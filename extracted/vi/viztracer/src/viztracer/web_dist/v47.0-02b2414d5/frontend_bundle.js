var frontend=function(){"use strict";var be="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function n(r){var t,n;return r.__esModule?r:("function"==typeof(t=r.default)?(n=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)}).prototype=t.prototype:n={},Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(r).forEach(function(e){var t=Object.getOwnPropertyDescriptor(r,e);Object.defineProperty(n,e,t.get?t:{enumerable:!0,get:function(){return r[e]}})}),n)}var pe={},a=function(e,t){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return(o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function s(e,t){var r={};for(a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(r[a[n]]=e[a[n]]);return r}function l(e,t,r,n){var a,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;0<=s;s--)(a=e[s])&&(o=(i<3?a(o):3<i?a(t,r,o):a(t,r))||o);return 3<i&&o&&Object.defineProperty(t,r,o),o}function c(r,n){return function(e,t){n(e,t,r)}}function u(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function d(e,o,s,l){return new(s=s||Promise)(function(r,t){function n(e){try{i(l.next(e))}catch(e){t(e)}}function a(e){try{i(l.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,a)}i((l=l.apply(e,o||[])).next())})}function f(n,a){var i,o,s,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;l=c&&t[c=0]?0:l;)try{if(i=1,o&&(s=2&t[0]?o.return:t[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,t[1])).done)return s;switch(o=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,o=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(s=0<(s=l.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))l.label=t[1];else if(6===t[0]&&l.label<s[1])l.label=s[1],s=t;else{if(!(s&&l.label<s[2])){s[2]&&l.ops.pop(),l.trys.pop();continue}l.label=s[2],l.ops.push(t)}}t=a.call(n,l)}catch(e){t=[6,e],o=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}}var p=Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]};function h(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||p(t,e,r)}function g(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),o=[];try{for(;(void 0===t||0<t--)&&!(n=i.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return o}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(m(arguments[t]));return e}function y(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),a=0,t=0;t<r;t++)for(var i=arguments[t],o=0,s=i.length;o<s;o++,a++)n[a]=i[o];return n}function T(e,t,r){if(r||2===arguments.length)for(var n,a=0,i=t.length;a<i;a++)!n&&a in t||((n=n||Array.prototype.slice.call(t,0,a))[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))}function b(e){return this instanceof b?(this.v=e,this):new b(e)}function v(e,t,r){var a,i,o;if(Symbol.asyncIterator)return a=r.apply(e,t||[]),i=[],o={},n("next"),n("throw"),n("return",function(t){return function(e){return Promise.resolve(e).then(t,c)}}),o[Symbol.asyncIterator]=function(){return this},o;throw new TypeError("Symbol.asyncIterator is not defined.");function n(n,e){a[n]&&(o[n]=function(r){return new Promise(function(e,t){1<i.push([n,r,e,t])||s(n,r)})},e)&&(o[n]=e(o[n]))}function s(e,t){try{(r=a[e](t)).value instanceof b?Promise.resolve(r.value.v).then(l,c):u(i[0][2],r)}catch(e){u(i[0][3],e)}var r}function l(e){s("next",e)}function c(e){s("throw",e)}function u(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}function E(n){var a,e={};return t("next"),t("throw",function(e){throw e}),t("return"),e[Symbol.iterator]=function(){return this},e;function t(t,r){e[t]=n[t]?function(e){return(a=!a)?{value:b(n[t](e)),done:!1}:r?r(e):e}:r}}function S(o){var e,t;if(Symbol.asyncIterator)return(e=o[Symbol.asyncIterator])?e.call(o):(o=g(o),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);throw new TypeError("Symbol.asyncIterator is not defined.");function r(i){t[i]=o[i]&&function(a){return new Promise(function(e,t){var r,n;a=o[i](a),r=e,e=t,n=a.done,t=a.value,Promise.resolve(t).then(function(e){r({value:e,done:n})},e)})}}}function A(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var O=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function C(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&p(t,e,r);return O(t,e),t}function k(e){return e&&e.__esModule?e:{default:e}}function w(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e===t&&n:t.has(e))return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e);throw new TypeError("Cannot read private member from an object whose class did not declare it")}function R(e,t,r,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e===t&&a:t.has(e))return"a"===n?a.call(e,r):a?a.value=r:t.set(e,r),r;throw new TypeError("Cannot write private member to an object whose class did not declare it")}function I(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function N(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var n,a;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(a=n)}if("function"!=typeof n)throw new TypeError("Object not disposable.");a&&(n=function(){try{a.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var U="function"==typeof SuppressedError?SuppressedError:function(e,t,r){r=new Error(r);return r.name="SuppressedError",r.error=e,r.suppressed=t,r};function B(n){function a(e){n.error=n.hasError?new U(e,n.error,"An error was suppressed during disposal."):e,n.hasError=!0}return function t(){for(;n.stack.length;){var e=n.stack.pop();try{var r=e.dispose&&e.dispose.call(e.value);if(e.async)return Promise.resolve(r).then(t,function(e){return a(e),t()})}catch(e){a(e)}}if(n.hasError)throw n.error}()}var he,j={__extends:i,__assign:o,__rest:s,__decorate:l,__param:c,__metadata:u,__awaiter:d,__generator:f,__createBinding:p,__exportStar:h,__values:g,__read:m,__spread:_,__spreadArrays:y,__spreadArray:T,__await:b,__asyncGenerator:v,__asyncDelegator:E,__asyncValues:S,__makeTemplateObject:A,__importStar:C,__importDefault:k,__classPrivateFieldGet:w,__classPrivateFieldSet:R,__classPrivateFieldIn:I,__addDisposableResource:N,__disposeResources:B},or=n(Object.freeze({__proto__:null,__extends:i,get __assign(){return o},__rest:s,__decorate:l,__param:c,__esDecorate:function(e,t,r,n,a,i){function o(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,l=n.kind,c="getter"===l?"get":"setter"===l?"set":"value",e=!t&&e?n.static?e:e.prototype:null,u=t||(e?Object.getOwnPropertyDescriptor(e,n.name):{}),d=!1,f=r.length-1;0<=f;f--){var p,h={};for(p in n)h[p]="access"===p?{}:n[p];for(p in n.access)h.access[p]=n.access[p];h.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");i.push(o(e||null))};var g=(0,r[f])("accessor"===l?{get:u.get,set:u.set}:u[c],h);if("accessor"===l){if(void 0!==g){if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(s=o(g.get))&&(u.get=s),(s=o(g.set))&&(u.set=s),(s=o(g.init))&&a.unshift(s)}}else(s=o(g))&&("field"===l?a.unshift(s):u[c]=s)}e&&Object.defineProperty(e,n.name,u),d=!0},__runInitializers:function(e,t,r){for(var n=2<arguments.length,a=0;a<t.length;a++)r=n?t[a].call(e,r):t[a].call(e);return n?r:void 0},__propKey:function(e){return"symbol"==typeof e?e:"".concat(e)},__setFunctionName:function(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})},__metadata:u,__awaiter:d,__generator:f,__createBinding:p,__exportStar:h,__values:g,__read:m,__spread:_,__spreadArrays:y,__spreadArray:T,__await:b,__asyncGenerator:v,__asyncDelegator:E,__asyncValues:S,__makeTemplateObject:A,__importStar:C,__importDefault:k,__classPrivateFieldGet:w,__classPrivateFieldSet:R,__classPrivateFieldIn:I,__addDisposableResource:N,__disposeResources:B,default:j}));var ge,me,H,G={},W={exports:{}};function q(){if(!me){me=1;var e,i=Object.defineProperty,L=Object.getOwnPropertyDescriptor,F=Object.getOwnPropertyNames,U=Object.prototype.hasOwnProperty,t={},B=t,r={Immer:()=>f,applyPatches:()=>q,castDraft:()=>function(e){return e},castImmutable:()=>function(e){return e},createDraft:()=>$,current:()=>ne,enableMapSet:()=>function(){class r extends Map{constructor(e,t){super(),this[l]={o:2,i:t,n:t?t.n:s,s:!1,c:!1,e:void 0,r:void 0,t:e,u:this,l:!1,m:!1}}get size(){return b(this[l]).size}has(e){return b(this[l]).has(e)}set(e,t){var r=this[l];return o(r),b(r).has(e)&&b(r).get(e)===t||(n(r),N(r),r.r.set(e,!0),r.e.set(e,t),r.r.set(e,!0)),this}delete(e){var t;return!!this.has(e)&&(o(t=this[l]),n(t),N(t),t.t.has(e)?t.r.set(e,!1):t.r.delete(e),t.e.delete(e),!0)}clear(){let t=this[l];o(t),b(t).size&&(n(t),N(t),t.r=new Map,A(t.t,e=>{t.r.set(e,!1)}),t.e.clear())}forEach(n,a){b(this[l]).forEach((e,t,r)=>{n.call(a,this.get(t),t,this)})}get(e){var t=this[l],r=(o(t),b(t).get(e));return t.c||!g(r)||r!==t.t.get(e)||(r=x(r,t),n(t),t.e.set(e,r)),r}keys(){return b(this[l]).keys()}values(){let t=this.keys();return{[Symbol.iterator]:()=>this.values(),next:()=>{var e=t.next();return e.done?e:{done:!1,value:this.get(e.value)}}}}entries(){let r=this.keys();return{[Symbol.iterator]:()=>this.entries(),next:()=>{var e,t=r.next();return t.done?t:(e=this.get(t.value),{done:!1,value:[t.value,e]})}}}[Symbol.iterator](){return this.entries()}}function n(e){e.e||(e.r=new Map,e.e=new Map(e.t))}class a extends Set{constructor(e,t){super(),this[l]={o:3,i:t,n:t?t.n:s,s:!1,c:!1,e:void 0,t:e,u:this,a:new Map,m:!1,l:!1}}get size(){return b(this[l]).size}has(e){var t=this[l];return o(t),t.e?!!(t.e.has(e)||t.a.has(e)&&t.e.has(t.a.get(e))):t.t.has(e)}add(e){var t=this[l];return o(t),this.has(e)||(i(t),N(t),t.e.add(e)),this}delete(e){var t;return!!this.has(e)&&(o(t=this[l]),i(t),N(t),t.e.delete(e)||!!t.a.has(e)&&t.e.delete(t.a.get(e)))}clear(){var e=this[l];o(e),b(e).size&&(i(e),N(e),e.e.clear())}values(){var e=this[l];return o(e),i(e),e.e.values()}entries(){var e=this[l];return o(e),i(e),e.e.entries()}keys(){return this.values()}[Symbol.iterator](){return this.values()}forEach(e,t){let r=this.values(),n=r.next();for(;!n.done;)e.call(t,n.value,n.value,this),n=r.next()}}function i(r){r.e||(r.e=new Set,r.t.forEach(e=>{var t;g(e)?(t=x(e,r),r.a.set(e,t),r.e.add(t)):r.e.add(e)}))}function o(e){e.m&&p(3,JSON.stringify(b(e)))}J("MapSet",{I:function(e,t){return new r(e,t)},D:function(e,t){return new a(e,t)}})},enablePatches:()=>function(){let b="replace",v="add",E="remove";function l(e){if(!g(e))return e;if(Array.isArray(e))return e.map(l);if(y(e))return new Map(Array.from(e.entries()).map(([e,t])=>[e,l(t)]));if(T(e))return new Set(Array.from(e).map(l));var t,r=Object.create(u(e));for(t in e)r[t]=l(e[t]);return O(e,n)&&(r[n]=e[n]),r}function S(e){return h(e)?l(e):e}J("Patches",{A:function(s,e){return e.forEach(e=>{let{path:n,op:t}=e,a=s;for(let r=0;r<n.length-1;r++){let e=_(a),t=n[r];"string"!=typeof t&&"number"!=typeof t&&(t=""+t),0!==e&&1!==e||"__proto__"!==t&&"constructor"!==t||p(19),"function"==typeof a&&"prototype"===t&&p(19),"object"!=typeof(a=C(a,t))&&p(18,n.join("/"))}var r=_(a),i=l(e.value),o=n[n.length-1];switch(t){case b:switch(r){case 2:return a.set(o,i);case 3:p(16);default:return a[o]=i}case v:switch(r){case 1:return"-"===o?a.push(i):a.splice(o,0,i);case 2:return a.set(o,i);case 3:return a.add(i);default:return a[o]=i}case E:switch(r){case 1:return a.splice(o,1);case 2:return a.delete(o);case 3:return a.delete(e.value);default:return delete a[o]}default:p(17)}}),s},g:function(e,o,s,l){switch(e.o){case 0:case 2:{var c=e;var u=o;var d=s;var f=l;let{t:a,e:i}=c;A(c.r,(e,t)=>{var r=C(a,e),n=C(i,e),t=t?O(a,e)?b:v:E;r===n&&t===b||(e=u.concat(e),d.push(t===E?{op:t,path:e}:{op:t,path:e,value:n}),f.push(t===v?{op:E,path:e}:t===E?{op:v,path:e,value:S(r)}:{op:b,path:e,value:S(r)}))});return}case 1:{c=e;var a=o;var i=s;var p=l;let{t,r}=c,n=c.e;n.length<t.length&&([t,n]=[n,t],[i,p]=[p,i]);for(let e=0;e<t.length;e++){var h;r[e]&&n[e]!==t[e]&&(h=a.concat([e]),i.push({op:b,path:h,value:S(n[e])}),p.push({op:b,path:h,value:S(t[e])}))}for(let e=t.length;e<n.length;e++){var g=a.concat([e]);i.push({op:v,path:g,value:S(n[e])})}for(let e=n.length-1;t.length<=e;--e){var m=a.concat([e]);p.push({op:E,path:m})}return}case 3:{var t=e;var _=o;var y=s;var T=l;let{t:r,e:n}=t,a=0;r.forEach(e=>{var t;n.has(e)||(t=_.concat([a]),y.push({op:E,path:t,value:e}),T.unshift({op:v,path:t,value:e})),a++}),a=0,n.forEach(e=>{var t;r.has(e)||(t=_.concat([a]),y.push({op:v,path:t,value:e}),T.unshift({op:E,path:t,value:e})),a++});return}}},T:function(e,t,r,n){r.push({op:b,path:[],value:t===c?void 0:t}),n.push({op:b,path:[],value:e})}})},finishDraft:()=>z,freeze:()=>E,immerable:()=>n,isDraft:()=>h,isDraftable:()=>g,nothing:()=>c,original:()=>function(e){return h(e)||p(15),e[l].t},produce:()=>H,produceWithPatches:()=>G,setAutoFreeze:()=>V,setUseStrictShallowCopy:()=>W};for(e in r)i(B,e,{get:r[e],enumerable:!0});ge=(e=>{var t=i({},"__esModule",{value:!0}),r=e,n=void 0,a=void 0;if(r&&"object"==typeof r||"function"==typeof r)for(let e of F(r))U.call(t,e)||e===n||i(t,e,{get:()=>r[e],enumerable:!(a=L(r,e))||a.enumerable});return t})(t);var s,c=Symbol.for("immer-nothing"),n=Symbol.for("immer-draftable"),l=Symbol.for("immer-state"),u=Object.getPrototypeOf,j=Object.prototype.constructor.toString(),a={},o={get(e,t){var r,n;return t===l?e:O(r=b(e),t)?(n=r[t],!e.c&&g(n)&&n===P(e.t,t)?(D(e),e.e[t]=x(n,e)):n):(n=e,(e=re(e=r,t))?"value"in e?e.value:e.get?.call(n.u):void 0)},has(e,t){return t in b(e)},ownKeys(e){return Reflect.ownKeys(b(e))},set(e,t,r){var n=re(b(e),t);if(n?.set)n.set.call(e.u,r);else{if(!e.s){var n=P(b(e),t),a=n?.[l];if(a&&a.t===r)return e.e[t]=r,!(e.r[t]=!1);if(((a=r)===(n=n)?0!==a||1/a==1/n:a!=a&&n!=n)&&(void 0!==r||O(e.t,t)))return!0;D(e),N(e)}e.e[t]===r&&(void 0!==r||t in e.e)||Number.isNaN(r)&&Number.isNaN(e.e[t])||(e.e[t]=r,e.r[t]=!0)}return!0},deleteProperty(e,t){return void 0!==P(e.t,t)||t in e.t?(e.r[t]=!1,D(e),N(e)):delete e.r[t],e.e&&delete e.e[t],!0},getOwnPropertyDescriptor(e,t){var r=b(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:1!==e.o||"length"!==t,enumerable:n.enumerable,value:r[t]}},defineProperty(){p(11)},getPrototypeOf(e){return u(e.t)},setPrototypeOf(){p(12)}},d={},f=(A(o,(e,t)=>{d[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),d.deleteProperty=function(e,t){return d.set.call(this,e,t,void 0)},d.set=function(e,t,r){return o.set.call(this,e[0],t,r,e[0])},class{constructor(e){this.y=!0,this.S=!1,this.produce=(a,i,n)=>{if("function"==typeof a&&"function"!=typeof i){let r=i,n=(i=a,this);return function(e=r,...t){return n.produce(e,e=>i.call(this,e,...t))}}"function"!=typeof i&&p(6),void 0!==n&&"function"!=typeof n&&p(7);let o;if(g(a)){let e=Q(this),t=x(a,void 0),r=!0;try{o=i(t),r=!1}finally{(r?w:R)(e)}return Z(e,n),ee(o,e)}var e,t;if(!a||"object"!=typeof a)return(o=void 0===(o=i(a))?a:o)===c&&(o=void 0),this.y&&E(o,!0),n&&(e=[],t=[],k("Patches").T(a,o,e,t),n(e,t)),o;p(1)},this.produceWithPatches=(r,e)=>{if("function"==typeof r)return(e,...t)=>this.produceWithPatches(e,e=>r(e,...t));let n,a;return[this.produce(r,e,(e,t)=>{n=e,a=t}),n,a]},"boolean"==typeof e?.autoFreeze&&this.setAutoFreeze(e.autoFreeze),"boolean"==typeof e?.useStrictShallowCopy&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){g(e)||p(8),h(e)&&(e=ne(e));var t=Q(this),e=x(e,void 0);return e[l].l=!0,R(t),e}finishDraft(e,t){e=e&&e[l],e&&e.l||p(9),e=e.n;return Z(e,t),ee(void 0,e)}setAutoFreeze(e){this.y=e}setUseStrictShallowCopy(e){this.S=e}applyPatches(e,t){let r;for(r=t.length-1;0<=r;r--){var n=t[r];if(0===n.path.length&&"replace"===n.op){e=n.value;break}}-1<r&&(t=t.slice(r+1));let a=k("Patches").A;return h(e)?a(e,t):this.produce(e,e=>a(e,t))}}),t=new f,H=t.produce,G=t.produceWithPatches.bind(t),V=t.setAutoFreeze.bind(t),W=t.setUseStrictShallowCopy.bind(t),q=t.applyPatches.bind(t),$=t.createDraft.bind(t),z=t.finishDraft.bind(t)}return ge;function p(e){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}function h(e){return!!e&&!!e[l]}function g(e){return!!e&&(m(e)||Array.isArray(e)||!!e[n]||!!e.constructor?.[n]||y(e)||T(e))}function m(e){return!(!e||"object"!=typeof e)&&(null===(e=u(e))||(e=Object.hasOwnProperty.call(e,"constructor")&&e.constructor)===Object||"function"==typeof e&&Function.toString.call(e)===j)}function A(r,n){0===_(r)?Reflect.ownKeys(r).forEach(e=>{n(e,r[e],r)}):r.forEach((e,t)=>n(t,e,r))}function _(e){var t=e[l];return t?t.o:Array.isArray(e)?1:y(e)?2:T(e)?3:0}function O(e,t){return 2===_(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function C(e,t){return 2===_(e)?e.get(t):e[t]}function K(e,t,r){var n=_(e);2===n?e.set(t,r):3===n?e.add(r):e[t]=r}function y(e){return e instanceof Map}function T(e){return e instanceof Set}function b(e){return e.e||e.t}function v(t,e){if(y(t))return new Map(t);if(T(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);var r=m(t);if(!0===e||"class_only"===e&&!r){var n=Object.getOwnPropertyDescriptors(t),a=(delete n[l],Reflect.ownKeys(n));for(let e=0;e<a.length;e++){var i=a[e],o=n[i];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:t[i]})}return Object.create(u(t),n)}return null!==(e=u(t))&&r?{...t}:(r=Object.create(e),Object.assign(r,t))}function E(e,t=!1){return S(e)||h(e)||!g(e)||(1<_(e)&&(e.set=e.add=e.clear=e.delete=Y),Object.freeze(e),t&&Object.entries(e).forEach(([,e])=>E(e,!0))),e}function Y(){p(2)}function S(e){return Object.isFrozen(e)}function k(e){e=a[e];return e||p(0),e}function J(e,t){a[e]||(a[e]=t)}function Z(e,t){t&&(k("Patches"),e.f=[],e.h=[],e.b=t)}function w(e){R(e),e.a.forEach(X),e.a=null}function R(e){e===s&&(s=e.i)}function Q(e){return s={a:[],i:s,p:e,P:!0,d:0}}function X(e){e=e[l];0===e.o||1===e.o?e.x():e.m=!0}function ee(e,t){t.d=t.a.length;var r=t.a[0];return void 0!==e&&e!==r?(r[l].s&&(w(t),p(4)),g(e)&&(e=I(t,e),t.i||M(t,e)),t.f&&k("Patches").T(r[l].t,e,t.f,t.h)):e=I(t,r,[]),w(t),t.f&&t.b(t.f,t.h),e!==c?e:void 0}function I(a,r,i){if(S(r))return r;let o=r[l];if(!o)return A(r,(e,t)=>te(a,o,r,e,t,i)),r;if(o.n!==a)return r;if(!o.s)return M(a,o.t,!0),o.t;if(!o.c){o.c=!0,o.n.d--;let r=o.e,e=r,n=!1;3===o.o&&(e=new Set(r),r.clear(),n=!0),A(e,(e,t)=>te(a,o,r,e,t,i,n)),M(a,r,!1),i&&a.f&&k("Patches").g(o,i,a.f,a.h)}return o.e}function te(e,t,r,n,a,i,o){if(h(a)){i=I(e,a,i&&t&&3!==t.o&&!O(t.r,n)?i.concat(n):void 0);if(K(r,n,i),!h(i))return;e.P=!1}else o&&r.add(a);!g(a)||S(a)||!e.p.y&&e.d<1||(I(e,a),t&&t.n.i)||"symbol"==typeof n||!Object.prototype.propertyIsEnumerable.call(r,n)||M(e,a)}function M(e,t,r=!1){!e.i&&e.p.y&&e.P&&E(t,r)}function P(e,t){var r=e[l];return(r?b(r):e)[t]}function re(t,r){if(r in t){let e=u(t);for(;e;){var n=Object.getOwnPropertyDescriptor(e,r);if(n)return n;e=u(e)}}}function N(e){e.s||(e.s=!0,e.i&&N(e.i))}function D(e){e.e||(e.e=v(e.t,e.n.p.S))}function x(e,t){e=y(e)?k("MapSet").I(e,t):T(e)?k("MapSet").D(e,t):function(e,t){let r=Array.isArray(e),n={o:r?1:0,n:t?t.n:s,s:!1,c:!1,r:{},i:t,t:e,u:null,e:null,x:null,l:!1},a=n,i=o;r&&(a=[n],i=d);var{revoke:t,proxy:e}=Proxy.revocable(a,i);return n.u=e,n.x=t,e}(e,t);return(t?t.n:s).a.push(e),e}function ne(e){return h(e)||p(10),function r(e){if(!g(e)||S(e))return e;let t=e[l],n;if(t){if(!t.s)return t.t;t.c=!0,n=v(e,t.n.p.S)}else n=v(e,!0);return A(n,(e,t)=>{K(n,e,r(t))}),t&&(t.c=!1),n}(e)}}function _e(){return H||(H=1,W.exports=q()),W.exports}var $,ye,Te={},ve={};function Ee(){return ye||(ye=1,$=function(e,t){var r=new Array(arguments.length-1),i=0,n=2,o=!0;for(;n<arguments.length;)r[i++]=arguments[n++];return new Promise(function(n,a){r[i]=function(e){if(o)if(o=!1,e)a(e);else{for(var t=new Array(arguments.length-1),r=0;r<t.length;)t[r++]=arguments[r];n.apply(null,t)}};try{e.apply(t||null,r)}catch(e){o&&(o=!1,a(e))}})}),$}var Se,Ae,Oe,Ce,ke,we,Re,Ie={};function Me(){if(!Se){Se=1;for(var e=Ie,c=(e.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;1<--t%4&&"="===e.charAt(t);)++r;return Math.ceil(3*e.length)/4-r},new Array(64)),l=new Array(123),t=0;t<64;)l[c[t]=t<26?t+65:t<52?t+71:t<62?t-4:t-59|43]=t++;e.encode=function(e,t,r){for(var n,a=null,i=[],o=0,s=0;t<r;){var l=e[t++];switch(s){case 0:i[o++]=c[l>>2],n=(3&l)<<4,s=1;break;case 1:i[o++]=c[n|l>>4],n=(15&l)<<2,s=2;break;case 2:i[o++]=c[n|l>>6],i[o++]=c[63&l],s=0}8191<o&&((a=a||[]).push(String.fromCharCode.apply(String,i)),o=0)}return s&&(i[o++]=c[n],i[o++]=61,1===s)&&(i[o++]=61),a?(o&&a.push(String.fromCharCode.apply(String,i.slice(0,o))),a.join("")):String.fromCharCode.apply(String,i.slice(0,o))};var u="invalid encoding";e.decode=function(e,t,r){for(var n,a=r,i=0,o=0;o<e.length;){var s=e.charCodeAt(o++);if(61===s&&1<i)break;if(void 0===(s=l[s]))throw Error(u);switch(i){case 0:n=s,i=1;break;case 1:t[r++]=n<<2|(48&s)>>4,n=s,i=2;break;case 2:t[r++]=(15&n)<<4|(60&s)>>2,n=s,i=3;break;case 3:t[r++]=(3&n)<<6|s,i=0}}if(1===i)throw Error(u);return r-a},e.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}}return Ie}function Pe(){return ke||(ke=1,Ce=e(e)),Ce;function e(e){function t(e,t,r,n){var a=t<0?1:0;0===(t=a?-t:t)?e(0<1/t?0:2147483648,r,n):isNaN(t)?e(2143289344,r,n):e(34028234663852886e22<t?(a<<31|2139095040)>>>0:t<11754943508222875e-54?(a<<31|Math.round(t/1401298464324817e-60))>>>0:(a<<31|(e=Math.floor(Math.log(t)/Math.LN2))+127<<23|8388607&Math.round(t*Math.pow(2,-e)*8388608))>>>0,r,n)}function r(e,t,r){e=e(t,r),t=2*(e>>31)+1,r=e>>>23&255,e&=8388607;return 255==r?e?NaN:1/0*t:0==r?1401298464324817e-60*t*e:t*Math.pow(2,r-150)*(8388608+e)}function n(e,t,r){s[0]=e,t[r]=l[0],t[r+1]=l[1],t[r+2]=l[2],t[r+3]=l[3]}function a(e,t,r){s[0]=e,t[r]=l[3],t[r+1]=l[2],t[r+2]=l[1],t[r+3]=l[0]}function i(e,t){return l[0]=e[t],l[1]=e[t+1],l[2]=e[t+2],l[3]=e[t+3],s[0]}function o(e,t){return l[3]=e[t],l[2]=e[t+1],l[1]=e[t+2],l[0]=e[t+3],s[0]}var s,l,c,u,d;function f(e,t,r,n,a,i){var o,s,l=n<0?1:0;0===(n=l?-n:n)?(e(0,a,i+t),e(0<1/n?0:2147483648,a,i+r)):isNaN(n)?(e(0,a,i+t),e(2146959360,a,i+r)):17976931348623157e292<n?(e(0,a,i+t),e((l<<31|2146435072)>>>0,a,i+r)):n<22250738585072014e-324?(e((o=n/5e-324)>>>0,a,i+t),e((l<<31|o/4294967296)>>>0,a,i+r)):(1024===(s=Math.floor(Math.log(n)/Math.LN2))&&(s=1023),e(4503599627370496*(o=n*Math.pow(2,-s))>>>0,a,i+t),e((l<<31|s+1023<<20|1048576*o&1048575)>>>0,a,i+r))}function p(e,t,r,n,a){t=e(n,a+t),e=e(n,a+r),n=2*(e>>31)+1,a=e>>>20&2047,r=4294967296*(1048575&e)+t;return 2047==a?r?NaN:1/0*n:0==a?5e-324*n*r:n*Math.pow(2,a-1075)*(r+4503599627370496)}function h(e,t,r){c[0]=e,t[r]=u[0],t[r+1]=u[1],t[r+2]=u[2],t[r+3]=u[3],t[r+4]=u[4],t[r+5]=u[5],t[r+6]=u[6],t[r+7]=u[7]}function g(e,t,r){c[0]=e,t[r]=u[7],t[r+1]=u[6],t[r+2]=u[5],t[r+3]=u[4],t[r+4]=u[3],t[r+5]=u[2],t[r+6]=u[1],t[r+7]=u[0]}function m(e,t){return u[0]=e[t],u[1]=e[t+1],u[2]=e[t+2],u[3]=e[t+3],u[4]=e[t+4],u[5]=e[t+5],u[6]=e[t+6],u[7]=e[t+7],c[0]}function _(e,t){return u[7]=e[t],u[6]=e[t+1],u[5]=e[t+2],u[4]=e[t+3],u[3]=e[t+4],u[2]=e[t+5],u[1]=e[t+6],u[0]=e[t+7],c[0]}return"undefined"!=typeof Float32Array?(s=new Float32Array([-0]),l=new Uint8Array(s.buffer),d=128===l[3],e.writeFloatLE=d?n:a,e.writeFloatBE=d?a:n,e.readFloatLE=d?i:o,e.readFloatBE=d?o:i):(e.writeFloatLE=t.bind(null,y),e.writeFloatBE=t.bind(null,T),e.readFloatLE=r.bind(null,b),e.readFloatBE=r.bind(null,v)),"undefined"!=typeof Float64Array?(c=new Float64Array([-0]),u=new Uint8Array(c.buffer),d=128===u[7],e.writeDoubleLE=d?h:g,e.writeDoubleBE=d?g:h,e.readDoubleLE=d?m:_,e.readDoubleBE=d?_:m):(e.writeDoubleLE=f.bind(null,y,0,4),e.writeDoubleBE=f.bind(null,T,4,0),e.readDoubleLE=p.bind(null,b,0,4),e.readDoubleBE=p.bind(null,v,4,0)),e}function y(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function T(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=255&e}function b(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function v(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}}var Ne,De,Le,Fe,Ue,Be,je,Ge,Ve,We,qe,$e,ze,Ke,Ye={};function Je(){var e;return Ne||(Ne=1,(e=Ye).length=function(e){for(var t,r=0,n=0;n<e.length;++n)(t=e.charCodeAt(n))<128?r+=1:t<2048?r+=2:55296==(64512&t)&&56320==(64512&e.charCodeAt(n+1))?(++n,r+=4):r+=3;return r},e.read=function(e,t,r){if(r-t<1)return"";for(var n,a=null,i=[],o=0;t<r;)(n=e[t++])<128?i[o++]=n:191<n&&n<224?i[o++]=(31&n)<<6|63&e[t++]:239<n&&n<365?(n=((7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,i[o++]=55296+(n>>10),i[o++]=56320+(1023&n)):i[o++]=(15&n)<<12|(63&e[t++])<<6|63&e[t++],8191<o&&((a=a||[]).push(String.fromCharCode.apply(String,i)),o=0);return a?(o&&a.push(String.fromCharCode.apply(String,i.slice(0,o))),a.join("")):String.fromCharCode.apply(String,i.slice(0,o))},e.write=function(e,t,r){for(var n,a,i=r,o=0;o<e.length;++o)(n=e.charCodeAt(o))<128?t[r++]=n:(n<2048?t[r++]=n>>6|192:(55296==(64512&n)&&56320==(64512&(a=e.charCodeAt(o+1)))?(++o,t[r++]=(n=65536+((1023&n)<<10)+(1023&a))>>18|240,t[r++]=n>>12&63|128):t[r++]=n>>12|224,t[r++]=n>>6&63|128),t[r++]=63&n|128);return r-i}),Ye}function Ze(){return Le||(Le=1,De=function(t,r,e){var n=e||8192,a=n>>>1,i=null,o=n;return function(e){if(e<1||a<e)return t(e);n<o+e&&(i=t(n),o=0);e=r.call(i,o,o+=e);return 7&o&&(o=1+(7|o)),e}}),De}function Qe(){var t,n,r,a;return Be||(Be=1,(a=ve).asPromise=Ee(),a.base64=Me(),a.EventEmitter=(Oe||(Oe=1,(Ae=e).prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this},e.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var r=this._listeners[e],n=0;n<r.length;)r[n].fn===t?r.splice(n,1):++n;return this},e.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],n=1;n<arguments.length;)r.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,r)}return this}),Ae),a.float=Pe(),a.inquire=(Re||(Re=1,we=function(e){try{}catch(e){}return null}),we),a.utf8=Je(),a.pool=Ze(),a.LongBits=(Ue||(Ue=1,Fe=i,t=Qe(),(n=i.zero=new i(0,0)).toNumber=function(){return 0},n.zzEncode=n.zzDecode=function(){return this},n.length=function(){return 1},i.zeroHash="\0\0\0\0\0\0\0\0",i.fromNumber=function(e){var t,r;return 0===e?n:(r=(e=(t=e<0)?-e:e)>>>0,e=(e-r)/4294967296>>>0,t&&(e=~e>>>0,r=~r>>>0,4294967295<++r)&&(r=0,4294967295<++e)&&(e=0),new i(r,e))},i.from=function(e){if("number"==typeof e)return i.fromNumber(e);if(t.isString(e)){if(!t.Long)return i.fromNumber(parseInt(e,10));e=t.Long.fromString(e)}return e.low||e.high?new i(e.low>>>0,e.high>>>0):n},i.prototype.toNumber=function(e){var t;return!e&&this.hi>>>31?(e=1+~this.lo>>>0,t=~this.hi>>>0,-(e+4294967296*(t=e?t:t+1>>>0))):this.lo+4294967296*this.hi},i.prototype.toLong=function(e){return t.Long?new t.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}},r=String.prototype.charCodeAt,i.fromHash=function(e){return"\0\0\0\0\0\0\0\0"===e?n:new i((r.call(e,0)|r.call(e,1)<<8|r.call(e,2)<<16|r.call(e,3)<<24)>>>0,(r.call(e,4)|r.call(e,5)<<8|r.call(e,6)<<16|r.call(e,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},i.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},i.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0==r?0==t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}),Fe),a.isNode=Boolean(void 0!==be&&be&&be.process&&be.process.versions&&be.process.versions.node),a.global=a.isNode&&be||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||be,a.emptyArray=Object.freeze?Object.freeze([]):[],a.emptyObject=Object.freeze?Object.freeze({}):{},a.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},a.isString=function(e){return"string"==typeof e||e instanceof String},a.isObject=function(e){return e&&"object"==typeof e},a.isset=a.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!=typeof r||0<(Array.isArray(r)?r:Object.keys(r)).length)},a.Buffer=function(){try{var e=a.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),a._Buffer_from=null,a._Buffer_allocUnsafe=null,a.newBuffer=function(e){return"number"==typeof e?a.Buffer?a._Buffer_allocUnsafe(e):new a.Array(e):a.Buffer?a._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},a.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,a.Long=a.global.dcodeIO&&a.global.dcodeIO.Long||a.global.Long||a.inquire("long"),a.key2Re=/^true|false|0|1$/,a.key32Re=/^-?(?:0|[1-9][0-9]*)$/,a.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,a.longToHash=function(e){return e?a.LongBits.from(e).toHash():a.LongBits.zeroHash},a.longFromHash=function(e,t){e=a.LongBits.fromHash(e);return a.Long?a.Long.fromBits(e.lo,e.hi,t):e.toNumber(Boolean(t))},a.merge=o,a.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},a.newError=s,a.ProtocolError=s("ProtocolError"),a.oneOfGetter=function(e){for(var r={},t=0;t<e.length;++t)r[e[t]]=1;return function(){for(var e=Object.keys(this),t=e.length-1;-1<t;--t)if(1===r[e[t]]&&void 0!==this[e[t]]&&null!==this[e[t]])return e[t]}},a.oneOfSetter=function(r){return function(e){for(var t=0;t<r.length;++t)r[t]!==e&&delete this[r[t]]}},a.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},a._configure=function(){var r=a.Buffer;r?(a._Buffer_from=r.from!==Uint8Array.from&&r.from||function(e,t){return new r(e,t)},a._Buffer_allocUnsafe=r.allocUnsafe||function(e){return new r(e)}):a._Buffer_from=a._Buffer_allocUnsafe=null}),ve;function e(){this._listeners={}}function i(e,t){this.lo=e>>>0,this.hi=t>>>0}function o(e,t,r){for(var n=Object.keys(t),a=0;a<n.length;++a)void 0!==e[n[a]]&&r||(e[n[a]]=t[n[a]]);return e}function s(e){function r(e,t){if(!(this instanceof r))return new r(e,t);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,r):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),t&&o(this,t)}return r.prototype=Object.create(Error.prototype,{constructor:{value:r,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),r}}function Xe(){var n,t,r,a,i,o,s;return Ge||(Ge=1,je=u,n=Qe(),r=n.LongBits,a=n.base64,i=n.utf8,u.create=(o=function(){return n.Buffer?function(){return(u.create=function(){return new t})()}:function(){return new u}})(),u.alloc=function(e){return new n.Array(e)},n.Array!==Array&&(u.alloc=n.pool(u.alloc,n.Array.prototype.subarray)),u.prototype._push=function(e,t,r){return this.tail=this.tail.next=new l(e,t,r),this.len+=t,this},(f.prototype=Object.create(l.prototype)).fn=function(e,t,r){for(;127<e;)t[r++]=127&e|128,e>>>=7;t[r]=e},u.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new f((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},u.prototype.int32=function(e){return e<0?this._push(p,10,r.fromNumber(e)):this.uint32(e)},u.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},u.prototype.int64=u.prototype.uint64=function(e){e=r.from(e);return this._push(p,e.length(),e)},u.prototype.sint64=function(e){e=r.from(e).zzEncode();return this._push(p,e.length(),e)},u.prototype.bool=function(e){return this._push(d,1,e?1:0)},u.prototype.sfixed32=u.prototype.fixed32=function(e){return this._push(h,4,e>>>0)},u.prototype.sfixed64=u.prototype.fixed64=function(e){e=r.from(e);return this._push(h,4,e.lo)._push(h,4,e.hi)},u.prototype.float=function(e){return this._push(n.float.writeFloatLE,4,e)},u.prototype.double=function(e){return this._push(n.float.writeDoubleLE,8,e)},s=n.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var n=0;n<e.length;++n)t[r+n]=e[n]},u.prototype.bytes=function(e){var t,r=e.length>>>0;return r?(n.isString(e)&&(t=u.alloc(r=a.length(e)),a.decode(e,t,0),e=t),this.uint32(r)._push(s,r,e)):this._push(d,1,0)},u.prototype.string=function(e){var t=i.length(e);return t?this.uint32(t)._push(i.write,t,e):this._push(d,1,0)},u.prototype.fork=function(){return this.states=new c(this),this.head=this.tail=new l(e,0,0),this.len=0,this},u.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new l(e,0,0),this.len=0),this},u.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},u.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},u._configure=function(e){t=e,u.create=o(),t._configure()}),je;function l(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function e(){}function c(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function u(){this.len=0,this.head=new l(e,0,0),this.tail=this.head,this.states=null}function d(e,t,r){t[r]=255&e}function f(e,t){this.len=e,this.next=void 0,this.val=t}function p(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;127<e.lo;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function h(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}}function et(){var n,r,a,t,i,o,e;return $e||($e=1,qe=l,n=Qe(),a=n.LongBits,t=n.utf8,i="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new l(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new l(e);throw Error("illegal buffer")},l.create=(o=function(){return n.Buffer?function(e){return(l.create=function(e){return n.Buffer.isBuffer(e)?new r(e):i(e)})(e)}:i})(),l.prototype._slice=n.Array.prototype.subarray||n.Array.prototype.slice,l.prototype.uint32=(e=4294967295,function(){if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)||!((this.pos+=5)>this.len))return e;throw this.pos=this.len,s(this,10)}),l.prototype.int32=function(){return 0|this.uint32()},l.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},l.prototype.bool=function(){return 0!==this.uint32()},l.prototype.fixed32=function(){if(this.pos+4>this.len)throw s(this,4);return u(this.buf,this.pos+=4)},l.prototype.sfixed32=function(){if(this.pos+4>this.len)throw s(this,4);return 0|u(this.buf,this.pos+=4)},l.prototype.float=function(){if(this.pos+4>this.len)throw s(this,4);var e=n.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},l.prototype.double=function(){if(this.pos+8>this.len)throw s(this,4);var e=n.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},l.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw s(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?(e=n.Buffer)?e.alloc(0):new this.buf.constructor(0):this._slice.call(this.buf,t,r)},l.prototype.string=function(){var e=this.bytes();return t.read(e,0,e.length)},l.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw s(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw s(this)}while(128&this.buf[this.pos++]);return this},l.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},l._configure=function(e){r=e,l.create=o(),r._configure();var t=n.Long?"toLong":"toNumber";n.merge(l.prototype,{int64:function(){return c.call(this)[t](!1)},uint64:function(){return c.call(this)[t](!0)},sint64:function(){return c.call(this).zzDecode()[t](!1)},fixed64:function(){return d.call(this)[t](!0)},sfixed64:function(){return d.call(this)[t](!1)}})}),qe;function s(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function l(e){this.buf=e,this.pos=0,this.len=e.length}function c(){var e=new a(0,0),t=0;if(!(4<this.len-this.pos)){for(;t<3;++t){if(this.pos>=this.len)throw s(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,4<this.len-this.pos){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw s(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function u(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function d(){if(this.pos+8>this.len)throw s(this,8);return new a(u(this.buf,this.pos+=4),u(this.buf,this.pos+=4))}}var tt,rt,nt,at,it,ot,st,lt,ct,ut={};function dt(){var s;return nt||(nt=1,ut.Service=(rt||(rt=1,tt=e,s=Qe(),((e.prototype=Object.create(s.EventEmitter.prototype)).constructor=e).prototype.rpcCall=function e(r,t,n,a,i){if(!a)throw TypeError("request must be specified");var o=this;if(!i)return s.asPromise(e,o,r,t,n,a);if(o.rpcImpl)try{return o.rpcImpl(r,t[o.requestDelimited?"encodeDelimited":"encode"](a).finish(),function(e,t){if(e)return o.emit("error",e,r),i(e);if(null!==t){if(!(t instanceof n))try{t=n[o.responseDelimited?"decodeDelimited":"decode"](t)}catch(e){return o.emit("error",e,r),i(e)}return o.emit("data",t,r),i(null,t)}o.end(!0)})}catch(e){o.emit("error",e,r),setTimeout(function(){i(e)},0)}else setTimeout(function(){i(Error("already ended"))},0)},e.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}),tt)),ut;function e(e,t,r){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");s.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(r)}}function ft(){var e,n,t,r,a;return ot||(ot=1,(a=Te).build="minimal",a.Writer=Xe(),a.BufferWriter=(We||(We=1,Ve=i,e=Xe(),(i.prototype=Object.create(e.prototype)).constructor=i,n=Qe(),i._configure=function(){i.alloc=n._Buffer_allocUnsafe,i.writeBytesBuffer=n.Buffer&&n.Buffer.prototype instanceof Uint8Array&&"set"===n.Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var n=0;n<e.length;)t[r++]=e[n++]}},i.prototype.bytes=function(e){var t=(e=n.isString(e)?n._Buffer_from(e,"base64"):e).length>>>0;return this.uint32(t),t&&this._push(i.writeBytesBuffer,t,e),this},i.prototype.string=function(e){var t=n.Buffer.byteLength(e);return this.uint32(t),t&&this._push(o,t,e),this},i._configure()),Ve),a.Reader=et(),a.BufferReader=(Ke||(Ke=1,ze=s,t=et(),(s.prototype=Object.create(t.prototype)).constructor=s,r=Qe(),s._configure=function(){r.Buffer&&(s.prototype._slice=r.Buffer.prototype.slice)},s.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},s._configure()),ze),a.util=Qe(),a.rpc=dt(),a.roots=(it||(it=1,at={}),at),a.configure=l,l()),Te;function i(){e.call(this)}function o(e,t,r){e.length<40?n.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}function s(e){t.call(this,e)}function l(){a.util._configure(),a.Writer._configure(a.BufferWriter),a.Reader._configure(a.BufferReader)}}function lr(){return lt||(lt=1,st=ft()),st}function pt(){if(!ct){ct=1,Object.defineProperty(G,"__esModule",{value:!0});var t=or;const r=_e(),n=t.__importDefault(lr());let e=!1;if(e)throw new Error("initialize() should be called exactly once");(0,r.enablePatches)(),(0,r.enableMapSet)(),(0,r.setAutoFreeze)(!0),n.default.util.Long=void 0,n.default.configure(),e=!0}}var ht,gt={},mt={},_t={},yt={};var Tt,bt={};var vt,Et,St,At={},Ot={},Ct={};function kt(){var t,e;return Et||(Et=1,Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.default=void 0,vt||(vt=1,Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.default=void 0,Ct.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i),t=(e=Ct)&&e.__esModule?e:{default:e},Ot.default=function(e){return"string"==typeof e&&t.default.test(e)}),Ot}function wt(){var n,e;return St||(St=1,Object.defineProperty(At,"__esModule",{value:!0}),At.default=void 0,n=(e=kt())&&e.__esModule?e:{default:e},At.default=function(e){var t,r;if((0,n.default)(e))return(r=new Uint8Array(16))[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r;throw TypeError("Invalid UUID")}),At}var It,Mt={};function Pt(){if(!It){It=1,Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.default=void 0,Mt.unsafeStringify=a;for(var e,r=(e=kt())&&e.__esModule?e:{default:e},n=[],t=0;t<256;++t)n.push((t+256).toString(16).slice(1));Mt.default=function(e,t=0){if(e=a(e,t),(0,r.default)(e))return e;throw TypeError("Stringified UUID is invalid")}}return Mt;function a(e,t=0){return(n[e[t+0]]+n[e[t+1]]+n[e[t+2]]+n[e[t+3]]+"-"+n[e[t+4]]+n[e[t+5]]+"-"+n[e[t+6]]+n[e[t+7]]+"-"+n[e[t+8]]+n[e[t+9]]+"-"+n[e[t+10]]+n[e[t+11]]+n[e[t+12]]+n[e[t+13]]+n[e[t+14]]+n[e[t+15]]).toLowerCase()}}var Nt,Dt,xt={},Lt={};function Ft(){var e,t;return Nt||(Nt=1,Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.default=function(){if(!e&&!(e="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return e(t)},t=new Uint8Array(16)),Lt}function Ut(){var u,e,d,f,p,h,g;return Dt||(Dt=1,Object.defineProperty(xt,"__esModule",{value:!0}),xt.default=void 0,u=(e=Ft())&&e.__esModule?e:{default:e},d=Pt(),g=h=0,xt.default=function(e,t,r){var n=t&&r||0,a=t||new Array(16),i=(e=e||{}).node,r=e.clockseq,o=(e._v6||(i=i||f,null==r&&(r=p)),null!=i&&null!=r||(o=e.random||(e.rng||u.default)(),null==i&&(i=[o[0],o[1],o[2],o[3],o[4],o[5]],f||e._v6||(i[0]|=1,f=i)),null==r&&(r=16383&(o[6]<<8|o[7]),void 0!==p||e._v6||(p=r))),void 0!==e.msecs?e.msecs:Date.now()),s=void 0!==e.nsecs?e.nsecs:g+1,l=o-h+(s-g)/1e4;if(l<0&&void 0===e.clockseq&&(r=r+1&16383),1e4<=(s=(l<0||h<o)&&void 0===e.nsecs?0:s))throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");h=o,p=r,l=(1e4*(268435455&(o+=122192928e5))+(g=s))%4294967296,a[n++]=l>>>24&255,a[n++]=l>>>16&255,a[n++]=l>>>8&255,a[n++]=255&l,e=o/4294967296*1e4&268435455,a[n++]=e>>>8&255,a[n++]=255&e,a[n++]=e>>>24&15|16,a[n++]=e>>>16&255,a[n++]=r>>>8|128,a[n++]=255&r;for(var c=0;c<6;++c)a[n+c]=i[c];return t||(0,d.unsafeStringify)(a)}),xt}var Bt,jt={};function Ht(){var r,e,n;return Bt||(Bt=1,Object.defineProperty(jt,"__esModule",{value:!0}),jt.default=function(e){var t=function(e){return Uint8Array.of((15&e[6])<<4|e[7]>>4&15,(15&e[7])<<4|(240&e[4])>>4,(15&e[4])<<4|(240&e[5])>>4,(15&e[5])<<4|(240&e[0])>>4,(15&e[0])<<4|(240&e[1])>>4,(15&e[1])<<4|(240&e[2])>>4,96|15&e[2],e[3],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}("string"==typeof e?(0,r.default)(e):e);return"string"==typeof e?(0,n.unsafeStringify)(t):t},r=(e=wt())&&e.__esModule?e:{default:e},n=Pt()),jt}var Gt,Vt={},Wt={};function qt(){var c,u,e,r,n;return Gt||(Gt=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.URL=Wt.DNS=void 0,Wt.default=function(e,s,l){function t(e,t,r,n){var a;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),16!==(null==(a=t="string"==typeof t?(0,u.default)(t):t)?void 0:a.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var i=new Uint8Array(16+e.length);if(i.set(t),i.set(e,t.length),(i=l(i))[6]=15&i[6]|s,i[8]=63&i[8]|128,r){n=n||0;for(var o=0;o<16;++o)r[n+o]=i[o];return r}return(0,c.unsafeStringify)(i)}try{t.name=e}catch(e){}return t.DNS=r,t.URL=n,t},c=Pt(),u=(e=wt())&&e.__esModule?e:{default:e},r=Wt.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",n=Wt.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8"),Wt}var $t,zt,Kt={};function Yt(){return $t||($t=1,Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.default=void 0,Kt.default=function(e){if("string"==typeof e){var t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(var r=0;r<t.length;++r)e[r]=t.charCodeAt(r)}for(var n=function(e,t){e[t>>5]|=128<<t%32,e[d(t)-1]=t;for(var r=1732584193,n=-271733879,a=-1732584194,i=271733878,o=0;o<e.length;o+=16){var s=r,l=n,c=a,u=i;r=p(r,n,a,i,e[o],7,-680876936),i=p(i,r,n,a,e[o+1],12,-389564586),a=p(a,i,r,n,e[o+2],17,606105819),n=p(n,a,i,r,e[o+3],22,-1044525330),r=p(r,n,a,i,e[o+4],7,-176418897),i=p(i,r,n,a,e[o+5],12,1200080426),a=p(a,i,r,n,e[o+6],17,-1473231341),n=p(n,a,i,r,e[o+7],22,-45705983),r=p(r,n,a,i,e[o+8],7,1770035416),i=p(i,r,n,a,e[o+9],12,-1958414417),a=p(a,i,r,n,e[o+10],17,-42063),n=p(n,a,i,r,e[o+11],22,-1990404162),r=p(r,n,a,i,e[o+12],7,1804603682),i=p(i,r,n,a,e[o+13],12,-40341101),a=p(a,i,r,n,e[o+14],17,-1502002290),n=p(n,a,i,r,e[o+15],22,1236535329),r=h(r,n,a,i,e[o+1],5,-165796510),i=h(i,r,n,a,e[o+6],9,-1069501632),a=h(a,i,r,n,e[o+11],14,643717713),n=h(n,a,i,r,e[o],20,-373897302),r=h(r,n,a,i,e[o+5],5,-701558691),i=h(i,r,n,a,e[o+10],9,38016083),a=h(a,i,r,n,e[o+15],14,-660478335),n=h(n,a,i,r,e[o+4],20,-405537848),r=h(r,n,a,i,e[o+9],5,568446438),i=h(i,r,n,a,e[o+14],9,-1019803690),a=h(a,i,r,n,e[o+3],14,-187363961),n=h(n,a,i,r,e[o+8],20,1163531501),r=h(r,n,a,i,e[o+13],5,-1444681467),i=h(i,r,n,a,e[o+2],9,-51403784),a=h(a,i,r,n,e[o+7],14,1735328473),n=h(n,a,i,r,e[o+12],20,-1926607734),r=g(r,n,a,i,e[o+5],4,-378558),i=g(i,r,n,a,e[o+8],11,-2022574463),a=g(a,i,r,n,e[o+11],16,1839030562),n=g(n,a,i,r,e[o+14],23,-35309556),r=g(r,n,a,i,e[o+1],4,-1530992060),i=g(i,r,n,a,e[o+4],11,1272893353),a=g(a,i,r,n,e[o+7],16,-155497632),n=g(n,a,i,r,e[o+10],23,-1094730640),r=g(r,n,a,i,e[o+13],4,681279174),i=g(i,r,n,a,e[o],11,-358537222),a=g(a,i,r,n,e[o+3],16,-722521979),n=g(n,a,i,r,e[o+6],23,76029189),r=g(r,n,a,i,e[o+9],4,-640364487),i=g(i,r,n,a,e[o+12],11,-421815835),a=g(a,i,r,n,e[o+15],16,530742520),n=g(n,a,i,r,e[o+2],23,-995338651),r=m(r,n,a,i,e[o],6,-198630844),i=m(i,r,n,a,e[o+7],10,1126891415),a=m(a,i,r,n,e[o+14],15,-1416354905),n=m(n,a,i,r,e[o+5],21,-57434055),r=m(r,n,a,i,e[o+12],6,1700485571),i=m(i,r,n,a,e[o+3],10,-1894986606),a=m(a,i,r,n,e[o+10],15,-1051523),n=m(n,a,i,r,e[o+1],21,-2054922799),r=m(r,n,a,i,e[o+8],6,1873313359),i=m(i,r,n,a,e[o+15],10,-30611744),a=m(a,i,r,n,e[o+6],15,-1560198380),n=m(n,a,i,r,e[o+13],21,1309151649),r=m(r,n,a,i,e[o+4],6,-145523070),i=m(i,r,n,a,e[o+11],10,-1120210379),a=m(a,i,r,n,e[o+2],15,718787259),n=m(n,a,i,r,e[o+9],21,-343485551),r=f(r,s),n=f(n,l),a=f(a,c),i=f(i,u)}return[r,n,a,i]}(function(e){if(0===e.length)return[];for(var t=8*e.length,r=new Uint32Array(d(t)),n=0;n<t;n+=8)r[n>>5]|=(255&e[n/8])<<n%32;return r}(e),8*e.length),a=[],i=32*n.length,o="0123456789abcdef",s=0;s<i;s+=8){var l=n[s>>5]>>>s%32&255,l=parseInt(o.charAt(l>>>4&15)+o.charAt(15&l),16);a.push(l)}return a}),Kt;function d(e){return 14+(e+64>>>9<<4)+1}function f(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function s(e,t,r,n,a,i){return f((t=f(f(t,e),f(n,i)))<<a|t>>>32-a,r)}function p(e,t,r,n,a,i,o){return s(t&r|~t&n,e,t,a,i,o)}function h(e,t,r,n,a,i,o){return s(t&n|r&~n,e,t,a,i,o)}function g(e,t,r,n,a,i,o){return s(t^r^n,e,t,a,i,o)}function m(e,t,r,n,a,i,o){return s(r^(t|~n),e,t,a,i,o)}}var Jt,Zt,Qt={},Xt={};function er(){var i,e,o,s;return Zt||(Zt=1,Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.default=void 0,i=t((Jt||(Jt=1,Object.defineProperty(Xt,"__esModule",{value:!0}),Xt.default=void 0,e="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Xt.default={randomUUID:e}),Xt)),o=t(Ft()),s=Pt(),Qt.default=function(e,t,r){if(i.default.randomUUID&&!t&&!e)return i.default.randomUUID();var n=(e=e||{}).random||(e.rng||o.default)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var a=0;a<16;++a)t[r+a]=n[a];return t}return(0,s.unsafeStringify)(n)}),Qt;function t(e){return e&&e.__esModule?e:{default:e}}}var tr,rr,nr={},ar={};function ir(){return tr||(tr=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.default=void 0,ar.default=function(e){var t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var n=unescape(encodeURIComponent(e));e=[];for(var a=0;a<n.length;++a)e.push(n.charCodeAt(a))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var i=e.length/4+2,o=Math.ceil(i/16),s=new Array(o),l=0;l<o;++l){for(var c=new Uint32Array(16),u=0;u<16;++u)c[u]=e[64*l+4*u]<<24|e[64*l+4*u+1]<<16|e[64*l+4*u+2]<<8|e[64*l+4*u+3];s[l]=c}s[o-1][14]=8*(e.length-1)/Math.pow(2,32),s[o-1][14]=Math.floor(s[o-1][14]),s[o-1][15]=8*(e.length-1)&4294967295;for(var d=0;d<o;++d){for(var f=new Uint32Array(80),p=0;p<16;++p)f[p]=s[d][p];for(var h=16;h<80;++h)f[h]=E(f[h-3]^f[h-8]^f[h-14]^f[h-16],1);for(var g=r[0],m=r[1],_=r[2],y=r[3],T=r[4],b=0;b<80;++b)var v=Math.floor(b/20),v=E(g,5)+function(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:return t^r^n;case 2:return t&r^t&n^r&n;case 3:return t^r^n}}(v,m,_,y)+T+t[v]+f[b]>>>0,T=y,y=_,_=E(m,30)>>>0,m=g,g=v;r[0]=r[0]+g>>>0,r[1]=r[1]+m>>>0,r[2]=r[2]+_>>>0,r[3]=r[3]+y>>>0,r[4]=r[4]+T>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]}),ar;function E(e,t){return e<<t|e>>>32-t}}var cr,ur={};function dr(){var i,o,s;return cr||(cr=1,Object.defineProperty(ur,"__esModule",{value:!0}),ur.default=function(e={},t,r=0){var n=(0,o.default)(l(l({},e),{},{_v6:!0}),new Uint8Array(16));if(n=(0,s.default)(n),t){for(var a=0;a<16;a++)t[r+a]=n[a];return t}return(0,i.unsafeStringify)(n)},i=Pt(),o=e(Ut()),s=e(Ht())),ur;function e(e){return e&&e.__esModule?e:{default:e}}function t(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function l(n){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?t(Object(a),!0).forEach(function(e){var t,r;t=n,r=a[e=e],(e=function(e){e=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):t(Object(a)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(a,e))})}return n}}var fr,pr={};function hr(){var r,e,n;return fr||(fr=1,Object.defineProperty(pr,"__esModule",{value:!0}),pr.default=function(e){var t=function(e){return Uint8Array.of((15&e[3])<<4|e[4]>>4&15,(15&e[4])<<4|(240&e[5])>>4,(15&e[5])<<4|15&e[6],e[7],(15&e[1])<<4|(240&e[2])>>4,(15&e[2])<<4|(240&e[3])>>4,16|(240&e[0])>>4,(15&e[0])<<4|(240&e[1])>>4,e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}("string"==typeof e?(0,r.default)(e):e);return"string"==typeof e?(0,n.unsafeStringify)(t):t},r=(e=wt())&&e.__esModule?e:{default:e},n=Pt()),pr}var gr,mr={};function _r(){var c,e,u,d,f,p;return gr||(gr=1,Object.defineProperty(mr,"__esModule",{value:!0}),mr.default=void 0,c=(e=Ft())&&e.__esModule?e:{default:e},u=Pt(),f=d=null,p=0,mr.default=function(e,t,r){e=e||{};var r=t&&r||0,n=t||new Uint8Array(16),a=e.random||(e.rng||c.default)(),i=void 0!==e.msecs?e.msecs:Date.now(),o=void 0!==e.seq?e.seq:null,s=f,l=d;return p<i&&void 0===e.msecs&&(p=i,null!==o)&&(l=s=null),null!==o&&(s=(o=2147483647<o?2147483647:o)>>>19&4095,l=524287&o),null!==s&&null!==l||(s=(s=127&a[6])<<8|a[7],l=(l=(l=63&a[8])<<8|a[9])<<5|a[10]>>>3),p<i+1e4&&null===o?524287<++l&&(l=0,4095<++s)&&(s=0,p++):p=i,f=s,d=l,n[r++]=p/1099511627776&255,n[r++]=p/4294967296&255,n[r++]=p/16777216&255,n[r++]=p/65536&255,n[r++]=p/256&255,n[r++]=255&p,n[r++]=s>>>4&15|112,n[r++]=255&s,n[r++]=l>>>13&63|128,n[r++]=l>>>5&255,n[r++]=l<<3&255|7&a[10],n[r++]=a[11],n[r++]=a[12],n[r++]=a[13],n[r++]=a[14],n[+r]=a[15],t||(0,u.unsafeStringify)(n)}),mr}var yr,Tr,br={};function vr(){var t,e;return yr||(yr=1,Object.defineProperty(br,"__esModule",{value:!0}),br.default=void 0,t=(e=kt())&&e.__esModule?e:{default:e},br.default=function(e){if((0,t.default)(e))return parseInt(e.slice(14,15),16);throw TypeError("Invalid UUID")}),br}function Er(){var e,t,r,n,a,i,o,s,l,c,u,d,f,p,h,g;return Tr||(Tr=1,e=_t,Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"MAX",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(e,"NIL",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(e,"parse",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"v1",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"v1ToV6",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"v3",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"v4",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(e,"v5",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(e,"v6",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(e,"v6ToV1",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(e,"v7",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(e,"validate",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return g.default}}),t=y((ht||(ht=1,Object.defineProperty(yt,"__esModule",{value:!0}),yt.default=void 0,yt.default="ffffffff-ffff-ffff-ffff-ffffffffffff"),yt)),r=y((Tt||(Tt=1,Object.defineProperty(bt,"__esModule",{value:!0}),bt.default=void 0,bt.default="00000000-0000-0000-0000-000000000000"),bt)),n=y(wt()),a=y(Pt()),i=y(Ut()),o=y(Ht()),s=y((zt||(zt=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.default=void 0,e=m(qt()),l=m(Yt()),e=(0,e.default)("v3",48,l.default),Vt.default=e),Vt)),c=y(er()),u=y((rr||(rr=1,Object.defineProperty(nr,"__esModule",{value:!0}),nr.default=void 0,l=_(qt()),e=_(ir()),l=(0,l.default)("v5",80,e.default),nr.default=l),nr)),d=y(dr()),f=y(hr()),p=y(_r()),h=y(kt()),g=y(vr())),_t;function m(e){return e&&e.__esModule?e:{default:e}}function _(e){return e&&e.__esModule?e:{default:e}}function y(e){return e&&e.__esModule?e:{default:e}}}var Sr,Ar={};function Or(){if(!Sr){Sr=1,Object.defineProperty(Ar,"__esModule",{value:!0}),Ar.Registry=Ar.RegistryError=void 0;class r extends Error{constructor(e){super(e),this.name=this.constructor.name}}Ar.RegistryError=r;Ar.Registry=class e{key;registry;static kindRegistry(){return new e(e=>e.kind)}constructor(e){this.registry=new Map,this.key=e}register(e){const t=this.key(e);if(this.registry.has(t))throw new r(`Registrant ${t} already exists in the registry`);return this.registry.set(t,e),{[Symbol.dispose]:()=>this.registry.delete(t)}}has(e){return this.registry.has(e)}get(e){var t=this.registry.get(e);if(void 0===t)throw new r(e+" has not been registered.");return t}tryGet(e){return this.registry.get(e)}*values(){yield*this.registry.values()}valuesAsArray(){return Array.from(this.values())}unregisterAllForTesting(){this.registry.clear()}}}return Ar}var Cr,kr={},wr={};function Rr(){if(!Cr){Cr=1,Object.defineProperty(wr,"__esModule",{value:!0}),wr.BigintMath=void 0;class r{static INT64_MAX=2n**63n-1n;static INT64_MIN=-(2n**63n);static bitCeil(e){let t=1n;for(;t<e;)t<<=1n;return t}static bitFloor(e){let t=1n;for(;t<<1n<=e;)t<<=1n;return t}static log2(e){let t=1n,r=0;for(;t<<1n<=e;)t<<=1n,++r;return r}static quant(e,t){return(t=r.max(1n,t))*((e+t/2n)/t)}static quantFloor(e,t){return t=r.max(1n,t),0<=e?e-e%t:e-e%t-(e%t===0n?0n:t)}static quantCeil(e,t){return t=r.max(1n,t),0<=e?e-e%t+(e%t===0n?0n:t):e-e%t}static max(e,t){return t<e?e:t}static min(e,t){return e<t?e:t}static popcount(e){if(e<0n)throw Error("Can't get popcount of negative number "+e);let t=0;for(;e;)1n&e&&++t,e>>=1n;return t}static ratio(e,t){return Number(e)/Number(t)}static abs(e){return e<0n?-1n*e:e}}wr.BigintMath=r}return wr}var Ir,Mr={},Pr={};function Nr(){return Ir||(Ir=1,Object.defineProperty(Pr,"__esModule",{value:!0}),Pr.SCM_REVISION=Pr.VERSION=void 0,Pr.VERSION="v47.0-02b2414d5",Pr.SCM_REVISION="02b2414d5cefce49f68cd71de96eac5fe793af44"),Pr}var Dr,xr,Lr,Fr={};function z(){return Dr||(Dr=1,Object.defineProperty(Fr,"__esModule",{value:!0}),Fr.exists=function(e){return null!=e}),Fr}function ee(){if(!xr){xr=1,Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.assertExists=function(e){if(null!=e)return e;throw new Error("Value doesn't exist")},Mr.assertTrue=r,Mr.assertFalse=function(e,t){r(!e,t)},Mr.addErrorHandler=function(e){f.includes(e)||f.push(e)},Mr.reportError=function(t){let r=void 0,n="",e;var a=[],i=location.protocol+"//"+location.host;t instanceof ErrorEvent?(e="ERROR",r=null===t.error||void 0===t.error?(s=(""+t.message).split("\n"),n=s[0],{stack:s.slice(1).join("\n")}):(n=""+t.error,t.error)):t instanceof PromiseRejectionEvent?(e="PROMISE_REJ",n=""+t.reason,r=t.reason):(e="OTHER",n=""+t);if(n=(n=(n=n.replace(/^Uncaught Error:/,"")).replace(/^Error:/,"")).trim(),void 0!==r&&null!==r){var o,s=r.stack;let e=void 0!==s?""+s:"";for(o of(e=e.replaceAll(/\r/g,"")).split("\n"))if(!n.includes(o)){var l=(o=(o=o.replace(/^\s*at\s*/,"")).replace(/\s*\(([^)]+)\)$/,"@$1")).lastIndexOf("@");let e="",t="";0<=l?(t=o.substring(l+1),e=o.substring(0,l)):t=o,t.includes(i)&&(t=(t=t.replace(i,"")).replace(`/${u.VERSION}/`,"")),a.push({name:e,location:t})}t=a.find(e=>e.name.includes("perfetto::"))?.name;n.includes("RuntimeError")&&(0,d.exists)(t)&&(n+=" @ "+t.trim())}for(const c of f)c({errType:e,message:n,stack:a})},Mr.assertUnreachable=function(e){throw new Error("This code should not be reachable "+e)};const u=Nr(),d=z(),f=[];function r(e,t){if(!e)throw new Error(t??"Failed assertion")}}return Mr}function K(){if(Lr)return kr;Lr=1,Object.defineProperty(kr,"__esModule",{value:!0}),kr.TimeSpan=kr.Timecode=kr.Duration=kr.Time=void 0,kr.currentDateHourAndMinute=function(){var e=new Date;return`${e.toISOString().substr(0,10)}-${e.getHours()}-`+e.getMinutes()},kr.toISODateOnly=function(e){var t=e.getUTCFullYear(),r=String(e.getUTCMonth()+1).padStart(2,"0"),e=String(e.getUTCDate()).padStart(2,"0");return t+`-${r}-`+e};const s=Rr(),r=ee();class n{static INVALID=n.fromRaw(-1n);static MIN=n.fromRaw(0n);static MAX=n.fromRaw(s.BigintMath.INT64_MAX);static ZERO=n.fromRaw(0n);static fromRaw(e){return e}static fromSeconds(e){return n.fromRaw(BigInt(Math.floor(1e9*e)))}static toSeconds(e){return Number(e)/1e9}static fromMillis(e){return n.fromRaw(BigInt(Math.floor(1e6*e)))}static toMillis(e){return Number(e)/1e6}static fromDate(e,t){e=e.getTime(),e=n.fromMillis(e);return n.add(e,t)}static toDate(e,t){e=n.sub(e,t),t=n.toMillis(e);return new Date(t)}static getLatestMidnight(e,t){e=n.toDate(e,t),e=new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()));return n.fromDate(e,t)}static add(e,t){return n.fromRaw(e+t)}static sub(e,t){return n.fromRaw(e-t)}static diff(e,t){return e-t}static min(e,t){return n.fromRaw(s.BigintMath.min(e,t))}static max(e,t){return n.fromRaw(s.BigintMath.max(e,t))}static quantFloor(e,t){return n.fromRaw(s.BigintMath.quantFloor(e,t))}static quantCeil(e,t){return n.fromRaw(s.BigintMath.quantCeil(e,t))}static quant(e,t){return n.fromRaw(s.BigintMath.quant(e,t))}static formatSeconds(e){return n.toSeconds(e).toString()+" s"}static toTimecode(e){return new t(e)}}kr.Time=n;class i{static MIN=s.BigintMath.INT64_MIN;static MAX=s.BigintMath.INT64_MAX;static ZERO=0n;static fromRaw(e){return e}static min(e,t){return s.BigintMath.min(e,t)}static max(e,t){return s.BigintMath.max(e,t)}static fromMillis(e){return BigInt(Math.floor(e/1e3*1e9))}static toSeconds(e){return Number(e)/1e9}static humanise(e){var e=i.toSeconds(e),t=["s","ms","us","ns"],r=Math.sign(e);let n=Math.abs(e),a=0;for(;n<1&&0!==n&&a<t.length-1;)n*=1e3,a++;return(r<0?"-":"")+Math.round(10*n)/10+t[a]}static format(n){let a="";return n<1?"0s":([["h",3600000000000n],["m",60000000000n],["s",1000000000n],["ms",1000000n],["us",1000n],["ns",1n]].forEach(([e,t])=>{var r;t<=n&&(r=n/t,a+=r.toLocaleString()+e+" ",n%=t)}),a.slice(0,-1))}static formatSeconds(e){return i.toSeconds(e).toString()+" s"}}kr.Duration=i;class t{sign;days;hours;minutes;seconds;millis;micros;nanos;constructor(e){this.sign=e<0?"-":"";var e=s.BigintMath.abs(e),t=e/86400000000000n,r=e/3600000000000n%24n,n=e/60000000000n%60n,a=e/1000000000n%60n,i=e/1000000n%1000n,o=e/1000n%1000n,e=e%1000n;this.days=t.toString(),this.hours=r.toString().padStart(2,"0"),this.minutes=n.toString().padStart(2,"0"),this.seconds=a.toString().padStart(2,"0"),this.millis=i.toString().padStart(3,"0"),this.micros=o.toString().padStart(3,"0"),this.nanos=e.toString().padStart(3,"0")}get dhhmmss(){var e="0"===this.days?"":this.days+"d";return this.sign+e+this.hours+`:${this.minutes}:`+this.seconds}subsec(e=" "){return""+this.millis+e+this.micros+e+this.nanos}toString(e=" "){return this.dhhmmss+"."+this.subsec(e)}}kr.Timecode=t;class a{static ZERO=new a(n.ZERO,n.ZERO);start;end;constructor(e,t){(0,r.assertTrue)(e<=t,`Span start [${e}] cannot be greater than end [${t}]`),this.start=e,this.end=t}static fromTimeAndDuration(e,t){return new a(e,n.add(e,t))}get duration(){return this.end-this.start}get midpoint(){return n.fromRaw((this.start+this.end)/2n)}contains(e){return this.start<=e&&e<this.end}containsSpan(e,t){return this.start<=e&&t<=this.end}overlaps(e,t){return!(t<=this.start||e>=this.end)}equals(e){return this.start===e.start&&this.end===e.end}translate(e){return new a(n.add(this.start,e),n.add(this.end,e))}pad(e){return new a(n.sub(this.start,e),n.add(this.end,e))}}return kr.TimeSpan=a,kr}var Ur,Br,jr={},Hr={},Gr={};function te(){if(!Ur){Ur=1,Object.defineProperty(Gr,"__esModule",{value:!0}),Gr.getPath=function(e,t){let r=e;for(const n of t){if(void 0===r)return;r=r[n]}return r},Gr.setPath=function(e,t,r){var n=[...t];let a=e;for(;1<n.length;){const i=(0,o.assertExists)(n.shift());a=a[i]}const i=n.shift();if(!(0,s.exists)(i))throw TypeError("Path array is empty");a[i]=r},Gr.shallowEquals=function(e,t){if(e!==t){if(void 0===e||void 0===t)return!1;if(null===e||null===t)return!1;var r=e,n=t;for(const a of Object.keys(r))if(r[a]!==n[a])return!1;for(const i of Object.keys(n))if(r[i]!==n[i])return!1}return!0},Gr.isString=function(e){return"string"==typeof e||e instanceof String},Gr.isEnumValue=function(e,t){return Object.values(e).includes(t)};const o=ee(),s=z()}return Gr}function Vr(){if(Br)return Hr;Br=1,Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.createStore=function(e){return new t(e)};const n=_e(),a=te();class t{internalState;subscriptions=new Set;constructor(e){this.internalState=(0,n.produce)(e,()=>{})}get state(){return this.internalState}edit(e){Array.isArray(e)?this.applyEdits(e):this.applyEdits([e])}applyEdits(e){const t=this.internalState;e=e.reduce((e,t)=>(0,n.produce)(e,t),t);this.internalState=e,this.subscriptions.forEach(e=>{e(this,t)})}createSubStore(e,t){return new r(this,e,t)}subscribe(e){return this.subscriptions.add(e),{[Symbol.dispose]:()=>{this.subscriptions.delete(e)}}}[Symbol.dispose](){}}class r{parentStore;path;migrate;parentState;cachedState;parentStoreSubscription;subscriptions=new Set;constructor(e,t,r){this.parentStore=e,this.path=t,this.migrate=r,this.parentState=(0,a.getPath)(this.parentStore.state,this.path),this.cachedState=(0,n.produce)(r(this.parentState),()=>{}),this.parentStoreSubscription=this.parentStore.subscribe(()=>{(0,a.getPath)(this.parentStore.state,this.path)!==this.parentState&&this.subscriptions.forEach(e=>{e(this,this.cachedState)})})}get state(){const e=(0,a.getPath)(this.parentStore.state,this.path);return this.parentState===e?this.cachedState:(this.parentState=e,this.cachedState=(0,n.produce)(this.cachedState,()=>this.migrate(e)))}edit(e){Array.isArray(e)?this.applyEdits(e):this.applyEdits([e])}applyEdits(e){const t=this.cachedState,r=e.reduce((e,t)=>(0,n.produce)(e,t),t);this.parentState=r;try{this.parentStore.edit(e=>{(0,a.setPath)(e,this.path,r)})}catch(e){if(!(e instanceof TypeError))throw e;console.warn("Failed to update parent store at ",this.path)}this.cachedState=r,this.subscriptions.forEach(e=>{e(this,t)})}createSubStore(e,t){return new r(this,e,t)}subscribe(e){return this.subscriptions.add(e),{[Symbol.dispose]:()=>{this.subscriptions.delete(e)}}}[Symbol.dispose](){this.parentStoreSubscription[Symbol.dispose]()}}return Hr}var Wr,qr,$r,zr,Kr,Yr,Jr,Zr,Qr={},Xr={};function en(){if(!zr){zr=1;qr||(qr=1,Wr={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]});const o=Wr,s={};for(const r of Object.keys(o))s[o[r]]=r;const l={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};$r=l;for(const n of Object.keys(l)){if(!("channels"in l[n]))throw new Error("missing channels property: "+n);if(!("labels"in l[n]))throw new Error("missing channel labels property: "+n);if(l[n].labels.length!==l[n].channels)throw new Error("channel and label counts mismatch: "+n);var{channels:e,labels:t}=l[n];delete l[n].channels,delete l[n].labels,Object.defineProperty(l[n],"channels",{value:e}),Object.defineProperty(l[n],"labels",{value:t})}l.rgb.hsl=function(e){var t=e[0]/255,r=e[1]/255,e=e[2]/255,n=Math.min(t,r,e),a=Math.max(t,r,e),i=a-n;let o,s;a===n?o=0:t===a?o=(r-e)/i:r===a?o=2+(e-t)/i:e===a&&(o=4+(t-r)/i),(o=Math.min(60*o,360))<0&&(o+=360);e=(n+a)/2;return s=a===n?0:e<=.5?i/(a+n):i/(2-a-n),[o,100*s,100*e]},l.rgb.hsv=function(e){var t,r,n;let a,i;var o=e[0]/255,s=e[1]/255,e=e[2]/255;const l=Math.max(o,s,e),c=l-Math.min(o,s,e);function u(e){return(l-e)/6/c+.5}return 0===c?(a=0,i=0):(i=c/l,t=u(o),r=u(s),n=u(e),o===l?a=n-r:s===l?a=1/3+t-n:e===l&&(a=2/3+r-t),a<0?a+=1:1<a&&--a),[360*a,100*i,100*l]},l.rgb.hwb=function(e){var t=e[0],r=e[1],n=e[2];return[l.rgb.hsl(e)[0],100*(1/255*Math.min(t,Math.min(r,n))),100*(1-1/255*Math.max(t,Math.max(r,n)))]},l.rgb.cmyk=function(e){var t=e[0]/255,r=e[1]/255,e=e[2]/255,n=Math.min(1-t,1-r,1-e);return[100*((1-t-n)/(1-n)||0),100*((1-r-n)/(1-n)||0),100*((1-e-n)/(1-n)||0),100*n]},l.rgb.keyword=function(e){var t=s[e];if(t)return t;let r=1/0,n;for(const i of Object.keys(o)){var a=o[i],a=(e[0]-a[0])**2+(e[1]-a[1])**2+(e[2]-a[2])**2;a<r&&(r=a,n=i)}return n},l.keyword.rgb=function(e){return o[e]},l.rgb.xyz=function(e){var t=e[0]/255,r=e[1]/255,e=e[2]/255;return[100*(.4124*(t=.04045<t?((.055+t)/1.055)**2.4:t/12.92)+.3576*(r=.04045<r?((.055+r)/1.055)**2.4:r/12.92)+.1805*(e=.04045<e?((.055+e)/1.055)**2.4:e/12.92)),100*(.2126*t+.7152*r+.0722*e),100*(.0193*t+.1192*r+.9505*e)]},l.rgb.lab=function(e){var e=l.rgb.xyz(e),t=e[0],r=e[1],e=e[2];return[116*(r=.008856<(r/=100)?r**(1/3):7.787*r+16/116)-16,500*((.008856<(t/=95.047)?t**(1/3):7.787*t+16/116)-r),200*(r-(.008856<(e/=108.883)?e**(1/3):7.787*e+16/116))]},l.hsl.rgb=function(e){var t=e[0]/360,r=e[1]/100,e=e[2]/100;let n,a,i;if(0==r)return[i=255*e,i,i];var o=2*e-(n=e<.5?e*(1+r):e+r-e*r),s=[0,0,0];for(let e=0;e<3;e++)(a=t+1/3*-(e-1))<0&&a++,1<a&&a--,i=6*a<1?o+6*(n-o)*a:2*a<1?n:3*a<2?o+(n-o)*(2/3-a)*6:o,s[e]=255*i;return s},l.hsl.hsv=function(e){var t=e[0],r=e[1]/100,e=e[2]/100,n=r,a=Math.max(e,.01),i=(n*=a<=1?a:2-a,((e*=2)+(r*=e<=1?e:2-e))/2);return[t,100*(0==e?2*n/(a+n):2*r/(e+r)),100*i]},l.hsv.rgb=function(e){var t=e[0]/60,r=e[1]/100,n=e[2]/100,e=Math.floor(t)%6,t=t-Math.floor(t),a=255*n*(1-r),i=255*n*(1-r*t),o=255*n*(1-r*(1-t));switch(n*=255,e){case 0:return[n,o,a];case 1:return[i,n,a];case 2:return[a,n,o];case 3:return[a,i,n];case 4:return[o,a,n];case 5:return[n,a,i]}},l.hsv.hsl=function(e){var t=e[0],r=e[1]/100,e=e[2]/100,n=Math.max(e,.01),e=(2-r)*e,a=(2-r)*n,r=r*n;return[t,100*((r/=a<=1?a:2-a)||0),100*(e/=2)]},l.hwb.rgb=function(e){var t=e[0]/360;let r=e[1]/100,n=e[2]/100;e=r+n;let a;1<e&&(r/=e,n/=e);var e=Math.floor(6*t),i=1-n,o=(a=6*t-e,0!=(1&e)&&(a=1-a),r+a*(i-r));let s,l,c;switch(e){default:case 6:case 0:s=i,l=o,c=r;break;case 1:s=o,l=i,c=r;break;case 2:s=r,l=i,c=o;break;case 3:s=r,l=o,c=i;break;case 4:s=o,l=r,c=i;break;case 5:s=i,l=r,c=o}return[255*s,255*l,255*c]},l.cmyk.rgb=function(e){var t=e[0]/100,r=e[1]/100,n=e[2]/100,e=e[3]/100;return[255*(1-Math.min(1,t*(1-e)+e)),255*(1-Math.min(1,r*(1-e)+e)),255*(1-Math.min(1,n*(1-e)+e))]},l.xyz.rgb=function(e){var t=e[0]/100,r=e[1]/100,e=e[2]/100,n=3.2406*t+-1.5372*r+-.4986*e,a=-.9689*t+1.8758*r+.0415*e,t=.0557*t+-.204*r+1.057*e;return a=.0031308<a?1.055*a**(1/2.4)-.055:12.92*a,t=.0031308<t?1.055*t**(1/2.4)-.055:12.92*t,[255*Math.min(Math.max(0,.0031308<n?1.055*n**(1/2.4)-.055:12.92*n),1),255*Math.min(Math.max(0,a),1),255*Math.min(Math.max(0,t),1)]},l.xyz.lab=function(e){var t=e[0],r=e[1],e=e[2];return[116*(r=.008856<(r/=100)?r**(1/3):7.787*r+16/116)-16,500*((.008856<(t/=95.047)?t**(1/3):7.787*t+16/116)-r),200*(r-(.008856<(e/=108.883)?e**(1/3):7.787*e+16/116))]},l.lab.xyz=function(e){var t=(e[0]+16)/116,r=e[1]/500+t,e=t-e[2]/200,n=t**3,a=r**3,i=e**3;return t=.008856<n?n:(t-16/116)/7.787,r=.008856<a?a:(r-16/116)/7.787,e=.008856<i?i:(e-16/116)/7.787,[r*=95.047,t*=100,e*=108.883]},l.lab.lch=function(e){var t=e[0],r=e[1],e=e[2];let n;var a=Math.atan2(e,r),a=((n=360*a/2/Math.PI)<0&&(n+=360),Math.sqrt(r*r+e*e));return[t,a,n]},l.lch.lab=function(e){var t=e[0],r=e[1],e=e[2]/360*2*Math.PI;return[t,r*Math.cos(e),r*Math.sin(e)]},l.rgb.ansi16=function(e,t=null){var[r,n,a]=e,e=null===t?l.rgb.hsv(e)[2]:t;if(0===(e=Math.round(e/50)))return 30;let i=30+(Math.round(a/255)<<2|Math.round(n/255)<<1|Math.round(r/255));return 2===e&&(i+=60),i},l.hsv.ansi16=function(e){return l.rgb.ansi16(l.hsv.rgb(e),e[2])},l.rgb.ansi256=function(e){var t=e[0],r=e[1],e=e[2];return t===r&&r===e?t<8?16:248<t?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(r/255*5)+Math.round(e/255*5)},l.ansi16.rgb=function(e){let t=e%10;return 0===t||7===t?(50<e&&(t+=3.5),[t=t/10.5*255,t,t]):(e=.5*(1+~~(50<e)),[(1&t)*e*255,(t>>1&1)*e*255,(t>>2&1)*e*255])},l.ansi256.rgb=function(e){var t;return 232<=e?[t=10*(e-232)+8,t,t]:(e-=16,[Math.floor(e/36)/5*255,Math.floor((t=e%36)/6)/5*255,t%6/5*255])},l.rgb.hex=function(e){e=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(e.length)+e},l.hex.rgb=function(e){e=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!e)return[0,0,0];let t=e[0];3===e[0].length&&(t=t.split("").map(e=>e+e).join(""));e=parseInt(t,16);return[e>>16&255,e>>8&255,255&e]},l.rgb.hcg=function(e){var t=e[0]/255,r=e[1]/255,e=e[2]/255,n=Math.max(Math.max(t,r),e),a=Math.min(Math.min(t,r),e),i=n-a;let o,s;return o=i<1?a/(1-i):0,[360*(s=(s=i<=0?0:n===t?(r-e)/i%6:n===r?2+(e-t)/i:4+(t-r)/i)/6%1),100*i,100*o]},l.hsl.hcg=function(e){var t=e[1]/100,r=e[2]/100,t=r<.5?2*t*r:2*t*(1-r);let n=t<1?(r-.5*t)/(1-t):0;return[e[0],100*t,100*n]},l.hsv.hcg=function(e){var t=e[1]/100,r=e[2]/100,t=t*r;let n=t<1?(r-t)/(1-t):0;return[e[0],100*t,100*n]},l.hcg.rgb=function(e){var t=e[0]/360,r=e[1]/100,e=e[2]/100;if(0==r)return[255*e,255*e,255*e];var n=[0,0,0],t=t%1*6,a=t%1,i=1-a;switch(Math.floor(t)){case 0:n[0]=1,n[1]=a,n[2]=0;break;case 1:n[0]=i,n[1]=1,n[2]=0;break;case 2:n[0]=0,n[1]=1,n[2]=a;break;case 3:n[0]=0,n[1]=i,n[2]=1;break;case 4:n[0]=a,n[1]=0,n[2]=1;break;default:n[0]=1,n[1]=0,n[2]=i}return[255*(r*n[0]+(t=(1-r)*e)),255*(r*n[1]+t),255*(r*n[2]+t)]},l.hcg.hsv=function(e){var t=e[1]/100,r=t+e[2]/100*(1-t);let n=0<r?t/r:0;return[e[0],100*n,100*r]},l.hcg.hsl=function(e){var t=e[1]/100,r=e[2]/100*(1-t)+.5*t;let n=0;return 0<r&&r<.5?n=t/(2*r):.5<=r&&r<1&&(n=t/(2*(1-r))),[e[0],100*n,100*r]},l.hcg.hwb=function(e){var t=e[1]/100,r=t+e[2]/100*(1-t);return[e[0],100*(r-t),100*(1-r)]},l.hwb.hcg=function(e){var t=e[1]/100,r=1-e[2]/100,t=r-t;let n=t<1?(r-t)/(1-t):0;return[e[0],100*t,100*n]},l.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},l.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},l.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},l.gray.hsl=function(e){return[0,0,e[0]]},l.gray.hsv=l.gray.hsl,l.gray.hwb=function(e){return[0,100,e[0]]},l.gray.cmyk=function(e){return[0,0,0,e[0]]},l.gray.lab=function(e){return[e[0],0,0]},l.gray.hex=function(e){e=255&Math.round(e[0]/100*255),e=((e<<16)+(e<<8)+e).toString(16).toUpperCase();return"000000".substring(e.length)+e},l.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}}return $r}function tn(){if(!Yr){Yr=1;const l=en();function t(e){var r=function(){var r={},n=Object.keys(l);for(let e=n.length,t=0;t<e;t++)r[n[t]]={distance:-1,parent:null};return r}(),n=[e];for(r[e].distance=0;n.length;){var a=n.pop(),i=Object.keys(l[a]);for(let e=i.length,t=0;t<e;t++){var o=i[t],s=r[o];-1===s.distance&&(s.distance=r[a].distance+1,s.parent=a,n.unshift(o))}}return r}function o(e,t){var r=[t[e].parent,e];let n=l[t[e].parent][e],a=t[e].parent;for(;t[a].parent;)r.unshift(t[a].parent),n=function(t,r){return function(e){return r(t(e))}}(l[t[a].parent][a],n),a=t[a].parent;return n.conversion=r,n}Kr=function(e){var r=t(e),n={},a=Object.keys(r);for(let e=a.length,t=0;t<e;t++){var i=a[t];null!==r[i].parent&&(n[i]=o(i,r))}return n}}return Kr}function rn(){if(!Zr){Zr=1;const e=en(),t=tn(),o={};function a(r){function e(...e){var t=e[0];return null==t?t:(1<t.length&&(e=t),r(e))}return"conversion"in r&&(e.conversion=r.conversion),e}function i(n){function e(...e){var t=e[0];if(null==t)return t;1<t.length&&(e=t);var r=n(e);if("object"==typeof r)for(let e=r.length,t=0;t<e;t++)r[t]=Math.round(r[t]);return r}return"conversion"in n&&(e.conversion=n.conversion),e}Object.keys(e).forEach(r=>{o[r]={},Object.defineProperty(o[r],"channels",{value:e[r].channels}),Object.defineProperty(o[r],"labels",{value:e[r].labels});const n=t(r);Object.keys(n).forEach(e=>{var t=n[e];o[r][e]=i(t),o[r][e].raw=a(t)})}),Jr=o}return Jr}var nn,an={};function on(){return nn||(nn=1,Object.defineProperty(an,"__esModule",{value:!0}),an.hash=function(t,e){let r=18652613;for(let e=0;e<t.length;e++)r=16777619*(r^=t.charCodeAt(e))&4294967295;return Math.abs(r)%e}),an}var sn,ln={};function re(){if(!sn){sn=1;{var e=ln;var n,t;Object.defineProperty(e,"__esModule",{value:!0}),e.RECORDING_V2_FLAG=e.featureFlags=e.FlagsForTesting=e.OverrideState=void 0,(t=n||(e.OverrideState=n={})).DEFAULT="DEFAULT",t.TRUE="OVERRIDE_TRUE",t.FALSE="OVERRIDE_FALSE";class r{store;flags;overrides;constructor(e){this.store=e,this.flags=new Map,this.overrides={},this.load()}register(e){var t=e.id;if(this.flags.has(t))throw new Error(`Flag with id "${t}" is already registered.`);var r=this.overrides[t],r=void 0===r?n.DEFAULT:r,r=new a(this,r,e);return this.flags.set(t,r),r}allFlags(){const t=["127.0.0.1","::1","localhost"].includes(window.location.hostname);let e=[...this.flags.values()];return(e=e.filter(e=>t||!e.devOnly)).sort((e,t)=>e.name.localeCompare(t.name)),e}resetAll(){for(const e of this.flags.values())e.state=n.DEFAULT;this.save()}load(){var e=this.store.load();!function(e){var t=[n.TRUE.toString(),n.FALSE.toString()];for(const r of Object.values(e))if("string"!=typeof r||!t.includes(r))return;return 1}(e)||(this.overrides=e)}save(){for(const e of this.flags.values())e.isOverridden()?this.overrides[e.id]=e.state:delete this.overrides[e.id];this.store.save(this.overrides)}}class a{registry;state;id;name;description;defaultValue;devOnly;constructor(e,t,r){this.registry=e,this.id=r.id,this.state=t,this.description=r.description,this.defaultValue=r.defaultValue,this.name=r.name??r.id,this.devOnly=r.devOnly||!1}get(){switch(this.state){case n.TRUE:return!0;case n.FALSE:return!1;default:n.DEFAULT;return this.defaultValue}}set(e){e=e?n.TRUE:n.FALSE;this.state!==e&&(this.state=e,this.registry.save())}overriddenState(){return this.state}reset(){this.state=n.DEFAULT,this.registry.save()}isOverridden(){return this.state!==n.DEFAULT}}e.FlagsForTesting=r,e.featureFlags=new r(new class i{static KEY="perfettoFeatureFlags";load(){var e=localStorage.getItem(i.KEY);let t;try{t=JSON.parse(e??"{}")}catch(e){return{}}return"object"!=typeof t||null===t?{}:t}save(e){e=JSON.stringify(e),localStorage.setItem(i.KEY,e)}}),e.RECORDING_V2_FLAG=e.featureFlags.register({id:"recordingv2",name:"Recording V2",description:"Record using V2 interface",defaultValue:!1})}}return ln}var cn,un,dn={};var fn,pn,hn,gn={};function mn(){if(!fn){fn=1,Object.defineProperty(gn,"__esModule",{value:!0}),gn.clamp=function(e,t,r){return Math.max(t,Math.min(r,e))},gn.floatEqual=function(e,t,r=n){return Math.abs(e-t)<r};const n=1e-9}return gn}function _n(){if(!pn){pn=1,Object.defineProperty(dn,"__esModule",{value:!0}),dn.HSLuvColor=dn.HSLColor=void 0,dn.hslToRgb=n,dn.hexToRgb=a,dn.rgbToHsl=i,dn.colorCompare=function(e,t){return e.cssString.localeCompare(t.cssString)};un||(un=1,(f={Geometry:function(){}}).Geometry.intersectLineLine=function(e,t){t=(e.intercept-t.intercept)/(t.slope-e.slope);return{x:t,y:e.slope*t+e.intercept}},f.Geometry.distanceFromOrigin=function(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))},f.Geometry.distanceLineFromOrigin=function(e){return Math.abs(e.intercept)/Math.sqrt(Math.pow(e.slope,2)+1)},f.Geometry.perpendicularThroughPoint=function(e,t){e=-1/e.slope;return{slope:e,intercept:t.y-e*t.x}},f.Geometry.angleFromOrigin=function(e){return Math.atan2(e.y,e.x)},f.Geometry.normalizeAngle=function(e){var t=2*Math.PI;return(e%t+t)%t},f.Geometry.lengthOfRayUntilIntersect=function(e,t){return t.intercept/(Math.sin(e)-t.slope*Math.cos(e))},f.Hsluv=function(){},f.Hsluv.getBounds=function(e){for(var t=[],r=Math.pow(e+16,3)/1560896,n=r>f.Hsluv.epsilon?r:e/f.Hsluv.kappa,a=0;a<3;)for(var i=a++,o=f.Hsluv.m[i][0],s=f.Hsluv.m[i][1],l=f.Hsluv.m[i][2],c=0;c<2;){var u=c++,d=(632260*l-126452*s)*n+126452*u;t.push({slope:(284517*o-94839*l)*n/d,intercept:((838422*l+769860*s+731718*o)*e*n-769860*u*e)/d})}return t},f.Hsluv.maxSafeChromaForL=function(e){for(var t=f.Hsluv.getBounds(e),r=1/0,n=0;n<t.length;)var a=t[n],a=(++n,f.Geometry.distanceLineFromOrigin(a)),r=Math.min(r,a);return r},f.Hsluv.maxChromaForLH=function(e,t){for(var r=t/360*Math.PI*2,n=f.Hsluv.getBounds(e),a=1/0,i=0;i<n.length;){var o=n[i],o=(++i,f.Geometry.lengthOfRayUntilIntersect(r,o));0<=o&&(a=Math.min(a,o))}return a},f.Hsluv.dotProduct=function(e,t){for(var r=0,n=0,a=e.length;n<a;){var i=n++;r+=e[i]*t[i]}return r},f.Hsluv.fromLinear=function(e){return e<=.0031308?12.92*e:1.055*Math.pow(e,.4166666666666667)-.055},f.Hsluv.toLinear=function(e){return.04045<e?Math.pow((e+.055)/1.055,2.4):e/12.92},f.Hsluv.xyzToRgb=function(e){return[f.Hsluv.fromLinear(f.Hsluv.dotProduct(f.Hsluv.m[0],e)),f.Hsluv.fromLinear(f.Hsluv.dotProduct(f.Hsluv.m[1],e)),f.Hsluv.fromLinear(f.Hsluv.dotProduct(f.Hsluv.m[2],e))]},f.Hsluv.rgbToXyz=function(e){e=[f.Hsluv.toLinear(e[0]),f.Hsluv.toLinear(e[1]),f.Hsluv.toLinear(e[2])];return[f.Hsluv.dotProduct(f.Hsluv.minv[0],e),f.Hsluv.dotProduct(f.Hsluv.minv[1],e),f.Hsluv.dotProduct(f.Hsluv.minv[2],e)]},f.Hsluv.yToL=function(e){return e<=f.Hsluv.epsilon?e/f.Hsluv.refY*f.Hsluv.kappa:116*Math.pow(e/f.Hsluv.refY,.3333333333333333)-16},f.Hsluv.lToY=function(e){return e<=8?f.Hsluv.refY*e/f.Hsluv.kappa:f.Hsluv.refY*Math.pow((e+16)/116,3)},f.Hsluv.xyzToLuv=function(e){var t=e[0],r=e[1],e=t+15*r+3*e[2],t=4*t,n=9*r,e=(0!=e?(t/=e,n/=e):n=t=NaN,f.Hsluv.yToL(r));return 0==e?[0,0,0]:[e,13*e*(t-f.Hsluv.refU),13*e*(n-f.Hsluv.refV)]},f.Hsluv.luvToXyz=function(e){var t=e[0],r=e[1],e=e[2];return 0==t?[0,0,0]:(r=r/(13*t)+f.Hsluv.refU,e=e/(13*t)+f.Hsluv.refV,[r=0-9*(t=f.Hsluv.lToY(t))*r/((r-4)*e-r*e),t,(9*t-15*e*t-e*r)/(3*e)])},f.Hsluv.luvToLch=function(e){var t,r=e[0],n=e[1],e=e[2],a=Math.sqrt(n*n+e*e);return a<1e-8?t=0:(t=180*Math.atan2(e,n)/Math.PI)<0&&(t=360+t),[r,a,t]},f.Hsluv.lchToLuv=function(e){var t=e[0],r=e[1],e=e[2]/360*2*Math.PI;return[t,Math.cos(e)*r,Math.sin(e)*r]},f.Hsluv.hsluvToLch=function(e){var t=e[0],r=e[1],e=e[2];return 99.9999999<e?[100,0,t]:e<1e-8?[0,0,t]:[e,f.Hsluv.maxChromaForLH(e,t)/100*r,t]},f.Hsluv.lchToHsluv=function(e){var t=e[0],r=e[1],e=e[2];return 99.9999999<t?[e,0,100]:t<1e-8?[e,0,0]:[e,r/f.Hsluv.maxChromaForLH(t,e)*100,t]},f.Hsluv.hpluvToLch=function(e){var t=e[0],r=e[1],e=e[2];return 99.9999999<e?[100,0,t]:e<1e-8?[0,0,t]:[e,f.Hsluv.maxSafeChromaForL(e)/100*r,t]},f.Hsluv.lchToHpluv=function(e){var t=e[0],r=e[1],e=e[2];return 99.9999999<t?[e,0,100]:t<1e-8?[e,0,0]:[e,r/f.Hsluv.maxSafeChromaForL(t)*100,t]},f.Hsluv.rgbToHex=function(e){for(var t="#",r=0;r<3;){var n=e[r++],n=Math.round(255*n),a=n%16;t+=f.Hsluv.hexChars.charAt((n-a)/16|0)+f.Hsluv.hexChars.charAt(a)}return t},f.Hsluv.hexToRgb=function(e){e=e.toLowerCase();for(var t=[],r=0;r<3;){var n=r++,a=f.Hsluv.hexChars.indexOf(e.charAt(2*n+1)),n=f.Hsluv.hexChars.indexOf(e.charAt(2*n+2));t.push((16*a+n)/255)}return t},f.Hsluv.lchToRgb=function(e){return f.Hsluv.xyzToRgb(f.Hsluv.luvToXyz(f.Hsluv.lchToLuv(e)))},f.Hsluv.rgbToLch=function(e){return f.Hsluv.luvToLch(f.Hsluv.xyzToLuv(f.Hsluv.rgbToXyz(e)))},f.Hsluv.hsluvToRgb=function(e){return f.Hsluv.lchToRgb(f.Hsluv.hsluvToLch(e))},f.Hsluv.rgbToHsluv=function(e){return f.Hsluv.lchToHsluv(f.Hsluv.rgbToLch(e))},f.Hsluv.hpluvToRgb=function(e){return f.Hsluv.lchToRgb(f.Hsluv.hpluvToLch(e))},f.Hsluv.rgbToHpluv=function(e){return f.Hsluv.lchToHpluv(f.Hsluv.rgbToLch(e))},f.Hsluv.hsluvToHex=function(e){return f.Hsluv.rgbToHex(f.Hsluv.hsluvToRgb(e))},f.Hsluv.hpluvToHex=function(e){return f.Hsluv.rgbToHex(f.Hsluv.hpluvToRgb(e))},f.Hsluv.hexToHsluv=function(e){return f.Hsluv.rgbToHsluv(f.Hsluv.hexToRgb(e))},f.Hsluv.hexToHpluv=function(e){return f.Hsluv.rgbToHpluv(f.Hsluv.hexToRgb(e))},f.Hsluv.m=[[3.240969941904521,-1.537383177570093,-.498610760293],[-.96924363628087,1.87596750150772,.041555057407175],[.055630079696993,-.20397695888897,1.056971514242878]],f.Hsluv.minv=[[.41239079926595,.35758433938387,.18048078840183],[.21263900587151,.71516867876775,.072192315360733],[.019330818715591,.11919477979462,.95053215224966]],f.Hsluv.refY=1,f.Hsluv.refU=.19783000664283,f.Hsluv.refV=.46831999493879,f.Hsluv.kappa=903.2962962,f.Hsluv.epsilon=.0088564516,f.Hsluv.hexChars="0123456789abcdef",e={hsluvToRgb:f.Hsluv.hsluvToRgb,rgbToHsluv:f.Hsluv.rgbToHsluv,hpluvToRgb:f.Hsluv.hpluvToRgb,rgbToHpluv:f.Hsluv.rgbToHpluv,hsluvToHex:f.Hsluv.hsluvToHex,hexToHsluv:f.Hsluv.hexToHsluv,hpluvToHex:f.Hsluv.hpluvToHex,hexToHpluv:f.Hsluv.hexToHpluv,lchToHpluv:f.Hsluv.lchToHpluv,hpluvToLch:f.Hsluv.hpluvToLch,lchToHsluv:f.Hsluv.lchToHsluv,hsluvToLch:f.Hsluv.hsluvToLch,lchToLuv:f.Hsluv.lchToLuv,luvToLch:f.Hsluv.luvToLch,xyzToLuv:f.Hsluv.xyzToLuv,luvToXyz:f.Hsluv.luvToXyz,xyzToRgb:f.Hsluv.xyzToRgb,rgbToXyz:f.Hsluv.rgbToXyz,lchToRgb:f.Hsluv.lchToRgb,rgbToLch:f.Hsluv.rgbToLch},cn=e);const s=cn;var f,e;const l=mn(),c=100,u=100;class t{hsl;alpha;constructor(e,t){var r;Array.isArray(e)?this.hsl=e:"string"==typeof e?(r=a(e),this.hsl=i(r)):this.hsl=[e.h,e.s,e.l],this.alpha=t}lighten(e,t=c){var[r,n,a]=this.hsl,a=(0,l.clamp)(a+e,0,t);return this.create([r,n,a],this.alpha)}darken(e,t=0){var[r,n,a]=this.hsl,a=(0,l.clamp)(a-e,t,c);return this.create([r,n,a],this.alpha)}saturate(e,t=u){var[r,n,a]=this.hsl,n=(0,l.clamp)(n+e,0,t);return this.create([r,n,a],this.alpha)}desaturate(e,t=0){var[r,n,a]=this.hsl,n=(0,l.clamp)(n-e,t,u);return this.create([r,n,a],this.alpha)}setHSL(e){var[t,r,n]=this.hsl;return this.create({h:t,s:r,l:n,...e},this.alpha)}setAlpha(e){return this.create(this.hsl,e)}}class r extends t{cssString;perceivedBrightness;constructor(e,t){super(e,t);var[e,t,r]=n(...this.hsl);this.perceivedBrightness=o(e,t,r),void 0===this.alpha?this.cssString=`rgb(${e} ${t} ${r})`:this.cssString=`rgb(${e} ${t} ${r} / ${this.alpha})`}create(e,t){return new r(e,t)}}dn.HSLColor=r;class d extends t{cssString;perceivedBrightness;constructor(e,t){super(e,t);var e=(0,s.hsluvToRgb)(this.hsl),t=Math.floor(255*e[0]),r=Math.floor(255*e[1]),e=Math.floor(255*e[2]);this.perceivedBrightness=o(t,r,e),void 0===this.alpha?this.cssString=`rgb(${t} ${r} ${e})`:this.cssString=`rgb(${t} ${r} ${e} / ${this.alpha})`}create(e,t){return new d(e,t)}}function n(e,t,r){t/=u,r/=c;var t=(1-Math.abs(2*r-1))*t,n=t*(1-Math.abs(e/60%2-1)),r=r-t/2;let[a,i,o]=[0,0,0];return 0<=e&&e<60?[a,i,o]=[t,n,0]:60<=e&&e<120?[a,i,o]=[n,t,0]:120<=e&&e<180?[a,i,o]=[0,t,n]:180<=e&&e<240?[a,i,o]=[0,n,t]:240<=e&&e<300?[a,i,o]=[n,0,t]:300<=e&&e<360&&([a,i,o]=[t,0,n]),a=Math.round(255*(a+r)),i=Math.round(255*(i+r)),o=Math.round(255*(o+r)),[a,i,o]}function a(e){let t=0,r=0,n=0;return 4===e.length?(t=parseInt(e[1]+e[1],16),r=parseInt(e[2]+e[2],16),n=parseInt(e[3]+e[3],16)):7===e.length&&(t=parseInt(e.substring(1,3),16),r=parseInt(e.substring(3,5),16),n=parseInt(e.substring(5,7),16)),[t,r,n]}function i(e){var[t,r,n]=e,e=(t/=255,r/=255,n/=255,Math.max(t,r,n)),a=Math.min(t,r,n);let i=(e+a)/2,o=(e+a)/2;var s=(e+a)/2;if(e===a)i=o=0;else{var l=e-a;switch(o=.5<s?l/(2-e-a):l/(e+a),e){case t:i=(r-n)/l+(r<n?6:0);break;case r:i=(n-t)/l+2;break;case n:i=(t-r)/l+4}i/=6}return[360*i,100*o,100*s]}function o(e,t,r){return(299*e+587*t+114*r)/1e3}dn.HSLuvColor=d}return dn}function M(){if(!hn){hn=1,Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.UNEXPECTED_PINK=void 0,Xr.makeColorScheme=n,Xr.colorForState=function(e){{if("Running"===e)return m;if(e.startsWith("Runnable"))return _;if(e.includes("Uninterruptible Sleep"))return e.includes("non-IO")?g:T;if(e.includes("Dead"))return h;if(e.includes("Sleeping")||e.includes("Idle"))return y}return b},Xr.colorForTid=t,Xr.colorForThread=function(e){if(void 0===e)return h;e=e.pid??e.tid;return t(e)},Xr.colorForCpu=function(e){return c.get()?a(e.toString()).base:(e=(128+32*e)%256,new s.HSLColor({h:e,s:50,l:50}))},Xr.randomColor=function(){var e=Math.random();return c.get()?a(e.toString()).base.cssString:(e=9*Math.floor(40*e),"#"+r.hsl.hex([e,90,30]))},Xr.getColorForSlice=function(e){e=e.replace(/( )?\d+/g,"");return(c.get()?a:i)(e)},Xr.colorForFtrace=a,Xr.colorForSample=function(e,t){let r;r=(c.get()?a:i)(String(e));return(t?r.variant:r.base).cssString};const r=rn(),o=on();var e=re();const s=_n(),l=180,c=e.featureFlags.register({id:"useConsistentColors",name:"Use common color palette for timeline elements",description:"Use the same color palette for all timeline elements.",defaultValue:!1});e=[new s.HSLColor({h:4,s:90,l:58}),new s.HSLColor({h:340,s:82,l:52}),new s.HSLColor({h:291,s:64,l:42}),new s.HSLColor({h:262,s:52,l:47}),new s.HSLColor({h:231,s:48,l:48}),new s.HSLColor({h:207,s:90,l:54}),new s.HSLColor({h:199,s:98,l:48}),new s.HSLColor({h:187,s:100,l:42}),new s.HSLColor({h:174,s:100,l:29}),new s.HSLColor({h:122,s:39,l:49}),new s.HSLColor({h:88,s:50,l:53}),new s.HSLColor({h:66,s:70,l:54}),new s.HSLColor({h:45,s:100,l:51}),new s.HSLColor({h:36,s:100,l:50}),new s.HSLColor({h:14,s:100,l:57}),new s.HSLColor({h:16,s:25,l:38}),new s.HSLColor({h:200,s:18,l:46}),new s.HSLColor({h:54,s:100,l:62})];const u=new s.HSLColor([0,0,100]),d=new s.HSLColor([0,0,0]),f=new s.HSLColor([0,0,90]),p=e.map(e=>{var e=e.lighten(10,60).desaturate(20),t=e.lighten(30,80).desaturate(20);return{base:e,variant:t,disabled:f,textBase:u,textVariant:u,textDisabled:u}}),h=n(new s.HSLColor([0,0,62])),g=n(new s.HSLColor([3,30,49])),m=n(new s.HSLColor([120,44,34])),_=n(new s.HSLColor([75,55,47])),y=n(new s.HSLColor([0,1,97],.55)),T=n(new s.HSLColor([36,100,50])),b=n(new s.HSLColor([231,48,48])),v=(Xr.UNEXPECTED_PINK=n(new s.HSLColor([330,100,70])),new Map);function n(e,t){return t=t??e.darken(15).saturate(15),{base:e,variant:t,disabled:f,textBase:e.perceivedBrightness>=l?d:u,textVariant:t.perceivedBrightness>=l?d:u,textDisabled:u}}function a(e){e=(0,o.hash)(e,p.length);return p[e]}function i(e){const t=v.get(e);if(t)return t;{var r=(0,o.hash)(e,360);const t=n(new s.HSLuvColor({h:r,s:80,l:(0,o.hash)(e+"x",40)+40}),new s.HSLuvColor({h:r,s:80,l:30}));return v.set(e,t),t}}function t(e){return a(e.toString())}}return Xr}var yn,Tn,bn={},vn={};function En(){if(!Tn){Tn=1,Object.defineProperty(bn,"__esModule",{value:!0}),bn.tableColumnEquals=r,bn.toggleEnabled=function(t,e,r,n){n&&void 0===e.find(e=>t(r,e))&&e.push(r);n||-1!==(n=e.findIndex(e=>t(r,e)))&&e.splice(n,1)},bn.aggregationEquals=function(e,t){return new n.EqualsBuilder(e,t).comparePrimitive(e=>e.aggregationFunction).compare(r,e=>e.column).equals()},bn.columnKey=t,bn.aggregationKey=function(e){return e.aggregationFunction+":"+t(e.column)};const n=function(){if(!yn){yn=1,Object.defineProperty(vn,"__esModule",{value:!0}),vn.EqualsBuilder=void 0;vn.EqualsBuilder=class{result=!0;first;second;constructor(e,t){this.first=e,this.second=t}comparePrimitive(e){return this.result&&(this.result=e(this.first)===e(this.second)),this}compare(e,t){return this.result&&(this.result=e(t(this.first),t(this.second))),this}equals(){return this.result}}}return vn}();function r(e,t){switch(e.kind){case"argument":return"argument"===t.kind&&e.argument===t.argument;case"regular":return"regular"===t.kind&&e.table===t.table&&e.column===t.column}}function t(e){switch(e.kind){case"argument":return"argument:"+e.argument;case"regular":return e.table+"."+e.column}}}return bn}var Sn,An={};function On(){if(!Sn){Sn=1,Object.defineProperty(An,"__esModule",{value:!0}),An.computeIntervals=function(e,t,r,n){if((0,i.assertTrue)(t!==r),r<t){const a="left"==n?r:r+1;return[{from:0,to:a},{from:t,to:t+1},{from:a,to:t},{from:t+1,to:e}]}const a="left"==n?r:r+1;return[{from:0,to:t},{from:t+1,to:a},{from:t,to:t+1},{from:a,to:e}]},An.performReordering=function(e,t){var r=[];for(const n of e)r.push(...t.slice(n.from,n.to));return r};const i=ee()}return An}var Cn,kn={},wn={},Rn={},In={},Mn={},Pn={},Nn={};function Dn(){var t,e,n;return Cn||(Cn=1,t=Nn,Object.defineProperty(t,"__esModule",{value:!0}),t.getParsedType=t.ZodParsedType=t.objectUtil=t.util=void 0,(n=e=t.util||(t.util={})).assertEqual=e=>e,n.assertIs=function(e){},n.assertNever=function(e){throw new Error},n.arrayToEnum=e=>{var t={};for(const r of e)t[r]=r;return t},n.getValidEnumValues=t=>{var e={};for(const r of n.objectKeys(t).filter(e=>"number"!=typeof t[t[e]]))e[r]=t[r];return n.objectValues(e)},n.objectValues=t=>n.objectKeys(t).map(function(e){return t[e]}),n.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{var t=[];for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},n.find=(e,t)=>{for(const r of e)if(t(r))return r},n.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,n.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},n.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t,(t.objectUtil||(t.objectUtil={})).mergeShapes=(e,t)=>({...e,...t}),t.ZodParsedType=e.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),t.getParsedType=e=>{switch(typeof e){case"undefined":return t.ZodParsedType.undefined;case"string":return t.ZodParsedType.string;case"number":return isNaN(e)?t.ZodParsedType.nan:t.ZodParsedType.number;case"boolean":return t.ZodParsedType.boolean;case"function":return t.ZodParsedType.function;case"bigint":return t.ZodParsedType.bigint;case"symbol":return t.ZodParsedType.symbol;case"object":return Array.isArray(e)?t.ZodParsedType.array:null===e?t.ZodParsedType.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?t.ZodParsedType.promise:"undefined"!=typeof Map&&e instanceof Map?t.ZodParsedType.map:"undefined"!=typeof Set&&e instanceof Set?t.ZodParsedType.set:"undefined"!=typeof Date&&e instanceof Date?t.ZodParsedType.date:t.ZodParsedType.object;default:return t.ZodParsedType.unknown}}),Nn}var xn,Ln,Fn,Un={};function Bn(){if(!xn){xn=1,Object.defineProperty(Un,"__esModule",{value:!0}),Un.ZodError=Un.quotelessJson=Un.ZodIssueCode=void 0;const e=Dn();Un.ZodIssueCode=e.util.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);Un.quotelessJson=e=>{return JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:")};class t extends Error{constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};var t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const a=e||function(e){return e.message},i={_errors:[]},t=e=>{for(const n of e.issues)if("invalid_union"===n.code)n.unionErrors.map(t);else if("invalid_return_type"===n.code)t(n.returnTypeError);else if("invalid_arguments"===n.code)t(n.argumentsError);else if(0===n.path.length)i._errors.push(a(n));else{let e=i,t=0;for(;t<n.path.length;){var r=n.path[t];t===n.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(a(n))):e[r]=e[r]||{_errors:[]},e=e[r],t++}}};return t(this),i}static assert(e){if(!(e instanceof t))throw new Error("Not a ZodError: "+e)}toString(){return this.message}get message(){return JSON.stringify(this.issues,e.util.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){var t={},r=[];for(const n of this.issues)(0<n.path.length?(t[n.path[0]]=t[n.path[0]]||[],t[n.path[0]]):r).push(e(n));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}(Un.ZodError=t).create=e=>{return new t(e)}}return Un}function jn(){if(!Ln){Ln=1,Object.defineProperty(Pn,"__esModule",{value:!0});const n=Dn(),a=Bn();Pn.default=(e,t)=>{let r;switch(e.code){case a.ZodIssueCode.invalid_type:r=e.received===n.ZodParsedType.undefined?"Required":`Expected ${e.expected}, received `+e.received;break;case a.ZodIssueCode.invalid_literal:r="Invalid literal value, expected "+JSON.stringify(e.expected,n.util.jsonStringifyReplacer);break;case a.ZodIssueCode.unrecognized_keys:r="Unrecognized key(s) in object: "+n.util.joinValues(e.keys,", ");break;case a.ZodIssueCode.invalid_union:r="Invalid input";break;case a.ZodIssueCode.invalid_union_discriminator:r="Invalid discriminator value. Expected "+n.util.joinValues(e.options);break;case a.ZodIssueCode.invalid_enum_value:r=`Invalid enum value. Expected ${n.util.joinValues(e.options)}, received '${e.received}'`;break;case a.ZodIssueCode.invalid_arguments:r="Invalid function arguments";break;case a.ZodIssueCode.invalid_return_type:r="Invalid function return type";break;case a.ZodIssueCode.invalid_date:r="Invalid date";break;case a.ZodIssueCode.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(r=r+" at one or more positions greater than or equal to "+e.validation.position)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:n.util.assertNever(e.validation):r="regex"!==e.validation?"Invalid "+e.validation:"Invalid";break;case a.ZodIssueCode.too_small:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?"Number must be "+(e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than ")+e.minimum:"date"===e.type?"Date must be "+(e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than ")+new Date(Number(e.minimum)):"Invalid input";break;case a.ZodIssueCode.too_big:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} `+e.maximum:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} `+e.maximum:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} `+new Date(Number(e.maximum)):"Invalid input";break;case a.ZodIssueCode.custom:r="Invalid input";break;case a.ZodIssueCode.invalid_intersection_types:r="Intersection results could not be merged";break;case a.ZodIssueCode.not_multiple_of:r="Number must be a multiple of "+e.multipleOf;break;case a.ZodIssueCode.not_finite:r="Number must be finite";break;default:r=t.defaultError,n.util.assertNever(e)}return{message:r}}}return Pn}function Hn(){if(!Fn){Fn=1;var e=be&&be.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},e=(Object.defineProperty(Mn,"__esModule",{value:!0}),Mn.getErrorMap=Mn.setErrorMap=Mn.defaultErrorMap=void 0,e(jn()));Mn.defaultErrorMap=e.default;let t=e.default;Mn.setErrorMap=function(e){t=e},Mn.getErrorMap=function(){return t}}return Mn}var Gn,Vn={};function Wn(){if(!Gn){Gn=1;{var o=Vn;var e=be&&be.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0}),o.isAsync=o.isValid=o.isDirty=o.isAborted=o.OK=o.DIRTY=o.INVALID=o.ParseStatus=o.addIssueToContext=o.EMPTY_PATH=o.makeIssue=void 0;const n=Hn(),a=e(jn());o.makeIssue=e=>{var{data:t,path:e,errorMaps:r,issueData:n}=e,e=[...e,...n.path||[]],a={...n,path:e};if(void 0!==n.message)return{...n,path:e,message:n.message};let i="";for(const o of r.filter(e=>!!e).slice().reverse())i=o(a,{data:t,defaultError:i}).message;return{...n,path:e,message:i}},o.EMPTY_PATH=[],o.addIssueToContext=function(e,t){var r=(0,n.getErrorMap)(),t=(0,o.makeIssue)({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===a.default?void 0:a.default].filter(e=>!!e)});e.common.issues.push(t)};class s{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){var r=[];for(const n of t){if("aborted"===n.status)return o.INVALID;"dirty"===n.status&&e.dirty(),r.push(n.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){var r=[];for(const i of t){var n=await i.key,a=await i.value;r.push({key:n,value:a})}return s.mergeObjectSync(e,r)}static mergeObjectSync(e,t){var r={};for(const i of t){var{key:n,value:a}=i;if("aborted"===n.status)return o.INVALID;if("aborted"===a.status)return o.INVALID;"dirty"===n.status&&e.dirty(),"dirty"===a.status&&e.dirty(),"__proto__"===n.value||void 0===a.value&&!i.alwaysSet||(r[n.value]=a.value)}return{status:e.value,value:r}}}o.ParseStatus=s,o.INVALID=Object.freeze({status:"aborted"});o.DIRTY=e=>({status:"dirty",value:e}),o.OK=e=>({status:"valid",value:e}),o.isAborted=e=>"aborted"===e.status,o.isDirty=e=>"dirty"===e.status,o.isValid=e=>"valid"===e.status;o.isAsync=e=>"undefined"!=typeof Promise&&e instanceof Promise}}return Vn}var qn,$n={};var zn,Kn,Yn,Jn,Zn,Qn={},Xn={};function ea(){if(!Kn){Kn=1;{var e=Qn;var n,a,l,t,F=be&&be.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e===t&&n:t.has(e))return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e);throw new TypeError("Cannot read private member from an object whose class did not declare it")},U=be&&be.__classPrivateFieldSet||function(e,t,r,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e===t&&a:t.has(e))return"a"===n?a.call(e,r):a?a.value=r:t.set(e,r),r;throw new TypeError("Cannot write private member to an object whose class did not declare it")};Object.defineProperty(e,"__esModule",{value:!0}),e.boolean=e.bigint=e.array=e.any=e.coerce=e.ZodFirstPartyTypeKind=e.late=e.ZodSchema=e.Schema=e.custom=e.ZodReadonly=e.ZodPipeline=e.ZodBranded=e.BRAND=e.ZodNaN=e.ZodCatch=e.ZodDefault=e.ZodNullable=e.ZodOptional=e.ZodTransformer=e.ZodEffects=e.ZodPromise=e.ZodNativeEnum=e.ZodEnum=e.ZodLiteral=e.ZodLazy=e.ZodFunction=e.ZodSet=e.ZodMap=e.ZodRecord=e.ZodTuple=e.ZodIntersection=e.ZodDiscriminatedUnion=e.ZodUnion=e.ZodObject=e.ZodArray=e.ZodVoid=e.ZodNever=e.ZodUnknown=e.ZodAny=e.ZodNull=e.ZodUndefined=e.ZodSymbol=e.ZodDate=e.ZodBoolean=e.ZodBigInt=e.ZodNumber=e.ZodString=e.datetimeRegex=e.ZodType=void 0,e.NEVER=e.void=e.unknown=e.union=e.undefined=e.tuple=e.transformer=e.symbol=e.string=e.strictObject=e.set=e.record=e.promise=e.preprocess=e.pipeline=e.ostring=e.optional=e.onumber=e.oboolean=e.object=e.number=e.nullable=e.null=e.never=e.nativeEnum=e.nan=e.map=e.literal=e.lazy=e.intersection=e.instanceof=e.function=e.enum=e.effect=e.discriminatedUnion=e.date=void 0;const u=Hn(),i=(zn||(zn=1,t=Xn,Object.defineProperty(t,"__esModule",{value:!0}),t.errorUtil=void 0,(t=t.errorUtil||(t.errorUtil={})).errToObj=e=>"string"==typeof e?{message:e}:e||{},t.toString=e=>"string"==typeof e?e:null==e?void 0:e.message),Xn),g=Wn(),m=Dn(),_=Bn();class y{constructor(e,t,r,n){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const V=(t,e)=>{if((0,g.isValid)(e))return{success:!0,data:e.value};if(t.common.issues.length)return{success:!1,get error(){var e;return this._error||(e=new _.ZodError(t.common.issues),this._error=e),this._error}};throw new Error("Validation failed but no issues detected.")};function c(a){if(!a)return{};const{errorMap:e,invalid_type_error:i,required_error:o,description:t}=a;if(e&&(i||o))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:t}:{errorMap:(e,t)=>{var r,n=a["message"];return"invalid_enum_value"===e.code?{message:null!=n?n:t.defaultError}:void 0===t.data?{message:null!=(r=null!=n?n:o)?r:t.defaultError}:"invalid_type"!==e.code?{message:t.defaultError}:{message:null!=(r=null!=n?n:i)?r:t.defaultError}},description:t}}class o{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return(0,m.getParsedType)(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:(0,m.getParsedType)(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new g.ParseStatus,ctx:{common:e.parent.common,data:e.data,parsedType:(0,m.getParsedType)(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){e=this._parse(e);if((0,g.isAsync)(e))throw new Error("Synchronous parse encountered promise.");return e}_parseAsync(e){e=this._parse(e);return Promise.resolve(e)}parse(e,t){e=this.safeParse(e,t);if(e.success)return e.data;throw e.error}safeParse(e,t){var r={common:{issues:[],async:null!=(r=null==t?void 0:t.async)&&r,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:(0,m.getParsedType)(e)},t=this._parseSync({data:e,path:r.path,parent:r});return V(r,t)}async parseAsync(e,t){e=await this.safeParseAsync(e,t);if(e.success)return e.data;throw e.error}async safeParseAsync(e,t){t={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:(0,m.getParsedType)(e)},e=this._parse({data:e,path:t.path,parent:t}),e=await((0,g.isAsync)(e)?e:Promise.resolve(e));return V(t,e)}refine(a,i){return this._refinement((t,r)=>{var e=a(t);const n=()=>{return r.addIssue({code:_.ZodIssueCode.custom,...(e=t,"string"==typeof i||void 0===i?{message:i}:"function"==typeof i?i(e):i)});var e};return"undefined"!=typeof Promise&&e instanceof Promise?e.then(e=>!!e||(n(),!1)):!!e||(n(),!1)})}refinement(r,n){return this._refinement((e,t)=>!!r(e)||(t.addIssue("function"==typeof n?n(e,t):n),!1))}_refinement(e){return new D({schema:this,typeName:l.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return x.create(this,this._def)}nullable(){return L.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return O.create(this,this._def)}promise(){return N.create(this,this._def)}or(e){return ae.create([this,e],this._def)}and(e){return oe.create(this,e,this._def)}transform(e){return new D({...c(this._def),schema:this,typeName:l.ZodEffects,effect:{type:"transform",transform:e}})}default(e){var t="function"==typeof e?e:()=>e;return new de({...c(this._def),innerType:this,defaultValue:t,typeName:l.ZodDefault})}brand(){return new he({typeName:l.ZodBranded,type:this,...c(this._def)})}catch(e){var t="function"==typeof e?e:()=>e;return new fe({...c(this._def),innerType:this,catchValue:t,typeName:l.ZodCatch})}describe(e){return new this.constructor({...this._def,description:e})}pipe(e){return ge.create(this,e)}readonly(){return me.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}e.ZodType=o,e.Schema=o,e.ZodSchema=o;const W=/^c[^\s-]{8,}$/i,q=/^[0-9a-z]+$/,$=/^[0-9A-HJKMNP-TV-Z]{26}$/,z=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,K=/^[a-z0-9_-]{21}$/i,Y=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,J=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let s;const Z=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Q=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,X=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,ee="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",te=new RegExp(`^${ee}$`);function B(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t+="(\\.\\d+)?"),t}function j(e){var t=ee+"T"+B(e),r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t+=`(${r.join("|")})`,new RegExp(`^${t}$`)}e.datetimeRegex=j;class d extends o{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==m.ZodParsedType.string){const n=this._getOrReturnCtx(t);return(0,g.addIssueToContext)(n,{code:_.ZodIssueCode.invalid_type,expected:m.ZodParsedType.string,received:n.parsedType}),g.INVALID}var e,r=new g.ParseStatus;let n=void 0;for(const o of this._def.checks)if("min"===o.kind)t.data.length<o.value&&(n=this._getOrReturnCtx(t,n),(0,g.addIssueToContext)(n,{code:_.ZodIssueCode.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),r.dirty());else if("max"===o.kind)t.data.length>o.value&&(n=this._getOrReturnCtx(t,n),(0,g.addIssueToContext)(n,{code:_.ZodIssueCode.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),r.dirty());else if("length"===o.kind){var a=t.data.length>o.value,i=t.data.length<o.value;(a||i)&&(n=this._getOrReturnCtx(t,n),a?(0,g.addIssueToContext)(n,{code:_.ZodIssueCode.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}):i&&(0,g.addIssueToContext)(n,{code:_.ZodIssueCode.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}),r.dirty())}else if("email"===o.kind)J.test(t.data)||(n=this._getOrReturnCtx(t,n),(0,g.addIssueToContext)(n,{validation:"email",code:_.ZodIssueCode.invalid_string,message:o.message}),r.dirty());else if("emoji"===o.kind)(s=s||new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")).test(t.data)||(n=this._getOrReturnCtx(t,n),(0,g.addIssueToContext)(n,{validation:"emoji",code:_.ZodIssueCode.invalid_string,message:o.message}),r.dirty());else if("uuid"===o.kind)z.test(t.data)||(n=this._getOrReturnCtx(t,n),(0,g.addIssueToContext)(n,{validation:"uuid",code:_.ZodIssueCode.invalid_string,message:o.message}),r.dirty());else if("nanoid"===o.kind)K.test(t.data)||(n=this._getOrReturnCtx(t,n),(0,g.addIssueToContext)(n,{validation:"nanoid",code:_.ZodIssueCode.invalid_string,message:o.message}),r.dirty());else if("cuid"===o.kind)W.test(t.data)||(n=this._getOrReturnCtx(t,n),(0,g.addIssueToContext)(n,{validation:"cuid",code:_.ZodIssueCode.invalid_string,message:o.message}),r.dirty());else if("cuid2"===o.kind)q.test(t.data)||(n=this._getOrReturnCtx(t,n),(0,g.addIssueToContext)(n,{validation:"cuid2",code:_.ZodIssueCode.invalid_string,message:o.message}),r.dirty());else if("ulid"===o.kind)$.test(t.data)||(n=this._getOrReturnCtx(t,n),(0,g.addIssueToContext)(n,{validation:"ulid",code:_.ZodIssueCode.invalid_string,message:o.message}),r.dirty());else if("url"===o.kind)try{new URL(t.data)}catch(e){n=this._getOrReturnCtx(t,n),(0,g.addIssueToContext)(n,{validation:"url",code:_.ZodIssueCode.invalid_string,message:o.message}),r.dirty()}else"regex"===o.kind?(o.regex.lastIndex=0,o.regex.test(t.data)||(n=this._getOrReturnCtx(t,n),(0,g.addIssueToContext)(n,{validation:"regex",code:_.ZodIssueCode.invalid_string,message:o.message}),r.dirty())):"trim"===o.kind?t.data=t.data.trim():"includes"===o.kind?t.data.includes(o.value,o.position)||(n=this._getOrReturnCtx(t,n),(0,g.addIssueToContext)(n,{code:_.ZodIssueCode.invalid_string,validation:{includes:o.value,position:o.position},message:o.message}),r.dirty()):"toLowerCase"===o.kind?t.data=t.data.toLowerCase():"toUpperCase"===o.kind?t.data=t.data.toUpperCase():"startsWith"===o.kind?t.data.startsWith(o.value)||(n=this._getOrReturnCtx(t,n),(0,g.addIssueToContext)(n,{code:_.ZodIssueCode.invalid_string,validation:{startsWith:o.value},message:o.message}),r.dirty()):"endsWith"===o.kind?t.data.endsWith(o.value)||(n=this._getOrReturnCtx(t,n),(0,g.addIssueToContext)(n,{code:_.ZodIssueCode.invalid_string,validation:{endsWith:o.value},message:o.message}),r.dirty()):"datetime"===o.kind?j(o).test(t.data)||(n=this._getOrReturnCtx(t,n),(0,g.addIssueToContext)(n,{code:_.ZodIssueCode.invalid_string,validation:"datetime",message:o.message}),r.dirty()):"date"===o.kind?te.test(t.data)||(n=this._getOrReturnCtx(t,n),(0,g.addIssueToContext)(n,{code:_.ZodIssueCode.invalid_string,validation:"date",message:o.message}),r.dirty()):"time"===o.kind?(a=o,new RegExp(`^${B(a)}$`).test(t.data)||(n=this._getOrReturnCtx(t,n),(0,g.addIssueToContext)(n,{code:_.ZodIssueCode.invalid_string,validation:"time",message:o.message}),r.dirty())):"duration"===o.kind?Y.test(t.data)||(n=this._getOrReturnCtx(t,n),(0,g.addIssueToContext)(n,{validation:"duration",code:_.ZodIssueCode.invalid_string,message:o.message}),r.dirty()):"ip"===o.kind?(i=t.data,("v4"!==(e=o.version)&&e||!Z.test(i))&&("v6"!==e&&e||!Q.test(i))&&(n=this._getOrReturnCtx(t,n),(0,g.addIssueToContext)(n,{validation:"ip",code:_.ZodIssueCode.invalid_string,message:o.message}),r.dirty())):"base64"===o.kind?X.test(t.data)||(n=this._getOrReturnCtx(t,n),(0,g.addIssueToContext)(n,{validation:"base64",code:_.ZodIssueCode.invalid_string,message:o.message}),r.dirty()):m.util.assertNever(o);return{status:r.value,value:t.data}}_regex(t,e,r){return this.refinement(e=>t.test(e),{validation:e,code:_.ZodIssueCode.invalid_string,...i.errorUtil.errToObj(r)})}_addCheck(e){return new d({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...i.errorUtil.errToObj(e)})}url(e){return this._addCheck({kind:"url",...i.errorUtil.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...i.errorUtil.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...i.errorUtil.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...i.errorUtil.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...i.errorUtil.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...i.errorUtil.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...i.errorUtil.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...i.errorUtil.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...i.errorUtil.errToObj(e)})}datetime(e){var t;return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:null!=(t=null==e?void 0:e.offset)&&t,local:null!=(t=null==e?void 0:e.local)&&t,...i.errorUtil.errToObj(null==e?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,...i.errorUtil.errToObj(null==e?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...i.errorUtil.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...i.errorUtil.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...i.errorUtil.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...i.errorUtil.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...i.errorUtil.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...i.errorUtil.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...i.errorUtil.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...i.errorUtil.errToObj(t)})}nonempty(e){return this.min(1,i.errorUtil.errToObj(e))}trim(){return new d({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new d({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new d({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isDate(){return!!this._def.checks.find(e=>"date"===e.kind)}get isTime(){return!!this._def.checks.find(e=>"time"===e.kind)}get isDuration(){return!!this._def.checks.find(e=>"duration"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isNANOID(){return!!this._def.checks.find(e=>"nanoid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get isBase64(){return!!this._def.checks.find(e=>"base64"===e.kind)}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}(e.ZodString=d).create=e=>{var t;return new d({checks:[],typeName:l.ZodString,coerce:null!=(t=null==e?void 0:e.coerce)&&t,...c(e)})};class f extends o{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==m.ZodParsedType.number){const t=this._getOrReturnCtx(e);return(0,g.addIssueToContext)(t,{code:_.ZodIssueCode.invalid_type,expected:m.ZodParsedType.number,received:t.parsedType}),g.INVALID}let t=void 0;var r,n,a,i,o=new g.ParseStatus;for(const s of this._def.checks)"int"===s.kind?m.util.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),(0,g.addIssueToContext)(t,{code:_.ZodIssueCode.invalid_type,expected:"integer",received:"float",message:s.message}),o.dirty()):"min"===s.kind?(s.inclusive?e.data<s.value:e.data<=s.value)&&(t=this._getOrReturnCtx(e,t),(0,g.addIssueToContext)(t,{code:_.ZodIssueCode.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),o.dirty()):"max"===s.kind?(s.inclusive?e.data>s.value:e.data>=s.value)&&(t=this._getOrReturnCtx(e,t),(0,g.addIssueToContext)(t,{code:_.ZodIssueCode.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),o.dirty()):"multipleOf"===s.kind?0!=(r=e.data,n=s.value,a=i=a=void 0,a=(r.toString().split(".")[1]||"").length,i=(n.toString().split(".")[1]||"").length,a=i<a?a:i,parseInt(r.toFixed(a).replace(".",""))%parseInt(n.toFixed(a).replace(".",""))/Math.pow(10,a))&&(t=this._getOrReturnCtx(e,t),(0,g.addIssueToContext)(t,{code:_.ZodIssueCode.not_multiple_of,multipleOf:s.value,message:s.message}),o.dirty()):"finite"===s.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),(0,g.addIssueToContext)(t,{code:_.ZodIssueCode.not_finite,message:s.message}),o.dirty()):m.util.assertNever(s);return{status:o.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,i.errorUtil.toString(t))}gt(e,t){return this.setLimit("min",e,!1,i.errorUtil.toString(t))}lte(e,t){return this.setLimit("max",e,!0,i.errorUtil.toString(t))}lt(e,t){return this.setLimit("max",e,!1,i.errorUtil.toString(t))}setLimit(e,t,r,n){return new f({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:i.errorUtil.toString(n)}]})}_addCheck(e){return new f({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:i.errorUtil.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:i.errorUtil.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:i.errorUtil.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:i.errorUtil.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:i.errorUtil.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:i.errorUtil.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:i.errorUtil.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:i.errorUtil.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:i.errorUtil.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&m.util.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;"min"===r.kind?(null===t||r.value>t)&&(t=r.value):"max"===r.kind&&(null===e||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}(e.ZodNumber=f).create=e=>new f({checks:[],typeName:l.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...c(e)});class p extends o{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==m.ZodParsedType.bigint){const t=this._getOrReturnCtx(e);return(0,g.addIssueToContext)(t,{code:_.ZodIssueCode.invalid_type,expected:m.ZodParsedType.bigint,received:t.parsedType}),g.INVALID}let t=void 0;var r=new g.ParseStatus;for(const n of this._def.checks)"min"===n.kind?(n.inclusive?e.data<n.value:e.data<=n.value)&&(t=this._getOrReturnCtx(e,t),(0,g.addIssueToContext)(t,{code:_.ZodIssueCode.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):"max"===n.kind?(n.inclusive?e.data>n.value:e.data>=n.value)&&(t=this._getOrReturnCtx(e,t),(0,g.addIssueToContext)(t,{code:_.ZodIssueCode.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):"multipleOf"===n.kind?e.data%n.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),(0,g.addIssueToContext)(t,{code:_.ZodIssueCode.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):m.util.assertNever(n);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,i.errorUtil.toString(t))}gt(e,t){return this.setLimit("min",e,!1,i.errorUtil.toString(t))}lte(e,t){return this.setLimit("max",e,!0,i.errorUtil.toString(t))}lt(e,t){return this.setLimit("max",e,!1,i.errorUtil.toString(t))}setLimit(e,t,r,n){return new p({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:i.errorUtil.toString(n)}]})}_addCheck(e){return new p({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:i.errorUtil.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:i.errorUtil.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:i.errorUtil.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:i.errorUtil.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:i.errorUtil.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}(e.ZodBigInt=p).create=e=>{var t;return new p({checks:[],typeName:l.ZodBigInt,coerce:null!=(t=null==e?void 0:e.coerce)&&t,...c(e)})};class h extends o{_parse(e){var t;return this._def.coerce&&(e.data=Boolean(e.data)),this._getType(e)!==m.ZodParsedType.boolean?(t=this._getOrReturnCtx(e),(0,g.addIssueToContext)(t,{code:_.ZodIssueCode.invalid_type,expected:m.ZodParsedType.boolean,received:t.parsedType}),g.INVALID):(0,g.OK)(e.data)}}(e.ZodBoolean=h).create=e=>new h({typeName:l.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...c(e)});class T extends o{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==m.ZodParsedType.date){const r=this._getOrReturnCtx(e);return(0,g.addIssueToContext)(r,{code:_.ZodIssueCode.invalid_type,expected:m.ZodParsedType.date,received:r.parsedType}),g.INVALID}if(isNaN(e.data.getTime())){const r=this._getOrReturnCtx(e);return(0,g.addIssueToContext)(r,{code:_.ZodIssueCode.invalid_date}),g.INVALID}var t=new g.ParseStatus;let r=void 0;for(const n of this._def.checks)"min"===n.kind?e.data.getTime()<n.value&&(r=this._getOrReturnCtx(e,r),(0,g.addIssueToContext)(r,{code:_.ZodIssueCode.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),t.dirty()):"max"===n.kind?e.data.getTime()>n.value&&(r=this._getOrReturnCtx(e,r),(0,g.addIssueToContext)(r,{code:_.ZodIssueCode.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),t.dirty()):m.util.assertNever(n);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new T({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:i.errorUtil.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:i.errorUtil.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}(e.ZodDate=T).create=e=>new T({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:l.ZodDate,...c(e)});class re extends o{_parse(e){var t;return this._getType(e)!==m.ZodParsedType.symbol?(t=this._getOrReturnCtx(e),(0,g.addIssueToContext)(t,{code:_.ZodIssueCode.invalid_type,expected:m.ZodParsedType.symbol,received:t.parsedType}),g.INVALID):(0,g.OK)(e.data)}}(e.ZodSymbol=re).create=e=>new re({typeName:l.ZodSymbol,...c(e)});class b extends o{_parse(e){var t;return this._getType(e)!==m.ZodParsedType.undefined?(t=this._getOrReturnCtx(e),(0,g.addIssueToContext)(t,{code:_.ZodIssueCode.invalid_type,expected:m.ZodParsedType.undefined,received:t.parsedType}),g.INVALID):(0,g.OK)(e.data)}}(e.ZodUndefined=b).create=e=>new b({typeName:l.ZodUndefined,...c(e)});class v extends o{_parse(e){var t;return this._getType(e)!==m.ZodParsedType.null?(t=this._getOrReturnCtx(e),(0,g.addIssueToContext)(t,{code:_.ZodIssueCode.invalid_type,expected:m.ZodParsedType.null,received:t.parsedType}),g.INVALID):(0,g.OK)(e.data)}}(e.ZodNull=v).create=e=>new v({typeName:l.ZodNull,...c(e)});class E extends o{constructor(){super(...arguments),this._any=!0}_parse(e){return(0,g.OK)(e.data)}}(e.ZodAny=E).create=e=>new E({typeName:l.ZodAny,...c(e)});class S extends o{constructor(){super(...arguments),this._unknown=!0}_parse(e){return(0,g.OK)(e.data)}}(e.ZodUnknown=S).create=e=>new S({typeName:l.ZodUnknown,...c(e)});class A extends o{_parse(e){e=this._getOrReturnCtx(e);return(0,g.addIssueToContext)(e,{code:_.ZodIssueCode.invalid_type,expected:m.ZodParsedType.never,received:e.parsedType}),g.INVALID}}(e.ZodNever=A).create=e=>new A({typeName:l.ZodNever,...c(e)});class ne extends o{_parse(e){var t;return this._getType(e)!==m.ZodParsedType.undefined?(t=this._getOrReturnCtx(e),(0,g.addIssueToContext)(t,{code:_.ZodIssueCode.invalid_type,expected:m.ZodParsedType.void,received:t.parsedType}),g.INVALID):(0,g.OK)(e.data)}}(e.ZodVoid=ne).create=e=>new ne({typeName:l.ZodVoid,...c(e)});class O extends o{_parse(e){const{ctx:r,status:t}=this._processInputParams(e),n=this._def;var a;return r.parsedType!==m.ZodParsedType.array?((0,g.addIssueToContext)(r,{code:_.ZodIssueCode.invalid_type,expected:m.ZodParsedType.array,received:r.parsedType}),g.INVALID):(null!==n.exactLength&&(e=r.data.length>n.exactLength.value,a=r.data.length<n.exactLength.value,e||a)&&((0,g.addIssueToContext)(r,{code:e?_.ZodIssueCode.too_big:_.ZodIssueCode.too_small,minimum:a?n.exactLength.value:void 0,maximum:e?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),t.dirty()),null!==n.minLength&&r.data.length<n.minLength.value&&((0,g.addIssueToContext)(r,{code:_.ZodIssueCode.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),t.dirty()),null!==n.maxLength&&r.data.length>n.maxLength.value&&((0,g.addIssueToContext)(r,{code:_.ZodIssueCode.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),t.dirty()),r.common.async?Promise.all([...r.data].map((e,t)=>n.type._parseAsync(new y(r,e,r.path,t)))).then(e=>g.ParseStatus.mergeArray(t,e)):(a=[...r.data].map((e,t)=>n.type._parseSync(new y(r,e,r.path,t))),g.ParseStatus.mergeArray(t,a)))}get element(){return this._def.type}min(e,t){return new O({...this._def,minLength:{value:e,message:i.errorUtil.toString(t)}})}max(e,t){return new O({...this._def,maxLength:{value:e,message:i.errorUtil.toString(t)}})}length(e,t){return new O({...this._def,exactLength:{value:e,message:i.errorUtil.toString(t)}})}nonempty(e){return this.min(1,e)}}(e.ZodArray=O).create=(e,t)=>new O({type:e,minLength:null,maxLength:null,exactLength:null,typeName:l.ZodArray,...c(t)});class C extends o{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){var e,t;return null!==this._cached?this._cached:(e=this._def.shape(),t=m.util.objectKeys(e),this._cached={shape:e,keys:t})}_parse(e){if(this._getType(e)!==m.ZodParsedType.object){const r=this._getOrReturnCtx(e);return(0,g.addIssueToContext)(r,{code:_.ZodIssueCode.invalid_type,expected:m.ZodParsedType.object,received:r.parsedType}),g.INVALID}const{status:t,ctx:r}=this._processInputParams(e);var{shape:n,keys:a}=this._getCached(),i=[];if(!(this._def.catchall instanceof A&&"strip"===this._def.unknownKeys))for(const d in r.data)a.includes(d)||i.push(d);const o=[];for(const f of a){var s=n[f],l=r.data[f];o.push({key:{status:"valid",value:f},value:s._parse(new y(r,l,r.path,f)),alwaysSet:f in r.data})}if(this._def.catchall instanceof A){e=this._def.unknownKeys;if("passthrough"===e)for(const p of i)o.push({key:{status:"valid",value:p},value:{status:"valid",value:r.data[p]}});else if("strict"===e)0<i.length&&((0,g.addIssueToContext)(r,{code:_.ZodIssueCode.unrecognized_keys,keys:i}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{var c=this._def.catchall;for(const h of i){var u=r.data[h];o.push({key:{status:"valid",value:h},value:c._parse(new y(r,u,r.path,h)),alwaysSet:h in r.data})}}return r.common.async?Promise.resolve().then(async()=>{var e=[];for(const n of o){var t=await n.key,r=await n.value;e.push({key:t,value:r,alwaysSet:n.alwaysSet})}return e}).then(e=>g.ParseStatus.mergeObjectSync(t,e)):g.ParseStatus.mergeObjectSync(t,o)}get shape(){return this._def.shape()}strict(a){return i.errorUtil.errToObj,new C({...this._def,unknownKeys:"strict",...void 0!==a?{errorMap:(e,t)=>{var r,n=null!=(r=null==(r=(n=this._def).errorMap)?void 0:r.call(n,e,t).message)?r:t.defaultError;return"unrecognized_keys"===e.code?{message:null!=(r=i.errorUtil.errToObj(a).message)?r:n}:{message:n}}}:{}})}strip(){return new C({...this._def,unknownKeys:"strip"})}passthrough(){return new C({...this._def,unknownKeys:"passthrough"})}extend(e){return new C({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new C({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:l.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new C({...this._def,catchall:e})}pick(t){const r={};return m.util.objectKeys(t).forEach(e=>{t[e]&&this.shape[e]&&(r[e]=this.shape[e])}),new C({...this._def,shape:()=>r})}omit(t){const r={};return m.util.objectKeys(this.shape).forEach(e=>{t[e]||(r[e]=this.shape[e])}),new C({...this._def,shape:()=>r})}deepPartial(){return function t(e){if(e instanceof C){const n={};for(const a in e.shape){var r=e.shape[a];n[a]=x.create(t(r))}return new C({...e._def,shape:()=>n})}return e instanceof O?new O({...e._def,type:t(e.element)}):e instanceof x?x.create(t(e.unwrap())):e instanceof L?L.create(t(e.unwrap())):e instanceof w?w.create(e.items.map(e=>t(e))):e}(this)}partial(r){const n={};return m.util.objectKeys(this.shape).forEach(e=>{var t=this.shape[e];r&&!r[e]?n[e]=t:n[e]=t.optional()}),new C({...this._def,shape:()=>n})}required(e){const r={};return m.util.objectKeys(this.shape).forEach(t=>{if(e&&!e[t])r[t]=this.shape[t];else{let e=this.shape[t];for(;e instanceof x;)e=e._def.innerType;r[t]=e}}),new C({...this._def,shape:()=>r})}keyof(){return H(m.util.objectKeys(this.shape))}}(e.ZodObject=C).create=(e,t)=>new C({shape:()=>e,unknownKeys:"strip",catchall:A.create(),typeName:l.ZodObject,...c(t)}),C.strictCreate=(e,t)=>new C({shape:()=>e,unknownKeys:"strict",catchall:A.create(),typeName:l.ZodObject,...c(t)}),C.lazycreate=(e,t)=>new C({shape:e,unknownKeys:"strip",catchall:A.create(),typeName:l.ZodObject,...c(t)});class ae extends o{_parse(t){const n=this._processInputParams(t)["ctx"];t=this._def.options;if(n.common.async)return Promise.all(t.map(async e=>{var t={...n,common:{...n.common,issues:[]},parent:null};return{result:await e._parseAsync({data:n.data,path:n.path,parent:t}),ctx:t}})).then(function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const r of e)if("dirty"===r.result.status)return n.common.issues.push(...r.ctx.common.issues),r.result;return e=e.map(e=>new _.ZodError(e.ctx.common.issues)),(0,g.addIssueToContext)(n,{code:_.ZodIssueCode.invalid_union,unionErrors:e}),g.INVALID});{let e=void 0;var r=[];for(const o of t){var a={...n,common:{...n.common,issues:[]},parent:null},i=o._parseSync({data:n.data,path:n.path,parent:a});if("valid"===i.status)return i;"dirty"===i.status&&(e=e||{result:i,ctx:a}),a.common.issues.length&&r.push(a.common.issues)}return e?(n.common.issues.push(...e.ctx.common.issues),e.result):(t=r.map(e=>new _.ZodError(e)),(0,g.addIssueToContext)(n,{code:_.ZodIssueCode.invalid_union,unionErrors:t}),g.INVALID)}}get options(){return this._def.options}}(e.ZodUnion=ae).create=(e,t)=>new ae({options:e,typeName:l.ZodUnion,...c(t)});const k=e=>e instanceof ce?k(e.schema):e instanceof D?k(e.innerType()):e instanceof ue?[e.value]:e instanceof M?e.options:e instanceof P?m.util.objectValues(e.enum):e instanceof de?k(e._def.innerType):e instanceof b?[void 0]:e instanceof v?[null]:e instanceof x?[void 0,...k(e.unwrap())]:e instanceof L?[null,...k(e.unwrap())]:e instanceof he||e instanceof me?k(e.unwrap()):e instanceof fe?k(e._def.innerType):[];class ie extends o{_parse(e){var t,r,e=this._processInputParams(e)["ctx"];return e.parsedType!==m.ZodParsedType.object?((0,g.addIssueToContext)(e,{code:_.ZodIssueCode.invalid_type,expected:m.ZodParsedType.object,received:e.parsedType}),g.INVALID):(t=this.discriminator,r=e.data[t],(r=this.optionsMap.get(r))?e.common.async?r._parseAsync({data:e.data,path:e.path,parent:e}):r._parseSync({data:e.data,path:e.path,parent:e}):((0,g.addIssueToContext)(e,{code:_.ZodIssueCode.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[t]}),g.INVALID))}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){var n=new Map;for(const i of t){var a=k(i.shape[e]);if(!a.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of a){if(n.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value `+String(o));n.set(o,i)}}return new ie({typeName:l.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:n,...c(r)})}}e.ZodDiscriminatedUnion=ie;class oe extends o{_parse(e){const{status:n,ctx:a}=this._processInputParams(e),r=(e,t)=>{var r;return(0,g.isAborted)(e)||(0,g.isAborted)(t)?g.INVALID:(r=function t(r,n){var e=(0,m.getParsedType)(r),a=(0,m.getParsedType)(n);if(r===n)return{valid:!0,data:r};if(e===m.ZodParsedType.object&&a===m.ZodParsedType.object){const u=m.util.objectKeys(n);var i=m.util.objectKeys(r).filter(e=>-1!==u.indexOf(e)),o={...r,...n};for(const d of i){var s=t(r[d],n[d]);if(!s.valid)return{valid:!1};o[d]=s.data}return{valid:!0,data:o}}if(e!==m.ZodParsedType.array||a!==m.ZodParsedType.array)return e===m.ZodParsedType.date&&a===m.ZodParsedType.date&&+r==+n?{valid:!0,data:r}:{valid:!1};if(r.length!==n.length)return{valid:!1};var l=[];for(let e=0;e<r.length;e++){var c=t(r[e],n[e]);if(!c.valid)return{valid:!1};l.push(c.data)}return{valid:!0,data:l}}(e.value,t.value)).valid?(((0,g.isDirty)(e)||(0,g.isDirty)(t))&&n.dirty(),{status:n.value,value:r.data}):((0,g.addIssueToContext)(a,{code:_.ZodIssueCode.invalid_intersection_types}),g.INVALID)};return a.common.async?Promise.all([this._def.left._parseAsync({data:a.data,path:a.path,parent:a}),this._def.right._parseAsync({data:a.data,path:a.path,parent:a})]).then(([e,t])=>r(e,t)):r(this._def.left._parseSync({data:a.data,path:a.path,parent:a}),this._def.right._parseSync({data:a.data,path:a.path,parent:a}))}}(e.ZodIntersection=oe).create=(e,t,r)=>new oe({left:e,right:t,typeName:l.ZodIntersection,...c(r)});class w extends o{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);return n.parsedType!==m.ZodParsedType.array?((0,g.addIssueToContext)(n,{code:_.ZodIssueCode.invalid_type,expected:m.ZodParsedType.array,received:n.parsedType}),g.INVALID):n.data.length<this._def.items.length?((0,g.addIssueToContext)(n,{code:_.ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),g.INVALID):(!this._def.rest&&n.data.length>this._def.items.length&&((0,g.addIssueToContext)(n,{code:_.ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty()),e=[...n.data].map((e,t)=>{var r=this._def.items[t]||this._def.rest;return r?r._parse(new y(n,e,n.path,t)):null}).filter(e=>!!e),n.common.async?Promise.all(e).then(e=>g.ParseStatus.mergeArray(t,e)):g.ParseStatus.mergeArray(t,e))}get items(){return this._def.items}rest(e){return new w({...this._def,rest:e})}}(e.ZodTuple=w).create=(e,t)=>{if(Array.isArray(e))return new w({items:e,typeName:l.ZodTuple,rest:null,...c(t)});throw new Error("You must pass an array of schemas to z.tuple([ ... ])")};class se extends o{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){var{status:e,ctx:t}=this._processInputParams(e);if(t.parsedType!==m.ZodParsedType.object)return(0,g.addIssueToContext)(t,{code:_.ZodIssueCode.invalid_type,expected:m.ZodParsedType.object,received:t.parsedType}),g.INVALID;var r=[],n=this._def.keyType,a=this._def.valueType;for(const i in t.data)r.push({key:n._parse(new y(t,i,t.path,i)),value:a._parse(new y(t,t.data[i],t.path,i)),alwaysSet:i in t.data});return t.common.async?g.ParseStatus.mergeObjectAsync(e,r):g.ParseStatus.mergeObjectSync(e,r)}get element(){return this._def.valueType}static create(e,t,r){return t instanceof o?new se({keyType:e,valueType:t,typeName:l.ZodRecord,...c(r)}):new se({keyType:d.create(),valueType:e,typeName:l.ZodRecord,...c(t)})}}e.ZodRecord=se;class le extends o{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:a}=this._processInputParams(e);if(a.parsedType!==m.ZodParsedType.map)return(0,g.addIssueToContext)(a,{code:_.ZodIssueCode.invalid_type,expected:m.ZodParsedType.map,received:a.parsedType}),g.INVALID;const i=this._def.keyType,o=this._def.valueType,s=[...a.data.entries()].map(([e,t],r)=>({key:i._parse(new y(a,e,a.path,[r,"key"])),value:o._parse(new y(a,t,a.path,[r,"value"]))}));if(a.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const r of s){var e=await r.key,t=await r.value;if("aborted"===e.status||"aborted"===t.status)return g.INVALID;"dirty"!==e.status&&"dirty"!==t.status||n.dirty(),c.set(e.value,t.value)}return{status:n.value,value:c}})}var t=new Map;for(const u of s){var r=u.key,l=u.value;if("aborted"===r.status||"aborted"===l.status)return g.INVALID;"dirty"!==r.status&&"dirty"!==l.status||n.dirty(),t.set(r.value,l.value)}return{status:n.value,value:t}}}(e.ZodMap=le).create=(e,t,r)=>new le({valueType:t,keyType:e,typeName:l.ZodMap,...c(r)});class R extends o{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==m.ZodParsedType.set)return(0,g.addIssueToContext)(r,{code:_.ZodIssueCode.invalid_type,expected:m.ZodParsedType.set,received:r.parsedType}),g.INVALID;e=this._def;null!==e.minSize&&r.data.size<e.minSize.value&&((0,g.addIssueToContext)(r,{code:_.ZodIssueCode.too_small,minimum:e.minSize.value,type:"set",inclusive:!0,exact:!1,message:e.minSize.message}),n.dirty()),null!==e.maxSize&&r.data.size>e.maxSize.value&&((0,g.addIssueToContext)(r,{code:_.ZodIssueCode.too_big,maximum:e.maxSize.value,type:"set",inclusive:!0,exact:!1,message:e.maxSize.message}),n.dirty());const a=this._def.valueType;function t(e){var t=new Set;for(const r of e){if("aborted"===r.status)return g.INVALID;"dirty"===r.status&&n.dirty(),t.add(r.value)}return{status:n.value,value:t}}e=[...r.data.values()].map((e,t)=>a._parse(new y(r,e,r.path,t)));return r.common.async?Promise.all(e).then(e=>t(e)):t(e)}min(e,t){return new R({...this._def,minSize:{value:e,message:i.errorUtil.toString(t)}})}max(e,t){return new R({...this._def,maxSize:{value:e,message:i.errorUtil.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}(e.ZodSet=R).create=(e,t)=>new R({valueType:e,minSize:null,maxSize:null,typeName:l.ZodSet,...c(t)});class I extends o{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const r=this._processInputParams(e)["ctx"];if(r.parsedType!==m.ZodParsedType.function)return(0,g.addIssueToContext)(r,{code:_.ZodIssueCode.invalid_type,expected:m.ZodParsedType.function,received:r.parsedType}),g.INVALID;function a(e,t){return(0,g.makeIssue)({data:e,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,(0,u.getErrorMap)(),u.defaultErrorMap].filter(e=>!!e),issueData:{code:_.ZodIssueCode.invalid_arguments,argumentsError:t}})}function i(e,t){return(0,g.makeIssue)({data:e,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,(0,u.getErrorMap)(),u.defaultErrorMap].filter(e=>!!e),issueData:{code:_.ZodIssueCode.invalid_return_type,returnTypeError:t}})}const o={errorMap:r.common.contextualErrorMap},s=r.data;if(this._def.returns instanceof N){const l=this;return(0,g.OK)(async function(...t){const r=new _.ZodError([]);var e=await l._def.args.parseAsync(t,o).catch(e=>{throw r.addIssue(a(t,e)),r});const n=await Reflect.apply(s,this,e);return await l._def.returns._def.type.parseAsync(n,o).catch(e=>{throw r.addIssue(i(n,e)),r})})}{const n=this;return(0,g.OK)(function(...e){var t=n._def.args.safeParse(e,o);if(!t.success)throw new _.ZodError([a(e,t.error)]);e=Reflect.apply(s,this,t.data),t=n._def.returns.safeParse(e,o);if(t.success)return t.data;throw new _.ZodError([i(e,t.error)])})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new I({...this._def,args:w.create(e).rest(S.create())})}returns(e){return new I({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new I({args:e||w.create([]).rest(S.create()),returns:t||S.create(),typeName:l.ZodFunction,...c(r)})}}e.ZodFunction=I;class ce extends o{get schema(){return this._def.getter()}_parse(e){e=this._processInputParams(e).ctx;return this._def.getter()._parse({data:e.data,path:e.path,parent:e})}}(e.ZodLazy=ce).create=(e,t)=>new ce({getter:e,typeName:l.ZodLazy,...c(t)});class ue extends o{_parse(e){var t;return e.data!==this._def.value?(t=this._getOrReturnCtx(e),(0,g.addIssueToContext)(t,{received:t.data,code:_.ZodIssueCode.invalid_literal,expected:this._def.value}),g.INVALID):{status:"valid",value:e.data}}get value(){return this._def.value}}function H(e,t){return new M({values:e,typeName:l.ZodEnum,...c(t)})}(e.ZodLiteral=ue).create=(e,t)=>new ue({value:e,typeName:l.ZodLiteral,...c(t)});class M extends o{constructor(){super(...arguments),n.set(this,void 0)}_parse(e){var t,r;return"string"!=typeof e.data?(r=this._getOrReturnCtx(e),t=this._def.values,(0,g.addIssueToContext)(r,{expected:m.util.joinValues(t),received:r.parsedType,code:_.ZodIssueCode.invalid_type}),g.INVALID):(F(this,n,"f")||U(this,n,new Set(this._def.values),"f"),F(this,n,"f").has(e.data)?(0,g.OK)(e.data):(t=this._getOrReturnCtx(e),r=this._def.values,(0,g.addIssueToContext)(t,{received:t.data,code:_.ZodIssueCode.invalid_enum_value,options:r}),g.INVALID))}get options(){return this._def.values}get enum(){var e={};for(const t of this._def.values)e[t]=t;return e}get Values(){var e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){var e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return M.create(e,{...this._def,...t})}exclude(t,e=this._def){return M.create(this.options.filter(e=>!t.includes(e)),{...this._def,...e})}}e.ZodEnum=M,n=new WeakMap,M.create=H;class P extends o{constructor(){super(...arguments),a.set(this,void 0)}_parse(e){var t,r=m.util.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);return n.parsedType!==m.ZodParsedType.string&&n.parsedType!==m.ZodParsedType.number?(t=m.util.objectValues(r),(0,g.addIssueToContext)(n,{expected:m.util.joinValues(t),received:n.parsedType,code:_.ZodIssueCode.invalid_type}),g.INVALID):(F(this,a,"f")||U(this,a,new Set(m.util.getValidEnumValues(this._def.values)),"f"),F(this,a,"f").has(e.data)?(0,g.OK)(e.data):(t=m.util.objectValues(r),(0,g.addIssueToContext)(n,{received:n.data,code:_.ZodIssueCode.invalid_enum_value,options:t}),g.INVALID))}get enum(){return this._def.values}}e.ZodNativeEnum=P,a=new WeakMap,P.create=(e,t)=>new P({values:e,typeName:l.ZodNativeEnum,...c(t)});class N extends o{unwrap(){return this._def.type}_parse(e){const t=this._processInputParams(e)["ctx"];return t.parsedType!==m.ZodParsedType.promise&&!1===t.common.async?((0,g.addIssueToContext)(t,{code:_.ZodIssueCode.invalid_type,expected:m.ZodParsedType.promise,received:t.parsedType}),g.INVALID):(e=t.parsedType===m.ZodParsedType.promise?t.data:Promise.resolve(t.data),(0,g.OK)(e.then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap}))))}}(e.ZodPromise=N).create=(e,t)=>new N({type:e,typeName:l.ZodPromise,...c(t)});class D extends o{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===l.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),n=this._def.effect||null,a={addIssue:e=>{(0,g.addIssueToContext)(r,e),e.fatal?t.abort():t.dirty()},get path(){return r.path}};if(a.addIssue=a.addIssue.bind(a),"preprocess"===n.type)return e=n.transform(r.data,a),r.common.async?Promise.resolve(e).then(async e=>{return"aborted"===t.value||"aborted"===(e=await this._def.schema._parseAsync({data:e,path:r.path,parent:r})).status?g.INVALID:"dirty"===e.status||"dirty"===t.value?(0,g.DIRTY)(e.value):e}):"aborted"===t.value||"aborted"===(e=this._def.schema._parseSync({data:e,path:r.path,parent:r})).status?g.INVALID:"dirty"===e.status||"dirty"===t.value?(0,g.DIRTY)(e.value):e;if("refinement"===n.type){const i=e=>{var t=n.refinement(e,a);if(r.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};return!1===r.common.async?"aborted"===(e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r})).status?g.INVALID:("dirty"===e.status&&t.dirty(),i(e.value),{status:t.value,value:e.value}):this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(e=>"aborted"===e.status?g.INVALID:("dirty"===e.status&&t.dirty(),i(e.value).then(()=>({status:t.value,value:e.value}))))}if("transform"===n.type){if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(e=>(0,g.isValid)(e)?Promise.resolve(n.transform(e.value,a)).then(e=>({status:t.value,value:e})):e);e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!(0,g.isValid)(e))return e;e=n.transform(e.value,a);if(e instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:e}}m.util.assertNever(n)}}e.ZodEffects=D,(e.ZodTransformer=D).create=(e,t,r)=>new D({schema:e,typeName:l.ZodEffects,effect:t,...c(r)}),D.createWithPreprocess=(e,t,r)=>new D({schema:t,effect:{type:"preprocess",transform:e},typeName:l.ZodEffects,...c(r)});class x extends o{_parse(e){return this._getType(e)===m.ZodParsedType.undefined?(0,g.OK)(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}(e.ZodOptional=x).create=(e,t)=>new x({innerType:e,typeName:l.ZodOptional,...c(t)});class L extends o{_parse(e){return this._getType(e)===m.ZodParsedType.null?(0,g.OK)(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}(e.ZodNullable=L).create=(e,t)=>new L({innerType:e,typeName:l.ZodNullable,...c(t)});class de extends o{_parse(e){e=this._processInputParams(e).ctx;let t=e.data;return e.parsedType===m.ZodParsedType.undefined&&(t=this._def.defaultValue()),this._def.innerType._parse({data:t,path:e.path,parent:e})}removeDefault(){return this._def.innerType}}(e.ZodDefault=de).create=(e,t)=>new de({innerType:e,typeName:l.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...c(t)});class fe extends o{_parse(e){e=this._processInputParams(e).ctx;const t={...e,common:{...e.common,issues:[]}};e=this._def.innerType._parse({data:t.data,path:t.path,parent:{...t}});return(0,g.isAsync)(e)?e.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new _.ZodError(t.common.issues)},input:t.data})})):{status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new _.ZodError(t.common.issues)},input:t.data})}}removeCatch(){return this._def.innerType}}(e.ZodCatch=fe).create=(e,t)=>new fe({innerType:e,typeName:l.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...c(t)});class pe extends o{_parse(e){var t;return this._getType(e)!==m.ZodParsedType.nan?(t=this._getOrReturnCtx(e),(0,g.addIssueToContext)(t,{code:_.ZodIssueCode.invalid_type,expected:m.ZodParsedType.nan,received:t.parsedType}),g.INVALID):{status:"valid",value:e.data}}}(e.ZodNaN=pe).create=e=>new pe({typeName:l.ZodNaN,...c(e)}),e.BRAND=Symbol("zod_brand");class he extends o{_parse(e){var e=this._processInputParams(e)["ctx"],t=e.data;return this._def.type._parse({data:t,path:e.path,parent:e})}unwrap(){return this._def.type}}e.ZodBranded=he;class ge extends o{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);return r.common.async?(async()=>{var e=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?g.INVALID:"dirty"===e.status?(t.dirty(),(0,g.DIRTY)(e.value)):this._def.out._parseAsync({data:e.value,path:r.path,parent:r})})():"aborted"===(e=this._def.in._parseSync({data:r.data,path:r.path,parent:r})).status?g.INVALID:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:r.path,parent:r})}static create(e,t){return new ge({in:e,out:t,typeName:l.ZodPipeline})}}e.ZodPipeline=ge;class me extends o{_parse(e){e=this._def.innerType._parse(e);const t=e=>((0,g.isValid)(e)&&(e.value=Object.freeze(e.value)),e);return(0,g.isAsync)(e)?e.then(e=>t(e)):t(e)}unwrap(){return this._def.innerType}}function G(n,a={},i){return n?E.create().superRefine((e,t)=>{var r;n(e)||(r=null==(r=null!=(r=(e="function"==typeof a?a(e):"string"==typeof a?{message:a}:a).fatal)?r:i)||r,t.addIssue({code:"custom",..."string"==typeof e?{message:e}:e,fatal:r}))}):E.create()}(e.ZodReadonly=me).create=(e,t)=>new me({innerType:e,typeName:l.ZodReadonly,...c(t)}),e.custom=G,e.late={object:C.lazycreate},(t=l=e.ZodFirstPartyTypeKind||(e.ZodFirstPartyTypeKind={})).ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly";e.instanceof=(t,e={message:"Input not instance of "+t.name})=>G(e=>e instanceof t,e);const _e=d.create,ye=(e.string=_e,f.create);e.number=ye;var r=pe.create,r=(e.nan=r,p.create);e.bigint=r;const Te=h.create;e.boolean=Te;r=T.create,e.date=r,r=re.create,e.symbol=r,r=b.create,e.undefined=r,r=v.create,e.null=r,r=E.create,e.any=r,r=S.create,e.unknown=r,r=A.create,e.never=r,r=ne.create,e.void=r,r=O.create,e.array=r,r=C.create,e.object=r,r=C.strictCreate,e.strictObject=r,r=ae.create,e.union=r,r=ie.create,e.discriminatedUnion=r,r=oe.create,e.intersection=r,r=w.create,e.tuple=r,r=se.create,e.record=r,r=le.create,e.map=r,r=R.create,e.set=r,r=I.create,e.function=r,r=ce.create,e.lazy=r,r=ue.create,e.literal=r,r=M.create,e.enum=r,r=P.create,e.nativeEnum=r,r=N.create,e.promise=r,r=D.create,e.effect=r,e.transformer=r,r=x.create,e.optional=r,r=L.create,e.nullable=r,r=D.createWithPreprocess,e.preprocess=r,r=ge.create;e.pipeline=r,e.ostring=()=>_e().optional(),e.onumber=()=>ye().optional();e.oboolean=()=>Te().optional(),e.coerce={string:e=>d.create({...e,coerce:!0}),number:e=>f.create({...e,coerce:!0}),boolean:e=>h.create({...e,coerce:!0}),bigint:e=>p.create({...e,coerce:!0}),date:e=>T.create({...e,coerce:!0})},e.NEVER=g.INVALID}}return Qn}function ta(){var e,n,t;return Yn||(Yn=1,e=In,n=be&&be.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),t=be&&be.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)},Object.defineProperty(e,"__esModule",{value:!0}),t(Hn(),e),t(Wn(),e),t((qn||(qn=1,Object.defineProperty($n,"__esModule",{value:!0})),$n),e),t(Dn(),e),t(ea(),e),t(Bn(),e)),In}function ra(){var e,n,a,t,r;return Jn||(Jn=1,e=Rn,n=be&&be.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),a=be&&be.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),t=be&&be.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t},r=be&&be.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)},Object.defineProperty(e,"__esModule",{value:!0}),e.z=void 0,t=t(ta()),e.z=t,r(ta(),e),e.default=t),Rn}function na(){var e,t;return Zn||(Zn=1,e=wn,Object.defineProperty(e,"__esModule",{value:!0}),e.NAMED_RECORD_CONFIG_SCHEMA=e.RECORD_CONFIG_SCHEMA=void 0,e.createEmptyRecordConfig=function(){return e.RECORD_CONFIG_SCHEMA.parse({})},t=ra(),e.RECORD_CONFIG_SCHEMA=t.z.object({mode:t.z.enum(["STOP_WHEN_FULL","RING_BUFFER","LONG_TRACE"]).default("STOP_WHEN_FULL"),durationMs:t.z.number().default(1e4),maxFileSizeMb:t.z.number().default(100),fileWritePeriodMs:t.z.number().default(2500),bufferSizeMb:t.z.number().default(64),cpuSched:t.z.boolean().default(!1),cpuFreq:t.z.boolean().default(!1),cpuFreqPollMs:t.z.number().default(1e3),cpuSyscall:t.z.boolean().default(!1),gpuFreq:t.z.boolean().default(!1),gpuMemTotal:t.z.boolean().default(!1),gpuWorkPeriod:t.z.boolean().default(!1),ftrace:t.z.boolean().default(!1),atrace:t.z.boolean().default(!1),ftraceEvents:t.z.array(t.z.string()).default([]),ftraceExtraEvents:t.z.string().default(""),atraceCats:t.z.array(t.z.string()).default([]),allAtraceApps:t.z.boolean().default(!0),atraceApps:t.z.string().default(""),ftraceBufferSizeKb:t.z.number().default(0),ftraceDrainPeriodMs:t.z.number().default(0),androidLogs:t.z.boolean().default(!1),androidLogBuffers:t.z.array(t.z.string()).default([]),androidFrameTimeline:t.z.boolean().default(!1),androidGameInterventionList:t.z.boolean().default(!1),androidNetworkTracing:t.z.boolean().default(!1),androidNetworkTracingPollMs:t.z.number().default(250),cpuCoarse:t.z.boolean().default(!1),cpuCoarsePollMs:t.z.number().default(1e3),batteryDrain:t.z.boolean().default(!1),batteryDrainPollMs:t.z.number().default(1e3),boardSensors:t.z.boolean().default(!1),memHiFreq:t.z.boolean().default(!1),meminfo:t.z.boolean().default(!1),meminfoPeriodMs:t.z.number().default(1e3),meminfoCounters:t.z.array(t.z.string()).default([]),vmstat:t.z.boolean().default(!1),vmstatPeriodMs:t.z.number().default(1e3),vmstatCounters:t.z.array(t.z.string()).default([]),heapProfiling:t.z.boolean().default(!1),hpSamplingIntervalBytes:t.z.number().default(4096),hpProcesses:t.z.string().default(""),hpContinuousDumpsPhase:t.z.number().default(0),hpContinuousDumpsInterval:t.z.number().default(0),hpSharedMemoryBuffer:t.z.number().default(8388608),hpBlockClient:t.z.boolean().default(!0),hpAllHeaps:t.z.boolean().default(!1),javaHeapDump:t.z.boolean().default(!1),jpProcesses:t.z.string().default(""),jpContinuousDumpsPhase:t.z.number().default(0),jpContinuousDumpsInterval:t.z.number().default(0),memLmk:t.z.boolean().default(!1),procStats:t.z.boolean().default(!1),procStatsPeriodMs:t.z.number().default(1e3),chromeCategoriesSelected:t.z.array(t.z.string()).default([]),chromeHighOverheadCategoriesSelected:t.z.array(t.z.string()).default([]),chromePrivacyFiltering:t.z.boolean().default(!1),chromeLogs:t.z.boolean().default(!1),taskScheduling:t.z.boolean().default(!1),ipcFlows:t.z.boolean().default(!1),jsExecution:t.z.boolean().default(!1),webContentRendering:t.z.boolean().default(!1),uiRendering:t.z.boolean().default(!1),inputEvents:t.z.boolean().default(!1),navigationAndLoading:t.z.boolean().default(!1),audio:t.z.boolean().default(!1),video:t.z.boolean().default(!1),etwCSwitch:t.z.boolean().default(!1),etwThreadState:t.z.boolean().default(!1),symbolizeKsyms:t.z.boolean().default(!1),tracePerf:t.z.boolean().default(!1),timebaseFrequency:t.z.number().default(100),targetCmdLine:t.z.array(t.z.string()).default([]),linuxDeviceRpm:t.z.boolean().default(!1)}).default({}),e.NAMED_RECORD_CONFIG_SCHEMA=t.z.object({title:t.z.string(),key:t.z.string(),config:e.RECORD_CONFIG_SCHEMA})),wn}var aa,ia,oa,sa={},la={},ca={};function ua(){if(!aa){aa=1,Object.defineProperty(ca,"__esModule",{value:!0}),ca.SelectionManager=ca.ProfileType=void 0,ca.selectionToLegacySelection=function e(t){switch(t.kind){case"area":case"single":case"empty":case"note":return null;case"union":for(const r of t.selections){const n=e(r);if(null!==n)return n}return null;case"legacy":return t.legacySelection;default:return(0,a.assertUnreachable)(t),null}};const a=ee();ca.ProfileType={HEAP_PROFILE:"heap_profile",MIXED_HEAP_PROFILE:"heap_profile:com.android.art,libc.malloc",NATIVE_HEAP_PROFILE:"heap_profile:libc.malloc",JAVA_HEAP_SAMPLES:"heap_profile:com.android.art",JAVA_HEAP_GRAPH:"graph",PERF_SAMPLE:"perf"};ca.SelectionManager=class{store;constructor(e){this.store=e}clear(){this.store.edit(e=>{e.selection={kind:"empty"}})}addSelection(t){this.store.edit(e=>{switch(e.selection.kind){case"empty":e.selection=t;break;case"union":e.selection.selections.push(t);break;case"single":case"legacy":case"area":case"note":e.selection={kind:"union",selections:[e.selection,t]};break;default:(0,a.assertUnreachable)(e.selection)}})}setLegacy(e){this.clear(),this.addSelection({kind:"legacy",legacySelection:e})}setEvent(e,t,r){this.clear(),this.addEvent(e,t,r)}addEvent(e,t,r){this.addSelection({kind:"single",trackKey:e,eventId:t}),r&&this.addSelection({kind:"legacy",legacySelection:r})}}}return ca}function Y(){if(!ia){ia=1;{var e=la;Object.defineProperty(e,"__esModule",{value:!0}),e.InThreadTrackSortKey=e.SCROLLING_TRACK_GROUP=e.STATE_VERSION=e.MAX_TIME=e.PrimaryTrackSortKey=e.ProfileType=void 0,e.isAndroidP=function(e){return"P"===e.os},e.isAndroidTarget=function(e){return["Q","P","O"].includes(e.os)},e.isChromeTarget=function(e){return["C","CrOS"].includes(e.os)},e.isCrOSTarget=function(e){return"CrOS"===e.os},e.isLinuxTarget=function(e){return"L"===e.os},e.isWindowsTarget=function(e){return"Win"===e.os},e.isAdbTarget=function(e){return!!e.serial},e.hasActiveProbes=function(e){var t=new Set(["hpBlockClient","allAtraceApps","chromePrivacyFiltering"]);let r;for(r in e)if("boolean"==typeof e[r]&&!0===e[r]&&!t.has(r))return!0;if(0<e.chromeCategoriesSelected.length)return!0;return 0<e.chromeHighOverheadCategoriesSelected.length},e.getDefaultRecordingTargets=function(){return[{os:"Q",name:"Android Q+ / 10+"},{os:"P",name:"Android P / 9"},{os:"O",name:"Android O- / 8-"},{os:"C",name:"Chrome"},{os:"CrOS",name:"Chrome OS (system trace)"},{os:"L",name:"Linux desktop"},{os:"Win",name:"Windows desktop"}]},e.getBuiltinChromeCategoryList=function(){return["accessibility","AccountFetcherService","android.adpf","android.ui.jank","android_webview","android_webview.timeline","aogh","audio","base","benchmark","blink","blink.animations","blink.bindings","blink.console","blink.net","blink.resource","blink.user_timing","blink.worker","blink_style","Blob","browser","browsing_data","CacheStorage","Calculators","CameraStream","cppgc","camera","cast_app","cast_perf_test","cast.mdns","cast.mdns.socket","cast.stream","cc","cc.debug","cdp.perf","chromeos","cma","compositor","content","content_capture","interactions","delegated_ink_trails","device","devtools","devtools.contrast","devtools.timeline","disk_cache","download","download_service","drm","drmcursor","dwrite","DXVA_Decoding","evdev","event","event_latency","exo","extensions","explore_sites","FileSystem","file_system_provider","fledge","fonts","GAMEPAD","gpu","gpu.angle","gpu.angle.texture_metrics","gpu.capture","graphics.pipeline","headless","history","hwoverlays","identity","ime","IndexedDB","input","input.scrolling","io","ipc","Java","jni","jpeg","latency","latencyInfo","leveldb","loading","log","login","media","media_router","memory","midi","mojom","mus","native","navigation","navigation.debug","net","network.scheduler","netlog","offline_pages","omnibox","oobe","openscreen","ozone","partition_alloc","passwords","p2p","page-serialization","paint_preview","pepper","PlatformMalloc","power","ppapi","ppapi_proxy","print","raf_investigation","rail","renderer","renderer_host","renderer.scheduler","resources","RLZ","ServiceWorker","SiteEngagement","safe_browsing","scheduler","scheduler.long_tasks","screenlock_monitor","segmentation_platform","sequence_manager","service_manager","sharing","shell","shortcut_viewer","shutdown","skia","sql","stadia_media","stadia_rtc","startup","sync","system_apps","test_gpu","toplevel","toplevel.flow","ui","v8","v8.execute","v8.wasm","ValueStoreFrontend::Backend","views","views.frame","viz","vk","wakeup.flow","wayland","webaudio","webengine.fidl","weblayer","WebCore","webnn","webrtc","webrtc_stats","xr","disabled-by-default-android_view_hierarchy","disabled-by-default-animation-worklet","disabled-by-default-audio","disabled-by-default-audio.latency","disabled-by-default-audio-worklet","disabled-by-default-base","disabled-by-default-blink.debug","disabled-by-default-blink.debug.display_lock","disabled-by-default-blink.debug.layout","disabled-by-default-blink.debug.layout.trees","disabled-by-default-blink.feature_usage","disabled-by-default-blink.image_decoding","disabled-by-default-blink.invalidation","disabled-by-default-identifiability","disabled-by-default-identifiability.high_entropy_api","disabled-by-default-cc","disabled-by-default-cc.debug","disabled-by-default-cc.debug.cdp-perf","disabled-by-default-cc.debug.display_items","disabled-by-default-cc.debug.lcd_text","disabled-by-default-cc.debug.picture","disabled-by-default-cc.debug.scheduler","disabled-by-default-cc.debug.scheduler.frames","disabled-by-default-cc.debug.scheduler.now","disabled-by-default-content.verbose","disabled-by-default-cpu_profiler","disabled-by-default-cppgc","disabled-by-default-cpu_profiler.debug","disabled-by-default-devtools.screenshot","disabled-by-default-devtools.timeline","disabled-by-default-devtools.timeline.frame","disabled-by-default-devtools.timeline.inputs","disabled-by-default-devtools.timeline.invalidationTracking","disabled-by-default-devtools.timeline.layers","disabled-by-default-devtools.timeline.picture","disabled-by-default-devtools.timeline.stack","disabled-by-default-devtools.target-rundown","disabled-by-default-devtools.v8-source-rundown","disabled-by-default-devtools.v8-source-rundown-sources","disabled-by-default-file","disabled-by-default-fonts","disabled-by-default-gpu_cmd_queue","disabled-by-default-gpu.dawn","disabled-by-default-gpu.debug","disabled-by-default-gpu.decoder","disabled-by-default-gpu.device","disabled-by-default-gpu.graphite.dawn","disabled-by-default-gpu.service","disabled-by-default-gpu.vulkan.vma","disabled-by-default-histogram_samples","disabled-by-default-java-heap-profiler","disabled-by-default-layer-element","disabled-by-default-layout_shift.debug","disabled-by-default-lifecycles","disabled-by-default-loading","disabled-by-default-mediastream","disabled-by-default-memory-infra","disabled-by-default-memory-infra.v8.code_stats","disabled-by-default-mojom","disabled-by-default-net","disabled-by-default-network","disabled-by-default-paint-worklet","disabled-by-default-power","disabled-by-default-renderer.scheduler","disabled-by-default-renderer.scheduler.debug","disabled-by-default-sequence_manager","disabled-by-default-sequence_manager.debug","disabled-by-default-sequence_manager.verbose_snapshots","disabled-by-default-skia","disabled-by-default-skia.gpu","disabled-by-default-skia.gpu.cache","disabled-by-default-skia.shaders","disabled-by-default-skottie","disabled-by-default-SyncFileSystem","disabled-by-default-system_power","disabled-by-default-system_stats","disabled-by-default-thread_pool_diagnostics","disabled-by-default-toplevel.ipc","disabled-by-default-user_action_samples","disabled-by-default-v8.compile","disabled-by-default-v8.cpu_profiler","disabled-by-default-v8.gc","disabled-by-default-v8.gc_stats","disabled-by-default-v8.ic_stats","disabled-by-default-v8.inspector","disabled-by-default-v8.runtime","disabled-by-default-v8.runtime_stats","disabled-by-default-v8.runtime_stats_sampling","disabled-by-default-v8.stack_trace","disabled-by-default-v8.turbofan","disabled-by-default-v8.wasm.detailed","disabled-by-default-v8.wasm.turbofan","disabled-by-default-video_and_image_capture","disabled-by-default-display.framedisplayed","disabled-by-default-viz.gpu_composite_time","disabled-by-default-viz.debug.overlay_planes","disabled-by-default-viz.hit_testing_flow","disabled-by-default-viz.overdraw","disabled-by-default-viz.quads","disabled-by-default-viz.surface_id_flow","disabled-by-default-viz.surface_lifetime","disabled-by-default-viz.triangles","disabled-by-default-viz.visual_debugger","disabled-by-default-webaudio.audionode","disabled-by-default-webgpu","disabled-by-default-webnn","disabled-by-default-webrtc","disabled-by-default-worker.scheduler","disabled-by-default-xr.debug"]},e.getContainingGroupKey=function(e,t){e=e.tracks[t];if(void 0===e)return null;t=e.trackGroup;return t||null},e.getLegacySelection=function(e){return(0,r.selectionToLegacySelection)(e.selection)};const r=ua();var t=ua();Object.defineProperty(e,"ProfileType",{enumerable:!0,get:function(){return t.ProfileType}}),e.PrimaryTrackSortKey={DEBUG_TRACK:0,0:"DEBUG_TRACK",NULL_TRACK:1,1:"NULL_TRACK",PROCESS_SCHEDULING_TRACK:2,2:"PROCESS_SCHEDULING_TRACK",PROCESS_SUMMARY_TRACK:3,3:"PROCESS_SUMMARY_TRACK",EXPECTED_FRAMES_SLICE_TRACK:4,4:"EXPECTED_FRAMES_SLICE_TRACK",ACTUAL_FRAMES_SLICE_TRACK:5,5:"ACTUAL_FRAMES_SLICE_TRACK",PERF_SAMPLES_PROFILE_TRACK:6,6:"PERF_SAMPLES_PROFILE_TRACK",HEAP_PROFILE_TRACK:7,7:"HEAP_PROFILE_TRACK",MAIN_THREAD:8,8:"MAIN_THREAD",RENDER_THREAD:9,9:"RENDER_THREAD",GPU_COMPLETION_THREAD:10,10:"GPU_COMPLETION_THREAD",CHROME_IO_THREAD:11,11:"CHROME_IO_THREAD",CHROME_COMPOSITOR_THREAD:12,12:"CHROME_COMPOSITOR_THREAD",ORDINARY_THREAD:13,13:"ORDINARY_THREAD",COUNTER_TRACK:14,14:"COUNTER_TRACK",ASYNC_SLICE_TRACK:15,15:"ASYNC_SLICE_TRACK",ORDINARY_TRACK:16,16:"ORDINARY_TRACK"},e.MAX_TIME=180,e.STATE_VERSION=61,e.SCROLLING_TRACK_GROUP="ScrollingTracks",e.InThreadTrackSortKey={THREAD_COUNTER_TRACK:0,0:"THREAD_COUNTER_TRACK",THREAD_SCHEDULING_STATE_TRACK:1,1:"THREAD_SCHEDULING_STATE_TRACK",CPU_STACK_SAMPLES_TRACK:2,2:"CPU_STACK_SAMPLES_TRACK",VISUALISED_ARGS_TRACK:3,3:"VISUALISED_ARGS_TRACK",ORDINARY:4,4:"ORDINARY",DEFAULT_TRACK:5,5:"DEFAULT_TRACK"}}}return la}function da(){if(!oa){oa=1,Object.defineProperty(sa,"__esModule",{value:!0}),sa.recordTargetStore=sa.RecordTargetStore=sa.autosaveConfigStore=sa.AutosaveConfigStore=sa.recordConfigStore=sa.RecordConfigStore=void 0;const i=z(),r=Y(),o=na(),s="recordConfigs",n="autosaveConfig",t="recordTargetOS";class e{recordConfigs;recordConfigNames;constructor(){this.recordConfigs=[],this.recordConfigNames=new Set,this.reloadFromLocalStorage()}_save(){window.localStorage.setItem(s,JSON.stringify(this.recordConfigs))}save(e,t){this.reloadFromLocalStorage();t=t??(new Date).toJSON(),e={title:t,config:e,key:(new Date).toJSON()};this.recordConfigs.push(e),this.recordConfigNames.add(t),this._save()}overwrite(e,t){this.reloadFromLocalStorage();var r=this.recordConfigs.find(e=>e.key===t);if(void 0===r)throw new Error("trying to overwrite non-existing config");r.config=e,this._save()}delete(t){this.reloadFromLocalStorage();let r=-1;for(let e=0;e<this.recordConfigs.length;++e)if(this.recordConfigs[e].key===t){r=e;break}-1!==r?(this.recordConfigNames.delete(this.recordConfigs[r].title),this.recordConfigs.splice(r,1),this._save()):console.warn("The config selected doesn't exist any more")}clearRecordConfigs(){this.recordConfigs=[],this.recordConfigNames.clear(),this._save()}reloadFromLocalStorage(){var e=window.localStorage.getItem(s);if((0,i.exists)(e)){this.recordConfigNames.clear();try{var t=[],r=JSON.parse(e);if(Array.isArray(r)){for(let e=0;e<r.length;++e){var n=r[e],a=o.NAMED_RECORD_CONFIG_SCHEMA.safeParse(n);a.success?t.push(a.data):console.log("Validation of saved record config has failed: ",a.error.toString())}this.recordConfigs=t,this._save()}else this.clearRecordConfigs()}catch(e){this.clearRecordConfigs()}}else this.clearRecordConfigs()}canSave(e){return!this.recordConfigNames.has(e)}}sa.RecordConfigStore=e,sa.recordConfigStore=new e;class a{config;hasSavedConfig;constructor(){this.hasSavedConfig=!1,this.config=(0,o.createEmptyRecordConfig)();var e,t=window.localStorage.getItem(n);null!==t&&null!==(t=JSON.parse(t))&&"object"==typeof t&&(e=o.RECORD_CONFIG_SCHEMA.safeParse(t)).success&&(this.config=e.data,this.hasSavedConfig=!0)}get(){return this.config}save(e){window.localStorage.setItem(n,JSON.stringify(e)),this.config=e,this.hasSavedConfig=!0}}sa.AutosaveConfigStore=a,sa.autosaveConfigStore=new a;class l{recordTargetOS;constructor(){this.recordTargetOS=window.localStorage.getItem(t)}get(){return this.recordTargetOS}getValidTarget(){var e=(0,r.getDefaultRecordingTargets)();const t=this.get();return e.find(e=>e.os===t)||e[0]}save(e){window.localStorage.setItem(t,e),this.recordTargetOS=e}}sa.RecordTargetStore=l,sa.recordTargetStore=new l}return sa}var fa,pa,ha={};function ga(){if(!fa){fa=1,Object.defineProperty(ha,"__esModule",{value:!0}),ha.SqlTables=void 0;ha.SqlTables=class{static slice={imports:["slices.slices"],name:"_slice_with_thread_and_process_info",displayName:"slice",columns:[{name:"id",title:"ID",display:{type:"slice_id",ts:"ts",dur:"dur",trackId:"track_id"}},{name:"ts",title:"Timestamp",display:{type:"timestamp"}},{name:"dur",title:"Duration",display:{type:"duration"}},{name:"thread_dur",title:"Thread duration",display:{type:"thread_duration"}},{name:"category",title:"Category"},{name:"name",title:"Name"},{name:"track_id",title:"Track ID",startsHidden:!0},{name:"track_name",title:"Track name",startsHidden:!0},{name:"thread_name",title:"Thread name"},{name:"utid",startsHidden:!0},{name:"tid"},{name:"process_name",title:"Process name"},{name:"upid",startsHidden:!0},{name:"pid"},{name:"depth",title:"Depth",startsHidden:!0},{name:"parent_id",title:"Parent slice ID",startsHidden:!0},{name:"arg_set_id",title:"Arg",type:"arg_set_id"}]}}}return ha}function ma(){if(!pa){pa=1;{var e=kn;Object.defineProperty(e,"__esModule",{value:!0}),e.COUNT_AGGREGATION=void 0,e.keyedMap=function(e,...t){var r=new Map;for(const n of t)r.set(e(n),n);return r},e.createEmptyNonSerializableState=r,e.createEmptyState=function(){return{version:s.STATE_VERSION,nextId:"-1",newEngineMode:"USE_HTTP_RPC_IF_AVAILABLE",tracks:{},utidToThreadSortKey:{},aggregatePreferences:{},trackGroups:{},pinnedTracks:[],scrollingTracks:[],queries:{},notes:{},recordConfig:l.get()?i.autosaveConfigStore.get():(0,a.createEmptyRecordConfig)(),displayConfigAsPbtxt:!1,lastLoadedConfig:{type:"NONE"},omniboxState:{omnibox:"",mode:"SEARCH"},status:{msg:"",timestamp:0},selection:{kind:"empty"},traceConversionInProgress:!1,perfDebug:!1,sidebarVisible:!1,hoveredUtid:-1,hoveredPid:-1,hoverCursorTimestamp:n.Time.INVALID,hoveredNoteTimestamp:n.Time.INVALID,highlightedSliceId:-1,focusedFlowIdLeft:-1,focusedFlowIdRight:-1,searchIndex:-1,tabs:{currentTab:"current_selection",openTabs:[]},recordingInProgress:!1,recordingCancelled:!1,extensionInstalled:!1,flamegraphModalDismissed:!1,recordingTarget:i.recordTargetStore.getValidTarget(),availableAdbDevices:[],fetchChromeCategories:!1,chromeCategories:void 0,nonSerializableState:r(),plugins:{},trackFilterTerm:void 0}};const n=K(),a=na();var t=re();const i=da(),o=ga(),s=Y(),l=t.featureFlags.register({id:"autoloadStartedConfig",name:"Auto-load last used recording config",description:"Starting a recording automatically saves its configuration. This flag controls whether this config is automatically loaded.",defaultValue:!0});function r(){return{pivotTable:{queryResult:null,selectedPivots:[{kind:"regular",table:o.SqlTables.slice.name,column:"name"}],selectedAggregations:[{aggregationFunction:"SUM",column:{kind:"regular",table:o.SqlTables.slice.name,column:"dur"},sortDirection:"DESC"},{aggregationFunction:"SUM",column:{kind:"regular",table:o.SqlTables.slice.name,column:"thread_dur"}},e.COUNT_AGGREGATION],constrainToArea:!0,queryRequested:!1}}}e.COUNT_AGGREGATION={aggregationFunction:"COUNT",column:{kind:"regular",table:"",column:""}}}}return kn}var _a,ya,Ta,ba,va,Ea={},sr={};function Sa(){var n,o,a,i,s,e,t,r,L,l;return Ta||(Ta=1,Object.defineProperty(sr,"__esModule",{value:!0}),sr.TrackEventConfig=sr.TraceProcessorRpcStream=sr.TraceProcessorRpc=sr.TraceProcessorApiVersion=sr.TraceConfig=sr.SysStatsConfig=sr.StatusResult=sr.StatCounters=sr.ResetTraceProcessorArgs=sr.ReadBuffersResponse=sr.ReadBuffersRequest=sr.QueryServiceStateResponse=sr.QueryServiceStateRequest=sr.QueryResult=sr.QueryArgs=sr.ProcessStatsConfig=sr.PerfEvents=sr.PerfEventConfig=sr.PerfettoMetatrace=sr.NetworkPacketTraceConfig=sr.NativeContinuousDumpConfig=sr.MetatraceCategories=sr.MeminfoCounters=sr.JavaHprofConfig=sr.JavaContinuousDumpConfig=sr.IPCFrame=sr.HeapprofdConfig=sr.GetTraceStatsResponse=sr.GetTraceStatsRequest=sr.FtraceConfig=sr.FreeBuffersResponse=sr.FreeBuffersRequest=sr.EtwConfig=sr.EnableTracingResponse=sr.EnableTracingRequest=sr.EnableMetatraceArgs=sr.DisableTracingResponse=sr.DisableTracingRequest=sr.DisableAndReadMetatraceResult=sr.DataSourceDescriptor=sr.DataSourceConfig=sr.ConsumerPort=sr.ComputeMetricResult=sr.ComputeMetricArgs=sr.ChromeConfig=sr.BufferConfig=sr.BatteryCounters=sr.AndroidPowerConfig=sr.AndroidLogId=sr.AndroidLogConfig=void 0,sr.VmstatCounters=void 0,t=(e=or.__importDefault((ya||(ya=1,n=lr(),o=n.Reader,a=n.Writer,i=n.util,(s=n.roots.default||(n.roots.default={})).perfetto=((L={}).protos=((r={}).ConsumerPort=(((c.prototype=Object.create(n.rpc.Service.prototype)).constructor=c).create=function(e,t,r){return new this(e,t,r)},Object.defineProperty(c.prototype.enableTracing=function e(t,r){return this.rpcCall(e,s.perfetto.protos.EnableTracingRequest,s.perfetto.protos.EnableTracingResponse,t,r)},"name",{value:"EnableTracing"}),Object.defineProperty(c.prototype.disableTracing=function e(t,r){return this.rpcCall(e,s.perfetto.protos.DisableTracingRequest,s.perfetto.protos.DisableTracingResponse,t,r)},"name",{value:"DisableTracing"}),Object.defineProperty(c.prototype.readBuffers=function e(t,r){return this.rpcCall(e,s.perfetto.protos.ReadBuffersRequest,s.perfetto.protos.ReadBuffersResponse,t,r)},"name",{value:"ReadBuffers"}),Object.defineProperty(c.prototype.freeBuffers=function e(t,r){return this.rpcCall(e,s.perfetto.protos.FreeBuffersRequest,s.perfetto.protos.FreeBuffersResponse,t,r)},"name",{value:"FreeBuffers"}),Object.defineProperty(c.prototype.flush=function e(t,r){return this.rpcCall(e,s.perfetto.protos.FlushRequest,s.perfetto.protos.FlushResponse,t,r)},"name",{value:"Flush"}),Object.defineProperty(c.prototype.startTracing=function e(t,r){return this.rpcCall(e,s.perfetto.protos.StartTracingRequest,s.perfetto.protos.StartTracingResponse,t,r)},"name",{value:"StartTracing"}),Object.defineProperty(c.prototype.changeTraceConfig=function e(t,r){return this.rpcCall(e,s.perfetto.protos.ChangeTraceConfigRequest,s.perfetto.protos.ChangeTraceConfigResponse,t,r)},"name",{value:"ChangeTraceConfig"}),Object.defineProperty(c.prototype.detach=function e(t,r){return this.rpcCall(e,s.perfetto.protos.DetachRequest,s.perfetto.protos.DetachResponse,t,r)},"name",{value:"Detach"}),Object.defineProperty(c.prototype.attach=function e(t,r){return this.rpcCall(e,s.perfetto.protos.AttachRequest,s.perfetto.protos.AttachResponse,t,r)},"name",{value:"Attach"}),Object.defineProperty(c.prototype.getTraceStats=function e(t,r){return this.rpcCall(e,s.perfetto.protos.GetTraceStatsRequest,s.perfetto.protos.GetTraceStatsResponse,t,r)},"name",{value:"GetTraceStats"}),Object.defineProperty(c.prototype.observeEvents=function e(t,r){return this.rpcCall(e,s.perfetto.protos.ObserveEventsRequest,s.perfetto.protos.ObserveEventsResponse,t,r)},"name",{value:"ObserveEvents"}),Object.defineProperty(c.prototype.queryServiceState=function e(t,r){return this.rpcCall(e,s.perfetto.protos.QueryServiceStateRequest,s.perfetto.protos.QueryServiceStateResponse,t,r)},"name",{value:"QueryServiceState"}),Object.defineProperty(c.prototype.queryCapabilities=function e(t,r){return this.rpcCall(e,s.perfetto.protos.QueryCapabilitiesRequest,s.perfetto.protos.QueryCapabilitiesResponse,t,r)},"name",{value:"QueryCapabilities"}),Object.defineProperty(c.prototype.saveTraceForBugreport=function e(t,r){return this.rpcCall(e,s.perfetto.protos.SaveTraceForBugreportRequest,s.perfetto.protos.SaveTraceForBugreportResponse,t,r)},"name",{value:"SaveTraceForBugreport"}),Object.defineProperty(c.prototype.cloneSession=function e(t,r){return this.rpcCall(e,s.perfetto.protos.CloneSessionRequest,s.perfetto.protos.CloneSessionResponse,t,r)},"name",{value:"CloneSession"}),c),r.EnableTracingRequest=(F.prototype.traceConfig=null,F.prototype.attachNotificationOnly=!1,F.create=function(e){return new F(e)},F.encode=function(e,t){return t=t||a.create(),null!=e.traceConfig&&Object.hasOwnProperty.call(e,"traceConfig")&&s.perfetto.protos.TraceConfig.encode(e.traceConfig,t.uint32(10).fork()).ldelim(),null!=e.attachNotificationOnly&&Object.hasOwnProperty.call(e,"attachNotificationOnly")&&t.uint32(16).bool(e.attachNotificationOnly),t},F.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.EnableTracingRequest;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.traceConfig=s.perfetto.protos.TraceConfig.decode(e,e.uint32());break;case 2:n.attachNotificationOnly=e.bool();break;default:e.skipType(7&a)}}return n},F.fromObject=function(e){if(e instanceof s.perfetto.protos.EnableTracingRequest)return e;var t=new s.perfetto.protos.EnableTracingRequest;if(null!=e.traceConfig){if("object"!=typeof e.traceConfig)throw TypeError(".perfetto.protos.EnableTracingRequest.traceConfig: object expected");t.traceConfig=s.perfetto.protos.TraceConfig.fromObject(e.traceConfig)}return null!=e.attachNotificationOnly&&(t.attachNotificationOnly=Boolean(e.attachNotificationOnly)),t},F.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.traceConfig=null,r.attachNotificationOnly=!1),null!=e.traceConfig&&e.hasOwnProperty("traceConfig")&&(r.traceConfig=s.perfetto.protos.TraceConfig.toObject(e.traceConfig,t)),null!=e.attachNotificationOnly&&e.hasOwnProperty("attachNotificationOnly")&&(r.attachNotificationOnly=e.attachNotificationOnly),r},F.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},F.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.EnableTracingRequest"},F),r.EnableTracingResponse=(U.prototype.disabled=null,U.prototype.error="",Object.defineProperty(U.prototype,"state",{get:i.oneOfGetter(e=["disabled"]),set:i.oneOfSetter(e)}),U.create=function(e){return new U(e)},U.encode=function(e,t){return t=t||a.create(),null!=e.disabled&&Object.hasOwnProperty.call(e,"disabled")&&t.uint32(8).bool(e.disabled),null!=e.error&&Object.hasOwnProperty.call(e,"error")&&t.uint32(26).string(e.error),t},U.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.EnableTracingResponse;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.disabled=e.bool();break;case 3:n.error=e.string();break;default:e.skipType(7&a)}}return n},U.fromObject=function(e){var t;return e instanceof s.perfetto.protos.EnableTracingResponse?e:(t=new s.perfetto.protos.EnableTracingResponse,null!=e.disabled&&(t.disabled=Boolean(e.disabled)),null!=e.error&&(t.error=String(e.error)),t)},U.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.error=""),null!=e.disabled&&e.hasOwnProperty("disabled")&&(r.disabled=e.disabled,t.oneofs)&&(r.state="disabled"),null!=e.error&&e.hasOwnProperty("error")&&(r.error=e.error),r},U.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},U.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.EnableTracingResponse"},U),r.StartTracingRequest=(B.create=function(e){return new B(e)},B.encode=function(e,t){return t=t||a.create()},B.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,t=new s.perfetto.protos.StartTracingRequest;e.pos<r;){var n=e.uint32();e.skipType(7&n)}return t},B.fromObject=function(e){return e instanceof s.perfetto.protos.StartTracingRequest?e:new s.perfetto.protos.StartTracingRequest},B.toObject=function(){return{}},B.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},B.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.StartTracingRequest"},B),r.StartTracingResponse=(j.create=function(e){return new j(e)},j.encode=function(e,t){return t=t||a.create()},j.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,t=new s.perfetto.protos.StartTracingResponse;e.pos<r;){var n=e.uint32();e.skipType(7&n)}return t},j.fromObject=function(e){return e instanceof s.perfetto.protos.StartTracingResponse?e:new s.perfetto.protos.StartTracingResponse},j.toObject=function(){return{}},j.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},j.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.StartTracingResponse"},j),r.ChangeTraceConfigRequest=(H.prototype.traceConfig=null,H.create=function(e){return new H(e)},H.encode=function(e,t){return t=t||a.create(),null!=e.traceConfig&&Object.hasOwnProperty.call(e,"traceConfig")&&s.perfetto.protos.TraceConfig.encode(e.traceConfig,t.uint32(10).fork()).ldelim(),t},H.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.ChangeTraceConfigRequest;e.pos<r;){var a=e.uint32();a>>>3==1?n.traceConfig=s.perfetto.protos.TraceConfig.decode(e,e.uint32()):e.skipType(7&a)}return n},H.fromObject=function(e){if(e instanceof s.perfetto.protos.ChangeTraceConfigRequest)return e;var t=new s.perfetto.protos.ChangeTraceConfigRequest;if(null!=e.traceConfig){if("object"!=typeof e.traceConfig)throw TypeError(".perfetto.protos.ChangeTraceConfigRequest.traceConfig: object expected");t.traceConfig=s.perfetto.protos.TraceConfig.fromObject(e.traceConfig)}return t},H.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.traceConfig=null),null!=e.traceConfig&&e.hasOwnProperty("traceConfig")&&(r.traceConfig=s.perfetto.protos.TraceConfig.toObject(e.traceConfig,t)),r},H.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},H.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.ChangeTraceConfigRequest"},H),r.ChangeTraceConfigResponse=(G.create=function(e){return new G(e)},G.encode=function(e,t){return t=t||a.create()},G.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,t=new s.perfetto.protos.ChangeTraceConfigResponse;e.pos<r;){var n=e.uint32();e.skipType(7&n)}return t},G.fromObject=function(e){return e instanceof s.perfetto.protos.ChangeTraceConfigResponse?e:new s.perfetto.protos.ChangeTraceConfigResponse},G.toObject=function(){return{}},G.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},G.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.ChangeTraceConfigResponse"},G),r.DisableTracingRequest=(V.create=function(e){return new V(e)},V.encode=function(e,t){return t=t||a.create()},V.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,t=new s.perfetto.protos.DisableTracingRequest;e.pos<r;){var n=e.uint32();e.skipType(7&n)}return t},V.fromObject=function(e){return e instanceof s.perfetto.protos.DisableTracingRequest?e:new s.perfetto.protos.DisableTracingRequest},V.toObject=function(){return{}},V.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},V.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.DisableTracingRequest"},V),r.DisableTracingResponse=(W.create=function(e){return new W(e)},W.encode=function(e,t){return t=t||a.create()},W.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,t=new s.perfetto.protos.DisableTracingResponse;e.pos<r;){var n=e.uint32();e.skipType(7&n)}return t},W.fromObject=function(e){return e instanceof s.perfetto.protos.DisableTracingResponse?e:new s.perfetto.protos.DisableTracingResponse},W.toObject=function(){return{}},W.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},W.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.DisableTracingResponse"},W),r.ReadBuffersRequest=(q.create=function(e){return new q(e)},q.encode=function(e,t){return t=t||a.create()},q.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,t=new s.perfetto.protos.ReadBuffersRequest;e.pos<r;){var n=e.uint32();e.skipType(7&n)}return t},q.fromObject=function(e){return e instanceof s.perfetto.protos.ReadBuffersRequest?e:new s.perfetto.protos.ReadBuffersRequest},q.toObject=function(){return{}},q.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},q.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.ReadBuffersRequest"},q),r.ReadBuffersResponse=($.prototype.slices=i.emptyArray,$.create=function(e){return new $(e)},$.encode=function(e,t){if(t=t||a.create(),null!=e.slices&&e.slices.length)for(var r=0;r<e.slices.length;++r)s.perfetto.protos.ReadBuffersResponse.Slice.encode(e.slices[r],t.uint32(18).fork()).ldelim();return t},$.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.ReadBuffersResponse;e.pos<r;){var a=e.uint32();a>>>3==2?(n.slices&&n.slices.length||(n.slices=[]),n.slices.push(s.perfetto.protos.ReadBuffersResponse.Slice.decode(e,e.uint32()))):e.skipType(7&a)}return n},$.fromObject=function(e){if(e instanceof s.perfetto.protos.ReadBuffersResponse)return e;var t=new s.perfetto.protos.ReadBuffersResponse;if(e.slices){if(!Array.isArray(e.slices))throw TypeError(".perfetto.protos.ReadBuffersResponse.slices: array expected");t.slices=[];for(var r=0;r<e.slices.length;++r){if("object"!=typeof e.slices[r])throw TypeError(".perfetto.protos.ReadBuffersResponse.slices: object expected");t.slices[r]=s.perfetto.protos.ReadBuffersResponse.Slice.fromObject(e.slices[r])}}return t},$.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.slices=[]),e.slices&&e.slices.length){r.slices=[];for(var n=0;n<e.slices.length;++n)r.slices[n]=s.perfetto.protos.ReadBuffersResponse.Slice.toObject(e.slices[n],t)}return r},$.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},$.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.ReadBuffersResponse"},$.Slice=(z.prototype.data=i.newBuffer([]),z.prototype.lastSliceForPacket=!1,z.create=function(e){return new z(e)},z.encode=function(e,t){return t=t||a.create(),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(10).bytes(e.data),null!=e.lastSliceForPacket&&Object.hasOwnProperty.call(e,"lastSliceForPacket")&&t.uint32(16).bool(e.lastSliceForPacket),t},z.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.ReadBuffersResponse.Slice;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.data=e.bytes();break;case 2:n.lastSliceForPacket=e.bool();break;default:e.skipType(7&a)}}return n},z.fromObject=function(e){var t;return e instanceof s.perfetto.protos.ReadBuffersResponse.Slice?e:(t=new s.perfetto.protos.ReadBuffersResponse.Slice,null!=e.data&&("string"==typeof e.data?i.base64.decode(e.data,t.data=i.newBuffer(i.base64.length(e.data)),0):0<=e.data.length&&(t.data=e.data)),null!=e.lastSliceForPacket&&(t.lastSliceForPacket=Boolean(e.lastSliceForPacket)),t)},z.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(t.bytes===String?r.data="":(r.data=[],t.bytes!==Array&&(r.data=i.newBuffer(r.data))),r.lastSliceForPacket=!1),null!=e.data&&e.hasOwnProperty("data")&&(r.data=t.bytes===String?i.base64.encode(e.data,0,e.data.length):t.bytes===Array?Array.prototype.slice.call(e.data):e.data),null!=e.lastSliceForPacket&&e.hasOwnProperty("lastSliceForPacket")&&(r.lastSliceForPacket=e.lastSliceForPacket),r},z.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},z.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.ReadBuffersResponse.Slice"},z),$),r.FreeBuffersRequest=(K.prototype.bufferIds=i.emptyArray,K.create=function(e){return new K(e)},K.encode=function(e,t){if(t=t||a.create(),null!=e.bufferIds&&e.bufferIds.length)for(var r=0;r<e.bufferIds.length;++r)t.uint32(8).uint32(e.bufferIds[r]);return t},K.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.FreeBuffersRequest;e.pos<r;){var a=e.uint32();if(a>>>3==1)if(n.bufferIds&&n.bufferIds.length||(n.bufferIds=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.bufferIds.push(e.uint32());else n.bufferIds.push(e.uint32());else e.skipType(7&a)}return n},K.fromObject=function(e){if(e instanceof s.perfetto.protos.FreeBuffersRequest)return e;var t=new s.perfetto.protos.FreeBuffersRequest;if(e.bufferIds){if(!Array.isArray(e.bufferIds))throw TypeError(".perfetto.protos.FreeBuffersRequest.bufferIds: array expected");t.bufferIds=[];for(var r=0;r<e.bufferIds.length;++r)t.bufferIds[r]=e.bufferIds[r]>>>0}return t},K.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.bufferIds=[]),e.bufferIds&&e.bufferIds.length){r.bufferIds=[];for(var n=0;n<e.bufferIds.length;++n)r.bufferIds[n]=e.bufferIds[n]}return r},K.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},K.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.FreeBuffersRequest"},K),r.FreeBuffersResponse=(Y.create=function(e){return new Y(e)},Y.encode=function(e,t){return t=t||a.create()},Y.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,t=new s.perfetto.protos.FreeBuffersResponse;e.pos<r;){var n=e.uint32();e.skipType(7&n)}return t},Y.fromObject=function(e){return e instanceof s.perfetto.protos.FreeBuffersResponse?e:new s.perfetto.protos.FreeBuffersResponse},Y.toObject=function(){return{}},Y.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Y.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.FreeBuffersResponse"},Y),r.FlushRequest=(J.prototype.timeoutMs=0,J.prototype.flags=i.Long?i.Long.fromBits(0,0,!0):0,J.create=function(e){return new J(e)},J.encode=function(e,t){return t=t||a.create(),null!=e.timeoutMs&&Object.hasOwnProperty.call(e,"timeoutMs")&&t.uint32(8).uint32(e.timeoutMs),null!=e.flags&&Object.hasOwnProperty.call(e,"flags")&&t.uint32(16).uint64(e.flags),t},J.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.FlushRequest;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.timeoutMs=e.uint32();break;case 2:n.flags=e.uint64();break;default:e.skipType(7&a)}}return n},J.fromObject=function(e){var t;return e instanceof s.perfetto.protos.FlushRequest?e:(t=new s.perfetto.protos.FlushRequest,null!=e.timeoutMs&&(t.timeoutMs=e.timeoutMs>>>0),null!=e.flags&&(i.Long?(t.flags=i.Long.fromValue(e.flags)).unsigned=!0:"string"==typeof e.flags?t.flags=parseInt(e.flags,10):"number"==typeof e.flags?t.flags=e.flags:"object"==typeof e.flags&&(t.flags=new i.LongBits(e.flags.low>>>0,e.flags.high>>>0).toNumber(!0))),t)},J.toObject=function(e,t){var r,n={};return(t=t||{}).defaults&&(n.timeoutMs=0,i.Long?(r=new i.Long(0,0,!0),n.flags=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.flags=t.longs===String?"0":0),null!=e.timeoutMs&&e.hasOwnProperty("timeoutMs")&&(n.timeoutMs=e.timeoutMs),null!=e.flags&&e.hasOwnProperty("flags")&&("number"==typeof e.flags?n.flags=t.longs===String?String(e.flags):e.flags:n.flags=t.longs===String?i.Long.prototype.toString.call(e.flags):t.longs===Number?new i.LongBits(e.flags.low>>>0,e.flags.high>>>0).toNumber(!0):e.flags),n},J.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},J.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.FlushRequest"},J),r.FlushResponse=(Z.create=function(e){return new Z(e)},Z.encode=function(e,t){return t=t||a.create()},Z.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,t=new s.perfetto.protos.FlushResponse;e.pos<r;){var n=e.uint32();e.skipType(7&n)}return t},Z.fromObject=function(e){return e instanceof s.perfetto.protos.FlushResponse?e:new s.perfetto.protos.FlushResponse},Z.toObject=function(){return{}},Z.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Z.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.FlushResponse"},Z),r.DetachRequest=(Q.prototype.key="",Q.create=function(e){return new Q(e)},Q.encode=function(e,t){return t=t||a.create(),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),t},Q.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.DetachRequest;e.pos<r;){var a=e.uint32();a>>>3==1?n.key=e.string():e.skipType(7&a)}return n},Q.fromObject=function(e){var t;return e instanceof s.perfetto.protos.DetachRequest?e:(t=new s.perfetto.protos.DetachRequest,null!=e.key&&(t.key=String(e.key)),t)},Q.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.key=""),null!=e.key&&e.hasOwnProperty("key")&&(r.key=e.key),r},Q.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Q.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.DetachRequest"},Q),r.DetachResponse=(X.create=function(e){return new X(e)},X.encode=function(e,t){return t=t||a.create()},X.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,t=new s.perfetto.protos.DetachResponse;e.pos<r;){var n=e.uint32();e.skipType(7&n)}return t},X.fromObject=function(e){return e instanceof s.perfetto.protos.DetachResponse?e:new s.perfetto.protos.DetachResponse},X.toObject=function(){return{}},X.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},X.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.DetachResponse"},X),r.AttachRequest=(ee.prototype.key="",ee.create=function(e){return new ee(e)},ee.encode=function(e,t){return t=t||a.create(),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),t},ee.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.AttachRequest;e.pos<r;){var a=e.uint32();a>>>3==1?n.key=e.string():e.skipType(7&a)}return n},ee.fromObject=function(e){var t;return e instanceof s.perfetto.protos.AttachRequest?e:(t=new s.perfetto.protos.AttachRequest,null!=e.key&&(t.key=String(e.key)),t)},ee.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.key=""),null!=e.key&&e.hasOwnProperty("key")&&(r.key=e.key),r},ee.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},ee.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.AttachRequest"},ee),r.AttachResponse=(te.prototype.traceConfig=null,te.create=function(e){return new te(e)},te.encode=function(e,t){return t=t||a.create(),null!=e.traceConfig&&Object.hasOwnProperty.call(e,"traceConfig")&&s.perfetto.protos.TraceConfig.encode(e.traceConfig,t.uint32(10).fork()).ldelim(),t},te.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.AttachResponse;e.pos<r;){var a=e.uint32();a>>>3==1?n.traceConfig=s.perfetto.protos.TraceConfig.decode(e,e.uint32()):e.skipType(7&a)}return n},te.fromObject=function(e){if(e instanceof s.perfetto.protos.AttachResponse)return e;var t=new s.perfetto.protos.AttachResponse;if(null!=e.traceConfig){if("object"!=typeof e.traceConfig)throw TypeError(".perfetto.protos.AttachResponse.traceConfig: object expected");t.traceConfig=s.perfetto.protos.TraceConfig.fromObject(e.traceConfig)}return t},te.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.traceConfig=null),null!=e.traceConfig&&e.hasOwnProperty("traceConfig")&&(r.traceConfig=s.perfetto.protos.TraceConfig.toObject(e.traceConfig,t)),r},te.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},te.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.AttachResponse"},te),r.GetTraceStatsRequest=(re.create=function(e){return new re(e)},re.encode=function(e,t){return t=t||a.create()},re.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,t=new s.perfetto.protos.GetTraceStatsRequest;e.pos<r;){var n=e.uint32();e.skipType(7&n)}return t},re.fromObject=function(e){return e instanceof s.perfetto.protos.GetTraceStatsRequest?e:new s.perfetto.protos.GetTraceStatsRequest},re.toObject=function(){return{}},re.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},re.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.GetTraceStatsRequest"},re),r.GetTraceStatsResponse=(ne.prototype.traceStats=null,ne.create=function(e){return new ne(e)},ne.encode=function(e,t){return t=t||a.create(),null!=e.traceStats&&Object.hasOwnProperty.call(e,"traceStats")&&s.perfetto.protos.TraceStats.encode(e.traceStats,t.uint32(10).fork()).ldelim(),t},ne.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.GetTraceStatsResponse;e.pos<r;){var a=e.uint32();a>>>3==1?n.traceStats=s.perfetto.protos.TraceStats.decode(e,e.uint32()):e.skipType(7&a)}return n},ne.fromObject=function(e){if(e instanceof s.perfetto.protos.GetTraceStatsResponse)return e;var t=new s.perfetto.protos.GetTraceStatsResponse;if(null!=e.traceStats){if("object"!=typeof e.traceStats)throw TypeError(".perfetto.protos.GetTraceStatsResponse.traceStats: object expected");t.traceStats=s.perfetto.protos.TraceStats.fromObject(e.traceStats)}return t},ne.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.traceStats=null),null!=e.traceStats&&e.hasOwnProperty("traceStats")&&(r.traceStats=s.perfetto.protos.TraceStats.toObject(e.traceStats,t)),r},ne.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},ne.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.GetTraceStatsResponse"},ne),r.ObserveEventsRequest=(ae.prototype.eventsToObserve=i.emptyArray,ae.create=function(e){return new ae(e)},ae.encode=function(e,t){if(t=t||a.create(),null!=e.eventsToObserve&&e.eventsToObserve.length)for(var r=0;r<e.eventsToObserve.length;++r)t.uint32(8).int32(e.eventsToObserve[r]);return t},ae.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.ObserveEventsRequest;e.pos<r;){var a=e.uint32();if(a>>>3==1)if(n.eventsToObserve&&n.eventsToObserve.length||(n.eventsToObserve=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.eventsToObserve.push(e.int32());else n.eventsToObserve.push(e.int32());else e.skipType(7&a)}return n},ae.fromObject=function(e){if(e instanceof s.perfetto.protos.ObserveEventsRequest)return e;var t=new s.perfetto.protos.ObserveEventsRequest;if(e.eventsToObserve){if(!Array.isArray(e.eventsToObserve))throw TypeError(".perfetto.protos.ObserveEventsRequest.eventsToObserve: array expected");t.eventsToObserve=[];for(var r=0;r<e.eventsToObserve.length;++r)switch(e.eventsToObserve[r]){default:if("number"==typeof e.eventsToObserve[r]){t.eventsToObserve[r]=e.eventsToObserve[r];break}case"TYPE_UNSPECIFIED":case 0:t.eventsToObserve[r]=0;break;case"TYPE_DATA_SOURCES_INSTANCES":case 1:t.eventsToObserve[r]=1;break;case"TYPE_ALL_DATA_SOURCES_STARTED":case 2:t.eventsToObserve[r]=2;break;case"TYPE_CLONE_TRIGGER_HIT":case 4:t.eventsToObserve[r]=4}}return t},ae.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.eventsToObserve=[]),e.eventsToObserve&&e.eventsToObserve.length){r.eventsToObserve=[];for(var n=0;n<e.eventsToObserve.length;++n)r.eventsToObserve[n]=t.enums!==String||void 0===s.perfetto.protos.ObservableEvents.Type[e.eventsToObserve[n]]?e.eventsToObserve[n]:s.perfetto.protos.ObservableEvents.Type[e.eventsToObserve[n]]}return r},ae.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},ae.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.ObserveEventsRequest"},ae),r.ObserveEventsResponse=(ie.prototype.events=null,ie.create=function(e){return new ie(e)},ie.encode=function(e,t){return t=t||a.create(),null!=e.events&&Object.hasOwnProperty.call(e,"events")&&s.perfetto.protos.ObservableEvents.encode(e.events,t.uint32(10).fork()).ldelim(),t},ie.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.ObserveEventsResponse;e.pos<r;){var a=e.uint32();a>>>3==1?n.events=s.perfetto.protos.ObservableEvents.decode(e,e.uint32()):e.skipType(7&a)}return n},ie.fromObject=function(e){if(e instanceof s.perfetto.protos.ObserveEventsResponse)return e;var t=new s.perfetto.protos.ObserveEventsResponse;if(null!=e.events){if("object"!=typeof e.events)throw TypeError(".perfetto.protos.ObserveEventsResponse.events: object expected");t.events=s.perfetto.protos.ObservableEvents.fromObject(e.events)}return t},ie.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.events=null),null!=e.events&&e.hasOwnProperty("events")&&(r.events=s.perfetto.protos.ObservableEvents.toObject(e.events,t)),r},ie.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},ie.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.ObserveEventsResponse"},ie),r.QueryServiceStateRequest=(oe.prototype.sessionsOnly=!1,oe.create=function(e){return new oe(e)},oe.encode=function(e,t){return t=t||a.create(),null!=e.sessionsOnly&&Object.hasOwnProperty.call(e,"sessionsOnly")&&t.uint32(8).bool(e.sessionsOnly),t},oe.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.QueryServiceStateRequest;e.pos<r;){var a=e.uint32();a>>>3==1?n.sessionsOnly=e.bool():e.skipType(7&a)}return n},oe.fromObject=function(e){var t;return e instanceof s.perfetto.protos.QueryServiceStateRequest?e:(t=new s.perfetto.protos.QueryServiceStateRequest,null!=e.sessionsOnly&&(t.sessionsOnly=Boolean(e.sessionsOnly)),t)},oe.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.sessionsOnly=!1),null!=e.sessionsOnly&&e.hasOwnProperty("sessionsOnly")&&(r.sessionsOnly=e.sessionsOnly),r},oe.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},oe.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.QueryServiceStateRequest"},oe),r.QueryServiceStateResponse=(se.prototype.serviceState=null,se.create=function(e){return new se(e)},se.encode=function(e,t){return t=t||a.create(),null!=e.serviceState&&Object.hasOwnProperty.call(e,"serviceState")&&s.perfetto.protos.TracingServiceState.encode(e.serviceState,t.uint32(10).fork()).ldelim(),t},se.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.QueryServiceStateResponse;e.pos<r;){var a=e.uint32();a>>>3==1?n.serviceState=s.perfetto.protos.TracingServiceState.decode(e,e.uint32()):e.skipType(7&a)}return n},se.fromObject=function(e){if(e instanceof s.perfetto.protos.QueryServiceStateResponse)return e;var t=new s.perfetto.protos.QueryServiceStateResponse;if(null!=e.serviceState){if("object"!=typeof e.serviceState)throw TypeError(".perfetto.protos.QueryServiceStateResponse.serviceState: object expected");t.serviceState=s.perfetto.protos.TracingServiceState.fromObject(e.serviceState)}return t},se.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.serviceState=null),null!=e.serviceState&&e.hasOwnProperty("serviceState")&&(r.serviceState=s.perfetto.protos.TracingServiceState.toObject(e.serviceState,t)),r},se.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},se.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.QueryServiceStateResponse"},se),r.QueryCapabilitiesRequest=(le.create=function(e){return new le(e)},le.encode=function(e,t){return t=t||a.create()},le.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,t=new s.perfetto.protos.QueryCapabilitiesRequest;e.pos<r;){var n=e.uint32();e.skipType(7&n)}return t},le.fromObject=function(e){return e instanceof s.perfetto.protos.QueryCapabilitiesRequest?e:new s.perfetto.protos.QueryCapabilitiesRequest},le.toObject=function(){return{}},le.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},le.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.QueryCapabilitiesRequest"},le),r.QueryCapabilitiesResponse=(ce.prototype.capabilities=null,ce.create=function(e){return new ce(e)},ce.encode=function(e,t){return t=t||a.create(),null!=e.capabilities&&Object.hasOwnProperty.call(e,"capabilities")&&s.perfetto.protos.TracingServiceCapabilities.encode(e.capabilities,t.uint32(10).fork()).ldelim(),t},ce.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.QueryCapabilitiesResponse;e.pos<r;){var a=e.uint32();a>>>3==1?n.capabilities=s.perfetto.protos.TracingServiceCapabilities.decode(e,e.uint32()):e.skipType(7&a)}return n},ce.fromObject=function(e){if(e instanceof s.perfetto.protos.QueryCapabilitiesResponse)return e;var t=new s.perfetto.protos.QueryCapabilitiesResponse;if(null!=e.capabilities){if("object"!=typeof e.capabilities)throw TypeError(".perfetto.protos.QueryCapabilitiesResponse.capabilities: object expected");t.capabilities=s.perfetto.protos.TracingServiceCapabilities.fromObject(e.capabilities)}return t},ce.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.capabilities=null),null!=e.capabilities&&e.hasOwnProperty("capabilities")&&(r.capabilities=s.perfetto.protos.TracingServiceCapabilities.toObject(e.capabilities,t)),r},ce.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},ce.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.QueryCapabilitiesResponse"},ce),r.SaveTraceForBugreportRequest=(ue.create=function(e){return new ue(e)},ue.encode=function(e,t){return t=t||a.create()},ue.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,t=new s.perfetto.protos.SaveTraceForBugreportRequest;e.pos<r;){var n=e.uint32();e.skipType(7&n)}return t},ue.fromObject=function(e){return e instanceof s.perfetto.protos.SaveTraceForBugreportRequest?e:new s.perfetto.protos.SaveTraceForBugreportRequest},ue.toObject=function(){return{}},ue.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},ue.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.SaveTraceForBugreportRequest"},ue),r.SaveTraceForBugreportResponse=(de.prototype.success=!1,de.prototype.msg="",de.create=function(e){return new de(e)},de.encode=function(e,t){return t=t||a.create(),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.msg&&Object.hasOwnProperty.call(e,"msg")&&t.uint32(18).string(e.msg),t},de.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.SaveTraceForBugreportResponse;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.success=e.bool();break;case 2:n.msg=e.string();break;default:e.skipType(7&a)}}return n},de.fromObject=function(e){var t;return e instanceof s.perfetto.protos.SaveTraceForBugreportResponse?e:(t=new s.perfetto.protos.SaveTraceForBugreportResponse,null!=e.success&&(t.success=Boolean(e.success)),null!=e.msg&&(t.msg=String(e.msg)),t)},de.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.success=!1,r.msg=""),null!=e.success&&e.hasOwnProperty("success")&&(r.success=e.success),null!=e.msg&&e.hasOwnProperty("msg")&&(r.msg=e.msg),r},de.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},de.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.SaveTraceForBugreportResponse"},de),r.CloneSessionRequest=(fe.prototype.sessionId=i.Long?i.Long.fromBits(0,0,!0):0,fe.prototype.skipTraceFilter=!1,fe.prototype.forBugreport=!1,fe.create=function(e){return new fe(e)},fe.encode=function(e,t){return t=t||a.create(),null!=e.sessionId&&Object.hasOwnProperty.call(e,"sessionId")&&t.uint32(8).uint64(e.sessionId),null!=e.skipTraceFilter&&Object.hasOwnProperty.call(e,"skipTraceFilter")&&t.uint32(16).bool(e.skipTraceFilter),null!=e.forBugreport&&Object.hasOwnProperty.call(e,"forBugreport")&&t.uint32(24).bool(e.forBugreport),t},fe.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.CloneSessionRequest;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.sessionId=e.uint64();break;case 2:n.skipTraceFilter=e.bool();break;case 3:n.forBugreport=e.bool();break;default:e.skipType(7&a)}}return n},fe.fromObject=function(e){var t;return e instanceof s.perfetto.protos.CloneSessionRequest?e:(t=new s.perfetto.protos.CloneSessionRequest,null!=e.sessionId&&(i.Long?(t.sessionId=i.Long.fromValue(e.sessionId)).unsigned=!0:"string"==typeof e.sessionId?t.sessionId=parseInt(e.sessionId,10):"number"==typeof e.sessionId?t.sessionId=e.sessionId:"object"==typeof e.sessionId&&(t.sessionId=new i.LongBits(e.sessionId.low>>>0,e.sessionId.high>>>0).toNumber(!0))),null!=e.skipTraceFilter&&(t.skipTraceFilter=Boolean(e.skipTraceFilter)),null!=e.forBugreport&&(t.forBugreport=Boolean(e.forBugreport)),t)},fe.toObject=function(e,t){var r,n={};return(t=t||{}).defaults&&(i.Long?(r=new i.Long(0,0,!0),n.sessionId=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.sessionId=t.longs===String?"0":0,n.skipTraceFilter=!1,n.forBugreport=!1),null!=e.sessionId&&e.hasOwnProperty("sessionId")&&("number"==typeof e.sessionId?n.sessionId=t.longs===String?String(e.sessionId):e.sessionId:n.sessionId=t.longs===String?i.Long.prototype.toString.call(e.sessionId):t.longs===Number?new i.LongBits(e.sessionId.low>>>0,e.sessionId.high>>>0).toNumber(!0):e.sessionId),null!=e.skipTraceFilter&&e.hasOwnProperty("skipTraceFilter")&&(n.skipTraceFilter=e.skipTraceFilter),null!=e.forBugreport&&e.hasOwnProperty("forBugreport")&&(n.forBugreport=e.forBugreport),n},fe.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},fe.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.CloneSessionRequest"},fe),r.CloneSessionResponse=(pe.prototype.success=!1,pe.prototype.error="",pe.prototype.uuidMsb=i.Long?i.Long.fromBits(0,0,!1):0,pe.prototype.uuidLsb=i.Long?i.Long.fromBits(0,0,!1):0,pe.create=function(e){return new pe(e)},pe.encode=function(e,t){return t=t||a.create(),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.error&&Object.hasOwnProperty.call(e,"error")&&t.uint32(18).string(e.error),null!=e.uuidMsb&&Object.hasOwnProperty.call(e,"uuidMsb")&&t.uint32(24).int64(e.uuidMsb),null!=e.uuidLsb&&Object.hasOwnProperty.call(e,"uuidLsb")&&t.uint32(32).int64(e.uuidLsb),t},pe.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.CloneSessionResponse;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.success=e.bool();break;case 2:n.error=e.string();break;case 3:n.uuidMsb=e.int64();break;case 4:n.uuidLsb=e.int64();break;default:e.skipType(7&a)}}return n},pe.fromObject=function(e){var t;return e instanceof s.perfetto.protos.CloneSessionResponse?e:(t=new s.perfetto.protos.CloneSessionResponse,null!=e.success&&(t.success=Boolean(e.success)),null!=e.error&&(t.error=String(e.error)),null!=e.uuidMsb&&(i.Long?(t.uuidMsb=i.Long.fromValue(e.uuidMsb)).unsigned=!1:"string"==typeof e.uuidMsb?t.uuidMsb=parseInt(e.uuidMsb,10):"number"==typeof e.uuidMsb?t.uuidMsb=e.uuidMsb:"object"==typeof e.uuidMsb&&(t.uuidMsb=new i.LongBits(e.uuidMsb.low>>>0,e.uuidMsb.high>>>0).toNumber())),null!=e.uuidLsb&&(i.Long?(t.uuidLsb=i.Long.fromValue(e.uuidLsb)).unsigned=!1:"string"==typeof e.uuidLsb?t.uuidLsb=parseInt(e.uuidLsb,10):"number"==typeof e.uuidLsb?t.uuidLsb=e.uuidLsb:"object"==typeof e.uuidLsb&&(t.uuidLsb=new i.LongBits(e.uuidLsb.low>>>0,e.uuidLsb.high>>>0).toNumber())),t)},pe.toObject=function(e,t){var r,n={};return(t=t||{}).defaults&&(n.success=!1,n.error="",i.Long?(r=new i.Long(0,0,!1),n.uuidMsb=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.uuidMsb=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!1),n.uuidLsb=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.uuidLsb=t.longs===String?"0":0),null!=e.success&&e.hasOwnProperty("success")&&(n.success=e.success),null!=e.error&&e.hasOwnProperty("error")&&(n.error=e.error),null!=e.uuidMsb&&e.hasOwnProperty("uuidMsb")&&("number"==typeof e.uuidMsb?n.uuidMsb=t.longs===String?String(e.uuidMsb):e.uuidMsb:n.uuidMsb=t.longs===String?i.Long.prototype.toString.call(e.uuidMsb):t.longs===Number?new i.LongBits(e.uuidMsb.low>>>0,e.uuidMsb.high>>>0).toNumber():e.uuidMsb),null!=e.uuidLsb&&e.hasOwnProperty("uuidLsb")&&("number"==typeof e.uuidLsb?n.uuidLsb=t.longs===String?String(e.uuidLsb):e.uuidLsb:n.uuidLsb=t.longs===String?i.Long.prototype.toString.call(e.uuidLsb):t.longs===Number?new i.LongBits(e.uuidLsb.low>>>0,e.uuidLsb.high>>>0).toNumber():e.uuidLsb),n},pe.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},pe.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.CloneSessionResponse"},pe),r.ObservableEvents=(he.prototype.instanceStateChanges=i.emptyArray,he.prototype.allDataSourcesStarted=!1,he.prototype.cloneTriggerHit=null,he.create=function(e){return new he(e)},he.encode=function(e,t){if(t=t||a.create(),null!=e.instanceStateChanges&&e.instanceStateChanges.length)for(var r=0;r<e.instanceStateChanges.length;++r)s.perfetto.protos.ObservableEvents.DataSourceInstanceStateChange.encode(e.instanceStateChanges[r],t.uint32(10).fork()).ldelim();return null!=e.allDataSourcesStarted&&Object.hasOwnProperty.call(e,"allDataSourcesStarted")&&t.uint32(16).bool(e.allDataSourcesStarted),null!=e.cloneTriggerHit&&Object.hasOwnProperty.call(e,"cloneTriggerHit")&&s.perfetto.protos.ObservableEvents.CloneTriggerHit.encode(e.cloneTriggerHit,t.uint32(26).fork()).ldelim(),t},he.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.ObservableEvents;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.instanceStateChanges&&n.instanceStateChanges.length||(n.instanceStateChanges=[]),n.instanceStateChanges.push(s.perfetto.protos.ObservableEvents.DataSourceInstanceStateChange.decode(e,e.uint32()));break;case 2:n.allDataSourcesStarted=e.bool();break;case 3:n.cloneTriggerHit=s.perfetto.protos.ObservableEvents.CloneTriggerHit.decode(e,e.uint32());break;default:e.skipType(7&a)}}return n},he.fromObject=function(e){if(e instanceof s.perfetto.protos.ObservableEvents)return e;var t=new s.perfetto.protos.ObservableEvents;if(e.instanceStateChanges){if(!Array.isArray(e.instanceStateChanges))throw TypeError(".perfetto.protos.ObservableEvents.instanceStateChanges: array expected");t.instanceStateChanges=[];for(var r=0;r<e.instanceStateChanges.length;++r){if("object"!=typeof e.instanceStateChanges[r])throw TypeError(".perfetto.protos.ObservableEvents.instanceStateChanges: object expected");t.instanceStateChanges[r]=s.perfetto.protos.ObservableEvents.DataSourceInstanceStateChange.fromObject(e.instanceStateChanges[r])}}if(null!=e.allDataSourcesStarted&&(t.allDataSourcesStarted=Boolean(e.allDataSourcesStarted)),null!=e.cloneTriggerHit){if("object"!=typeof e.cloneTriggerHit)throw TypeError(".perfetto.protos.ObservableEvents.cloneTriggerHit: object expected");t.cloneTriggerHit=s.perfetto.protos.ObservableEvents.CloneTriggerHit.fromObject(e.cloneTriggerHit)}return t},he.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.instanceStateChanges=[]),t.defaults&&(r.allDataSourcesStarted=!1,r.cloneTriggerHit=null),e.instanceStateChanges&&e.instanceStateChanges.length){r.instanceStateChanges=[];for(var n=0;n<e.instanceStateChanges.length;++n)r.instanceStateChanges[n]=s.perfetto.protos.ObservableEvents.DataSourceInstanceStateChange.toObject(e.instanceStateChanges[n],t)}return null!=e.allDataSourcesStarted&&e.hasOwnProperty("allDataSourcesStarted")&&(r.allDataSourcesStarted=e.allDataSourcesStarted),null!=e.cloneTriggerHit&&e.hasOwnProperty("cloneTriggerHit")&&(r.cloneTriggerHit=s.perfetto.protos.ObservableEvents.CloneTriggerHit.toObject(e.cloneTriggerHit,t)),r},he.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},he.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.ObservableEvents"},he.Type=(e={},(t=Object.create(e))[e[0]="TYPE_UNSPECIFIED"]=0,t[e[1]="TYPE_DATA_SOURCES_INSTANCES"]=1,t[e[2]="TYPE_ALL_DATA_SOURCES_STARTED"]=2,t[e[4]="TYPE_CLONE_TRIGGER_HIT"]=4,t),he.DataSourceInstanceState=(e={},(t=Object.create(e))[e[1]="DATA_SOURCE_INSTANCE_STATE_STOPPED"]=1,t[e[2]="DATA_SOURCE_INSTANCE_STATE_STARTED"]=2,t),he.DataSourceInstanceStateChange=(ge.prototype.producerName="",ge.prototype.dataSourceName="",ge.prototype.state=1,ge.create=function(e){return new ge(e)},ge.encode=function(e,t){return t=t||a.create(),null!=e.producerName&&Object.hasOwnProperty.call(e,"producerName")&&t.uint32(10).string(e.producerName),null!=e.dataSourceName&&Object.hasOwnProperty.call(e,"dataSourceName")&&t.uint32(18).string(e.dataSourceName),null!=e.state&&Object.hasOwnProperty.call(e,"state")&&t.uint32(24).int32(e.state),t},ge.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.ObservableEvents.DataSourceInstanceStateChange;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.producerName=e.string();break;case 2:n.dataSourceName=e.string();break;case 3:n.state=e.int32();break;default:e.skipType(7&a)}}return n},ge.fromObject=function(e){if(e instanceof s.perfetto.protos.ObservableEvents.DataSourceInstanceStateChange)return e;var t=new s.perfetto.protos.ObservableEvents.DataSourceInstanceStateChange;switch(null!=e.producerName&&(t.producerName=String(e.producerName)),null!=e.dataSourceName&&(t.dataSourceName=String(e.dataSourceName)),e.state){default:"number"==typeof e.state&&(t.state=e.state);break;case"DATA_SOURCE_INSTANCE_STATE_STOPPED":case 1:t.state=1;break;case"DATA_SOURCE_INSTANCE_STATE_STARTED":case 2:t.state=2}return t},ge.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.producerName="",r.dataSourceName="",r.state=t.enums===String?"DATA_SOURCE_INSTANCE_STATE_STOPPED":1),null!=e.producerName&&e.hasOwnProperty("producerName")&&(r.producerName=e.producerName),null!=e.dataSourceName&&e.hasOwnProperty("dataSourceName")&&(r.dataSourceName=e.dataSourceName),null!=e.state&&e.hasOwnProperty("state")&&(r.state=t.enums!==String||void 0===s.perfetto.protos.ObservableEvents.DataSourceInstanceState[e.state]?e.state:s.perfetto.protos.ObservableEvents.DataSourceInstanceState[e.state]),r},ge.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},ge.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.ObservableEvents.DataSourceInstanceStateChange"},ge),he.CloneTriggerHit=(me.prototype.tracingSessionId=i.Long?i.Long.fromBits(0,0,!1):0,me.prototype.triggerName="",me.create=function(e){return new me(e)},me.encode=function(e,t){return t=t||a.create(),null!=e.tracingSessionId&&Object.hasOwnProperty.call(e,"tracingSessionId")&&t.uint32(8).int64(e.tracingSessionId),null!=e.triggerName&&Object.hasOwnProperty.call(e,"triggerName")&&t.uint32(18).string(e.triggerName),t},me.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.ObservableEvents.CloneTriggerHit;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.tracingSessionId=e.int64();break;case 2:n.triggerName=e.string();break;default:e.skipType(7&a)}}return n},me.fromObject=function(e){var t;return e instanceof s.perfetto.protos.ObservableEvents.CloneTriggerHit?e:(t=new s.perfetto.protos.ObservableEvents.CloneTriggerHit,null!=e.tracingSessionId&&(i.Long?(t.tracingSessionId=i.Long.fromValue(e.tracingSessionId)).unsigned=!1:"string"==typeof e.tracingSessionId?t.tracingSessionId=parseInt(e.tracingSessionId,10):"number"==typeof e.tracingSessionId?t.tracingSessionId=e.tracingSessionId:"object"==typeof e.tracingSessionId&&(t.tracingSessionId=new i.LongBits(e.tracingSessionId.low>>>0,e.tracingSessionId.high>>>0).toNumber())),null!=e.triggerName&&(t.triggerName=String(e.triggerName)),t)},me.toObject=function(e,t){var r,n={};return(t=t||{}).defaults&&(i.Long?(r=new i.Long(0,0,!1),n.tracingSessionId=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.tracingSessionId=t.longs===String?"0":0,n.triggerName=""),null!=e.tracingSessionId&&e.hasOwnProperty("tracingSessionId")&&("number"==typeof e.tracingSessionId?n.tracingSessionId=t.longs===String?String(e.tracingSessionId):e.tracingSessionId:n.tracingSessionId=t.longs===String?i.Long.prototype.toString.call(e.tracingSessionId):t.longs===Number?new i.LongBits(e.tracingSessionId.low>>>0,e.tracingSessionId.high>>>0).toNumber():e.tracingSessionId),null!=e.triggerName&&e.hasOwnProperty("triggerName")&&(n.triggerName=e.triggerName),n},me.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},me.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.ObservableEvents.CloneTriggerHit"},me),he),r.TracingServiceState=(u.prototype.producers=i.emptyArray,u.prototype.dataSources=i.emptyArray,u.prototype.tracingSessions=i.emptyArray,u.prototype.supportsTracingSessions=!1,u.prototype.numSessions=0,u.prototype.numSessionsStarted=0,u.prototype.tracingServiceVersion="",u.create=function(e){return new u(e)},u.encode=function(e,t){if(t=t||a.create(),null!=e.producers&&e.producers.length)for(var r=0;r<e.producers.length;++r)s.perfetto.protos.TracingServiceState.Producer.encode(e.producers[r],t.uint32(10).fork()).ldelim();if(null!=e.dataSources&&e.dataSources.length)for(r=0;r<e.dataSources.length;++r)s.perfetto.protos.TracingServiceState.DataSource.encode(e.dataSources[r],t.uint32(18).fork()).ldelim();if(null!=e.numSessions&&Object.hasOwnProperty.call(e,"numSessions")&&t.uint32(24).int32(e.numSessions),null!=e.numSessionsStarted&&Object.hasOwnProperty.call(e,"numSessionsStarted")&&t.uint32(32).int32(e.numSessionsStarted),null!=e.tracingServiceVersion&&Object.hasOwnProperty.call(e,"tracingServiceVersion")&&t.uint32(42).string(e.tracingServiceVersion),null!=e.tracingSessions&&e.tracingSessions.length)for(r=0;r<e.tracingSessions.length;++r)s.perfetto.protos.TracingServiceState.TracingSession.encode(e.tracingSessions[r],t.uint32(50).fork()).ldelim();return null!=e.supportsTracingSessions&&Object.hasOwnProperty.call(e,"supportsTracingSessions")&&t.uint32(56).bool(e.supportsTracingSessions),t},u.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TracingServiceState;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.producers&&n.producers.length||(n.producers=[]),n.producers.push(s.perfetto.protos.TracingServiceState.Producer.decode(e,e.uint32()));break;case 2:n.dataSources&&n.dataSources.length||(n.dataSources=[]),n.dataSources.push(s.perfetto.protos.TracingServiceState.DataSource.decode(e,e.uint32()));break;case 6:n.tracingSessions&&n.tracingSessions.length||(n.tracingSessions=[]),n.tracingSessions.push(s.perfetto.protos.TracingServiceState.TracingSession.decode(e,e.uint32()));break;case 7:n.supportsTracingSessions=e.bool();break;case 3:n.numSessions=e.int32();break;case 4:n.numSessionsStarted=e.int32();break;case 5:n.tracingServiceVersion=e.string();break;default:e.skipType(7&a)}}return n},u.fromObject=function(e){if(e instanceof s.perfetto.protos.TracingServiceState)return e;var t=new s.perfetto.protos.TracingServiceState;if(e.producers){if(!Array.isArray(e.producers))throw TypeError(".perfetto.protos.TracingServiceState.producers: array expected");t.producers=[];for(var r=0;r<e.producers.length;++r){if("object"!=typeof e.producers[r])throw TypeError(".perfetto.protos.TracingServiceState.producers: object expected");t.producers[r]=s.perfetto.protos.TracingServiceState.Producer.fromObject(e.producers[r])}}if(e.dataSources){if(!Array.isArray(e.dataSources))throw TypeError(".perfetto.protos.TracingServiceState.dataSources: array expected");t.dataSources=[];for(r=0;r<e.dataSources.length;++r){if("object"!=typeof e.dataSources[r])throw TypeError(".perfetto.protos.TracingServiceState.dataSources: object expected");t.dataSources[r]=s.perfetto.protos.TracingServiceState.DataSource.fromObject(e.dataSources[r])}}if(e.tracingSessions){if(!Array.isArray(e.tracingSessions))throw TypeError(".perfetto.protos.TracingServiceState.tracingSessions: array expected");t.tracingSessions=[];for(r=0;r<e.tracingSessions.length;++r){if("object"!=typeof e.tracingSessions[r])throw TypeError(".perfetto.protos.TracingServiceState.tracingSessions: object expected");t.tracingSessions[r]=s.perfetto.protos.TracingServiceState.TracingSession.fromObject(e.tracingSessions[r])}}return null!=e.supportsTracingSessions&&(t.supportsTracingSessions=Boolean(e.supportsTracingSessions)),null!=e.numSessions&&(t.numSessions=0|e.numSessions),null!=e.numSessionsStarted&&(t.numSessionsStarted=0|e.numSessionsStarted),null!=e.tracingServiceVersion&&(t.tracingServiceVersion=String(e.tracingServiceVersion)),t},u.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.producers=[],r.dataSources=[],r.tracingSessions=[]),t.defaults&&(r.numSessions=0,r.numSessionsStarted=0,r.tracingServiceVersion="",r.supportsTracingSessions=!1),e.producers&&e.producers.length){r.producers=[];for(var n=0;n<e.producers.length;++n)r.producers[n]=s.perfetto.protos.TracingServiceState.Producer.toObject(e.producers[n],t)}if(e.dataSources&&e.dataSources.length){r.dataSources=[];for(n=0;n<e.dataSources.length;++n)r.dataSources[n]=s.perfetto.protos.TracingServiceState.DataSource.toObject(e.dataSources[n],t)}if(null!=e.numSessions&&e.hasOwnProperty("numSessions")&&(r.numSessions=e.numSessions),null!=e.numSessionsStarted&&e.hasOwnProperty("numSessionsStarted")&&(r.numSessionsStarted=e.numSessionsStarted),null!=e.tracingServiceVersion&&e.hasOwnProperty("tracingServiceVersion")&&(r.tracingServiceVersion=e.tracingServiceVersion),e.tracingSessions&&e.tracingSessions.length){r.tracingSessions=[];for(n=0;n<e.tracingSessions.length;++n)r.tracingSessions[n]=s.perfetto.protos.TracingServiceState.TracingSession.toObject(e.tracingSessions[n],t)}return null!=e.supportsTracingSessions&&e.hasOwnProperty("supportsTracingSessions")&&(r.supportsTracingSessions=e.supportsTracingSessions),r},u.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},u.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TracingServiceState"},u.Producer=(_e.prototype.id=0,_e.prototype.name="",_e.prototype.pid=0,_e.prototype.uid=0,_e.prototype.sdkVersion="",_e.create=function(e){return new _e(e)},_e.encode=function(e,t){return t=t||a.create(),null!=e.id&&Object.hasOwnProperty.call(e,"id")&&t.uint32(8).int32(e.id),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(18).string(e.name),null!=e.uid&&Object.hasOwnProperty.call(e,"uid")&&t.uint32(24).int32(e.uid),null!=e.sdkVersion&&Object.hasOwnProperty.call(e,"sdkVersion")&&t.uint32(34).string(e.sdkVersion),null!=e.pid&&Object.hasOwnProperty.call(e,"pid")&&t.uint32(40).int32(e.pid),t},_e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TracingServiceState.Producer;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.id=e.int32();break;case 2:n.name=e.string();break;case 5:n.pid=e.int32();break;case 3:n.uid=e.int32();break;case 4:n.sdkVersion=e.string();break;default:e.skipType(7&a)}}return n},_e.fromObject=function(e){var t;return e instanceof s.perfetto.protos.TracingServiceState.Producer?e:(t=new s.perfetto.protos.TracingServiceState.Producer,null!=e.id&&(t.id=0|e.id),null!=e.name&&(t.name=String(e.name)),null!=e.pid&&(t.pid=0|e.pid),null!=e.uid&&(t.uid=0|e.uid),null!=e.sdkVersion&&(t.sdkVersion=String(e.sdkVersion)),t)},_e.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.id=0,r.name="",r.uid=0,r.sdkVersion="",r.pid=0),null!=e.id&&e.hasOwnProperty("id")&&(r.id=e.id),null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.uid&&e.hasOwnProperty("uid")&&(r.uid=e.uid),null!=e.sdkVersion&&e.hasOwnProperty("sdkVersion")&&(r.sdkVersion=e.sdkVersion),null!=e.pid&&e.hasOwnProperty("pid")&&(r.pid=e.pid),r},_e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},_e.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TracingServiceState.Producer"},_e),u.DataSource=(ye.prototype.dsDescriptor=null,ye.prototype.producerId=0,ye.create=function(e){return new ye(e)},ye.encode=function(e,t){return t=t||a.create(),null!=e.dsDescriptor&&Object.hasOwnProperty.call(e,"dsDescriptor")&&s.perfetto.protos.DataSourceDescriptor.encode(e.dsDescriptor,t.uint32(10).fork()).ldelim(),null!=e.producerId&&Object.hasOwnProperty.call(e,"producerId")&&t.uint32(16).int32(e.producerId),t},ye.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TracingServiceState.DataSource;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.dsDescriptor=s.perfetto.protos.DataSourceDescriptor.decode(e,e.uint32());break;case 2:n.producerId=e.int32();break;default:e.skipType(7&a)}}return n},ye.fromObject=function(e){if(e instanceof s.perfetto.protos.TracingServiceState.DataSource)return e;var t=new s.perfetto.protos.TracingServiceState.DataSource;if(null!=e.dsDescriptor){if("object"!=typeof e.dsDescriptor)throw TypeError(".perfetto.protos.TracingServiceState.DataSource.dsDescriptor: object expected");t.dsDescriptor=s.perfetto.protos.DataSourceDescriptor.fromObject(e.dsDescriptor)}return null!=e.producerId&&(t.producerId=0|e.producerId),t},ye.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.dsDescriptor=null,r.producerId=0),null!=e.dsDescriptor&&e.hasOwnProperty("dsDescriptor")&&(r.dsDescriptor=s.perfetto.protos.DataSourceDescriptor.toObject(e.dsDescriptor,t)),null!=e.producerId&&e.hasOwnProperty("producerId")&&(r.producerId=e.producerId),r},ye.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},ye.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TracingServiceState.DataSource"},ye),u.TracingSession=(d.prototype.id=i.Long?i.Long.fromBits(0,0,!0):0,d.prototype.consumerUid=0,d.prototype.state="",d.prototype.uniqueSessionName="",d.prototype.bufferSizeKb=i.emptyArray,d.prototype.durationMs=0,d.prototype.numDataSources=0,d.prototype.startRealtimeNs=i.Long?i.Long.fromBits(0,0,!1):0,d.prototype.bugreportScore=0,d.prototype.bugreportFilename="",d.prototype.isStarted=!1,d.create=function(e){return new d(e)},d.encode=function(e,t){if(t=t||a.create(),null!=e.id&&Object.hasOwnProperty.call(e,"id")&&t.uint32(8).uint64(e.id),null!=e.consumerUid&&Object.hasOwnProperty.call(e,"consumerUid")&&t.uint32(16).int32(e.consumerUid),null!=e.state&&Object.hasOwnProperty.call(e,"state")&&t.uint32(26).string(e.state),null!=e.uniqueSessionName&&Object.hasOwnProperty.call(e,"uniqueSessionName")&&t.uint32(34).string(e.uniqueSessionName),null!=e.bufferSizeKb&&e.bufferSizeKb.length)for(var r=0;r<e.bufferSizeKb.length;++r)t.uint32(40).uint32(e.bufferSizeKb[r]);return null!=e.durationMs&&Object.hasOwnProperty.call(e,"durationMs")&&t.uint32(48).uint32(e.durationMs),null!=e.numDataSources&&Object.hasOwnProperty.call(e,"numDataSources")&&t.uint32(56).uint32(e.numDataSources),null!=e.startRealtimeNs&&Object.hasOwnProperty.call(e,"startRealtimeNs")&&t.uint32(64).int64(e.startRealtimeNs),null!=e.bugreportScore&&Object.hasOwnProperty.call(e,"bugreportScore")&&t.uint32(72).int32(e.bugreportScore),null!=e.bugreportFilename&&Object.hasOwnProperty.call(e,"bugreportFilename")&&t.uint32(82).string(e.bugreportFilename),null!=e.isStarted&&Object.hasOwnProperty.call(e,"isStarted")&&t.uint32(88).bool(e.isStarted),t},d.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TracingServiceState.TracingSession;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.id=e.uint64();break;case 2:n.consumerUid=e.int32();break;case 3:n.state=e.string();break;case 4:n.uniqueSessionName=e.string();break;case 5:if(n.bufferSizeKb&&n.bufferSizeKb.length||(n.bufferSizeKb=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.bufferSizeKb.push(e.uint32());else n.bufferSizeKb.push(e.uint32());break;case 6:n.durationMs=e.uint32();break;case 7:n.numDataSources=e.uint32();break;case 8:n.startRealtimeNs=e.int64();break;case 9:n.bugreportScore=e.int32();break;case 10:n.bugreportFilename=e.string();break;case 11:n.isStarted=e.bool();break;default:e.skipType(7&a)}}return n},d.fromObject=function(e){if(e instanceof s.perfetto.protos.TracingServiceState.TracingSession)return e;var t=new s.perfetto.protos.TracingServiceState.TracingSession;if(null!=e.id&&(i.Long?(t.id=i.Long.fromValue(e.id)).unsigned=!0:"string"==typeof e.id?t.id=parseInt(e.id,10):"number"==typeof e.id?t.id=e.id:"object"==typeof e.id&&(t.id=new i.LongBits(e.id.low>>>0,e.id.high>>>0).toNumber(!0))),null!=e.consumerUid&&(t.consumerUid=0|e.consumerUid),null!=e.state&&(t.state=String(e.state)),null!=e.uniqueSessionName&&(t.uniqueSessionName=String(e.uniqueSessionName)),e.bufferSizeKb){if(!Array.isArray(e.bufferSizeKb))throw TypeError(".perfetto.protos.TracingServiceState.TracingSession.bufferSizeKb: array expected");t.bufferSizeKb=[];for(var r=0;r<e.bufferSizeKb.length;++r)t.bufferSizeKb[r]=e.bufferSizeKb[r]>>>0}return null!=e.durationMs&&(t.durationMs=e.durationMs>>>0),null!=e.numDataSources&&(t.numDataSources=e.numDataSources>>>0),null!=e.startRealtimeNs&&(i.Long?(t.startRealtimeNs=i.Long.fromValue(e.startRealtimeNs)).unsigned=!1:"string"==typeof e.startRealtimeNs?t.startRealtimeNs=parseInt(e.startRealtimeNs,10):"number"==typeof e.startRealtimeNs?t.startRealtimeNs=e.startRealtimeNs:"object"==typeof e.startRealtimeNs&&(t.startRealtimeNs=new i.LongBits(e.startRealtimeNs.low>>>0,e.startRealtimeNs.high>>>0).toNumber())),null!=e.bugreportScore&&(t.bugreportScore=0|e.bugreportScore),null!=e.bugreportFilename&&(t.bugreportFilename=String(e.bugreportFilename)),null!=e.isStarted&&(t.isStarted=Boolean(e.isStarted)),t},d.toObject=function(e,t){var r,n={};if(((t=t||{}).arrays||t.defaults)&&(n.bufferSizeKb=[]),t.defaults&&(i.Long?(r=new i.Long(0,0,!0),n.id=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.id=t.longs===String?"0":0,n.consumerUid=0,n.state="",n.uniqueSessionName="",n.durationMs=0,n.numDataSources=0,i.Long?(r=new i.Long(0,0,!1),n.startRealtimeNs=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.startRealtimeNs=t.longs===String?"0":0,n.bugreportScore=0,n.bugreportFilename="",n.isStarted=!1),null!=e.id&&e.hasOwnProperty("id")&&("number"==typeof e.id?n.id=t.longs===String?String(e.id):e.id:n.id=t.longs===String?i.Long.prototype.toString.call(e.id):t.longs===Number?new i.LongBits(e.id.low>>>0,e.id.high>>>0).toNumber(!0):e.id),null!=e.consumerUid&&e.hasOwnProperty("consumerUid")&&(n.consumerUid=e.consumerUid),null!=e.state&&e.hasOwnProperty("state")&&(n.state=e.state),null!=e.uniqueSessionName&&e.hasOwnProperty("uniqueSessionName")&&(n.uniqueSessionName=e.uniqueSessionName),e.bufferSizeKb&&e.bufferSizeKb.length){n.bufferSizeKb=[];for(var a=0;a<e.bufferSizeKb.length;++a)n.bufferSizeKb[a]=e.bufferSizeKb[a]}return null!=e.durationMs&&e.hasOwnProperty("durationMs")&&(n.durationMs=e.durationMs),null!=e.numDataSources&&e.hasOwnProperty("numDataSources")&&(n.numDataSources=e.numDataSources),null!=e.startRealtimeNs&&e.hasOwnProperty("startRealtimeNs")&&("number"==typeof e.startRealtimeNs?n.startRealtimeNs=t.longs===String?String(e.startRealtimeNs):e.startRealtimeNs:n.startRealtimeNs=t.longs===String?i.Long.prototype.toString.call(e.startRealtimeNs):t.longs===Number?new i.LongBits(e.startRealtimeNs.low>>>0,e.startRealtimeNs.high>>>0).toNumber():e.startRealtimeNs),null!=e.bugreportScore&&e.hasOwnProperty("bugreportScore")&&(n.bugreportScore=e.bugreportScore),null!=e.bugreportFilename&&e.hasOwnProperty("bugreportFilename")&&(n.bugreportFilename=e.bugreportFilename),null!=e.isStarted&&e.hasOwnProperty("isStarted")&&(n.isStarted=e.isStarted),n},d.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},d.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TracingServiceState.TracingSession"},d),u),r.DataSourceDescriptor=(f.prototype.name="",f.prototype.id=i.Long?i.Long.fromBits(0,0,!0):0,f.prototype.willNotifyOnStop=!1,f.prototype.willNotifyOnStart=!1,f.prototype.handlesIncrementalStateClear=!1,f.prototype.noFlush=!1,f.prototype.gpuCounterDescriptor=null,f.prototype.trackEventDescriptor=null,f.prototype.ftraceDescriptor=null,f.create=function(e){return new f(e)},f.encode=function(e,t){return t=t||a.create(),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.willNotifyOnStop&&Object.hasOwnProperty.call(e,"willNotifyOnStop")&&t.uint32(16).bool(e.willNotifyOnStop),null!=e.willNotifyOnStart&&Object.hasOwnProperty.call(e,"willNotifyOnStart")&&t.uint32(24).bool(e.willNotifyOnStart),null!=e.handlesIncrementalStateClear&&Object.hasOwnProperty.call(e,"handlesIncrementalStateClear")&&t.uint32(32).bool(e.handlesIncrementalStateClear),null!=e.gpuCounterDescriptor&&Object.hasOwnProperty.call(e,"gpuCounterDescriptor")&&s.perfetto.protos.GpuCounterDescriptor.encode(e.gpuCounterDescriptor,t.uint32(42).fork()).ldelim(),null!=e.trackEventDescriptor&&Object.hasOwnProperty.call(e,"trackEventDescriptor")&&s.perfetto.protos.TrackEventDescriptor.encode(e.trackEventDescriptor,t.uint32(50).fork()).ldelim(),null!=e.id&&Object.hasOwnProperty.call(e,"id")&&t.uint32(56).uint64(e.id),null!=e.ftraceDescriptor&&Object.hasOwnProperty.call(e,"ftraceDescriptor")&&s.perfetto.protos.FtraceDescriptor.encode(e.ftraceDescriptor,t.uint32(66).fork()).ldelim(),null!=e.noFlush&&Object.hasOwnProperty.call(e,"noFlush")&&t.uint32(72).bool(e.noFlush),t},f.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.DataSourceDescriptor;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.name=e.string();break;case 7:n.id=e.uint64();break;case 2:n.willNotifyOnStop=e.bool();break;case 3:n.willNotifyOnStart=e.bool();break;case 4:n.handlesIncrementalStateClear=e.bool();break;case 9:n.noFlush=e.bool();break;case 5:n.gpuCounterDescriptor=s.perfetto.protos.GpuCounterDescriptor.decode(e,e.uint32());break;case 6:n.trackEventDescriptor=s.perfetto.protos.TrackEventDescriptor.decode(e,e.uint32());break;case 8:n.ftraceDescriptor=s.perfetto.protos.FtraceDescriptor.decode(e,e.uint32());break;default:e.skipType(7&a)}}return n},f.fromObject=function(e){if(e instanceof s.perfetto.protos.DataSourceDescriptor)return e;var t=new s.perfetto.protos.DataSourceDescriptor;if(null!=e.name&&(t.name=String(e.name)),null!=e.id&&(i.Long?(t.id=i.Long.fromValue(e.id)).unsigned=!0:"string"==typeof e.id?t.id=parseInt(e.id,10):"number"==typeof e.id?t.id=e.id:"object"==typeof e.id&&(t.id=new i.LongBits(e.id.low>>>0,e.id.high>>>0).toNumber(!0))),null!=e.willNotifyOnStop&&(t.willNotifyOnStop=Boolean(e.willNotifyOnStop)),null!=e.willNotifyOnStart&&(t.willNotifyOnStart=Boolean(e.willNotifyOnStart)),null!=e.handlesIncrementalStateClear&&(t.handlesIncrementalStateClear=Boolean(e.handlesIncrementalStateClear)),null!=e.noFlush&&(t.noFlush=Boolean(e.noFlush)),null!=e.gpuCounterDescriptor){if("object"!=typeof e.gpuCounterDescriptor)throw TypeError(".perfetto.protos.DataSourceDescriptor.gpuCounterDescriptor: object expected");t.gpuCounterDescriptor=s.perfetto.protos.GpuCounterDescriptor.fromObject(e.gpuCounterDescriptor)}if(null!=e.trackEventDescriptor){if("object"!=typeof e.trackEventDescriptor)throw TypeError(".perfetto.protos.DataSourceDescriptor.trackEventDescriptor: object expected");t.trackEventDescriptor=s.perfetto.protos.TrackEventDescriptor.fromObject(e.trackEventDescriptor)}if(null!=e.ftraceDescriptor){if("object"!=typeof e.ftraceDescriptor)throw TypeError(".perfetto.protos.DataSourceDescriptor.ftraceDescriptor: object expected");t.ftraceDescriptor=s.perfetto.protos.FtraceDescriptor.fromObject(e.ftraceDescriptor)}return t},f.toObject=function(e,t){var r,n={};return(t=t||{}).defaults&&(n.name="",n.willNotifyOnStop=!1,n.willNotifyOnStart=!1,n.handlesIncrementalStateClear=!1,n.gpuCounterDescriptor=null,n.trackEventDescriptor=null,i.Long?(r=new i.Long(0,0,!0),n.id=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.id=t.longs===String?"0":0,n.ftraceDescriptor=null,n.noFlush=!1),null!=e.name&&e.hasOwnProperty("name")&&(n.name=e.name),null!=e.willNotifyOnStop&&e.hasOwnProperty("willNotifyOnStop")&&(n.willNotifyOnStop=e.willNotifyOnStop),null!=e.willNotifyOnStart&&e.hasOwnProperty("willNotifyOnStart")&&(n.willNotifyOnStart=e.willNotifyOnStart),null!=e.handlesIncrementalStateClear&&e.hasOwnProperty("handlesIncrementalStateClear")&&(n.handlesIncrementalStateClear=e.handlesIncrementalStateClear),null!=e.gpuCounterDescriptor&&e.hasOwnProperty("gpuCounterDescriptor")&&(n.gpuCounterDescriptor=s.perfetto.protos.GpuCounterDescriptor.toObject(e.gpuCounterDescriptor,t)),null!=e.trackEventDescriptor&&e.hasOwnProperty("trackEventDescriptor")&&(n.trackEventDescriptor=s.perfetto.protos.TrackEventDescriptor.toObject(e.trackEventDescriptor,t)),null!=e.id&&e.hasOwnProperty("id")&&("number"==typeof e.id?n.id=t.longs===String?String(e.id):e.id:n.id=t.longs===String?i.Long.prototype.toString.call(e.id):t.longs===Number?new i.LongBits(e.id.low>>>0,e.id.high>>>0).toNumber(!0):e.id),null!=e.ftraceDescriptor&&e.hasOwnProperty("ftraceDescriptor")&&(n.ftraceDescriptor=s.perfetto.protos.FtraceDescriptor.toObject(e.ftraceDescriptor,t)),null!=e.noFlush&&e.hasOwnProperty("noFlush")&&(n.noFlush=e.noFlush),n},f.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},f.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.DataSourceDescriptor"},f),r.FtraceDescriptor=(Te.prototype.atraceCategories=i.emptyArray,Te.create=function(e){return new Te(e)},Te.encode=function(e,t){if(t=t||a.create(),null!=e.atraceCategories&&e.atraceCategories.length)for(var r=0;r<e.atraceCategories.length;++r)s.perfetto.protos.FtraceDescriptor.AtraceCategory.encode(e.atraceCategories[r],t.uint32(10).fork()).ldelim();return t},Te.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.FtraceDescriptor;e.pos<r;){var a=e.uint32();a>>>3==1?(n.atraceCategories&&n.atraceCategories.length||(n.atraceCategories=[]),n.atraceCategories.push(s.perfetto.protos.FtraceDescriptor.AtraceCategory.decode(e,e.uint32()))):e.skipType(7&a)}return n},Te.fromObject=function(e){if(e instanceof s.perfetto.protos.FtraceDescriptor)return e;var t=new s.perfetto.protos.FtraceDescriptor;if(e.atraceCategories){if(!Array.isArray(e.atraceCategories))throw TypeError(".perfetto.protos.FtraceDescriptor.atraceCategories: array expected");t.atraceCategories=[];for(var r=0;r<e.atraceCategories.length;++r){if("object"!=typeof e.atraceCategories[r])throw TypeError(".perfetto.protos.FtraceDescriptor.atraceCategories: object expected");t.atraceCategories[r]=s.perfetto.protos.FtraceDescriptor.AtraceCategory.fromObject(e.atraceCategories[r])}}return t},Te.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.atraceCategories=[]),e.atraceCategories&&e.atraceCategories.length){r.atraceCategories=[];for(var n=0;n<e.atraceCategories.length;++n)r.atraceCategories[n]=s.perfetto.protos.FtraceDescriptor.AtraceCategory.toObject(e.atraceCategories[n],t)}return r},Te.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Te.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.FtraceDescriptor"},Te.AtraceCategory=(be.prototype.name="",be.prototype.description="",be.create=function(e){return new be(e)},be.encode=function(e,t){return t=t||a.create(),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.description&&Object.hasOwnProperty.call(e,"description")&&t.uint32(18).string(e.description),t},be.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.FtraceDescriptor.AtraceCategory;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.name=e.string();break;case 2:n.description=e.string();break;default:e.skipType(7&a)}}return n},be.fromObject=function(e){var t;return e instanceof s.perfetto.protos.FtraceDescriptor.AtraceCategory?e:(t=new s.perfetto.protos.FtraceDescriptor.AtraceCategory,null!=e.name&&(t.name=String(e.name)),null!=e.description&&(t.description=String(e.description)),t)},be.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.name="",r.description=""),null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.description&&e.hasOwnProperty("description")&&(r.description=e.description),r},be.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},be.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.FtraceDescriptor.AtraceCategory"},be),Te),r.GpuCounterDescriptor=(p.prototype.specs=i.emptyArray,p.prototype.blocks=i.emptyArray,p.prototype.minSamplingPeriodNs=i.Long?i.Long.fromBits(0,0,!0):0,p.prototype.maxSamplingPeriodNs=i.Long?i.Long.fromBits(0,0,!0):0,p.prototype.supportsInstrumentedSampling=!1,p.create=function(e){return new p(e)},p.encode=function(e,t){if(t=t||a.create(),null!=e.specs&&e.specs.length)for(var r=0;r<e.specs.length;++r)s.perfetto.protos.GpuCounterDescriptor.GpuCounterSpec.encode(e.specs[r],t.uint32(10).fork()).ldelim();if(null!=e.blocks&&e.blocks.length)for(r=0;r<e.blocks.length;++r)s.perfetto.protos.GpuCounterDescriptor.GpuCounterBlock.encode(e.blocks[r],t.uint32(18).fork()).ldelim();return null!=e.minSamplingPeriodNs&&Object.hasOwnProperty.call(e,"minSamplingPeriodNs")&&t.uint32(24).uint64(e.minSamplingPeriodNs),null!=e.maxSamplingPeriodNs&&Object.hasOwnProperty.call(e,"maxSamplingPeriodNs")&&t.uint32(32).uint64(e.maxSamplingPeriodNs),null!=e.supportsInstrumentedSampling&&Object.hasOwnProperty.call(e,"supportsInstrumentedSampling")&&t.uint32(40).bool(e.supportsInstrumentedSampling),t},p.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.GpuCounterDescriptor;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.specs&&n.specs.length||(n.specs=[]),n.specs.push(s.perfetto.protos.GpuCounterDescriptor.GpuCounterSpec.decode(e,e.uint32()));break;case 2:n.blocks&&n.blocks.length||(n.blocks=[]),n.blocks.push(s.perfetto.protos.GpuCounterDescriptor.GpuCounterBlock.decode(e,e.uint32()));break;case 3:n.minSamplingPeriodNs=e.uint64();break;case 4:n.maxSamplingPeriodNs=e.uint64();break;case 5:n.supportsInstrumentedSampling=e.bool();break;default:e.skipType(7&a)}}return n},p.fromObject=function(e){if(e instanceof s.perfetto.protos.GpuCounterDescriptor)return e;var t=new s.perfetto.protos.GpuCounterDescriptor;if(e.specs){if(!Array.isArray(e.specs))throw TypeError(".perfetto.protos.GpuCounterDescriptor.specs: array expected");t.specs=[];for(var r=0;r<e.specs.length;++r){if("object"!=typeof e.specs[r])throw TypeError(".perfetto.protos.GpuCounterDescriptor.specs: object expected");t.specs[r]=s.perfetto.protos.GpuCounterDescriptor.GpuCounterSpec.fromObject(e.specs[r])}}if(e.blocks){if(!Array.isArray(e.blocks))throw TypeError(".perfetto.protos.GpuCounterDescriptor.blocks: array expected");t.blocks=[];for(r=0;r<e.blocks.length;++r){if("object"!=typeof e.blocks[r])throw TypeError(".perfetto.protos.GpuCounterDescriptor.blocks: object expected");t.blocks[r]=s.perfetto.protos.GpuCounterDescriptor.GpuCounterBlock.fromObject(e.blocks[r])}}return null!=e.minSamplingPeriodNs&&(i.Long?(t.minSamplingPeriodNs=i.Long.fromValue(e.minSamplingPeriodNs)).unsigned=!0:"string"==typeof e.minSamplingPeriodNs?t.minSamplingPeriodNs=parseInt(e.minSamplingPeriodNs,10):"number"==typeof e.minSamplingPeriodNs?t.minSamplingPeriodNs=e.minSamplingPeriodNs:"object"==typeof e.minSamplingPeriodNs&&(t.minSamplingPeriodNs=new i.LongBits(e.minSamplingPeriodNs.low>>>0,e.minSamplingPeriodNs.high>>>0).toNumber(!0))),null!=e.maxSamplingPeriodNs&&(i.Long?(t.maxSamplingPeriodNs=i.Long.fromValue(e.maxSamplingPeriodNs)).unsigned=!0:"string"==typeof e.maxSamplingPeriodNs?t.maxSamplingPeriodNs=parseInt(e.maxSamplingPeriodNs,10):"number"==typeof e.maxSamplingPeriodNs?t.maxSamplingPeriodNs=e.maxSamplingPeriodNs:"object"==typeof e.maxSamplingPeriodNs&&(t.maxSamplingPeriodNs=new i.LongBits(e.maxSamplingPeriodNs.low>>>0,e.maxSamplingPeriodNs.high>>>0).toNumber(!0))),null!=e.supportsInstrumentedSampling&&(t.supportsInstrumentedSampling=Boolean(e.supportsInstrumentedSampling)),t},p.toObject=function(e,t){var r,n={};if(((t=t||{}).arrays||t.defaults)&&(n.specs=[],n.blocks=[]),t.defaults&&(i.Long?(r=new i.Long(0,0,!0),n.minSamplingPeriodNs=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.minSamplingPeriodNs=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.maxSamplingPeriodNs=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.maxSamplingPeriodNs=t.longs===String?"0":0,n.supportsInstrumentedSampling=!1),e.specs&&e.specs.length){n.specs=[];for(var a=0;a<e.specs.length;++a)n.specs[a]=s.perfetto.protos.GpuCounterDescriptor.GpuCounterSpec.toObject(e.specs[a],t)}if(e.blocks&&e.blocks.length){n.blocks=[];for(a=0;a<e.blocks.length;++a)n.blocks[a]=s.perfetto.protos.GpuCounterDescriptor.GpuCounterBlock.toObject(e.blocks[a],t)}return null!=e.minSamplingPeriodNs&&e.hasOwnProperty("minSamplingPeriodNs")&&("number"==typeof e.minSamplingPeriodNs?n.minSamplingPeriodNs=t.longs===String?String(e.minSamplingPeriodNs):e.minSamplingPeriodNs:n.minSamplingPeriodNs=t.longs===String?i.Long.prototype.toString.call(e.minSamplingPeriodNs):t.longs===Number?new i.LongBits(e.minSamplingPeriodNs.low>>>0,e.minSamplingPeriodNs.high>>>0).toNumber(!0):e.minSamplingPeriodNs),null!=e.maxSamplingPeriodNs&&e.hasOwnProperty("maxSamplingPeriodNs")&&("number"==typeof e.maxSamplingPeriodNs?n.maxSamplingPeriodNs=t.longs===String?String(e.maxSamplingPeriodNs):e.maxSamplingPeriodNs:n.maxSamplingPeriodNs=t.longs===String?i.Long.prototype.toString.call(e.maxSamplingPeriodNs):t.longs===Number?new i.LongBits(e.maxSamplingPeriodNs.low>>>0,e.maxSamplingPeriodNs.high>>>0).toNumber(!0):e.maxSamplingPeriodNs),null!=e.supportsInstrumentedSampling&&e.hasOwnProperty("supportsInstrumentedSampling")&&(n.supportsInstrumentedSampling=e.supportsInstrumentedSampling),n},p.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},p.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.GpuCounterDescriptor"},p.GpuCounterGroup=(e={},(t=Object.create(e))[e[0]="UNCLASSIFIED"]=0,t[e[1]="SYSTEM"]=1,t[e[2]="VERTICES"]=2,t[e[3]="FRAGMENTS"]=3,t[e[4]="PRIMITIVES"]=4,t[e[5]="MEMORY"]=5,t[e[6]="COMPUTE"]=6,t),p.GpuCounterSpec=(h.prototype.counterId=0,h.prototype.name="",h.prototype.description="",h.prototype.intPeakValue=null,h.prototype.doublePeakValue=null,h.prototype.numeratorUnits=i.emptyArray,h.prototype.denominatorUnits=i.emptyArray,h.prototype.selectByDefault=!1,h.prototype.groups=i.emptyArray,Object.defineProperty(h.prototype,"peakValue",{get:i.oneOfGetter(e=["intPeakValue","doublePeakValue"]),set:i.oneOfSetter(e)}),h.create=function(e){return new h(e)},h.encode=function(e,t){if(t=t||a.create(),null!=e.counterId&&Object.hasOwnProperty.call(e,"counterId")&&t.uint32(8).uint32(e.counterId),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(18).string(e.name),null!=e.description&&Object.hasOwnProperty.call(e,"description")&&t.uint32(26).string(e.description),null!=e.intPeakValue&&Object.hasOwnProperty.call(e,"intPeakValue")&&t.uint32(40).int64(e.intPeakValue),null!=e.doublePeakValue&&Object.hasOwnProperty.call(e,"doublePeakValue")&&t.uint32(49).double(e.doublePeakValue),null!=e.numeratorUnits&&e.numeratorUnits.length)for(var r=0;r<e.numeratorUnits.length;++r)t.uint32(56).int32(e.numeratorUnits[r]);if(null!=e.denominatorUnits&&e.denominatorUnits.length)for(r=0;r<e.denominatorUnits.length;++r)t.uint32(64).int32(e.denominatorUnits[r]);if(null!=e.selectByDefault&&Object.hasOwnProperty.call(e,"selectByDefault")&&t.uint32(72).bool(e.selectByDefault),null!=e.groups&&e.groups.length)for(r=0;r<e.groups.length;++r)t.uint32(80).int32(e.groups[r]);return t},h.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.GpuCounterDescriptor.GpuCounterSpec;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.counterId=e.uint32();break;case 2:n.name=e.string();break;case 3:n.description=e.string();break;case 5:n.intPeakValue=e.int64();break;case 6:n.doublePeakValue=e.double();break;case 7:if(n.numeratorUnits&&n.numeratorUnits.length||(n.numeratorUnits=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.numeratorUnits.push(e.int32());else n.numeratorUnits.push(e.int32());break;case 8:if(n.denominatorUnits&&n.denominatorUnits.length||(n.denominatorUnits=[]),2==(7&a))for(i=e.uint32()+e.pos;e.pos<i;)n.denominatorUnits.push(e.int32());else n.denominatorUnits.push(e.int32());break;case 9:n.selectByDefault=e.bool();break;case 10:if(n.groups&&n.groups.length||(n.groups=[]),2==(7&a))for(i=e.uint32()+e.pos;e.pos<i;)n.groups.push(e.int32());else n.groups.push(e.int32());break;default:e.skipType(7&a)}}return n},h.fromObject=function(e){if(e instanceof s.perfetto.protos.GpuCounterDescriptor.GpuCounterSpec)return e;var t=new s.perfetto.protos.GpuCounterDescriptor.GpuCounterSpec;if(null!=e.counterId&&(t.counterId=e.counterId>>>0),null!=e.name&&(t.name=String(e.name)),null!=e.description&&(t.description=String(e.description)),null!=e.intPeakValue&&(i.Long?(t.intPeakValue=i.Long.fromValue(e.intPeakValue)).unsigned=!1:"string"==typeof e.intPeakValue?t.intPeakValue=parseInt(e.intPeakValue,10):"number"==typeof e.intPeakValue?t.intPeakValue=e.intPeakValue:"object"==typeof e.intPeakValue&&(t.intPeakValue=new i.LongBits(e.intPeakValue.low>>>0,e.intPeakValue.high>>>0).toNumber())),null!=e.doublePeakValue&&(t.doublePeakValue=Number(e.doublePeakValue)),e.numeratorUnits){if(!Array.isArray(e.numeratorUnits))throw TypeError(".perfetto.protos.GpuCounterDescriptor.GpuCounterSpec.numeratorUnits: array expected");t.numeratorUnits=[];for(var r=0;r<e.numeratorUnits.length;++r)switch(e.numeratorUnits[r]){default:if("number"==typeof e.numeratorUnits[r]){t.numeratorUnits[r]=e.numeratorUnits[r];break}case"NONE":case 0:t.numeratorUnits[r]=0;break;case"BIT":case 1:t.numeratorUnits[r]=1;break;case"KILOBIT":case 2:t.numeratorUnits[r]=2;break;case"MEGABIT":case 3:t.numeratorUnits[r]=3;break;case"GIGABIT":case 4:t.numeratorUnits[r]=4;break;case"TERABIT":case 5:t.numeratorUnits[r]=5;break;case"PETABIT":case 6:t.numeratorUnits[r]=6;break;case"BYTE":case 7:t.numeratorUnits[r]=7;break;case"KILOBYTE":case 8:t.numeratorUnits[r]=8;break;case"MEGABYTE":case 9:t.numeratorUnits[r]=9;break;case"GIGABYTE":case 10:t.numeratorUnits[r]=10;break;case"TERABYTE":case 11:t.numeratorUnits[r]=11;break;case"PETABYTE":case 12:t.numeratorUnits[r]=12;break;case"HERTZ":case 13:t.numeratorUnits[r]=13;break;case"KILOHERTZ":case 14:t.numeratorUnits[r]=14;break;case"MEGAHERTZ":case 15:t.numeratorUnits[r]=15;break;case"GIGAHERTZ":case 16:t.numeratorUnits[r]=16;break;case"TERAHERTZ":case 17:t.numeratorUnits[r]=17;break;case"PETAHERTZ":case 18:t.numeratorUnits[r]=18;break;case"NANOSECOND":case 19:t.numeratorUnits[r]=19;break;case"MICROSECOND":case 20:t.numeratorUnits[r]=20;break;case"MILLISECOND":case 21:t.numeratorUnits[r]=21;break;case"SECOND":case 22:t.numeratorUnits[r]=22;break;case"MINUTE":case 23:t.numeratorUnits[r]=23;break;case"HOUR":case 24:t.numeratorUnits[r]=24;break;case"VERTEX":case 25:t.numeratorUnits[r]=25;break;case"PIXEL":case 26:t.numeratorUnits[r]=26;break;case"TRIANGLE":case 27:t.numeratorUnits[r]=27;break;case"PRIMITIVE":case 38:t.numeratorUnits[r]=38;break;case"FRAGMENT":case 39:t.numeratorUnits[r]=39;break;case"MILLIWATT":case 28:t.numeratorUnits[r]=28;break;case"WATT":case 29:t.numeratorUnits[r]=29;break;case"KILOWATT":case 30:t.numeratorUnits[r]=30;break;case"JOULE":case 31:t.numeratorUnits[r]=31;break;case"VOLT":case 32:t.numeratorUnits[r]=32;break;case"AMPERE":case 33:t.numeratorUnits[r]=33;break;case"CELSIUS":case 34:t.numeratorUnits[r]=34;break;case"FAHRENHEIT":case 35:t.numeratorUnits[r]=35;break;case"KELVIN":case 36:t.numeratorUnits[r]=36;break;case"PERCENT":case 37:t.numeratorUnits[r]=37;break;case"INSTRUCTION":case 40:t.numeratorUnits[r]=40}}if(e.denominatorUnits){if(!Array.isArray(e.denominatorUnits))throw TypeError(".perfetto.protos.GpuCounterDescriptor.GpuCounterSpec.denominatorUnits: array expected");t.denominatorUnits=[];for(r=0;r<e.denominatorUnits.length;++r)switch(e.denominatorUnits[r]){default:if("number"==typeof e.denominatorUnits[r]){t.denominatorUnits[r]=e.denominatorUnits[r];break}case"NONE":case 0:t.denominatorUnits[r]=0;break;case"BIT":case 1:t.denominatorUnits[r]=1;break;case"KILOBIT":case 2:t.denominatorUnits[r]=2;break;case"MEGABIT":case 3:t.denominatorUnits[r]=3;break;case"GIGABIT":case 4:t.denominatorUnits[r]=4;break;case"TERABIT":case 5:t.denominatorUnits[r]=5;break;case"PETABIT":case 6:t.denominatorUnits[r]=6;break;case"BYTE":case 7:t.denominatorUnits[r]=7;break;case"KILOBYTE":case 8:t.denominatorUnits[r]=8;break;case"MEGABYTE":case 9:t.denominatorUnits[r]=9;break;case"GIGABYTE":case 10:t.denominatorUnits[r]=10;break;case"TERABYTE":case 11:t.denominatorUnits[r]=11;break;case"PETABYTE":case 12:t.denominatorUnits[r]=12;break;case"HERTZ":case 13:t.denominatorUnits[r]=13;break;case"KILOHERTZ":case 14:t.denominatorUnits[r]=14;break;case"MEGAHERTZ":case 15:t.denominatorUnits[r]=15;break;case"GIGAHERTZ":case 16:t.denominatorUnits[r]=16;break;case"TERAHERTZ":case 17:t.denominatorUnits[r]=17;break;case"PETAHERTZ":case 18:t.denominatorUnits[r]=18;break;case"NANOSECOND":case 19:t.denominatorUnits[r]=19;break;case"MICROSECOND":case 20:t.denominatorUnits[r]=20;break;case"MILLISECOND":case 21:t.denominatorUnits[r]=21;break;case"SECOND":case 22:t.denominatorUnits[r]=22;break;case"MINUTE":case 23:t.denominatorUnits[r]=23;break;case"HOUR":case 24:t.denominatorUnits[r]=24;break;case"VERTEX":case 25:t.denominatorUnits[r]=25;break;case"PIXEL":case 26:t.denominatorUnits[r]=26;break;case"TRIANGLE":case 27:t.denominatorUnits[r]=27;break;case"PRIMITIVE":case 38:t.denominatorUnits[r]=38;break;case"FRAGMENT":case 39:t.denominatorUnits[r]=39;break;case"MILLIWATT":case 28:t.denominatorUnits[r]=28;break;case"WATT":case 29:t.denominatorUnits[r]=29;break;case"KILOWATT":case 30:t.denominatorUnits[r]=30;break;case"JOULE":case 31:t.denominatorUnits[r]=31;break;case"VOLT":case 32:t.denominatorUnits[r]=32;break;case"AMPERE":case 33:t.denominatorUnits[r]=33;break;case"CELSIUS":case 34:t.denominatorUnits[r]=34;break;case"FAHRENHEIT":case 35:t.denominatorUnits[r]=35;break;case"KELVIN":case 36:t.denominatorUnits[r]=36;break;case"PERCENT":case 37:t.denominatorUnits[r]=37;break;case"INSTRUCTION":case 40:t.denominatorUnits[r]=40}}if(null!=e.selectByDefault&&(t.selectByDefault=Boolean(e.selectByDefault)),e.groups){if(!Array.isArray(e.groups))throw TypeError(".perfetto.protos.GpuCounterDescriptor.GpuCounterSpec.groups: array expected");t.groups=[];for(r=0;r<e.groups.length;++r)switch(e.groups[r]){default:if("number"==typeof e.groups[r]){t.groups[r]=e.groups[r];break}case"UNCLASSIFIED":case 0:t.groups[r]=0;break;case"SYSTEM":case 1:t.groups[r]=1;break;case"VERTICES":case 2:t.groups[r]=2;break;case"FRAGMENTS":case 3:t.groups[r]=3;break;case"PRIMITIVES":case 4:t.groups[r]=4;break;case"MEMORY":case 5:t.groups[r]=5;break;case"COMPUTE":case 6:t.groups[r]=6}}return t},h.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.numeratorUnits=[],r.denominatorUnits=[],r.groups=[]),t.defaults&&(r.counterId=0,r.name="",r.description="",r.selectByDefault=!1),null!=e.counterId&&e.hasOwnProperty("counterId")&&(r.counterId=e.counterId),null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.description&&e.hasOwnProperty("description")&&(r.description=e.description),null!=e.intPeakValue&&e.hasOwnProperty("intPeakValue")&&("number"==typeof e.intPeakValue?r.intPeakValue=t.longs===String?String(e.intPeakValue):e.intPeakValue:r.intPeakValue=t.longs===String?i.Long.prototype.toString.call(e.intPeakValue):t.longs===Number?new i.LongBits(e.intPeakValue.low>>>0,e.intPeakValue.high>>>0).toNumber():e.intPeakValue,t.oneofs)&&(r.peakValue="intPeakValue"),null!=e.doublePeakValue&&e.hasOwnProperty("doublePeakValue")&&(r.doublePeakValue=t.json&&!isFinite(e.doublePeakValue)?String(e.doublePeakValue):e.doublePeakValue,t.oneofs)&&(r.peakValue="doublePeakValue"),e.numeratorUnits&&e.numeratorUnits.length){r.numeratorUnits=[];for(var n=0;n<e.numeratorUnits.length;++n)r.numeratorUnits[n]=t.enums!==String||void 0===s.perfetto.protos.GpuCounterDescriptor.MeasureUnit[e.numeratorUnits[n]]?e.numeratorUnits[n]:s.perfetto.protos.GpuCounterDescriptor.MeasureUnit[e.numeratorUnits[n]]}if(e.denominatorUnits&&e.denominatorUnits.length){r.denominatorUnits=[];for(n=0;n<e.denominatorUnits.length;++n)r.denominatorUnits[n]=t.enums!==String||void 0===s.perfetto.protos.GpuCounterDescriptor.MeasureUnit[e.denominatorUnits[n]]?e.denominatorUnits[n]:s.perfetto.protos.GpuCounterDescriptor.MeasureUnit[e.denominatorUnits[n]]}if(null!=e.selectByDefault&&e.hasOwnProperty("selectByDefault")&&(r.selectByDefault=e.selectByDefault),e.groups&&e.groups.length){r.groups=[];for(n=0;n<e.groups.length;++n)r.groups[n]=t.enums!==String||void 0===s.perfetto.protos.GpuCounterDescriptor.GpuCounterGroup[e.groups[n]]?e.groups[n]:s.perfetto.protos.GpuCounterDescriptor.GpuCounterGroup[e.groups[n]]}return r},h.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},h.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.GpuCounterDescriptor.GpuCounterSpec"},h),p.GpuCounterBlock=(ve.prototype.blockId=0,ve.prototype.blockCapacity=0,ve.prototype.name="",ve.prototype.description="",ve.prototype.counterIds=i.emptyArray,ve.create=function(e){return new ve(e)},ve.encode=function(e,t){if(t=t||a.create(),null!=e.blockId&&Object.hasOwnProperty.call(e,"blockId")&&t.uint32(8).uint32(e.blockId),null!=e.blockCapacity&&Object.hasOwnProperty.call(e,"blockCapacity")&&t.uint32(16).uint32(e.blockCapacity),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(26).string(e.name),null!=e.description&&Object.hasOwnProperty.call(e,"description")&&t.uint32(34).string(e.description),null!=e.counterIds&&e.counterIds.length)for(var r=0;r<e.counterIds.length;++r)t.uint32(40).uint32(e.counterIds[r]);return t},ve.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.GpuCounterDescriptor.GpuCounterBlock;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.blockId=e.uint32();break;case 2:n.blockCapacity=e.uint32();break;case 3:n.name=e.string();break;case 4:n.description=e.string();break;case 5:if(n.counterIds&&n.counterIds.length||(n.counterIds=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.counterIds.push(e.uint32());else n.counterIds.push(e.uint32());break;default:e.skipType(7&a)}}return n},ve.fromObject=function(e){if(e instanceof s.perfetto.protos.GpuCounterDescriptor.GpuCounterBlock)return e;var t=new s.perfetto.protos.GpuCounterDescriptor.GpuCounterBlock;if(null!=e.blockId&&(t.blockId=e.blockId>>>0),null!=e.blockCapacity&&(t.blockCapacity=e.blockCapacity>>>0),null!=e.name&&(t.name=String(e.name)),null!=e.description&&(t.description=String(e.description)),e.counterIds){if(!Array.isArray(e.counterIds))throw TypeError(".perfetto.protos.GpuCounterDescriptor.GpuCounterBlock.counterIds: array expected");t.counterIds=[];for(var r=0;r<e.counterIds.length;++r)t.counterIds[r]=e.counterIds[r]>>>0}return t},ve.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.counterIds=[]),t.defaults&&(r.blockId=0,r.blockCapacity=0,r.name="",r.description=""),null!=e.blockId&&e.hasOwnProperty("blockId")&&(r.blockId=e.blockId),null!=e.blockCapacity&&e.hasOwnProperty("blockCapacity")&&(r.blockCapacity=e.blockCapacity),null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.description&&e.hasOwnProperty("description")&&(r.description=e.description),e.counterIds&&e.counterIds.length){r.counterIds=[];for(var n=0;n<e.counterIds.length;++n)r.counterIds[n]=e.counterIds[n]}return r},ve.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},ve.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.GpuCounterDescriptor.GpuCounterBlock"},ve),p.MeasureUnit=(t={},(e=Object.create(t))[t[0]="NONE"]=0,e[t[1]="BIT"]=1,e[t[2]="KILOBIT"]=2,e[t[3]="MEGABIT"]=3,e[t[4]="GIGABIT"]=4,e[t[5]="TERABIT"]=5,e[t[6]="PETABIT"]=6,e[t[7]="BYTE"]=7,e[t[8]="KILOBYTE"]=8,e[t[9]="MEGABYTE"]=9,e[t[10]="GIGABYTE"]=10,e[t[11]="TERABYTE"]=11,e[t[12]="PETABYTE"]=12,e[t[13]="HERTZ"]=13,e[t[14]="KILOHERTZ"]=14,e[t[15]="MEGAHERTZ"]=15,e[t[16]="GIGAHERTZ"]=16,e[t[17]="TERAHERTZ"]=17,e[t[18]="PETAHERTZ"]=18,e[t[19]="NANOSECOND"]=19,e[t[20]="MICROSECOND"]=20,e[t[21]="MILLISECOND"]=21,e[t[22]="SECOND"]=22,e[t[23]="MINUTE"]=23,e[t[24]="HOUR"]=24,e[t[25]="VERTEX"]=25,e[t[26]="PIXEL"]=26,e[t[27]="TRIANGLE"]=27,e[t[38]="PRIMITIVE"]=38,e[t[39]="FRAGMENT"]=39,e[t[28]="MILLIWATT"]=28,e[t[29]="WATT"]=29,e[t[30]="KILOWATT"]=30,e[t[31]="JOULE"]=31,e[t[32]="VOLT"]=32,e[t[33]="AMPERE"]=33,e[t[34]="CELSIUS"]=34,e[t[35]="FAHRENHEIT"]=35,e[t[36]="KELVIN"]=36,e[t[37]="PERCENT"]=37,e[t[40]="INSTRUCTION"]=40,e),p),r.TrackEventCategory=(Ee.prototype.name="",Ee.prototype.description="",Ee.prototype.tags=i.emptyArray,Ee.create=function(e){return new Ee(e)},Ee.encode=function(e,t){if(t=t||a.create(),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.description&&Object.hasOwnProperty.call(e,"description")&&t.uint32(18).string(e.description),null!=e.tags&&e.tags.length)for(var r=0;r<e.tags.length;++r)t.uint32(26).string(e.tags[r]);return t},Ee.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TrackEventCategory;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.name=e.string();break;case 2:n.description=e.string();break;case 3:n.tags&&n.tags.length||(n.tags=[]),n.tags.push(e.string());break;default:e.skipType(7&a)}}return n},Ee.fromObject=function(e){if(e instanceof s.perfetto.protos.TrackEventCategory)return e;var t=new s.perfetto.protos.TrackEventCategory;if(null!=e.name&&(t.name=String(e.name)),null!=e.description&&(t.description=String(e.description)),e.tags){if(!Array.isArray(e.tags))throw TypeError(".perfetto.protos.TrackEventCategory.tags: array expected");t.tags=[];for(var r=0;r<e.tags.length;++r)t.tags[r]=String(e.tags[r])}return t},Ee.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.tags=[]),t.defaults&&(r.name="",r.description=""),null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.description&&e.hasOwnProperty("description")&&(r.description=e.description),e.tags&&e.tags.length){r.tags=[];for(var n=0;n<e.tags.length;++n)r.tags[n]=e.tags[n]}return r},Ee.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Ee.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TrackEventCategory"},Ee),r.TrackEventDescriptor=(Se.prototype.availableCategories=i.emptyArray,Se.create=function(e){return new Se(e)},Se.encode=function(e,t){if(t=t||a.create(),null!=e.availableCategories&&e.availableCategories.length)for(var r=0;r<e.availableCategories.length;++r)s.perfetto.protos.TrackEventCategory.encode(e.availableCategories[r],t.uint32(10).fork()).ldelim();return t},Se.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TrackEventDescriptor;e.pos<r;){var a=e.uint32();a>>>3==1?(n.availableCategories&&n.availableCategories.length||(n.availableCategories=[]),n.availableCategories.push(s.perfetto.protos.TrackEventCategory.decode(e,e.uint32()))):e.skipType(7&a)}return n},Se.fromObject=function(e){if(e instanceof s.perfetto.protos.TrackEventDescriptor)return e;var t=new s.perfetto.protos.TrackEventDescriptor;if(e.availableCategories){if(!Array.isArray(e.availableCategories))throw TypeError(".perfetto.protos.TrackEventDescriptor.availableCategories: array expected");t.availableCategories=[];for(var r=0;r<e.availableCategories.length;++r){if("object"!=typeof e.availableCategories[r])throw TypeError(".perfetto.protos.TrackEventDescriptor.availableCategories: object expected");t.availableCategories[r]=s.perfetto.protos.TrackEventCategory.fromObject(e.availableCategories[r])}}return t},Se.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.availableCategories=[]),e.availableCategories&&e.availableCategories.length){r.availableCategories=[];for(var n=0;n<e.availableCategories.length;++n)r.availableCategories[n]=s.perfetto.protos.TrackEventCategory.toObject(e.availableCategories[n],t)}return r},Se.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Se.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TrackEventDescriptor"},Se),r.TracingServiceCapabilities=(Ae.prototype.hasQueryCapabilities=!1,Ae.prototype.observableEvents=i.emptyArray,Ae.prototype.hasTraceConfigOutputPath=!1,Ae.prototype.hasCloneSession=!1,Ae.create=function(e){return new Ae(e)},Ae.encode=function(e,t){if(t=t||a.create(),null!=e.hasQueryCapabilities&&Object.hasOwnProperty.call(e,"hasQueryCapabilities")&&t.uint32(8).bool(e.hasQueryCapabilities),null!=e.observableEvents&&e.observableEvents.length)for(var r=0;r<e.observableEvents.length;++r)t.uint32(16).int32(e.observableEvents[r]);return null!=e.hasTraceConfigOutputPath&&Object.hasOwnProperty.call(e,"hasTraceConfigOutputPath")&&t.uint32(24).bool(e.hasTraceConfigOutputPath),null!=e.hasCloneSession&&Object.hasOwnProperty.call(e,"hasCloneSession")&&t.uint32(32).bool(e.hasCloneSession),t},Ae.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TracingServiceCapabilities;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.hasQueryCapabilities=e.bool();break;case 2:if(n.observableEvents&&n.observableEvents.length||(n.observableEvents=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.observableEvents.push(e.int32());else n.observableEvents.push(e.int32());break;case 3:n.hasTraceConfigOutputPath=e.bool();break;case 4:n.hasCloneSession=e.bool();break;default:e.skipType(7&a)}}return n},Ae.fromObject=function(e){if(e instanceof s.perfetto.protos.TracingServiceCapabilities)return e;var t=new s.perfetto.protos.TracingServiceCapabilities;if(null!=e.hasQueryCapabilities&&(t.hasQueryCapabilities=Boolean(e.hasQueryCapabilities)),e.observableEvents){if(!Array.isArray(e.observableEvents))throw TypeError(".perfetto.protos.TracingServiceCapabilities.observableEvents: array expected");t.observableEvents=[];for(var r=0;r<e.observableEvents.length;++r)switch(e.observableEvents[r]){default:if("number"==typeof e.observableEvents[r]){t.observableEvents[r]=e.observableEvents[r];break}case"TYPE_UNSPECIFIED":case 0:t.observableEvents[r]=0;break;case"TYPE_DATA_SOURCES_INSTANCES":case 1:t.observableEvents[r]=1;break;case"TYPE_ALL_DATA_SOURCES_STARTED":case 2:t.observableEvents[r]=2;break;case"TYPE_CLONE_TRIGGER_HIT":case 4:t.observableEvents[r]=4}}return null!=e.hasTraceConfigOutputPath&&(t.hasTraceConfigOutputPath=Boolean(e.hasTraceConfigOutputPath)),null!=e.hasCloneSession&&(t.hasCloneSession=Boolean(e.hasCloneSession)),t},Ae.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.observableEvents=[]),t.defaults&&(r.hasQueryCapabilities=!1,r.hasTraceConfigOutputPath=!1,r.hasCloneSession=!1),null!=e.hasQueryCapabilities&&e.hasOwnProperty("hasQueryCapabilities")&&(r.hasQueryCapabilities=e.hasQueryCapabilities),e.observableEvents&&e.observableEvents.length){r.observableEvents=[];for(var n=0;n<e.observableEvents.length;++n)r.observableEvents[n]=t.enums!==String||void 0===s.perfetto.protos.ObservableEvents.Type[e.observableEvents[n]]?e.observableEvents[n]:s.perfetto.protos.ObservableEvents.Type[e.observableEvents[n]]}return null!=e.hasTraceConfigOutputPath&&e.hasOwnProperty("hasTraceConfigOutputPath")&&(r.hasTraceConfigOutputPath=e.hasTraceConfigOutputPath),null!=e.hasCloneSession&&e.hasOwnProperty("hasCloneSession")&&(r.hasCloneSession=e.hasCloneSession),r},Ae.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Ae.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TracingServiceCapabilities"},Ae),r.TraceStats=(g.prototype.bufferStats=i.emptyArray,g.prototype.chunkPayloadHistogramDef=i.emptyArray,g.prototype.writerStats=i.emptyArray,g.prototype.producersConnected=0,g.prototype.producersSeen=i.Long?i.Long.fromBits(0,0,!0):0,g.prototype.dataSourcesRegistered=0,g.prototype.dataSourcesSeen=i.Long?i.Long.fromBits(0,0,!0):0,g.prototype.tracingSessions=0,g.prototype.totalBuffers=0,g.prototype.chunksDiscarded=i.Long?i.Long.fromBits(0,0,!0):0,g.prototype.patchesDiscarded=i.Long?i.Long.fromBits(0,0,!0):0,g.prototype.invalidPackets=i.Long?i.Long.fromBits(0,0,!0):0,g.prototype.filterStats=null,g.prototype.flushesRequested=i.Long?i.Long.fromBits(0,0,!0):0,g.prototype.flushesSucceeded=i.Long?i.Long.fromBits(0,0,!0):0,g.prototype.flushesFailed=i.Long?i.Long.fromBits(0,0,!0):0,g.prototype.finalFlushOutcome=0,g.create=function(e){return new g(e)},g.encode=function(e,t){if(t=t||a.create(),null!=e.bufferStats&&e.bufferStats.length)for(var r=0;r<e.bufferStats.length;++r)s.perfetto.protos.TraceStats.BufferStats.encode(e.bufferStats[r],t.uint32(10).fork()).ldelim();if(null!=e.producersConnected&&Object.hasOwnProperty.call(e,"producersConnected")&&t.uint32(16).uint32(e.producersConnected),null!=e.producersSeen&&Object.hasOwnProperty.call(e,"producersSeen")&&t.uint32(24).uint64(e.producersSeen),null!=e.dataSourcesRegistered&&Object.hasOwnProperty.call(e,"dataSourcesRegistered")&&t.uint32(32).uint32(e.dataSourcesRegistered),null!=e.dataSourcesSeen&&Object.hasOwnProperty.call(e,"dataSourcesSeen")&&t.uint32(40).uint64(e.dataSourcesSeen),null!=e.tracingSessions&&Object.hasOwnProperty.call(e,"tracingSessions")&&t.uint32(48).uint32(e.tracingSessions),null!=e.totalBuffers&&Object.hasOwnProperty.call(e,"totalBuffers")&&t.uint32(56).uint32(e.totalBuffers),null!=e.chunksDiscarded&&Object.hasOwnProperty.call(e,"chunksDiscarded")&&t.uint32(64).uint64(e.chunksDiscarded),null!=e.patchesDiscarded&&Object.hasOwnProperty.call(e,"patchesDiscarded")&&t.uint32(72).uint64(e.patchesDiscarded),null!=e.invalidPackets&&Object.hasOwnProperty.call(e,"invalidPackets")&&t.uint32(80).uint64(e.invalidPackets),null!=e.filterStats&&Object.hasOwnProperty.call(e,"filterStats")&&s.perfetto.protos.TraceStats.FilterStats.encode(e.filterStats,t.uint32(90).fork()).ldelim(),null!=e.flushesRequested&&Object.hasOwnProperty.call(e,"flushesRequested")&&t.uint32(96).uint64(e.flushesRequested),null!=e.flushesSucceeded&&Object.hasOwnProperty.call(e,"flushesSucceeded")&&t.uint32(104).uint64(e.flushesSucceeded),null!=e.flushesFailed&&Object.hasOwnProperty.call(e,"flushesFailed")&&t.uint32(112).uint64(e.flushesFailed),null!=e.finalFlushOutcome&&Object.hasOwnProperty.call(e,"finalFlushOutcome")&&t.uint32(120).int32(e.finalFlushOutcome),null!=e.chunkPayloadHistogramDef&&e.chunkPayloadHistogramDef.length)for(r=0;r<e.chunkPayloadHistogramDef.length;++r)t.uint32(136).int64(e.chunkPayloadHistogramDef[r]);if(null!=e.writerStats&&e.writerStats.length)for(r=0;r<e.writerStats.length;++r)s.perfetto.protos.TraceStats.WriterStats.encode(e.writerStats[r],t.uint32(146).fork()).ldelim();return t},g.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TraceStats;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.bufferStats&&n.bufferStats.length||(n.bufferStats=[]),n.bufferStats.push(s.perfetto.protos.TraceStats.BufferStats.decode(e,e.uint32()));break;case 17:if(n.chunkPayloadHistogramDef&&n.chunkPayloadHistogramDef.length||(n.chunkPayloadHistogramDef=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.chunkPayloadHistogramDef.push(e.int64());else n.chunkPayloadHistogramDef.push(e.int64());break;case 18:n.writerStats&&n.writerStats.length||(n.writerStats=[]),n.writerStats.push(s.perfetto.protos.TraceStats.WriterStats.decode(e,e.uint32()));break;case 2:n.producersConnected=e.uint32();break;case 3:n.producersSeen=e.uint64();break;case 4:n.dataSourcesRegistered=e.uint32();break;case 5:n.dataSourcesSeen=e.uint64();break;case 6:n.tracingSessions=e.uint32();break;case 7:n.totalBuffers=e.uint32();break;case 8:n.chunksDiscarded=e.uint64();break;case 9:n.patchesDiscarded=e.uint64();break;case 10:n.invalidPackets=e.uint64();break;case 11:n.filterStats=s.perfetto.protos.TraceStats.FilterStats.decode(e,e.uint32());break;case 12:n.flushesRequested=e.uint64();break;case 13:n.flushesSucceeded=e.uint64();break;case 14:n.flushesFailed=e.uint64();break;case 15:n.finalFlushOutcome=e.int32();break;default:e.skipType(7&a)}}return n},g.fromObject=function(e){if(e instanceof s.perfetto.protos.TraceStats)return e;var t=new s.perfetto.protos.TraceStats;if(e.bufferStats){if(!Array.isArray(e.bufferStats))throw TypeError(".perfetto.protos.TraceStats.bufferStats: array expected");t.bufferStats=[];for(var r=0;r<e.bufferStats.length;++r){if("object"!=typeof e.bufferStats[r])throw TypeError(".perfetto.protos.TraceStats.bufferStats: object expected");t.bufferStats[r]=s.perfetto.protos.TraceStats.BufferStats.fromObject(e.bufferStats[r])}}if(e.chunkPayloadHistogramDef){if(!Array.isArray(e.chunkPayloadHistogramDef))throw TypeError(".perfetto.protos.TraceStats.chunkPayloadHistogramDef: array expected");t.chunkPayloadHistogramDef=[];for(r=0;r<e.chunkPayloadHistogramDef.length;++r)i.Long?(t.chunkPayloadHistogramDef[r]=i.Long.fromValue(e.chunkPayloadHistogramDef[r])).unsigned=!1:"string"==typeof e.chunkPayloadHistogramDef[r]?t.chunkPayloadHistogramDef[r]=parseInt(e.chunkPayloadHistogramDef[r],10):"number"==typeof e.chunkPayloadHistogramDef[r]?t.chunkPayloadHistogramDef[r]=e.chunkPayloadHistogramDef[r]:"object"==typeof e.chunkPayloadHistogramDef[r]&&(t.chunkPayloadHistogramDef[r]=new i.LongBits(e.chunkPayloadHistogramDef[r].low>>>0,e.chunkPayloadHistogramDef[r].high>>>0).toNumber())}if(e.writerStats){if(!Array.isArray(e.writerStats))throw TypeError(".perfetto.protos.TraceStats.writerStats: array expected");t.writerStats=[];for(r=0;r<e.writerStats.length;++r){if("object"!=typeof e.writerStats[r])throw TypeError(".perfetto.protos.TraceStats.writerStats: object expected");t.writerStats[r]=s.perfetto.protos.TraceStats.WriterStats.fromObject(e.writerStats[r])}}if(null!=e.producersConnected&&(t.producersConnected=e.producersConnected>>>0),null!=e.producersSeen&&(i.Long?(t.producersSeen=i.Long.fromValue(e.producersSeen)).unsigned=!0:"string"==typeof e.producersSeen?t.producersSeen=parseInt(e.producersSeen,10):"number"==typeof e.producersSeen?t.producersSeen=e.producersSeen:"object"==typeof e.producersSeen&&(t.producersSeen=new i.LongBits(e.producersSeen.low>>>0,e.producersSeen.high>>>0).toNumber(!0))),null!=e.dataSourcesRegistered&&(t.dataSourcesRegistered=e.dataSourcesRegistered>>>0),null!=e.dataSourcesSeen&&(i.Long?(t.dataSourcesSeen=i.Long.fromValue(e.dataSourcesSeen)).unsigned=!0:"string"==typeof e.dataSourcesSeen?t.dataSourcesSeen=parseInt(e.dataSourcesSeen,10):"number"==typeof e.dataSourcesSeen?t.dataSourcesSeen=e.dataSourcesSeen:"object"==typeof e.dataSourcesSeen&&(t.dataSourcesSeen=new i.LongBits(e.dataSourcesSeen.low>>>0,e.dataSourcesSeen.high>>>0).toNumber(!0))),null!=e.tracingSessions&&(t.tracingSessions=e.tracingSessions>>>0),null!=e.totalBuffers&&(t.totalBuffers=e.totalBuffers>>>0),null!=e.chunksDiscarded&&(i.Long?(t.chunksDiscarded=i.Long.fromValue(e.chunksDiscarded)).unsigned=!0:"string"==typeof e.chunksDiscarded?t.chunksDiscarded=parseInt(e.chunksDiscarded,10):"number"==typeof e.chunksDiscarded?t.chunksDiscarded=e.chunksDiscarded:"object"==typeof e.chunksDiscarded&&(t.chunksDiscarded=new i.LongBits(e.chunksDiscarded.low>>>0,e.chunksDiscarded.high>>>0).toNumber(!0))),null!=e.patchesDiscarded&&(i.Long?(t.patchesDiscarded=i.Long.fromValue(e.patchesDiscarded)).unsigned=!0:"string"==typeof e.patchesDiscarded?t.patchesDiscarded=parseInt(e.patchesDiscarded,10):"number"==typeof e.patchesDiscarded?t.patchesDiscarded=e.patchesDiscarded:"object"==typeof e.patchesDiscarded&&(t.patchesDiscarded=new i.LongBits(e.patchesDiscarded.low>>>0,e.patchesDiscarded.high>>>0).toNumber(!0))),null!=e.invalidPackets&&(i.Long?(t.invalidPackets=i.Long.fromValue(e.invalidPackets)).unsigned=!0:"string"==typeof e.invalidPackets?t.invalidPackets=parseInt(e.invalidPackets,10):"number"==typeof e.invalidPackets?t.invalidPackets=e.invalidPackets:"object"==typeof e.invalidPackets&&(t.invalidPackets=new i.LongBits(e.invalidPackets.low>>>0,e.invalidPackets.high>>>0).toNumber(!0))),null!=e.filterStats){if("object"!=typeof e.filterStats)throw TypeError(".perfetto.protos.TraceStats.filterStats: object expected");t.filterStats=s.perfetto.protos.TraceStats.FilterStats.fromObject(e.filterStats)}switch(null!=e.flushesRequested&&(i.Long?(t.flushesRequested=i.Long.fromValue(e.flushesRequested)).unsigned=!0:"string"==typeof e.flushesRequested?t.flushesRequested=parseInt(e.flushesRequested,10):"number"==typeof e.flushesRequested?t.flushesRequested=e.flushesRequested:"object"==typeof e.flushesRequested&&(t.flushesRequested=new i.LongBits(e.flushesRequested.low>>>0,e.flushesRequested.high>>>0).toNumber(!0))),null!=e.flushesSucceeded&&(i.Long?(t.flushesSucceeded=i.Long.fromValue(e.flushesSucceeded)).unsigned=!0:"string"==typeof e.flushesSucceeded?t.flushesSucceeded=parseInt(e.flushesSucceeded,10):"number"==typeof e.flushesSucceeded?t.flushesSucceeded=e.flushesSucceeded:"object"==typeof e.flushesSucceeded&&(t.flushesSucceeded=new i.LongBits(e.flushesSucceeded.low>>>0,e.flushesSucceeded.high>>>0).toNumber(!0))),null!=e.flushesFailed&&(i.Long?(t.flushesFailed=i.Long.fromValue(e.flushesFailed)).unsigned=!0:"string"==typeof e.flushesFailed?t.flushesFailed=parseInt(e.flushesFailed,10):"number"==typeof e.flushesFailed?t.flushesFailed=e.flushesFailed:"object"==typeof e.flushesFailed&&(t.flushesFailed=new i.LongBits(e.flushesFailed.low>>>0,e.flushesFailed.high>>>0).toNumber(!0))),e.finalFlushOutcome){default:"number"==typeof e.finalFlushOutcome&&(t.finalFlushOutcome=e.finalFlushOutcome);break;case"FINAL_FLUSH_UNSPECIFIED":case 0:t.finalFlushOutcome=0;break;case"FINAL_FLUSH_SUCCEEDED":case 1:t.finalFlushOutcome=1;break;case"FINAL_FLUSH_FAILED":case 2:t.finalFlushOutcome=2}return t},g.toObject=function(e,t){var r,n={};if(((t=t||{}).arrays||t.defaults)&&(n.bufferStats=[],n.chunkPayloadHistogramDef=[],n.writerStats=[]),t.defaults&&(n.producersConnected=0,i.Long?(r=new i.Long(0,0,!0),n.producersSeen=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.producersSeen=t.longs===String?"0":0,n.dataSourcesRegistered=0,i.Long?(r=new i.Long(0,0,!0),n.dataSourcesSeen=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.dataSourcesSeen=t.longs===String?"0":0,n.tracingSessions=0,n.totalBuffers=0,i.Long?(r=new i.Long(0,0,!0),n.chunksDiscarded=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.chunksDiscarded=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.patchesDiscarded=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.patchesDiscarded=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.invalidPackets=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.invalidPackets=t.longs===String?"0":0,n.filterStats=null,i.Long?(r=new i.Long(0,0,!0),n.flushesRequested=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.flushesRequested=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.flushesSucceeded=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.flushesSucceeded=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.flushesFailed=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.flushesFailed=t.longs===String?"0":0,n.finalFlushOutcome=t.enums===String?"FINAL_FLUSH_UNSPECIFIED":0),e.bufferStats&&e.bufferStats.length){n.bufferStats=[];for(var a=0;a<e.bufferStats.length;++a)n.bufferStats[a]=s.perfetto.protos.TraceStats.BufferStats.toObject(e.bufferStats[a],t)}if(null!=e.producersConnected&&e.hasOwnProperty("producersConnected")&&(n.producersConnected=e.producersConnected),null!=e.producersSeen&&e.hasOwnProperty("producersSeen")&&("number"==typeof e.producersSeen?n.producersSeen=t.longs===String?String(e.producersSeen):e.producersSeen:n.producersSeen=t.longs===String?i.Long.prototype.toString.call(e.producersSeen):t.longs===Number?new i.LongBits(e.producersSeen.low>>>0,e.producersSeen.high>>>0).toNumber(!0):e.producersSeen),null!=e.dataSourcesRegistered&&e.hasOwnProperty("dataSourcesRegistered")&&(n.dataSourcesRegistered=e.dataSourcesRegistered),null!=e.dataSourcesSeen&&e.hasOwnProperty("dataSourcesSeen")&&("number"==typeof e.dataSourcesSeen?n.dataSourcesSeen=t.longs===String?String(e.dataSourcesSeen):e.dataSourcesSeen:n.dataSourcesSeen=t.longs===String?i.Long.prototype.toString.call(e.dataSourcesSeen):t.longs===Number?new i.LongBits(e.dataSourcesSeen.low>>>0,e.dataSourcesSeen.high>>>0).toNumber(!0):e.dataSourcesSeen),null!=e.tracingSessions&&e.hasOwnProperty("tracingSessions")&&(n.tracingSessions=e.tracingSessions),null!=e.totalBuffers&&e.hasOwnProperty("totalBuffers")&&(n.totalBuffers=e.totalBuffers),null!=e.chunksDiscarded&&e.hasOwnProperty("chunksDiscarded")&&("number"==typeof e.chunksDiscarded?n.chunksDiscarded=t.longs===String?String(e.chunksDiscarded):e.chunksDiscarded:n.chunksDiscarded=t.longs===String?i.Long.prototype.toString.call(e.chunksDiscarded):t.longs===Number?new i.LongBits(e.chunksDiscarded.low>>>0,e.chunksDiscarded.high>>>0).toNumber(!0):e.chunksDiscarded),null!=e.patchesDiscarded&&e.hasOwnProperty("patchesDiscarded")&&("number"==typeof e.patchesDiscarded?n.patchesDiscarded=t.longs===String?String(e.patchesDiscarded):e.patchesDiscarded:n.patchesDiscarded=t.longs===String?i.Long.prototype.toString.call(e.patchesDiscarded):t.longs===Number?new i.LongBits(e.patchesDiscarded.low>>>0,e.patchesDiscarded.high>>>0).toNumber(!0):e.patchesDiscarded),null!=e.invalidPackets&&e.hasOwnProperty("invalidPackets")&&("number"==typeof e.invalidPackets?n.invalidPackets=t.longs===String?String(e.invalidPackets):e.invalidPackets:n.invalidPackets=t.longs===String?i.Long.prototype.toString.call(e.invalidPackets):t.longs===Number?new i.LongBits(e.invalidPackets.low>>>0,e.invalidPackets.high>>>0).toNumber(!0):e.invalidPackets),null!=e.filterStats&&e.hasOwnProperty("filterStats")&&(n.filterStats=s.perfetto.protos.TraceStats.FilterStats.toObject(e.filterStats,t)),null!=e.flushesRequested&&e.hasOwnProperty("flushesRequested")&&("number"==typeof e.flushesRequested?n.flushesRequested=t.longs===String?String(e.flushesRequested):e.flushesRequested:n.flushesRequested=t.longs===String?i.Long.prototype.toString.call(e.flushesRequested):t.longs===Number?new i.LongBits(e.flushesRequested.low>>>0,e.flushesRequested.high>>>0).toNumber(!0):e.flushesRequested),null!=e.flushesSucceeded&&e.hasOwnProperty("flushesSucceeded")&&("number"==typeof e.flushesSucceeded?n.flushesSucceeded=t.longs===String?String(e.flushesSucceeded):e.flushesSucceeded:n.flushesSucceeded=t.longs===String?i.Long.prototype.toString.call(e.flushesSucceeded):t.longs===Number?new i.LongBits(e.flushesSucceeded.low>>>0,e.flushesSucceeded.high>>>0).toNumber(!0):e.flushesSucceeded),null!=e.flushesFailed&&e.hasOwnProperty("flushesFailed")&&("number"==typeof e.flushesFailed?n.flushesFailed=t.longs===String?String(e.flushesFailed):e.flushesFailed:n.flushesFailed=t.longs===String?i.Long.prototype.toString.call(e.flushesFailed):t.longs===Number?new i.LongBits(e.flushesFailed.low>>>0,e.flushesFailed.high>>>0).toNumber(!0):e.flushesFailed),null!=e.finalFlushOutcome&&e.hasOwnProperty("finalFlushOutcome")&&(n.finalFlushOutcome=t.enums!==String||void 0===s.perfetto.protos.TraceStats.FinalFlushOutcome[e.finalFlushOutcome]?e.finalFlushOutcome:s.perfetto.protos.TraceStats.FinalFlushOutcome[e.finalFlushOutcome]),e.chunkPayloadHistogramDef&&e.chunkPayloadHistogramDef.length){n.chunkPayloadHistogramDef=[];for(a=0;a<e.chunkPayloadHistogramDef.length;++a)"number"==typeof e.chunkPayloadHistogramDef[a]?n.chunkPayloadHistogramDef[a]=t.longs===String?String(e.chunkPayloadHistogramDef[a]):e.chunkPayloadHistogramDef[a]:n.chunkPayloadHistogramDef[a]=t.longs===String?i.Long.prototype.toString.call(e.chunkPayloadHistogramDef[a]):t.longs===Number?new i.LongBits(e.chunkPayloadHistogramDef[a].low>>>0,e.chunkPayloadHistogramDef[a].high>>>0).toNumber():e.chunkPayloadHistogramDef[a]}if(e.writerStats&&e.writerStats.length){n.writerStats=[];for(a=0;a<e.writerStats.length;++a)n.writerStats[a]=s.perfetto.protos.TraceStats.WriterStats.toObject(e.writerStats[a],t)}return n},g.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},g.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TraceStats"},g.BufferStats=(m.prototype.bufferSize=i.Long?i.Long.fromBits(0,0,!0):0,m.prototype.bytesWritten=i.Long?i.Long.fromBits(0,0,!0):0,m.prototype.bytesOverwritten=i.Long?i.Long.fromBits(0,0,!0):0,m.prototype.bytesRead=i.Long?i.Long.fromBits(0,0,!0):0,m.prototype.paddingBytesWritten=i.Long?i.Long.fromBits(0,0,!0):0,m.prototype.paddingBytesCleared=i.Long?i.Long.fromBits(0,0,!0):0,m.prototype.chunksWritten=i.Long?i.Long.fromBits(0,0,!0):0,m.prototype.chunksRewritten=i.Long?i.Long.fromBits(0,0,!0):0,m.prototype.chunksOverwritten=i.Long?i.Long.fromBits(0,0,!0):0,m.prototype.chunksDiscarded=i.Long?i.Long.fromBits(0,0,!0):0,m.prototype.chunksRead=i.Long?i.Long.fromBits(0,0,!0):0,m.prototype.chunksCommittedOutOfOrder=i.Long?i.Long.fromBits(0,0,!0):0,m.prototype.writeWrapCount=i.Long?i.Long.fromBits(0,0,!0):0,m.prototype.patchesSucceeded=i.Long?i.Long.fromBits(0,0,!0):0,m.prototype.patchesFailed=i.Long?i.Long.fromBits(0,0,!0):0,m.prototype.readaheadsSucceeded=i.Long?i.Long.fromBits(0,0,!0):0,m.prototype.readaheadsFailed=i.Long?i.Long.fromBits(0,0,!0):0,m.prototype.abiViolations=i.Long?i.Long.fromBits(0,0,!0):0,m.prototype.traceWriterPacketLoss=i.Long?i.Long.fromBits(0,0,!0):0,m.create=function(e){return new m(e)},m.encode=function(e,t){return t=t||a.create(),null!=e.bytesWritten&&Object.hasOwnProperty.call(e,"bytesWritten")&&t.uint32(8).uint64(e.bytesWritten),null!=e.chunksWritten&&Object.hasOwnProperty.call(e,"chunksWritten")&&t.uint32(16).uint64(e.chunksWritten),null!=e.chunksOverwritten&&Object.hasOwnProperty.call(e,"chunksOverwritten")&&t.uint32(24).uint64(e.chunksOverwritten),null!=e.writeWrapCount&&Object.hasOwnProperty.call(e,"writeWrapCount")&&t.uint32(32).uint64(e.writeWrapCount),null!=e.patchesSucceeded&&Object.hasOwnProperty.call(e,"patchesSucceeded")&&t.uint32(40).uint64(e.patchesSucceeded),null!=e.patchesFailed&&Object.hasOwnProperty.call(e,"patchesFailed")&&t.uint32(48).uint64(e.patchesFailed),null!=e.readaheadsSucceeded&&Object.hasOwnProperty.call(e,"readaheadsSucceeded")&&t.uint32(56).uint64(e.readaheadsSucceeded),null!=e.readaheadsFailed&&Object.hasOwnProperty.call(e,"readaheadsFailed")&&t.uint32(64).uint64(e.readaheadsFailed),null!=e.abiViolations&&Object.hasOwnProperty.call(e,"abiViolations")&&t.uint32(72).uint64(e.abiViolations),null!=e.chunksRewritten&&Object.hasOwnProperty.call(e,"chunksRewritten")&&t.uint32(80).uint64(e.chunksRewritten),null!=e.chunksCommittedOutOfOrder&&Object.hasOwnProperty.call(e,"chunksCommittedOutOfOrder")&&t.uint32(88).uint64(e.chunksCommittedOutOfOrder),null!=e.bufferSize&&Object.hasOwnProperty.call(e,"bufferSize")&&t.uint32(96).uint64(e.bufferSize),null!=e.bytesOverwritten&&Object.hasOwnProperty.call(e,"bytesOverwritten")&&t.uint32(104).uint64(e.bytesOverwritten),null!=e.bytesRead&&Object.hasOwnProperty.call(e,"bytesRead")&&t.uint32(112).uint64(e.bytesRead),null!=e.paddingBytesWritten&&Object.hasOwnProperty.call(e,"paddingBytesWritten")&&t.uint32(120).uint64(e.paddingBytesWritten),null!=e.paddingBytesCleared&&Object.hasOwnProperty.call(e,"paddingBytesCleared")&&t.uint32(128).uint64(e.paddingBytesCleared),null!=e.chunksRead&&Object.hasOwnProperty.call(e,"chunksRead")&&t.uint32(136).uint64(e.chunksRead),null!=e.chunksDiscarded&&Object.hasOwnProperty.call(e,"chunksDiscarded")&&t.uint32(144).uint64(e.chunksDiscarded),null!=e.traceWriterPacketLoss&&Object.hasOwnProperty.call(e,"traceWriterPacketLoss")&&t.uint32(152).uint64(e.traceWriterPacketLoss),t},m.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TraceStats.BufferStats;e.pos<r;){var a=e.uint32();switch(a>>>3){case 12:n.bufferSize=e.uint64();break;case 1:n.bytesWritten=e.uint64();break;case 13:n.bytesOverwritten=e.uint64();break;case 14:n.bytesRead=e.uint64();break;case 15:n.paddingBytesWritten=e.uint64();break;case 16:n.paddingBytesCleared=e.uint64();break;case 2:n.chunksWritten=e.uint64();break;case 10:n.chunksRewritten=e.uint64();break;case 3:n.chunksOverwritten=e.uint64();break;case 18:n.chunksDiscarded=e.uint64();break;case 17:n.chunksRead=e.uint64();break;case 11:n.chunksCommittedOutOfOrder=e.uint64();break;case 4:n.writeWrapCount=e.uint64();break;case 5:n.patchesSucceeded=e.uint64();break;case 6:n.patchesFailed=e.uint64();break;case 7:n.readaheadsSucceeded=e.uint64();break;case 8:n.readaheadsFailed=e.uint64();break;case 9:n.abiViolations=e.uint64();break;case 19:n.traceWriterPacketLoss=e.uint64();break;default:e.skipType(7&a)}}return n},m.fromObject=function(e){var t;return e instanceof s.perfetto.protos.TraceStats.BufferStats?e:(t=new s.perfetto.protos.TraceStats.BufferStats,null!=e.bufferSize&&(i.Long?(t.bufferSize=i.Long.fromValue(e.bufferSize)).unsigned=!0:"string"==typeof e.bufferSize?t.bufferSize=parseInt(e.bufferSize,10):"number"==typeof e.bufferSize?t.bufferSize=e.bufferSize:"object"==typeof e.bufferSize&&(t.bufferSize=new i.LongBits(e.bufferSize.low>>>0,e.bufferSize.high>>>0).toNumber(!0))),null!=e.bytesWritten&&(i.Long?(t.bytesWritten=i.Long.fromValue(e.bytesWritten)).unsigned=!0:"string"==typeof e.bytesWritten?t.bytesWritten=parseInt(e.bytesWritten,10):"number"==typeof e.bytesWritten?t.bytesWritten=e.bytesWritten:"object"==typeof e.bytesWritten&&(t.bytesWritten=new i.LongBits(e.bytesWritten.low>>>0,e.bytesWritten.high>>>0).toNumber(!0))),null!=e.bytesOverwritten&&(i.Long?(t.bytesOverwritten=i.Long.fromValue(e.bytesOverwritten)).unsigned=!0:"string"==typeof e.bytesOverwritten?t.bytesOverwritten=parseInt(e.bytesOverwritten,10):"number"==typeof e.bytesOverwritten?t.bytesOverwritten=e.bytesOverwritten:"object"==typeof e.bytesOverwritten&&(t.bytesOverwritten=new i.LongBits(e.bytesOverwritten.low>>>0,e.bytesOverwritten.high>>>0).toNumber(!0))),null!=e.bytesRead&&(i.Long?(t.bytesRead=i.Long.fromValue(e.bytesRead)).unsigned=!0:"string"==typeof e.bytesRead?t.bytesRead=parseInt(e.bytesRead,10):"number"==typeof e.bytesRead?t.bytesRead=e.bytesRead:"object"==typeof e.bytesRead&&(t.bytesRead=new i.LongBits(e.bytesRead.low>>>0,e.bytesRead.high>>>0).toNumber(!0))),null!=e.paddingBytesWritten&&(i.Long?(t.paddingBytesWritten=i.Long.fromValue(e.paddingBytesWritten)).unsigned=!0:"string"==typeof e.paddingBytesWritten?t.paddingBytesWritten=parseInt(e.paddingBytesWritten,10):"number"==typeof e.paddingBytesWritten?t.paddingBytesWritten=e.paddingBytesWritten:"object"==typeof e.paddingBytesWritten&&(t.paddingBytesWritten=new i.LongBits(e.paddingBytesWritten.low>>>0,e.paddingBytesWritten.high>>>0).toNumber(!0))),null!=e.paddingBytesCleared&&(i.Long?(t.paddingBytesCleared=i.Long.fromValue(e.paddingBytesCleared)).unsigned=!0:"string"==typeof e.paddingBytesCleared?t.paddingBytesCleared=parseInt(e.paddingBytesCleared,10):"number"==typeof e.paddingBytesCleared?t.paddingBytesCleared=e.paddingBytesCleared:"object"==typeof e.paddingBytesCleared&&(t.paddingBytesCleared=new i.LongBits(e.paddingBytesCleared.low>>>0,e.paddingBytesCleared.high>>>0).toNumber(!0))),null!=e.chunksWritten&&(i.Long?(t.chunksWritten=i.Long.fromValue(e.chunksWritten)).unsigned=!0:"string"==typeof e.chunksWritten?t.chunksWritten=parseInt(e.chunksWritten,10):"number"==typeof e.chunksWritten?t.chunksWritten=e.chunksWritten:"object"==typeof e.chunksWritten&&(t.chunksWritten=new i.LongBits(e.chunksWritten.low>>>0,e.chunksWritten.high>>>0).toNumber(!0))),null!=e.chunksRewritten&&(i.Long?(t.chunksRewritten=i.Long.fromValue(e.chunksRewritten)).unsigned=!0:"string"==typeof e.chunksRewritten?t.chunksRewritten=parseInt(e.chunksRewritten,10):"number"==typeof e.chunksRewritten?t.chunksRewritten=e.chunksRewritten:"object"==typeof e.chunksRewritten&&(t.chunksRewritten=new i.LongBits(e.chunksRewritten.low>>>0,e.chunksRewritten.high>>>0).toNumber(!0))),null!=e.chunksOverwritten&&(i.Long?(t.chunksOverwritten=i.Long.fromValue(e.chunksOverwritten)).unsigned=!0:"string"==typeof e.chunksOverwritten?t.chunksOverwritten=parseInt(e.chunksOverwritten,10):"number"==typeof e.chunksOverwritten?t.chunksOverwritten=e.chunksOverwritten:"object"==typeof e.chunksOverwritten&&(t.chunksOverwritten=new i.LongBits(e.chunksOverwritten.low>>>0,e.chunksOverwritten.high>>>0).toNumber(!0))),null!=e.chunksDiscarded&&(i.Long?(t.chunksDiscarded=i.Long.fromValue(e.chunksDiscarded)).unsigned=!0:"string"==typeof e.chunksDiscarded?t.chunksDiscarded=parseInt(e.chunksDiscarded,10):"number"==typeof e.chunksDiscarded?t.chunksDiscarded=e.chunksDiscarded:"object"==typeof e.chunksDiscarded&&(t.chunksDiscarded=new i.LongBits(e.chunksDiscarded.low>>>0,e.chunksDiscarded.high>>>0).toNumber(!0))),null!=e.chunksRead&&(i.Long?(t.chunksRead=i.Long.fromValue(e.chunksRead)).unsigned=!0:"string"==typeof e.chunksRead?t.chunksRead=parseInt(e.chunksRead,10):"number"==typeof e.chunksRead?t.chunksRead=e.chunksRead:"object"==typeof e.chunksRead&&(t.chunksRead=new i.LongBits(e.chunksRead.low>>>0,e.chunksRead.high>>>0).toNumber(!0))),null!=e.chunksCommittedOutOfOrder&&(i.Long?(t.chunksCommittedOutOfOrder=i.Long.fromValue(e.chunksCommittedOutOfOrder)).unsigned=!0:"string"==typeof e.chunksCommittedOutOfOrder?t.chunksCommittedOutOfOrder=parseInt(e.chunksCommittedOutOfOrder,10):"number"==typeof e.chunksCommittedOutOfOrder?t.chunksCommittedOutOfOrder=e.chunksCommittedOutOfOrder:"object"==typeof e.chunksCommittedOutOfOrder&&(t.chunksCommittedOutOfOrder=new i.LongBits(e.chunksCommittedOutOfOrder.low>>>0,e.chunksCommittedOutOfOrder.high>>>0).toNumber(!0))),null!=e.writeWrapCount&&(i.Long?(t.writeWrapCount=i.Long.fromValue(e.writeWrapCount)).unsigned=!0:"string"==typeof e.writeWrapCount?t.writeWrapCount=parseInt(e.writeWrapCount,10):"number"==typeof e.writeWrapCount?t.writeWrapCount=e.writeWrapCount:"object"==typeof e.writeWrapCount&&(t.writeWrapCount=new i.LongBits(e.writeWrapCount.low>>>0,e.writeWrapCount.high>>>0).toNumber(!0))),null!=e.patchesSucceeded&&(i.Long?(t.patchesSucceeded=i.Long.fromValue(e.patchesSucceeded)).unsigned=!0:"string"==typeof e.patchesSucceeded?t.patchesSucceeded=parseInt(e.patchesSucceeded,10):"number"==typeof e.patchesSucceeded?t.patchesSucceeded=e.patchesSucceeded:"object"==typeof e.patchesSucceeded&&(t.patchesSucceeded=new i.LongBits(e.patchesSucceeded.low>>>0,e.patchesSucceeded.high>>>0).toNumber(!0))),null!=e.patchesFailed&&(i.Long?(t.patchesFailed=i.Long.fromValue(e.patchesFailed)).unsigned=!0:"string"==typeof e.patchesFailed?t.patchesFailed=parseInt(e.patchesFailed,10):"number"==typeof e.patchesFailed?t.patchesFailed=e.patchesFailed:"object"==typeof e.patchesFailed&&(t.patchesFailed=new i.LongBits(e.patchesFailed.low>>>0,e.patchesFailed.high>>>0).toNumber(!0))),null!=e.readaheadsSucceeded&&(i.Long?(t.readaheadsSucceeded=i.Long.fromValue(e.readaheadsSucceeded)).unsigned=!0:"string"==typeof e.readaheadsSucceeded?t.readaheadsSucceeded=parseInt(e.readaheadsSucceeded,10):"number"==typeof e.readaheadsSucceeded?t.readaheadsSucceeded=e.readaheadsSucceeded:"object"==typeof e.readaheadsSucceeded&&(t.readaheadsSucceeded=new i.LongBits(e.readaheadsSucceeded.low>>>0,e.readaheadsSucceeded.high>>>0).toNumber(!0))),null!=e.readaheadsFailed&&(i.Long?(t.readaheadsFailed=i.Long.fromValue(e.readaheadsFailed)).unsigned=!0:"string"==typeof e.readaheadsFailed?t.readaheadsFailed=parseInt(e.readaheadsFailed,10):"number"==typeof e.readaheadsFailed?t.readaheadsFailed=e.readaheadsFailed:"object"==typeof e.readaheadsFailed&&(t.readaheadsFailed=new i.LongBits(e.readaheadsFailed.low>>>0,e.readaheadsFailed.high>>>0).toNumber(!0))),null!=e.abiViolations&&(i.Long?(t.abiViolations=i.Long.fromValue(e.abiViolations)).unsigned=!0:"string"==typeof e.abiViolations?t.abiViolations=parseInt(e.abiViolations,10):"number"==typeof e.abiViolations?t.abiViolations=e.abiViolations:"object"==typeof e.abiViolations&&(t.abiViolations=new i.LongBits(e.abiViolations.low>>>0,e.abiViolations.high>>>0).toNumber(!0))),null!=e.traceWriterPacketLoss&&(i.Long?(t.traceWriterPacketLoss=i.Long.fromValue(e.traceWriterPacketLoss)).unsigned=!0:"string"==typeof e.traceWriterPacketLoss?t.traceWriterPacketLoss=parseInt(e.traceWriterPacketLoss,10):"number"==typeof e.traceWriterPacketLoss?t.traceWriterPacketLoss=e.traceWriterPacketLoss:"object"==typeof e.traceWriterPacketLoss&&(t.traceWriterPacketLoss=new i.LongBits(e.traceWriterPacketLoss.low>>>0,e.traceWriterPacketLoss.high>>>0).toNumber(!0))),t)},m.toObject=function(e,t){var r,n={};return(t=t||{}).defaults&&(i.Long?(r=new i.Long(0,0,!0),n.bytesWritten=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.bytesWritten=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.chunksWritten=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.chunksWritten=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.chunksOverwritten=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.chunksOverwritten=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.writeWrapCount=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.writeWrapCount=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.patchesSucceeded=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.patchesSucceeded=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.patchesFailed=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.patchesFailed=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.readaheadsSucceeded=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.readaheadsSucceeded=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.readaheadsFailed=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.readaheadsFailed=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.abiViolations=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.abiViolations=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.chunksRewritten=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.chunksRewritten=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.chunksCommittedOutOfOrder=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.chunksCommittedOutOfOrder=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.bufferSize=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.bufferSize=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.bytesOverwritten=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.bytesOverwritten=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.bytesRead=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.bytesRead=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.paddingBytesWritten=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.paddingBytesWritten=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.paddingBytesCleared=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.paddingBytesCleared=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.chunksRead=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.chunksRead=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.chunksDiscarded=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.chunksDiscarded=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.traceWriterPacketLoss=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.traceWriterPacketLoss=t.longs===String?"0":0),null!=e.bytesWritten&&e.hasOwnProperty("bytesWritten")&&("number"==typeof e.bytesWritten?n.bytesWritten=t.longs===String?String(e.bytesWritten):e.bytesWritten:n.bytesWritten=t.longs===String?i.Long.prototype.toString.call(e.bytesWritten):t.longs===Number?new i.LongBits(e.bytesWritten.low>>>0,e.bytesWritten.high>>>0).toNumber(!0):e.bytesWritten),null!=e.chunksWritten&&e.hasOwnProperty("chunksWritten")&&("number"==typeof e.chunksWritten?n.chunksWritten=t.longs===String?String(e.chunksWritten):e.chunksWritten:n.chunksWritten=t.longs===String?i.Long.prototype.toString.call(e.chunksWritten):t.longs===Number?new i.LongBits(e.chunksWritten.low>>>0,e.chunksWritten.high>>>0).toNumber(!0):e.chunksWritten),null!=e.chunksOverwritten&&e.hasOwnProperty("chunksOverwritten")&&("number"==typeof e.chunksOverwritten?n.chunksOverwritten=t.longs===String?String(e.chunksOverwritten):e.chunksOverwritten:n.chunksOverwritten=t.longs===String?i.Long.prototype.toString.call(e.chunksOverwritten):t.longs===Number?new i.LongBits(e.chunksOverwritten.low>>>0,e.chunksOverwritten.high>>>0).toNumber(!0):e.chunksOverwritten),null!=e.writeWrapCount&&e.hasOwnProperty("writeWrapCount")&&("number"==typeof e.writeWrapCount?n.writeWrapCount=t.longs===String?String(e.writeWrapCount):e.writeWrapCount:n.writeWrapCount=t.longs===String?i.Long.prototype.toString.call(e.writeWrapCount):t.longs===Number?new i.LongBits(e.writeWrapCount.low>>>0,e.writeWrapCount.high>>>0).toNumber(!0):e.writeWrapCount),null!=e.patchesSucceeded&&e.hasOwnProperty("patchesSucceeded")&&("number"==typeof e.patchesSucceeded?n.patchesSucceeded=t.longs===String?String(e.patchesSucceeded):e.patchesSucceeded:n.patchesSucceeded=t.longs===String?i.Long.prototype.toString.call(e.patchesSucceeded):t.longs===Number?new i.LongBits(e.patchesSucceeded.low>>>0,e.patchesSucceeded.high>>>0).toNumber(!0):e.patchesSucceeded),null!=e.patchesFailed&&e.hasOwnProperty("patchesFailed")&&("number"==typeof e.patchesFailed?n.patchesFailed=t.longs===String?String(e.patchesFailed):e.patchesFailed:n.patchesFailed=t.longs===String?i.Long.prototype.toString.call(e.patchesFailed):t.longs===Number?new i.LongBits(e.patchesFailed.low>>>0,e.patchesFailed.high>>>0).toNumber(!0):e.patchesFailed),null!=e.readaheadsSucceeded&&e.hasOwnProperty("readaheadsSucceeded")&&("number"==typeof e.readaheadsSucceeded?n.readaheadsSucceeded=t.longs===String?String(e.readaheadsSucceeded):e.readaheadsSucceeded:n.readaheadsSucceeded=t.longs===String?i.Long.prototype.toString.call(e.readaheadsSucceeded):t.longs===Number?new i.LongBits(e.readaheadsSucceeded.low>>>0,e.readaheadsSucceeded.high>>>0).toNumber(!0):e.readaheadsSucceeded),null!=e.readaheadsFailed&&e.hasOwnProperty("readaheadsFailed")&&("number"==typeof e.readaheadsFailed?n.readaheadsFailed=t.longs===String?String(e.readaheadsFailed):e.readaheadsFailed:n.readaheadsFailed=t.longs===String?i.Long.prototype.toString.call(e.readaheadsFailed):t.longs===Number?new i.LongBits(e.readaheadsFailed.low>>>0,e.readaheadsFailed.high>>>0).toNumber(!0):e.readaheadsFailed),null!=e.abiViolations&&e.hasOwnProperty("abiViolations")&&("number"==typeof e.abiViolations?n.abiViolations=t.longs===String?String(e.abiViolations):e.abiViolations:n.abiViolations=t.longs===String?i.Long.prototype.toString.call(e.abiViolations):t.longs===Number?new i.LongBits(e.abiViolations.low>>>0,e.abiViolations.high>>>0).toNumber(!0):e.abiViolations),null!=e.chunksRewritten&&e.hasOwnProperty("chunksRewritten")&&("number"==typeof e.chunksRewritten?n.chunksRewritten=t.longs===String?String(e.chunksRewritten):e.chunksRewritten:n.chunksRewritten=t.longs===String?i.Long.prototype.toString.call(e.chunksRewritten):t.longs===Number?new i.LongBits(e.chunksRewritten.low>>>0,e.chunksRewritten.high>>>0).toNumber(!0):e.chunksRewritten),null!=e.chunksCommittedOutOfOrder&&e.hasOwnProperty("chunksCommittedOutOfOrder")&&("number"==typeof e.chunksCommittedOutOfOrder?n.chunksCommittedOutOfOrder=t.longs===String?String(e.chunksCommittedOutOfOrder):e.chunksCommittedOutOfOrder:n.chunksCommittedOutOfOrder=t.longs===String?i.Long.prototype.toString.call(e.chunksCommittedOutOfOrder):t.longs===Number?new i.LongBits(e.chunksCommittedOutOfOrder.low>>>0,e.chunksCommittedOutOfOrder.high>>>0).toNumber(!0):e.chunksCommittedOutOfOrder),null!=e.bufferSize&&e.hasOwnProperty("bufferSize")&&("number"==typeof e.bufferSize?n.bufferSize=t.longs===String?String(e.bufferSize):e.bufferSize:n.bufferSize=t.longs===String?i.Long.prototype.toString.call(e.bufferSize):t.longs===Number?new i.LongBits(e.bufferSize.low>>>0,e.bufferSize.high>>>0).toNumber(!0):e.bufferSize),null!=e.bytesOverwritten&&e.hasOwnProperty("bytesOverwritten")&&("number"==typeof e.bytesOverwritten?n.bytesOverwritten=t.longs===String?String(e.bytesOverwritten):e.bytesOverwritten:n.bytesOverwritten=t.longs===String?i.Long.prototype.toString.call(e.bytesOverwritten):t.longs===Number?new i.LongBits(e.bytesOverwritten.low>>>0,e.bytesOverwritten.high>>>0).toNumber(!0):e.bytesOverwritten),null!=e.bytesRead&&e.hasOwnProperty("bytesRead")&&("number"==typeof e.bytesRead?n.bytesRead=t.longs===String?String(e.bytesRead):e.bytesRead:n.bytesRead=t.longs===String?i.Long.prototype.toString.call(e.bytesRead):t.longs===Number?new i.LongBits(e.bytesRead.low>>>0,e.bytesRead.high>>>0).toNumber(!0):e.bytesRead),null!=e.paddingBytesWritten&&e.hasOwnProperty("paddingBytesWritten")&&("number"==typeof e.paddingBytesWritten?n.paddingBytesWritten=t.longs===String?String(e.paddingBytesWritten):e.paddingBytesWritten:n.paddingBytesWritten=t.longs===String?i.Long.prototype.toString.call(e.paddingBytesWritten):t.longs===Number?new i.LongBits(e.paddingBytesWritten.low>>>0,e.paddingBytesWritten.high>>>0).toNumber(!0):e.paddingBytesWritten),null!=e.paddingBytesCleared&&e.hasOwnProperty("paddingBytesCleared")&&("number"==typeof e.paddingBytesCleared?n.paddingBytesCleared=t.longs===String?String(e.paddingBytesCleared):e.paddingBytesCleared:n.paddingBytesCleared=t.longs===String?i.Long.prototype.toString.call(e.paddingBytesCleared):t.longs===Number?new i.LongBits(e.paddingBytesCleared.low>>>0,e.paddingBytesCleared.high>>>0).toNumber(!0):e.paddingBytesCleared),null!=e.chunksRead&&e.hasOwnProperty("chunksRead")&&("number"==typeof e.chunksRead?n.chunksRead=t.longs===String?String(e.chunksRead):e.chunksRead:n.chunksRead=t.longs===String?i.Long.prototype.toString.call(e.chunksRead):t.longs===Number?new i.LongBits(e.chunksRead.low>>>0,e.chunksRead.high>>>0).toNumber(!0):e.chunksRead),null!=e.chunksDiscarded&&e.hasOwnProperty("chunksDiscarded")&&("number"==typeof e.chunksDiscarded?n.chunksDiscarded=t.longs===String?String(e.chunksDiscarded):e.chunksDiscarded:n.chunksDiscarded=t.longs===String?i.Long.prototype.toString.call(e.chunksDiscarded):t.longs===Number?new i.LongBits(e.chunksDiscarded.low>>>0,e.chunksDiscarded.high>>>0).toNumber(!0):e.chunksDiscarded),null!=e.traceWriterPacketLoss&&e.hasOwnProperty("traceWriterPacketLoss")&&("number"==typeof e.traceWriterPacketLoss?n.traceWriterPacketLoss=t.longs===String?String(e.traceWriterPacketLoss):e.traceWriterPacketLoss:n.traceWriterPacketLoss=t.longs===String?i.Long.prototype.toString.call(e.traceWriterPacketLoss):t.longs===Number?new i.LongBits(e.traceWriterPacketLoss.low>>>0,e.traceWriterPacketLoss.high>>>0).toNumber(!0):e.traceWriterPacketLoss),n},m.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},m.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TraceStats.BufferStats"},m),g.WriterStats=(Oe.prototype.sequenceId=i.Long?i.Long.fromBits(0,0,!0):0,Oe.prototype.buffer=0,Oe.prototype.chunkPayloadHistogramCounts=i.emptyArray,Oe.prototype.chunkPayloadHistogramSum=i.emptyArray,Oe.create=function(e){return new Oe(e)},Oe.encode=function(e,t){if(t=t||a.create(),null!=e.sequenceId&&Object.hasOwnProperty.call(e,"sequenceId")&&t.uint32(8).uint64(e.sequenceId),null!=e.chunkPayloadHistogramCounts&&e.chunkPayloadHistogramCounts.length){t.uint32(18).fork();for(var r=0;r<e.chunkPayloadHistogramCounts.length;++r)t.uint64(e.chunkPayloadHistogramCounts[r]);t.ldelim()}if(null!=e.chunkPayloadHistogramSum&&e.chunkPayloadHistogramSum.length){t.uint32(26).fork();for(r=0;r<e.chunkPayloadHistogramSum.length;++r)t.int64(e.chunkPayloadHistogramSum[r]);t.ldelim()}return null!=e.buffer&&Object.hasOwnProperty.call(e,"buffer")&&t.uint32(32).uint32(e.buffer),t},Oe.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TraceStats.WriterStats;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.sequenceId=e.uint64();break;case 4:n.buffer=e.uint32();break;case 2:if(n.chunkPayloadHistogramCounts&&n.chunkPayloadHistogramCounts.length||(n.chunkPayloadHistogramCounts=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.chunkPayloadHistogramCounts.push(e.uint64());else n.chunkPayloadHistogramCounts.push(e.uint64());break;case 3:if(n.chunkPayloadHistogramSum&&n.chunkPayloadHistogramSum.length||(n.chunkPayloadHistogramSum=[]),2==(7&a))for(i=e.uint32()+e.pos;e.pos<i;)n.chunkPayloadHistogramSum.push(e.int64());else n.chunkPayloadHistogramSum.push(e.int64());break;default:e.skipType(7&a)}}return n},Oe.fromObject=function(e){if(e instanceof s.perfetto.protos.TraceStats.WriterStats)return e;var t=new s.perfetto.protos.TraceStats.WriterStats;if(null!=e.sequenceId&&(i.Long?(t.sequenceId=i.Long.fromValue(e.sequenceId)).unsigned=!0:"string"==typeof e.sequenceId?t.sequenceId=parseInt(e.sequenceId,10):"number"==typeof e.sequenceId?t.sequenceId=e.sequenceId:"object"==typeof e.sequenceId&&(t.sequenceId=new i.LongBits(e.sequenceId.low>>>0,e.sequenceId.high>>>0).toNumber(!0))),null!=e.buffer&&(t.buffer=e.buffer>>>0),e.chunkPayloadHistogramCounts){if(!Array.isArray(e.chunkPayloadHistogramCounts))throw TypeError(".perfetto.protos.TraceStats.WriterStats.chunkPayloadHistogramCounts: array expected");t.chunkPayloadHistogramCounts=[];for(var r=0;r<e.chunkPayloadHistogramCounts.length;++r)i.Long?(t.chunkPayloadHistogramCounts[r]=i.Long.fromValue(e.chunkPayloadHistogramCounts[r])).unsigned=!0:"string"==typeof e.chunkPayloadHistogramCounts[r]?t.chunkPayloadHistogramCounts[r]=parseInt(e.chunkPayloadHistogramCounts[r],10):"number"==typeof e.chunkPayloadHistogramCounts[r]?t.chunkPayloadHistogramCounts[r]=e.chunkPayloadHistogramCounts[r]:"object"==typeof e.chunkPayloadHistogramCounts[r]&&(t.chunkPayloadHistogramCounts[r]=new i.LongBits(e.chunkPayloadHistogramCounts[r].low>>>0,e.chunkPayloadHistogramCounts[r].high>>>0).toNumber(!0))}if(e.chunkPayloadHistogramSum){if(!Array.isArray(e.chunkPayloadHistogramSum))throw TypeError(".perfetto.protos.TraceStats.WriterStats.chunkPayloadHistogramSum: array expected");t.chunkPayloadHistogramSum=[];for(r=0;r<e.chunkPayloadHistogramSum.length;++r)i.Long?(t.chunkPayloadHistogramSum[r]=i.Long.fromValue(e.chunkPayloadHistogramSum[r])).unsigned=!1:"string"==typeof e.chunkPayloadHistogramSum[r]?t.chunkPayloadHistogramSum[r]=parseInt(e.chunkPayloadHistogramSum[r],10):"number"==typeof e.chunkPayloadHistogramSum[r]?t.chunkPayloadHistogramSum[r]=e.chunkPayloadHistogramSum[r]:"object"==typeof e.chunkPayloadHistogramSum[r]&&(t.chunkPayloadHistogramSum[r]=new i.LongBits(e.chunkPayloadHistogramSum[r].low>>>0,e.chunkPayloadHistogramSum[r].high>>>0).toNumber())}return t},Oe.toObject=function(e,t){var r,n={};if(((t=t||{}).arrays||t.defaults)&&(n.chunkPayloadHistogramCounts=[],n.chunkPayloadHistogramSum=[]),t.defaults&&(i.Long?(r=new i.Long(0,0,!0),n.sequenceId=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.sequenceId=t.longs===String?"0":0,n.buffer=0),null!=e.sequenceId&&e.hasOwnProperty("sequenceId")&&("number"==typeof e.sequenceId?n.sequenceId=t.longs===String?String(e.sequenceId):e.sequenceId:n.sequenceId=t.longs===String?i.Long.prototype.toString.call(e.sequenceId):t.longs===Number?new i.LongBits(e.sequenceId.low>>>0,e.sequenceId.high>>>0).toNumber(!0):e.sequenceId),e.chunkPayloadHistogramCounts&&e.chunkPayloadHistogramCounts.length){n.chunkPayloadHistogramCounts=[];for(var a=0;a<e.chunkPayloadHistogramCounts.length;++a)"number"==typeof e.chunkPayloadHistogramCounts[a]?n.chunkPayloadHistogramCounts[a]=t.longs===String?String(e.chunkPayloadHistogramCounts[a]):e.chunkPayloadHistogramCounts[a]:n.chunkPayloadHistogramCounts[a]=t.longs===String?i.Long.prototype.toString.call(e.chunkPayloadHistogramCounts[a]):t.longs===Number?new i.LongBits(e.chunkPayloadHistogramCounts[a].low>>>0,e.chunkPayloadHistogramCounts[a].high>>>0).toNumber(!0):e.chunkPayloadHistogramCounts[a]}if(e.chunkPayloadHistogramSum&&e.chunkPayloadHistogramSum.length){n.chunkPayloadHistogramSum=[];for(a=0;a<e.chunkPayloadHistogramSum.length;++a)"number"==typeof e.chunkPayloadHistogramSum[a]?n.chunkPayloadHistogramSum[a]=t.longs===String?String(e.chunkPayloadHistogramSum[a]):e.chunkPayloadHistogramSum[a]:n.chunkPayloadHistogramSum[a]=t.longs===String?i.Long.prototype.toString.call(e.chunkPayloadHistogramSum[a]):t.longs===Number?new i.LongBits(e.chunkPayloadHistogramSum[a].low>>>0,e.chunkPayloadHistogramSum[a].high>>>0).toNumber():e.chunkPayloadHistogramSum[a]}return null!=e.buffer&&e.hasOwnProperty("buffer")&&(n.buffer=e.buffer),n},Oe.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Oe.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TraceStats.WriterStats"},Oe),g.FilterStats=(Ce.prototype.inputPackets=i.Long?i.Long.fromBits(0,0,!0):0,Ce.prototype.inputBytes=i.Long?i.Long.fromBits(0,0,!0):0,Ce.prototype.outputBytes=i.Long?i.Long.fromBits(0,0,!0):0,Ce.prototype.errors=i.Long?i.Long.fromBits(0,0,!0):0,Ce.prototype.timeTakenNs=i.Long?i.Long.fromBits(0,0,!0):0,Ce.prototype.bytesDiscardedPerBuffer=i.emptyArray,Ce.create=function(e){return new Ce(e)},Ce.encode=function(e,t){if(t=t||a.create(),null!=e.inputPackets&&Object.hasOwnProperty.call(e,"inputPackets")&&t.uint32(8).uint64(e.inputPackets),null!=e.inputBytes&&Object.hasOwnProperty.call(e,"inputBytes")&&t.uint32(16).uint64(e.inputBytes),null!=e.outputBytes&&Object.hasOwnProperty.call(e,"outputBytes")&&t.uint32(24).uint64(e.outputBytes),null!=e.errors&&Object.hasOwnProperty.call(e,"errors")&&t.uint32(32).uint64(e.errors),null!=e.timeTakenNs&&Object.hasOwnProperty.call(e,"timeTakenNs")&&t.uint32(40).uint64(e.timeTakenNs),null!=e.bytesDiscardedPerBuffer&&e.bytesDiscardedPerBuffer.length)for(var r=0;r<e.bytesDiscardedPerBuffer.length;++r)t.uint32(160).uint64(e.bytesDiscardedPerBuffer[r]);return t},Ce.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TraceStats.FilterStats;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.inputPackets=e.uint64();break;case 2:n.inputBytes=e.uint64();break;case 3:n.outputBytes=e.uint64();break;case 4:n.errors=e.uint64();break;case 5:n.timeTakenNs=e.uint64();break;case 20:if(n.bytesDiscardedPerBuffer&&n.bytesDiscardedPerBuffer.length||(n.bytesDiscardedPerBuffer=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.bytesDiscardedPerBuffer.push(e.uint64());else n.bytesDiscardedPerBuffer.push(e.uint64());break;default:e.skipType(7&a)}}return n},Ce.fromObject=function(e){if(e instanceof s.perfetto.protos.TraceStats.FilterStats)return e;var t=new s.perfetto.protos.TraceStats.FilterStats;if(null!=e.inputPackets&&(i.Long?(t.inputPackets=i.Long.fromValue(e.inputPackets)).unsigned=!0:"string"==typeof e.inputPackets?t.inputPackets=parseInt(e.inputPackets,10):"number"==typeof e.inputPackets?t.inputPackets=e.inputPackets:"object"==typeof e.inputPackets&&(t.inputPackets=new i.LongBits(e.inputPackets.low>>>0,e.inputPackets.high>>>0).toNumber(!0))),null!=e.inputBytes&&(i.Long?(t.inputBytes=i.Long.fromValue(e.inputBytes)).unsigned=!0:"string"==typeof e.inputBytes?t.inputBytes=parseInt(e.inputBytes,10):"number"==typeof e.inputBytes?t.inputBytes=e.inputBytes:"object"==typeof e.inputBytes&&(t.inputBytes=new i.LongBits(e.inputBytes.low>>>0,e.inputBytes.high>>>0).toNumber(!0))),null!=e.outputBytes&&(i.Long?(t.outputBytes=i.Long.fromValue(e.outputBytes)).unsigned=!0:"string"==typeof e.outputBytes?t.outputBytes=parseInt(e.outputBytes,10):"number"==typeof e.outputBytes?t.outputBytes=e.outputBytes:"object"==typeof e.outputBytes&&(t.outputBytes=new i.LongBits(e.outputBytes.low>>>0,e.outputBytes.high>>>0).toNumber(!0))),null!=e.errors&&(i.Long?(t.errors=i.Long.fromValue(e.errors)).unsigned=!0:"string"==typeof e.errors?t.errors=parseInt(e.errors,10):"number"==typeof e.errors?t.errors=e.errors:"object"==typeof e.errors&&(t.errors=new i.LongBits(e.errors.low>>>0,e.errors.high>>>0).toNumber(!0))),null!=e.timeTakenNs&&(i.Long?(t.timeTakenNs=i.Long.fromValue(e.timeTakenNs)).unsigned=!0:"string"==typeof e.timeTakenNs?t.timeTakenNs=parseInt(e.timeTakenNs,10):"number"==typeof e.timeTakenNs?t.timeTakenNs=e.timeTakenNs:"object"==typeof e.timeTakenNs&&(t.timeTakenNs=new i.LongBits(e.timeTakenNs.low>>>0,e.timeTakenNs.high>>>0).toNumber(!0))),e.bytesDiscardedPerBuffer){if(!Array.isArray(e.bytesDiscardedPerBuffer))throw TypeError(".perfetto.protos.TraceStats.FilterStats.bytesDiscardedPerBuffer: array expected");t.bytesDiscardedPerBuffer=[];for(var r=0;r<e.bytesDiscardedPerBuffer.length;++r)i.Long?(t.bytesDiscardedPerBuffer[r]=i.Long.fromValue(e.bytesDiscardedPerBuffer[r])).unsigned=!0:"string"==typeof e.bytesDiscardedPerBuffer[r]?t.bytesDiscardedPerBuffer[r]=parseInt(e.bytesDiscardedPerBuffer[r],10):"number"==typeof e.bytesDiscardedPerBuffer[r]?t.bytesDiscardedPerBuffer[r]=e.bytesDiscardedPerBuffer[r]:"object"==typeof e.bytesDiscardedPerBuffer[r]&&(t.bytesDiscardedPerBuffer[r]=new i.LongBits(e.bytesDiscardedPerBuffer[r].low>>>0,e.bytesDiscardedPerBuffer[r].high>>>0).toNumber(!0))}return t},Ce.toObject=function(e,t){var r,n={};if(((t=t||{}).arrays||t.defaults)&&(n.bytesDiscardedPerBuffer=[]),t.defaults&&(i.Long?(r=new i.Long(0,0,!0),n.inputPackets=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.inputPackets=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.inputBytes=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.inputBytes=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.outputBytes=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.outputBytes=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.errors=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.errors=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.timeTakenNs=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.timeTakenNs=t.longs===String?"0":0),null!=e.inputPackets&&e.hasOwnProperty("inputPackets")&&("number"==typeof e.inputPackets?n.inputPackets=t.longs===String?String(e.inputPackets):e.inputPackets:n.inputPackets=t.longs===String?i.Long.prototype.toString.call(e.inputPackets):t.longs===Number?new i.LongBits(e.inputPackets.low>>>0,e.inputPackets.high>>>0).toNumber(!0):e.inputPackets),null!=e.inputBytes&&e.hasOwnProperty("inputBytes")&&("number"==typeof e.inputBytes?n.inputBytes=t.longs===String?String(e.inputBytes):e.inputBytes:n.inputBytes=t.longs===String?i.Long.prototype.toString.call(e.inputBytes):t.longs===Number?new i.LongBits(e.inputBytes.low>>>0,e.inputBytes.high>>>0).toNumber(!0):e.inputBytes),null!=e.outputBytes&&e.hasOwnProperty("outputBytes")&&("number"==typeof e.outputBytes?n.outputBytes=t.longs===String?String(e.outputBytes):e.outputBytes:n.outputBytes=t.longs===String?i.Long.prototype.toString.call(e.outputBytes):t.longs===Number?new i.LongBits(e.outputBytes.low>>>0,e.outputBytes.high>>>0).toNumber(!0):e.outputBytes),null!=e.errors&&e.hasOwnProperty("errors")&&("number"==typeof e.errors?n.errors=t.longs===String?String(e.errors):e.errors:n.errors=t.longs===String?i.Long.prototype.toString.call(e.errors):t.longs===Number?new i.LongBits(e.errors.low>>>0,e.errors.high>>>0).toNumber(!0):e.errors),null!=e.timeTakenNs&&e.hasOwnProperty("timeTakenNs")&&("number"==typeof e.timeTakenNs?n.timeTakenNs=t.longs===String?String(e.timeTakenNs):e.timeTakenNs:n.timeTakenNs=t.longs===String?i.Long.prototype.toString.call(e.timeTakenNs):t.longs===Number?new i.LongBits(e.timeTakenNs.low>>>0,e.timeTakenNs.high>>>0).toNumber(!0):e.timeTakenNs),e.bytesDiscardedPerBuffer&&e.bytesDiscardedPerBuffer.length){n.bytesDiscardedPerBuffer=[];for(var a=0;a<e.bytesDiscardedPerBuffer.length;++a)"number"==typeof e.bytesDiscardedPerBuffer[a]?n.bytesDiscardedPerBuffer[a]=t.longs===String?String(e.bytesDiscardedPerBuffer[a]):e.bytesDiscardedPerBuffer[a]:n.bytesDiscardedPerBuffer[a]=t.longs===String?i.Long.prototype.toString.call(e.bytesDiscardedPerBuffer[a]):t.longs===Number?new i.LongBits(e.bytesDiscardedPerBuffer[a].low>>>0,e.bytesDiscardedPerBuffer[a].high>>>0).toNumber(!0):e.bytesDiscardedPerBuffer[a]}return n},Ce.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Ce.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TraceStats.FilterStats"},Ce),g.FinalFlushOutcome=(t={},(e=Object.create(t))[t[0]="FINAL_FLUSH_UNSPECIFIED"]=0,e[t[1]="FINAL_FLUSH_SUCCEEDED"]=1,e[t[2]="FINAL_FLUSH_FAILED"]=2,e),g),r.TraceConfig=(_.prototype.buffers=i.emptyArray,_.prototype.dataSources=i.emptyArray,_.prototype.builtinDataSources=null,_.prototype.durationMs=0,_.prototype.preferSuspendClockForDuration=!1,_.prototype.enableExtraGuardrails=!1,_.prototype.lockdownMode=0,_.prototype.producers=i.emptyArray,_.prototype.statsdMetadata=null,_.prototype.writeIntoFile=!1,_.prototype.outputPath="",_.prototype.fileWritePeriodMs=0,_.prototype.maxFileSizeBytes=i.Long?i.Long.fromBits(0,0,!0):0,_.prototype.guardrailOverrides=null,_.prototype.deferredStart=!1,_.prototype.flushPeriodMs=0,_.prototype.flushTimeoutMs=0,_.prototype.dataSourceStopTimeoutMs=0,_.prototype.notifyTraceur=!1,_.prototype.bugreportScore=0,_.prototype.bugreportFilename="",_.prototype.triggerConfig=null,_.prototype.activateTriggers=i.emptyArray,_.prototype.incrementalStateConfig=null,_.prototype.allowUserBuildTracing=!1,_.prototype.uniqueSessionName="",_.prototype.compressionType=0,_.prototype.incidentReportConfig=null,_.prototype.statsdLogging=0,_.prototype.traceUuidMsb=i.Long?i.Long.fromBits(0,0,!1):0,_.prototype.traceUuidLsb=i.Long?i.Long.fromBits(0,0,!1):0,_.prototype.traceFilter=null,_.prototype.androidReportConfig=null,_.prototype.cmdTraceStartDelay=null,_.prototype.sessionSemaphores=i.emptyArray,_.create=function(e){return new _(e)},_.encode=function(e,t){if(t=t||a.create(),null!=e.buffers&&e.buffers.length)for(var r=0;r<e.buffers.length;++r)s.perfetto.protos.TraceConfig.BufferConfig.encode(e.buffers[r],t.uint32(10).fork()).ldelim();if(null!=e.dataSources&&e.dataSources.length)for(r=0;r<e.dataSources.length;++r)s.perfetto.protos.TraceConfig.DataSource.encode(e.dataSources[r],t.uint32(18).fork()).ldelim();if(null!=e.durationMs&&Object.hasOwnProperty.call(e,"durationMs")&&t.uint32(24).uint32(e.durationMs),null!=e.enableExtraGuardrails&&Object.hasOwnProperty.call(e,"enableExtraGuardrails")&&t.uint32(32).bool(e.enableExtraGuardrails),null!=e.lockdownMode&&Object.hasOwnProperty.call(e,"lockdownMode")&&t.uint32(40).int32(e.lockdownMode),null!=e.producers&&e.producers.length)for(r=0;r<e.producers.length;++r)s.perfetto.protos.TraceConfig.ProducerConfig.encode(e.producers[r],t.uint32(50).fork()).ldelim();if(null!=e.statsdMetadata&&Object.hasOwnProperty.call(e,"statsdMetadata")&&s.perfetto.protos.TraceConfig.StatsdMetadata.encode(e.statsdMetadata,t.uint32(58).fork()).ldelim(),null!=e.writeIntoFile&&Object.hasOwnProperty.call(e,"writeIntoFile")&&t.uint32(64).bool(e.writeIntoFile),null!=e.fileWritePeriodMs&&Object.hasOwnProperty.call(e,"fileWritePeriodMs")&&t.uint32(72).uint32(e.fileWritePeriodMs),null!=e.maxFileSizeBytes&&Object.hasOwnProperty.call(e,"maxFileSizeBytes")&&t.uint32(80).uint64(e.maxFileSizeBytes),null!=e.guardrailOverrides&&Object.hasOwnProperty.call(e,"guardrailOverrides")&&s.perfetto.protos.TraceConfig.GuardrailOverrides.encode(e.guardrailOverrides,t.uint32(90).fork()).ldelim(),null!=e.deferredStart&&Object.hasOwnProperty.call(e,"deferredStart")&&t.uint32(96).bool(e.deferredStart),null!=e.flushPeriodMs&&Object.hasOwnProperty.call(e,"flushPeriodMs")&&t.uint32(104).uint32(e.flushPeriodMs),null!=e.flushTimeoutMs&&Object.hasOwnProperty.call(e,"flushTimeoutMs")&&t.uint32(112).uint32(e.flushTimeoutMs),null!=e.notifyTraceur&&Object.hasOwnProperty.call(e,"notifyTraceur")&&t.uint32(128).bool(e.notifyTraceur),null!=e.triggerConfig&&Object.hasOwnProperty.call(e,"triggerConfig")&&s.perfetto.protos.TraceConfig.TriggerConfig.encode(e.triggerConfig,t.uint32(138).fork()).ldelim(),null!=e.activateTriggers&&e.activateTriggers.length)for(r=0;r<e.activateTriggers.length;++r)t.uint32(146).string(e.activateTriggers[r]);if(null!=e.allowUserBuildTracing&&Object.hasOwnProperty.call(e,"allowUserBuildTracing")&&t.uint32(152).bool(e.allowUserBuildTracing),null!=e.builtinDataSources&&Object.hasOwnProperty.call(e,"builtinDataSources")&&s.perfetto.protos.TraceConfig.BuiltinDataSource.encode(e.builtinDataSources,t.uint32(162).fork()).ldelim(),null!=e.incrementalStateConfig&&Object.hasOwnProperty.call(e,"incrementalStateConfig")&&s.perfetto.protos.TraceConfig.IncrementalStateConfig.encode(e.incrementalStateConfig,t.uint32(170).fork()).ldelim(),null!=e.uniqueSessionName&&Object.hasOwnProperty.call(e,"uniqueSessionName")&&t.uint32(178).string(e.uniqueSessionName),null!=e.dataSourceStopTimeoutMs&&Object.hasOwnProperty.call(e,"dataSourceStopTimeoutMs")&&t.uint32(184).uint32(e.dataSourceStopTimeoutMs),null!=e.compressionType&&Object.hasOwnProperty.call(e,"compressionType")&&t.uint32(192).int32(e.compressionType),null!=e.incidentReportConfig&&Object.hasOwnProperty.call(e,"incidentReportConfig")&&s.perfetto.protos.TraceConfig.IncidentReportConfig.encode(e.incidentReportConfig,t.uint32(202).fork()).ldelim(),null!=e.traceUuidMsb&&Object.hasOwnProperty.call(e,"traceUuidMsb")&&t.uint32(216).int64(e.traceUuidMsb),null!=e.traceUuidLsb&&Object.hasOwnProperty.call(e,"traceUuidLsb")&&t.uint32(224).int64(e.traceUuidLsb),null!=e.outputPath&&Object.hasOwnProperty.call(e,"outputPath")&&t.uint32(234).string(e.outputPath),null!=e.bugreportScore&&Object.hasOwnProperty.call(e,"bugreportScore")&&t.uint32(240).int32(e.bugreportScore),null!=e.statsdLogging&&Object.hasOwnProperty.call(e,"statsdLogging")&&t.uint32(248).int32(e.statsdLogging),null!=e.traceFilter&&Object.hasOwnProperty.call(e,"traceFilter")&&s.perfetto.protos.TraceConfig.TraceFilter.encode(e.traceFilter,t.uint32(266).fork()).ldelim(),null!=e.androidReportConfig&&Object.hasOwnProperty.call(e,"androidReportConfig")&&s.perfetto.protos.TraceConfig.AndroidReportConfig.encode(e.androidReportConfig,t.uint32(274).fork()).ldelim(),null!=e.cmdTraceStartDelay&&Object.hasOwnProperty.call(e,"cmdTraceStartDelay")&&s.perfetto.protos.TraceConfig.CmdTraceStartDelay.encode(e.cmdTraceStartDelay,t.uint32(282).fork()).ldelim(),null!=e.preferSuspendClockForDuration&&Object.hasOwnProperty.call(e,"preferSuspendClockForDuration")&&t.uint32(288).bool(e.preferSuspendClockForDuration),null!=e.bugreportFilename&&Object.hasOwnProperty.call(e,"bugreportFilename")&&t.uint32(306).string(e.bugreportFilename),null!=e.sessionSemaphores&&e.sessionSemaphores.length)for(r=0;r<e.sessionSemaphores.length;++r)s.perfetto.protos.TraceConfig.SessionSemaphore.encode(e.sessionSemaphores[r],t.uint32(314).fork()).ldelim();return t},_.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TraceConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.buffers&&n.buffers.length||(n.buffers=[]),n.buffers.push(s.perfetto.protos.TraceConfig.BufferConfig.decode(e,e.uint32()));break;case 2:n.dataSources&&n.dataSources.length||(n.dataSources=[]),n.dataSources.push(s.perfetto.protos.TraceConfig.DataSource.decode(e,e.uint32()));break;case 20:n.builtinDataSources=s.perfetto.protos.TraceConfig.BuiltinDataSource.decode(e,e.uint32());break;case 3:n.durationMs=e.uint32();break;case 36:n.preferSuspendClockForDuration=e.bool();break;case 4:n.enableExtraGuardrails=e.bool();break;case 5:n.lockdownMode=e.int32();break;case 6:n.producers&&n.producers.length||(n.producers=[]),n.producers.push(s.perfetto.protos.TraceConfig.ProducerConfig.decode(e,e.uint32()));break;case 7:n.statsdMetadata=s.perfetto.protos.TraceConfig.StatsdMetadata.decode(e,e.uint32());break;case 8:n.writeIntoFile=e.bool();break;case 29:n.outputPath=e.string();break;case 9:n.fileWritePeriodMs=e.uint32();break;case 10:n.maxFileSizeBytes=e.uint64();break;case 11:n.guardrailOverrides=s.perfetto.protos.TraceConfig.GuardrailOverrides.decode(e,e.uint32());break;case 12:n.deferredStart=e.bool();break;case 13:n.flushPeriodMs=e.uint32();break;case 14:n.flushTimeoutMs=e.uint32();break;case 23:n.dataSourceStopTimeoutMs=e.uint32();break;case 16:n.notifyTraceur=e.bool();break;case 30:n.bugreportScore=e.int32();break;case 38:n.bugreportFilename=e.string();break;case 17:n.triggerConfig=s.perfetto.protos.TraceConfig.TriggerConfig.decode(e,e.uint32());break;case 18:n.activateTriggers&&n.activateTriggers.length||(n.activateTriggers=[]),n.activateTriggers.push(e.string());break;case 21:n.incrementalStateConfig=s.perfetto.protos.TraceConfig.IncrementalStateConfig.decode(e,e.uint32());break;case 19:n.allowUserBuildTracing=e.bool();break;case 22:n.uniqueSessionName=e.string();break;case 24:n.compressionType=e.int32();break;case 25:n.incidentReportConfig=s.perfetto.protos.TraceConfig.IncidentReportConfig.decode(e,e.uint32());break;case 31:n.statsdLogging=e.int32();break;case 27:n.traceUuidMsb=e.int64();break;case 28:n.traceUuidLsb=e.int64();break;case 33:n.traceFilter=s.perfetto.protos.TraceConfig.TraceFilter.decode(e,e.uint32());break;case 34:n.androidReportConfig=s.perfetto.protos.TraceConfig.AndroidReportConfig.decode(e,e.uint32());break;case 35:n.cmdTraceStartDelay=s.perfetto.protos.TraceConfig.CmdTraceStartDelay.decode(e,e.uint32());break;case 39:n.sessionSemaphores&&n.sessionSemaphores.length||(n.sessionSemaphores=[]),n.sessionSemaphores.push(s.perfetto.protos.TraceConfig.SessionSemaphore.decode(e,e.uint32()));break;default:e.skipType(7&a)}}return n},_.fromObject=function(e){if(e instanceof s.perfetto.protos.TraceConfig)return e;var t=new s.perfetto.protos.TraceConfig;if(e.buffers){if(!Array.isArray(e.buffers))throw TypeError(".perfetto.protos.TraceConfig.buffers: array expected");t.buffers=[];for(var r=0;r<e.buffers.length;++r){if("object"!=typeof e.buffers[r])throw TypeError(".perfetto.protos.TraceConfig.buffers: object expected");t.buffers[r]=s.perfetto.protos.TraceConfig.BufferConfig.fromObject(e.buffers[r])}}if(e.dataSources){if(!Array.isArray(e.dataSources))throw TypeError(".perfetto.protos.TraceConfig.dataSources: array expected");t.dataSources=[];for(r=0;r<e.dataSources.length;++r){if("object"!=typeof e.dataSources[r])throw TypeError(".perfetto.protos.TraceConfig.dataSources: object expected");t.dataSources[r]=s.perfetto.protos.TraceConfig.DataSource.fromObject(e.dataSources[r])}}if(null!=e.builtinDataSources){if("object"!=typeof e.builtinDataSources)throw TypeError(".perfetto.protos.TraceConfig.builtinDataSources: object expected");t.builtinDataSources=s.perfetto.protos.TraceConfig.BuiltinDataSource.fromObject(e.builtinDataSources)}switch(null!=e.durationMs&&(t.durationMs=e.durationMs>>>0),null!=e.preferSuspendClockForDuration&&(t.preferSuspendClockForDuration=Boolean(e.preferSuspendClockForDuration)),null!=e.enableExtraGuardrails&&(t.enableExtraGuardrails=Boolean(e.enableExtraGuardrails)),e.lockdownMode){default:"number"==typeof e.lockdownMode&&(t.lockdownMode=e.lockdownMode);break;case"LOCKDOWN_UNCHANGED":case 0:t.lockdownMode=0;break;case"LOCKDOWN_CLEAR":case 1:t.lockdownMode=1;break;case"LOCKDOWN_SET":case 2:t.lockdownMode=2}if(e.producers){if(!Array.isArray(e.producers))throw TypeError(".perfetto.protos.TraceConfig.producers: array expected");t.producers=[];for(r=0;r<e.producers.length;++r){if("object"!=typeof e.producers[r])throw TypeError(".perfetto.protos.TraceConfig.producers: object expected");t.producers[r]=s.perfetto.protos.TraceConfig.ProducerConfig.fromObject(e.producers[r])}}if(null!=e.statsdMetadata){if("object"!=typeof e.statsdMetadata)throw TypeError(".perfetto.protos.TraceConfig.statsdMetadata: object expected");t.statsdMetadata=s.perfetto.protos.TraceConfig.StatsdMetadata.fromObject(e.statsdMetadata)}if(null!=e.writeIntoFile&&(t.writeIntoFile=Boolean(e.writeIntoFile)),null!=e.outputPath&&(t.outputPath=String(e.outputPath)),null!=e.fileWritePeriodMs&&(t.fileWritePeriodMs=e.fileWritePeriodMs>>>0),null!=e.maxFileSizeBytes&&(i.Long?(t.maxFileSizeBytes=i.Long.fromValue(e.maxFileSizeBytes)).unsigned=!0:"string"==typeof e.maxFileSizeBytes?t.maxFileSizeBytes=parseInt(e.maxFileSizeBytes,10):"number"==typeof e.maxFileSizeBytes?t.maxFileSizeBytes=e.maxFileSizeBytes:"object"==typeof e.maxFileSizeBytes&&(t.maxFileSizeBytes=new i.LongBits(e.maxFileSizeBytes.low>>>0,e.maxFileSizeBytes.high>>>0).toNumber(!0))),null!=e.guardrailOverrides){if("object"!=typeof e.guardrailOverrides)throw TypeError(".perfetto.protos.TraceConfig.guardrailOverrides: object expected");t.guardrailOverrides=s.perfetto.protos.TraceConfig.GuardrailOverrides.fromObject(e.guardrailOverrides)}if(null!=e.deferredStart&&(t.deferredStart=Boolean(e.deferredStart)),null!=e.flushPeriodMs&&(t.flushPeriodMs=e.flushPeriodMs>>>0),null!=e.flushTimeoutMs&&(t.flushTimeoutMs=e.flushTimeoutMs>>>0),null!=e.dataSourceStopTimeoutMs&&(t.dataSourceStopTimeoutMs=e.dataSourceStopTimeoutMs>>>0),null!=e.notifyTraceur&&(t.notifyTraceur=Boolean(e.notifyTraceur)),null!=e.bugreportScore&&(t.bugreportScore=0|e.bugreportScore),null!=e.bugreportFilename&&(t.bugreportFilename=String(e.bugreportFilename)),null!=e.triggerConfig){if("object"!=typeof e.triggerConfig)throw TypeError(".perfetto.protos.TraceConfig.triggerConfig: object expected");t.triggerConfig=s.perfetto.protos.TraceConfig.TriggerConfig.fromObject(e.triggerConfig)}if(e.activateTriggers){if(!Array.isArray(e.activateTriggers))throw TypeError(".perfetto.protos.TraceConfig.activateTriggers: array expected");t.activateTriggers=[];for(r=0;r<e.activateTriggers.length;++r)t.activateTriggers[r]=String(e.activateTriggers[r])}if(null!=e.incrementalStateConfig){if("object"!=typeof e.incrementalStateConfig)throw TypeError(".perfetto.protos.TraceConfig.incrementalStateConfig: object expected");t.incrementalStateConfig=s.perfetto.protos.TraceConfig.IncrementalStateConfig.fromObject(e.incrementalStateConfig)}switch(null!=e.allowUserBuildTracing&&(t.allowUserBuildTracing=Boolean(e.allowUserBuildTracing)),null!=e.uniqueSessionName&&(t.uniqueSessionName=String(e.uniqueSessionName)),e.compressionType){default:"number"==typeof e.compressionType&&(t.compressionType=e.compressionType);break;case"COMPRESSION_TYPE_UNSPECIFIED":case 0:t.compressionType=0;break;case"COMPRESSION_TYPE_DEFLATE":case 1:t.compressionType=1}if(null!=e.incidentReportConfig){if("object"!=typeof e.incidentReportConfig)throw TypeError(".perfetto.protos.TraceConfig.incidentReportConfig: object expected");t.incidentReportConfig=s.perfetto.protos.TraceConfig.IncidentReportConfig.fromObject(e.incidentReportConfig)}switch(e.statsdLogging){default:"number"==typeof e.statsdLogging&&(t.statsdLogging=e.statsdLogging);break;case"STATSD_LOGGING_UNSPECIFIED":case 0:t.statsdLogging=0;break;case"STATSD_LOGGING_ENABLED":case 1:t.statsdLogging=1;break;case"STATSD_LOGGING_DISABLED":case 2:t.statsdLogging=2}if(null!=e.traceUuidMsb&&(i.Long?(t.traceUuidMsb=i.Long.fromValue(e.traceUuidMsb)).unsigned=!1:"string"==typeof e.traceUuidMsb?t.traceUuidMsb=parseInt(e.traceUuidMsb,10):"number"==typeof e.traceUuidMsb?t.traceUuidMsb=e.traceUuidMsb:"object"==typeof e.traceUuidMsb&&(t.traceUuidMsb=new i.LongBits(e.traceUuidMsb.low>>>0,e.traceUuidMsb.high>>>0).toNumber())),null!=e.traceUuidLsb&&(i.Long?(t.traceUuidLsb=i.Long.fromValue(e.traceUuidLsb)).unsigned=!1:"string"==typeof e.traceUuidLsb?t.traceUuidLsb=parseInt(e.traceUuidLsb,10):"number"==typeof e.traceUuidLsb?t.traceUuidLsb=e.traceUuidLsb:"object"==typeof e.traceUuidLsb&&(t.traceUuidLsb=new i.LongBits(e.traceUuidLsb.low>>>0,e.traceUuidLsb.high>>>0).toNumber())),null!=e.traceFilter){if("object"!=typeof e.traceFilter)throw TypeError(".perfetto.protos.TraceConfig.traceFilter: object expected");t.traceFilter=s.perfetto.protos.TraceConfig.TraceFilter.fromObject(e.traceFilter)}if(null!=e.androidReportConfig){if("object"!=typeof e.androidReportConfig)throw TypeError(".perfetto.protos.TraceConfig.androidReportConfig: object expected");t.androidReportConfig=s.perfetto.protos.TraceConfig.AndroidReportConfig.fromObject(e.androidReportConfig)}if(null!=e.cmdTraceStartDelay){if("object"!=typeof e.cmdTraceStartDelay)throw TypeError(".perfetto.protos.TraceConfig.cmdTraceStartDelay: object expected");t.cmdTraceStartDelay=s.perfetto.protos.TraceConfig.CmdTraceStartDelay.fromObject(e.cmdTraceStartDelay)}if(e.sessionSemaphores){if(!Array.isArray(e.sessionSemaphores))throw TypeError(".perfetto.protos.TraceConfig.sessionSemaphores: array expected");t.sessionSemaphores=[];for(r=0;r<e.sessionSemaphores.length;++r){if("object"!=typeof e.sessionSemaphores[r])throw TypeError(".perfetto.protos.TraceConfig.sessionSemaphores: object expected");t.sessionSemaphores[r]=s.perfetto.protos.TraceConfig.SessionSemaphore.fromObject(e.sessionSemaphores[r])}}return t},_.toObject=function(e,t){var r,n={};if(((t=t||{}).arrays||t.defaults)&&(n.buffers=[],n.dataSources=[],n.producers=[],n.activateTriggers=[],n.sessionSemaphores=[]),t.defaults&&(n.durationMs=0,n.enableExtraGuardrails=!1,n.lockdownMode=t.enums===String?"LOCKDOWN_UNCHANGED":0,n.statsdMetadata=null,n.writeIntoFile=!1,n.fileWritePeriodMs=0,i.Long?(r=new i.Long(0,0,!0),n.maxFileSizeBytes=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.maxFileSizeBytes=t.longs===String?"0":0,n.guardrailOverrides=null,n.deferredStart=!1,n.flushPeriodMs=0,n.flushTimeoutMs=0,n.notifyTraceur=!1,n.triggerConfig=null,n.allowUserBuildTracing=!1,n.builtinDataSources=null,n.incrementalStateConfig=null,n.uniqueSessionName="",n.dataSourceStopTimeoutMs=0,n.compressionType=t.enums===String?"COMPRESSION_TYPE_UNSPECIFIED":0,n.incidentReportConfig=null,i.Long?(r=new i.Long(0,0,!1),n.traceUuidMsb=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.traceUuidMsb=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!1),n.traceUuidLsb=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.traceUuidLsb=t.longs===String?"0":0,n.outputPath="",n.bugreportScore=0,n.statsdLogging=t.enums===String?"STATSD_LOGGING_UNSPECIFIED":0,n.traceFilter=null,n.androidReportConfig=null,n.cmdTraceStartDelay=null,n.preferSuspendClockForDuration=!1,n.bugreportFilename=""),e.buffers&&e.buffers.length){n.buffers=[];for(var a=0;a<e.buffers.length;++a)n.buffers[a]=s.perfetto.protos.TraceConfig.BufferConfig.toObject(e.buffers[a],t)}if(e.dataSources&&e.dataSources.length){n.dataSources=[];for(a=0;a<e.dataSources.length;++a)n.dataSources[a]=s.perfetto.protos.TraceConfig.DataSource.toObject(e.dataSources[a],t)}if(null!=e.durationMs&&e.hasOwnProperty("durationMs")&&(n.durationMs=e.durationMs),null!=e.enableExtraGuardrails&&e.hasOwnProperty("enableExtraGuardrails")&&(n.enableExtraGuardrails=e.enableExtraGuardrails),null!=e.lockdownMode&&e.hasOwnProperty("lockdownMode")&&(n.lockdownMode=t.enums!==String||void 0===s.perfetto.protos.TraceConfig.LockdownModeOperation[e.lockdownMode]?e.lockdownMode:s.perfetto.protos.TraceConfig.LockdownModeOperation[e.lockdownMode]),e.producers&&e.producers.length){n.producers=[];for(a=0;a<e.producers.length;++a)n.producers[a]=s.perfetto.protos.TraceConfig.ProducerConfig.toObject(e.producers[a],t)}if(null!=e.statsdMetadata&&e.hasOwnProperty("statsdMetadata")&&(n.statsdMetadata=s.perfetto.protos.TraceConfig.StatsdMetadata.toObject(e.statsdMetadata,t)),null!=e.writeIntoFile&&e.hasOwnProperty("writeIntoFile")&&(n.writeIntoFile=e.writeIntoFile),null!=e.fileWritePeriodMs&&e.hasOwnProperty("fileWritePeriodMs")&&(n.fileWritePeriodMs=e.fileWritePeriodMs),null!=e.maxFileSizeBytes&&e.hasOwnProperty("maxFileSizeBytes")&&("number"==typeof e.maxFileSizeBytes?n.maxFileSizeBytes=t.longs===String?String(e.maxFileSizeBytes):e.maxFileSizeBytes:n.maxFileSizeBytes=t.longs===String?i.Long.prototype.toString.call(e.maxFileSizeBytes):t.longs===Number?new i.LongBits(e.maxFileSizeBytes.low>>>0,e.maxFileSizeBytes.high>>>0).toNumber(!0):e.maxFileSizeBytes),null!=e.guardrailOverrides&&e.hasOwnProperty("guardrailOverrides")&&(n.guardrailOverrides=s.perfetto.protos.TraceConfig.GuardrailOverrides.toObject(e.guardrailOverrides,t)),null!=e.deferredStart&&e.hasOwnProperty("deferredStart")&&(n.deferredStart=e.deferredStart),null!=e.flushPeriodMs&&e.hasOwnProperty("flushPeriodMs")&&(n.flushPeriodMs=e.flushPeriodMs),null!=e.flushTimeoutMs&&e.hasOwnProperty("flushTimeoutMs")&&(n.flushTimeoutMs=e.flushTimeoutMs),null!=e.notifyTraceur&&e.hasOwnProperty("notifyTraceur")&&(n.notifyTraceur=e.notifyTraceur),null!=e.triggerConfig&&e.hasOwnProperty("triggerConfig")&&(n.triggerConfig=s.perfetto.protos.TraceConfig.TriggerConfig.toObject(e.triggerConfig,t)),e.activateTriggers&&e.activateTriggers.length){n.activateTriggers=[];for(a=0;a<e.activateTriggers.length;++a)n.activateTriggers[a]=e.activateTriggers[a]}if(null!=e.allowUserBuildTracing&&e.hasOwnProperty("allowUserBuildTracing")&&(n.allowUserBuildTracing=e.allowUserBuildTracing),null!=e.builtinDataSources&&e.hasOwnProperty("builtinDataSources")&&(n.builtinDataSources=s.perfetto.protos.TraceConfig.BuiltinDataSource.toObject(e.builtinDataSources,t)),null!=e.incrementalStateConfig&&e.hasOwnProperty("incrementalStateConfig")&&(n.incrementalStateConfig=s.perfetto.protos.TraceConfig.IncrementalStateConfig.toObject(e.incrementalStateConfig,t)),null!=e.uniqueSessionName&&e.hasOwnProperty("uniqueSessionName")&&(n.uniqueSessionName=e.uniqueSessionName),null!=e.dataSourceStopTimeoutMs&&e.hasOwnProperty("dataSourceStopTimeoutMs")&&(n.dataSourceStopTimeoutMs=e.dataSourceStopTimeoutMs),null!=e.compressionType&&e.hasOwnProperty("compressionType")&&(n.compressionType=t.enums!==String||void 0===s.perfetto.protos.TraceConfig.CompressionType[e.compressionType]?e.compressionType:s.perfetto.protos.TraceConfig.CompressionType[e.compressionType]),null!=e.incidentReportConfig&&e.hasOwnProperty("incidentReportConfig")&&(n.incidentReportConfig=s.perfetto.protos.TraceConfig.IncidentReportConfig.toObject(e.incidentReportConfig,t)),null!=e.traceUuidMsb&&e.hasOwnProperty("traceUuidMsb")&&("number"==typeof e.traceUuidMsb?n.traceUuidMsb=t.longs===String?String(e.traceUuidMsb):e.traceUuidMsb:n.traceUuidMsb=t.longs===String?i.Long.prototype.toString.call(e.traceUuidMsb):t.longs===Number?new i.LongBits(e.traceUuidMsb.low>>>0,e.traceUuidMsb.high>>>0).toNumber():e.traceUuidMsb),null!=e.traceUuidLsb&&e.hasOwnProperty("traceUuidLsb")&&("number"==typeof e.traceUuidLsb?n.traceUuidLsb=t.longs===String?String(e.traceUuidLsb):e.traceUuidLsb:n.traceUuidLsb=t.longs===String?i.Long.prototype.toString.call(e.traceUuidLsb):t.longs===Number?new i.LongBits(e.traceUuidLsb.low>>>0,e.traceUuidLsb.high>>>0).toNumber():e.traceUuidLsb),null!=e.outputPath&&e.hasOwnProperty("outputPath")&&(n.outputPath=e.outputPath),null!=e.bugreportScore&&e.hasOwnProperty("bugreportScore")&&(n.bugreportScore=e.bugreportScore),null!=e.statsdLogging&&e.hasOwnProperty("statsdLogging")&&(n.statsdLogging=t.enums!==String||void 0===s.perfetto.protos.TraceConfig.StatsdLogging[e.statsdLogging]?e.statsdLogging:s.perfetto.protos.TraceConfig.StatsdLogging[e.statsdLogging]),null!=e.traceFilter&&e.hasOwnProperty("traceFilter")&&(n.traceFilter=s.perfetto.protos.TraceConfig.TraceFilter.toObject(e.traceFilter,t)),null!=e.androidReportConfig&&e.hasOwnProperty("androidReportConfig")&&(n.androidReportConfig=s.perfetto.protos.TraceConfig.AndroidReportConfig.toObject(e.androidReportConfig,t)),null!=e.cmdTraceStartDelay&&e.hasOwnProperty("cmdTraceStartDelay")&&(n.cmdTraceStartDelay=s.perfetto.protos.TraceConfig.CmdTraceStartDelay.toObject(e.cmdTraceStartDelay,t)),null!=e.preferSuspendClockForDuration&&e.hasOwnProperty("preferSuspendClockForDuration")&&(n.preferSuspendClockForDuration=e.preferSuspendClockForDuration),null!=e.bugreportFilename&&e.hasOwnProperty("bugreportFilename")&&(n.bugreportFilename=e.bugreportFilename),e.sessionSemaphores&&e.sessionSemaphores.length){n.sessionSemaphores=[];for(a=0;a<e.sessionSemaphores.length;++a)n.sessionSemaphores[a]=s.perfetto.protos.TraceConfig.SessionSemaphore.toObject(e.sessionSemaphores[a],t)}return n},_.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},_.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TraceConfig"},_.BufferConfig=(ke.prototype.sizeKb=0,ke.prototype.fillPolicy=0,ke.prototype.transferOnClone=!1,ke.prototype.clearBeforeClone=!1,ke.create=function(e){return new ke(e)},ke.encode=function(e,t){return t=t||a.create(),null!=e.sizeKb&&Object.hasOwnProperty.call(e,"sizeKb")&&t.uint32(8).uint32(e.sizeKb),null!=e.fillPolicy&&Object.hasOwnProperty.call(e,"fillPolicy")&&t.uint32(32).int32(e.fillPolicy),null!=e.transferOnClone&&Object.hasOwnProperty.call(e,"transferOnClone")&&t.uint32(40).bool(e.transferOnClone),null!=e.clearBeforeClone&&Object.hasOwnProperty.call(e,"clearBeforeClone")&&t.uint32(48).bool(e.clearBeforeClone),t},ke.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TraceConfig.BufferConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.sizeKb=e.uint32();break;case 4:n.fillPolicy=e.int32();break;case 5:n.transferOnClone=e.bool();break;case 6:n.clearBeforeClone=e.bool();break;default:e.skipType(7&a)}}return n},ke.fromObject=function(e){if(e instanceof s.perfetto.protos.TraceConfig.BufferConfig)return e;var t=new s.perfetto.protos.TraceConfig.BufferConfig;switch(null!=e.sizeKb&&(t.sizeKb=e.sizeKb>>>0),e.fillPolicy){default:"number"==typeof e.fillPolicy&&(t.fillPolicy=e.fillPolicy);break;case"UNSPECIFIED":case 0:t.fillPolicy=0;break;case"RING_BUFFER":case 1:t.fillPolicy=1;break;case"DISCARD":case 2:t.fillPolicy=2}return null!=e.transferOnClone&&(t.transferOnClone=Boolean(e.transferOnClone)),null!=e.clearBeforeClone&&(t.clearBeforeClone=Boolean(e.clearBeforeClone)),t},ke.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.sizeKb=0,r.fillPolicy=t.enums===String?"UNSPECIFIED":0,r.transferOnClone=!1,r.clearBeforeClone=!1),null!=e.sizeKb&&e.hasOwnProperty("sizeKb")&&(r.sizeKb=e.sizeKb),null!=e.fillPolicy&&e.hasOwnProperty("fillPolicy")&&(r.fillPolicy=t.enums!==String||void 0===s.perfetto.protos.TraceConfig.BufferConfig.FillPolicy[e.fillPolicy]?e.fillPolicy:s.perfetto.protos.TraceConfig.BufferConfig.FillPolicy[e.fillPolicy]),null!=e.transferOnClone&&e.hasOwnProperty("transferOnClone")&&(r.transferOnClone=e.transferOnClone),null!=e.clearBeforeClone&&e.hasOwnProperty("clearBeforeClone")&&(r.clearBeforeClone=e.clearBeforeClone),r},ke.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},ke.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TraceConfig.BufferConfig"},ke.FillPolicy=(t={},(e=Object.create(t))[t[0]="UNSPECIFIED"]=0,e[t[1]="RING_BUFFER"]=1,e[t[2]="DISCARD"]=2,e),ke),_.DataSource=(we.prototype.config=null,we.prototype.producerNameFilter=i.emptyArray,we.prototype.producerNameRegexFilter=i.emptyArray,we.create=function(e){return new we(e)},we.encode=function(e,t){if(t=t||a.create(),null!=e.config&&Object.hasOwnProperty.call(e,"config")&&s.perfetto.protos.DataSourceConfig.encode(e.config,t.uint32(10).fork()).ldelim(),null!=e.producerNameFilter&&e.producerNameFilter.length)for(var r=0;r<e.producerNameFilter.length;++r)t.uint32(18).string(e.producerNameFilter[r]);if(null!=e.producerNameRegexFilter&&e.producerNameRegexFilter.length)for(r=0;r<e.producerNameRegexFilter.length;++r)t.uint32(26).string(e.producerNameRegexFilter[r]);return t},we.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TraceConfig.DataSource;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.config=s.perfetto.protos.DataSourceConfig.decode(e,e.uint32());break;case 2:n.producerNameFilter&&n.producerNameFilter.length||(n.producerNameFilter=[]),n.producerNameFilter.push(e.string());break;case 3:n.producerNameRegexFilter&&n.producerNameRegexFilter.length||(n.producerNameRegexFilter=[]),n.producerNameRegexFilter.push(e.string());break;default:e.skipType(7&a)}}return n},we.fromObject=function(e){if(e instanceof s.perfetto.protos.TraceConfig.DataSource)return e;var t=new s.perfetto.protos.TraceConfig.DataSource;if(null!=e.config){if("object"!=typeof e.config)throw TypeError(".perfetto.protos.TraceConfig.DataSource.config: object expected");t.config=s.perfetto.protos.DataSourceConfig.fromObject(e.config)}if(e.producerNameFilter){if(!Array.isArray(e.producerNameFilter))throw TypeError(".perfetto.protos.TraceConfig.DataSource.producerNameFilter: array expected");t.producerNameFilter=[];for(var r=0;r<e.producerNameFilter.length;++r)t.producerNameFilter[r]=String(e.producerNameFilter[r])}if(e.producerNameRegexFilter){if(!Array.isArray(e.producerNameRegexFilter))throw TypeError(".perfetto.protos.TraceConfig.DataSource.producerNameRegexFilter: array expected");t.producerNameRegexFilter=[];for(r=0;r<e.producerNameRegexFilter.length;++r)t.producerNameRegexFilter[r]=String(e.producerNameRegexFilter[r])}return t},we.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.producerNameFilter=[],r.producerNameRegexFilter=[]),t.defaults&&(r.config=null),null!=e.config&&e.hasOwnProperty("config")&&(r.config=s.perfetto.protos.DataSourceConfig.toObject(e.config,t)),e.producerNameFilter&&e.producerNameFilter.length){r.producerNameFilter=[];for(var n=0;n<e.producerNameFilter.length;++n)r.producerNameFilter[n]=e.producerNameFilter[n]}if(e.producerNameRegexFilter&&e.producerNameRegexFilter.length){r.producerNameRegexFilter=[];for(n=0;n<e.producerNameRegexFilter.length;++n)r.producerNameRegexFilter[n]=e.producerNameRegexFilter[n]}return r},we.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},we.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TraceConfig.DataSource"},we),_.BuiltinDataSource=(y.prototype.disableClockSnapshotting=!1,y.prototype.disableTraceConfig=!1,y.prototype.disableSystemInfo=!1,y.prototype.disableServiceEvents=!1,y.prototype.primaryTraceClock=0,y.prototype.snapshotIntervalMs=0,y.prototype.preferSuspendClockForSnapshot=!1,y.prototype.disableChunkUsageHistograms=!1,y.create=function(e){return new y(e)},y.encode=function(e,t){return t=t||a.create(),null!=e.disableClockSnapshotting&&Object.hasOwnProperty.call(e,"disableClockSnapshotting")&&t.uint32(8).bool(e.disableClockSnapshotting),null!=e.disableTraceConfig&&Object.hasOwnProperty.call(e,"disableTraceConfig")&&t.uint32(16).bool(e.disableTraceConfig),null!=e.disableSystemInfo&&Object.hasOwnProperty.call(e,"disableSystemInfo")&&t.uint32(24).bool(e.disableSystemInfo),null!=e.disableServiceEvents&&Object.hasOwnProperty.call(e,"disableServiceEvents")&&t.uint32(32).bool(e.disableServiceEvents),null!=e.primaryTraceClock&&Object.hasOwnProperty.call(e,"primaryTraceClock")&&t.uint32(40).int32(e.primaryTraceClock),null!=e.snapshotIntervalMs&&Object.hasOwnProperty.call(e,"snapshotIntervalMs")&&t.uint32(48).uint32(e.snapshotIntervalMs),null!=e.preferSuspendClockForSnapshot&&Object.hasOwnProperty.call(e,"preferSuspendClockForSnapshot")&&t.uint32(56).bool(e.preferSuspendClockForSnapshot),null!=e.disableChunkUsageHistograms&&Object.hasOwnProperty.call(e,"disableChunkUsageHistograms")&&t.uint32(64).bool(e.disableChunkUsageHistograms),t},y.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TraceConfig.BuiltinDataSource;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.disableClockSnapshotting=e.bool();break;case 2:n.disableTraceConfig=e.bool();break;case 3:n.disableSystemInfo=e.bool();break;case 4:n.disableServiceEvents=e.bool();break;case 5:n.primaryTraceClock=e.int32();break;case 6:n.snapshotIntervalMs=e.uint32();break;case 7:n.preferSuspendClockForSnapshot=e.bool();break;case 8:n.disableChunkUsageHistograms=e.bool();break;default:e.skipType(7&a)}}return n},y.fromObject=function(e){if(e instanceof s.perfetto.protos.TraceConfig.BuiltinDataSource)return e;var t=new s.perfetto.protos.TraceConfig.BuiltinDataSource;switch(null!=e.disableClockSnapshotting&&(t.disableClockSnapshotting=Boolean(e.disableClockSnapshotting)),null!=e.disableTraceConfig&&(t.disableTraceConfig=Boolean(e.disableTraceConfig)),null!=e.disableSystemInfo&&(t.disableSystemInfo=Boolean(e.disableSystemInfo)),null!=e.disableServiceEvents&&(t.disableServiceEvents=Boolean(e.disableServiceEvents)),e.primaryTraceClock){default:"number"==typeof e.primaryTraceClock&&(t.primaryTraceClock=e.primaryTraceClock);break;case"BUILTIN_CLOCK_UNKNOWN":case 0:t.primaryTraceClock=0;break;case"BUILTIN_CLOCK_REALTIME":case 1:t.primaryTraceClock=1;break;case"BUILTIN_CLOCK_REALTIME_COARSE":case 2:t.primaryTraceClock=2;break;case"BUILTIN_CLOCK_MONOTONIC":case 3:t.primaryTraceClock=3;break;case"BUILTIN_CLOCK_MONOTONIC_COARSE":case 4:t.primaryTraceClock=4;break;case"BUILTIN_CLOCK_MONOTONIC_RAW":case 5:t.primaryTraceClock=5;break;case"BUILTIN_CLOCK_BOOTTIME":case 6:t.primaryTraceClock=6;break;case"BUILTIN_CLOCK_TSC":case 9:t.primaryTraceClock=9;break;case"BUILTIN_CLOCK_MAX_ID":case 63:t.primaryTraceClock=63}return null!=e.snapshotIntervalMs&&(t.snapshotIntervalMs=e.snapshotIntervalMs>>>0),null!=e.preferSuspendClockForSnapshot&&(t.preferSuspendClockForSnapshot=Boolean(e.preferSuspendClockForSnapshot)),null!=e.disableChunkUsageHistograms&&(t.disableChunkUsageHistograms=Boolean(e.disableChunkUsageHistograms)),t},y.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.disableClockSnapshotting=!1,r.disableTraceConfig=!1,r.disableSystemInfo=!1,r.disableServiceEvents=!1,r.primaryTraceClock=t.enums===String?"BUILTIN_CLOCK_UNKNOWN":0,r.snapshotIntervalMs=0,r.preferSuspendClockForSnapshot=!1,r.disableChunkUsageHistograms=!1),null!=e.disableClockSnapshotting&&e.hasOwnProperty("disableClockSnapshotting")&&(r.disableClockSnapshotting=e.disableClockSnapshotting),null!=e.disableTraceConfig&&e.hasOwnProperty("disableTraceConfig")&&(r.disableTraceConfig=e.disableTraceConfig),null!=e.disableSystemInfo&&e.hasOwnProperty("disableSystemInfo")&&(r.disableSystemInfo=e.disableSystemInfo),null!=e.disableServiceEvents&&e.hasOwnProperty("disableServiceEvents")&&(r.disableServiceEvents=e.disableServiceEvents),null!=e.primaryTraceClock&&e.hasOwnProperty("primaryTraceClock")&&(r.primaryTraceClock=t.enums!==String||void 0===s.perfetto.protos.BuiltinClock[e.primaryTraceClock]?e.primaryTraceClock:s.perfetto.protos.BuiltinClock[e.primaryTraceClock]),null!=e.snapshotIntervalMs&&e.hasOwnProperty("snapshotIntervalMs")&&(r.snapshotIntervalMs=e.snapshotIntervalMs),null!=e.preferSuspendClockForSnapshot&&e.hasOwnProperty("preferSuspendClockForSnapshot")&&(r.preferSuspendClockForSnapshot=e.preferSuspendClockForSnapshot),null!=e.disableChunkUsageHistograms&&e.hasOwnProperty("disableChunkUsageHistograms")&&(r.disableChunkUsageHistograms=e.disableChunkUsageHistograms),r},y.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},y.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TraceConfig.BuiltinDataSource"},y),_.LockdownModeOperation=(t={},(e=Object.create(t))[t[0]="LOCKDOWN_UNCHANGED"]=0,e[t[1]="LOCKDOWN_CLEAR"]=1,e[t[2]="LOCKDOWN_SET"]=2,e),_.ProducerConfig=(Re.prototype.producerName="",Re.prototype.shmSizeKb=0,Re.prototype.pageSizeKb=0,Re.create=function(e){return new Re(e)},Re.encode=function(e,t){return t=t||a.create(),null!=e.producerName&&Object.hasOwnProperty.call(e,"producerName")&&t.uint32(10).string(e.producerName),null!=e.shmSizeKb&&Object.hasOwnProperty.call(e,"shmSizeKb")&&t.uint32(16).uint32(e.shmSizeKb),null!=e.pageSizeKb&&Object.hasOwnProperty.call(e,"pageSizeKb")&&t.uint32(24).uint32(e.pageSizeKb),t},Re.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TraceConfig.ProducerConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.producerName=e.string();break;case 2:n.shmSizeKb=e.uint32();break;case 3:n.pageSizeKb=e.uint32();break;default:e.skipType(7&a)}}return n},Re.fromObject=function(e){var t;return e instanceof s.perfetto.protos.TraceConfig.ProducerConfig?e:(t=new s.perfetto.protos.TraceConfig.ProducerConfig,null!=e.producerName&&(t.producerName=String(e.producerName)),null!=e.shmSizeKb&&(t.shmSizeKb=e.shmSizeKb>>>0),null!=e.pageSizeKb&&(t.pageSizeKb=e.pageSizeKb>>>0),t)},Re.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.producerName="",r.shmSizeKb=0,r.pageSizeKb=0),null!=e.producerName&&e.hasOwnProperty("producerName")&&(r.producerName=e.producerName),null!=e.shmSizeKb&&e.hasOwnProperty("shmSizeKb")&&(r.shmSizeKb=e.shmSizeKb),null!=e.pageSizeKb&&e.hasOwnProperty("pageSizeKb")&&(r.pageSizeKb=e.pageSizeKb),r},Re.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Re.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TraceConfig.ProducerConfig"},Re),_.StatsdMetadata=(Ie.prototype.triggeringAlertId=i.Long?i.Long.fromBits(0,0,!1):0,Ie.prototype.triggeringConfigUid=0,Ie.prototype.triggeringConfigId=i.Long?i.Long.fromBits(0,0,!1):0,Ie.prototype.triggeringSubscriptionId=i.Long?i.Long.fromBits(0,0,!1):0,Ie.create=function(e){return new Ie(e)},Ie.encode=function(e,t){return t=t||a.create(),null!=e.triggeringAlertId&&Object.hasOwnProperty.call(e,"triggeringAlertId")&&t.uint32(8).int64(e.triggeringAlertId),null!=e.triggeringConfigUid&&Object.hasOwnProperty.call(e,"triggeringConfigUid")&&t.uint32(16).int32(e.triggeringConfigUid),null!=e.triggeringConfigId&&Object.hasOwnProperty.call(e,"triggeringConfigId")&&t.uint32(24).int64(e.triggeringConfigId),null!=e.triggeringSubscriptionId&&Object.hasOwnProperty.call(e,"triggeringSubscriptionId")&&t.uint32(32).int64(e.triggeringSubscriptionId),t},Ie.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TraceConfig.StatsdMetadata;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.triggeringAlertId=e.int64();break;case 2:n.triggeringConfigUid=e.int32();break;case 3:n.triggeringConfigId=e.int64();break;case 4:n.triggeringSubscriptionId=e.int64();break;default:e.skipType(7&a)}}return n},Ie.fromObject=function(e){var t;return e instanceof s.perfetto.protos.TraceConfig.StatsdMetadata?e:(t=new s.perfetto.protos.TraceConfig.StatsdMetadata,null!=e.triggeringAlertId&&(i.Long?(t.triggeringAlertId=i.Long.fromValue(e.triggeringAlertId)).unsigned=!1:"string"==typeof e.triggeringAlertId?t.triggeringAlertId=parseInt(e.triggeringAlertId,10):"number"==typeof e.triggeringAlertId?t.triggeringAlertId=e.triggeringAlertId:"object"==typeof e.triggeringAlertId&&(t.triggeringAlertId=new i.LongBits(e.triggeringAlertId.low>>>0,e.triggeringAlertId.high>>>0).toNumber())),null!=e.triggeringConfigUid&&(t.triggeringConfigUid=0|e.triggeringConfigUid),null!=e.triggeringConfigId&&(i.Long?(t.triggeringConfigId=i.Long.fromValue(e.triggeringConfigId)).unsigned=!1:"string"==typeof e.triggeringConfigId?t.triggeringConfigId=parseInt(e.triggeringConfigId,10):"number"==typeof e.triggeringConfigId?t.triggeringConfigId=e.triggeringConfigId:"object"==typeof e.triggeringConfigId&&(t.triggeringConfigId=new i.LongBits(e.triggeringConfigId.low>>>0,e.triggeringConfigId.high>>>0).toNumber())),null!=e.triggeringSubscriptionId&&(i.Long?(t.triggeringSubscriptionId=i.Long.fromValue(e.triggeringSubscriptionId)).unsigned=!1:"string"==typeof e.triggeringSubscriptionId?t.triggeringSubscriptionId=parseInt(e.triggeringSubscriptionId,10):"number"==typeof e.triggeringSubscriptionId?t.triggeringSubscriptionId=e.triggeringSubscriptionId:"object"==typeof e.triggeringSubscriptionId&&(t.triggeringSubscriptionId=new i.LongBits(e.triggeringSubscriptionId.low>>>0,e.triggeringSubscriptionId.high>>>0).toNumber())),t)},Ie.toObject=function(e,t){var r,n={};return(t=t||{}).defaults&&(i.Long?(r=new i.Long(0,0,!1),n.triggeringAlertId=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.triggeringAlertId=t.longs===String?"0":0,n.triggeringConfigUid=0,i.Long?(r=new i.Long(0,0,!1),n.triggeringConfigId=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.triggeringConfigId=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!1),n.triggeringSubscriptionId=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.triggeringSubscriptionId=t.longs===String?"0":0),null!=e.triggeringAlertId&&e.hasOwnProperty("triggeringAlertId")&&("number"==typeof e.triggeringAlertId?n.triggeringAlertId=t.longs===String?String(e.triggeringAlertId):e.triggeringAlertId:n.triggeringAlertId=t.longs===String?i.Long.prototype.toString.call(e.triggeringAlertId):t.longs===Number?new i.LongBits(e.triggeringAlertId.low>>>0,e.triggeringAlertId.high>>>0).toNumber():e.triggeringAlertId),null!=e.triggeringConfigUid&&e.hasOwnProperty("triggeringConfigUid")&&(n.triggeringConfigUid=e.triggeringConfigUid),null!=e.triggeringConfigId&&e.hasOwnProperty("triggeringConfigId")&&("number"==typeof e.triggeringConfigId?n.triggeringConfigId=t.longs===String?String(e.triggeringConfigId):e.triggeringConfigId:n.triggeringConfigId=t.longs===String?i.Long.prototype.toString.call(e.triggeringConfigId):t.longs===Number?new i.LongBits(e.triggeringConfigId.low>>>0,e.triggeringConfigId.high>>>0).toNumber():e.triggeringConfigId),null!=e.triggeringSubscriptionId&&e.hasOwnProperty("triggeringSubscriptionId")&&("number"==typeof e.triggeringSubscriptionId?n.triggeringSubscriptionId=t.longs===String?String(e.triggeringSubscriptionId):e.triggeringSubscriptionId:n.triggeringSubscriptionId=t.longs===String?i.Long.prototype.toString.call(e.triggeringSubscriptionId):t.longs===Number?new i.LongBits(e.triggeringSubscriptionId.low>>>0,e.triggeringSubscriptionId.high>>>0).toNumber():e.triggeringSubscriptionId),n},Ie.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Ie.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TraceConfig.StatsdMetadata"},Ie),_.GuardrailOverrides=(Me.prototype.maxUploadPerDayBytes=i.Long?i.Long.fromBits(0,0,!0):0,Me.prototype.maxTracingBufferSizeKb=0,Me.create=function(e){return new Me(e)},Me.encode=function(e,t){return t=t||a.create(),null!=e.maxUploadPerDayBytes&&Object.hasOwnProperty.call(e,"maxUploadPerDayBytes")&&t.uint32(8).uint64(e.maxUploadPerDayBytes),null!=e.maxTracingBufferSizeKb&&Object.hasOwnProperty.call(e,"maxTracingBufferSizeKb")&&t.uint32(16).uint32(e.maxTracingBufferSizeKb),t},Me.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TraceConfig.GuardrailOverrides;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.maxUploadPerDayBytes=e.uint64();break;case 2:n.maxTracingBufferSizeKb=e.uint32();break;default:e.skipType(7&a)}}return n},Me.fromObject=function(e){var t;return e instanceof s.perfetto.protos.TraceConfig.GuardrailOverrides?e:(t=new s.perfetto.protos.TraceConfig.GuardrailOverrides,null!=e.maxUploadPerDayBytes&&(i.Long?(t.maxUploadPerDayBytes=i.Long.fromValue(e.maxUploadPerDayBytes)).unsigned=!0:"string"==typeof e.maxUploadPerDayBytes?t.maxUploadPerDayBytes=parseInt(e.maxUploadPerDayBytes,10):"number"==typeof e.maxUploadPerDayBytes?t.maxUploadPerDayBytes=e.maxUploadPerDayBytes:"object"==typeof e.maxUploadPerDayBytes&&(t.maxUploadPerDayBytes=new i.LongBits(e.maxUploadPerDayBytes.low>>>0,e.maxUploadPerDayBytes.high>>>0).toNumber(!0))),null!=e.maxTracingBufferSizeKb&&(t.maxTracingBufferSizeKb=e.maxTracingBufferSizeKb>>>0),t)},Me.toObject=function(e,t){var r,n={};return(t=t||{}).defaults&&(i.Long?(r=new i.Long(0,0,!0),n.maxUploadPerDayBytes=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.maxUploadPerDayBytes=t.longs===String?"0":0,n.maxTracingBufferSizeKb=0),null!=e.maxUploadPerDayBytes&&e.hasOwnProperty("maxUploadPerDayBytes")&&("number"==typeof e.maxUploadPerDayBytes?n.maxUploadPerDayBytes=t.longs===String?String(e.maxUploadPerDayBytes):e.maxUploadPerDayBytes:n.maxUploadPerDayBytes=t.longs===String?i.Long.prototype.toString.call(e.maxUploadPerDayBytes):t.longs===Number?new i.LongBits(e.maxUploadPerDayBytes.low>>>0,e.maxUploadPerDayBytes.high>>>0).toNumber(!0):e.maxUploadPerDayBytes),null!=e.maxTracingBufferSizeKb&&e.hasOwnProperty("maxTracingBufferSizeKb")&&(n.maxTracingBufferSizeKb=e.maxTracingBufferSizeKb),n},Me.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Me.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TraceConfig.GuardrailOverrides"},Me),_.TriggerConfig=(Pe.prototype.triggerMode=0,Pe.prototype.useCloneSnapshotIfAvailable=!1,Pe.prototype.triggers=i.emptyArray,Pe.prototype.triggerTimeoutMs=0,Pe.create=function(e){return new Pe(e)},Pe.encode=function(e,t){if(t=t||a.create(),null!=e.triggerMode&&Object.hasOwnProperty.call(e,"triggerMode")&&t.uint32(8).int32(e.triggerMode),null!=e.triggers&&e.triggers.length)for(var r=0;r<e.triggers.length;++r)s.perfetto.protos.TraceConfig.TriggerConfig.Trigger.encode(e.triggers[r],t.uint32(18).fork()).ldelim();return null!=e.triggerTimeoutMs&&Object.hasOwnProperty.call(e,"triggerTimeoutMs")&&t.uint32(24).uint32(e.triggerTimeoutMs),null!=e.useCloneSnapshotIfAvailable&&Object.hasOwnProperty.call(e,"useCloneSnapshotIfAvailable")&&t.uint32(40).bool(e.useCloneSnapshotIfAvailable),t},Pe.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TraceConfig.TriggerConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.triggerMode=e.int32();break;case 5:n.useCloneSnapshotIfAvailable=e.bool();break;case 2:n.triggers&&n.triggers.length||(n.triggers=[]),n.triggers.push(s.perfetto.protos.TraceConfig.TriggerConfig.Trigger.decode(e,e.uint32()));break;case 3:n.triggerTimeoutMs=e.uint32();break;default:e.skipType(7&a)}}return n},Pe.fromObject=function(e){if(e instanceof s.perfetto.protos.TraceConfig.TriggerConfig)return e;var t=new s.perfetto.protos.TraceConfig.TriggerConfig;switch(e.triggerMode){default:"number"==typeof e.triggerMode&&(t.triggerMode=e.triggerMode);break;case"UNSPECIFIED":case 0:t.triggerMode=0;break;case"START_TRACING":case 1:t.triggerMode=1;break;case"STOP_TRACING":case 2:t.triggerMode=2;break;case"CLONE_SNAPSHOT":case 4:t.triggerMode=4}if(null!=e.useCloneSnapshotIfAvailable&&(t.useCloneSnapshotIfAvailable=Boolean(e.useCloneSnapshotIfAvailable)),e.triggers){if(!Array.isArray(e.triggers))throw TypeError(".perfetto.protos.TraceConfig.TriggerConfig.triggers: array expected");t.triggers=[];for(var r=0;r<e.triggers.length;++r){if("object"!=typeof e.triggers[r])throw TypeError(".perfetto.protos.TraceConfig.TriggerConfig.triggers: object expected");t.triggers[r]=s.perfetto.protos.TraceConfig.TriggerConfig.Trigger.fromObject(e.triggers[r])}}return null!=e.triggerTimeoutMs&&(t.triggerTimeoutMs=e.triggerTimeoutMs>>>0),t},Pe.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.triggers=[]),t.defaults&&(r.triggerMode=t.enums===String?"UNSPECIFIED":0,r.triggerTimeoutMs=0,r.useCloneSnapshotIfAvailable=!1),null!=e.triggerMode&&e.hasOwnProperty("triggerMode")&&(r.triggerMode=t.enums!==String||void 0===s.perfetto.protos.TraceConfig.TriggerConfig.TriggerMode[e.triggerMode]?e.triggerMode:s.perfetto.protos.TraceConfig.TriggerConfig.TriggerMode[e.triggerMode]),e.triggers&&e.triggers.length){r.triggers=[];for(var n=0;n<e.triggers.length;++n)r.triggers[n]=s.perfetto.protos.TraceConfig.TriggerConfig.Trigger.toObject(e.triggers[n],t)}return null!=e.triggerTimeoutMs&&e.hasOwnProperty("triggerTimeoutMs")&&(r.triggerTimeoutMs=e.triggerTimeoutMs),null!=e.useCloneSnapshotIfAvailable&&e.hasOwnProperty("useCloneSnapshotIfAvailable")&&(r.useCloneSnapshotIfAvailable=e.useCloneSnapshotIfAvailable),r},Pe.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Pe.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TraceConfig.TriggerConfig"},Pe.TriggerMode=(t={},(e=Object.create(t))[t[0]="UNSPECIFIED"]=0,e[t[1]="START_TRACING"]=1,e[t[2]="STOP_TRACING"]=2,e[t[4]="CLONE_SNAPSHOT"]=4,e),Pe.Trigger=(Ne.prototype.name="",Ne.prototype.producerNameRegex="",Ne.prototype.stopDelayMs=0,Ne.prototype.maxPer_24H=0,Ne.prototype.skipProbability=0,Ne.create=function(e){return new Ne(e)},Ne.encode=function(e,t){return t=t||a.create(),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.producerNameRegex&&Object.hasOwnProperty.call(e,"producerNameRegex")&&t.uint32(18).string(e.producerNameRegex),null!=e.stopDelayMs&&Object.hasOwnProperty.call(e,"stopDelayMs")&&t.uint32(24).uint32(e.stopDelayMs),null!=e.maxPer_24H&&Object.hasOwnProperty.call(e,"maxPer_24H")&&t.uint32(32).uint32(e.maxPer_24H),null!=e.skipProbability&&Object.hasOwnProperty.call(e,"skipProbability")&&t.uint32(41).double(e.skipProbability),t},Ne.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TraceConfig.TriggerConfig.Trigger;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.name=e.string();break;case 2:n.producerNameRegex=e.string();break;case 3:n.stopDelayMs=e.uint32();break;case 4:n.maxPer_24H=e.uint32();break;case 5:n.skipProbability=e.double();break;default:e.skipType(7&a)}}return n},Ne.fromObject=function(e){var t;return e instanceof s.perfetto.protos.TraceConfig.TriggerConfig.Trigger?e:(t=new s.perfetto.protos.TraceConfig.TriggerConfig.Trigger,null!=e.name&&(t.name=String(e.name)),null!=e.producerNameRegex&&(t.producerNameRegex=String(e.producerNameRegex)),null!=e.stopDelayMs&&(t.stopDelayMs=e.stopDelayMs>>>0),null!=e.maxPer_24H&&(t.maxPer_24H=e.maxPer_24H>>>0),null!=e.skipProbability&&(t.skipProbability=Number(e.skipProbability)),t)},Ne.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.name="",r.producerNameRegex="",r.stopDelayMs=0,r.maxPer_24H=0,r.skipProbability=0),null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.producerNameRegex&&e.hasOwnProperty("producerNameRegex")&&(r.producerNameRegex=e.producerNameRegex),null!=e.stopDelayMs&&e.hasOwnProperty("stopDelayMs")&&(r.stopDelayMs=e.stopDelayMs),null!=e.maxPer_24H&&e.hasOwnProperty("maxPer_24H")&&(r.maxPer_24H=e.maxPer_24H),null!=e.skipProbability&&e.hasOwnProperty("skipProbability")&&(r.skipProbability=t.json&&!isFinite(e.skipProbability)?String(e.skipProbability):e.skipProbability),r},Ne.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Ne.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TraceConfig.TriggerConfig.Trigger"},Ne),Pe),_.IncrementalStateConfig=(De.prototype.clearPeriodMs=0,De.create=function(e){return new De(e)},De.encode=function(e,t){return t=t||a.create(),null!=e.clearPeriodMs&&Object.hasOwnProperty.call(e,"clearPeriodMs")&&t.uint32(8).uint32(e.clearPeriodMs),t},De.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TraceConfig.IncrementalStateConfig;e.pos<r;){var a=e.uint32();a>>>3==1?n.clearPeriodMs=e.uint32():e.skipType(7&a)}return n},De.fromObject=function(e){var t;return e instanceof s.perfetto.protos.TraceConfig.IncrementalStateConfig?e:(t=new s.perfetto.protos.TraceConfig.IncrementalStateConfig,null!=e.clearPeriodMs&&(t.clearPeriodMs=e.clearPeriodMs>>>0),t)},De.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.clearPeriodMs=0),null!=e.clearPeriodMs&&e.hasOwnProperty("clearPeriodMs")&&(r.clearPeriodMs=e.clearPeriodMs),r},De.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},De.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TraceConfig.IncrementalStateConfig"},De),_.CompressionType=(t={},(e=Object.create(t))[t[0]="COMPRESSION_TYPE_UNSPECIFIED"]=0,e[t[1]="COMPRESSION_TYPE_DEFLATE"]=1,e),_.IncidentReportConfig=(xe.prototype.destinationPackage="",xe.prototype.destinationClass="",xe.prototype.privacyLevel=0,xe.prototype.skipIncidentd=!1,xe.prototype.skipDropbox=!1,xe.create=function(e){return new xe(e)},xe.encode=function(e,t){return t=t||a.create(),null!=e.destinationPackage&&Object.hasOwnProperty.call(e,"destinationPackage")&&t.uint32(10).string(e.destinationPackage),null!=e.destinationClass&&Object.hasOwnProperty.call(e,"destinationClass")&&t.uint32(18).string(e.destinationClass),null!=e.privacyLevel&&Object.hasOwnProperty.call(e,"privacyLevel")&&t.uint32(24).int32(e.privacyLevel),null!=e.skipDropbox&&Object.hasOwnProperty.call(e,"skipDropbox")&&t.uint32(32).bool(e.skipDropbox),null!=e.skipIncidentd&&Object.hasOwnProperty.call(e,"skipIncidentd")&&t.uint32(40).bool(e.skipIncidentd),t},xe.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TraceConfig.IncidentReportConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.destinationPackage=e.string();break;case 2:n.destinationClass=e.string();break;case 3:n.privacyLevel=e.int32();break;case 5:n.skipIncidentd=e.bool();break;case 4:n.skipDropbox=e.bool();break;default:e.skipType(7&a)}}return n},xe.fromObject=function(e){var t;return e instanceof s.perfetto.protos.TraceConfig.IncidentReportConfig?e:(t=new s.perfetto.protos.TraceConfig.IncidentReportConfig,null!=e.destinationPackage&&(t.destinationPackage=String(e.destinationPackage)),null!=e.destinationClass&&(t.destinationClass=String(e.destinationClass)),null!=e.privacyLevel&&(t.privacyLevel=0|e.privacyLevel),null!=e.skipIncidentd&&(t.skipIncidentd=Boolean(e.skipIncidentd)),null!=e.skipDropbox&&(t.skipDropbox=Boolean(e.skipDropbox)),t)},xe.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.destinationPackage="",r.destinationClass="",r.privacyLevel=0,r.skipDropbox=!1,r.skipIncidentd=!1),null!=e.destinationPackage&&e.hasOwnProperty("destinationPackage")&&(r.destinationPackage=e.destinationPackage),null!=e.destinationClass&&e.hasOwnProperty("destinationClass")&&(r.destinationClass=e.destinationClass),null!=e.privacyLevel&&e.hasOwnProperty("privacyLevel")&&(r.privacyLevel=e.privacyLevel),null!=e.skipDropbox&&e.hasOwnProperty("skipDropbox")&&(r.skipDropbox=e.skipDropbox),null!=e.skipIncidentd&&e.hasOwnProperty("skipIncidentd")&&(r.skipIncidentd=e.skipIncidentd),r},xe.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},xe.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TraceConfig.IncidentReportConfig"},xe),_.StatsdLogging=(t={},(e=Object.create(t))[t[0]="STATSD_LOGGING_UNSPECIFIED"]=0,e[t[1]="STATSD_LOGGING_ENABLED"]=1,e[t[2]="STATSD_LOGGING_DISABLED"]=2,e),_.TraceFilter=(Le.prototype.bytecode=i.newBuffer([]),Le.prototype.bytecodeV2=i.newBuffer([]),Le.prototype.stringFilterChain=null,Le.create=function(e){return new Le(e)},Le.encode=function(e,t){return t=t||a.create(),null!=e.bytecode&&Object.hasOwnProperty.call(e,"bytecode")&&t.uint32(10).bytes(e.bytecode),null!=e.bytecodeV2&&Object.hasOwnProperty.call(e,"bytecodeV2")&&t.uint32(18).bytes(e.bytecodeV2),null!=e.stringFilterChain&&Object.hasOwnProperty.call(e,"stringFilterChain")&&s.perfetto.protos.TraceConfig.TraceFilter.StringFilterChain.encode(e.stringFilterChain,t.uint32(26).fork()).ldelim(),t},Le.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TraceConfig.TraceFilter;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.bytecode=e.bytes();break;case 2:n.bytecodeV2=e.bytes();break;case 3:n.stringFilterChain=s.perfetto.protos.TraceConfig.TraceFilter.StringFilterChain.decode(e,e.uint32());break;default:e.skipType(7&a)}}return n},Le.fromObject=function(e){if(e instanceof s.perfetto.protos.TraceConfig.TraceFilter)return e;var t=new s.perfetto.protos.TraceConfig.TraceFilter;if(null!=e.bytecode&&("string"==typeof e.bytecode?i.base64.decode(e.bytecode,t.bytecode=i.newBuffer(i.base64.length(e.bytecode)),0):0<=e.bytecode.length&&(t.bytecode=e.bytecode)),null!=e.bytecodeV2&&("string"==typeof e.bytecodeV2?i.base64.decode(e.bytecodeV2,t.bytecodeV2=i.newBuffer(i.base64.length(e.bytecodeV2)),0):0<=e.bytecodeV2.length&&(t.bytecodeV2=e.bytecodeV2)),null!=e.stringFilterChain){if("object"!=typeof e.stringFilterChain)throw TypeError(".perfetto.protos.TraceConfig.TraceFilter.stringFilterChain: object expected");t.stringFilterChain=s.perfetto.protos.TraceConfig.TraceFilter.StringFilterChain.fromObject(e.stringFilterChain)}return t},Le.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(t.bytes===String?r.bytecode="":(r.bytecode=[],t.bytes!==Array&&(r.bytecode=i.newBuffer(r.bytecode))),t.bytes===String?r.bytecodeV2="":(r.bytecodeV2=[],t.bytes!==Array&&(r.bytecodeV2=i.newBuffer(r.bytecodeV2))),r.stringFilterChain=null),null!=e.bytecode&&e.hasOwnProperty("bytecode")&&(r.bytecode=t.bytes===String?i.base64.encode(e.bytecode,0,e.bytecode.length):t.bytes===Array?Array.prototype.slice.call(e.bytecode):e.bytecode),null!=e.bytecodeV2&&e.hasOwnProperty("bytecodeV2")&&(r.bytecodeV2=t.bytes===String?i.base64.encode(e.bytecodeV2,0,e.bytecodeV2.length):t.bytes===Array?Array.prototype.slice.call(e.bytecodeV2):e.bytecodeV2),null!=e.stringFilterChain&&e.hasOwnProperty("stringFilterChain")&&(r.stringFilterChain=s.perfetto.protos.TraceConfig.TraceFilter.StringFilterChain.toObject(e.stringFilterChain,t)),r},Le.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Le.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TraceConfig.TraceFilter"},Le.StringFilterPolicy=(t={},(e=Object.create(t))[t[0]="SFP_UNSPECIFIED"]=0,e[t[1]="SFP_MATCH_REDACT_GROUPS"]=1,e[t[2]="SFP_ATRACE_MATCH_REDACT_GROUPS"]=2,e[t[3]="SFP_MATCH_BREAK"]=3,e[t[4]="SFP_ATRACE_MATCH_BREAK"]=4,e[t[5]="SFP_ATRACE_REPEATED_SEARCH_REDACT_GROUPS"]=5,e),Le.StringFilterRule=(Fe.prototype.policy=0,Fe.prototype.regexPattern="",Fe.prototype.atracePayloadStartsWith="",Fe.create=function(e){return new Fe(e)},Fe.encode=function(e,t){return t=t||a.create(),null!=e.policy&&Object.hasOwnProperty.call(e,"policy")&&t.uint32(8).int32(e.policy),null!=e.regexPattern&&Object.hasOwnProperty.call(e,"regexPattern")&&t.uint32(18).string(e.regexPattern),null!=e.atracePayloadStartsWith&&Object.hasOwnProperty.call(e,"atracePayloadStartsWith")&&t.uint32(26).string(e.atracePayloadStartsWith),t},Fe.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TraceConfig.TraceFilter.StringFilterRule;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.policy=e.int32();break;case 2:n.regexPattern=e.string();break;case 3:n.atracePayloadStartsWith=e.string();break;default:e.skipType(7&a)}}return n},Fe.fromObject=function(e){if(e instanceof s.perfetto.protos.TraceConfig.TraceFilter.StringFilterRule)return e;var t=new s.perfetto.protos.TraceConfig.TraceFilter.StringFilterRule;switch(e.policy){default:"number"==typeof e.policy&&(t.policy=e.policy);break;case"SFP_UNSPECIFIED":case 0:t.policy=0;break;case"SFP_MATCH_REDACT_GROUPS":case 1:t.policy=1;break;case"SFP_ATRACE_MATCH_REDACT_GROUPS":case 2:t.policy=2;break;case"SFP_MATCH_BREAK":case 3:t.policy=3;break;case"SFP_ATRACE_MATCH_BREAK":case 4:t.policy=4;break;case"SFP_ATRACE_REPEATED_SEARCH_REDACT_GROUPS":case 5:t.policy=5}return null!=e.regexPattern&&(t.regexPattern=String(e.regexPattern)),null!=e.atracePayloadStartsWith&&(t.atracePayloadStartsWith=String(e.atracePayloadStartsWith)),t},Fe.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.policy=t.enums===String?"SFP_UNSPECIFIED":0,r.regexPattern="",r.atracePayloadStartsWith=""),null!=e.policy&&e.hasOwnProperty("policy")&&(r.policy=t.enums!==String||void 0===s.perfetto.protos.TraceConfig.TraceFilter.StringFilterPolicy[e.policy]?e.policy:s.perfetto.protos.TraceConfig.TraceFilter.StringFilterPolicy[e.policy]),null!=e.regexPattern&&e.hasOwnProperty("regexPattern")&&(r.regexPattern=e.regexPattern),null!=e.atracePayloadStartsWith&&e.hasOwnProperty("atracePayloadStartsWith")&&(r.atracePayloadStartsWith=e.atracePayloadStartsWith),r},Fe.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Fe.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TraceConfig.TraceFilter.StringFilterRule"},Fe),Le.StringFilterChain=(Ue.prototype.rules=i.emptyArray,Ue.create=function(e){return new Ue(e)},Ue.encode=function(e,t){if(t=t||a.create(),null!=e.rules&&e.rules.length)for(var r=0;r<e.rules.length;++r)s.perfetto.protos.TraceConfig.TraceFilter.StringFilterRule.encode(e.rules[r],t.uint32(10).fork()).ldelim();return t},Ue.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TraceConfig.TraceFilter.StringFilterChain;e.pos<r;){var a=e.uint32();a>>>3==1?(n.rules&&n.rules.length||(n.rules=[]),n.rules.push(s.perfetto.protos.TraceConfig.TraceFilter.StringFilterRule.decode(e,e.uint32()))):e.skipType(7&a)}return n},Ue.fromObject=function(e){if(e instanceof s.perfetto.protos.TraceConfig.TraceFilter.StringFilterChain)return e;var t=new s.perfetto.protos.TraceConfig.TraceFilter.StringFilterChain;if(e.rules){if(!Array.isArray(e.rules))throw TypeError(".perfetto.protos.TraceConfig.TraceFilter.StringFilterChain.rules: array expected");t.rules=[];for(var r=0;r<e.rules.length;++r){if("object"!=typeof e.rules[r])throw TypeError(".perfetto.protos.TraceConfig.TraceFilter.StringFilterChain.rules: object expected");t.rules[r]=s.perfetto.protos.TraceConfig.TraceFilter.StringFilterRule.fromObject(e.rules[r])}}return t},Ue.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.rules=[]),e.rules&&e.rules.length){r.rules=[];for(var n=0;n<e.rules.length;++n)r.rules[n]=s.perfetto.protos.TraceConfig.TraceFilter.StringFilterRule.toObject(e.rules[n],t)}return r},Ue.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Ue.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TraceConfig.TraceFilter.StringFilterChain"},Ue),Le),_.AndroidReportConfig=(Be.prototype.reporterServicePackage="",Be.prototype.reporterServiceClass="",Be.prototype.skipReport=!1,Be.prototype.usePipeInFrameworkForTesting=!1,Be.create=function(e){return new Be(e)},Be.encode=function(e,t){return t=t||a.create(),null!=e.reporterServicePackage&&Object.hasOwnProperty.call(e,"reporterServicePackage")&&t.uint32(10).string(e.reporterServicePackage),null!=e.reporterServiceClass&&Object.hasOwnProperty.call(e,"reporterServiceClass")&&t.uint32(18).string(e.reporterServiceClass),null!=e.skipReport&&Object.hasOwnProperty.call(e,"skipReport")&&t.uint32(24).bool(e.skipReport),null!=e.usePipeInFrameworkForTesting&&Object.hasOwnProperty.call(e,"usePipeInFrameworkForTesting")&&t.uint32(32).bool(e.usePipeInFrameworkForTesting),t},Be.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TraceConfig.AndroidReportConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.reporterServicePackage=e.string();break;case 2:n.reporterServiceClass=e.string();break;case 3:n.skipReport=e.bool();break;case 4:n.usePipeInFrameworkForTesting=e.bool();break;default:e.skipType(7&a)}}return n},Be.fromObject=function(e){var t;return e instanceof s.perfetto.protos.TraceConfig.AndroidReportConfig?e:(t=new s.perfetto.protos.TraceConfig.AndroidReportConfig,null!=e.reporterServicePackage&&(t.reporterServicePackage=String(e.reporterServicePackage)),null!=e.reporterServiceClass&&(t.reporterServiceClass=String(e.reporterServiceClass)),null!=e.skipReport&&(t.skipReport=Boolean(e.skipReport)),null!=e.usePipeInFrameworkForTesting&&(t.usePipeInFrameworkForTesting=Boolean(e.usePipeInFrameworkForTesting)),t)},Be.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.reporterServicePackage="",r.reporterServiceClass="",r.skipReport=!1,r.usePipeInFrameworkForTesting=!1),null!=e.reporterServicePackage&&e.hasOwnProperty("reporterServicePackage")&&(r.reporterServicePackage=e.reporterServicePackage),null!=e.reporterServiceClass&&e.hasOwnProperty("reporterServiceClass")&&(r.reporterServiceClass=e.reporterServiceClass),null!=e.skipReport&&e.hasOwnProperty("skipReport")&&(r.skipReport=e.skipReport),null!=e.usePipeInFrameworkForTesting&&e.hasOwnProperty("usePipeInFrameworkForTesting")&&(r.usePipeInFrameworkForTesting=e.usePipeInFrameworkForTesting),r},Be.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Be.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TraceConfig.AndroidReportConfig"},Be),_.CmdTraceStartDelay=(je.prototype.minDelayMs=0,je.prototype.maxDelayMs=0,je.create=function(e){return new je(e)},je.encode=function(e,t){return t=t||a.create(),null!=e.minDelayMs&&Object.hasOwnProperty.call(e,"minDelayMs")&&t.uint32(8).uint32(e.minDelayMs),null!=e.maxDelayMs&&Object.hasOwnProperty.call(e,"maxDelayMs")&&t.uint32(16).uint32(e.maxDelayMs),t},je.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TraceConfig.CmdTraceStartDelay;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.minDelayMs=e.uint32();break;case 2:n.maxDelayMs=e.uint32();break;default:e.skipType(7&a)}}return n},je.fromObject=function(e){var t;return e instanceof s.perfetto.protos.TraceConfig.CmdTraceStartDelay?e:(t=new s.perfetto.protos.TraceConfig.CmdTraceStartDelay,null!=e.minDelayMs&&(t.minDelayMs=e.minDelayMs>>>0),null!=e.maxDelayMs&&(t.maxDelayMs=e.maxDelayMs>>>0),t)},je.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.minDelayMs=0,r.maxDelayMs=0),null!=e.minDelayMs&&e.hasOwnProperty("minDelayMs")&&(r.minDelayMs=e.minDelayMs),null!=e.maxDelayMs&&e.hasOwnProperty("maxDelayMs")&&(r.maxDelayMs=e.maxDelayMs),r},je.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},je.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TraceConfig.CmdTraceStartDelay"},je),_.SessionSemaphore=(He.prototype.name="",He.prototype.maxOtherSessionCount=i.Long?i.Long.fromBits(0,0,!0):0,He.create=function(e){return new He(e)},He.encode=function(e,t){return t=t||a.create(),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.maxOtherSessionCount&&Object.hasOwnProperty.call(e,"maxOtherSessionCount")&&t.uint32(16).uint64(e.maxOtherSessionCount),t},He.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TraceConfig.SessionSemaphore;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.name=e.string();break;case 2:n.maxOtherSessionCount=e.uint64();break;default:e.skipType(7&a)}}return n},He.fromObject=function(e){var t;return e instanceof s.perfetto.protos.TraceConfig.SessionSemaphore?e:(t=new s.perfetto.protos.TraceConfig.SessionSemaphore,null!=e.name&&(t.name=String(e.name)),null!=e.maxOtherSessionCount&&(i.Long?(t.maxOtherSessionCount=i.Long.fromValue(e.maxOtherSessionCount)).unsigned=!0:"string"==typeof e.maxOtherSessionCount?t.maxOtherSessionCount=parseInt(e.maxOtherSessionCount,10):"number"==typeof e.maxOtherSessionCount?t.maxOtherSessionCount=e.maxOtherSessionCount:"object"==typeof e.maxOtherSessionCount&&(t.maxOtherSessionCount=new i.LongBits(e.maxOtherSessionCount.low>>>0,e.maxOtherSessionCount.high>>>0).toNumber(!0))),t)},He.toObject=function(e,t){var r,n={};return(t=t||{}).defaults&&(n.name="",i.Long?(r=new i.Long(0,0,!0),n.maxOtherSessionCount=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.maxOtherSessionCount=t.longs===String?"0":0),null!=e.name&&e.hasOwnProperty("name")&&(n.name=e.name),null!=e.maxOtherSessionCount&&e.hasOwnProperty("maxOtherSessionCount")&&("number"==typeof e.maxOtherSessionCount?n.maxOtherSessionCount=t.longs===String?String(e.maxOtherSessionCount):e.maxOtherSessionCount:n.maxOtherSessionCount=t.longs===String?i.Long.prototype.toString.call(e.maxOtherSessionCount):t.longs===Number?new i.LongBits(e.maxOtherSessionCount.low>>>0,e.maxOtherSessionCount.high>>>0).toNumber(!0):e.maxOtherSessionCount),n},He.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},He.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TraceConfig.SessionSemaphore"},He),_),r.BuiltinClock=(t={},(e=Object.create(t))[t[0]="BUILTIN_CLOCK_UNKNOWN"]=0,e[t[1]="BUILTIN_CLOCK_REALTIME"]=1,e[t[2]="BUILTIN_CLOCK_REALTIME_COARSE"]=2,e[t[3]="BUILTIN_CLOCK_MONOTONIC"]=3,e[t[4]="BUILTIN_CLOCK_MONOTONIC_COARSE"]=4,e[t[5]="BUILTIN_CLOCK_MONOTONIC_RAW"]=5,e[t[6]="BUILTIN_CLOCK_BOOTTIME"]=6,e[t[9]="BUILTIN_CLOCK_TSC"]=9,e[t[63]="BUILTIN_CLOCK_MAX_ID"]=63,e),r.DataSourceConfig=(T.prototype.name="",T.prototype.targetBuffer=0,T.prototype.traceDurationMs=0,T.prototype.preferSuspendClockForDuration=!1,T.prototype.stopTimeoutMs=0,T.prototype.enableExtraGuardrails=!1,T.prototype.sessionInitiator=0,T.prototype.tracingSessionId=i.Long?i.Long.fromBits(0,0,!0):0,T.prototype.ftraceConfig=null,T.prototype.inodeFileConfig=null,T.prototype.processStatsConfig=null,T.prototype.sysStatsConfig=null,T.prototype.heapprofdConfig=null,T.prototype.javaHprofConfig=null,T.prototype.androidPowerConfig=null,T.prototype.androidLogConfig=null,T.prototype.gpuCounterConfig=null,T.prototype.androidGameInterventionListConfig=null,T.prototype.packagesListConfig=null,T.prototype.perfEventConfig=null,T.prototype.vulkanMemoryConfig=null,T.prototype.trackEventConfig=null,T.prototype.androidPolledStateConfig=null,T.prototype.androidSystemPropertyConfig=null,T.prototype.statsdTracingConfig=null,T.prototype.systemInfoConfig=null,T.prototype.chromeConfig=null,T.prototype.v8Config=null,T.prototype.interceptorConfig=null,T.prototype.networkPacketTraceConfig=null,T.prototype.surfaceflingerLayersConfig=null,T.prototype.surfaceflingerTransactionsConfig=null,T.prototype.androidSdkSyspropGuardConfig=null,T.prototype.etwConfig=null,T.prototype.protologConfig=null,T.prototype.androidInputEventConfig=null,T.prototype.pixelModemConfig=null,T.prototype.windowmanagerConfig=null,T.prototype.legacyConfig="",T.prototype.forTesting=null,T.create=function(e){return new T(e)},T.encode=function(e,t){return t=t||a.create(),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.targetBuffer&&Object.hasOwnProperty.call(e,"targetBuffer")&&t.uint32(16).uint32(e.targetBuffer),null!=e.traceDurationMs&&Object.hasOwnProperty.call(e,"traceDurationMs")&&t.uint32(24).uint32(e.traceDurationMs),null!=e.tracingSessionId&&Object.hasOwnProperty.call(e,"tracingSessionId")&&t.uint32(32).uint64(e.tracingSessionId),null!=e.enableExtraGuardrails&&Object.hasOwnProperty.call(e,"enableExtraGuardrails")&&t.uint32(48).bool(e.enableExtraGuardrails),null!=e.stopTimeoutMs&&Object.hasOwnProperty.call(e,"stopTimeoutMs")&&t.uint32(56).uint32(e.stopTimeoutMs),null!=e.sessionInitiator&&Object.hasOwnProperty.call(e,"sessionInitiator")&&t.uint32(64).int32(e.sessionInitiator),null!=e.ftraceConfig&&Object.hasOwnProperty.call(e,"ftraceConfig")&&s.perfetto.protos.FtraceConfig.encode(e.ftraceConfig,t.uint32(802).fork()).ldelim(),null!=e.chromeConfig&&Object.hasOwnProperty.call(e,"chromeConfig")&&s.perfetto.protos.ChromeConfig.encode(e.chromeConfig,t.uint32(810).fork()).ldelim(),null!=e.inodeFileConfig&&Object.hasOwnProperty.call(e,"inodeFileConfig")&&s.perfetto.protos.InodeFileConfig.encode(e.inodeFileConfig,t.uint32(818).fork()).ldelim(),null!=e.processStatsConfig&&Object.hasOwnProperty.call(e,"processStatsConfig")&&s.perfetto.protos.ProcessStatsConfig.encode(e.processStatsConfig,t.uint32(826).fork()).ldelim(),null!=e.sysStatsConfig&&Object.hasOwnProperty.call(e,"sysStatsConfig")&&s.perfetto.protos.SysStatsConfig.encode(e.sysStatsConfig,t.uint32(834).fork()).ldelim(),null!=e.heapprofdConfig&&Object.hasOwnProperty.call(e,"heapprofdConfig")&&s.perfetto.protos.HeapprofdConfig.encode(e.heapprofdConfig,t.uint32(842).fork()).ldelim(),null!=e.androidPowerConfig&&Object.hasOwnProperty.call(e,"androidPowerConfig")&&s.perfetto.protos.AndroidPowerConfig.encode(e.androidPowerConfig,t.uint32(850).fork()).ldelim(),null!=e.androidLogConfig&&Object.hasOwnProperty.call(e,"androidLogConfig")&&s.perfetto.protos.AndroidLogConfig.encode(e.androidLogConfig,t.uint32(858).fork()).ldelim(),null!=e.gpuCounterConfig&&Object.hasOwnProperty.call(e,"gpuCounterConfig")&&s.perfetto.protos.GpuCounterConfig.encode(e.gpuCounterConfig,t.uint32(866).fork()).ldelim(),null!=e.packagesListConfig&&Object.hasOwnProperty.call(e,"packagesListConfig")&&s.perfetto.protos.PackagesListConfig.encode(e.packagesListConfig,t.uint32(874).fork()).ldelim(),null!=e.javaHprofConfig&&Object.hasOwnProperty.call(e,"javaHprofConfig")&&s.perfetto.protos.JavaHprofConfig.encode(e.javaHprofConfig,t.uint32(882).fork()).ldelim(),null!=e.perfEventConfig&&Object.hasOwnProperty.call(e,"perfEventConfig")&&s.perfetto.protos.PerfEventConfig.encode(e.perfEventConfig,t.uint32(890).fork()).ldelim(),null!=e.vulkanMemoryConfig&&Object.hasOwnProperty.call(e,"vulkanMemoryConfig")&&s.perfetto.protos.VulkanMemoryConfig.encode(e.vulkanMemoryConfig,t.uint32(898).fork()).ldelim(),null!=e.trackEventConfig&&Object.hasOwnProperty.call(e,"trackEventConfig")&&s.perfetto.protos.TrackEventConfig.encode(e.trackEventConfig,t.uint32(906).fork()).ldelim(),null!=e.androidPolledStateConfig&&Object.hasOwnProperty.call(e,"androidPolledStateConfig")&&s.perfetto.protos.AndroidPolledStateConfig.encode(e.androidPolledStateConfig,t.uint32(914).fork()).ldelim(),null!=e.interceptorConfig&&Object.hasOwnProperty.call(e,"interceptorConfig")&&s.perfetto.protos.InterceptorConfig.encode(e.interceptorConfig,t.uint32(922).fork()).ldelim(),null!=e.androidGameInterventionListConfig&&Object.hasOwnProperty.call(e,"androidGameInterventionListConfig")&&s.perfetto.protos.AndroidGameInterventionListConfig.encode(e.androidGameInterventionListConfig,t.uint32(930).fork()).ldelim(),null!=e.statsdTracingConfig&&Object.hasOwnProperty.call(e,"statsdTracingConfig")&&s.perfetto.protos.StatsdTracingConfig.encode(e.statsdTracingConfig,t.uint32(938).fork()).ldelim(),null!=e.androidSystemPropertyConfig&&Object.hasOwnProperty.call(e,"androidSystemPropertyConfig")&&s.perfetto.protos.AndroidSystemPropertyConfig.encode(e.androidSystemPropertyConfig,t.uint32(946).fork()).ldelim(),null!=e.systemInfoConfig&&Object.hasOwnProperty.call(e,"systemInfoConfig")&&s.perfetto.protos.SystemInfoConfig.encode(e.systemInfoConfig,t.uint32(954).fork()).ldelim(),null!=e.networkPacketTraceConfig&&Object.hasOwnProperty.call(e,"networkPacketTraceConfig")&&s.perfetto.protos.NetworkPacketTraceConfig.encode(e.networkPacketTraceConfig,t.uint32(962).fork()).ldelim(),null!=e.surfaceflingerLayersConfig&&Object.hasOwnProperty.call(e,"surfaceflingerLayersConfig")&&s.perfetto.protos.SurfaceFlingerLayersConfig.encode(e.surfaceflingerLayersConfig,t.uint32(970).fork()).ldelim(),null!=e.preferSuspendClockForDuration&&Object.hasOwnProperty.call(e,"preferSuspendClockForDuration")&&t.uint32(976).bool(e.preferSuspendClockForDuration),null!=e.surfaceflingerTransactionsConfig&&Object.hasOwnProperty.call(e,"surfaceflingerTransactionsConfig")&&s.perfetto.protos.SurfaceFlingerTransactionsConfig.encode(e.surfaceflingerTransactionsConfig,t.uint32(986).fork()).ldelim(),null!=e.androidSdkSyspropGuardConfig&&Object.hasOwnProperty.call(e,"androidSdkSyspropGuardConfig")&&s.perfetto.protos.AndroidSdkSyspropGuardConfig.encode(e.androidSdkSyspropGuardConfig,t.uint32(994).fork()).ldelim(),null!=e.etwConfig&&Object.hasOwnProperty.call(e,"etwConfig")&&s.perfetto.protos.EtwConfig.encode(e.etwConfig,t.uint32(1002).fork()).ldelim(),null!=e.protologConfig&&Object.hasOwnProperty.call(e,"protologConfig")&&s.perfetto.protos.ProtoLogConfig.encode(e.protologConfig,t.uint32(1010).fork()).ldelim(),null!=e.v8Config&&Object.hasOwnProperty.call(e,"v8Config")&&s.perfetto.protos.V8Config.encode(e.v8Config,t.uint32(1018).fork()).ldelim(),null!=e.androidInputEventConfig&&Object.hasOwnProperty.call(e,"androidInputEventConfig")&&s.perfetto.protos.AndroidInputEventConfig.encode(e.androidInputEventConfig,t.uint32(1026).fork()).ldelim(),null!=e.pixelModemConfig&&Object.hasOwnProperty.call(e,"pixelModemConfig")&&s.perfetto.protos.PixelModemConfig.encode(e.pixelModemConfig,t.uint32(1034).fork()).ldelim(),null!=e.windowmanagerConfig&&Object.hasOwnProperty.call(e,"windowmanagerConfig")&&s.perfetto.protos.WindowManagerConfig.encode(e.windowmanagerConfig,t.uint32(1042).fork()).ldelim(),null!=e.legacyConfig&&Object.hasOwnProperty.call(e,"legacyConfig")&&t.uint32(8002).string(e.legacyConfig),null!=e.forTesting&&Object.hasOwnProperty.call(e,"forTesting")&&s.perfetto.protos.TestConfig.encode(e.forTesting,t.uint32(8010).fork()).ldelim(),t},T.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.DataSourceConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.name=e.string();break;case 2:n.targetBuffer=e.uint32();break;case 3:n.traceDurationMs=e.uint32();break;case 122:n.preferSuspendClockForDuration=e.bool();break;case 7:n.stopTimeoutMs=e.uint32();break;case 6:n.enableExtraGuardrails=e.bool();break;case 8:n.sessionInitiator=e.int32();break;case 4:n.tracingSessionId=e.uint64();break;case 100:n.ftraceConfig=s.perfetto.protos.FtraceConfig.decode(e,e.uint32());break;case 102:n.inodeFileConfig=s.perfetto.protos.InodeFileConfig.decode(e,e.uint32());break;case 103:n.processStatsConfig=s.perfetto.protos.ProcessStatsConfig.decode(e,e.uint32());break;case 104:n.sysStatsConfig=s.perfetto.protos.SysStatsConfig.decode(e,e.uint32());break;case 105:n.heapprofdConfig=s.perfetto.protos.HeapprofdConfig.decode(e,e.uint32());break;case 110:n.javaHprofConfig=s.perfetto.protos.JavaHprofConfig.decode(e,e.uint32());break;case 106:n.androidPowerConfig=s.perfetto.protos.AndroidPowerConfig.decode(e,e.uint32());break;case 107:n.androidLogConfig=s.perfetto.protos.AndroidLogConfig.decode(e,e.uint32());break;case 108:n.gpuCounterConfig=s.perfetto.protos.GpuCounterConfig.decode(e,e.uint32());break;case 116:n.androidGameInterventionListConfig=s.perfetto.protos.AndroidGameInterventionListConfig.decode(e,e.uint32());break;case 109:n.packagesListConfig=s.perfetto.protos.PackagesListConfig.decode(e,e.uint32());break;case 111:n.perfEventConfig=s.perfetto.protos.PerfEventConfig.decode(e,e.uint32());break;case 112:n.vulkanMemoryConfig=s.perfetto.protos.VulkanMemoryConfig.decode(e,e.uint32());break;case 113:n.trackEventConfig=s.perfetto.protos.TrackEventConfig.decode(e,e.uint32());break;case 114:n.androidPolledStateConfig=s.perfetto.protos.AndroidPolledStateConfig.decode(e,e.uint32());break;case 118:n.androidSystemPropertyConfig=s.perfetto.protos.AndroidSystemPropertyConfig.decode(e,e.uint32());break;case 117:n.statsdTracingConfig=s.perfetto.protos.StatsdTracingConfig.decode(e,e.uint32());break;case 119:n.systemInfoConfig=s.perfetto.protos.SystemInfoConfig.decode(e,e.uint32());break;case 101:n.chromeConfig=s.perfetto.protos.ChromeConfig.decode(e,e.uint32());break;case 127:n.v8Config=s.perfetto.protos.V8Config.decode(e,e.uint32());break;case 115:n.interceptorConfig=s.perfetto.protos.InterceptorConfig.decode(e,e.uint32());break;case 120:n.networkPacketTraceConfig=s.perfetto.protos.NetworkPacketTraceConfig.decode(e,e.uint32());break;case 121:n.surfaceflingerLayersConfig=s.perfetto.protos.SurfaceFlingerLayersConfig.decode(e,e.uint32());break;case 123:n.surfaceflingerTransactionsConfig=s.perfetto.protos.SurfaceFlingerTransactionsConfig.decode(e,e.uint32());break;case 124:n.androidSdkSyspropGuardConfig=s.perfetto.protos.AndroidSdkSyspropGuardConfig.decode(e,e.uint32());break;case 125:n.etwConfig=s.perfetto.protos.EtwConfig.decode(e,e.uint32());break;case 126:n.protologConfig=s.perfetto.protos.ProtoLogConfig.decode(e,e.uint32());break;case 128:n.androidInputEventConfig=s.perfetto.protos.AndroidInputEventConfig.decode(e,e.uint32());break;case 129:n.pixelModemConfig=s.perfetto.protos.PixelModemConfig.decode(e,e.uint32());break;case 130:n.windowmanagerConfig=s.perfetto.protos.WindowManagerConfig.decode(e,e.uint32());break;case 1e3:n.legacyConfig=e.string();break;case 1001:n.forTesting=s.perfetto.protos.TestConfig.decode(e,e.uint32());break;default:e.skipType(7&a)}}return n},T.fromObject=function(e){if(e instanceof s.perfetto.protos.DataSourceConfig)return e;var t=new s.perfetto.protos.DataSourceConfig;switch(null!=e.name&&(t.name=String(e.name)),null!=e.targetBuffer&&(t.targetBuffer=e.targetBuffer>>>0),null!=e.traceDurationMs&&(t.traceDurationMs=e.traceDurationMs>>>0),null!=e.preferSuspendClockForDuration&&(t.preferSuspendClockForDuration=Boolean(e.preferSuspendClockForDuration)),null!=e.stopTimeoutMs&&(t.stopTimeoutMs=e.stopTimeoutMs>>>0),null!=e.enableExtraGuardrails&&(t.enableExtraGuardrails=Boolean(e.enableExtraGuardrails)),e.sessionInitiator){default:"number"==typeof e.sessionInitiator&&(t.sessionInitiator=e.sessionInitiator);break;case"SESSION_INITIATOR_UNSPECIFIED":case 0:t.sessionInitiator=0;break;case"SESSION_INITIATOR_TRUSTED_SYSTEM":case 1:t.sessionInitiator=1}if(null!=e.tracingSessionId&&(i.Long?(t.tracingSessionId=i.Long.fromValue(e.tracingSessionId)).unsigned=!0:"string"==typeof e.tracingSessionId?t.tracingSessionId=parseInt(e.tracingSessionId,10):"number"==typeof e.tracingSessionId?t.tracingSessionId=e.tracingSessionId:"object"==typeof e.tracingSessionId&&(t.tracingSessionId=new i.LongBits(e.tracingSessionId.low>>>0,e.tracingSessionId.high>>>0).toNumber(!0))),null!=e.ftraceConfig){if("object"!=typeof e.ftraceConfig)throw TypeError(".perfetto.protos.DataSourceConfig.ftraceConfig: object expected");t.ftraceConfig=s.perfetto.protos.FtraceConfig.fromObject(e.ftraceConfig)}if(null!=e.inodeFileConfig){if("object"!=typeof e.inodeFileConfig)throw TypeError(".perfetto.protos.DataSourceConfig.inodeFileConfig: object expected");t.inodeFileConfig=s.perfetto.protos.InodeFileConfig.fromObject(e.inodeFileConfig)}if(null!=e.processStatsConfig){if("object"!=typeof e.processStatsConfig)throw TypeError(".perfetto.protos.DataSourceConfig.processStatsConfig: object expected");t.processStatsConfig=s.perfetto.protos.ProcessStatsConfig.fromObject(e.processStatsConfig)}if(null!=e.sysStatsConfig){if("object"!=typeof e.sysStatsConfig)throw TypeError(".perfetto.protos.DataSourceConfig.sysStatsConfig: object expected");t.sysStatsConfig=s.perfetto.protos.SysStatsConfig.fromObject(e.sysStatsConfig)}if(null!=e.heapprofdConfig){if("object"!=typeof e.heapprofdConfig)throw TypeError(".perfetto.protos.DataSourceConfig.heapprofdConfig: object expected");t.heapprofdConfig=s.perfetto.protos.HeapprofdConfig.fromObject(e.heapprofdConfig)}if(null!=e.javaHprofConfig){if("object"!=typeof e.javaHprofConfig)throw TypeError(".perfetto.protos.DataSourceConfig.javaHprofConfig: object expected");t.javaHprofConfig=s.perfetto.protos.JavaHprofConfig.fromObject(e.javaHprofConfig)}if(null!=e.androidPowerConfig){if("object"!=typeof e.androidPowerConfig)throw TypeError(".perfetto.protos.DataSourceConfig.androidPowerConfig: object expected");t.androidPowerConfig=s.perfetto.protos.AndroidPowerConfig.fromObject(e.androidPowerConfig)}if(null!=e.androidLogConfig){if("object"!=typeof e.androidLogConfig)throw TypeError(".perfetto.protos.DataSourceConfig.androidLogConfig: object expected");t.androidLogConfig=s.perfetto.protos.AndroidLogConfig.fromObject(e.androidLogConfig)}if(null!=e.gpuCounterConfig){if("object"!=typeof e.gpuCounterConfig)throw TypeError(".perfetto.protos.DataSourceConfig.gpuCounterConfig: object expected");t.gpuCounterConfig=s.perfetto.protos.GpuCounterConfig.fromObject(e.gpuCounterConfig)}if(null!=e.androidGameInterventionListConfig){if("object"!=typeof e.androidGameInterventionListConfig)throw TypeError(".perfetto.protos.DataSourceConfig.androidGameInterventionListConfig: object expected");t.androidGameInterventionListConfig=s.perfetto.protos.AndroidGameInterventionListConfig.fromObject(e.androidGameInterventionListConfig)}if(null!=e.packagesListConfig){if("object"!=typeof e.packagesListConfig)throw TypeError(".perfetto.protos.DataSourceConfig.packagesListConfig: object expected");t.packagesListConfig=s.perfetto.protos.PackagesListConfig.fromObject(e.packagesListConfig)}if(null!=e.perfEventConfig){if("object"!=typeof e.perfEventConfig)throw TypeError(".perfetto.protos.DataSourceConfig.perfEventConfig: object expected");t.perfEventConfig=s.perfetto.protos.PerfEventConfig.fromObject(e.perfEventConfig)}if(null!=e.vulkanMemoryConfig){if("object"!=typeof e.vulkanMemoryConfig)throw TypeError(".perfetto.protos.DataSourceConfig.vulkanMemoryConfig: object expected");t.vulkanMemoryConfig=s.perfetto.protos.VulkanMemoryConfig.fromObject(e.vulkanMemoryConfig)}if(null!=e.trackEventConfig){if("object"!=typeof e.trackEventConfig)throw TypeError(".perfetto.protos.DataSourceConfig.trackEventConfig: object expected");t.trackEventConfig=s.perfetto.protos.TrackEventConfig.fromObject(e.trackEventConfig)}if(null!=e.androidPolledStateConfig){if("object"!=typeof e.androidPolledStateConfig)throw TypeError(".perfetto.protos.DataSourceConfig.androidPolledStateConfig: object expected");t.androidPolledStateConfig=s.perfetto.protos.AndroidPolledStateConfig.fromObject(e.androidPolledStateConfig)}if(null!=e.androidSystemPropertyConfig){if("object"!=typeof e.androidSystemPropertyConfig)throw TypeError(".perfetto.protos.DataSourceConfig.androidSystemPropertyConfig: object expected");t.androidSystemPropertyConfig=s.perfetto.protos.AndroidSystemPropertyConfig.fromObject(e.androidSystemPropertyConfig)}if(null!=e.statsdTracingConfig){if("object"!=typeof e.statsdTracingConfig)throw TypeError(".perfetto.protos.DataSourceConfig.statsdTracingConfig: object expected");t.statsdTracingConfig=s.perfetto.protos.StatsdTracingConfig.fromObject(e.statsdTracingConfig)}if(null!=e.systemInfoConfig){if("object"!=typeof e.systemInfoConfig)throw TypeError(".perfetto.protos.DataSourceConfig.systemInfoConfig: object expected");t.systemInfoConfig=s.perfetto.protos.SystemInfoConfig.fromObject(e.systemInfoConfig)}if(null!=e.chromeConfig){if("object"!=typeof e.chromeConfig)throw TypeError(".perfetto.protos.DataSourceConfig.chromeConfig: object expected");t.chromeConfig=s.perfetto.protos.ChromeConfig.fromObject(e.chromeConfig)}if(null!=e.v8Config){if("object"!=typeof e.v8Config)throw TypeError(".perfetto.protos.DataSourceConfig.v8Config: object expected");t.v8Config=s.perfetto.protos.V8Config.fromObject(e.v8Config)}if(null!=e.interceptorConfig){if("object"!=typeof e.interceptorConfig)throw TypeError(".perfetto.protos.DataSourceConfig.interceptorConfig: object expected");t.interceptorConfig=s.perfetto.protos.InterceptorConfig.fromObject(e.interceptorConfig)}if(null!=e.networkPacketTraceConfig){if("object"!=typeof e.networkPacketTraceConfig)throw TypeError(".perfetto.protos.DataSourceConfig.networkPacketTraceConfig: object expected");t.networkPacketTraceConfig=s.perfetto.protos.NetworkPacketTraceConfig.fromObject(e.networkPacketTraceConfig)}if(null!=e.surfaceflingerLayersConfig){if("object"!=typeof e.surfaceflingerLayersConfig)throw TypeError(".perfetto.protos.DataSourceConfig.surfaceflingerLayersConfig: object expected");t.surfaceflingerLayersConfig=s.perfetto.protos.SurfaceFlingerLayersConfig.fromObject(e.surfaceflingerLayersConfig)}if(null!=e.surfaceflingerTransactionsConfig){if("object"!=typeof e.surfaceflingerTransactionsConfig)throw TypeError(".perfetto.protos.DataSourceConfig.surfaceflingerTransactionsConfig: object expected");t.surfaceflingerTransactionsConfig=s.perfetto.protos.SurfaceFlingerTransactionsConfig.fromObject(e.surfaceflingerTransactionsConfig)}if(null!=e.androidSdkSyspropGuardConfig){if("object"!=typeof e.androidSdkSyspropGuardConfig)throw TypeError(".perfetto.protos.DataSourceConfig.androidSdkSyspropGuardConfig: object expected");t.androidSdkSyspropGuardConfig=s.perfetto.protos.AndroidSdkSyspropGuardConfig.fromObject(e.androidSdkSyspropGuardConfig)}if(null!=e.etwConfig){if("object"!=typeof e.etwConfig)throw TypeError(".perfetto.protos.DataSourceConfig.etwConfig: object expected");t.etwConfig=s.perfetto.protos.EtwConfig.fromObject(e.etwConfig)}if(null!=e.protologConfig){if("object"!=typeof e.protologConfig)throw TypeError(".perfetto.protos.DataSourceConfig.protologConfig: object expected");t.protologConfig=s.perfetto.protos.ProtoLogConfig.fromObject(e.protologConfig)}if(null!=e.androidInputEventConfig){if("object"!=typeof e.androidInputEventConfig)throw TypeError(".perfetto.protos.DataSourceConfig.androidInputEventConfig: object expected");t.androidInputEventConfig=s.perfetto.protos.AndroidInputEventConfig.fromObject(e.androidInputEventConfig)}if(null!=e.pixelModemConfig){if("object"!=typeof e.pixelModemConfig)throw TypeError(".perfetto.protos.DataSourceConfig.pixelModemConfig: object expected");t.pixelModemConfig=s.perfetto.protos.PixelModemConfig.fromObject(e.pixelModemConfig)}if(null!=e.windowmanagerConfig){if("object"!=typeof e.windowmanagerConfig)throw TypeError(".perfetto.protos.DataSourceConfig.windowmanagerConfig: object expected");t.windowmanagerConfig=s.perfetto.protos.WindowManagerConfig.fromObject(e.windowmanagerConfig)}if(null!=e.legacyConfig&&(t.legacyConfig=String(e.legacyConfig)),null!=e.forTesting){if("object"!=typeof e.forTesting)throw TypeError(".perfetto.protos.DataSourceConfig.forTesting: object expected");t.forTesting=s.perfetto.protos.TestConfig.fromObject(e.forTesting)}return t},T.toObject=function(e,t){var r,n={};return(t=t||{}).defaults&&(n.name="",n.targetBuffer=0,n.traceDurationMs=0,i.Long?(r=new i.Long(0,0,!0),n.tracingSessionId=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.tracingSessionId=t.longs===String?"0":0,n.enableExtraGuardrails=!1,n.stopTimeoutMs=0,n.sessionInitiator=t.enums===String?"SESSION_INITIATOR_UNSPECIFIED":0,n.ftraceConfig=null,n.chromeConfig=null,n.inodeFileConfig=null,n.processStatsConfig=null,n.sysStatsConfig=null,n.heapprofdConfig=null,n.androidPowerConfig=null,n.androidLogConfig=null,n.gpuCounterConfig=null,n.packagesListConfig=null,n.javaHprofConfig=null,n.perfEventConfig=null,n.vulkanMemoryConfig=null,n.trackEventConfig=null,n.androidPolledStateConfig=null,n.interceptorConfig=null,n.androidGameInterventionListConfig=null,n.statsdTracingConfig=null,n.androidSystemPropertyConfig=null,n.systemInfoConfig=null,n.networkPacketTraceConfig=null,n.surfaceflingerLayersConfig=null,n.preferSuspendClockForDuration=!1,n.surfaceflingerTransactionsConfig=null,n.androidSdkSyspropGuardConfig=null,n.etwConfig=null,n.protologConfig=null,n.v8Config=null,n.androidInputEventConfig=null,n.pixelModemConfig=null,n.windowmanagerConfig=null,n.legacyConfig="",n.forTesting=null),null!=e.name&&e.hasOwnProperty("name")&&(n.name=e.name),null!=e.targetBuffer&&e.hasOwnProperty("targetBuffer")&&(n.targetBuffer=e.targetBuffer),null!=e.traceDurationMs&&e.hasOwnProperty("traceDurationMs")&&(n.traceDurationMs=e.traceDurationMs),null!=e.tracingSessionId&&e.hasOwnProperty("tracingSessionId")&&("number"==typeof e.tracingSessionId?n.tracingSessionId=t.longs===String?String(e.tracingSessionId):e.tracingSessionId:n.tracingSessionId=t.longs===String?i.Long.prototype.toString.call(e.tracingSessionId):t.longs===Number?new i.LongBits(e.tracingSessionId.low>>>0,e.tracingSessionId.high>>>0).toNumber(!0):e.tracingSessionId),null!=e.enableExtraGuardrails&&e.hasOwnProperty("enableExtraGuardrails")&&(n.enableExtraGuardrails=e.enableExtraGuardrails),null!=e.stopTimeoutMs&&e.hasOwnProperty("stopTimeoutMs")&&(n.stopTimeoutMs=e.stopTimeoutMs),null!=e.sessionInitiator&&e.hasOwnProperty("sessionInitiator")&&(n.sessionInitiator=t.enums!==String||void 0===s.perfetto.protos.DataSourceConfig.SessionInitiator[e.sessionInitiator]?e.sessionInitiator:s.perfetto.protos.DataSourceConfig.SessionInitiator[e.sessionInitiator]),null!=e.ftraceConfig&&e.hasOwnProperty("ftraceConfig")&&(n.ftraceConfig=s.perfetto.protos.FtraceConfig.toObject(e.ftraceConfig,t)),null!=e.chromeConfig&&e.hasOwnProperty("chromeConfig")&&(n.chromeConfig=s.perfetto.protos.ChromeConfig.toObject(e.chromeConfig,t)),null!=e.inodeFileConfig&&e.hasOwnProperty("inodeFileConfig")&&(n.inodeFileConfig=s.perfetto.protos.InodeFileConfig.toObject(e.inodeFileConfig,t)),null!=e.processStatsConfig&&e.hasOwnProperty("processStatsConfig")&&(n.processStatsConfig=s.perfetto.protos.ProcessStatsConfig.toObject(e.processStatsConfig,t)),null!=e.sysStatsConfig&&e.hasOwnProperty("sysStatsConfig")&&(n.sysStatsConfig=s.perfetto.protos.SysStatsConfig.toObject(e.sysStatsConfig,t)),null!=e.heapprofdConfig&&e.hasOwnProperty("heapprofdConfig")&&(n.heapprofdConfig=s.perfetto.protos.HeapprofdConfig.toObject(e.heapprofdConfig,t)),null!=e.androidPowerConfig&&e.hasOwnProperty("androidPowerConfig")&&(n.androidPowerConfig=s.perfetto.protos.AndroidPowerConfig.toObject(e.androidPowerConfig,t)),null!=e.androidLogConfig&&e.hasOwnProperty("androidLogConfig")&&(n.androidLogConfig=s.perfetto.protos.AndroidLogConfig.toObject(e.androidLogConfig,t)),null!=e.gpuCounterConfig&&e.hasOwnProperty("gpuCounterConfig")&&(n.gpuCounterConfig=s.perfetto.protos.GpuCounterConfig.toObject(e.gpuCounterConfig,t)),null!=e.packagesListConfig&&e.hasOwnProperty("packagesListConfig")&&(n.packagesListConfig=s.perfetto.protos.PackagesListConfig.toObject(e.packagesListConfig,t)),null!=e.javaHprofConfig&&e.hasOwnProperty("javaHprofConfig")&&(n.javaHprofConfig=s.perfetto.protos.JavaHprofConfig.toObject(e.javaHprofConfig,t)),null!=e.perfEventConfig&&e.hasOwnProperty("perfEventConfig")&&(n.perfEventConfig=s.perfetto.protos.PerfEventConfig.toObject(e.perfEventConfig,t)),null!=e.vulkanMemoryConfig&&e.hasOwnProperty("vulkanMemoryConfig")&&(n.vulkanMemoryConfig=s.perfetto.protos.VulkanMemoryConfig.toObject(e.vulkanMemoryConfig,t)),null!=e.trackEventConfig&&e.hasOwnProperty("trackEventConfig")&&(n.trackEventConfig=s.perfetto.protos.TrackEventConfig.toObject(e.trackEventConfig,t)),null!=e.androidPolledStateConfig&&e.hasOwnProperty("androidPolledStateConfig")&&(n.androidPolledStateConfig=s.perfetto.protos.AndroidPolledStateConfig.toObject(e.androidPolledStateConfig,t)),null!=e.interceptorConfig&&e.hasOwnProperty("interceptorConfig")&&(n.interceptorConfig=s.perfetto.protos.InterceptorConfig.toObject(e.interceptorConfig,t)),null!=e.androidGameInterventionListConfig&&e.hasOwnProperty("androidGameInterventionListConfig")&&(n.androidGameInterventionListConfig=s.perfetto.protos.AndroidGameInterventionListConfig.toObject(e.androidGameInterventionListConfig,t)),null!=e.statsdTracingConfig&&e.hasOwnProperty("statsdTracingConfig")&&(n.statsdTracingConfig=s.perfetto.protos.StatsdTracingConfig.toObject(e.statsdTracingConfig,t)),null!=e.androidSystemPropertyConfig&&e.hasOwnProperty("androidSystemPropertyConfig")&&(n.androidSystemPropertyConfig=s.perfetto.protos.AndroidSystemPropertyConfig.toObject(e.androidSystemPropertyConfig,t)),null!=e.systemInfoConfig&&e.hasOwnProperty("systemInfoConfig")&&(n.systemInfoConfig=s.perfetto.protos.SystemInfoConfig.toObject(e.systemInfoConfig,t)),null!=e.networkPacketTraceConfig&&e.hasOwnProperty("networkPacketTraceConfig")&&(n.networkPacketTraceConfig=s.perfetto.protos.NetworkPacketTraceConfig.toObject(e.networkPacketTraceConfig,t)),null!=e.surfaceflingerLayersConfig&&e.hasOwnProperty("surfaceflingerLayersConfig")&&(n.surfaceflingerLayersConfig=s.perfetto.protos.SurfaceFlingerLayersConfig.toObject(e.surfaceflingerLayersConfig,t)),null!=e.preferSuspendClockForDuration&&e.hasOwnProperty("preferSuspendClockForDuration")&&(n.preferSuspendClockForDuration=e.preferSuspendClockForDuration),null!=e.surfaceflingerTransactionsConfig&&e.hasOwnProperty("surfaceflingerTransactionsConfig")&&(n.surfaceflingerTransactionsConfig=s.perfetto.protos.SurfaceFlingerTransactionsConfig.toObject(e.surfaceflingerTransactionsConfig,t)),null!=e.androidSdkSyspropGuardConfig&&e.hasOwnProperty("androidSdkSyspropGuardConfig")&&(n.androidSdkSyspropGuardConfig=s.perfetto.protos.AndroidSdkSyspropGuardConfig.toObject(e.androidSdkSyspropGuardConfig,t)),null!=e.etwConfig&&e.hasOwnProperty("etwConfig")&&(n.etwConfig=s.perfetto.protos.EtwConfig.toObject(e.etwConfig,t)),null!=e.protologConfig&&e.hasOwnProperty("protologConfig")&&(n.protologConfig=s.perfetto.protos.ProtoLogConfig.toObject(e.protologConfig,t)),null!=e.v8Config&&e.hasOwnProperty("v8Config")&&(n.v8Config=s.perfetto.protos.V8Config.toObject(e.v8Config,t)),null!=e.androidInputEventConfig&&e.hasOwnProperty("androidInputEventConfig")&&(n.androidInputEventConfig=s.perfetto.protos.AndroidInputEventConfig.toObject(e.androidInputEventConfig,t)),null!=e.pixelModemConfig&&e.hasOwnProperty("pixelModemConfig")&&(n.pixelModemConfig=s.perfetto.protos.PixelModemConfig.toObject(e.pixelModemConfig,t)),null!=e.windowmanagerConfig&&e.hasOwnProperty("windowmanagerConfig")&&(n.windowmanagerConfig=s.perfetto.protos.WindowManagerConfig.toObject(e.windowmanagerConfig,t)),null!=e.legacyConfig&&e.hasOwnProperty("legacyConfig")&&(n.legacyConfig=e.legacyConfig),null!=e.forTesting&&e.hasOwnProperty("forTesting")&&(n.forTesting=s.perfetto.protos.TestConfig.toObject(e.forTesting,t)),n},T.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},T.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.DataSourceConfig"},T.SessionInitiator=(t={},(e=Object.create(t))[t[0]="SESSION_INITIATOR_UNSPECIFIED"]=0,e[t[1]="SESSION_INITIATOR_TRUSTED_SYSTEM"]=1,e),T),r.AndroidGameInterventionListConfig=(Ge.prototype.packageNameFilter=i.emptyArray,Ge.create=function(e){return new Ge(e)},Ge.encode=function(e,t){if(t=t||a.create(),null!=e.packageNameFilter&&e.packageNameFilter.length)for(var r=0;r<e.packageNameFilter.length;++r)t.uint32(10).string(e.packageNameFilter[r]);return t},Ge.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.AndroidGameInterventionListConfig;e.pos<r;){var a=e.uint32();a>>>3==1?(n.packageNameFilter&&n.packageNameFilter.length||(n.packageNameFilter=[]),n.packageNameFilter.push(e.string())):e.skipType(7&a)}return n},Ge.fromObject=function(e){if(e instanceof s.perfetto.protos.AndroidGameInterventionListConfig)return e;var t=new s.perfetto.protos.AndroidGameInterventionListConfig;if(e.packageNameFilter){if(!Array.isArray(e.packageNameFilter))throw TypeError(".perfetto.protos.AndroidGameInterventionListConfig.packageNameFilter: array expected");t.packageNameFilter=[];for(var r=0;r<e.packageNameFilter.length;++r)t.packageNameFilter[r]=String(e.packageNameFilter[r])}return t},Ge.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.packageNameFilter=[]),e.packageNameFilter&&e.packageNameFilter.length){r.packageNameFilter=[];for(var n=0;n<e.packageNameFilter.length;++n)r.packageNameFilter[n]=e.packageNameFilter[n]}return r},Ge.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Ge.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.AndroidGameInterventionListConfig"},Ge),r.AndroidInputEventConfig=(Ve.prototype.mode=0,Ve.prototype.rules=i.emptyArray,Ve.prototype.traceDispatcherInputEvents=!1,Ve.prototype.traceDispatcherWindowDispatch=!1,Ve.create=function(e){return new Ve(e)},Ve.encode=function(e,t){if(t=t||a.create(),null!=e.mode&&Object.hasOwnProperty.call(e,"mode")&&t.uint32(8).int32(e.mode),null!=e.rules&&e.rules.length)for(var r=0;r<e.rules.length;++r)s.perfetto.protos.AndroidInputEventConfig.TraceRule.encode(e.rules[r],t.uint32(18).fork()).ldelim();return null!=e.traceDispatcherInputEvents&&Object.hasOwnProperty.call(e,"traceDispatcherInputEvents")&&t.uint32(24).bool(e.traceDispatcherInputEvents),null!=e.traceDispatcherWindowDispatch&&Object.hasOwnProperty.call(e,"traceDispatcherWindowDispatch")&&t.uint32(32).bool(e.traceDispatcherWindowDispatch),t},Ve.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.AndroidInputEventConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.mode=e.int32();break;case 2:n.rules&&n.rules.length||(n.rules=[]),n.rules.push(s.perfetto.protos.AndroidInputEventConfig.TraceRule.decode(e,e.uint32()));break;case 3:n.traceDispatcherInputEvents=e.bool();break;case 4:n.traceDispatcherWindowDispatch=e.bool();break;default:e.skipType(7&a)}}return n},Ve.fromObject=function(e){if(e instanceof s.perfetto.protos.AndroidInputEventConfig)return e;var t=new s.perfetto.protos.AndroidInputEventConfig;switch(e.mode){default:"number"==typeof e.mode&&(t.mode=e.mode);break;case"TRACE_MODE_TRACE_ALL":case 0:t.mode=0;break;case"TRACE_MODE_USE_RULES":case 1:t.mode=1}if(e.rules){if(!Array.isArray(e.rules))throw TypeError(".perfetto.protos.AndroidInputEventConfig.rules: array expected");t.rules=[];for(var r=0;r<e.rules.length;++r){if("object"!=typeof e.rules[r])throw TypeError(".perfetto.protos.AndroidInputEventConfig.rules: object expected");t.rules[r]=s.perfetto.protos.AndroidInputEventConfig.TraceRule.fromObject(e.rules[r])}}return null!=e.traceDispatcherInputEvents&&(t.traceDispatcherInputEvents=Boolean(e.traceDispatcherInputEvents)),null!=e.traceDispatcherWindowDispatch&&(t.traceDispatcherWindowDispatch=Boolean(e.traceDispatcherWindowDispatch)),t},Ve.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.rules=[]),t.defaults&&(r.mode=t.enums===String?"TRACE_MODE_TRACE_ALL":0,r.traceDispatcherInputEvents=!1,r.traceDispatcherWindowDispatch=!1),null!=e.mode&&e.hasOwnProperty("mode")&&(r.mode=t.enums!==String||void 0===s.perfetto.protos.AndroidInputEventConfig.TraceMode[e.mode]?e.mode:s.perfetto.protos.AndroidInputEventConfig.TraceMode[e.mode]),e.rules&&e.rules.length){r.rules=[];for(var n=0;n<e.rules.length;++n)r.rules[n]=s.perfetto.protos.AndroidInputEventConfig.TraceRule.toObject(e.rules[n],t)}return null!=e.traceDispatcherInputEvents&&e.hasOwnProperty("traceDispatcherInputEvents")&&(r.traceDispatcherInputEvents=e.traceDispatcherInputEvents),null!=e.traceDispatcherWindowDispatch&&e.hasOwnProperty("traceDispatcherWindowDispatch")&&(r.traceDispatcherWindowDispatch=e.traceDispatcherWindowDispatch),r},Ve.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Ve.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.AndroidInputEventConfig"},Ve.TraceMode=(t={},(e=Object.create(t))[t[0]="TRACE_MODE_TRACE_ALL"]=0,e[t[1]="TRACE_MODE_USE_RULES"]=1,e),Ve.TraceLevel=(t={},(e=Object.create(t))[t[0]="TRACE_LEVEL_NONE"]=0,e[t[1]="TRACE_LEVEL_REDACTED"]=1,e[t[2]="TRACE_LEVEL_COMPLETE"]=2,e),Ve.TraceRule=(We.prototype.traceLevel=0,We.prototype.matchAllPackages=i.emptyArray,We.prototype.matchAnyPackages=i.emptyArray,We.prototype.matchSecure=!1,We.prototype.matchImeConnectionActive=!1,We.create=function(e){return new We(e)},We.encode=function(e,t){if(t=t||a.create(),null!=e.traceLevel&&Object.hasOwnProperty.call(e,"traceLevel")&&t.uint32(8).int32(e.traceLevel),null!=e.matchAllPackages&&e.matchAllPackages.length)for(var r=0;r<e.matchAllPackages.length;++r)t.uint32(18).string(e.matchAllPackages[r]);if(null!=e.matchAnyPackages&&e.matchAnyPackages.length)for(r=0;r<e.matchAnyPackages.length;++r)t.uint32(26).string(e.matchAnyPackages[r]);return null!=e.matchSecure&&Object.hasOwnProperty.call(e,"matchSecure")&&t.uint32(32).bool(e.matchSecure),null!=e.matchImeConnectionActive&&Object.hasOwnProperty.call(e,"matchImeConnectionActive")&&t.uint32(40).bool(e.matchImeConnectionActive),t},We.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.AndroidInputEventConfig.TraceRule;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.traceLevel=e.int32();break;case 2:n.matchAllPackages&&n.matchAllPackages.length||(n.matchAllPackages=[]),n.matchAllPackages.push(e.string());break;case 3:n.matchAnyPackages&&n.matchAnyPackages.length||(n.matchAnyPackages=[]),n.matchAnyPackages.push(e.string());break;case 4:n.matchSecure=e.bool();break;case 5:n.matchImeConnectionActive=e.bool();break;default:e.skipType(7&a)}}return n},We.fromObject=function(e){if(e instanceof s.perfetto.protos.AndroidInputEventConfig.TraceRule)return e;var t=new s.perfetto.protos.AndroidInputEventConfig.TraceRule;switch(e.traceLevel){default:"number"==typeof e.traceLevel&&(t.traceLevel=e.traceLevel);break;case"TRACE_LEVEL_NONE":case 0:t.traceLevel=0;break;case"TRACE_LEVEL_REDACTED":case 1:t.traceLevel=1;break;case"TRACE_LEVEL_COMPLETE":case 2:t.traceLevel=2}if(e.matchAllPackages){if(!Array.isArray(e.matchAllPackages))throw TypeError(".perfetto.protos.AndroidInputEventConfig.TraceRule.matchAllPackages: array expected");t.matchAllPackages=[];for(var r=0;r<e.matchAllPackages.length;++r)t.matchAllPackages[r]=String(e.matchAllPackages[r])}if(e.matchAnyPackages){if(!Array.isArray(e.matchAnyPackages))throw TypeError(".perfetto.protos.AndroidInputEventConfig.TraceRule.matchAnyPackages: array expected");t.matchAnyPackages=[];for(r=0;r<e.matchAnyPackages.length;++r)t.matchAnyPackages[r]=String(e.matchAnyPackages[r])}return null!=e.matchSecure&&(t.matchSecure=Boolean(e.matchSecure)),null!=e.matchImeConnectionActive&&(t.matchImeConnectionActive=Boolean(e.matchImeConnectionActive)),t},We.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.matchAllPackages=[],r.matchAnyPackages=[]),t.defaults&&(r.traceLevel=t.enums===String?"TRACE_LEVEL_NONE":0,r.matchSecure=!1,r.matchImeConnectionActive=!1),null!=e.traceLevel&&e.hasOwnProperty("traceLevel")&&(r.traceLevel=t.enums!==String||void 0===s.perfetto.protos.AndroidInputEventConfig.TraceLevel[e.traceLevel]?e.traceLevel:s.perfetto.protos.AndroidInputEventConfig.TraceLevel[e.traceLevel]),e.matchAllPackages&&e.matchAllPackages.length){r.matchAllPackages=[];for(var n=0;n<e.matchAllPackages.length;++n)r.matchAllPackages[n]=e.matchAllPackages[n]}if(e.matchAnyPackages&&e.matchAnyPackages.length){r.matchAnyPackages=[];for(n=0;n<e.matchAnyPackages.length;++n)r.matchAnyPackages[n]=e.matchAnyPackages[n]}return null!=e.matchSecure&&e.hasOwnProperty("matchSecure")&&(r.matchSecure=e.matchSecure),null!=e.matchImeConnectionActive&&e.hasOwnProperty("matchImeConnectionActive")&&(r.matchImeConnectionActive=e.matchImeConnectionActive),r},We.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},We.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.AndroidInputEventConfig.TraceRule"},We),Ve),r.AndroidLogConfig=(qe.prototype.logIds=i.emptyArray,qe.prototype.minPrio=0,qe.prototype.filterTags=i.emptyArray,qe.create=function(e){return new qe(e)},qe.encode=function(e,t){if(t=t||a.create(),null!=e.logIds&&e.logIds.length)for(var r=0;r<e.logIds.length;++r)t.uint32(8).int32(e.logIds[r]);if(null!=e.minPrio&&Object.hasOwnProperty.call(e,"minPrio")&&t.uint32(24).int32(e.minPrio),null!=e.filterTags&&e.filterTags.length)for(r=0;r<e.filterTags.length;++r)t.uint32(34).string(e.filterTags[r]);return t},qe.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.AndroidLogConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:if(n.logIds&&n.logIds.length||(n.logIds=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.logIds.push(e.int32());else n.logIds.push(e.int32());break;case 3:n.minPrio=e.int32();break;case 4:n.filterTags&&n.filterTags.length||(n.filterTags=[]),n.filterTags.push(e.string());break;default:e.skipType(7&a)}}return n},qe.fromObject=function(e){if(e instanceof s.perfetto.protos.AndroidLogConfig)return e;var t=new s.perfetto.protos.AndroidLogConfig;if(e.logIds){if(!Array.isArray(e.logIds))throw TypeError(".perfetto.protos.AndroidLogConfig.logIds: array expected");t.logIds=[];for(var r=0;r<e.logIds.length;++r)switch(e.logIds[r]){default:if("number"==typeof e.logIds[r]){t.logIds[r]=e.logIds[r];break}case"LID_DEFAULT":case 0:t.logIds[r]=0;break;case"LID_RADIO":case 1:t.logIds[r]=1;break;case"LID_EVENTS":case 2:t.logIds[r]=2;break;case"LID_SYSTEM":case 3:t.logIds[r]=3;break;case"LID_CRASH":case 4:t.logIds[r]=4;break;case"LID_STATS":case 5:t.logIds[r]=5;break;case"LID_SECURITY":case 6:t.logIds[r]=6;break;case"LID_KERNEL":case 7:t.logIds[r]=7}}switch(e.minPrio){default:"number"==typeof e.minPrio&&(t.minPrio=e.minPrio);break;case"PRIO_UNSPECIFIED":case 0:t.minPrio=0;break;case"PRIO_UNUSED":case 1:t.minPrio=1;break;case"PRIO_VERBOSE":case 2:t.minPrio=2;break;case"PRIO_DEBUG":case 3:t.minPrio=3;break;case"PRIO_INFO":case 4:t.minPrio=4;break;case"PRIO_WARN":case 5:t.minPrio=5;break;case"PRIO_ERROR":case 6:t.minPrio=6;break;case"PRIO_FATAL":case 7:t.minPrio=7}if(e.filterTags){if(!Array.isArray(e.filterTags))throw TypeError(".perfetto.protos.AndroidLogConfig.filterTags: array expected");t.filterTags=[];for(r=0;r<e.filterTags.length;++r)t.filterTags[r]=String(e.filterTags[r])}return t},qe.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.logIds=[],r.filterTags=[]),t.defaults&&(r.minPrio=t.enums===String?"PRIO_UNSPECIFIED":0),e.logIds&&e.logIds.length){r.logIds=[];for(var n=0;n<e.logIds.length;++n)r.logIds[n]=t.enums!==String||void 0===s.perfetto.protos.AndroidLogId[e.logIds[n]]?e.logIds[n]:s.perfetto.protos.AndroidLogId[e.logIds[n]]}if(null!=e.minPrio&&e.hasOwnProperty("minPrio")&&(r.minPrio=t.enums!==String||void 0===s.perfetto.protos.AndroidLogPriority[e.minPrio]?e.minPrio:s.perfetto.protos.AndroidLogPriority[e.minPrio]),e.filterTags&&e.filterTags.length){r.filterTags=[];for(n=0;n<e.filterTags.length;++n)r.filterTags[n]=e.filterTags[n]}return r},qe.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},qe.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.AndroidLogConfig"},qe),r.AndroidLogId=(t={},(e=Object.create(t))[t[0]="LID_DEFAULT"]=0,e[t[1]="LID_RADIO"]=1,e[t[2]="LID_EVENTS"]=2,e[t[3]="LID_SYSTEM"]=3,e[t[4]="LID_CRASH"]=4,e[t[5]="LID_STATS"]=5,e[t[6]="LID_SECURITY"]=6,e[t[7]="LID_KERNEL"]=7,e),r.AndroidLogPriority=(t={},(e=Object.create(t))[t[0]="PRIO_UNSPECIFIED"]=0,e[t[1]="PRIO_UNUSED"]=1,e[t[2]="PRIO_VERBOSE"]=2,e[t[3]="PRIO_DEBUG"]=3,e[t[4]="PRIO_INFO"]=4,e[t[5]="PRIO_WARN"]=5,e[t[6]="PRIO_ERROR"]=6,e[t[7]="PRIO_FATAL"]=7,e),r.AndroidPolledStateConfig=($e.prototype.pollMs=0,$e.create=function(e){return new $e(e)},$e.encode=function(e,t){return t=t||a.create(),null!=e.pollMs&&Object.hasOwnProperty.call(e,"pollMs")&&t.uint32(8).uint32(e.pollMs),t},$e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.AndroidPolledStateConfig;e.pos<r;){var a=e.uint32();a>>>3==1?n.pollMs=e.uint32():e.skipType(7&a)}return n},$e.fromObject=function(e){var t;return e instanceof s.perfetto.protos.AndroidPolledStateConfig?e:(t=new s.perfetto.protos.AndroidPolledStateConfig,null!=e.pollMs&&(t.pollMs=e.pollMs>>>0),t)},$e.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.pollMs=0),null!=e.pollMs&&e.hasOwnProperty("pollMs")&&(r.pollMs=e.pollMs),r},$e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},$e.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.AndroidPolledStateConfig"},$e),r.AndroidSystemPropertyConfig=(ze.prototype.pollMs=0,ze.prototype.propertyName=i.emptyArray,ze.create=function(e){return new ze(e)},ze.encode=function(e,t){if(t=t||a.create(),null!=e.pollMs&&Object.hasOwnProperty.call(e,"pollMs")&&t.uint32(8).uint32(e.pollMs),null!=e.propertyName&&e.propertyName.length)for(var r=0;r<e.propertyName.length;++r)t.uint32(18).string(e.propertyName[r]);return t},ze.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.AndroidSystemPropertyConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.pollMs=e.uint32();break;case 2:n.propertyName&&n.propertyName.length||(n.propertyName=[]),n.propertyName.push(e.string());break;default:e.skipType(7&a)}}return n},ze.fromObject=function(e){if(e instanceof s.perfetto.protos.AndroidSystemPropertyConfig)return e;var t=new s.perfetto.protos.AndroidSystemPropertyConfig;if(null!=e.pollMs&&(t.pollMs=e.pollMs>>>0),e.propertyName){if(!Array.isArray(e.propertyName))throw TypeError(".perfetto.protos.AndroidSystemPropertyConfig.propertyName: array expected");t.propertyName=[];for(var r=0;r<e.propertyName.length;++r)t.propertyName[r]=String(e.propertyName[r])}return t},ze.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.propertyName=[]),t.defaults&&(r.pollMs=0),null!=e.pollMs&&e.hasOwnProperty("pollMs")&&(r.pollMs=e.pollMs),e.propertyName&&e.propertyName.length){r.propertyName=[];for(var n=0;n<e.propertyName.length;++n)r.propertyName[n]=e.propertyName[n]}return r},ze.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},ze.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.AndroidSystemPropertyConfig"},ze),r.AndroidSdkSyspropGuardConfig=(Ke.prototype.surfaceflingerSkiaTrackEvents=!1,Ke.prototype.hwuiSkiaTrackEvents=!1,Ke.prototype.hwuiPackageNameFilter=i.emptyArray,Ke.create=function(e){return new Ke(e)},Ke.encode=function(e,t){if(t=t||a.create(),null!=e.surfaceflingerSkiaTrackEvents&&Object.hasOwnProperty.call(e,"surfaceflingerSkiaTrackEvents")&&t.uint32(8).bool(e.surfaceflingerSkiaTrackEvents),null!=e.hwuiSkiaTrackEvents&&Object.hasOwnProperty.call(e,"hwuiSkiaTrackEvents")&&t.uint32(16).bool(e.hwuiSkiaTrackEvents),null!=e.hwuiPackageNameFilter&&e.hwuiPackageNameFilter.length)for(var r=0;r<e.hwuiPackageNameFilter.length;++r)t.uint32(26).string(e.hwuiPackageNameFilter[r]);return t},Ke.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.AndroidSdkSyspropGuardConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.surfaceflingerSkiaTrackEvents=e.bool();break;case 2:n.hwuiSkiaTrackEvents=e.bool();break;case 3:n.hwuiPackageNameFilter&&n.hwuiPackageNameFilter.length||(n.hwuiPackageNameFilter=[]),n.hwuiPackageNameFilter.push(e.string());break;default:e.skipType(7&a)}}return n},Ke.fromObject=function(e){if(e instanceof s.perfetto.protos.AndroidSdkSyspropGuardConfig)return e;var t=new s.perfetto.protos.AndroidSdkSyspropGuardConfig;if(null!=e.surfaceflingerSkiaTrackEvents&&(t.surfaceflingerSkiaTrackEvents=Boolean(e.surfaceflingerSkiaTrackEvents)),null!=e.hwuiSkiaTrackEvents&&(t.hwuiSkiaTrackEvents=Boolean(e.hwuiSkiaTrackEvents)),e.hwuiPackageNameFilter){if(!Array.isArray(e.hwuiPackageNameFilter))throw TypeError(".perfetto.protos.AndroidSdkSyspropGuardConfig.hwuiPackageNameFilter: array expected");t.hwuiPackageNameFilter=[];for(var r=0;r<e.hwuiPackageNameFilter.length;++r)t.hwuiPackageNameFilter[r]=String(e.hwuiPackageNameFilter[r])}return t},Ke.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.hwuiPackageNameFilter=[]),t.defaults&&(r.surfaceflingerSkiaTrackEvents=!1,r.hwuiSkiaTrackEvents=!1),null!=e.surfaceflingerSkiaTrackEvents&&e.hasOwnProperty("surfaceflingerSkiaTrackEvents")&&(r.surfaceflingerSkiaTrackEvents=e.surfaceflingerSkiaTrackEvents),null!=e.hwuiSkiaTrackEvents&&e.hasOwnProperty("hwuiSkiaTrackEvents")&&(r.hwuiSkiaTrackEvents=e.hwuiSkiaTrackEvents),e.hwuiPackageNameFilter&&e.hwuiPackageNameFilter.length){r.hwuiPackageNameFilter=[];for(var n=0;n<e.hwuiPackageNameFilter.length;++n)r.hwuiPackageNameFilter[n]=e.hwuiPackageNameFilter[n]}return r},Ke.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Ke.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.AndroidSdkSyspropGuardConfig"},Ke),r.NetworkPacketTraceConfig=(Ye.prototype.pollMs=0,Ye.prototype.aggregationThreshold=0,Ye.prototype.internLimit=0,Ye.prototype.dropLocalPort=!1,Ye.prototype.dropRemotePort=!1,Ye.prototype.dropTcpFlags=!1,Ye.create=function(e){return new Ye(e)},Ye.encode=function(e,t){return t=t||a.create(),null!=e.pollMs&&Object.hasOwnProperty.call(e,"pollMs")&&t.uint32(8).uint32(e.pollMs),null!=e.aggregationThreshold&&Object.hasOwnProperty.call(e,"aggregationThreshold")&&t.uint32(16).uint32(e.aggregationThreshold),null!=e.internLimit&&Object.hasOwnProperty.call(e,"internLimit")&&t.uint32(24).uint32(e.internLimit),null!=e.dropLocalPort&&Object.hasOwnProperty.call(e,"dropLocalPort")&&t.uint32(32).bool(e.dropLocalPort),null!=e.dropRemotePort&&Object.hasOwnProperty.call(e,"dropRemotePort")&&t.uint32(40).bool(e.dropRemotePort),null!=e.dropTcpFlags&&Object.hasOwnProperty.call(e,"dropTcpFlags")&&t.uint32(48).bool(e.dropTcpFlags),t},Ye.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.NetworkPacketTraceConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.pollMs=e.uint32();break;case 2:n.aggregationThreshold=e.uint32();break;case 3:n.internLimit=e.uint32();break;case 4:n.dropLocalPort=e.bool();break;case 5:n.dropRemotePort=e.bool();break;case 6:n.dropTcpFlags=e.bool();break;default:e.skipType(7&a)}}return n},Ye.fromObject=function(e){var t;return e instanceof s.perfetto.protos.NetworkPacketTraceConfig?e:(t=new s.perfetto.protos.NetworkPacketTraceConfig,null!=e.pollMs&&(t.pollMs=e.pollMs>>>0),null!=e.aggregationThreshold&&(t.aggregationThreshold=e.aggregationThreshold>>>0),null!=e.internLimit&&(t.internLimit=e.internLimit>>>0),null!=e.dropLocalPort&&(t.dropLocalPort=Boolean(e.dropLocalPort)),null!=e.dropRemotePort&&(t.dropRemotePort=Boolean(e.dropRemotePort)),null!=e.dropTcpFlags&&(t.dropTcpFlags=Boolean(e.dropTcpFlags)),t)},Ye.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.pollMs=0,r.aggregationThreshold=0,r.internLimit=0,r.dropLocalPort=!1,r.dropRemotePort=!1,r.dropTcpFlags=!1),null!=e.pollMs&&e.hasOwnProperty("pollMs")&&(r.pollMs=e.pollMs),null!=e.aggregationThreshold&&e.hasOwnProperty("aggregationThreshold")&&(r.aggregationThreshold=e.aggregationThreshold),null!=e.internLimit&&e.hasOwnProperty("internLimit")&&(r.internLimit=e.internLimit),null!=e.dropLocalPort&&e.hasOwnProperty("dropLocalPort")&&(r.dropLocalPort=e.dropLocalPort),null!=e.dropRemotePort&&e.hasOwnProperty("dropRemotePort")&&(r.dropRemotePort=e.dropRemotePort),null!=e.dropTcpFlags&&e.hasOwnProperty("dropTcpFlags")&&(r.dropTcpFlags=e.dropTcpFlags),r},Ye.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Ye.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.NetworkPacketTraceConfig"},Ye),r.PackagesListConfig=(Je.prototype.packageNameFilter=i.emptyArray,Je.create=function(e){return new Je(e)},Je.encode=function(e,t){if(t=t||a.create(),null!=e.packageNameFilter&&e.packageNameFilter.length)for(var r=0;r<e.packageNameFilter.length;++r)t.uint32(10).string(e.packageNameFilter[r]);return t},Je.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.PackagesListConfig;e.pos<r;){var a=e.uint32();a>>>3==1?(n.packageNameFilter&&n.packageNameFilter.length||(n.packageNameFilter=[]),n.packageNameFilter.push(e.string())):e.skipType(7&a)}return n},Je.fromObject=function(e){if(e instanceof s.perfetto.protos.PackagesListConfig)return e;var t=new s.perfetto.protos.PackagesListConfig;if(e.packageNameFilter){if(!Array.isArray(e.packageNameFilter))throw TypeError(".perfetto.protos.PackagesListConfig.packageNameFilter: array expected");t.packageNameFilter=[];for(var r=0;r<e.packageNameFilter.length;++r)t.packageNameFilter[r]=String(e.packageNameFilter[r])}return t},Je.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.packageNameFilter=[]),e.packageNameFilter&&e.packageNameFilter.length){r.packageNameFilter=[];for(var n=0;n<e.packageNameFilter.length;++n)r.packageNameFilter[n]=e.packageNameFilter[n]}return r},Je.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Je.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.PackagesListConfig"},Je),r.PixelModemConfig=(Ze.prototype.eventGroup=0,Ze.prototype.pigweedHashAllowList=i.emptyArray,Ze.prototype.pigweedHashDenyList=i.emptyArray,Ze.create=function(e){return new Ze(e)},Ze.encode=function(e,t){if(t=t||a.create(),null!=e.eventGroup&&Object.hasOwnProperty.call(e,"eventGroup")&&t.uint32(8).int32(e.eventGroup),null!=e.pigweedHashAllowList&&e.pigweedHashAllowList.length)for(var r=0;r<e.pigweedHashAllowList.length;++r)t.uint32(16).int64(e.pigweedHashAllowList[r]);if(null!=e.pigweedHashDenyList&&e.pigweedHashDenyList.length)for(r=0;r<e.pigweedHashDenyList.length;++r)t.uint32(24).int64(e.pigweedHashDenyList[r]);return t},Ze.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.PixelModemConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.eventGroup=e.int32();break;case 2:if(n.pigweedHashAllowList&&n.pigweedHashAllowList.length||(n.pigweedHashAllowList=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.pigweedHashAllowList.push(e.int64());else n.pigweedHashAllowList.push(e.int64());break;case 3:if(n.pigweedHashDenyList&&n.pigweedHashDenyList.length||(n.pigweedHashDenyList=[]),2==(7&a))for(i=e.uint32()+e.pos;e.pos<i;)n.pigweedHashDenyList.push(e.int64());else n.pigweedHashDenyList.push(e.int64());break;default:e.skipType(7&a)}}return n},Ze.fromObject=function(e){if(e instanceof s.perfetto.protos.PixelModemConfig)return e;var t=new s.perfetto.protos.PixelModemConfig;switch(e.eventGroup){default:"number"==typeof e.eventGroup&&(t.eventGroup=e.eventGroup);break;case"EVENT_GROUP_UNKNOWN":case 0:t.eventGroup=0;break;case"EVENT_GROUP_LOW_BANDWIDTH":case 1:t.eventGroup=1;break;case"EVENT_GROUP_HIGH_AND_LOW_BANDWIDTH":case 2:t.eventGroup=2}if(e.pigweedHashAllowList){if(!Array.isArray(e.pigweedHashAllowList))throw TypeError(".perfetto.protos.PixelModemConfig.pigweedHashAllowList: array expected");t.pigweedHashAllowList=[];for(var r=0;r<e.pigweedHashAllowList.length;++r)i.Long?(t.pigweedHashAllowList[r]=i.Long.fromValue(e.pigweedHashAllowList[r])).unsigned=!1:"string"==typeof e.pigweedHashAllowList[r]?t.pigweedHashAllowList[r]=parseInt(e.pigweedHashAllowList[r],10):"number"==typeof e.pigweedHashAllowList[r]?t.pigweedHashAllowList[r]=e.pigweedHashAllowList[r]:"object"==typeof e.pigweedHashAllowList[r]&&(t.pigweedHashAllowList[r]=new i.LongBits(e.pigweedHashAllowList[r].low>>>0,e.pigweedHashAllowList[r].high>>>0).toNumber())}if(e.pigweedHashDenyList){if(!Array.isArray(e.pigweedHashDenyList))throw TypeError(".perfetto.protos.PixelModemConfig.pigweedHashDenyList: array expected");t.pigweedHashDenyList=[];for(r=0;r<e.pigweedHashDenyList.length;++r)i.Long?(t.pigweedHashDenyList[r]=i.Long.fromValue(e.pigweedHashDenyList[r])).unsigned=!1:"string"==typeof e.pigweedHashDenyList[r]?t.pigweedHashDenyList[r]=parseInt(e.pigweedHashDenyList[r],10):"number"==typeof e.pigweedHashDenyList[r]?t.pigweedHashDenyList[r]=e.pigweedHashDenyList[r]:"object"==typeof e.pigweedHashDenyList[r]&&(t.pigweedHashDenyList[r]=new i.LongBits(e.pigweedHashDenyList[r].low>>>0,e.pigweedHashDenyList[r].high>>>0).toNumber())}return t},Ze.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.pigweedHashAllowList=[],r.pigweedHashDenyList=[]),t.defaults&&(r.eventGroup=t.enums===String?"EVENT_GROUP_UNKNOWN":0),null!=e.eventGroup&&e.hasOwnProperty("eventGroup")&&(r.eventGroup=t.enums!==String||void 0===s.perfetto.protos.PixelModemConfig.EventGroup[e.eventGroup]?e.eventGroup:s.perfetto.protos.PixelModemConfig.EventGroup[e.eventGroup]),e.pigweedHashAllowList&&e.pigweedHashAllowList.length){r.pigweedHashAllowList=[];for(var n=0;n<e.pigweedHashAllowList.length;++n)"number"==typeof e.pigweedHashAllowList[n]?r.pigweedHashAllowList[n]=t.longs===String?String(e.pigweedHashAllowList[n]):e.pigweedHashAllowList[n]:r.pigweedHashAllowList[n]=t.longs===String?i.Long.prototype.toString.call(e.pigweedHashAllowList[n]):t.longs===Number?new i.LongBits(e.pigweedHashAllowList[n].low>>>0,e.pigweedHashAllowList[n].high>>>0).toNumber():e.pigweedHashAllowList[n]}if(e.pigweedHashDenyList&&e.pigweedHashDenyList.length){r.pigweedHashDenyList=[];for(n=0;n<e.pigweedHashDenyList.length;++n)"number"==typeof e.pigweedHashDenyList[n]?r.pigweedHashDenyList[n]=t.longs===String?String(e.pigweedHashDenyList[n]):e.pigweedHashDenyList[n]:r.pigweedHashDenyList[n]=t.longs===String?i.Long.prototype.toString.call(e.pigweedHashDenyList[n]):t.longs===Number?new i.LongBits(e.pigweedHashDenyList[n].low>>>0,e.pigweedHashDenyList[n].high>>>0).toNumber():e.pigweedHashDenyList[n]}return r},Ze.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Ze.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.PixelModemConfig"},Ze.EventGroup=(t={},(e=Object.create(t))[t[0]="EVENT_GROUP_UNKNOWN"]=0,e[t[1]="EVENT_GROUP_LOW_BANDWIDTH"]=1,e[t[2]="EVENT_GROUP_HIGH_AND_LOW_BANDWIDTH"]=2,e),Ze),r.ProtoLogConfig=(Qe.prototype.groupOverrides=i.emptyArray,Qe.prototype.tracingMode=0,Qe.prototype.defaultLogFromLevel=0,Qe.create=function(e){return new Qe(e)},Qe.encode=function(e,t){if(t=t||a.create(),null!=e.groupOverrides&&e.groupOverrides.length)for(var r=0;r<e.groupOverrides.length;++r)s.perfetto.protos.ProtoLogGroup.encode(e.groupOverrides[r],t.uint32(10).fork()).ldelim();return null!=e.tracingMode&&Object.hasOwnProperty.call(e,"tracingMode")&&t.uint32(16).int32(e.tracingMode),null!=e.defaultLogFromLevel&&Object.hasOwnProperty.call(e,"defaultLogFromLevel")&&t.uint32(24).int32(e.defaultLogFromLevel),t},Qe.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.ProtoLogConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.groupOverrides&&n.groupOverrides.length||(n.groupOverrides=[]),n.groupOverrides.push(s.perfetto.protos.ProtoLogGroup.decode(e,e.uint32()));break;case 2:n.tracingMode=e.int32();break;case 3:n.defaultLogFromLevel=e.int32();break;default:e.skipType(7&a)}}return n},Qe.fromObject=function(e){if(e instanceof s.perfetto.protos.ProtoLogConfig)return e;var t=new s.perfetto.protos.ProtoLogConfig;if(e.groupOverrides){if(!Array.isArray(e.groupOverrides))throw TypeError(".perfetto.protos.ProtoLogConfig.groupOverrides: array expected");t.groupOverrides=[];for(var r=0;r<e.groupOverrides.length;++r){if("object"!=typeof e.groupOverrides[r])throw TypeError(".perfetto.protos.ProtoLogConfig.groupOverrides: object expected");t.groupOverrides[r]=s.perfetto.protos.ProtoLogGroup.fromObject(e.groupOverrides[r])}}switch(e.tracingMode){default:"number"==typeof e.tracingMode&&(t.tracingMode=e.tracingMode);break;case"DEFAULT":case 0:t.tracingMode=0;break;case"ENABLE_ALL":case 1:t.tracingMode=1}switch(e.defaultLogFromLevel){default:"number"==typeof e.defaultLogFromLevel&&(t.defaultLogFromLevel=e.defaultLogFromLevel);break;case"PROTOLOG_LEVEL_UNDEFINED":case 0:t.defaultLogFromLevel=0;break;case"PROTOLOG_LEVEL_DEBUG":case 1:t.defaultLogFromLevel=1;break;case"PROTOLOG_LEVEL_VERBOSE":case 2:t.defaultLogFromLevel=2;break;case"PROTOLOG_LEVEL_INFO":case 3:t.defaultLogFromLevel=3;break;case"PROTOLOG_LEVEL_WARN":case 4:t.defaultLogFromLevel=4;break;case"PROTOLOG_LEVEL_ERROR":case 5:t.defaultLogFromLevel=5;break;case"PROTOLOG_LEVEL_WTF":case 6:t.defaultLogFromLevel=6}return t},Qe.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.groupOverrides=[]),t.defaults&&(r.tracingMode=t.enums===String?"DEFAULT":0,r.defaultLogFromLevel=t.enums===String?"PROTOLOG_LEVEL_UNDEFINED":0),e.groupOverrides&&e.groupOverrides.length){r.groupOverrides=[];for(var n=0;n<e.groupOverrides.length;++n)r.groupOverrides[n]=s.perfetto.protos.ProtoLogGroup.toObject(e.groupOverrides[n],t)}return null!=e.tracingMode&&e.hasOwnProperty("tracingMode")&&(r.tracingMode=t.enums!==String||void 0===s.perfetto.protos.ProtoLogConfig.TracingMode[e.tracingMode]?e.tracingMode:s.perfetto.protos.ProtoLogConfig.TracingMode[e.tracingMode]),null!=e.defaultLogFromLevel&&e.hasOwnProperty("defaultLogFromLevel")&&(r.defaultLogFromLevel=t.enums!==String||void 0===s.perfetto.protos.ProtoLogLevel[e.defaultLogFromLevel]?e.defaultLogFromLevel:s.perfetto.protos.ProtoLogLevel[e.defaultLogFromLevel]),r},Qe.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Qe.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.ProtoLogConfig"},Qe.TracingMode=(t={},(e=Object.create(t))[t[0]="DEFAULT"]=0,e[t[1]="ENABLE_ALL"]=1,e),Qe),r.ProtoLogGroup=(Xe.prototype.groupName="",Xe.prototype.logFrom=0,Xe.prototype.collectStacktrace=!1,Xe.create=function(e){return new Xe(e)},Xe.encode=function(e,t){return t=t||a.create(),null!=e.groupName&&Object.hasOwnProperty.call(e,"groupName")&&t.uint32(10).string(e.groupName),null!=e.logFrom&&Object.hasOwnProperty.call(e,"logFrom")&&t.uint32(16).int32(e.logFrom),null!=e.collectStacktrace&&Object.hasOwnProperty.call(e,"collectStacktrace")&&t.uint32(24).bool(e.collectStacktrace),t},Xe.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.ProtoLogGroup;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.groupName=e.string();break;case 2:n.logFrom=e.int32();break;case 3:n.collectStacktrace=e.bool();break;default:e.skipType(7&a)}}return n},Xe.fromObject=function(e){if(e instanceof s.perfetto.protos.ProtoLogGroup)return e;var t=new s.perfetto.protos.ProtoLogGroup;switch(null!=e.groupName&&(t.groupName=String(e.groupName)),e.logFrom){default:"number"==typeof e.logFrom&&(t.logFrom=e.logFrom);break;case"PROTOLOG_LEVEL_UNDEFINED":case 0:t.logFrom=0;break;case"PROTOLOG_LEVEL_DEBUG":case 1:t.logFrom=1;break;case"PROTOLOG_LEVEL_VERBOSE":case 2:t.logFrom=2;break;case"PROTOLOG_LEVEL_INFO":case 3:t.logFrom=3;break;case"PROTOLOG_LEVEL_WARN":case 4:t.logFrom=4;break;case"PROTOLOG_LEVEL_ERROR":case 5:t.logFrom=5;break;case"PROTOLOG_LEVEL_WTF":case 6:t.logFrom=6}return null!=e.collectStacktrace&&(t.collectStacktrace=Boolean(e.collectStacktrace)),t},Xe.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.groupName="",r.logFrom=t.enums===String?"PROTOLOG_LEVEL_UNDEFINED":0,r.collectStacktrace=!1),null!=e.groupName&&e.hasOwnProperty("groupName")&&(r.groupName=e.groupName),null!=e.logFrom&&e.hasOwnProperty("logFrom")&&(r.logFrom=t.enums!==String||void 0===s.perfetto.protos.ProtoLogLevel[e.logFrom]?e.logFrom:s.perfetto.protos.ProtoLogLevel[e.logFrom]),null!=e.collectStacktrace&&e.hasOwnProperty("collectStacktrace")&&(r.collectStacktrace=e.collectStacktrace),r},Xe.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Xe.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.ProtoLogGroup"},Xe),r.ProtoLogLevel=(t={},(e=Object.create(t))[t[0]="PROTOLOG_LEVEL_UNDEFINED"]=0,e[t[1]="PROTOLOG_LEVEL_DEBUG"]=1,e[t[2]="PROTOLOG_LEVEL_VERBOSE"]=2,e[t[3]="PROTOLOG_LEVEL_INFO"]=3,e[t[4]="PROTOLOG_LEVEL_WARN"]=4,e[t[5]="PROTOLOG_LEVEL_ERROR"]=5,e[t[6]="PROTOLOG_LEVEL_WTF"]=6,e),r.SurfaceFlingerLayersConfig=(et.prototype.mode=0,et.prototype.traceFlags=i.emptyArray,et.create=function(e){return new et(e)},et.encode=function(e,t){if(t=t||a.create(),null!=e.mode&&Object.hasOwnProperty.call(e,"mode")&&t.uint32(8).int32(e.mode),null!=e.traceFlags&&e.traceFlags.length)for(var r=0;r<e.traceFlags.length;++r)t.uint32(16).int32(e.traceFlags[r]);return t},et.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.SurfaceFlingerLayersConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.mode=e.int32();break;case 2:if(n.traceFlags&&n.traceFlags.length||(n.traceFlags=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.traceFlags.push(e.int32());else n.traceFlags.push(e.int32());break;default:e.skipType(7&a)}}return n},et.fromObject=function(e){if(e instanceof s.perfetto.protos.SurfaceFlingerLayersConfig)return e;var t=new s.perfetto.protos.SurfaceFlingerLayersConfig;switch(e.mode){default:"number"==typeof e.mode&&(t.mode=e.mode);break;case"MODE_UNSPECIFIED":case 0:t.mode=0;break;case"MODE_ACTIVE":case 1:t.mode=1;break;case"MODE_GENERATED":case 2:t.mode=2;break;case"MODE_DUMP":case 3:t.mode=3;break;case"MODE_GENERATED_BUGREPORT_ONLY":case 4:t.mode=4}if(e.traceFlags){if(!Array.isArray(e.traceFlags))throw TypeError(".perfetto.protos.SurfaceFlingerLayersConfig.traceFlags: array expected");t.traceFlags=[];for(var r=0;r<e.traceFlags.length;++r)switch(e.traceFlags[r]){default:if("number"==typeof e.traceFlags[r]){t.traceFlags[r]=e.traceFlags[r];break}case"TRACE_FLAG_UNSPECIFIED":case 0:t.traceFlags[r]=0;break;case"TRACE_FLAG_INPUT":case 2:t.traceFlags[r]=2;break;case"TRACE_FLAG_COMPOSITION":case 4:t.traceFlags[r]=4;break;case"TRACE_FLAG_EXTRA":case 8:t.traceFlags[r]=8;break;case"TRACE_FLAG_HWC":case 16:t.traceFlags[r]=16;break;case"TRACE_FLAG_BUFFERS":case 32:t.traceFlags[r]=32;break;case"TRACE_FLAG_VIRTUAL_DISPLAYS":case 64:t.traceFlags[r]=64;break;case"TRACE_FLAG_ALL":case 14:t.traceFlags[r]=14}}return t},et.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.traceFlags=[]),t.defaults&&(r.mode=t.enums===String?"MODE_UNSPECIFIED":0),null!=e.mode&&e.hasOwnProperty("mode")&&(r.mode=t.enums!==String||void 0===s.perfetto.protos.SurfaceFlingerLayersConfig.Mode[e.mode]?e.mode:s.perfetto.protos.SurfaceFlingerLayersConfig.Mode[e.mode]),e.traceFlags&&e.traceFlags.length){r.traceFlags=[];for(var n=0;n<e.traceFlags.length;++n)r.traceFlags[n]=t.enums!==String||void 0===s.perfetto.protos.SurfaceFlingerLayersConfig.TraceFlag[e.traceFlags[n]]?e.traceFlags[n]:s.perfetto.protos.SurfaceFlingerLayersConfig.TraceFlag[e.traceFlags[n]]}return r},et.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},et.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.SurfaceFlingerLayersConfig"},et.Mode=(t={},(e=Object.create(t))[t[0]="MODE_UNSPECIFIED"]=0,e[t[1]="MODE_ACTIVE"]=1,e[t[2]="MODE_GENERATED"]=2,e[t[3]="MODE_DUMP"]=3,e[t[4]="MODE_GENERATED_BUGREPORT_ONLY"]=4,e),et.TraceFlag=(t={},(e=Object.create(t))[t[0]="TRACE_FLAG_UNSPECIFIED"]=0,e[t[2]="TRACE_FLAG_INPUT"]=2,e[t[4]="TRACE_FLAG_COMPOSITION"]=4,e[t[8]="TRACE_FLAG_EXTRA"]=8,e[t[16]="TRACE_FLAG_HWC"]=16,e[t[32]="TRACE_FLAG_BUFFERS"]=32,e[t[64]="TRACE_FLAG_VIRTUAL_DISPLAYS"]=64,e[t[14]="TRACE_FLAG_ALL"]=14,e),et),r.SurfaceFlingerTransactionsConfig=(tt.prototype.mode=0,tt.create=function(e){return new tt(e)},tt.encode=function(e,t){return t=t||a.create(),null!=e.mode&&Object.hasOwnProperty.call(e,"mode")&&t.uint32(8).int32(e.mode),t},tt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.SurfaceFlingerTransactionsConfig;e.pos<r;){var a=e.uint32();a>>>3==1?n.mode=e.int32():e.skipType(7&a)}return n},tt.fromObject=function(e){if(e instanceof s.perfetto.protos.SurfaceFlingerTransactionsConfig)return e;var t=new s.perfetto.protos.SurfaceFlingerTransactionsConfig;switch(e.mode){default:"number"==typeof e.mode&&(t.mode=e.mode);break;case"MODE_UNSPECIFIED":case 0:t.mode=0;break;case"MODE_CONTINUOUS":case 1:t.mode=1;break;case"MODE_ACTIVE":case 2:t.mode=2}return t},tt.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.mode=t.enums===String?"MODE_UNSPECIFIED":0),null!=e.mode&&e.hasOwnProperty("mode")&&(r.mode=t.enums!==String||void 0===s.perfetto.protos.SurfaceFlingerTransactionsConfig.Mode[e.mode]?e.mode:s.perfetto.protos.SurfaceFlingerTransactionsConfig.Mode[e.mode]),r},tt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},tt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.SurfaceFlingerTransactionsConfig"},tt.Mode=(t={},(e=Object.create(t))[t[0]="MODE_UNSPECIFIED"]=0,e[t[1]="MODE_CONTINUOUS"]=1,e[t[2]="MODE_ACTIVE"]=2,e),tt),r.WindowManagerConfig=(rt.prototype.logFrequency=0,rt.prototype.logLevel=0,rt.create=function(e){return new rt(e)},rt.encode=function(e,t){return t=t||a.create(),null!=e.logFrequency&&Object.hasOwnProperty.call(e,"logFrequency")&&t.uint32(8).int32(e.logFrequency),null!=e.logLevel&&Object.hasOwnProperty.call(e,"logLevel")&&t.uint32(16).int32(e.logLevel),t},rt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.WindowManagerConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.logFrequency=e.int32();break;case 2:n.logLevel=e.int32();break;default:e.skipType(7&a)}}return n},rt.fromObject=function(e){if(e instanceof s.perfetto.protos.WindowManagerConfig)return e;var t=new s.perfetto.protos.WindowManagerConfig;switch(e.logFrequency){default:"number"==typeof e.logFrequency&&(t.logFrequency=e.logFrequency);break;case"LOG_FREQUENCY_UNSPECIFIED":case 0:t.logFrequency=0;break;case"LOG_FREQUENCY_FRAME":case 1:t.logFrequency=1;break;case"LOG_FREQUENCY_TRANSACTION":case 2:t.logFrequency=2}switch(e.logLevel){default:"number"==typeof e.logLevel&&(t.logLevel=e.logLevel);break;case"LOG_LEVEL_UNSPECIFIED":case 0:t.logLevel=0;break;case"LOG_LEVEL_VERBOSE":case 1:t.logLevel=1;break;case"LOG_LEVEL_DEBUG":case 2:t.logLevel=2;break;case"LOG_LEVEL_CRITICAL":case 3:t.logLevel=3}return t},rt.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.logFrequency=t.enums===String?"LOG_FREQUENCY_UNSPECIFIED":0,r.logLevel=t.enums===String?"LOG_LEVEL_UNSPECIFIED":0),null!=e.logFrequency&&e.hasOwnProperty("logFrequency")&&(r.logFrequency=t.enums!==String||void 0===s.perfetto.protos.WindowManagerConfig.LogFrequency[e.logFrequency]?e.logFrequency:s.perfetto.protos.WindowManagerConfig.LogFrequency[e.logFrequency]),null!=e.logLevel&&e.hasOwnProperty("logLevel")&&(r.logLevel=t.enums!==String||void 0===s.perfetto.protos.WindowManagerConfig.LogLevel[e.logLevel]?e.logLevel:s.perfetto.protos.WindowManagerConfig.LogLevel[e.logLevel]),r},rt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},rt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.WindowManagerConfig"},rt.LogFrequency=(t={},(e=Object.create(t))[t[0]="LOG_FREQUENCY_UNSPECIFIED"]=0,e[t[1]="LOG_FREQUENCY_FRAME"]=1,e[t[2]="LOG_FREQUENCY_TRANSACTION"]=2,e),rt.LogLevel=(t={},(e=Object.create(t))[t[0]="LOG_LEVEL_UNSPECIFIED"]=0,e[t[1]="LOG_LEVEL_VERBOSE"]=1,e[t[2]="LOG_LEVEL_DEBUG"]=2,e[t[3]="LOG_LEVEL_CRITICAL"]=3,e),rt),r.ChromeConfig=(nt.prototype.traceConfig="",nt.prototype.privacyFilteringEnabled=!1,nt.prototype.convertToLegacyJson=!1,nt.prototype.clientPriority=0,nt.prototype.jsonAgentLabelFilter="",nt.create=function(e){return new nt(e)},nt.encode=function(e,t){return t=t||a.create(),null!=e.traceConfig&&Object.hasOwnProperty.call(e,"traceConfig")&&t.uint32(10).string(e.traceConfig),null!=e.privacyFilteringEnabled&&Object.hasOwnProperty.call(e,"privacyFilteringEnabled")&&t.uint32(16).bool(e.privacyFilteringEnabled),null!=e.convertToLegacyJson&&Object.hasOwnProperty.call(e,"convertToLegacyJson")&&t.uint32(24).bool(e.convertToLegacyJson),null!=e.clientPriority&&Object.hasOwnProperty.call(e,"clientPriority")&&t.uint32(32).int32(e.clientPriority),null!=e.jsonAgentLabelFilter&&Object.hasOwnProperty.call(e,"jsonAgentLabelFilter")&&t.uint32(42).string(e.jsonAgentLabelFilter),t},nt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.ChromeConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.traceConfig=e.string();break;case 2:n.privacyFilteringEnabled=e.bool();break;case 3:n.convertToLegacyJson=e.bool();break;case 4:n.clientPriority=e.int32();break;case 5:n.jsonAgentLabelFilter=e.string();break;default:e.skipType(7&a)}}return n},nt.fromObject=function(e){if(e instanceof s.perfetto.protos.ChromeConfig)return e;var t=new s.perfetto.protos.ChromeConfig;switch(null!=e.traceConfig&&(t.traceConfig=String(e.traceConfig)),null!=e.privacyFilteringEnabled&&(t.privacyFilteringEnabled=Boolean(e.privacyFilteringEnabled)),null!=e.convertToLegacyJson&&(t.convertToLegacyJson=Boolean(e.convertToLegacyJson)),e.clientPriority){default:"number"==typeof e.clientPriority&&(t.clientPriority=e.clientPriority);break;case"UNKNOWN":case 0:t.clientPriority=0;break;case"BACKGROUND":case 1:t.clientPriority=1;break;case"USER_INITIATED":case 2:t.clientPriority=2}return null!=e.jsonAgentLabelFilter&&(t.jsonAgentLabelFilter=String(e.jsonAgentLabelFilter)),t},nt.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.traceConfig="",r.privacyFilteringEnabled=!1,r.convertToLegacyJson=!1,r.clientPriority=t.enums===String?"UNKNOWN":0,r.jsonAgentLabelFilter=""),null!=e.traceConfig&&e.hasOwnProperty("traceConfig")&&(r.traceConfig=e.traceConfig),null!=e.privacyFilteringEnabled&&e.hasOwnProperty("privacyFilteringEnabled")&&(r.privacyFilteringEnabled=e.privacyFilteringEnabled),null!=e.convertToLegacyJson&&e.hasOwnProperty("convertToLegacyJson")&&(r.convertToLegacyJson=e.convertToLegacyJson),null!=e.clientPriority&&e.hasOwnProperty("clientPriority")&&(r.clientPriority=t.enums!==String||void 0===s.perfetto.protos.ChromeConfig.ClientPriority[e.clientPriority]?e.clientPriority:s.perfetto.protos.ChromeConfig.ClientPriority[e.clientPriority]),null!=e.jsonAgentLabelFilter&&e.hasOwnProperty("jsonAgentLabelFilter")&&(r.jsonAgentLabelFilter=e.jsonAgentLabelFilter),r},nt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},nt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.ChromeConfig"},nt.ClientPriority=(t={},(e=Object.create(t))[t[0]="UNKNOWN"]=0,e[t[1]="BACKGROUND"]=1,e[t[2]="USER_INITIATED"]=2,e),nt),r.V8Config=(at.prototype.logScriptSources=!1,at.prototype.logInstructions=!1,at.create=function(e){return new at(e)},at.encode=function(e,t){return t=t||a.create(),null!=e.logScriptSources&&Object.hasOwnProperty.call(e,"logScriptSources")&&t.uint32(8).bool(e.logScriptSources),null!=e.logInstructions&&Object.hasOwnProperty.call(e,"logInstructions")&&t.uint32(16).bool(e.logInstructions),t},at.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.V8Config;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.logScriptSources=e.bool();break;case 2:n.logInstructions=e.bool();break;default:e.skipType(7&a)}}return n},at.fromObject=function(e){var t;return e instanceof s.perfetto.protos.V8Config?e:(t=new s.perfetto.protos.V8Config,null!=e.logScriptSources&&(t.logScriptSources=Boolean(e.logScriptSources)),null!=e.logInstructions&&(t.logInstructions=Boolean(e.logInstructions)),t)},at.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.logScriptSources=!1,r.logInstructions=!1),null!=e.logScriptSources&&e.hasOwnProperty("logScriptSources")&&(r.logScriptSources=e.logScriptSources),null!=e.logInstructions&&e.hasOwnProperty("logInstructions")&&(r.logInstructions=e.logInstructions),r},at.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},at.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.V8Config"},at),r.EtwConfig=(it.prototype.kernelFlags=i.emptyArray,it.create=function(e){return new it(e)},it.encode=function(e,t){if(t=t||a.create(),null!=e.kernelFlags&&e.kernelFlags.length)for(var r=0;r<e.kernelFlags.length;++r)t.uint32(8).int32(e.kernelFlags[r]);return t},it.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.EtwConfig;e.pos<r;){var a=e.uint32();if(a>>>3==1)if(n.kernelFlags&&n.kernelFlags.length||(n.kernelFlags=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.kernelFlags.push(e.int32());else n.kernelFlags.push(e.int32());else e.skipType(7&a)}return n},it.fromObject=function(e){if(e instanceof s.perfetto.protos.EtwConfig)return e;var t=new s.perfetto.protos.EtwConfig;if(e.kernelFlags){if(!Array.isArray(e.kernelFlags))throw TypeError(".perfetto.protos.EtwConfig.kernelFlags: array expected");t.kernelFlags=[];for(var r=0;r<e.kernelFlags.length;++r)switch(e.kernelFlags[r]){default:if("number"==typeof e.kernelFlags[r]){t.kernelFlags[r]=e.kernelFlags[r];break}case"CSWITCH":case 0:t.kernelFlags[r]=0;break;case"DISPATCHER":case 1:t.kernelFlags[r]=1}}return t},it.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.kernelFlags=[]),e.kernelFlags&&e.kernelFlags.length){r.kernelFlags=[];for(var n=0;n<e.kernelFlags.length;++n)r.kernelFlags[n]=t.enums!==String||void 0===s.perfetto.protos.EtwConfig.KernelFlag[e.kernelFlags[n]]?e.kernelFlags[n]:s.perfetto.protos.EtwConfig.KernelFlag[e.kernelFlags[n]]}return r},it.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},it.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.EtwConfig"},it.KernelFlag=(t={},(e=Object.create(t))[t[0]="CSWITCH"]=0,e[t[1]="DISPATCHER"]=1,e),it),r.FtraceConfig=(b.prototype.ftraceEvents=i.emptyArray,b.prototype.atraceCategories=i.emptyArray,b.prototype.atraceApps=i.emptyArray,b.prototype.atraceCategoriesPreferSdk=i.emptyArray,b.prototype.bufferSizeKb=0,b.prototype.drainPeriodMs=0,b.prototype.drainBufferPercent=0,b.prototype.compactSched=null,b.prototype.printFilter=null,b.prototype.symbolizeKsyms=!1,b.prototype.ksymsMemPolicy=0,b.prototype.initializeKsymsSynchronouslyForTesting=!1,b.prototype.throttleRssStat=!1,b.prototype.disableGenericEvents=!1,b.prototype.syscallEvents=i.emptyArray,b.prototype.enableFunctionGraph=!1,b.prototype.functionFilters=i.emptyArray,b.prototype.functionGraphRoots=i.emptyArray,b.prototype.preserveFtraceBuffer=!1,b.prototype.useMonotonicRawClock=!1,b.prototype.instanceName="",b.prototype.bufferSizeLowerBound=!1,b.create=function(e){return new b(e)},b.encode=function(e,t){if(t=t||a.create(),null!=e.ftraceEvents&&e.ftraceEvents.length)for(var r=0;r<e.ftraceEvents.length;++r)t.uint32(10).string(e.ftraceEvents[r]);if(null!=e.atraceCategories&&e.atraceCategories.length)for(r=0;r<e.atraceCategories.length;++r)t.uint32(18).string(e.atraceCategories[r]);if(null!=e.atraceApps&&e.atraceApps.length)for(r=0;r<e.atraceApps.length;++r)t.uint32(26).string(e.atraceApps[r]);if(null!=e.bufferSizeKb&&Object.hasOwnProperty.call(e,"bufferSizeKb")&&t.uint32(80).uint32(e.bufferSizeKb),null!=e.drainPeriodMs&&Object.hasOwnProperty.call(e,"drainPeriodMs")&&t.uint32(88).uint32(e.drainPeriodMs),null!=e.compactSched&&Object.hasOwnProperty.call(e,"compactSched")&&s.perfetto.protos.FtraceConfig.CompactSchedConfig.encode(e.compactSched,t.uint32(98).fork()).ldelim(),null!=e.symbolizeKsyms&&Object.hasOwnProperty.call(e,"symbolizeKsyms")&&t.uint32(104).bool(e.symbolizeKsyms),null!=e.initializeKsymsSynchronouslyForTesting&&Object.hasOwnProperty.call(e,"initializeKsymsSynchronouslyForTesting")&&t.uint32(112).bool(e.initializeKsymsSynchronouslyForTesting),null!=e.throttleRssStat&&Object.hasOwnProperty.call(e,"throttleRssStat")&&t.uint32(120).bool(e.throttleRssStat),null!=e.disableGenericEvents&&Object.hasOwnProperty.call(e,"disableGenericEvents")&&t.uint32(128).bool(e.disableGenericEvents),null!=e.ksymsMemPolicy&&Object.hasOwnProperty.call(e,"ksymsMemPolicy")&&t.uint32(136).int32(e.ksymsMemPolicy),null!=e.syscallEvents&&e.syscallEvents.length)for(r=0;r<e.syscallEvents.length;++r)t.uint32(146).string(e.syscallEvents[r]);if(null!=e.enableFunctionGraph&&Object.hasOwnProperty.call(e,"enableFunctionGraph")&&t.uint32(152).bool(e.enableFunctionGraph),null!=e.functionFilters&&e.functionFilters.length)for(r=0;r<e.functionFilters.length;++r)t.uint32(162).string(e.functionFilters[r]);if(null!=e.functionGraphRoots&&e.functionGraphRoots.length)for(r=0;r<e.functionGraphRoots.length;++r)t.uint32(170).string(e.functionGraphRoots[r]);if(null!=e.printFilter&&Object.hasOwnProperty.call(e,"printFilter")&&s.perfetto.protos.FtraceConfig.PrintFilter.encode(e.printFilter,t.uint32(178).fork()).ldelim(),null!=e.preserveFtraceBuffer&&Object.hasOwnProperty.call(e,"preserveFtraceBuffer")&&t.uint32(184).bool(e.preserveFtraceBuffer),null!=e.useMonotonicRawClock&&Object.hasOwnProperty.call(e,"useMonotonicRawClock")&&t.uint32(192).bool(e.useMonotonicRawClock),null!=e.instanceName&&Object.hasOwnProperty.call(e,"instanceName")&&t.uint32(202).string(e.instanceName),null!=e.drainBufferPercent&&Object.hasOwnProperty.call(e,"drainBufferPercent")&&t.uint32(208).uint32(e.drainBufferPercent),null!=e.bufferSizeLowerBound&&Object.hasOwnProperty.call(e,"bufferSizeLowerBound")&&t.uint32(216).bool(e.bufferSizeLowerBound),null!=e.atraceCategoriesPreferSdk&&e.atraceCategoriesPreferSdk.length)for(r=0;r<e.atraceCategoriesPreferSdk.length;++r)t.uint32(226).string(e.atraceCategoriesPreferSdk[r]);return t},b.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.FtraceConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.ftraceEvents&&n.ftraceEvents.length||(n.ftraceEvents=[]),n.ftraceEvents.push(e.string());break;case 2:n.atraceCategories&&n.atraceCategories.length||(n.atraceCategories=[]),n.atraceCategories.push(e.string());break;case 3:n.atraceApps&&n.atraceApps.length||(n.atraceApps=[]),n.atraceApps.push(e.string());break;case 28:n.atraceCategoriesPreferSdk&&n.atraceCategoriesPreferSdk.length||(n.atraceCategoriesPreferSdk=[]),n.atraceCategoriesPreferSdk.push(e.string());break;case 10:n.bufferSizeKb=e.uint32();break;case 11:n.drainPeriodMs=e.uint32();break;case 26:n.drainBufferPercent=e.uint32();break;case 12:n.compactSched=s.perfetto.protos.FtraceConfig.CompactSchedConfig.decode(e,e.uint32());break;case 22:n.printFilter=s.perfetto.protos.FtraceConfig.PrintFilter.decode(e,e.uint32());break;case 13:n.symbolizeKsyms=e.bool();break;case 17:n.ksymsMemPolicy=e.int32();break;case 14:n.initializeKsymsSynchronouslyForTesting=e.bool();break;case 15:n.throttleRssStat=e.bool();break;case 16:n.disableGenericEvents=e.bool();break;case 18:n.syscallEvents&&n.syscallEvents.length||(n.syscallEvents=[]),n.syscallEvents.push(e.string());break;case 19:n.enableFunctionGraph=e.bool();break;case 20:n.functionFilters&&n.functionFilters.length||(n.functionFilters=[]),n.functionFilters.push(e.string());break;case 21:n.functionGraphRoots&&n.functionGraphRoots.length||(n.functionGraphRoots=[]),n.functionGraphRoots.push(e.string());break;case 23:n.preserveFtraceBuffer=e.bool();break;case 24:n.useMonotonicRawClock=e.bool();break;case 25:n.instanceName=e.string();break;case 27:n.bufferSizeLowerBound=e.bool();break;default:e.skipType(7&a)}}return n},b.fromObject=function(e){if(e instanceof s.perfetto.protos.FtraceConfig)return e;var t=new s.perfetto.protos.FtraceConfig;if(e.ftraceEvents){if(!Array.isArray(e.ftraceEvents))throw TypeError(".perfetto.protos.FtraceConfig.ftraceEvents: array expected");t.ftraceEvents=[];for(var r=0;r<e.ftraceEvents.length;++r)t.ftraceEvents[r]=String(e.ftraceEvents[r])}if(e.atraceCategories){if(!Array.isArray(e.atraceCategories))throw TypeError(".perfetto.protos.FtraceConfig.atraceCategories: array expected");t.atraceCategories=[];for(r=0;r<e.atraceCategories.length;++r)t.atraceCategories[r]=String(e.atraceCategories[r])}if(e.atraceApps){if(!Array.isArray(e.atraceApps))throw TypeError(".perfetto.protos.FtraceConfig.atraceApps: array expected");t.atraceApps=[];for(r=0;r<e.atraceApps.length;++r)t.atraceApps[r]=String(e.atraceApps[r])}if(e.atraceCategoriesPreferSdk){if(!Array.isArray(e.atraceCategoriesPreferSdk))throw TypeError(".perfetto.protos.FtraceConfig.atraceCategoriesPreferSdk: array expected");t.atraceCategoriesPreferSdk=[];for(r=0;r<e.atraceCategoriesPreferSdk.length;++r)t.atraceCategoriesPreferSdk[r]=String(e.atraceCategoriesPreferSdk[r])}if(null!=e.bufferSizeKb&&(t.bufferSizeKb=e.bufferSizeKb>>>0),null!=e.drainPeriodMs&&(t.drainPeriodMs=e.drainPeriodMs>>>0),null!=e.drainBufferPercent&&(t.drainBufferPercent=e.drainBufferPercent>>>0),null!=e.compactSched){if("object"!=typeof e.compactSched)throw TypeError(".perfetto.protos.FtraceConfig.compactSched: object expected");t.compactSched=s.perfetto.protos.FtraceConfig.CompactSchedConfig.fromObject(e.compactSched)}if(null!=e.printFilter){if("object"!=typeof e.printFilter)throw TypeError(".perfetto.protos.FtraceConfig.printFilter: object expected");t.printFilter=s.perfetto.protos.FtraceConfig.PrintFilter.fromObject(e.printFilter)}switch(null!=e.symbolizeKsyms&&(t.symbolizeKsyms=Boolean(e.symbolizeKsyms)),e.ksymsMemPolicy){default:"number"==typeof e.ksymsMemPolicy&&(t.ksymsMemPolicy=e.ksymsMemPolicy);break;case"KSYMS_UNSPECIFIED":case 0:t.ksymsMemPolicy=0;break;case"KSYMS_CLEANUP_ON_STOP":case 1:t.ksymsMemPolicy=1;break;case"KSYMS_RETAIN":case 2:t.ksymsMemPolicy=2}if(null!=e.initializeKsymsSynchronouslyForTesting&&(t.initializeKsymsSynchronouslyForTesting=Boolean(e.initializeKsymsSynchronouslyForTesting)),null!=e.throttleRssStat&&(t.throttleRssStat=Boolean(e.throttleRssStat)),null!=e.disableGenericEvents&&(t.disableGenericEvents=Boolean(e.disableGenericEvents)),e.syscallEvents){if(!Array.isArray(e.syscallEvents))throw TypeError(".perfetto.protos.FtraceConfig.syscallEvents: array expected");t.syscallEvents=[];for(r=0;r<e.syscallEvents.length;++r)t.syscallEvents[r]=String(e.syscallEvents[r])}if(null!=e.enableFunctionGraph&&(t.enableFunctionGraph=Boolean(e.enableFunctionGraph)),e.functionFilters){if(!Array.isArray(e.functionFilters))throw TypeError(".perfetto.protos.FtraceConfig.functionFilters: array expected");t.functionFilters=[];for(r=0;r<e.functionFilters.length;++r)t.functionFilters[r]=String(e.functionFilters[r])}if(e.functionGraphRoots){if(!Array.isArray(e.functionGraphRoots))throw TypeError(".perfetto.protos.FtraceConfig.functionGraphRoots: array expected");t.functionGraphRoots=[];for(r=0;r<e.functionGraphRoots.length;++r)t.functionGraphRoots[r]=String(e.functionGraphRoots[r])}return null!=e.preserveFtraceBuffer&&(t.preserveFtraceBuffer=Boolean(e.preserveFtraceBuffer)),null!=e.useMonotonicRawClock&&(t.useMonotonicRawClock=Boolean(e.useMonotonicRawClock)),null!=e.instanceName&&(t.instanceName=String(e.instanceName)),null!=e.bufferSizeLowerBound&&(t.bufferSizeLowerBound=Boolean(e.bufferSizeLowerBound)),t},b.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.ftraceEvents=[],r.atraceCategories=[],r.atraceApps=[],r.syscallEvents=[],r.functionFilters=[],r.functionGraphRoots=[],r.atraceCategoriesPreferSdk=[]),t.defaults&&(r.bufferSizeKb=0,r.drainPeriodMs=0,r.compactSched=null,r.symbolizeKsyms=!1,r.initializeKsymsSynchronouslyForTesting=!1,r.throttleRssStat=!1,r.disableGenericEvents=!1,r.ksymsMemPolicy=t.enums===String?"KSYMS_UNSPECIFIED":0,r.enableFunctionGraph=!1,r.printFilter=null,r.preserveFtraceBuffer=!1,r.useMonotonicRawClock=!1,r.instanceName="",r.drainBufferPercent=0,r.bufferSizeLowerBound=!1),e.ftraceEvents&&e.ftraceEvents.length){r.ftraceEvents=[];for(var n=0;n<e.ftraceEvents.length;++n)r.ftraceEvents[n]=e.ftraceEvents[n]}if(e.atraceCategories&&e.atraceCategories.length){r.atraceCategories=[];for(n=0;n<e.atraceCategories.length;++n)r.atraceCategories[n]=e.atraceCategories[n]}if(e.atraceApps&&e.atraceApps.length){r.atraceApps=[];for(n=0;n<e.atraceApps.length;++n)r.atraceApps[n]=e.atraceApps[n]}if(null!=e.bufferSizeKb&&e.hasOwnProperty("bufferSizeKb")&&(r.bufferSizeKb=e.bufferSizeKb),null!=e.drainPeriodMs&&e.hasOwnProperty("drainPeriodMs")&&(r.drainPeriodMs=e.drainPeriodMs),null!=e.compactSched&&e.hasOwnProperty("compactSched")&&(r.compactSched=s.perfetto.protos.FtraceConfig.CompactSchedConfig.toObject(e.compactSched,t)),null!=e.symbolizeKsyms&&e.hasOwnProperty("symbolizeKsyms")&&(r.symbolizeKsyms=e.symbolizeKsyms),null!=e.initializeKsymsSynchronouslyForTesting&&e.hasOwnProperty("initializeKsymsSynchronouslyForTesting")&&(r.initializeKsymsSynchronouslyForTesting=e.initializeKsymsSynchronouslyForTesting),null!=e.throttleRssStat&&e.hasOwnProperty("throttleRssStat")&&(r.throttleRssStat=e.throttleRssStat),null!=e.disableGenericEvents&&e.hasOwnProperty("disableGenericEvents")&&(r.disableGenericEvents=e.disableGenericEvents),null!=e.ksymsMemPolicy&&e.hasOwnProperty("ksymsMemPolicy")&&(r.ksymsMemPolicy=t.enums!==String||void 0===s.perfetto.protos.FtraceConfig.KsymsMemPolicy[e.ksymsMemPolicy]?e.ksymsMemPolicy:s.perfetto.protos.FtraceConfig.KsymsMemPolicy[e.ksymsMemPolicy]),e.syscallEvents&&e.syscallEvents.length){r.syscallEvents=[];for(n=0;n<e.syscallEvents.length;++n)r.syscallEvents[n]=e.syscallEvents[n]}if(null!=e.enableFunctionGraph&&e.hasOwnProperty("enableFunctionGraph")&&(r.enableFunctionGraph=e.enableFunctionGraph),e.functionFilters&&e.functionFilters.length){r.functionFilters=[];for(n=0;n<e.functionFilters.length;++n)r.functionFilters[n]=e.functionFilters[n]}if(e.functionGraphRoots&&e.functionGraphRoots.length){r.functionGraphRoots=[];for(n=0;n<e.functionGraphRoots.length;++n)r.functionGraphRoots[n]=e.functionGraphRoots[n]}if(null!=e.printFilter&&e.hasOwnProperty("printFilter")&&(r.printFilter=s.perfetto.protos.FtraceConfig.PrintFilter.toObject(e.printFilter,t)),null!=e.preserveFtraceBuffer&&e.hasOwnProperty("preserveFtraceBuffer")&&(r.preserveFtraceBuffer=e.preserveFtraceBuffer),null!=e.useMonotonicRawClock&&e.hasOwnProperty("useMonotonicRawClock")&&(r.useMonotonicRawClock=e.useMonotonicRawClock),null!=e.instanceName&&e.hasOwnProperty("instanceName")&&(r.instanceName=e.instanceName),null!=e.drainBufferPercent&&e.hasOwnProperty("drainBufferPercent")&&(r.drainBufferPercent=e.drainBufferPercent),null!=e.bufferSizeLowerBound&&e.hasOwnProperty("bufferSizeLowerBound")&&(r.bufferSizeLowerBound=e.bufferSizeLowerBound),e.atraceCategoriesPreferSdk&&e.atraceCategoriesPreferSdk.length){r.atraceCategoriesPreferSdk=[];for(n=0;n<e.atraceCategoriesPreferSdk.length;++n)r.atraceCategoriesPreferSdk[n]=e.atraceCategoriesPreferSdk[n]}return r},b.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},b.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.FtraceConfig"},b.CompactSchedConfig=(ot.prototype.enabled=!1,ot.create=function(e){return new ot(e)},ot.encode=function(e,t){return t=t||a.create(),null!=e.enabled&&Object.hasOwnProperty.call(e,"enabled")&&t.uint32(8).bool(e.enabled),t},ot.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.FtraceConfig.CompactSchedConfig;e.pos<r;){var a=e.uint32();a>>>3==1?n.enabled=e.bool():e.skipType(7&a)}return n},ot.fromObject=function(e){var t;return e instanceof s.perfetto.protos.FtraceConfig.CompactSchedConfig?e:(t=new s.perfetto.protos.FtraceConfig.CompactSchedConfig,null!=e.enabled&&(t.enabled=Boolean(e.enabled)),t)},ot.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.enabled=!1),null!=e.enabled&&e.hasOwnProperty("enabled")&&(r.enabled=e.enabled),r},ot.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},ot.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.FtraceConfig.CompactSchedConfig"},ot),b.PrintFilter=(st.prototype.rules=i.emptyArray,st.create=function(e){return new st(e)},st.encode=function(e,t){if(t=t||a.create(),null!=e.rules&&e.rules.length)for(var r=0;r<e.rules.length;++r)s.perfetto.protos.FtraceConfig.PrintFilter.Rule.encode(e.rules[r],t.uint32(10).fork()).ldelim();return t},st.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.FtraceConfig.PrintFilter;e.pos<r;){var a=e.uint32();a>>>3==1?(n.rules&&n.rules.length||(n.rules=[]),n.rules.push(s.perfetto.protos.FtraceConfig.PrintFilter.Rule.decode(e,e.uint32()))):e.skipType(7&a)}return n},st.fromObject=function(e){if(e instanceof s.perfetto.protos.FtraceConfig.PrintFilter)return e;var t=new s.perfetto.protos.FtraceConfig.PrintFilter;if(e.rules){if(!Array.isArray(e.rules))throw TypeError(".perfetto.protos.FtraceConfig.PrintFilter.rules: array expected");t.rules=[];for(var r=0;r<e.rules.length;++r){if("object"!=typeof e.rules[r])throw TypeError(".perfetto.protos.FtraceConfig.PrintFilter.rules: object expected");t.rules[r]=s.perfetto.protos.FtraceConfig.PrintFilter.Rule.fromObject(e.rules[r])}}return t},st.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.rules=[]),e.rules&&e.rules.length){r.rules=[];for(var n=0;n<e.rules.length;++n)r.rules[n]=s.perfetto.protos.FtraceConfig.PrintFilter.Rule.toObject(e.rules[n],t)}return r},st.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},st.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.FtraceConfig.PrintFilter"},st.Rule=(lt.prototype.prefix=null,lt.prototype.atraceMsg=null,lt.prototype.allow=!1,Object.defineProperty(lt.prototype,"match",{get:i.oneOfGetter(t=["prefix","atraceMsg"]),set:i.oneOfSetter(t)}),lt.create=function(e){return new lt(e)},lt.encode=function(e,t){return t=t||a.create(),null!=e.prefix&&Object.hasOwnProperty.call(e,"prefix")&&t.uint32(10).string(e.prefix),null!=e.allow&&Object.hasOwnProperty.call(e,"allow")&&t.uint32(16).bool(e.allow),null!=e.atraceMsg&&Object.hasOwnProperty.call(e,"atraceMsg")&&s.perfetto.protos.FtraceConfig.PrintFilter.Rule.AtraceMessage.encode(e.atraceMsg,t.uint32(26).fork()).ldelim(),t},lt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.FtraceConfig.PrintFilter.Rule;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.prefix=e.string();break;case 3:n.atraceMsg=s.perfetto.protos.FtraceConfig.PrintFilter.Rule.AtraceMessage.decode(e,e.uint32());break;case 2:n.allow=e.bool();break;default:e.skipType(7&a)}}return n},lt.fromObject=function(e){if(e instanceof s.perfetto.protos.FtraceConfig.PrintFilter.Rule)return e;var t=new s.perfetto.protos.FtraceConfig.PrintFilter.Rule;if(null!=e.prefix&&(t.prefix=String(e.prefix)),null!=e.atraceMsg){if("object"!=typeof e.atraceMsg)throw TypeError(".perfetto.protos.FtraceConfig.PrintFilter.Rule.atraceMsg: object expected");t.atraceMsg=s.perfetto.protos.FtraceConfig.PrintFilter.Rule.AtraceMessage.fromObject(e.atraceMsg)}return null!=e.allow&&(t.allow=Boolean(e.allow)),t},lt.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.allow=!1),null!=e.prefix&&e.hasOwnProperty("prefix")&&(r.prefix=e.prefix,t.oneofs)&&(r.match="prefix"),null!=e.allow&&e.hasOwnProperty("allow")&&(r.allow=e.allow),null!=e.atraceMsg&&e.hasOwnProperty("atraceMsg")&&(r.atraceMsg=s.perfetto.protos.FtraceConfig.PrintFilter.Rule.AtraceMessage.toObject(e.atraceMsg,t),t.oneofs)&&(r.match="atraceMsg"),r},lt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},lt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.FtraceConfig.PrintFilter.Rule"},lt.AtraceMessage=(ct.prototype.type="",ct.prototype.prefix="",ct.create=function(e){return new ct(e)},ct.encode=function(e,t){return t=t||a.create(),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(10).string(e.type),null!=e.prefix&&Object.hasOwnProperty.call(e,"prefix")&&t.uint32(18).string(e.prefix),t},ct.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.FtraceConfig.PrintFilter.Rule.AtraceMessage;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.type=e.string();break;case 2:n.prefix=e.string();break;default:e.skipType(7&a)}}return n},ct.fromObject=function(e){var t;return e instanceof s.perfetto.protos.FtraceConfig.PrintFilter.Rule.AtraceMessage?e:(t=new s.perfetto.protos.FtraceConfig.PrintFilter.Rule.AtraceMessage,null!=e.type&&(t.type=String(e.type)),null!=e.prefix&&(t.prefix=String(e.prefix)),t)},ct.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.type="",r.prefix=""),null!=e.type&&e.hasOwnProperty("type")&&(r.type=e.type),null!=e.prefix&&e.hasOwnProperty("prefix")&&(r.prefix=e.prefix),r},ct.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},ct.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.FtraceConfig.PrintFilter.Rule.AtraceMessage"},ct),lt),st),b.KsymsMemPolicy=(t={},(e=Object.create(t))[t[0]="KSYMS_UNSPECIFIED"]=0,e[t[1]="KSYMS_CLEANUP_ON_STOP"]=1,e[t[2]="KSYMS_RETAIN"]=2,e),b),r.GpuCounterConfig=(ut.prototype.counterPeriodNs=i.Long?i.Long.fromBits(0,0,!0):0,ut.prototype.counterIds=i.emptyArray,ut.prototype.instrumentedSampling=!1,ut.prototype.fixGpuClock=!1,ut.create=function(e){return new ut(e)},ut.encode=function(e,t){if(t=t||a.create(),null!=e.counterPeriodNs&&Object.hasOwnProperty.call(e,"counterPeriodNs")&&t.uint32(8).uint64(e.counterPeriodNs),null!=e.counterIds&&e.counterIds.length)for(var r=0;r<e.counterIds.length;++r)t.uint32(16).uint32(e.counterIds[r]);return null!=e.instrumentedSampling&&Object.hasOwnProperty.call(e,"instrumentedSampling")&&t.uint32(24).bool(e.instrumentedSampling),null!=e.fixGpuClock&&Object.hasOwnProperty.call(e,"fixGpuClock")&&t.uint32(32).bool(e.fixGpuClock),t},ut.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.GpuCounterConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.counterPeriodNs=e.uint64();break;case 2:if(n.counterIds&&n.counterIds.length||(n.counterIds=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.counterIds.push(e.uint32());else n.counterIds.push(e.uint32());break;case 3:n.instrumentedSampling=e.bool();break;case 4:n.fixGpuClock=e.bool();break;default:e.skipType(7&a)}}return n},ut.fromObject=function(e){if(e instanceof s.perfetto.protos.GpuCounterConfig)return e;var t=new s.perfetto.protos.GpuCounterConfig;if(null!=e.counterPeriodNs&&(i.Long?(t.counterPeriodNs=i.Long.fromValue(e.counterPeriodNs)).unsigned=!0:"string"==typeof e.counterPeriodNs?t.counterPeriodNs=parseInt(e.counterPeriodNs,10):"number"==typeof e.counterPeriodNs?t.counterPeriodNs=e.counterPeriodNs:"object"==typeof e.counterPeriodNs&&(t.counterPeriodNs=new i.LongBits(e.counterPeriodNs.low>>>0,e.counterPeriodNs.high>>>0).toNumber(!0))),e.counterIds){if(!Array.isArray(e.counterIds))throw TypeError(".perfetto.protos.GpuCounterConfig.counterIds: array expected");t.counterIds=[];for(var r=0;r<e.counterIds.length;++r)t.counterIds[r]=e.counterIds[r]>>>0}return null!=e.instrumentedSampling&&(t.instrumentedSampling=Boolean(e.instrumentedSampling)),null!=e.fixGpuClock&&(t.fixGpuClock=Boolean(e.fixGpuClock)),t},ut.toObject=function(e,t){var r,n={};if(((t=t||{}).arrays||t.defaults)&&(n.counterIds=[]),t.defaults&&(i.Long?(r=new i.Long(0,0,!0),n.counterPeriodNs=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.counterPeriodNs=t.longs===String?"0":0,n.instrumentedSampling=!1,n.fixGpuClock=!1),null!=e.counterPeriodNs&&e.hasOwnProperty("counterPeriodNs")&&("number"==typeof e.counterPeriodNs?n.counterPeriodNs=t.longs===String?String(e.counterPeriodNs):e.counterPeriodNs:n.counterPeriodNs=t.longs===String?i.Long.prototype.toString.call(e.counterPeriodNs):t.longs===Number?new i.LongBits(e.counterPeriodNs.low>>>0,e.counterPeriodNs.high>>>0).toNumber(!0):e.counterPeriodNs),e.counterIds&&e.counterIds.length){n.counterIds=[];for(var a=0;a<e.counterIds.length;++a)n.counterIds[a]=e.counterIds[a]}return null!=e.instrumentedSampling&&e.hasOwnProperty("instrumentedSampling")&&(n.instrumentedSampling=e.instrumentedSampling),null!=e.fixGpuClock&&e.hasOwnProperty("fixGpuClock")&&(n.fixGpuClock=e.fixGpuClock),n},ut.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},ut.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.GpuCounterConfig"},ut),r.VulkanMemoryConfig=(dt.prototype.trackDriverMemoryUsage=!1,dt.prototype.trackDeviceMemoryUsage=!1,dt.create=function(e){return new dt(e)},dt.encode=function(e,t){return t=t||a.create(),null!=e.trackDriverMemoryUsage&&Object.hasOwnProperty.call(e,"trackDriverMemoryUsage")&&t.uint32(8).bool(e.trackDriverMemoryUsage),null!=e.trackDeviceMemoryUsage&&Object.hasOwnProperty.call(e,"trackDeviceMemoryUsage")&&t.uint32(16).bool(e.trackDeviceMemoryUsage),t},dt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.VulkanMemoryConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.trackDriverMemoryUsage=e.bool();break;case 2:n.trackDeviceMemoryUsage=e.bool();break;default:e.skipType(7&a)}}return n},dt.fromObject=function(e){var t;return e instanceof s.perfetto.protos.VulkanMemoryConfig?e:(t=new s.perfetto.protos.VulkanMemoryConfig,null!=e.trackDriverMemoryUsage&&(t.trackDriverMemoryUsage=Boolean(e.trackDriverMemoryUsage)),null!=e.trackDeviceMemoryUsage&&(t.trackDeviceMemoryUsage=Boolean(e.trackDeviceMemoryUsage)),t)},dt.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.trackDriverMemoryUsage=!1,r.trackDeviceMemoryUsage=!1),null!=e.trackDriverMemoryUsage&&e.hasOwnProperty("trackDriverMemoryUsage")&&(r.trackDriverMemoryUsage=e.trackDriverMemoryUsage),null!=e.trackDeviceMemoryUsage&&e.hasOwnProperty("trackDeviceMemoryUsage")&&(r.trackDeviceMemoryUsage=e.trackDeviceMemoryUsage),r},dt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},dt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.VulkanMemoryConfig"},dt),r.InodeFileConfig=(ft.prototype.scanIntervalMs=0,ft.prototype.scanDelayMs=0,ft.prototype.scanBatchSize=0,ft.prototype.doNotScan=!1,ft.prototype.scanMountPoints=i.emptyArray,ft.prototype.mountPointMapping=i.emptyArray,ft.create=function(e){return new ft(e)},ft.encode=function(e,t){if(t=t||a.create(),null!=e.scanIntervalMs&&Object.hasOwnProperty.call(e,"scanIntervalMs")&&t.uint32(8).uint32(e.scanIntervalMs),null!=e.scanDelayMs&&Object.hasOwnProperty.call(e,"scanDelayMs")&&t.uint32(16).uint32(e.scanDelayMs),null!=e.scanBatchSize&&Object.hasOwnProperty.call(e,"scanBatchSize")&&t.uint32(24).uint32(e.scanBatchSize),null!=e.doNotScan&&Object.hasOwnProperty.call(e,"doNotScan")&&t.uint32(32).bool(e.doNotScan),null!=e.scanMountPoints&&e.scanMountPoints.length)for(var r=0;r<e.scanMountPoints.length;++r)t.uint32(42).string(e.scanMountPoints[r]);if(null!=e.mountPointMapping&&e.mountPointMapping.length)for(r=0;r<e.mountPointMapping.length;++r)s.perfetto.protos.InodeFileConfig.MountPointMappingEntry.encode(e.mountPointMapping[r],t.uint32(50).fork()).ldelim();return t},ft.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.InodeFileConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.scanIntervalMs=e.uint32();break;case 2:n.scanDelayMs=e.uint32();break;case 3:n.scanBatchSize=e.uint32();break;case 4:n.doNotScan=e.bool();break;case 5:n.scanMountPoints&&n.scanMountPoints.length||(n.scanMountPoints=[]),n.scanMountPoints.push(e.string());break;case 6:n.mountPointMapping&&n.mountPointMapping.length||(n.mountPointMapping=[]),n.mountPointMapping.push(s.perfetto.protos.InodeFileConfig.MountPointMappingEntry.decode(e,e.uint32()));break;default:e.skipType(7&a)}}return n},ft.fromObject=function(e){if(e instanceof s.perfetto.protos.InodeFileConfig)return e;var t=new s.perfetto.protos.InodeFileConfig;if(null!=e.scanIntervalMs&&(t.scanIntervalMs=e.scanIntervalMs>>>0),null!=e.scanDelayMs&&(t.scanDelayMs=e.scanDelayMs>>>0),null!=e.scanBatchSize&&(t.scanBatchSize=e.scanBatchSize>>>0),null!=e.doNotScan&&(t.doNotScan=Boolean(e.doNotScan)),e.scanMountPoints){if(!Array.isArray(e.scanMountPoints))throw TypeError(".perfetto.protos.InodeFileConfig.scanMountPoints: array expected");t.scanMountPoints=[];for(var r=0;r<e.scanMountPoints.length;++r)t.scanMountPoints[r]=String(e.scanMountPoints[r])}if(e.mountPointMapping){if(!Array.isArray(e.mountPointMapping))throw TypeError(".perfetto.protos.InodeFileConfig.mountPointMapping: array expected");t.mountPointMapping=[];for(r=0;r<e.mountPointMapping.length;++r){if("object"!=typeof e.mountPointMapping[r])throw TypeError(".perfetto.protos.InodeFileConfig.mountPointMapping: object expected");t.mountPointMapping[r]=s.perfetto.protos.InodeFileConfig.MountPointMappingEntry.fromObject(e.mountPointMapping[r])}}return t},ft.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.scanMountPoints=[],r.mountPointMapping=[]),t.defaults&&(r.scanIntervalMs=0,r.scanDelayMs=0,r.scanBatchSize=0,r.doNotScan=!1),null!=e.scanIntervalMs&&e.hasOwnProperty("scanIntervalMs")&&(r.scanIntervalMs=e.scanIntervalMs),null!=e.scanDelayMs&&e.hasOwnProperty("scanDelayMs")&&(r.scanDelayMs=e.scanDelayMs),null!=e.scanBatchSize&&e.hasOwnProperty("scanBatchSize")&&(r.scanBatchSize=e.scanBatchSize),null!=e.doNotScan&&e.hasOwnProperty("doNotScan")&&(r.doNotScan=e.doNotScan),e.scanMountPoints&&e.scanMountPoints.length){r.scanMountPoints=[];for(var n=0;n<e.scanMountPoints.length;++n)r.scanMountPoints[n]=e.scanMountPoints[n]}if(e.mountPointMapping&&e.mountPointMapping.length){r.mountPointMapping=[];for(n=0;n<e.mountPointMapping.length;++n)r.mountPointMapping[n]=s.perfetto.protos.InodeFileConfig.MountPointMappingEntry.toObject(e.mountPointMapping[n],t)}return r},ft.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},ft.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.InodeFileConfig"},ft.MountPointMappingEntry=(pt.prototype.mountpoint="",pt.prototype.scanRoots=i.emptyArray,pt.create=function(e){return new pt(e)},pt.encode=function(e,t){if(t=t||a.create(),null!=e.mountpoint&&Object.hasOwnProperty.call(e,"mountpoint")&&t.uint32(10).string(e.mountpoint),null!=e.scanRoots&&e.scanRoots.length)for(var r=0;r<e.scanRoots.length;++r)t.uint32(18).string(e.scanRoots[r]);return t},pt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.InodeFileConfig.MountPointMappingEntry;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.mountpoint=e.string();break;case 2:n.scanRoots&&n.scanRoots.length||(n.scanRoots=[]),n.scanRoots.push(e.string());break;default:e.skipType(7&a)}}return n},pt.fromObject=function(e){if(e instanceof s.perfetto.protos.InodeFileConfig.MountPointMappingEntry)return e;var t=new s.perfetto.protos.InodeFileConfig.MountPointMappingEntry;if(null!=e.mountpoint&&(t.mountpoint=String(e.mountpoint)),e.scanRoots){if(!Array.isArray(e.scanRoots))throw TypeError(".perfetto.protos.InodeFileConfig.MountPointMappingEntry.scanRoots: array expected");t.scanRoots=[];for(var r=0;r<e.scanRoots.length;++r)t.scanRoots[r]=String(e.scanRoots[r])}return t},pt.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.scanRoots=[]),t.defaults&&(r.mountpoint=""),null!=e.mountpoint&&e.hasOwnProperty("mountpoint")&&(r.mountpoint=e.mountpoint),e.scanRoots&&e.scanRoots.length){r.scanRoots=[];for(var n=0;n<e.scanRoots.length;++n)r.scanRoots[n]=e.scanRoots[n]}return r},pt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},pt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.InodeFileConfig.MountPointMappingEntry"},pt),ft),r.InterceptorConfig=(ht.prototype.name="",ht.prototype.consoleConfig=null,ht.create=function(e){return new ht(e)},ht.encode=function(e,t){return t=t||a.create(),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.consoleConfig&&Object.hasOwnProperty.call(e,"consoleConfig")&&s.perfetto.protos.ConsoleConfig.encode(e.consoleConfig,t.uint32(802).fork()).ldelim(),t},ht.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.InterceptorConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.name=e.string();break;case 100:n.consoleConfig=s.perfetto.protos.ConsoleConfig.decode(e,e.uint32());break;default:e.skipType(7&a)}}return n},ht.fromObject=function(e){if(e instanceof s.perfetto.protos.InterceptorConfig)return e;var t=new s.perfetto.protos.InterceptorConfig;if(null!=e.name&&(t.name=String(e.name)),null!=e.consoleConfig){if("object"!=typeof e.consoleConfig)throw TypeError(".perfetto.protos.InterceptorConfig.consoleConfig: object expected");t.consoleConfig=s.perfetto.protos.ConsoleConfig.fromObject(e.consoleConfig)}return t},ht.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.name="",r.consoleConfig=null),null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.consoleConfig&&e.hasOwnProperty("consoleConfig")&&(r.consoleConfig=s.perfetto.protos.ConsoleConfig.toObject(e.consoleConfig,t)),r},ht.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},ht.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.InterceptorConfig"},ht),r.ConsoleConfig=(gt.prototype.output=0,gt.prototype.enableColors=!1,gt.create=function(e){return new gt(e)},gt.encode=function(e,t){return t=t||a.create(),null!=e.output&&Object.hasOwnProperty.call(e,"output")&&t.uint32(8).int32(e.output),null!=e.enableColors&&Object.hasOwnProperty.call(e,"enableColors")&&t.uint32(16).bool(e.enableColors),t},gt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.ConsoleConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.output=e.int32();break;case 2:n.enableColors=e.bool();break;default:e.skipType(7&a)}}return n},gt.fromObject=function(e){if(e instanceof s.perfetto.protos.ConsoleConfig)return e;var t=new s.perfetto.protos.ConsoleConfig;switch(e.output){default:"number"==typeof e.output&&(t.output=e.output);break;case"OUTPUT_UNSPECIFIED":case 0:t.output=0;break;case"OUTPUT_STDOUT":case 1:t.output=1;break;case"OUTPUT_STDERR":case 2:t.output=2}return null!=e.enableColors&&(t.enableColors=Boolean(e.enableColors)),t},gt.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.output=t.enums===String?"OUTPUT_UNSPECIFIED":0,r.enableColors=!1),null!=e.output&&e.hasOwnProperty("output")&&(r.output=t.enums!==String||void 0===s.perfetto.protos.ConsoleConfig.Output[e.output]?e.output:s.perfetto.protos.ConsoleConfig.Output[e.output]),null!=e.enableColors&&e.hasOwnProperty("enableColors")&&(r.enableColors=e.enableColors),r},gt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},gt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.ConsoleConfig"},gt.Output=(t={},(e=Object.create(t))[t[0]="OUTPUT_UNSPECIFIED"]=0,e[t[1]="OUTPUT_STDOUT"]=1,e[t[2]="OUTPUT_STDERR"]=2,e),gt),r.AndroidPowerConfig=(mt.prototype.batteryPollMs=0,mt.prototype.batteryCounters=i.emptyArray,mt.prototype.collectPowerRails=!1,mt.prototype.collectEnergyEstimationBreakdown=!1,mt.prototype.collectEntityStateResidency=!1,mt.create=function(e){return new mt(e)},mt.encode=function(e,t){if(t=t||a.create(),null!=e.batteryPollMs&&Object.hasOwnProperty.call(e,"batteryPollMs")&&t.uint32(8).uint32(e.batteryPollMs),null!=e.batteryCounters&&e.batteryCounters.length)for(var r=0;r<e.batteryCounters.length;++r)t.uint32(16).int32(e.batteryCounters[r]);return null!=e.collectPowerRails&&Object.hasOwnProperty.call(e,"collectPowerRails")&&t.uint32(24).bool(e.collectPowerRails),null!=e.collectEnergyEstimationBreakdown&&Object.hasOwnProperty.call(e,"collectEnergyEstimationBreakdown")&&t.uint32(32).bool(e.collectEnergyEstimationBreakdown),null!=e.collectEntityStateResidency&&Object.hasOwnProperty.call(e,"collectEntityStateResidency")&&t.uint32(40).bool(e.collectEntityStateResidency),t},mt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.AndroidPowerConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.batteryPollMs=e.uint32();break;case 2:if(n.batteryCounters&&n.batteryCounters.length||(n.batteryCounters=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.batteryCounters.push(e.int32());else n.batteryCounters.push(e.int32());break;case 3:n.collectPowerRails=e.bool();break;case 4:n.collectEnergyEstimationBreakdown=e.bool();break;case 5:n.collectEntityStateResidency=e.bool();break;default:e.skipType(7&a)}}return n},mt.fromObject=function(e){if(e instanceof s.perfetto.protos.AndroidPowerConfig)return e;var t=new s.perfetto.protos.AndroidPowerConfig;if(null!=e.batteryPollMs&&(t.batteryPollMs=e.batteryPollMs>>>0),e.batteryCounters){if(!Array.isArray(e.batteryCounters))throw TypeError(".perfetto.protos.AndroidPowerConfig.batteryCounters: array expected");t.batteryCounters=[];for(var r=0;r<e.batteryCounters.length;++r)switch(e.batteryCounters[r]){default:if("number"==typeof e.batteryCounters[r]){t.batteryCounters[r]=e.batteryCounters[r];break}case"BATTERY_COUNTER_UNSPECIFIED":case 0:t.batteryCounters[r]=0;break;case"BATTERY_COUNTER_CHARGE":case 1:t.batteryCounters[r]=1;break;case"BATTERY_COUNTER_CAPACITY_PERCENT":case 2:t.batteryCounters[r]=2;break;case"BATTERY_COUNTER_CURRENT":case 3:t.batteryCounters[r]=3;break;case"BATTERY_COUNTER_CURRENT_AVG":case 4:t.batteryCounters[r]=4;break;case"BATTERY_COUNTER_VOLTAGE":case 5:t.batteryCounters[r]=5}}return null!=e.collectPowerRails&&(t.collectPowerRails=Boolean(e.collectPowerRails)),null!=e.collectEnergyEstimationBreakdown&&(t.collectEnergyEstimationBreakdown=Boolean(e.collectEnergyEstimationBreakdown)),null!=e.collectEntityStateResidency&&(t.collectEntityStateResidency=Boolean(e.collectEntityStateResidency)),t},mt.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.batteryCounters=[]),t.defaults&&(r.batteryPollMs=0,r.collectPowerRails=!1,r.collectEnergyEstimationBreakdown=!1,r.collectEntityStateResidency=!1),null!=e.batteryPollMs&&e.hasOwnProperty("batteryPollMs")&&(r.batteryPollMs=e.batteryPollMs),e.batteryCounters&&e.batteryCounters.length){r.batteryCounters=[];for(var n=0;n<e.batteryCounters.length;++n)r.batteryCounters[n]=t.enums!==String||void 0===s.perfetto.protos.AndroidPowerConfig.BatteryCounters[e.batteryCounters[n]]?e.batteryCounters[n]:s.perfetto.protos.AndroidPowerConfig.BatteryCounters[e.batteryCounters[n]]}return null!=e.collectPowerRails&&e.hasOwnProperty("collectPowerRails")&&(r.collectPowerRails=e.collectPowerRails),null!=e.collectEnergyEstimationBreakdown&&e.hasOwnProperty("collectEnergyEstimationBreakdown")&&(r.collectEnergyEstimationBreakdown=e.collectEnergyEstimationBreakdown),null!=e.collectEntityStateResidency&&e.hasOwnProperty("collectEntityStateResidency")&&(r.collectEntityStateResidency=e.collectEntityStateResidency),r},mt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},mt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.AndroidPowerConfig"},mt.BatteryCounters=(t={},(e=Object.create(t))[t[0]="BATTERY_COUNTER_UNSPECIFIED"]=0,e[t[1]="BATTERY_COUNTER_CHARGE"]=1,e[t[2]="BATTERY_COUNTER_CAPACITY_PERCENT"]=2,e[t[3]="BATTERY_COUNTER_CURRENT"]=3,e[t[4]="BATTERY_COUNTER_CURRENT_AVG"]=4,e[t[5]="BATTERY_COUNTER_VOLTAGE"]=5,e),mt),r.StatsdTracingConfig=(_t.prototype.pushAtomId=i.emptyArray,_t.prototype.rawPushAtomId=i.emptyArray,_t.prototype.pullConfig=i.emptyArray,_t.create=function(e){return new _t(e)},_t.encode=function(e,t){if(t=t||a.create(),null!=e.pushAtomId&&e.pushAtomId.length)for(var r=0;r<e.pushAtomId.length;++r)t.uint32(8).int32(e.pushAtomId[r]);if(null!=e.rawPushAtomId&&e.rawPushAtomId.length)for(r=0;r<e.rawPushAtomId.length;++r)t.uint32(16).int32(e.rawPushAtomId[r]);if(null!=e.pullConfig&&e.pullConfig.length)for(r=0;r<e.pullConfig.length;++r)s.perfetto.protos.StatsdPullAtomConfig.encode(e.pullConfig[r],t.uint32(26).fork()).ldelim();return t},_t.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.StatsdTracingConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:if(n.pushAtomId&&n.pushAtomId.length||(n.pushAtomId=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.pushAtomId.push(e.int32());else n.pushAtomId.push(e.int32());break;case 2:if(n.rawPushAtomId&&n.rawPushAtomId.length||(n.rawPushAtomId=[]),2==(7&a))for(i=e.uint32()+e.pos;e.pos<i;)n.rawPushAtomId.push(e.int32());else n.rawPushAtomId.push(e.int32());break;case 3:n.pullConfig&&n.pullConfig.length||(n.pullConfig=[]),n.pullConfig.push(s.perfetto.protos.StatsdPullAtomConfig.decode(e,e.uint32()));break;default:e.skipType(7&a)}}return n},_t.fromObject=function(e){if(e instanceof s.perfetto.protos.StatsdTracingConfig)return e;var t=new s.perfetto.protos.StatsdTracingConfig;if(e.pushAtomId){if(!Array.isArray(e.pushAtomId))throw TypeError(".perfetto.protos.StatsdTracingConfig.pushAtomId: array expected");t.pushAtomId=[];for(var r=0;r<e.pushAtomId.length;++r)switch(e.pushAtomId[r]){default:if("number"==typeof e.pushAtomId[r]){t.pushAtomId[r]=e.pushAtomId[r];break}case"ATOM_UNSPECIFIED":case 0:t.pushAtomId[r]=0;break;case"ATOM_BLE_SCAN_STATE_CHANGED":case 2:t.pushAtomId[r]=2;break;case"ATOM_PROCESS_STATE_CHANGED":case 3:t.pushAtomId[r]=3;break;case"ATOM_BLE_SCAN_RESULT_RECEIVED":case 4:t.pushAtomId[r]=4;break;case"ATOM_SENSOR_STATE_CHANGED":case 5:t.pushAtomId[r]=5;break;case"ATOM_GPS_SCAN_STATE_CHANGED":case 6:t.pushAtomId[r]=6;break;case"ATOM_SYNC_STATE_CHANGED":case 7:t.pushAtomId[r]=7;break;case"ATOM_SCHEDULED_JOB_STATE_CHANGED":case 8:t.pushAtomId[r]=8;break;case"ATOM_SCREEN_BRIGHTNESS_CHANGED":case 9:t.pushAtomId[r]=9;break;case"ATOM_WAKELOCK_STATE_CHANGED":case 10:t.pushAtomId[r]=10;break;case"ATOM_LONG_PARTIAL_WAKELOCK_STATE_CHANGED":case 11:t.pushAtomId[r]=11;break;case"ATOM_MOBILE_RADIO_POWER_STATE_CHANGED":case 12:t.pushAtomId[r]=12;break;case"ATOM_WIFI_RADIO_POWER_STATE_CHANGED":case 13:t.pushAtomId[r]=13;break;case"ATOM_ACTIVITY_MANAGER_SLEEP_STATE_CHANGED":case 14:t.pushAtomId[r]=14;break;case"ATOM_MEMORY_FACTOR_STATE_CHANGED":case 15:t.pushAtomId[r]=15;break;case"ATOM_EXCESSIVE_CPU_USAGE_REPORTED":case 16:t.pushAtomId[r]=16;break;case"ATOM_CACHED_KILL_REPORTED":case 17:t.pushAtomId[r]=17;break;case"ATOM_PROCESS_MEMORY_STAT_REPORTED":case 18:t.pushAtomId[r]=18;break;case"ATOM_LAUNCHER_EVENT":case 19:t.pushAtomId[r]=19;break;case"ATOM_BATTERY_SAVER_MODE_STATE_CHANGED":case 20:t.pushAtomId[r]=20;break;case"ATOM_DEVICE_IDLE_MODE_STATE_CHANGED":case 21:t.pushAtomId[r]=21;break;case"ATOM_DEVICE_IDLING_MODE_STATE_CHANGED":case 22:t.pushAtomId[r]=22;break;case"ATOM_AUDIO_STATE_CHANGED":case 23:t.pushAtomId[r]=23;break;case"ATOM_MEDIA_CODEC_STATE_CHANGED":case 24:t.pushAtomId[r]=24;break;case"ATOM_CAMERA_STATE_CHANGED":case 25:t.pushAtomId[r]=25;break;case"ATOM_FLASHLIGHT_STATE_CHANGED":case 26:t.pushAtomId[r]=26;break;case"ATOM_UID_PROCESS_STATE_CHANGED":case 27:t.pushAtomId[r]=27;break;case"ATOM_PROCESS_LIFE_CYCLE_STATE_CHANGED":case 28:t.pushAtomId[r]=28;break;case"ATOM_SCREEN_STATE_CHANGED":case 29:t.pushAtomId[r]=29;break;case"ATOM_BATTERY_LEVEL_CHANGED":case 30:t.pushAtomId[r]=30;break;case"ATOM_CHARGING_STATE_CHANGED":case 31:t.pushAtomId[r]=31;break;case"ATOM_PLUGGED_STATE_CHANGED":case 32:t.pushAtomId[r]=32;break;case"ATOM_INTERACTIVE_STATE_CHANGED":case 33:t.pushAtomId[r]=33;break;case"ATOM_TOUCH_EVENT_REPORTED":case 34:t.pushAtomId[r]=34;break;case"ATOM_WAKEUP_ALARM_OCCURRED":case 35:t.pushAtomId[r]=35;break;case"ATOM_KERNEL_WAKEUP_REPORTED":case 36:t.pushAtomId[r]=36;break;case"ATOM_WIFI_LOCK_STATE_CHANGED":case 37:t.pushAtomId[r]=37;break;case"ATOM_WIFI_SIGNAL_STRENGTH_CHANGED":case 38:t.pushAtomId[r]=38;break;case"ATOM_WIFI_SCAN_STATE_CHANGED":case 39:t.pushAtomId[r]=39;break;case"ATOM_PHONE_SIGNAL_STRENGTH_CHANGED":case 40:t.pushAtomId[r]=40;break;case"ATOM_SETTING_CHANGED":case 41:t.pushAtomId[r]=41;break;case"ATOM_ACTIVITY_FOREGROUND_STATE_CHANGED":case 42:t.pushAtomId[r]=42;break;case"ATOM_ISOLATED_UID_CHANGED":case 43:t.pushAtomId[r]=43;break;case"ATOM_PACKET_WAKEUP_OCCURRED":case 44:t.pushAtomId[r]=44;break;case"ATOM_WALL_CLOCK_TIME_SHIFTED":case 45:t.pushAtomId[r]=45;break;case"ATOM_ANOMALY_DETECTED":case 46:t.pushAtomId[r]=46;break;case"ATOM_APP_BREADCRUMB_REPORTED":case 47:t.pushAtomId[r]=47;break;case"ATOM_APP_START_OCCURRED":case 48:t.pushAtomId[r]=48;break;case"ATOM_APP_START_CANCELED":case 49:t.pushAtomId[r]=49;break;case"ATOM_APP_START_FULLY_DRAWN":case 50:t.pushAtomId[r]=50;break;case"ATOM_LMK_KILL_OCCURRED":case 51:t.pushAtomId[r]=51;break;case"ATOM_PICTURE_IN_PICTURE_STATE_CHANGED":case 52:t.pushAtomId[r]=52;break;case"ATOM_WIFI_MULTICAST_LOCK_STATE_CHANGED":case 53:t.pushAtomId[r]=53;break;case"ATOM_LMK_STATE_CHANGED":case 54:t.pushAtomId[r]=54;break;case"ATOM_APP_START_MEMORY_STATE_CAPTURED":case 55:t.pushAtomId[r]=55;break;case"ATOM_SHUTDOWN_SEQUENCE_REPORTED":case 56:t.pushAtomId[r]=56;break;case"ATOM_BOOT_SEQUENCE_REPORTED":case 57:t.pushAtomId[r]=57;break;case"ATOM_DAVEY_OCCURRED":case 58:t.pushAtomId[r]=58;break;case"ATOM_OVERLAY_STATE_CHANGED":case 59:t.pushAtomId[r]=59;break;case"ATOM_FOREGROUND_SERVICE_STATE_CHANGED":case 60:t.pushAtomId[r]=60;break;case"ATOM_CALL_STATE_CHANGED":case 61:t.pushAtomId[r]=61;break;case"ATOM_KEYGUARD_STATE_CHANGED":case 62:t.pushAtomId[r]=62;break;case"ATOM_KEYGUARD_BOUNCER_STATE_CHANGED":case 63:t.pushAtomId[r]=63;break;case"ATOM_KEYGUARD_BOUNCER_PASSWORD_ENTERED":case 64:t.pushAtomId[r]=64;break;case"ATOM_APP_DIED":case 65:t.pushAtomId[r]=65;break;case"ATOM_RESOURCE_CONFIGURATION_CHANGED":case 66:t.pushAtomId[r]=66;break;case"ATOM_BLUETOOTH_ENABLED_STATE_CHANGED":case 67:t.pushAtomId[r]=67;break;case"ATOM_BLUETOOTH_CONNECTION_STATE_CHANGED":case 68:t.pushAtomId[r]=68;break;case"ATOM_GPS_SIGNAL_QUALITY_CHANGED":case 69:t.pushAtomId[r]=69;break;case"ATOM_USB_CONNECTOR_STATE_CHANGED":case 70:t.pushAtomId[r]=70;break;case"ATOM_SPEAKER_IMPEDANCE_REPORTED":case 71:t.pushAtomId[r]=71;break;case"ATOM_HARDWARE_FAILED":case 72:t.pushAtomId[r]=72;break;case"ATOM_PHYSICAL_DROP_DETECTED":case 73:t.pushAtomId[r]=73;break;case"ATOM_CHARGE_CYCLES_REPORTED":case 74:t.pushAtomId[r]=74;break;case"ATOM_MOBILE_CONNECTION_STATE_CHANGED":case 75:t.pushAtomId[r]=75;break;case"ATOM_MOBILE_RADIO_TECHNOLOGY_CHANGED":case 76:t.pushAtomId[r]=76;break;case"ATOM_USB_DEVICE_ATTACHED":case 77:t.pushAtomId[r]=77;break;case"ATOM_APP_CRASH_OCCURRED":case 78:t.pushAtomId[r]=78;break;case"ATOM_ANR_OCCURRED":case 79:t.pushAtomId[r]=79;break;case"ATOM_WTF_OCCURRED":case 80:t.pushAtomId[r]=80;break;case"ATOM_LOW_MEM_REPORTED":case 81:t.pushAtomId[r]=81;break;case"ATOM_GENERIC_ATOM":case 82:t.pushAtomId[r]=82;break;case"ATOM_VIBRATOR_STATE_CHANGED":case 84:t.pushAtomId[r]=84;break;case"ATOM_DEFERRED_JOB_STATS_REPORTED":case 85:t.pushAtomId[r]=85;break;case"ATOM_THERMAL_THROTTLING":case 86:t.pushAtomId[r]=86;break;case"ATOM_BIOMETRIC_ACQUIRED":case 87:t.pushAtomId[r]=87;break;case"ATOM_BIOMETRIC_AUTHENTICATED":case 88:t.pushAtomId[r]=88;break;case"ATOM_BIOMETRIC_ERROR_OCCURRED":case 89:t.pushAtomId[r]=89;break;case"ATOM_UI_EVENT_REPORTED":case 90:t.pushAtomId[r]=90;break;case"ATOM_BATTERY_HEALTH_SNAPSHOT":case 91:t.pushAtomId[r]=91;break;case"ATOM_SLOW_IO":case 92:t.pushAtomId[r]=92;break;case"ATOM_BATTERY_CAUSED_SHUTDOWN":case 93:t.pushAtomId[r]=93;break;case"ATOM_PHONE_SERVICE_STATE_CHANGED":case 94:t.pushAtomId[r]=94;break;case"ATOM_PHONE_STATE_CHANGED":case 95:t.pushAtomId[r]=95;break;case"ATOM_USER_RESTRICTION_CHANGED":case 96:t.pushAtomId[r]=96;break;case"ATOM_SETTINGS_UI_CHANGED":case 97:t.pushAtomId[r]=97;break;case"ATOM_CONNECTIVITY_STATE_CHANGED":case 98:t.pushAtomId[r]=98;break;case"ATOM_SERVICE_STATE_CHANGED":case 99:t.pushAtomId[r]=99;break;case"ATOM_SERVICE_LAUNCH_REPORTED":case 100:t.pushAtomId[r]=100;break;case"ATOM_FLAG_FLIP_UPDATE_OCCURRED":case 101:t.pushAtomId[r]=101;break;case"ATOM_BINARY_PUSH_STATE_CHANGED":case 102:t.pushAtomId[r]=102;break;case"ATOM_DEVICE_POLICY_EVENT":case 103:t.pushAtomId[r]=103;break;case"ATOM_DOCS_UI_FILE_OP_CANCELED":case 104:t.pushAtomId[r]=104;break;case"ATOM_DOCS_UI_FILE_OP_COPY_MOVE_MODE_REPORTED":case 105:t.pushAtomId[r]=105;break;case"ATOM_DOCS_UI_FILE_OP_FAILURE":case 106:t.pushAtomId[r]=106;break;case"ATOM_DOCS_UI_PROVIDER_FILE_OP":case 107:t.pushAtomId[r]=107;break;case"ATOM_DOCS_UI_INVALID_SCOPED_ACCESS_REQUEST":case 108:t.pushAtomId[r]=108;break;case"ATOM_DOCS_UI_LAUNCH_REPORTED":case 109:t.pushAtomId[r]=109;break;case"ATOM_DOCS_UI_ROOT_VISITED":case 110:t.pushAtomId[r]=110;break;case"ATOM_DOCS_UI_STARTUP_MS":case 111:t.pushAtomId[r]=111;break;case"ATOM_DOCS_UI_USER_ACTION_REPORTED":case 112:t.pushAtomId[r]=112;break;case"ATOM_WIFI_ENABLED_STATE_CHANGED":case 113:t.pushAtomId[r]=113;break;case"ATOM_WIFI_RUNNING_STATE_CHANGED":case 114:t.pushAtomId[r]=114;break;case"ATOM_APP_COMPACTED":case 115:t.pushAtomId[r]=115;break;case"ATOM_NETWORK_DNS_EVENT_REPORTED":case 116:t.pushAtomId[r]=116;break;case"ATOM_DOCS_UI_PICKER_LAUNCHED_FROM_REPORTED":case 117:t.pushAtomId[r]=117;break;case"ATOM_DOCS_UI_PICK_RESULT_REPORTED":case 118:t.pushAtomId[r]=118;break;case"ATOM_DOCS_UI_SEARCH_MODE_REPORTED":case 119:t.pushAtomId[r]=119;break;case"ATOM_DOCS_UI_SEARCH_TYPE_REPORTED":case 120:t.pushAtomId[r]=120;break;case"ATOM_DATA_STALL_EVENT":case 121:t.pushAtomId[r]=121;break;case"ATOM_RESCUE_PARTY_RESET_REPORTED":case 122:t.pushAtomId[r]=122;break;case"ATOM_SIGNED_CONFIG_REPORTED":case 123:t.pushAtomId[r]=123;break;case"ATOM_GNSS_NI_EVENT_REPORTED":case 124:t.pushAtomId[r]=124;break;case"ATOM_BLUETOOTH_LINK_LAYER_CONNECTION_EVENT":case 125:t.pushAtomId[r]=125;break;case"ATOM_BLUETOOTH_ACL_CONNECTION_STATE_CHANGED":case 126:t.pushAtomId[r]=126;break;case"ATOM_BLUETOOTH_SCO_CONNECTION_STATE_CHANGED":case 127:t.pushAtomId[r]=127;break;case"ATOM_APP_DOWNGRADED":case 128:t.pushAtomId[r]=128;break;case"ATOM_APP_OPTIMIZED_AFTER_DOWNGRADED":case 129:t.pushAtomId[r]=129;break;case"ATOM_LOW_STORAGE_STATE_CHANGED":case 130:t.pushAtomId[r]=130;break;case"ATOM_GNSS_NFW_NOTIFICATION_REPORTED":case 131:t.pushAtomId[r]=131;break;case"ATOM_GNSS_CONFIGURATION_REPORTED":case 132:t.pushAtomId[r]=132;break;case"ATOM_USB_PORT_OVERHEAT_EVENT_REPORTED":case 133:t.pushAtomId[r]=133;break;case"ATOM_NFC_ERROR_OCCURRED":case 134:t.pushAtomId[r]=134;break;case"ATOM_NFC_STATE_CHANGED":case 135:t.pushAtomId[r]=135;break;case"ATOM_NFC_BEAM_OCCURRED":case 136:t.pushAtomId[r]=136;break;case"ATOM_NFC_CARDEMULATION_OCCURRED":case 137:t.pushAtomId[r]=137;break;case"ATOM_NFC_TAG_OCCURRED":case 138:t.pushAtomId[r]=138;break;case"ATOM_NFC_HCE_TRANSACTION_OCCURRED":case 139:t.pushAtomId[r]=139;break;case"ATOM_SE_STATE_CHANGED":case 140:t.pushAtomId[r]=140;break;case"ATOM_SE_OMAPI_REPORTED":case 141:t.pushAtomId[r]=141;break;case"ATOM_BROADCAST_DISPATCH_LATENCY_REPORTED":case 142:t.pushAtomId[r]=142;break;case"ATOM_ATTENTION_MANAGER_SERVICE_RESULT_REPORTED":case 143:t.pushAtomId[r]=143;break;case"ATOM_ADB_CONNECTION_CHANGED":case 144:t.pushAtomId[r]=144;break;case"ATOM_SPEECH_DSP_STAT_REPORTED":case 145:t.pushAtomId[r]=145;break;case"ATOM_USB_CONTAMINANT_REPORTED":case 146:t.pushAtomId[r]=146;break;case"ATOM_WATCHDOG_ROLLBACK_OCCURRED":case 147:t.pushAtomId[r]=147;break;case"ATOM_BIOMETRIC_SYSTEM_HEALTH_ISSUE_DETECTED":case 148:t.pushAtomId[r]=148;break;case"ATOM_BUBBLE_UI_CHANGED":case 149:t.pushAtomId[r]=149;break;case"ATOM_SCHEDULED_JOB_CONSTRAINT_CHANGED":case 150:t.pushAtomId[r]=150;break;case"ATOM_BLUETOOTH_ACTIVE_DEVICE_CHANGED":case 151:t.pushAtomId[r]=151;break;case"ATOM_BLUETOOTH_A2DP_PLAYBACK_STATE_CHANGED":case 152:t.pushAtomId[r]=152;break;case"ATOM_BLUETOOTH_A2DP_CODEC_CONFIG_CHANGED":case 153:t.pushAtomId[r]=153;break;case"ATOM_BLUETOOTH_A2DP_CODEC_CAPABILITY_CHANGED":case 154:t.pushAtomId[r]=154;break;case"ATOM_BLUETOOTH_A2DP_AUDIO_UNDERRUN_REPORTED":case 155:t.pushAtomId[r]=155;break;case"ATOM_BLUETOOTH_A2DP_AUDIO_OVERRUN_REPORTED":case 156:t.pushAtomId[r]=156;break;case"ATOM_BLUETOOTH_DEVICE_RSSI_REPORTED":case 157:t.pushAtomId[r]=157;break;case"ATOM_BLUETOOTH_DEVICE_FAILED_CONTACT_COUNTER_REPORTED":case 158:t.pushAtomId[r]=158;break;case"ATOM_BLUETOOTH_DEVICE_TX_POWER_LEVEL_REPORTED":case 159:t.pushAtomId[r]=159;break;case"ATOM_BLUETOOTH_HCI_TIMEOUT_REPORTED":case 160:t.pushAtomId[r]=160;break;case"ATOM_BLUETOOTH_QUALITY_REPORT_REPORTED":case 161:t.pushAtomId[r]=161;break;case"ATOM_BLUETOOTH_DEVICE_INFO_REPORTED":case 162:t.pushAtomId[r]=162;break;case"ATOM_BLUETOOTH_REMOTE_VERSION_INFO_REPORTED":case 163:t.pushAtomId[r]=163;break;case"ATOM_BLUETOOTH_SDP_ATTRIBUTE_REPORTED":case 164:t.pushAtomId[r]=164;break;case"ATOM_BLUETOOTH_BOND_STATE_CHANGED":case 165:t.pushAtomId[r]=165;break;case"ATOM_BLUETOOTH_CLASSIC_PAIRING_EVENT_REPORTED":case 166:t.pushAtomId[r]=166;break;case"ATOM_BLUETOOTH_SMP_PAIRING_EVENT_REPORTED":case 167:t.pushAtomId[r]=167;break;case"ATOM_SCREEN_TIMEOUT_EXTENSION_REPORTED":case 168:t.pushAtomId[r]=168;break;case"ATOM_PROCESS_START_TIME":case 169:t.pushAtomId[r]=169;break;case"ATOM_PERMISSION_GRANT_REQUEST_RESULT_REPORTED":case 170:t.pushAtomId[r]=170;break;case"ATOM_BLUETOOTH_SOCKET_CONNECTION_STATE_CHANGED":case 171:t.pushAtomId[r]=171;break;case"ATOM_DEVICE_IDENTIFIER_ACCESS_DENIED":case 172:t.pushAtomId[r]=172;break;case"ATOM_BUBBLE_DEVELOPER_ERROR_REPORTED":case 173:t.pushAtomId[r]=173;break;case"ATOM_ASSIST_GESTURE_STAGE_REPORTED":case 174:t.pushAtomId[r]=174;break;case"ATOM_ASSIST_GESTURE_FEEDBACK_REPORTED":case 175:t.pushAtomId[r]=175;break;case"ATOM_ASSIST_GESTURE_PROGRESS_REPORTED":case 176:t.pushAtomId[r]=176;break;case"ATOM_TOUCH_GESTURE_CLASSIFIED":case 177:t.pushAtomId[r]=177;break;case"ATOM_HIDDEN_API_USED":case 178:t.pushAtomId[r]=178;break;case"ATOM_STYLE_UI_CHANGED":case 179:t.pushAtomId[r]=179;break;case"ATOM_PRIVACY_INDICATORS_INTERACTED":case 180:t.pushAtomId[r]=180;break;case"ATOM_APP_INSTALL_ON_EXTERNAL_STORAGE_REPORTED":case 181:t.pushAtomId[r]=181;break;case"ATOM_NETWORK_STACK_REPORTED":case 182:t.pushAtomId[r]=182;break;case"ATOM_APP_MOVED_STORAGE_REPORTED":case 183:t.pushAtomId[r]=183;break;case"ATOM_BIOMETRIC_ENROLLED":case 184:t.pushAtomId[r]=184;break;case"ATOM_SYSTEM_SERVER_WATCHDOG_OCCURRED":case 185:t.pushAtomId[r]=185;break;case"ATOM_TOMB_STONE_OCCURRED":case 186:t.pushAtomId[r]=186;break;case"ATOM_BLUETOOTH_CLASS_OF_DEVICE_REPORTED":case 187:t.pushAtomId[r]=187;break;case"ATOM_INTELLIGENCE_EVENT_REPORTED":case 188:t.pushAtomId[r]=188;break;case"ATOM_THERMAL_THROTTLING_SEVERITY_STATE_CHANGED":case 189:t.pushAtomId[r]=189;break;case"ATOM_ROLE_REQUEST_RESULT_REPORTED":case 190:t.pushAtomId[r]=190;break;case"ATOM_MEDIAMETRICS_AUDIOPOLICY_REPORTED":case 191:t.pushAtomId[r]=191;break;case"ATOM_MEDIAMETRICS_AUDIORECORD_REPORTED":case 192:t.pushAtomId[r]=192;break;case"ATOM_MEDIAMETRICS_AUDIOTHREAD_REPORTED":case 193:t.pushAtomId[r]=193;break;case"ATOM_MEDIAMETRICS_AUDIOTRACK_REPORTED":case 194:t.pushAtomId[r]=194;break;case"ATOM_MEDIAMETRICS_CODEC_REPORTED":case 195:t.pushAtomId[r]=195;break;case"ATOM_MEDIAMETRICS_DRM_WIDEVINE_REPORTED":case 196:t.pushAtomId[r]=196;break;case"ATOM_MEDIAMETRICS_EXTRACTOR_REPORTED":case 197:t.pushAtomId[r]=197;break;case"ATOM_MEDIAMETRICS_MEDIADRM_REPORTED":case 198:t.pushAtomId[r]=198;break;case"ATOM_MEDIAMETRICS_NUPLAYER_REPORTED":case 199:t.pushAtomId[r]=199;break;case"ATOM_MEDIAMETRICS_RECORDER_REPORTED":case 200:t.pushAtomId[r]=200;break;case"ATOM_MEDIAMETRICS_DRMMANAGER_REPORTED":case 201:t.pushAtomId[r]=201;break;case"ATOM_CAR_POWER_STATE_CHANGED":case 203:t.pushAtomId[r]=203;break;case"ATOM_GARAGE_MODE_INFO":case 204:t.pushAtomId[r]=204;break;case"ATOM_TEST_ATOM_REPORTED":case 205:t.pushAtomId[r]=205;break;case"ATOM_CONTENT_CAPTURE_CALLER_MISMATCH_REPORTED":case 206:t.pushAtomId[r]=206;break;case"ATOM_CONTENT_CAPTURE_SERVICE_EVENTS":case 207:t.pushAtomId[r]=207;break;case"ATOM_CONTENT_CAPTURE_SESSION_EVENTS":case 208:t.pushAtomId[r]=208;break;case"ATOM_CONTENT_CAPTURE_FLUSHED":case 209:t.pushAtomId[r]=209;break;case"ATOM_LOCATION_MANAGER_API_USAGE_REPORTED":case 210:t.pushAtomId[r]=210;break;case"ATOM_REVIEW_PERMISSIONS_FRAGMENT_RESULT_REPORTED":case 211:t.pushAtomId[r]=211;break;case"ATOM_RUNTIME_PERMISSIONS_UPGRADE_RESULT":case 212:t.pushAtomId[r]=212;break;case"ATOM_GRANT_PERMISSIONS_ACTIVITY_BUTTON_ACTIONS":case 213:t.pushAtomId[r]=213;break;case"ATOM_LOCATION_ACCESS_CHECK_NOTIFICATION_ACTION":case 214:t.pushAtomId[r]=214;break;case"ATOM_APP_PERMISSION_FRAGMENT_ACTION_REPORTED":case 215:t.pushAtomId[r]=215;break;case"ATOM_APP_PERMISSION_FRAGMENT_VIEWED":case 216:t.pushAtomId[r]=216;break;case"ATOM_APP_PERMISSIONS_FRAGMENT_VIEWED":case 217:t.pushAtomId[r]=217;break;case"ATOM_PERMISSION_APPS_FRAGMENT_VIEWED":case 218:t.pushAtomId[r]=218;break;case"ATOM_TEXT_SELECTION_EVENT":case 219:t.pushAtomId[r]=219;break;case"ATOM_TEXT_LINKIFY_EVENT":case 220:t.pushAtomId[r]=220;break;case"ATOM_CONVERSATION_ACTIONS_EVENT":case 221:t.pushAtomId[r]=221;break;case"ATOM_LANGUAGE_DETECTION_EVENT":case 222:t.pushAtomId[r]=222;break;case"ATOM_EXCLUSION_RECT_STATE_CHANGED":case 223:t.pushAtomId[r]=223;break;case"ATOM_BACK_GESTURE_REPORTED_REPORTED":case 224:t.pushAtomId[r]=224;break;case"ATOM_UPDATE_ENGINE_UPDATE_ATTEMPT_REPORTED":case 225:t.pushAtomId[r]=225;break;case"ATOM_UPDATE_ENGINE_SUCCESSFUL_UPDATE_REPORTED":case 226:t.pushAtomId[r]=226;break;case"ATOM_CAMERA_ACTION_EVENT":case 227:t.pushAtomId[r]=227;break;case"ATOM_APP_COMPATIBILITY_CHANGE_REPORTED":case 228:t.pushAtomId[r]=228;break;case"ATOM_PERFETTO_UPLOADED":case 229:t.pushAtomId[r]=229;break;case"ATOM_VMS_CLIENT_CONNECTION_STATE_CHANGED":case 230:t.pushAtomId[r]=230;break;case"ATOM_MEDIA_PROVIDER_SCAN_OCCURRED":case 233:t.pushAtomId[r]=233;break;case"ATOM_MEDIA_CONTENT_DELETED":case 234:t.pushAtomId[r]=234;break;case"ATOM_MEDIA_PROVIDER_PERMISSION_REQUESTED":case 235:t.pushAtomId[r]=235;break;case"ATOM_MEDIA_PROVIDER_SCHEMA_CHANGED":case 236:t.pushAtomId[r]=236;break;case"ATOM_MEDIA_PROVIDER_IDLE_MAINTENANCE_FINISHED":case 237:t.pushAtomId[r]=237;break;case"ATOM_REBOOT_ESCROW_RECOVERY_REPORTED":case 238:t.pushAtomId[r]=238;break;case"ATOM_BOOT_TIME_EVENT_DURATION_REPORTED":case 239:t.pushAtomId[r]=239;break;case"ATOM_BOOT_TIME_EVENT_ELAPSED_TIME_REPORTED":case 240:t.pushAtomId[r]=240;break;case"ATOM_BOOT_TIME_EVENT_UTC_TIME_REPORTED":case 241:t.pushAtomId[r]=241;break;case"ATOM_BOOT_TIME_EVENT_ERROR_CODE_REPORTED":case 242:t.pushAtomId[r]=242;break;case"ATOM_USERSPACE_REBOOT_REPORTED":case 243:t.pushAtomId[r]=243;break;case"ATOM_NOTIFICATION_REPORTED":case 244:t.pushAtomId[r]=244;break;case"ATOM_NOTIFICATION_PANEL_REPORTED":case 245:t.pushAtomId[r]=245;break;case"ATOM_NOTIFICATION_CHANNEL_MODIFIED":case 246:t.pushAtomId[r]=246;break;case"ATOM_INTEGRITY_CHECK_RESULT_REPORTED":case 247:t.pushAtomId[r]=247;break;case"ATOM_INTEGRITY_RULES_PUSHED":case 248:t.pushAtomId[r]=248;break;case"ATOM_CB_MESSAGE_REPORTED":case 249:t.pushAtomId[r]=249;break;case"ATOM_CB_MESSAGE_ERROR":case 250:t.pushAtomId[r]=250;break;case"ATOM_WIFI_HEALTH_STAT_REPORTED":case 251:t.pushAtomId[r]=251;break;case"ATOM_WIFI_FAILURE_STAT_REPORTED":case 252:t.pushAtomId[r]=252;break;case"ATOM_WIFI_CONNECTION_RESULT_REPORTED":case 253:t.pushAtomId[r]=253;break;case"ATOM_APP_FREEZE_CHANGED":case 254:t.pushAtomId[r]=254;break;case"ATOM_SNAPSHOT_MERGE_REPORTED":case 255:t.pushAtomId[r]=255;break;case"ATOM_FOREGROUND_SERVICE_APP_OP_SESSION_ENDED":case 256:t.pushAtomId[r]=256;break;case"ATOM_DISPLAY_JANK_REPORTED":case 257:t.pushAtomId[r]=257;break;case"ATOM_APP_STANDBY_BUCKET_CHANGED":case 258:t.pushAtomId[r]=258;break;case"ATOM_SHARESHEET_STARTED":case 259:t.pushAtomId[r]=259;break;case"ATOM_RANKING_SELECTED":case 260:t.pushAtomId[r]=260;break;case"ATOM_TVSETTINGS_UI_INTERACTED":case 261:t.pushAtomId[r]=261;break;case"ATOM_LAUNCHER_SNAPSHOT":case 262:t.pushAtomId[r]=262;break;case"ATOM_PACKAGE_INSTALLER_V2_REPORTED":case 263:t.pushAtomId[r]=263;break;case"ATOM_USER_LIFECYCLE_JOURNEY_REPORTED":case 264:t.pushAtomId[r]=264;break;case"ATOM_USER_LIFECYCLE_EVENT_OCCURRED":case 265:t.pushAtomId[r]=265;break;case"ATOM_ACCESSIBILITY_SHORTCUT_REPORTED":case 266:t.pushAtomId[r]=266;break;case"ATOM_ACCESSIBILITY_SERVICE_REPORTED":case 267:t.pushAtomId[r]=267;break;case"ATOM_DOCS_UI_DRAG_AND_DROP_REPORTED":case 268:t.pushAtomId[r]=268;break;case"ATOM_APP_USAGE_EVENT_OCCURRED":case 269:t.pushAtomId[r]=269;break;case"ATOM_AUTO_REVOKE_NOTIFICATION_CLICKED":case 270:t.pushAtomId[r]=270;break;case"ATOM_AUTO_REVOKE_FRAGMENT_APP_VIEWED":case 271:t.pushAtomId[r]=271;break;case"ATOM_AUTO_REVOKED_APP_INTERACTION":case 272:t.pushAtomId[r]=272;break;case"ATOM_APP_PERMISSION_GROUPS_FRAGMENT_AUTO_REVOKE_ACTION":case 273:t.pushAtomId[r]=273;break;case"ATOM_EVS_USAGE_STATS_REPORTED":case 274:t.pushAtomId[r]=274;break;case"ATOM_AUDIO_POWER_USAGE_DATA_REPORTED":case 275:t.pushAtomId[r]=275;break;case"ATOM_TV_TUNER_STATE_CHANGED":case 276:t.pushAtomId[r]=276;break;case"ATOM_MEDIAOUTPUT_OP_SWITCH_REPORTED":case 277:t.pushAtomId[r]=277;break;case"ATOM_CB_MESSAGE_FILTERED":case 278:t.pushAtomId[r]=278;break;case"ATOM_TV_TUNER_DVR_STATUS":case 279:t.pushAtomId[r]=279;break;case"ATOM_TV_CAS_SESSION_OPEN_STATUS":case 280:t.pushAtomId[r]=280;break;case"ATOM_ASSISTANT_INVOCATION_REPORTED":case 281:t.pushAtomId[r]=281;break;case"ATOM_DISPLAY_WAKE_REPORTED":case 282:t.pushAtomId[r]=282;break;case"ATOM_CAR_USER_HAL_MODIFY_USER_REQUEST_REPORTED":case 283:t.pushAtomId[r]=283;break;case"ATOM_CAR_USER_HAL_MODIFY_USER_RESPONSE_REPORTED":case 284:t.pushAtomId[r]=284;break;case"ATOM_CAR_USER_HAL_POST_SWITCH_RESPONSE_REPORTED":case 285:t.pushAtomId[r]=285;break;case"ATOM_CAR_USER_HAL_INITIAL_USER_INFO_REQUEST_REPORTED":case 286:t.pushAtomId[r]=286;break;case"ATOM_CAR_USER_HAL_INITIAL_USER_INFO_RESPONSE_REPORTED":case 287:t.pushAtomId[r]=287;break;case"ATOM_CAR_USER_HAL_USER_ASSOCIATION_REQUEST_REPORTED":case 288:t.pushAtomId[r]=288;break;case"ATOM_CAR_USER_HAL_SET_USER_ASSOCIATION_RESPONSE_REPORTED":case 289:t.pushAtomId[r]=289;break;case"ATOM_NETWORK_IP_PROVISIONING_REPORTED":case 290:t.pushAtomId[r]=290;break;case"ATOM_NETWORK_DHCP_RENEW_REPORTED":case 291:t.pushAtomId[r]=291;break;case"ATOM_NETWORK_VALIDATION_REPORTED":case 292:t.pushAtomId[r]=292;break;case"ATOM_NETWORK_STACK_QUIRK_REPORTED":case 293:t.pushAtomId[r]=293;break;case"ATOM_MEDIAMETRICS_AUDIORECORDDEVICEUSAGE_REPORTED":case 294:t.pushAtomId[r]=294;break;case"ATOM_MEDIAMETRICS_AUDIOTHREADDEVICEUSAGE_REPORTED":case 295:t.pushAtomId[r]=295;break;case"ATOM_MEDIAMETRICS_AUDIOTRACKDEVICEUSAGE_REPORTED":case 296:t.pushAtomId[r]=296;break;case"ATOM_MEDIAMETRICS_AUDIODEVICECONNECTION_REPORTED":case 297:t.pushAtomId[r]=297;break;case"ATOM_BLOB_COMMITTED":case 298:t.pushAtomId[r]=298;break;case"ATOM_BLOB_LEASED":case 299:t.pushAtomId[r]=299;break;case"ATOM_BLOB_OPENED":case 300:t.pushAtomId[r]=300;break;case"ATOM_CONTACTS_PROVIDER_STATUS_REPORTED":case 301:t.pushAtomId[r]=301;break;case"ATOM_KEYSTORE_KEY_EVENT_REPORTED":case 302:t.pushAtomId[r]=302;break;case"ATOM_NETWORK_TETHERING_REPORTED":case 303:t.pushAtomId[r]=303;break;case"ATOM_IME_TOUCH_REPORTED":case 304:t.pushAtomId[r]=304;break;case"ATOM_UI_INTERACTION_FRAME_INFO_REPORTED":case 305:t.pushAtomId[r]=305;break;case"ATOM_UI_ACTION_LATENCY_REPORTED":case 306:t.pushAtomId[r]=306;break;case"ATOM_WIFI_DISCONNECT_REPORTED":case 307:t.pushAtomId[r]=307;break;case"ATOM_WIFI_CONNECTION_STATE_CHANGED":case 308:t.pushAtomId[r]=308;break;case"ATOM_HDMI_CEC_ACTIVE_SOURCE_CHANGED":case 309:t.pushAtomId[r]=309;break;case"ATOM_HDMI_CEC_MESSAGE_REPORTED":case 310:t.pushAtomId[r]=310;break;case"ATOM_AIRPLANE_MODE":case 311:t.pushAtomId[r]=311;break;case"ATOM_MODEM_RESTART":case 312:t.pushAtomId[r]=312;break;case"ATOM_CARRIER_ID_MISMATCH_REPORTED":case 313:t.pushAtomId[r]=313;break;case"ATOM_CARRIER_ID_TABLE_UPDATED":case 314:t.pushAtomId[r]=314;break;case"ATOM_DATA_STALL_RECOVERY_REPORTED":case 315:t.pushAtomId[r]=315;break;case"ATOM_MEDIAMETRICS_MEDIAPARSER_REPORTED":case 316:t.pushAtomId[r]=316;break;case"ATOM_TLS_HANDSHAKE_REPORTED":case 317:t.pushAtomId[r]=317;break;case"ATOM_TEXT_CLASSIFIER_API_USAGE_REPORTED":case 318:t.pushAtomId[r]=318;break;case"ATOM_CAR_WATCHDOG_KILL_STATS_REPORTED":case 319:t.pushAtomId[r]=319;break;case"ATOM_MEDIAMETRICS_PLAYBACK_REPORTED":case 320:t.pushAtomId[r]=320;break;case"ATOM_MEDIA_NETWORK_INFO_CHANGED":case 321:t.pushAtomId[r]=321;break;case"ATOM_MEDIA_PLAYBACK_STATE_CHANGED":case 322:t.pushAtomId[r]=322;break;case"ATOM_MEDIA_PLAYBACK_ERROR_REPORTED":case 323:t.pushAtomId[r]=323;break;case"ATOM_MEDIA_PLAYBACK_TRACK_CHANGED":case 324:t.pushAtomId[r]=324;break;case"ATOM_WIFI_SCAN_REPORTED":case 325:t.pushAtomId[r]=325;break;case"ATOM_WIFI_PNO_SCAN_REPORTED":case 326:t.pushAtomId[r]=326;break;case"ATOM_TIF_TUNE_CHANGED":case 327:t.pushAtomId[r]=327;break;case"ATOM_AUTO_ROTATE_REPORTED":case 328:t.pushAtomId[r]=328;break;case"ATOM_PERFETTO_TRIGGER":case 329:t.pushAtomId[r]=329;break;case"ATOM_TRANSCODING_DATA":case 330:t.pushAtomId[r]=330;break;case"ATOM_IMS_SERVICE_ENTITLEMENT_UPDATED":case 331:t.pushAtomId[r]=331;break;case"ATOM_DEVICE_ROTATED":case 333:t.pushAtomId[r]=333;break;case"ATOM_SIM_SPECIFIC_SETTINGS_RESTORED":case 334:t.pushAtomId[r]=334;break;case"ATOM_TEXT_CLASSIFIER_DOWNLOAD_REPORTED":case 335:t.pushAtomId[r]=335;break;case"ATOM_PIN_STORAGE_EVENT":case 336:t.pushAtomId[r]=336;break;case"ATOM_FACE_DOWN_REPORTED":case 337:t.pushAtomId[r]=337;break;case"ATOM_BLUETOOTH_HAL_CRASH_REASON_REPORTED":case 338:t.pushAtomId[r]=338;break;case"ATOM_REBOOT_ESCROW_PREPARATION_REPORTED":case 339:t.pushAtomId[r]=339;break;case"ATOM_REBOOT_ESCROW_LSKF_CAPTURE_REPORTED":case 340:t.pushAtomId[r]=340;break;case"ATOM_REBOOT_ESCROW_REBOOT_REPORTED":case 341:t.pushAtomId[r]=341;break;case"ATOM_BINDER_LATENCY_REPORTED":case 342:t.pushAtomId[r]=342;break;case"ATOM_MEDIAMETRICS_AAUDIOSTREAM_REPORTED":case 343:t.pushAtomId[r]=343;break;case"ATOM_MEDIA_TRANSCODING_SESSION_ENDED":case 344:t.pushAtomId[r]=344;break;case"ATOM_MAGNIFICATION_USAGE_REPORTED":case 345:t.pushAtomId[r]=345;break;case"ATOM_MAGNIFICATION_MODE_WITH_IME_ON_REPORTED":case 346:t.pushAtomId[r]=346;break;case"ATOM_APP_SEARCH_CALL_STATS_REPORTED":case 347:t.pushAtomId[r]=347;break;case"ATOM_APP_SEARCH_PUT_DOCUMENT_STATS_REPORTED":case 348:t.pushAtomId[r]=348;break;case"ATOM_DEVICE_CONTROL_CHANGED":case 349:t.pushAtomId[r]=349;break;case"ATOM_DEVICE_STATE_CHANGED":case 350:t.pushAtomId[r]=350;break;case"ATOM_INPUTDEVICE_REGISTERED":case 351:t.pushAtomId[r]=351;break;case"ATOM_SMARTSPACE_CARD_REPORTED":case 352:t.pushAtomId[r]=352;break;case"ATOM_AUTH_PROMPT_AUTHENTICATE_INVOKED":case 353:t.pushAtomId[r]=353;break;case"ATOM_AUTH_MANAGER_CAN_AUTHENTICATE_INVOKED":case 354:t.pushAtomId[r]=354;break;case"ATOM_AUTH_ENROLL_ACTION_INVOKED":case 355:t.pushAtomId[r]=355;break;case"ATOM_AUTH_DEPRECATED_API_USED":case 356:t.pushAtomId[r]=356;break;case"ATOM_UNATTENDED_REBOOT_OCCURRED":case 357:t.pushAtomId[r]=357;break;case"ATOM_LONG_REBOOT_BLOCKING_REPORTED":case 358:t.pushAtomId[r]=358;break;case"ATOM_LOCATION_TIME_ZONE_PROVIDER_STATE_CHANGED":case 359:t.pushAtomId[r]=359;break;case"ATOM_FDTRACK_EVENT_OCCURRED":case 364:t.pushAtomId[r]=364;break;case"ATOM_TIMEOUT_AUTO_EXTENDED_REPORTED":case 365:t.pushAtomId[r]=365;break;case"ATOM_ALARM_BATCH_DELIVERED":case 367:t.pushAtomId[r]=367;break;case"ATOM_ALARM_SCHEDULED":case 368:t.pushAtomId[r]=368;break;case"ATOM_CAR_WATCHDOG_IO_OVERUSE_STATS_REPORTED":case 369:t.pushAtomId[r]=369;break;case"ATOM_USER_LEVEL_HIBERNATION_STATE_CHANGED":case 370:t.pushAtomId[r]=370;break;case"ATOM_APP_SEARCH_INITIALIZE_STATS_REPORTED":case 371:t.pushAtomId[r]=371;break;case"ATOM_APP_SEARCH_QUERY_STATS_REPORTED":case 372:t.pushAtomId[r]=372;break;case"ATOM_APP_PROCESS_DIED":case 373:t.pushAtomId[r]=373;break;case"ATOM_NETWORK_IP_REACHABILITY_MONITOR_REPORTED":case 374:t.pushAtomId[r]=374;break;case"ATOM_SLOW_INPUT_EVENT_REPORTED":case 375:t.pushAtomId[r]=375;break;case"ATOM_ANR_OCCURRED_PROCESSING_STARTED":case 376:t.pushAtomId[r]=376;break;case"ATOM_APP_SEARCH_REMOVE_STATS_REPORTED":case 377:t.pushAtomId[r]=377;break;case"ATOM_MEDIA_CODEC_REPORTED":case 378:t.pushAtomId[r]=378;break;case"ATOM_PERMISSION_USAGE_FRAGMENT_INTERACTION":case 379:t.pushAtomId[r]=379;break;case"ATOM_PERMISSION_DETAILS_INTERACTION":case 380:t.pushAtomId[r]=380;break;case"ATOM_PRIVACY_SENSOR_TOGGLE_INTERACTION":case 381:t.pushAtomId[r]=381;break;case"ATOM_PRIVACY_TOGGLE_DIALOG_INTERACTION":case 382:t.pushAtomId[r]=382;break;case"ATOM_APP_SEARCH_OPTIMIZE_STATS_REPORTED":case 383:t.pushAtomId[r]=383;break;case"ATOM_NON_A11Y_TOOL_SERVICE_WARNING_REPORT":case 384:t.pushAtomId[r]=384;break;case"ATOM_APP_SEARCH_SET_SCHEMA_STATS_REPORTED":case 385:t.pushAtomId[r]=385;break;case"ATOM_APP_COMPAT_STATE_CHANGED":case 386:t.pushAtomId[r]=386;break;case"ATOM_SIZE_COMPAT_RESTART_BUTTON_EVENT_REPORTED":case 387:t.pushAtomId[r]=387;break;case"ATOM_SPLITSCREEN_UI_CHANGED":case 388:t.pushAtomId[r]=388;break;case"ATOM_NETWORK_DNS_HANDSHAKE_REPORTED":case 389:t.pushAtomId[r]=389;break;case"ATOM_BLUETOOTH_CODE_PATH_COUNTER":case 390:t.pushAtomId[r]=390;break;case"ATOM_BLUETOOTH_LE_BATCH_SCAN_REPORT_DELAY":case 392:t.pushAtomId[r]=392;break;case"ATOM_ACCESSIBILITY_FLOATING_MENU_UI_CHANGED":case 393:t.pushAtomId[r]=393;break;case"ATOM_NEURALNETWORKS_COMPILATION_COMPLETED":case 394:t.pushAtomId[r]=394;break;case"ATOM_NEURALNETWORKS_EXECUTION_COMPLETED":case 395:t.pushAtomId[r]=395;break;case"ATOM_NEURALNETWORKS_COMPILATION_FAILED":case 396:t.pushAtomId[r]=396;break;case"ATOM_NEURALNETWORKS_EXECUTION_FAILED":case 397:t.pushAtomId[r]=397;break;case"ATOM_CONTEXT_HUB_BOOTED":case 398:t.pushAtomId[r]=398;break;case"ATOM_CONTEXT_HUB_RESTARTED":case 399:t.pushAtomId[r]=399;break;case"ATOM_CONTEXT_HUB_LOADED_NANOAPP_SNAPSHOT_REPORTED":case 400:t.pushAtomId[r]=400;break;case"ATOM_CHRE_CODE_DOWNLOAD_TRANSACTED":case 401:t.pushAtomId[r]=401;break;case"ATOM_UWB_SESSION_INITED":case 402:t.pushAtomId[r]=402;break;case"ATOM_UWB_SESSION_CLOSED":case 403:t.pushAtomId[r]=403;break;case"ATOM_UWB_FIRST_RANGING_RECEIVED":case 404:t.pushAtomId[r]=404;break;case"ATOM_UWB_RANGING_MEASUREMENT_RECEIVED":case 405:t.pushAtomId[r]=405;break;case"ATOM_TEXT_CLASSIFIER_DOWNLOAD_WORK_SCHEDULED":case 406:t.pushAtomId[r]=406;break;case"ATOM_TEXT_CLASSIFIER_DOWNLOAD_WORK_COMPLETED":case 407:t.pushAtomId[r]=407;break;case"ATOM_CLIPBOARD_CLEARED":case 408:t.pushAtomId[r]=408;break;case"ATOM_VM_CREATION_REQUESTED":case 409:t.pushAtomId[r]=409;break;case"ATOM_NEARBY_DEVICE_SCAN_STATE_CHANGED":case 410:t.pushAtomId[r]=410;break;case"ATOM_CAMERA_COMPAT_CONTROL_EVENT_REPORTED":case 411:t.pushAtomId[r]=411;break;case"ATOM_APPLICATION_LOCALES_CHANGED":case 412:t.pushAtomId[r]=412;break;case"ATOM_MEDIAMETRICS_AUDIOTRACKSTATUS_REPORTED":case 413:t.pushAtomId[r]=413;break;case"ATOM_FOLD_STATE_DURATION_REPORTED":case 414:t.pushAtomId[r]=414;break;case"ATOM_LOCATION_TIME_ZONE_PROVIDER_CONTROLLER_STATE_CHANGED":case 415:t.pushAtomId[r]=415;break;case"ATOM_DISPLAY_HBM_STATE_CHANGED":case 416:t.pushAtomId[r]=416;break;case"ATOM_DISPLAY_HBM_BRIGHTNESS_CHANGED":case 417:t.pushAtomId[r]=417;break;case"ATOM_PERSISTENT_URI_PERMISSIONS_FLUSHED":case 418:t.pushAtomId[r]=418;break;case"ATOM_EARLY_BOOT_COMP_OS_ARTIFACTS_CHECK_REPORTED":case 419:t.pushAtomId[r]=419;break;case"ATOM_VBMETA_DIGEST_REPORTED":case 420:t.pushAtomId[r]=420;break;case"ATOM_APEX_INFO_GATHERED":case 421:t.pushAtomId[r]=421;break;case"ATOM_PVM_INFO_GATHERED":case 422:t.pushAtomId[r]=422;break;case"ATOM_WEAR_SETTINGS_UI_INTERACTED":case 423:t.pushAtomId[r]=423;break;case"ATOM_TRACING_SERVICE_REPORT_EVENT":case 424:t.pushAtomId[r]=424;break;case"ATOM_MEDIAMETRICS_AUDIORECORDSTATUS_REPORTED":case 425:t.pushAtomId[r]=425;break;case"ATOM_LAUNCHER_LATENCY":case 426:t.pushAtomId[r]=426;break;case"ATOM_DROPBOX_ENTRY_DROPPED":case 427:t.pushAtomId[r]=427;break;case"ATOM_WIFI_P2P_CONNECTION_REPORTED":case 428:t.pushAtomId[r]=428;break;case"ATOM_GAME_STATE_CHANGED":case 429:t.pushAtomId[r]=429;break;case"ATOM_HOTWORD_DETECTOR_CREATE_REQUESTED":case 430:t.pushAtomId[r]=430;break;case"ATOM_HOTWORD_DETECTION_SERVICE_INIT_RESULT_REPORTED":case 431:t.pushAtomId[r]=431;break;case"ATOM_HOTWORD_DETECTION_SERVICE_RESTARTED":case 432:t.pushAtomId[r]=432;break;case"ATOM_HOTWORD_DETECTOR_KEYPHRASE_TRIGGERED":case 433:t.pushAtomId[r]=433;break;case"ATOM_HOTWORD_DETECTOR_EVENTS":case 434:t.pushAtomId[r]=434;break;case"ATOM_AD_SERVICES_API_CALLED":case 435:t.pushAtomId[r]=435;break;case"ATOM_AD_SERVICES_MESUREMENT_REPORTS_UPLOADED":case 436:t.pushAtomId[r]=436;break;case"ATOM_BOOT_COMPLETED_BROADCAST_COMPLETION_LATENCY_REPORTED":case 437:t.pushAtomId[r]=437;break;case"ATOM_CONTACTS_INDEXER_UPDATE_STATS_REPORTED":case 440:t.pushAtomId[r]=440;break;case"ATOM_APP_BACKGROUND_RESTRICTIONS_INFO":case 441:t.pushAtomId[r]=441;break;case"ATOM_MMS_SMS_PROVIDER_GET_THREAD_ID_FAILED":case 442:t.pushAtomId[r]=442;break;case"ATOM_MMS_SMS_DATABASE_HELPER_ON_UPGRADE_FAILED":case 443:t.pushAtomId[r]=443;break;case"ATOM_PERMISSION_REMINDER_NOTIFICATION_INTERACTED":case 444:t.pushAtomId[r]=444;break;case"ATOM_RECENT_PERMISSION_DECISIONS_INTERACTED":case 445:t.pushAtomId[r]=445;break;case"ATOM_GNSS_PSDS_DOWNLOAD_REPORTED":case 446:t.pushAtomId[r]=446;break;case"ATOM_LE_AUDIO_CONNECTION_SESSION_REPORTED":case 447:t.pushAtomId[r]=447;break;case"ATOM_LE_AUDIO_BROADCAST_SESSION_REPORTED":case 448:t.pushAtomId[r]=448;break;case"ATOM_DREAM_UI_EVENT_REPORTED":case 449:t.pushAtomId[r]=449;break;case"ATOM_TASK_MANAGER_EVENT_REPORTED":case 450:t.pushAtomId[r]=450;break;case"ATOM_CDM_ASSOCIATION_ACTION":case 451:t.pushAtomId[r]=451;break;case"ATOM_MAGNIFICATION_TRIPLE_TAP_AND_HOLD_ACTIVATED_SESSION_REPORTED":case 452:t.pushAtomId[r]=452;break;case"ATOM_MAGNIFICATION_FOLLOW_TYPING_FOCUS_ACTIVATED_SESSION_REPORTED":case 453:t.pushAtomId[r]=453;break;case"ATOM_ACCESSIBILITY_TEXT_READING_OPTIONS_CHANGED":case 454:t.pushAtomId[r]=454;break;case"ATOM_WIFI_SETUP_FAILURE_CRASH_REPORTED":case 455:t.pushAtomId[r]=455;break;case"ATOM_UWB_DEVICE_ERROR_REPORTED":case 456:t.pushAtomId[r]=456;break;case"ATOM_ISOLATED_COMPILATION_SCHEDULED":case 457:t.pushAtomId[r]=457;break;case"ATOM_ISOLATED_COMPILATION_ENDED":case 458:t.pushAtomId[r]=458;break;case"ATOM_ONS_OPPORTUNISTIC_ESIM_PROVISIONING_COMPLETE":case 459:t.pushAtomId[r]=459;break;case"ATOM_SYSTEM_SERVER_PRE_WATCHDOG_OCCURRED":case 460:t.pushAtomId[r]=460;break;case"ATOM_TELEPHONY_ANOMALY_DETECTED":case 461:t.pushAtomId[r]=461;break;case"ATOM_LETTERBOX_POSITION_CHANGED":case 462:t.pushAtomId[r]=462;break;case"ATOM_REMOTE_KEY_PROVISIONING_ATTEMPT":case 463:t.pushAtomId[r]=463;break;case"ATOM_REMOTE_KEY_PROVISIONING_NETWORK_INFO":case 464:t.pushAtomId[r]=464;break;case"ATOM_REMOTE_KEY_PROVISIONING_TIMING":case 465:t.pushAtomId[r]=465;break;case"ATOM_MEDIAOUTPUT_OP_INTERACTION_REPORT":case 466:t.pushAtomId[r]=466;break;case"ATOM_SYNC_EXEMPTION_OCCURRED":case 468:t.pushAtomId[r]=468;break;case"ATOM_AUTOFILL_PRESENTATION_EVENT_REPORTED":case 469:t.pushAtomId[r]=469;break;case"ATOM_DOCK_STATE_CHANGED":case 470:t.pushAtomId[r]=470;break;case"ATOM_SAFETY_SOURCE_STATE_COLLECTED":case 471:t.pushAtomId[r]=471;break;case"ATOM_SAFETY_CENTER_SYSTEM_EVENT_REPORTED":case 472:t.pushAtomId[r]=472;break;case"ATOM_SAFETY_CENTER_INTERACTION_REPORTED":case 473:t.pushAtomId[r]=473;break;case"ATOM_SETTINGS_PROVIDER_SETTING_CHANGED":case 474:t.pushAtomId[r]=474;break;case"ATOM_BROADCAST_DELIVERY_EVENT_REPORTED":case 475:t.pushAtomId[r]=475;break;case"ATOM_SERVICE_REQUEST_EVENT_REPORTED":case 476:t.pushAtomId[r]=476;break;case"ATOM_PROVIDER_ACQUISITION_EVENT_REPORTED":case 477:t.pushAtomId[r]=477;break;case"ATOM_BLUETOOTH_DEVICE_NAME_REPORTED":case 478:t.pushAtomId[r]=478;break;case"ATOM_CB_CONFIG_UPDATED":case 479:t.pushAtomId[r]=479;break;case"ATOM_CB_MODULE_ERROR_REPORTED":case 480:t.pushAtomId[r]=480;break;case"ATOM_CB_SERVICE_FEATURE_CHANGED":case 481:t.pushAtomId[r]=481;break;case"ATOM_CB_RECEIVER_FEATURE_CHANGED":case 482:t.pushAtomId[r]=482;break;case"ATOM_JSSCRIPTENGINE_LATENCY_REPORTED":case 483:t.pushAtomId[r]=483;break;case"ATOM_PRIVACY_SIGNAL_NOTIFICATION_INTERACTION":case 484:t.pushAtomId[r]=484;break;case"ATOM_PRIVACY_SIGNAL_ISSUE_CARD_INTERACTION":case 485:t.pushAtomId[r]=485;break;case"ATOM_PRIVACY_SIGNALS_JOB_FAILURE":case 486:t.pushAtomId[r]=486;break;case"ATOM_VIBRATION_REPORTED":case 487:t.pushAtomId[r]=487;break;case"ATOM_UWB_RANGING_START":case 489:t.pushAtomId[r]=489;break;case"ATOM_MOBILE_DATA_DOWNLOAD_FILE_GROUP_STATUS_REPORTED":case 490:t.pushAtomId[r]=490;break;case"ATOM_APP_COMPACTED_V2":case 491:t.pushAtomId[r]=491;break;case"ATOM_AD_SERVICES_SETTINGS_USAGE_REPORTED":case 493:t.pushAtomId[r]=493;break;case"ATOM_DISPLAY_BRIGHTNESS_CHANGED":case 494:t.pushAtomId[r]=494;break;case"ATOM_ACTIVITY_ACTION_BLOCKED":case 495:t.pushAtomId[r]=495;break;case"ATOM_BACKGROUND_FETCH_PROCESS_REPORTED":case 496:t.pushAtomId[r]=496;break;case"ATOM_UPDATE_CUSTOM_AUDIENCE_PROCESS_REPORTED":case 497:t.pushAtomId[r]=497;break;case"ATOM_RUN_AD_BIDDING_PROCESS_REPORTED":case 498:t.pushAtomId[r]=498;break;case"ATOM_RUN_AD_SCORING_PROCESS_REPORTED":case 499:t.pushAtomId[r]=499;break;case"ATOM_RUN_AD_SELECTION_PROCESS_REPORTED":case 500:t.pushAtomId[r]=500;break;case"ATOM_RUN_AD_BIDDING_PER_CA_PROCESS_REPORTED":case 501:t.pushAtomId[r]=501;break;case"ATOM_MOBILE_DATA_DOWNLOAD_DOWNLOAD_RESULT_REPORTED":case 502:t.pushAtomId[r]=502;break;case"ATOM_MOBILE_DATA_DOWNLOAD_FILE_GROUP_STORAGE_STATS_REPORTED":case 503:t.pushAtomId[r]=503;break;case"ATOM_NETWORK_DNS_SERVER_SUPPORT_REPORTED":case 504:t.pushAtomId[r]=504;break;case"ATOM_VM_BOOTED":case 505:t.pushAtomId[r]=505;break;case"ATOM_VM_EXITED":case 506:t.pushAtomId[r]=506;break;case"ATOM_AMBIENT_BRIGHTNESS_STATS_REPORTED":case 507:t.pushAtomId[r]=507;break;case"ATOM_MEDIAMETRICS_SPATIALIZERCAPABILITIES_REPORTED":case 508:t.pushAtomId[r]=508;break;case"ATOM_MEDIAMETRICS_SPATIALIZERDEVICEENABLED_REPORTED":case 509:t.pushAtomId[r]=509;break;case"ATOM_MEDIAMETRICS_HEADTRACKERDEVICEENABLED_REPORTED":case 510:t.pushAtomId[r]=510;break;case"ATOM_MEDIAMETRICS_HEADTRACKERDEVICESUPPORTED_REPORTED":case 511:t.pushAtomId[r]=511;break;case"ATOM_AD_SERVICES_MEASUREMENT_REGISTRATIONS":case 512:t.pushAtomId[r]=512;break;case"ATOM_HEARING_AID_INFO_REPORTED":case 513:t.pushAtomId[r]=513;break;case"ATOM_DEVICE_WIDE_JOB_CONSTRAINT_CHANGED":case 514:t.pushAtomId[r]=514;break;case"ATOM_AMBIENT_MODE_CHANGED":case 515:t.pushAtomId[r]=515;break;case"ATOM_ANR_LATENCY_REPORTED":case 516:t.pushAtomId[r]=516;break;case"ATOM_RESOURCE_API_INFO":case 517:t.pushAtomId[r]=517;break;case"ATOM_SYSTEM_DEFAULT_NETWORK_CHANGED":case 518:t.pushAtomId[r]=518;break;case"ATOM_IWLAN_SETUP_DATA_CALL_RESULT_REPORTED":case 519:t.pushAtomId[r]=519;break;case"ATOM_IWLAN_PDN_DISCONNECTED_REASON_REPORTED":case 520:t.pushAtomId[r]=520;break;case"ATOM_AIRPLANE_MODE_SESSION_REPORTED":case 521:t.pushAtomId[r]=521;break;case"ATOM_VM_CPU_STATUS_REPORTED":case 522:t.pushAtomId[r]=522;break;case"ATOM_VM_MEM_STATUS_REPORTED":case 523:t.pushAtomId[r]=523;break;case"ATOM_PACKAGE_INSTALLATION_SESSION_REPORTED":case 524:t.pushAtomId[r]=524;break;case"ATOM_DEFAULT_NETWORK_REMATCH_INFO":case 525:t.pushAtomId[r]=525;break;case"ATOM_NETWORK_SELECTION_PERFORMANCE":case 526:t.pushAtomId[r]=526;break;case"ATOM_NETWORK_NSD_REPORTED":case 527:t.pushAtomId[r]=527;break;case"ATOM_BLUETOOTH_DISCONNECTION_REASON_REPORTED":case 529:t.pushAtomId[r]=529;break;case"ATOM_BLUETOOTH_LOCAL_VERSIONS_REPORTED":case 530:t.pushAtomId[r]=530;break;case"ATOM_BLUETOOTH_REMOTE_SUPPORTED_FEATURES_REPORTED":case 531:t.pushAtomId[r]=531;break;case"ATOM_BLUETOOTH_LOCAL_SUPPORTED_FEATURES_REPORTED":case 532:t.pushAtomId[r]=532;break;case"ATOM_BLUETOOTH_GATT_APP_INFO":case 533:t.pushAtomId[r]=533;break;case"ATOM_BRIGHTNESS_CONFIGURATION_UPDATED":case 534:t.pushAtomId[r]=534;break;case"ATOM_AD_SERVICES_GET_TOPICS_REPORTED":case 535:t.pushAtomId[r]=535;break;case"ATOM_AD_SERVICES_EPOCH_COMPUTATION_GET_TOP_TOPICS_REPORTED":case 536:t.pushAtomId[r]=536;break;case"ATOM_AD_SERVICES_EPOCH_COMPUTATION_CLASSIFIER_REPORTED":case 537:t.pushAtomId[r]=537;break;case"ATOM_WEAR_MEDIA_OUTPUT_SWITCHER_LAUNCHED":case 538:t.pushAtomId[r]=538;break;case"ATOM_WEAR_MEDIA_OUTPUT_SWITCHER_FINISHED":case 539:t.pushAtomId[r]=539;break;case"ATOM_WEAR_MEDIA_OUTPUT_SWITCHER_CONNECTION_REPORTED":case 540:t.pushAtomId[r]=540;break;case"ATOM_WEAR_MEDIA_OUTPUT_SWITCHER_DEVICE_SCAN_TRIGGERED":case 541:t.pushAtomId[r]=541;break;case"ATOM_WEAR_MEDIA_OUTPUT_SWITCHER_FIRST_DEVICE_SCAN_LATENCY":case 542:t.pushAtomId[r]=542;break;case"ATOM_WEAR_MEDIA_OUTPUT_SWITCHER_CONNECT_DEVICE_LATENCY":case 543:t.pushAtomId[r]=543;break;case"ATOM_PACKAGE_MANAGER_SNAPSHOT_REPORTED":case 544:t.pushAtomId[r]=544;break;case"ATOM_PACKAGE_MANAGER_APPS_FILTER_CACHE_BUILD_REPORTED":case 545:t.pushAtomId[r]=545;break;case"ATOM_PACKAGE_MANAGER_APPS_FILTER_CACHE_UPDATE_REPORTED":case 546:t.pushAtomId[r]=546;break;case"ATOM_LAUNCHER_IMPRESSION_EVENT":case 547:t.pushAtomId[r]=547;break;case"ATOM_WEAR_MEDIA_OUTPUT_SWITCHER_ALL_DEVICES_SCAN_LATENCY":case 549:t.pushAtomId[r]=549;break;case"ATOM_WS_WATCH_FACE_EDITED":case 551:t.pushAtomId[r]=551;break;case"ATOM_WS_WATCH_FACE_FAVORITE_ACTION_REPORTED":case 552:t.pushAtomId[r]=552;break;case"ATOM_WS_WATCH_FACE_SET_ACTION_REPORTED":case 553:t.pushAtomId[r]=553;break;case"ATOM_PACKAGE_UNINSTALLATION_REPORTED":case 554:t.pushAtomId[r]=554;break;case"ATOM_GAME_MODE_CHANGED":case 555:t.pushAtomId[r]=555;break;case"ATOM_GAME_MODE_CONFIGURATION_CHANGED":case 556:t.pushAtomId[r]=556;break;case"ATOM_BEDTIME_MODE_STATE_CHANGED":case 557:t.pushAtomId[r]=557;break;case"ATOM_NETWORK_SLICE_SESSION_ENDED":case 558:t.pushAtomId[r]=558;break;case"ATOM_NETWORK_SLICE_DAILY_DATA_USAGE_REPORTED":case 559:t.pushAtomId[r]=559;break;case"ATOM_NFC_TAG_TYPE_OCCURRED":case 560:t.pushAtomId[r]=560;break;case"ATOM_NFC_AID_CONFLICT_OCCURRED":case 561:t.pushAtomId[r]=561;break;case"ATOM_NFC_READER_CONFLICT_OCCURRED":case 562:t.pushAtomId[r]=562;break;case"ATOM_WS_TILE_LIST_CHANGED":case 563:t.pushAtomId[r]=563;break;case"ATOM_GET_TYPE_ACCESSED_WITHOUT_PERMISSION":case 564:t.pushAtomId[r]=564;break;case"ATOM_MOBILE_BUNDLED_APP_INFO_GATHERED":case 566:t.pushAtomId[r]=566;break;case"ATOM_WS_WATCH_FACE_COMPLICATION_SET_CHANGED":case 567:t.pushAtomId[r]=567;break;case"ATOM_MEDIA_DRM_CREATED":case 568:t.pushAtomId[r]=568;break;case"ATOM_MEDIA_DRM_ERRORED":case 569:t.pushAtomId[r]=569;break;case"ATOM_MEDIA_DRM_SESSION_OPENED":case 570:t.pushAtomId[r]=570;break;case"ATOM_MEDIA_DRM_SESSION_CLOSED":case 571:t.pushAtomId[r]=571;break;case"ATOM_USER_SELECTED_RESOLUTION":case 572:t.pushAtomId[r]=572;break;case"ATOM_UNSAFE_INTENT_EVENT_REPORTED":case 573:t.pushAtomId[r]=573;break;case"ATOM_PERFORMANCE_HINT_SESSION_REPORTED":case 574:t.pushAtomId[r]=574;break;case"ATOM_MEDIAMETRICS_MIDI_DEVICE_CLOSE_REPORTED":case 576:t.pushAtomId[r]=576;break;case"ATOM_BIOMETRIC_TOUCH_REPORTED":case 577:t.pushAtomId[r]=577;break;case"ATOM_HOTWORD_AUDIO_EGRESS_EVENT_REPORTED":case 578:t.pushAtomId[r]=578;break;case"ATOM_APP_SEARCH_SCHEMA_MIGRATION_STATS_REPORTED":case 579:t.pushAtomId[r]=579;break;case"ATOM_LOCATION_ENABLED_STATE_CHANGED":case 580:t.pushAtomId[r]=580;break;case"ATOM_IME_REQUEST_FINISHED":case 581:t.pushAtomId[r]=581;break;case"ATOM_USB_COMPLIANCE_WARNINGS_REPORTED":case 582:t.pushAtomId[r]=582;break;case"ATOM_APP_SUPPORTED_LOCALES_CHANGED":case 583:t.pushAtomId[r]=583;break;case"ATOM_GRAMMATICAL_INFLECTION_CHANGED":case 584:t.pushAtomId[r]=584;break;case"ATOM_MEDIA_PROVIDER_VOLUME_RECOVERY_REPORTED":case 586:t.pushAtomId[r]=586;break;case"ATOM_BIOMETRIC_PROPERTIES_COLLECTED":case 587:t.pushAtomId[r]=587;break;case"ATOM_KERNEL_WAKEUP_ATTRIBUTED":case 588:t.pushAtomId[r]=588;break;case"ATOM_SCREEN_STATE_CHANGED_V2":case 589:t.pushAtomId[r]=589;break;case"ATOM_WS_BACKUP_ACTION_REPORTED":case 590:t.pushAtomId[r]=590;break;case"ATOM_WS_RESTORE_ACTION_REPORTED":case 591:t.pushAtomId[r]=591;break;case"ATOM_DEVICE_LOG_ACCESS_EVENT_REPORTED":case 592:t.pushAtomId[r]=592;break;case"ATOM_MEDIA_SESSION_UPDATED":case 594:t.pushAtomId[r]=594;break;case"ATOM_WEAR_OOBE_STATE_CHANGED":case 595:t.pushAtomId[r]=595;break;case"ATOM_WS_NOTIFICATION_UPDATED":case 596:t.pushAtomId[r]=596;break;case"ATOM_NETWORK_VALIDATION_FAILURE_STATS_DAILY_REPORTED":case 601:t.pushAtomId[r]=601;break;case"ATOM_WS_COMPLICATION_TAPPED":case 602:t.pushAtomId[r]=602;break;case"ATOM_WS_WEAR_TIME_SESSION":case 610:t.pushAtomId[r]=610;break;case"ATOM_WIFI_BYTES_TRANSFER":case 1e4:t.pushAtomId[r]=1e4;break;case"ATOM_WIFI_BYTES_TRANSFER_BY_FG_BG":case 10001:t.pushAtomId[r]=10001;break;case"ATOM_MOBILE_BYTES_TRANSFER":case 10002:t.pushAtomId[r]=10002;break;case"ATOM_MOBILE_BYTES_TRANSFER_BY_FG_BG":case 10003:t.pushAtomId[r]=10003;break;case"ATOM_BLUETOOTH_BYTES_TRANSFER":case 10006:t.pushAtomId[r]=10006;break;case"ATOM_KERNEL_WAKELOCK":case 10004:t.pushAtomId[r]=10004;break;case"ATOM_SUBSYSTEM_SLEEP_STATE":case 10005:t.pushAtomId[r]=10005;break;case"ATOM_CPU_TIME_PER_UID":case 10009:t.pushAtomId[r]=10009;break;case"ATOM_CPU_TIME_PER_UID_FREQ":case 10010:t.pushAtomId[r]=10010;break;case"ATOM_WIFI_ACTIVITY_INFO":case 10011:t.pushAtomId[r]=10011;break;case"ATOM_MODEM_ACTIVITY_INFO":case 10012:t.pushAtomId[r]=10012;break;case"ATOM_BLUETOOTH_ACTIVITY_INFO":case 10007:t.pushAtomId[r]=10007;break;case"ATOM_PROCESS_MEMORY_STATE":case 10013:t.pushAtomId[r]=10013;break;case"ATOM_SYSTEM_ELAPSED_REALTIME":case 10014:t.pushAtomId[r]=10014;break;case"ATOM_SYSTEM_UPTIME":case 10015:t.pushAtomId[r]=10015;break;case"ATOM_CPU_ACTIVE_TIME":case 10016:t.pushAtomId[r]=10016;break;case"ATOM_CPU_CLUSTER_TIME":case 10017:t.pushAtomId[r]=10017;break;case"ATOM_DISK_SPACE":case 10018:t.pushAtomId[r]=10018;break;case"ATOM_REMAINING_BATTERY_CAPACITY":case 10019:t.pushAtomId[r]=10019;break;case"ATOM_FULL_BATTERY_CAPACITY":case 10020:t.pushAtomId[r]=10020;break;case"ATOM_TEMPERATURE":case 10021:t.pushAtomId[r]=10021;break;case"ATOM_BINDER_CALLS":case 10022:t.pushAtomId[r]=10022;break;case"ATOM_BINDER_CALLS_EXCEPTIONS":case 10023:t.pushAtomId[r]=10023;break;case"ATOM_LOOPER_STATS":case 10024:t.pushAtomId[r]=10024;break;case"ATOM_DISK_STATS":case 10025:t.pushAtomId[r]=10025;break;case"ATOM_DIRECTORY_USAGE":case 10026:t.pushAtomId[r]=10026;break;case"ATOM_APP_SIZE":case 10027:t.pushAtomId[r]=10027;break;case"ATOM_CATEGORY_SIZE":case 10028:t.pushAtomId[r]=10028;break;case"ATOM_PROC_STATS":case 10029:t.pushAtomId[r]=10029;break;case"ATOM_BATTERY_VOLTAGE":case 10030:t.pushAtomId[r]=10030;break;case"ATOM_NUM_FINGERPRINTS_ENROLLED":case 10031:t.pushAtomId[r]=10031;break;case"ATOM_DISK_IO":case 10032:t.pushAtomId[r]=10032;break;case"ATOM_POWER_PROFILE":case 10033:t.pushAtomId[r]=10033;break;case"ATOM_PROC_STATS_PKG_PROC":case 10034:t.pushAtomId[r]=10034;break;case"ATOM_PROCESS_CPU_TIME":case 10035:t.pushAtomId[r]=10035;break;case"ATOM_CPU_TIME_PER_THREAD_FREQ":case 10037:t.pushAtomId[r]=10037;break;case"ATOM_ON_DEVICE_POWER_MEASUREMENT":case 10038:t.pushAtomId[r]=10038;break;case"ATOM_DEVICE_CALCULATED_POWER_USE":case 10039:t.pushAtomId[r]=10039;break;case"ATOM_PROCESS_MEMORY_HIGH_WATER_MARK":case 10042:t.pushAtomId[r]=10042;break;case"ATOM_BATTERY_LEVEL":case 10043:t.pushAtomId[r]=10043;break;case"ATOM_BUILD_INFORMATION":case 10044:t.pushAtomId[r]=10044;break;case"ATOM_BATTERY_CYCLE_COUNT":case 10045:t.pushAtomId[r]=10045;break;case"ATOM_DEBUG_ELAPSED_CLOCK":case 10046:t.pushAtomId[r]=10046;break;case"ATOM_DEBUG_FAILING_ELAPSED_CLOCK":case 10047:t.pushAtomId[r]=10047;break;case"ATOM_NUM_FACES_ENROLLED":case 10048:t.pushAtomId[r]=10048;break;case"ATOM_ROLE_HOLDER":case 10049:t.pushAtomId[r]=10049;break;case"ATOM_DANGEROUS_PERMISSION_STATE":case 10050:t.pushAtomId[r]=10050;break;case"ATOM_TRAIN_INFO":case 10051:t.pushAtomId[r]=10051;break;case"ATOM_TIME_ZONE_DATA_INFO":case 10052:t.pushAtomId[r]=10052;break;case"ATOM_EXTERNAL_STORAGE_INFO":case 10053:t.pushAtomId[r]=10053;break;case"ATOM_GPU_STATS_GLOBAL_INFO":case 10054:t.pushAtomId[r]=10054;break;case"ATOM_GPU_STATS_APP_INFO":case 10055:t.pushAtomId[r]=10055;break;case"ATOM_SYSTEM_ION_HEAP_SIZE":case 10056:t.pushAtomId[r]=10056;break;case"ATOM_APPS_ON_EXTERNAL_STORAGE_INFO":case 10057:t.pushAtomId[r]=10057;break;case"ATOM_FACE_SETTINGS":case 10058:t.pushAtomId[r]=10058;break;case"ATOM_COOLING_DEVICE":case 10059:t.pushAtomId[r]=10059;break;case"ATOM_APP_OPS":case 10060:t.pushAtomId[r]=10060;break;case"ATOM_PROCESS_SYSTEM_ION_HEAP_SIZE":case 10061:t.pushAtomId[r]=10061;break;case"ATOM_SURFACEFLINGER_STATS_GLOBAL_INFO":case 10062:t.pushAtomId[r]=10062;break;case"ATOM_SURFACEFLINGER_STATS_LAYER_INFO":case 10063:t.pushAtomId[r]=10063;break;case"ATOM_PROCESS_MEMORY_SNAPSHOT":case 10064:t.pushAtomId[r]=10064;break;case"ATOM_VMS_CLIENT_STATS":case 10065:t.pushAtomId[r]=10065;break;case"ATOM_NOTIFICATION_REMOTE_VIEWS":case 10066:t.pushAtomId[r]=10066;break;case"ATOM_DANGEROUS_PERMISSION_STATE_SAMPLED":case 10067:t.pushAtomId[r]=10067;break;case"ATOM_GRAPHICS_STATS":case 10068:t.pushAtomId[r]=10068;break;case"ATOM_RUNTIME_APP_OP_ACCESS":case 10069:t.pushAtomId[r]=10069;break;case"ATOM_ION_HEAP_SIZE":case 10070:t.pushAtomId[r]=10070;break;case"ATOM_PACKAGE_NOTIFICATION_PREFERENCES":case 10071:t.pushAtomId[r]=10071;break;case"ATOM_PACKAGE_NOTIFICATION_CHANNEL_PREFERENCES":case 10072:t.pushAtomId[r]=10072;break;case"ATOM_PACKAGE_NOTIFICATION_CHANNEL_GROUP_PREFERENCES":case 10073:t.pushAtomId[r]=10073;break;case"ATOM_GNSS_STATS":case 10074:t.pushAtomId[r]=10074;break;case"ATOM_ATTRIBUTED_APP_OPS":case 10075:t.pushAtomId[r]=10075;break;case"ATOM_VOICE_CALL_SESSION":case 10076:t.pushAtomId[r]=10076;break;case"ATOM_VOICE_CALL_RAT_USAGE":case 10077:t.pushAtomId[r]=10077;break;case"ATOM_SIM_SLOT_STATE":case 10078:t.pushAtomId[r]=10078;break;case"ATOM_SUPPORTED_RADIO_ACCESS_FAMILY":case 10079:t.pushAtomId[r]=10079;break;case"ATOM_SETTING_SNAPSHOT":case 10080:t.pushAtomId[r]=10080;break;case"ATOM_BLOB_INFO":case 10081:t.pushAtomId[r]=10081;break;case"ATOM_DATA_USAGE_BYTES_TRANSFER":case 10082:t.pushAtomId[r]=10082;break;case"ATOM_BYTES_TRANSFER_BY_TAG_AND_METERED":case 10083:t.pushAtomId[r]=10083;break;case"ATOM_DND_MODE_RULE":case 10084:t.pushAtomId[r]=10084;break;case"ATOM_GENERAL_EXTERNAL_STORAGE_ACCESS_STATS":case 10085:t.pushAtomId[r]=10085;break;case"ATOM_INCOMING_SMS":case 10086:t.pushAtomId[r]=10086;break;case"ATOM_OUTGOING_SMS":case 10087:t.pushAtomId[r]=10087;break;case"ATOM_CARRIER_ID_TABLE_VERSION":case 10088:t.pushAtomId[r]=10088;break;case"ATOM_DATA_CALL_SESSION":case 10089:t.pushAtomId[r]=10089;break;case"ATOM_CELLULAR_SERVICE_STATE":case 10090:t.pushAtomId[r]=10090;break;case"ATOM_CELLULAR_DATA_SERVICE_SWITCH":case 10091:t.pushAtomId[r]=10091;break;case"ATOM_SYSTEM_MEMORY":case 10092:t.pushAtomId[r]=10092;break;case"ATOM_IMS_REGISTRATION_TERMINATION":case 10093:t.pushAtomId[r]=10093;break;case"ATOM_IMS_REGISTRATION_STATS":case 10094:t.pushAtomId[r]=10094;break;case"ATOM_CPU_TIME_PER_CLUSTER_FREQ":case 10095:t.pushAtomId[r]=10095;break;case"ATOM_CPU_CYCLES_PER_UID_CLUSTER":case 10096:t.pushAtomId[r]=10096;break;case"ATOM_DEVICE_ROTATED_DATA":case 10097:t.pushAtomId[r]=10097;break;case"ATOM_CPU_CYCLES_PER_THREAD_GROUP_CLUSTER":case 10098:t.pushAtomId[r]=10098;break;case"ATOM_MEDIA_DRM_ACTIVITY_INFO":case 10099:t.pushAtomId[r]=10099;break;case"ATOM_OEM_MANAGED_BYTES_TRANSFER":case 10100:t.pushAtomId[r]=10100;break;case"ATOM_GNSS_POWER_STATS":case 10101:t.pushAtomId[r]=10101;break;case"ATOM_TIME_ZONE_DETECTOR_STATE":case 10102:t.pushAtomId[r]=10102;break;case"ATOM_KEYSTORE2_STORAGE_STATS":case 10103:t.pushAtomId[r]=10103;break;case"ATOM_RKP_POOL_STATS":case 10104:t.pushAtomId[r]=10104;break;case"ATOM_PROCESS_DMABUF_MEMORY":case 10105:t.pushAtomId[r]=10105;break;case"ATOM_PENDING_ALARM_INFO":case 10106:t.pushAtomId[r]=10106;break;case"ATOM_USER_LEVEL_HIBERNATED_APPS":case 10107:t.pushAtomId[r]=10107;break;case"ATOM_LAUNCHER_LAYOUT_SNAPSHOT":case 10108:t.pushAtomId[r]=10108;break;case"ATOM_GLOBAL_HIBERNATED_APPS":case 10109:t.pushAtomId[r]=10109;break;case"ATOM_INPUT_EVENT_LATENCY_SKETCH":case 10110:t.pushAtomId[r]=10110;break;case"ATOM_BATTERY_USAGE_STATS_BEFORE_RESET":case 10111:t.pushAtomId[r]=10111;break;case"ATOM_BATTERY_USAGE_STATS_SINCE_RESET":case 10112:t.pushAtomId[r]=10112;break;case"ATOM_BATTERY_USAGE_STATS_SINCE_RESET_USING_POWER_PROFILE_MODEL":case 10113:t.pushAtomId[r]=10113;break;case"ATOM_INSTALLED_INCREMENTAL_PACKAGE":case 10114:t.pushAtomId[r]=10114;break;case"ATOM_TELEPHONY_NETWORK_REQUESTS":case 10115:t.pushAtomId[r]=10115;break;case"ATOM_APP_SEARCH_STORAGE_INFO":case 10116:t.pushAtomId[r]=10116;break;case"ATOM_VMSTAT":case 10117:t.pushAtomId[r]=10117;break;case"ATOM_KEYSTORE2_KEY_CREATION_WITH_GENERAL_INFO":case 10118:t.pushAtomId[r]=10118;break;case"ATOM_KEYSTORE2_KEY_CREATION_WITH_AUTH_INFO":case 10119:t.pushAtomId[r]=10119;break;case"ATOM_KEYSTORE2_KEY_CREATION_WITH_PURPOSE_AND_MODES_INFO":case 10120:t.pushAtomId[r]=10120;break;case"ATOM_KEYSTORE2_ATOM_WITH_OVERFLOW":case 10121:t.pushAtomId[r]=10121;break;case"ATOM_KEYSTORE2_KEY_OPERATION_WITH_PURPOSE_AND_MODES_INFO":case 10122:t.pushAtomId[r]=10122;break;case"ATOM_KEYSTORE2_KEY_OPERATION_WITH_GENERAL_INFO":case 10123:t.pushAtomId[r]=10123;break;case"ATOM_RKP_ERROR_STATS":case 10124:t.pushAtomId[r]=10124;break;case"ATOM_KEYSTORE2_CRASH_STATS":case 10125:t.pushAtomId[r]=10125;break;case"ATOM_VENDOR_APEX_INFO":case 10126:t.pushAtomId[r]=10126;break;case"ATOM_ACCESSIBILITY_SHORTCUT_STATS":case 10127:t.pushAtomId[r]=10127;break;case"ATOM_ACCESSIBILITY_FLOATING_MENU_STATS":case 10128:t.pushAtomId[r]=10128;break;case"ATOM_DATA_USAGE_BYTES_TRANSFER_V2":case 10129:t.pushAtomId[r]=10129;break;case"ATOM_MEDIA_CAPABILITIES":case 10130:t.pushAtomId[r]=10130;break;case"ATOM_CAR_WATCHDOG_SYSTEM_IO_USAGE_SUMMARY":case 10131:t.pushAtomId[r]=10131;break;case"ATOM_CAR_WATCHDOG_UID_IO_USAGE_SUMMARY":case 10132:t.pushAtomId[r]=10132;break;case"ATOM_IMS_REGISTRATION_FEATURE_TAG_STATS":case 10133:t.pushAtomId[r]=10133;break;case"ATOM_RCS_CLIENT_PROVISIONING_STATS":case 10134:t.pushAtomId[r]=10134;break;case"ATOM_RCS_ACS_PROVISIONING_STATS":case 10135:t.pushAtomId[r]=10135;break;case"ATOM_SIP_DELEGATE_STATS":case 10136:t.pushAtomId[r]=10136;break;case"ATOM_SIP_TRANSPORT_FEATURE_TAG_STATS":case 10137:t.pushAtomId[r]=10137;break;case"ATOM_SIP_MESSAGE_RESPONSE":case 10138:t.pushAtomId[r]=10138;break;case"ATOM_SIP_TRANSPORT_SESSION":case 10139:t.pushAtomId[r]=10139;break;case"ATOM_IMS_DEDICATED_BEARER_LISTENER_EVENT":case 10140:t.pushAtomId[r]=10140;break;case"ATOM_IMS_DEDICATED_BEARER_EVENT":case 10141:t.pushAtomId[r]=10141;break;case"ATOM_IMS_REGISTRATION_SERVICE_DESC_STATS":case 10142:t.pushAtomId[r]=10142;break;case"ATOM_UCE_EVENT_STATS":case 10143:t.pushAtomId[r]=10143;break;case"ATOM_PRESENCE_NOTIFY_EVENT":case 10144:t.pushAtomId[r]=10144;break;case"ATOM_GBA_EVENT":case 10145:t.pushAtomId[r]=10145;break;case"ATOM_PER_SIM_STATUS":case 10146:t.pushAtomId[r]=10146;break;case"ATOM_GPU_WORK_PER_UID":case 10147:t.pushAtomId[r]=10147;break;case"ATOM_PERSISTENT_URI_PERMISSIONS_AMOUNT_PER_PACKAGE":case 10148:t.pushAtomId[r]=10148;break;case"ATOM_SIGNED_PARTITION_INFO":case 10149:t.pushAtomId[r]=10149;break;case"ATOM_PINNED_FILE_SIZES_PER_PACKAGE":case 10150:t.pushAtomId[r]=10150;break;case"ATOM_PENDING_INTENTS_PER_PACKAGE":case 10151:t.pushAtomId[r]=10151;break;case"ATOM_USER_INFO":case 10152:t.pushAtomId[r]=10152;break;case"ATOM_TELEPHONY_NETWORK_REQUESTS_V2":case 10153:t.pushAtomId[r]=10153;break;case"ATOM_DEVICE_TELEPHONY_PROPERTIES":case 10154:t.pushAtomId[r]=10154;break;case"ATOM_REMOTE_KEY_PROVISIONING_ERROR_COUNTS":case 10155:t.pushAtomId[r]=10155;break;case"ATOM_SAFETY_STATE":case 10156:t.pushAtomId[r]=10156;break;case"ATOM_INCOMING_MMS":case 10157:t.pushAtomId[r]=10157;break;case"ATOM_OUTGOING_MMS":case 10158:t.pushAtomId[r]=10158;break;case"ATOM_MULTI_USER_INFO":case 10160:t.pushAtomId[r]=10160;break;case"ATOM_NETWORK_BPF_MAP_INFO":case 10161:t.pushAtomId[r]=10161;break;case"ATOM_OUTGOING_SHORT_CODE_SMS":case 10162:t.pushAtomId[r]=10162;break;case"ATOM_CONNECTIVITY_STATE_SAMPLE":case 10163:t.pushAtomId[r]=10163;break;case"ATOM_NETWORK_SELECTION_REMATCH_REASONS_INFO":case 10164:t.pushAtomId[r]=10164;break;case"ATOM_GAME_MODE_INFO":case 10165:t.pushAtomId[r]=10165;break;case"ATOM_GAME_MODE_CONFIGURATION":case 10166:t.pushAtomId[r]=10166;break;case"ATOM_GAME_MODE_LISTENER":case 10167:t.pushAtomId[r]=10167;break;case"ATOM_NETWORK_SLICE_REQUEST_COUNT":case 10168:t.pushAtomId[r]=10168;break;case"ATOM_WS_TILE_SNAPSHOT":case 10169:t.pushAtomId[r]=10169;break;case"ATOM_WS_ACTIVE_WATCH_FACE_COMPLICATION_SET_SNAPSHOT":case 10170:t.pushAtomId[r]=10170;break;case"ATOM_PROCESS_STATE":case 10171:t.pushAtomId[r]=10171;break;case"ATOM_PROCESS_ASSOCIATION":case 10172:t.pushAtomId[r]=10172;break;case"ATOM_ADPF_SYSTEM_COMPONENT_INFO":case 10173:t.pushAtomId[r]=10173;break;case"ATOM_NOTIFICATION_MEMORY_USE":case 10174:t.pushAtomId[r]=10174;break;case"ATOM_HDR_CAPABILITIES":case 10175:t.pushAtomId[r]=10175;break;case"ATOM_WS_FAVOURITE_WATCH_FACE_LIST_SNAPSHOT":case 10176:t.pushAtomId[r]=10176;break;case"ATOM_WIFI_AWARE_NDP_REPORTED":case 638:t.pushAtomId[r]=638;break;case"ATOM_WIFI_AWARE_ATTACH_REPORTED":case 639:t.pushAtomId[r]=639;break;case"ATOM_WIFI_SELF_RECOVERY_TRIGGERED":case 661:t.pushAtomId[r]=661;break;case"ATOM_SOFT_AP_STARTED":case 680:t.pushAtomId[r]=680;break;case"ATOM_SOFT_AP_STOPPED":case 681:t.pushAtomId[r]=681;break;case"ATOM_WIFI_LOCK_RELEASED":case 687:t.pushAtomId[r]=687;break;case"ATOM_WIFI_LOCK_DEACTIVATED":case 688:t.pushAtomId[r]=688;break;case"ATOM_WIFI_CONFIG_SAVED":case 689:t.pushAtomId[r]=689;break;case"ATOM_WIFI_AWARE_RESOURCE_USING_CHANGED":case 690:t.pushAtomId[r]=690;break;case"ATOM_WIFI_AWARE_HAL_API_CALLED":case 691:t.pushAtomId[r]=691;break;case"ATOM_WIFI_LOCAL_ONLY_REQUEST_RECEIVED":case 692:t.pushAtomId[r]=692;break;case"ATOM_WIFI_LOCAL_ONLY_REQUEST_SCAN_TRIGGERED":case 693:t.pushAtomId[r]=693;break;case"ATOM_WIFI_THREAD_TASK_EXECUTED":case 694:t.pushAtomId[r]=694;break;case"ATOM_WIFI_STATE_CHANGED":case 700:t.pushAtomId[r]=700;break;case"ATOM_WIFI_AWARE_CAPABILITIES":case 10190:t.pushAtomId[r]=10190;break;case"ATOM_WIFI_MODULE_INFO":case 10193:t.pushAtomId[r]=10193;break;case"ATOM_SETTINGS_SPA_REPORTED":case 622:t.pushAtomId[r]=622;break;case"ATOM_EXPRESS_EVENT_REPORTED":case 528:t.pushAtomId[r]=528;break;case"ATOM_EXPRESS_HISTOGRAM_SAMPLE_REPORTED":case 593:t.pushAtomId[r]=593;break;case"ATOM_EXPRESS_UID_EVENT_REPORTED":case 644:t.pushAtomId[r]=644;break;case"ATOM_EXPRESS_UID_HISTOGRAM_SAMPLE_REPORTED":case 658:t.pushAtomId[r]=658;break;case"ATOM_PERMISSION_RATIONALE_DIALOG_VIEWED":case 645:t.pushAtomId[r]=645;break;case"ATOM_PERMISSION_RATIONALE_DIALOG_ACTION_REPORTED":case 646:t.pushAtomId[r]=646;break;case"ATOM_APP_DATA_SHARING_UPDATES_NOTIFICATION_INTERACTION":case 647:t.pushAtomId[r]=647;break;case"ATOM_APP_DATA_SHARING_UPDATES_FRAGMENT_VIEWED":case 648:t.pushAtomId[r]=648;break;case"ATOM_APP_DATA_SHARING_UPDATES_FRAGMENT_ACTION_REPORTED":case 649:t.pushAtomId[r]=649;break;case"ATOM_WS_INCOMING_CALL_ACTION_REPORTED":case 626:t.pushAtomId[r]=626;break;case"ATOM_WS_CALL_DISCONNECTION_REPORTED":case 627:t.pushAtomId[r]=627;break;case"ATOM_WS_CALL_DURATION_REPORTED":case 628:t.pushAtomId[r]=628;break;case"ATOM_WS_CALL_USER_EXPERIENCE_LATENCY_REPORTED":case 629:t.pushAtomId[r]=629;break;case"ATOM_WS_CALL_INTERACTION_REPORTED":case 630:t.pushAtomId[r]=630;break;case"ATOM_FULL_SCREEN_INTENT_LAUNCHED":case 631:t.pushAtomId[r]=631;break;case"ATOM_BAL_ALLOWED":case 632:t.pushAtomId[r]=632;break;case"ATOM_IN_TASK_ACTIVITY_STARTED":case 685:t.pushAtomId[r]=685;break;case"ATOM_CACHED_APPS_HIGH_WATERMARK":case 10189:t.pushAtomId[r]=10189;break;case"ATOM_ODREFRESH_REPORTED":case 366:t.pushAtomId[r]=366;break;case"ATOM_ODSIGN_REPORTED":case 548:t.pushAtomId[r]=548;break;case"ATOM_ART_DATUM_REPORTED":case 332:t.pushAtomId[r]=332;break;case"ATOM_ART_DEVICE_DATUM_REPORTED":case 550:t.pushAtomId[r]=550;break;case"ATOM_ART_DATUM_DELTA_REPORTED":case 565:t.pushAtomId[r]=565;break;case"ATOM_BACKGROUND_DEXOPT_JOB_ENDED":case 467:t.pushAtomId[r]=467;break;case"ATOM_WEAR_ADAPTIVE_SUSPEND_STATS_REPORTED":case 619:t.pushAtomId[r]=619;break;case"ATOM_WEAR_POWER_ANOMALY_SERVICE_OPERATIONAL_STATS_REPORTED":case 620:t.pushAtomId[r]=620;break;case"ATOM_WEAR_POWER_ANOMALY_SERVICE_EVENT_STATS_REPORTED":case 621:t.pushAtomId[r]=621;break;case"ATOM_EMERGENCY_STATE_CHANGED":case 633:t.pushAtomId[r]=633;break;case"ATOM_DND_STATE_CHANGED":case 657:t.pushAtomId[r]=657;break;case"ATOM_MTE_STATE":case 10181:t.pushAtomId[r]=10181;break;case"ATOM_AD_SERVICES_BACK_COMPAT_GET_TOPICS_REPORTED":case 598:t.pushAtomId[r]=598;break;case"ATOM_AD_SERVICES_BACK_COMPAT_EPOCH_COMPUTATION_CLASSIFIER_REPORTED":case 599:t.pushAtomId[r]=599;break;case"ATOM_AD_SERVICES_MEASUREMENT_DEBUG_KEYS":case 640:t.pushAtomId[r]=640;break;case"ATOM_AD_SERVICES_ERROR_REPORTED":case 662:t.pushAtomId[r]=662;break;case"ATOM_AD_SERVICES_BACKGROUND_JOBS_EXECUTION_REPORTED":case 663:t.pushAtomId[r]=663;break;case"ATOM_AD_SERVICES_MEASUREMENT_DELAYED_SOURCE_REGISTRATION":case 673:t.pushAtomId[r]=673;break;case"ATOM_AD_SERVICES_MEASUREMENT_ATTRIBUTION":case 674:t.pushAtomId[r]=674;break;case"ATOM_AD_SERVICES_MEASUREMENT_JOBS":case 675:t.pushAtomId[r]=675;break;case"ATOM_AD_SERVICES_MEASUREMENT_WIPEOUT":case 676:t.pushAtomId[r]=676;break;case"ATOM_AD_SERVICES_CONSENT_MIGRATED":case 702:t.pushAtomId[r]=702;break;case"ATOM_RKPD_POOL_STATS":case 664:t.pushAtomId[r]=664;break;case"ATOM_RKPD_CLIENT_OPERATION":case 665:t.pushAtomId[r]=665;break;case"ATOM_AUTOFILL_UI_EVENT_REPORTED":case 603:t.pushAtomId[r]=603;break;case"ATOM_AUTOFILL_FILL_REQUEST_REPORTED":case 604:t.pushAtomId[r]=604;break;case"ATOM_AUTOFILL_FILL_RESPONSE_REPORTED":case 605:t.pushAtomId[r]=605;break;case"ATOM_AUTOFILL_SAVE_EVENT_REPORTED":case 606:t.pushAtomId[r]=606;break;case"ATOM_AUTOFILL_SESSION_COMMITTED":case 607:t.pushAtomId[r]=607;break;case"ATOM_AUTOFILL_FIELD_CLASSIFICATION_EVENT_REPORTED":case 659:t.pushAtomId[r]=659;break;case"ATOM_TEST_EXTENSION_ATOM_REPORTED":case 660:t.pushAtomId[r]=660;break;case"ATOM_TEST_RESTRICTED_ATOM_REPORTED":case 672:t.pushAtomId[r]=672;break;case"ATOM_STATS_SOCKET_LOSS_REPORTED":case 752:t.pushAtomId[r]=752;break;case"ATOM_PLUGIN_INITIALIZED":case 655:t.pushAtomId[r]=655;break;case"ATOM_TV_LOW_POWER_STANDBY_POLICY":case 679:t.pushAtomId[r]=679;break;case"ATOM_LOCKSCREEN_SHORTCUT_SELECTED":case 611:t.pushAtomId[r]=611;break;case"ATOM_LOCKSCREEN_SHORTCUT_TRIGGERED":case 612:t.pushAtomId[r]=612;break;case"ATOM_EMERGENCY_NUMBERS_INFO":case 10180:t.pushAtomId[r]=10180;break;case"ATOM_QUALIFIED_RAT_LIST_CHANGED":case 634:t.pushAtomId[r]=634;break;case"ATOM_QNS_IMS_CALL_DROP_STATS":case 635:t.pushAtomId[r]=635;break;case"ATOM_QNS_FALLBACK_RESTRICTION_CHANGED":case 636:t.pushAtomId[r]=636;break;case"ATOM_QNS_RAT_PREFERENCE_MISMATCH_INFO":case 10177:t.pushAtomId[r]=10177;break;case"ATOM_QNS_HANDOVER_TIME_MILLIS":case 10178:t.pushAtomId[r]=10178;break;case"ATOM_QNS_HANDOVER_PINGPONG":case 10179:t.pushAtomId[r]=10179;break;case"ATOM_SATELLITE_CONTROLLER":case 10182:t.pushAtomId[r]=10182;break;case"ATOM_SATELLITE_SESSION":case 10183:t.pushAtomId[r]=10183;break;case"ATOM_SATELLITE_INCOMING_DATAGRAM":case 10184:t.pushAtomId[r]=10184;break;case"ATOM_SATELLITE_OUTGOING_DATAGRAM":case 10185:t.pushAtomId[r]=10185;break;case"ATOM_SATELLITE_PROVISION":case 10186:t.pushAtomId[r]=10186;break;case"ATOM_SATELLITE_SOS_MESSAGE_RECOMMENDER":case 10187:t.pushAtomId[r]=10187;break;case"ATOM_IKE_SESSION_TERMINATED":case 678:t.pushAtomId[r]=678;break;case"ATOM_IKE_LIVENESS_CHECK_SESSION_VALIDATED":case 760:t.pushAtomId[r]=760;break;case"ATOM_BLUETOOTH_HASHED_DEVICE_NAME_REPORTED":case 613:t.pushAtomId[r]=613;break;case"ATOM_BLUETOOTH_L2CAP_COC_CLIENT_CONNECTION":case 614:t.pushAtomId[r]=614;break;case"ATOM_BLUETOOTH_L2CAP_COC_SERVER_CONNECTION":case 615:t.pushAtomId[r]=615;break;case"ATOM_BLUETOOTH_LE_SESSION_CONNECTED":case 656:t.pushAtomId[r]=656;break;case"ATOM_RESTRICTED_BLUETOOTH_DEVICE_NAME_REPORTED":case 666:t.pushAtomId[r]=666;break;case"ATOM_BLUETOOTH_PROFILE_CONNECTION_ATTEMPTED":case 696:t.pushAtomId[r]=696;break;case"ATOM_HEALTH_CONNECT_UI_IMPRESSION":case 623:t.pushAtomId[r]=623;break;case"ATOM_HEALTH_CONNECT_UI_INTERACTION":case 624:t.pushAtomId[r]=624;break;case"ATOM_HEALTH_CONNECT_APP_OPENED_REPORTED":case 625:t.pushAtomId[r]=625;break;case"ATOM_HEALTH_CONNECT_API_CALLED":case 616:t.pushAtomId[r]=616;break;case"ATOM_HEALTH_CONNECT_USAGE_STATS":case 617:t.pushAtomId[r]=617;break;case"ATOM_HEALTH_CONNECT_STORAGE_STATS":case 618:t.pushAtomId[r]=618;break;case"ATOM_HEALTH_CONNECT_API_INVOKED":case 643:t.pushAtomId[r]=643;break;case"ATOM_EXERCISE_ROUTE_API_CALLED":case 654:t.pushAtomId[r]=654;break;case"ATOM_ATOM_9999":case 9999:t.pushAtomId[r]=9999;break;case"ATOM_ATOM_99999":case 99999:t.pushAtomId[r]=99999;break;case"ATOM_THREADNETWORK_TELEMETRY_DATA_REPORTED":case 738:t.pushAtomId[r]=738;break;case"ATOM_THREADNETWORK_TOPO_ENTRY_REPEATED":case 739:t.pushAtomId[r]=739;break;case"ATOM_THREADNETWORK_DEVICE_INFO_REPORTED":case 740:t.pushAtomId[r]=740;break;case"ATOM_EMERGENCY_NUMBER_DIALED":case 637:t.pushAtomId[r]=637;break;case"ATOM_SANDBOX_API_CALLED":case 488:t.pushAtomId[r]=488;break;case"ATOM_SANDBOX_ACTIVITY_EVENT_OCCURRED":case 735:t.pushAtomId[r]=735;break;case"ATOM_SANDBOX_SDK_STORAGE":case 10159:t.pushAtomId[r]=10159;break;case"ATOM_CRONET_ENGINE_CREATED":case 703:t.pushAtomId[r]=703;break;case"ATOM_CRONET_TRAFFIC_REPORTED":case 704:t.pushAtomId[r]=704;break;case"ATOM_CRONET_ENGINE_BUILDER_INITIALIZED":case 762:t.pushAtomId[r]=762;break;case"ATOM_CRONET_HTTP_FLAGS_INITIALIZED":case 763:t.pushAtomId[r]=763;break;case"ATOM_CRONET_INITIALIZED":case 764:t.pushAtomId[r]=764;break;case"ATOM_DAILY_KEEPALIVE_INFO_REPORTED":case 650:t.pushAtomId[r]=650;break;case"ATOM_IP_CLIENT_RA_INFO_REPORTED":case 778:t.pushAtomId[r]=778;break;case"ATOM_APF_SESSION_INFO_REPORTED":case 777:t.pushAtomId[r]=777;break;case"ATOM_CREDENTIAL_MANAGER_API_CALLED":case 585:t.pushAtomId[r]=585;break;case"ATOM_CREDENTIAL_MANAGER_INIT_PHASE_REPORTED":case 651:t.pushAtomId[r]=651;break;case"ATOM_CREDENTIAL_MANAGER_CANDIDATE_PHASE_REPORTED":case 652:t.pushAtomId[r]=652;break;case"ATOM_CREDENTIAL_MANAGER_FINAL_PHASE_REPORTED":case 653:t.pushAtomId[r]=653;break;case"ATOM_CREDENTIAL_MANAGER_TOTAL_REPORTED":case 667:t.pushAtomId[r]=667;break;case"ATOM_CREDENTIAL_MANAGER_FINALNOUID_REPORTED":case 668:t.pushAtomId[r]=668;break;case"ATOM_CREDENTIAL_MANAGER_GET_REPORTED":case 669:t.pushAtomId[r]=669;break;case"ATOM_CREDENTIAL_MANAGER_AUTH_CLICK_REPORTED":case 670:t.pushAtomId[r]=670;break;case"ATOM_CREDENTIAL_MANAGER_APIV2_CALLED":case 671:t.pushAtomId[r]=671;break;case"ATOM_UWB_ACTIVITY_INFO":case 10188:t.pushAtomId[r]=10188;break;case"ATOM_MEDIA_ACTION_REPORTED":case 608:t.pushAtomId[r]=608;break;case"ATOM_MEDIA_CONTROLS_LAUNCHED":case 609:t.pushAtomId[r]=609;break;case"ATOM_MEDIA_CODEC_RECLAIM_REQUEST_COMPLETED":case 600:t.pushAtomId[r]=600;break;case"ATOM_MEDIA_CODEC_STARTED":case 641:t.pushAtomId[r]=641;break;case"ATOM_MEDIA_CODEC_STOPPED":case 642:t.pushAtomId[r]=642;break;case"ATOM_MEDIA_CODEC_RENDERED":case 684:t.pushAtomId[r]=684}}if(e.rawPushAtomId){if(!Array.isArray(e.rawPushAtomId))throw TypeError(".perfetto.protos.StatsdTracingConfig.rawPushAtomId: array expected");t.rawPushAtomId=[];for(r=0;r<e.rawPushAtomId.length;++r)t.rawPushAtomId[r]=0|e.rawPushAtomId[r]}if(e.pullConfig){if(!Array.isArray(e.pullConfig))throw TypeError(".perfetto.protos.StatsdTracingConfig.pullConfig: array expected");t.pullConfig=[];for(r=0;r<e.pullConfig.length;++r){if("object"!=typeof e.pullConfig[r])throw TypeError(".perfetto.protos.StatsdTracingConfig.pullConfig: object expected");t.pullConfig[r]=s.perfetto.protos.StatsdPullAtomConfig.fromObject(e.pullConfig[r])}}return t},_t.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.pushAtomId=[],r.rawPushAtomId=[],r.pullConfig=[]),e.pushAtomId&&e.pushAtomId.length){r.pushAtomId=[];for(var n=0;n<e.pushAtomId.length;++n)r.pushAtomId[n]=t.enums!==String||void 0===s.perfetto.protos.AtomId[e.pushAtomId[n]]?e.pushAtomId[n]:s.perfetto.protos.AtomId[e.pushAtomId[n]]}if(e.rawPushAtomId&&e.rawPushAtomId.length){r.rawPushAtomId=[];for(n=0;n<e.rawPushAtomId.length;++n)r.rawPushAtomId[n]=e.rawPushAtomId[n]}if(e.pullConfig&&e.pullConfig.length){r.pullConfig=[];for(n=0;n<e.pullConfig.length;++n)r.pullConfig[n]=s.perfetto.protos.StatsdPullAtomConfig.toObject(e.pullConfig[n],t)}return r},_t.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},_t.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.StatsdTracingConfig"},_t),r.StatsdPullAtomConfig=(yt.prototype.pullAtomId=i.emptyArray,yt.prototype.rawPullAtomId=i.emptyArray,yt.prototype.pullFrequencyMs=0,yt.prototype.packages=i.emptyArray,yt.create=function(e){return new yt(e)},yt.encode=function(e,t){if(t=t||a.create(),null!=e.pullAtomId&&e.pullAtomId.length)for(var r=0;r<e.pullAtomId.length;++r)t.uint32(8).int32(e.pullAtomId[r]);if(null!=e.rawPullAtomId&&e.rawPullAtomId.length)for(r=0;r<e.rawPullAtomId.length;++r)t.uint32(16).int32(e.rawPullAtomId[r]);if(null!=e.pullFrequencyMs&&Object.hasOwnProperty.call(e,"pullFrequencyMs")&&t.uint32(24).int32(e.pullFrequencyMs),null!=e.packages&&e.packages.length)for(r=0;r<e.packages.length;++r)t.uint32(34).string(e.packages[r]);return t},yt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.StatsdPullAtomConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:if(n.pullAtomId&&n.pullAtomId.length||(n.pullAtomId=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.pullAtomId.push(e.int32());else n.pullAtomId.push(e.int32());break;case 2:if(n.rawPullAtomId&&n.rawPullAtomId.length||(n.rawPullAtomId=[]),2==(7&a))for(i=e.uint32()+e.pos;e.pos<i;)n.rawPullAtomId.push(e.int32());else n.rawPullAtomId.push(e.int32());break;case 3:n.pullFrequencyMs=e.int32();break;case 4:n.packages&&n.packages.length||(n.packages=[]),n.packages.push(e.string());break;default:e.skipType(7&a)}}return n},yt.fromObject=function(e){if(e instanceof s.perfetto.protos.StatsdPullAtomConfig)return e;var t=new s.perfetto.protos.StatsdPullAtomConfig;if(e.pullAtomId){if(!Array.isArray(e.pullAtomId))throw TypeError(".perfetto.protos.StatsdPullAtomConfig.pullAtomId: array expected");t.pullAtomId=[];for(var r=0;r<e.pullAtomId.length;++r)switch(e.pullAtomId[r]){default:if("number"==typeof e.pullAtomId[r]){t.pullAtomId[r]=e.pullAtomId[r];break}case"ATOM_UNSPECIFIED":case 0:t.pullAtomId[r]=0;break;case"ATOM_BLE_SCAN_STATE_CHANGED":case 2:t.pullAtomId[r]=2;break;case"ATOM_PROCESS_STATE_CHANGED":case 3:t.pullAtomId[r]=3;break;case"ATOM_BLE_SCAN_RESULT_RECEIVED":case 4:t.pullAtomId[r]=4;break;case"ATOM_SENSOR_STATE_CHANGED":case 5:t.pullAtomId[r]=5;break;case"ATOM_GPS_SCAN_STATE_CHANGED":case 6:t.pullAtomId[r]=6;break;case"ATOM_SYNC_STATE_CHANGED":case 7:t.pullAtomId[r]=7;break;case"ATOM_SCHEDULED_JOB_STATE_CHANGED":case 8:t.pullAtomId[r]=8;break;case"ATOM_SCREEN_BRIGHTNESS_CHANGED":case 9:t.pullAtomId[r]=9;break;case"ATOM_WAKELOCK_STATE_CHANGED":case 10:t.pullAtomId[r]=10;break;case"ATOM_LONG_PARTIAL_WAKELOCK_STATE_CHANGED":case 11:t.pullAtomId[r]=11;break;case"ATOM_MOBILE_RADIO_POWER_STATE_CHANGED":case 12:t.pullAtomId[r]=12;break;case"ATOM_WIFI_RADIO_POWER_STATE_CHANGED":case 13:t.pullAtomId[r]=13;break;case"ATOM_ACTIVITY_MANAGER_SLEEP_STATE_CHANGED":case 14:t.pullAtomId[r]=14;break;case"ATOM_MEMORY_FACTOR_STATE_CHANGED":case 15:t.pullAtomId[r]=15;break;case"ATOM_EXCESSIVE_CPU_USAGE_REPORTED":case 16:t.pullAtomId[r]=16;break;case"ATOM_CACHED_KILL_REPORTED":case 17:t.pullAtomId[r]=17;break;case"ATOM_PROCESS_MEMORY_STAT_REPORTED":case 18:t.pullAtomId[r]=18;break;case"ATOM_LAUNCHER_EVENT":case 19:t.pullAtomId[r]=19;break;case"ATOM_BATTERY_SAVER_MODE_STATE_CHANGED":case 20:t.pullAtomId[r]=20;break;case"ATOM_DEVICE_IDLE_MODE_STATE_CHANGED":case 21:t.pullAtomId[r]=21;break;case"ATOM_DEVICE_IDLING_MODE_STATE_CHANGED":case 22:t.pullAtomId[r]=22;break;case"ATOM_AUDIO_STATE_CHANGED":case 23:t.pullAtomId[r]=23;break;case"ATOM_MEDIA_CODEC_STATE_CHANGED":case 24:t.pullAtomId[r]=24;break;case"ATOM_CAMERA_STATE_CHANGED":case 25:t.pullAtomId[r]=25;break;case"ATOM_FLASHLIGHT_STATE_CHANGED":case 26:t.pullAtomId[r]=26;break;case"ATOM_UID_PROCESS_STATE_CHANGED":case 27:t.pullAtomId[r]=27;break;case"ATOM_PROCESS_LIFE_CYCLE_STATE_CHANGED":case 28:t.pullAtomId[r]=28;break;case"ATOM_SCREEN_STATE_CHANGED":case 29:t.pullAtomId[r]=29;break;case"ATOM_BATTERY_LEVEL_CHANGED":case 30:t.pullAtomId[r]=30;break;case"ATOM_CHARGING_STATE_CHANGED":case 31:t.pullAtomId[r]=31;break;case"ATOM_PLUGGED_STATE_CHANGED":case 32:t.pullAtomId[r]=32;break;case"ATOM_INTERACTIVE_STATE_CHANGED":case 33:t.pullAtomId[r]=33;break;case"ATOM_TOUCH_EVENT_REPORTED":case 34:t.pullAtomId[r]=34;break;case"ATOM_WAKEUP_ALARM_OCCURRED":case 35:t.pullAtomId[r]=35;break;case"ATOM_KERNEL_WAKEUP_REPORTED":case 36:t.pullAtomId[r]=36;break;case"ATOM_WIFI_LOCK_STATE_CHANGED":case 37:t.pullAtomId[r]=37;break;case"ATOM_WIFI_SIGNAL_STRENGTH_CHANGED":case 38:t.pullAtomId[r]=38;break;case"ATOM_WIFI_SCAN_STATE_CHANGED":case 39:t.pullAtomId[r]=39;break;case"ATOM_PHONE_SIGNAL_STRENGTH_CHANGED":case 40:t.pullAtomId[r]=40;break;case"ATOM_SETTING_CHANGED":case 41:t.pullAtomId[r]=41;break;case"ATOM_ACTIVITY_FOREGROUND_STATE_CHANGED":case 42:t.pullAtomId[r]=42;break;case"ATOM_ISOLATED_UID_CHANGED":case 43:t.pullAtomId[r]=43;break;case"ATOM_PACKET_WAKEUP_OCCURRED":case 44:t.pullAtomId[r]=44;break;case"ATOM_WALL_CLOCK_TIME_SHIFTED":case 45:t.pullAtomId[r]=45;break;case"ATOM_ANOMALY_DETECTED":case 46:t.pullAtomId[r]=46;break;case"ATOM_APP_BREADCRUMB_REPORTED":case 47:t.pullAtomId[r]=47;break;case"ATOM_APP_START_OCCURRED":case 48:t.pullAtomId[r]=48;break;case"ATOM_APP_START_CANCELED":case 49:t.pullAtomId[r]=49;break;case"ATOM_APP_START_FULLY_DRAWN":case 50:t.pullAtomId[r]=50;break;case"ATOM_LMK_KILL_OCCURRED":case 51:t.pullAtomId[r]=51;break;case"ATOM_PICTURE_IN_PICTURE_STATE_CHANGED":case 52:t.pullAtomId[r]=52;break;case"ATOM_WIFI_MULTICAST_LOCK_STATE_CHANGED":case 53:t.pullAtomId[r]=53;break;case"ATOM_LMK_STATE_CHANGED":case 54:t.pullAtomId[r]=54;break;case"ATOM_APP_START_MEMORY_STATE_CAPTURED":case 55:t.pullAtomId[r]=55;break;case"ATOM_SHUTDOWN_SEQUENCE_REPORTED":case 56:t.pullAtomId[r]=56;break;case"ATOM_BOOT_SEQUENCE_REPORTED":case 57:t.pullAtomId[r]=57;break;case"ATOM_DAVEY_OCCURRED":case 58:t.pullAtomId[r]=58;break;case"ATOM_OVERLAY_STATE_CHANGED":case 59:t.pullAtomId[r]=59;break;case"ATOM_FOREGROUND_SERVICE_STATE_CHANGED":case 60:t.pullAtomId[r]=60;break;case"ATOM_CALL_STATE_CHANGED":case 61:t.pullAtomId[r]=61;break;case"ATOM_KEYGUARD_STATE_CHANGED":case 62:t.pullAtomId[r]=62;break;case"ATOM_KEYGUARD_BOUNCER_STATE_CHANGED":case 63:t.pullAtomId[r]=63;break;case"ATOM_KEYGUARD_BOUNCER_PASSWORD_ENTERED":case 64:t.pullAtomId[r]=64;break;case"ATOM_APP_DIED":case 65:t.pullAtomId[r]=65;break;case"ATOM_RESOURCE_CONFIGURATION_CHANGED":case 66:t.pullAtomId[r]=66;break;case"ATOM_BLUETOOTH_ENABLED_STATE_CHANGED":case 67:t.pullAtomId[r]=67;break;case"ATOM_BLUETOOTH_CONNECTION_STATE_CHANGED":case 68:t.pullAtomId[r]=68;break;case"ATOM_GPS_SIGNAL_QUALITY_CHANGED":case 69:t.pullAtomId[r]=69;break;case"ATOM_USB_CONNECTOR_STATE_CHANGED":case 70:t.pullAtomId[r]=70;break;case"ATOM_SPEAKER_IMPEDANCE_REPORTED":case 71:t.pullAtomId[r]=71;break;case"ATOM_HARDWARE_FAILED":case 72:t.pullAtomId[r]=72;break;case"ATOM_PHYSICAL_DROP_DETECTED":case 73:t.pullAtomId[r]=73;break;case"ATOM_CHARGE_CYCLES_REPORTED":case 74:t.pullAtomId[r]=74;break;case"ATOM_MOBILE_CONNECTION_STATE_CHANGED":case 75:t.pullAtomId[r]=75;break;case"ATOM_MOBILE_RADIO_TECHNOLOGY_CHANGED":case 76:t.pullAtomId[r]=76;break;case"ATOM_USB_DEVICE_ATTACHED":case 77:t.pullAtomId[r]=77;break;case"ATOM_APP_CRASH_OCCURRED":case 78:t.pullAtomId[r]=78;break;case"ATOM_ANR_OCCURRED":case 79:t.pullAtomId[r]=79;break;case"ATOM_WTF_OCCURRED":case 80:t.pullAtomId[r]=80;break;case"ATOM_LOW_MEM_REPORTED":case 81:t.pullAtomId[r]=81;break;case"ATOM_GENERIC_ATOM":case 82:t.pullAtomId[r]=82;break;case"ATOM_VIBRATOR_STATE_CHANGED":case 84:t.pullAtomId[r]=84;break;case"ATOM_DEFERRED_JOB_STATS_REPORTED":case 85:t.pullAtomId[r]=85;break;case"ATOM_THERMAL_THROTTLING":case 86:t.pullAtomId[r]=86;break;case"ATOM_BIOMETRIC_ACQUIRED":case 87:t.pullAtomId[r]=87;break;case"ATOM_BIOMETRIC_AUTHENTICATED":case 88:t.pullAtomId[r]=88;break;case"ATOM_BIOMETRIC_ERROR_OCCURRED":case 89:t.pullAtomId[r]=89;break;case"ATOM_UI_EVENT_REPORTED":case 90:t.pullAtomId[r]=90;break;case"ATOM_BATTERY_HEALTH_SNAPSHOT":case 91:t.pullAtomId[r]=91;break;case"ATOM_SLOW_IO":case 92:t.pullAtomId[r]=92;break;case"ATOM_BATTERY_CAUSED_SHUTDOWN":case 93:t.pullAtomId[r]=93;break;case"ATOM_PHONE_SERVICE_STATE_CHANGED":case 94:t.pullAtomId[r]=94;break;case"ATOM_PHONE_STATE_CHANGED":case 95:t.pullAtomId[r]=95;break;case"ATOM_USER_RESTRICTION_CHANGED":case 96:t.pullAtomId[r]=96;break;case"ATOM_SETTINGS_UI_CHANGED":case 97:t.pullAtomId[r]=97;break;case"ATOM_CONNECTIVITY_STATE_CHANGED":case 98:t.pullAtomId[r]=98;break;case"ATOM_SERVICE_STATE_CHANGED":case 99:t.pullAtomId[r]=99;break;case"ATOM_SERVICE_LAUNCH_REPORTED":case 100:t.pullAtomId[r]=100;break;case"ATOM_FLAG_FLIP_UPDATE_OCCURRED":case 101:t.pullAtomId[r]=101;break;case"ATOM_BINARY_PUSH_STATE_CHANGED":case 102:t.pullAtomId[r]=102;break;case"ATOM_DEVICE_POLICY_EVENT":case 103:t.pullAtomId[r]=103;break;case"ATOM_DOCS_UI_FILE_OP_CANCELED":case 104:t.pullAtomId[r]=104;break;case"ATOM_DOCS_UI_FILE_OP_COPY_MOVE_MODE_REPORTED":case 105:t.pullAtomId[r]=105;break;case"ATOM_DOCS_UI_FILE_OP_FAILURE":case 106:t.pullAtomId[r]=106;break;case"ATOM_DOCS_UI_PROVIDER_FILE_OP":case 107:t.pullAtomId[r]=107;break;case"ATOM_DOCS_UI_INVALID_SCOPED_ACCESS_REQUEST":case 108:t.pullAtomId[r]=108;break;case"ATOM_DOCS_UI_LAUNCH_REPORTED":case 109:t.pullAtomId[r]=109;break;case"ATOM_DOCS_UI_ROOT_VISITED":case 110:t.pullAtomId[r]=110;break;case"ATOM_DOCS_UI_STARTUP_MS":case 111:t.pullAtomId[r]=111;break;case"ATOM_DOCS_UI_USER_ACTION_REPORTED":case 112:t.pullAtomId[r]=112;break;case"ATOM_WIFI_ENABLED_STATE_CHANGED":case 113:t.pullAtomId[r]=113;break;case"ATOM_WIFI_RUNNING_STATE_CHANGED":case 114:t.pullAtomId[r]=114;break;case"ATOM_APP_COMPACTED":case 115:t.pullAtomId[r]=115;break;case"ATOM_NETWORK_DNS_EVENT_REPORTED":case 116:t.pullAtomId[r]=116;break;case"ATOM_DOCS_UI_PICKER_LAUNCHED_FROM_REPORTED":case 117:t.pullAtomId[r]=117;break;case"ATOM_DOCS_UI_PICK_RESULT_REPORTED":case 118:t.pullAtomId[r]=118;break;case"ATOM_DOCS_UI_SEARCH_MODE_REPORTED":case 119:t.pullAtomId[r]=119;break;case"ATOM_DOCS_UI_SEARCH_TYPE_REPORTED":case 120:t.pullAtomId[r]=120;break;case"ATOM_DATA_STALL_EVENT":case 121:t.pullAtomId[r]=121;break;case"ATOM_RESCUE_PARTY_RESET_REPORTED":case 122:t.pullAtomId[r]=122;break;case"ATOM_SIGNED_CONFIG_REPORTED":case 123:t.pullAtomId[r]=123;break;case"ATOM_GNSS_NI_EVENT_REPORTED":case 124:t.pullAtomId[r]=124;break;case"ATOM_BLUETOOTH_LINK_LAYER_CONNECTION_EVENT":case 125:t.pullAtomId[r]=125;break;case"ATOM_BLUETOOTH_ACL_CONNECTION_STATE_CHANGED":case 126:t.pullAtomId[r]=126;break;case"ATOM_BLUETOOTH_SCO_CONNECTION_STATE_CHANGED":case 127:t.pullAtomId[r]=127;break;case"ATOM_APP_DOWNGRADED":case 128:t.pullAtomId[r]=128;break;case"ATOM_APP_OPTIMIZED_AFTER_DOWNGRADED":case 129:t.pullAtomId[r]=129;break;case"ATOM_LOW_STORAGE_STATE_CHANGED":case 130:t.pullAtomId[r]=130;break;case"ATOM_GNSS_NFW_NOTIFICATION_REPORTED":case 131:t.pullAtomId[r]=131;break;case"ATOM_GNSS_CONFIGURATION_REPORTED":case 132:t.pullAtomId[r]=132;break;case"ATOM_USB_PORT_OVERHEAT_EVENT_REPORTED":case 133:t.pullAtomId[r]=133;break;case"ATOM_NFC_ERROR_OCCURRED":case 134:t.pullAtomId[r]=134;break;case"ATOM_NFC_STATE_CHANGED":case 135:t.pullAtomId[r]=135;break;case"ATOM_NFC_BEAM_OCCURRED":case 136:t.pullAtomId[r]=136;break;case"ATOM_NFC_CARDEMULATION_OCCURRED":case 137:t.pullAtomId[r]=137;break;case"ATOM_NFC_TAG_OCCURRED":case 138:t.pullAtomId[r]=138;break;case"ATOM_NFC_HCE_TRANSACTION_OCCURRED":case 139:t.pullAtomId[r]=139;break;case"ATOM_SE_STATE_CHANGED":case 140:t.pullAtomId[r]=140;break;case"ATOM_SE_OMAPI_REPORTED":case 141:t.pullAtomId[r]=141;break;case"ATOM_BROADCAST_DISPATCH_LATENCY_REPORTED":case 142:t.pullAtomId[r]=142;break;case"ATOM_ATTENTION_MANAGER_SERVICE_RESULT_REPORTED":case 143:t.pullAtomId[r]=143;break;case"ATOM_ADB_CONNECTION_CHANGED":case 144:t.pullAtomId[r]=144;break;case"ATOM_SPEECH_DSP_STAT_REPORTED":case 145:t.pullAtomId[r]=145;break;case"ATOM_USB_CONTAMINANT_REPORTED":case 146:t.pullAtomId[r]=146;break;case"ATOM_WATCHDOG_ROLLBACK_OCCURRED":case 147:t.pullAtomId[r]=147;break;case"ATOM_BIOMETRIC_SYSTEM_HEALTH_ISSUE_DETECTED":case 148:t.pullAtomId[r]=148;break;case"ATOM_BUBBLE_UI_CHANGED":case 149:t.pullAtomId[r]=149;break;case"ATOM_SCHEDULED_JOB_CONSTRAINT_CHANGED":case 150:t.pullAtomId[r]=150;break;case"ATOM_BLUETOOTH_ACTIVE_DEVICE_CHANGED":case 151:t.pullAtomId[r]=151;break;case"ATOM_BLUETOOTH_A2DP_PLAYBACK_STATE_CHANGED":case 152:t.pullAtomId[r]=152;break;case"ATOM_BLUETOOTH_A2DP_CODEC_CONFIG_CHANGED":case 153:t.pullAtomId[r]=153;break;case"ATOM_BLUETOOTH_A2DP_CODEC_CAPABILITY_CHANGED":case 154:t.pullAtomId[r]=154;break;case"ATOM_BLUETOOTH_A2DP_AUDIO_UNDERRUN_REPORTED":case 155:t.pullAtomId[r]=155;break;case"ATOM_BLUETOOTH_A2DP_AUDIO_OVERRUN_REPORTED":case 156:t.pullAtomId[r]=156;break;case"ATOM_BLUETOOTH_DEVICE_RSSI_REPORTED":case 157:t.pullAtomId[r]=157;break;case"ATOM_BLUETOOTH_DEVICE_FAILED_CONTACT_COUNTER_REPORTED":case 158:t.pullAtomId[r]=158;break;case"ATOM_BLUETOOTH_DEVICE_TX_POWER_LEVEL_REPORTED":case 159:t.pullAtomId[r]=159;break;case"ATOM_BLUETOOTH_HCI_TIMEOUT_REPORTED":case 160:t.pullAtomId[r]=160;break;case"ATOM_BLUETOOTH_QUALITY_REPORT_REPORTED":case 161:t.pullAtomId[r]=161;break;case"ATOM_BLUETOOTH_DEVICE_INFO_REPORTED":case 162:t.pullAtomId[r]=162;break;case"ATOM_BLUETOOTH_REMOTE_VERSION_INFO_REPORTED":case 163:t.pullAtomId[r]=163;break;case"ATOM_BLUETOOTH_SDP_ATTRIBUTE_REPORTED":case 164:t.pullAtomId[r]=164;break;case"ATOM_BLUETOOTH_BOND_STATE_CHANGED":case 165:t.pullAtomId[r]=165;break;case"ATOM_BLUETOOTH_CLASSIC_PAIRING_EVENT_REPORTED":case 166:t.pullAtomId[r]=166;break;case"ATOM_BLUETOOTH_SMP_PAIRING_EVENT_REPORTED":case 167:t.pullAtomId[r]=167;break;case"ATOM_SCREEN_TIMEOUT_EXTENSION_REPORTED":case 168:t.pullAtomId[r]=168;break;case"ATOM_PROCESS_START_TIME":case 169:t.pullAtomId[r]=169;break;case"ATOM_PERMISSION_GRANT_REQUEST_RESULT_REPORTED":case 170:t.pullAtomId[r]=170;break;case"ATOM_BLUETOOTH_SOCKET_CONNECTION_STATE_CHANGED":case 171:t.pullAtomId[r]=171;break;case"ATOM_DEVICE_IDENTIFIER_ACCESS_DENIED":case 172:t.pullAtomId[r]=172;break;case"ATOM_BUBBLE_DEVELOPER_ERROR_REPORTED":case 173:t.pullAtomId[r]=173;break;case"ATOM_ASSIST_GESTURE_STAGE_REPORTED":case 174:t.pullAtomId[r]=174;break;case"ATOM_ASSIST_GESTURE_FEEDBACK_REPORTED":case 175:t.pullAtomId[r]=175;break;case"ATOM_ASSIST_GESTURE_PROGRESS_REPORTED":case 176:t.pullAtomId[r]=176;break;case"ATOM_TOUCH_GESTURE_CLASSIFIED":case 177:t.pullAtomId[r]=177;break;case"ATOM_HIDDEN_API_USED":case 178:t.pullAtomId[r]=178;break;case"ATOM_STYLE_UI_CHANGED":case 179:t.pullAtomId[r]=179;break;case"ATOM_PRIVACY_INDICATORS_INTERACTED":case 180:t.pullAtomId[r]=180;break;case"ATOM_APP_INSTALL_ON_EXTERNAL_STORAGE_REPORTED":case 181:t.pullAtomId[r]=181;break;case"ATOM_NETWORK_STACK_REPORTED":case 182:t.pullAtomId[r]=182;break;case"ATOM_APP_MOVED_STORAGE_REPORTED":case 183:t.pullAtomId[r]=183;break;case"ATOM_BIOMETRIC_ENROLLED":case 184:t.pullAtomId[r]=184;break;case"ATOM_SYSTEM_SERVER_WATCHDOG_OCCURRED":case 185:t.pullAtomId[r]=185;break;case"ATOM_TOMB_STONE_OCCURRED":case 186:t.pullAtomId[r]=186;break;case"ATOM_BLUETOOTH_CLASS_OF_DEVICE_REPORTED":case 187:t.pullAtomId[r]=187;break;case"ATOM_INTELLIGENCE_EVENT_REPORTED":case 188:t.pullAtomId[r]=188;break;case"ATOM_THERMAL_THROTTLING_SEVERITY_STATE_CHANGED":case 189:t.pullAtomId[r]=189;break;case"ATOM_ROLE_REQUEST_RESULT_REPORTED":case 190:t.pullAtomId[r]=190;break;case"ATOM_MEDIAMETRICS_AUDIOPOLICY_REPORTED":case 191:t.pullAtomId[r]=191;break;case"ATOM_MEDIAMETRICS_AUDIORECORD_REPORTED":case 192:t.pullAtomId[r]=192;break;case"ATOM_MEDIAMETRICS_AUDIOTHREAD_REPORTED":case 193:t.pullAtomId[r]=193;break;case"ATOM_MEDIAMETRICS_AUDIOTRACK_REPORTED":case 194:t.pullAtomId[r]=194;break;case"ATOM_MEDIAMETRICS_CODEC_REPORTED":case 195:t.pullAtomId[r]=195;break;case"ATOM_MEDIAMETRICS_DRM_WIDEVINE_REPORTED":case 196:t.pullAtomId[r]=196;break;case"ATOM_MEDIAMETRICS_EXTRACTOR_REPORTED":case 197:t.pullAtomId[r]=197;break;case"ATOM_MEDIAMETRICS_MEDIADRM_REPORTED":case 198:t.pullAtomId[r]=198;break;case"ATOM_MEDIAMETRICS_NUPLAYER_REPORTED":case 199:t.pullAtomId[r]=199;break;case"ATOM_MEDIAMETRICS_RECORDER_REPORTED":case 200:t.pullAtomId[r]=200;break;case"ATOM_MEDIAMETRICS_DRMMANAGER_REPORTED":case 201:t.pullAtomId[r]=201;break;case"ATOM_CAR_POWER_STATE_CHANGED":case 203:t.pullAtomId[r]=203;break;case"ATOM_GARAGE_MODE_INFO":case 204:t.pullAtomId[r]=204;break;case"ATOM_TEST_ATOM_REPORTED":case 205:t.pullAtomId[r]=205;break;case"ATOM_CONTENT_CAPTURE_CALLER_MISMATCH_REPORTED":case 206:t.pullAtomId[r]=206;break;case"ATOM_CONTENT_CAPTURE_SERVICE_EVENTS":case 207:t.pullAtomId[r]=207;break;case"ATOM_CONTENT_CAPTURE_SESSION_EVENTS":case 208:t.pullAtomId[r]=208;break;case"ATOM_CONTENT_CAPTURE_FLUSHED":case 209:t.pullAtomId[r]=209;break;case"ATOM_LOCATION_MANAGER_API_USAGE_REPORTED":case 210:t.pullAtomId[r]=210;break;case"ATOM_REVIEW_PERMISSIONS_FRAGMENT_RESULT_REPORTED":case 211:t.pullAtomId[r]=211;break;case"ATOM_RUNTIME_PERMISSIONS_UPGRADE_RESULT":case 212:t.pullAtomId[r]=212;break;case"ATOM_GRANT_PERMISSIONS_ACTIVITY_BUTTON_ACTIONS":case 213:t.pullAtomId[r]=213;break;case"ATOM_LOCATION_ACCESS_CHECK_NOTIFICATION_ACTION":case 214:t.pullAtomId[r]=214;break;case"ATOM_APP_PERMISSION_FRAGMENT_ACTION_REPORTED":case 215:t.pullAtomId[r]=215;break;case"ATOM_APP_PERMISSION_FRAGMENT_VIEWED":case 216:t.pullAtomId[r]=216;break;case"ATOM_APP_PERMISSIONS_FRAGMENT_VIEWED":case 217:t.pullAtomId[r]=217;break;case"ATOM_PERMISSION_APPS_FRAGMENT_VIEWED":case 218:t.pullAtomId[r]=218;break;case"ATOM_TEXT_SELECTION_EVENT":case 219:t.pullAtomId[r]=219;break;case"ATOM_TEXT_LINKIFY_EVENT":case 220:t.pullAtomId[r]=220;break;case"ATOM_CONVERSATION_ACTIONS_EVENT":case 221:t.pullAtomId[r]=221;break;case"ATOM_LANGUAGE_DETECTION_EVENT":case 222:t.pullAtomId[r]=222;break;case"ATOM_EXCLUSION_RECT_STATE_CHANGED":case 223:t.pullAtomId[r]=223;break;case"ATOM_BACK_GESTURE_REPORTED_REPORTED":case 224:t.pullAtomId[r]=224;break;case"ATOM_UPDATE_ENGINE_UPDATE_ATTEMPT_REPORTED":case 225:t.pullAtomId[r]=225;break;case"ATOM_UPDATE_ENGINE_SUCCESSFUL_UPDATE_REPORTED":case 226:t.pullAtomId[r]=226;break;case"ATOM_CAMERA_ACTION_EVENT":case 227:t.pullAtomId[r]=227;break;case"ATOM_APP_COMPATIBILITY_CHANGE_REPORTED":case 228:t.pullAtomId[r]=228;break;case"ATOM_PERFETTO_UPLOADED":case 229:t.pullAtomId[r]=229;break;case"ATOM_VMS_CLIENT_CONNECTION_STATE_CHANGED":case 230:t.pullAtomId[r]=230;break;case"ATOM_MEDIA_PROVIDER_SCAN_OCCURRED":case 233:t.pullAtomId[r]=233;break;case"ATOM_MEDIA_CONTENT_DELETED":case 234:t.pullAtomId[r]=234;break;case"ATOM_MEDIA_PROVIDER_PERMISSION_REQUESTED":case 235:t.pullAtomId[r]=235;break;case"ATOM_MEDIA_PROVIDER_SCHEMA_CHANGED":case 236:t.pullAtomId[r]=236;break;case"ATOM_MEDIA_PROVIDER_IDLE_MAINTENANCE_FINISHED":case 237:t.pullAtomId[r]=237;break;case"ATOM_REBOOT_ESCROW_RECOVERY_REPORTED":case 238:t.pullAtomId[r]=238;break;case"ATOM_BOOT_TIME_EVENT_DURATION_REPORTED":case 239:t.pullAtomId[r]=239;break;case"ATOM_BOOT_TIME_EVENT_ELAPSED_TIME_REPORTED":case 240:t.pullAtomId[r]=240;break;case"ATOM_BOOT_TIME_EVENT_UTC_TIME_REPORTED":case 241:t.pullAtomId[r]=241;break;case"ATOM_BOOT_TIME_EVENT_ERROR_CODE_REPORTED":case 242:t.pullAtomId[r]=242;break;case"ATOM_USERSPACE_REBOOT_REPORTED":case 243:t.pullAtomId[r]=243;break;case"ATOM_NOTIFICATION_REPORTED":case 244:t.pullAtomId[r]=244;break;case"ATOM_NOTIFICATION_PANEL_REPORTED":case 245:t.pullAtomId[r]=245;break;case"ATOM_NOTIFICATION_CHANNEL_MODIFIED":case 246:t.pullAtomId[r]=246;break;case"ATOM_INTEGRITY_CHECK_RESULT_REPORTED":case 247:t.pullAtomId[r]=247;break;case"ATOM_INTEGRITY_RULES_PUSHED":case 248:t.pullAtomId[r]=248;break;case"ATOM_CB_MESSAGE_REPORTED":case 249:t.pullAtomId[r]=249;break;case"ATOM_CB_MESSAGE_ERROR":case 250:t.pullAtomId[r]=250;break;case"ATOM_WIFI_HEALTH_STAT_REPORTED":case 251:t.pullAtomId[r]=251;break;case"ATOM_WIFI_FAILURE_STAT_REPORTED":case 252:t.pullAtomId[r]=252;break;case"ATOM_WIFI_CONNECTION_RESULT_REPORTED":case 253:t.pullAtomId[r]=253;break;case"ATOM_APP_FREEZE_CHANGED":case 254:t.pullAtomId[r]=254;break;case"ATOM_SNAPSHOT_MERGE_REPORTED":case 255:t.pullAtomId[r]=255;break;case"ATOM_FOREGROUND_SERVICE_APP_OP_SESSION_ENDED":case 256:t.pullAtomId[r]=256;break;case"ATOM_DISPLAY_JANK_REPORTED":case 257:t.pullAtomId[r]=257;break;case"ATOM_APP_STANDBY_BUCKET_CHANGED":case 258:t.pullAtomId[r]=258;break;case"ATOM_SHARESHEET_STARTED":case 259:t.pullAtomId[r]=259;break;case"ATOM_RANKING_SELECTED":case 260:t.pullAtomId[r]=260;break;case"ATOM_TVSETTINGS_UI_INTERACTED":case 261:t.pullAtomId[r]=261;break;case"ATOM_LAUNCHER_SNAPSHOT":case 262:t.pullAtomId[r]=262;break;case"ATOM_PACKAGE_INSTALLER_V2_REPORTED":case 263:t.pullAtomId[r]=263;break;case"ATOM_USER_LIFECYCLE_JOURNEY_REPORTED":case 264:t.pullAtomId[r]=264;break;case"ATOM_USER_LIFECYCLE_EVENT_OCCURRED":case 265:t.pullAtomId[r]=265;break;case"ATOM_ACCESSIBILITY_SHORTCUT_REPORTED":case 266:t.pullAtomId[r]=266;break;case"ATOM_ACCESSIBILITY_SERVICE_REPORTED":case 267:t.pullAtomId[r]=267;break;case"ATOM_DOCS_UI_DRAG_AND_DROP_REPORTED":case 268:t.pullAtomId[r]=268;break;case"ATOM_APP_USAGE_EVENT_OCCURRED":case 269:t.pullAtomId[r]=269;break;case"ATOM_AUTO_REVOKE_NOTIFICATION_CLICKED":case 270:t.pullAtomId[r]=270;break;case"ATOM_AUTO_REVOKE_FRAGMENT_APP_VIEWED":case 271:t.pullAtomId[r]=271;break;case"ATOM_AUTO_REVOKED_APP_INTERACTION":case 272:t.pullAtomId[r]=272;break;case"ATOM_APP_PERMISSION_GROUPS_FRAGMENT_AUTO_REVOKE_ACTION":case 273:t.pullAtomId[r]=273;break;case"ATOM_EVS_USAGE_STATS_REPORTED":case 274:t.pullAtomId[r]=274;break;case"ATOM_AUDIO_POWER_USAGE_DATA_REPORTED":case 275:t.pullAtomId[r]=275;break;case"ATOM_TV_TUNER_STATE_CHANGED":case 276:t.pullAtomId[r]=276;break;case"ATOM_MEDIAOUTPUT_OP_SWITCH_REPORTED":case 277:t.pullAtomId[r]=277;break;case"ATOM_CB_MESSAGE_FILTERED":case 278:t.pullAtomId[r]=278;break;case"ATOM_TV_TUNER_DVR_STATUS":case 279:t.pullAtomId[r]=279;break;case"ATOM_TV_CAS_SESSION_OPEN_STATUS":case 280:t.pullAtomId[r]=280;break;case"ATOM_ASSISTANT_INVOCATION_REPORTED":case 281:t.pullAtomId[r]=281;break;case"ATOM_DISPLAY_WAKE_REPORTED":case 282:t.pullAtomId[r]=282;break;case"ATOM_CAR_USER_HAL_MODIFY_USER_REQUEST_REPORTED":case 283:t.pullAtomId[r]=283;break;case"ATOM_CAR_USER_HAL_MODIFY_USER_RESPONSE_REPORTED":case 284:t.pullAtomId[r]=284;break;case"ATOM_CAR_USER_HAL_POST_SWITCH_RESPONSE_REPORTED":case 285:t.pullAtomId[r]=285;break;case"ATOM_CAR_USER_HAL_INITIAL_USER_INFO_REQUEST_REPORTED":case 286:t.pullAtomId[r]=286;break;case"ATOM_CAR_USER_HAL_INITIAL_USER_INFO_RESPONSE_REPORTED":case 287:t.pullAtomId[r]=287;break;case"ATOM_CAR_USER_HAL_USER_ASSOCIATION_REQUEST_REPORTED":case 288:t.pullAtomId[r]=288;break;case"ATOM_CAR_USER_HAL_SET_USER_ASSOCIATION_RESPONSE_REPORTED":case 289:t.pullAtomId[r]=289;break;case"ATOM_NETWORK_IP_PROVISIONING_REPORTED":case 290:t.pullAtomId[r]=290;break;case"ATOM_NETWORK_DHCP_RENEW_REPORTED":case 291:t.pullAtomId[r]=291;break;case"ATOM_NETWORK_VALIDATION_REPORTED":case 292:t.pullAtomId[r]=292;break;case"ATOM_NETWORK_STACK_QUIRK_REPORTED":case 293:t.pullAtomId[r]=293;break;case"ATOM_MEDIAMETRICS_AUDIORECORDDEVICEUSAGE_REPORTED":case 294:t.pullAtomId[r]=294;break;case"ATOM_MEDIAMETRICS_AUDIOTHREADDEVICEUSAGE_REPORTED":case 295:t.pullAtomId[r]=295;break;case"ATOM_MEDIAMETRICS_AUDIOTRACKDEVICEUSAGE_REPORTED":case 296:t.pullAtomId[r]=296;break;case"ATOM_MEDIAMETRICS_AUDIODEVICECONNECTION_REPORTED":case 297:t.pullAtomId[r]=297;break;case"ATOM_BLOB_COMMITTED":case 298:t.pullAtomId[r]=298;break;case"ATOM_BLOB_LEASED":case 299:t.pullAtomId[r]=299;break;case"ATOM_BLOB_OPENED":case 300:t.pullAtomId[r]=300;break;case"ATOM_CONTACTS_PROVIDER_STATUS_REPORTED":case 301:t.pullAtomId[r]=301;break;case"ATOM_KEYSTORE_KEY_EVENT_REPORTED":case 302:t.pullAtomId[r]=302;break;case"ATOM_NETWORK_TETHERING_REPORTED":case 303:t.pullAtomId[r]=303;break;case"ATOM_IME_TOUCH_REPORTED":case 304:t.pullAtomId[r]=304;break;case"ATOM_UI_INTERACTION_FRAME_INFO_REPORTED":case 305:t.pullAtomId[r]=305;break;case"ATOM_UI_ACTION_LATENCY_REPORTED":case 306:t.pullAtomId[r]=306;break;case"ATOM_WIFI_DISCONNECT_REPORTED":case 307:t.pullAtomId[r]=307;break;case"ATOM_WIFI_CONNECTION_STATE_CHANGED":case 308:t.pullAtomId[r]=308;break;case"ATOM_HDMI_CEC_ACTIVE_SOURCE_CHANGED":case 309:t.pullAtomId[r]=309;break;case"ATOM_HDMI_CEC_MESSAGE_REPORTED":case 310:t.pullAtomId[r]=310;break;case"ATOM_AIRPLANE_MODE":case 311:t.pullAtomId[r]=311;break;case"ATOM_MODEM_RESTART":case 312:t.pullAtomId[r]=312;break;case"ATOM_CARRIER_ID_MISMATCH_REPORTED":case 313:t.pullAtomId[r]=313;break;case"ATOM_CARRIER_ID_TABLE_UPDATED":case 314:t.pullAtomId[r]=314;break;case"ATOM_DATA_STALL_RECOVERY_REPORTED":case 315:t.pullAtomId[r]=315;break;case"ATOM_MEDIAMETRICS_MEDIAPARSER_REPORTED":case 316:t.pullAtomId[r]=316;break;case"ATOM_TLS_HANDSHAKE_REPORTED":case 317:t.pullAtomId[r]=317;break;case"ATOM_TEXT_CLASSIFIER_API_USAGE_REPORTED":case 318:t.pullAtomId[r]=318;break;case"ATOM_CAR_WATCHDOG_KILL_STATS_REPORTED":case 319:t.pullAtomId[r]=319;break;case"ATOM_MEDIAMETRICS_PLAYBACK_REPORTED":case 320:t.pullAtomId[r]=320;break;case"ATOM_MEDIA_NETWORK_INFO_CHANGED":case 321:t.pullAtomId[r]=321;break;case"ATOM_MEDIA_PLAYBACK_STATE_CHANGED":case 322:t.pullAtomId[r]=322;break;case"ATOM_MEDIA_PLAYBACK_ERROR_REPORTED":case 323:t.pullAtomId[r]=323;break;case"ATOM_MEDIA_PLAYBACK_TRACK_CHANGED":case 324:t.pullAtomId[r]=324;break;case"ATOM_WIFI_SCAN_REPORTED":case 325:t.pullAtomId[r]=325;break;case"ATOM_WIFI_PNO_SCAN_REPORTED":case 326:t.pullAtomId[r]=326;break;case"ATOM_TIF_TUNE_CHANGED":case 327:t.pullAtomId[r]=327;break;case"ATOM_AUTO_ROTATE_REPORTED":case 328:t.pullAtomId[r]=328;break;case"ATOM_PERFETTO_TRIGGER":case 329:t.pullAtomId[r]=329;break;case"ATOM_TRANSCODING_DATA":case 330:t.pullAtomId[r]=330;break;case"ATOM_IMS_SERVICE_ENTITLEMENT_UPDATED":case 331:t.pullAtomId[r]=331;break;case"ATOM_DEVICE_ROTATED":case 333:t.pullAtomId[r]=333;break;case"ATOM_SIM_SPECIFIC_SETTINGS_RESTORED":case 334:t.pullAtomId[r]=334;break;case"ATOM_TEXT_CLASSIFIER_DOWNLOAD_REPORTED":case 335:t.pullAtomId[r]=335;break;case"ATOM_PIN_STORAGE_EVENT":case 336:t.pullAtomId[r]=336;break;case"ATOM_FACE_DOWN_REPORTED":case 337:t.pullAtomId[r]=337;break;case"ATOM_BLUETOOTH_HAL_CRASH_REASON_REPORTED":case 338:t.pullAtomId[r]=338;break;case"ATOM_REBOOT_ESCROW_PREPARATION_REPORTED":case 339:t.pullAtomId[r]=339;break;case"ATOM_REBOOT_ESCROW_LSKF_CAPTURE_REPORTED":case 340:t.pullAtomId[r]=340;break;case"ATOM_REBOOT_ESCROW_REBOOT_REPORTED":case 341:t.pullAtomId[r]=341;break;case"ATOM_BINDER_LATENCY_REPORTED":case 342:t.pullAtomId[r]=342;break;case"ATOM_MEDIAMETRICS_AAUDIOSTREAM_REPORTED":case 343:t.pullAtomId[r]=343;break;case"ATOM_MEDIA_TRANSCODING_SESSION_ENDED":case 344:t.pullAtomId[r]=344;break;case"ATOM_MAGNIFICATION_USAGE_REPORTED":case 345:t.pullAtomId[r]=345;break;case"ATOM_MAGNIFICATION_MODE_WITH_IME_ON_REPORTED":case 346:t.pullAtomId[r]=346;break;case"ATOM_APP_SEARCH_CALL_STATS_REPORTED":case 347:t.pullAtomId[r]=347;break;case"ATOM_APP_SEARCH_PUT_DOCUMENT_STATS_REPORTED":case 348:t.pullAtomId[r]=348;break;case"ATOM_DEVICE_CONTROL_CHANGED":case 349:t.pullAtomId[r]=349;break;case"ATOM_DEVICE_STATE_CHANGED":case 350:t.pullAtomId[r]=350;break;case"ATOM_INPUTDEVICE_REGISTERED":case 351:t.pullAtomId[r]=351;break;case"ATOM_SMARTSPACE_CARD_REPORTED":case 352:t.pullAtomId[r]=352;break;case"ATOM_AUTH_PROMPT_AUTHENTICATE_INVOKED":case 353:t.pullAtomId[r]=353;break;case"ATOM_AUTH_MANAGER_CAN_AUTHENTICATE_INVOKED":case 354:t.pullAtomId[r]=354;break;case"ATOM_AUTH_ENROLL_ACTION_INVOKED":case 355:t.pullAtomId[r]=355;break;case"ATOM_AUTH_DEPRECATED_API_USED":case 356:t.pullAtomId[r]=356;break;case"ATOM_UNATTENDED_REBOOT_OCCURRED":case 357:t.pullAtomId[r]=357;break;case"ATOM_LONG_REBOOT_BLOCKING_REPORTED":case 358:t.pullAtomId[r]=358;break;case"ATOM_LOCATION_TIME_ZONE_PROVIDER_STATE_CHANGED":case 359:t.pullAtomId[r]=359;break;case"ATOM_FDTRACK_EVENT_OCCURRED":case 364:t.pullAtomId[r]=364;break;case"ATOM_TIMEOUT_AUTO_EXTENDED_REPORTED":case 365:t.pullAtomId[r]=365;break;case"ATOM_ALARM_BATCH_DELIVERED":case 367:t.pullAtomId[r]=367;break;case"ATOM_ALARM_SCHEDULED":case 368:t.pullAtomId[r]=368;break;case"ATOM_CAR_WATCHDOG_IO_OVERUSE_STATS_REPORTED":case 369:t.pullAtomId[r]=369;break;case"ATOM_USER_LEVEL_HIBERNATION_STATE_CHANGED":case 370:t.pullAtomId[r]=370;break;case"ATOM_APP_SEARCH_INITIALIZE_STATS_REPORTED":case 371:t.pullAtomId[r]=371;break;case"ATOM_APP_SEARCH_QUERY_STATS_REPORTED":case 372:t.pullAtomId[r]=372;break;case"ATOM_APP_PROCESS_DIED":case 373:t.pullAtomId[r]=373;break;case"ATOM_NETWORK_IP_REACHABILITY_MONITOR_REPORTED":case 374:t.pullAtomId[r]=374;break;case"ATOM_SLOW_INPUT_EVENT_REPORTED":case 375:t.pullAtomId[r]=375;break;case"ATOM_ANR_OCCURRED_PROCESSING_STARTED":case 376:t.pullAtomId[r]=376;break;case"ATOM_APP_SEARCH_REMOVE_STATS_REPORTED":case 377:t.pullAtomId[r]=377;break;case"ATOM_MEDIA_CODEC_REPORTED":case 378:t.pullAtomId[r]=378;break;case"ATOM_PERMISSION_USAGE_FRAGMENT_INTERACTION":case 379:t.pullAtomId[r]=379;break;case"ATOM_PERMISSION_DETAILS_INTERACTION":case 380:t.pullAtomId[r]=380;break;case"ATOM_PRIVACY_SENSOR_TOGGLE_INTERACTION":case 381:t.pullAtomId[r]=381;break;case"ATOM_PRIVACY_TOGGLE_DIALOG_INTERACTION":case 382:t.pullAtomId[r]=382;break;case"ATOM_APP_SEARCH_OPTIMIZE_STATS_REPORTED":case 383:t.pullAtomId[r]=383;break;case"ATOM_NON_A11Y_TOOL_SERVICE_WARNING_REPORT":case 384:t.pullAtomId[r]=384;break;case"ATOM_APP_SEARCH_SET_SCHEMA_STATS_REPORTED":case 385:t.pullAtomId[r]=385;break;case"ATOM_APP_COMPAT_STATE_CHANGED":case 386:t.pullAtomId[r]=386;break;case"ATOM_SIZE_COMPAT_RESTART_BUTTON_EVENT_REPORTED":case 387:t.pullAtomId[r]=387;break;case"ATOM_SPLITSCREEN_UI_CHANGED":case 388:t.pullAtomId[r]=388;break;case"ATOM_NETWORK_DNS_HANDSHAKE_REPORTED":case 389:t.pullAtomId[r]=389;break;case"ATOM_BLUETOOTH_CODE_PATH_COUNTER":case 390:t.pullAtomId[r]=390;break;case"ATOM_BLUETOOTH_LE_BATCH_SCAN_REPORT_DELAY":case 392:t.pullAtomId[r]=392;break;case"ATOM_ACCESSIBILITY_FLOATING_MENU_UI_CHANGED":case 393:t.pullAtomId[r]=393;break;case"ATOM_NEURALNETWORKS_COMPILATION_COMPLETED":case 394:t.pullAtomId[r]=394;break;case"ATOM_NEURALNETWORKS_EXECUTION_COMPLETED":case 395:t.pullAtomId[r]=395;break;case"ATOM_NEURALNETWORKS_COMPILATION_FAILED":case 396:t.pullAtomId[r]=396;break;case"ATOM_NEURALNETWORKS_EXECUTION_FAILED":case 397:t.pullAtomId[r]=397;break;case"ATOM_CONTEXT_HUB_BOOTED":case 398:t.pullAtomId[r]=398;break;case"ATOM_CONTEXT_HUB_RESTARTED":case 399:t.pullAtomId[r]=399;break;case"ATOM_CONTEXT_HUB_LOADED_NANOAPP_SNAPSHOT_REPORTED":case 400:t.pullAtomId[r]=400;break;case"ATOM_CHRE_CODE_DOWNLOAD_TRANSACTED":case 401:t.pullAtomId[r]=401;break;case"ATOM_UWB_SESSION_INITED":case 402:t.pullAtomId[r]=402;break;case"ATOM_UWB_SESSION_CLOSED":case 403:t.pullAtomId[r]=403;break;case"ATOM_UWB_FIRST_RANGING_RECEIVED":case 404:t.pullAtomId[r]=404;break;case"ATOM_UWB_RANGING_MEASUREMENT_RECEIVED":case 405:t.pullAtomId[r]=405;break;case"ATOM_TEXT_CLASSIFIER_DOWNLOAD_WORK_SCHEDULED":case 406:t.pullAtomId[r]=406;break;case"ATOM_TEXT_CLASSIFIER_DOWNLOAD_WORK_COMPLETED":case 407:t.pullAtomId[r]=407;break;case"ATOM_CLIPBOARD_CLEARED":case 408:t.pullAtomId[r]=408;break;case"ATOM_VM_CREATION_REQUESTED":case 409:t.pullAtomId[r]=409;break;case"ATOM_NEARBY_DEVICE_SCAN_STATE_CHANGED":case 410:t.pullAtomId[r]=410;break;case"ATOM_CAMERA_COMPAT_CONTROL_EVENT_REPORTED":case 411:t.pullAtomId[r]=411;break;case"ATOM_APPLICATION_LOCALES_CHANGED":case 412:t.pullAtomId[r]=412;break;case"ATOM_MEDIAMETRICS_AUDIOTRACKSTATUS_REPORTED":case 413:t.pullAtomId[r]=413;break;case"ATOM_FOLD_STATE_DURATION_REPORTED":case 414:t.pullAtomId[r]=414;break;case"ATOM_LOCATION_TIME_ZONE_PROVIDER_CONTROLLER_STATE_CHANGED":case 415:t.pullAtomId[r]=415;break;case"ATOM_DISPLAY_HBM_STATE_CHANGED":case 416:t.pullAtomId[r]=416;break;case"ATOM_DISPLAY_HBM_BRIGHTNESS_CHANGED":case 417:t.pullAtomId[r]=417;break;case"ATOM_PERSISTENT_URI_PERMISSIONS_FLUSHED":case 418:t.pullAtomId[r]=418;break;case"ATOM_EARLY_BOOT_COMP_OS_ARTIFACTS_CHECK_REPORTED":case 419:t.pullAtomId[r]=419;break;case"ATOM_VBMETA_DIGEST_REPORTED":case 420:t.pullAtomId[r]=420;break;case"ATOM_APEX_INFO_GATHERED":case 421:t.pullAtomId[r]=421;break;case"ATOM_PVM_INFO_GATHERED":case 422:t.pullAtomId[r]=422;break;case"ATOM_WEAR_SETTINGS_UI_INTERACTED":case 423:t.pullAtomId[r]=423;break;case"ATOM_TRACING_SERVICE_REPORT_EVENT":case 424:t.pullAtomId[r]=424;break;case"ATOM_MEDIAMETRICS_AUDIORECORDSTATUS_REPORTED":case 425:t.pullAtomId[r]=425;break;case"ATOM_LAUNCHER_LATENCY":case 426:t.pullAtomId[r]=426;break;case"ATOM_DROPBOX_ENTRY_DROPPED":case 427:t.pullAtomId[r]=427;break;case"ATOM_WIFI_P2P_CONNECTION_REPORTED":case 428:t.pullAtomId[r]=428;break;case"ATOM_GAME_STATE_CHANGED":case 429:t.pullAtomId[r]=429;break;case"ATOM_HOTWORD_DETECTOR_CREATE_REQUESTED":case 430:t.pullAtomId[r]=430;break;case"ATOM_HOTWORD_DETECTION_SERVICE_INIT_RESULT_REPORTED":case 431:t.pullAtomId[r]=431;break;case"ATOM_HOTWORD_DETECTION_SERVICE_RESTARTED":case 432:t.pullAtomId[r]=432;break;case"ATOM_HOTWORD_DETECTOR_KEYPHRASE_TRIGGERED":case 433:t.pullAtomId[r]=433;break;case"ATOM_HOTWORD_DETECTOR_EVENTS":case 434:t.pullAtomId[r]=434;break;case"ATOM_AD_SERVICES_API_CALLED":case 435:t.pullAtomId[r]=435;break;case"ATOM_AD_SERVICES_MESUREMENT_REPORTS_UPLOADED":case 436:t.pullAtomId[r]=436;break;case"ATOM_BOOT_COMPLETED_BROADCAST_COMPLETION_LATENCY_REPORTED":case 437:t.pullAtomId[r]=437;break;case"ATOM_CONTACTS_INDEXER_UPDATE_STATS_REPORTED":case 440:t.pullAtomId[r]=440;break;case"ATOM_APP_BACKGROUND_RESTRICTIONS_INFO":case 441:t.pullAtomId[r]=441;break;case"ATOM_MMS_SMS_PROVIDER_GET_THREAD_ID_FAILED":case 442:t.pullAtomId[r]=442;break;case"ATOM_MMS_SMS_DATABASE_HELPER_ON_UPGRADE_FAILED":case 443:t.pullAtomId[r]=443;break;case"ATOM_PERMISSION_REMINDER_NOTIFICATION_INTERACTED":case 444:t.pullAtomId[r]=444;break;case"ATOM_RECENT_PERMISSION_DECISIONS_INTERACTED":case 445:t.pullAtomId[r]=445;break;case"ATOM_GNSS_PSDS_DOWNLOAD_REPORTED":case 446:t.pullAtomId[r]=446;break;case"ATOM_LE_AUDIO_CONNECTION_SESSION_REPORTED":case 447:t.pullAtomId[r]=447;break;case"ATOM_LE_AUDIO_BROADCAST_SESSION_REPORTED":case 448:t.pullAtomId[r]=448;break;case"ATOM_DREAM_UI_EVENT_REPORTED":case 449:t.pullAtomId[r]=449;break;case"ATOM_TASK_MANAGER_EVENT_REPORTED":case 450:t.pullAtomId[r]=450;break;case"ATOM_CDM_ASSOCIATION_ACTION":case 451:t.pullAtomId[r]=451;break;case"ATOM_MAGNIFICATION_TRIPLE_TAP_AND_HOLD_ACTIVATED_SESSION_REPORTED":case 452:t.pullAtomId[r]=452;break;case"ATOM_MAGNIFICATION_FOLLOW_TYPING_FOCUS_ACTIVATED_SESSION_REPORTED":case 453:t.pullAtomId[r]=453;break;case"ATOM_ACCESSIBILITY_TEXT_READING_OPTIONS_CHANGED":case 454:t.pullAtomId[r]=454;break;case"ATOM_WIFI_SETUP_FAILURE_CRASH_REPORTED":case 455:t.pullAtomId[r]=455;break;case"ATOM_UWB_DEVICE_ERROR_REPORTED":case 456:t.pullAtomId[r]=456;break;case"ATOM_ISOLATED_COMPILATION_SCHEDULED":case 457:t.pullAtomId[r]=457;break;case"ATOM_ISOLATED_COMPILATION_ENDED":case 458:t.pullAtomId[r]=458;break;case"ATOM_ONS_OPPORTUNISTIC_ESIM_PROVISIONING_COMPLETE":case 459:t.pullAtomId[r]=459;break;case"ATOM_SYSTEM_SERVER_PRE_WATCHDOG_OCCURRED":case 460:t.pullAtomId[r]=460;break;case"ATOM_TELEPHONY_ANOMALY_DETECTED":case 461:t.pullAtomId[r]=461;break;case"ATOM_LETTERBOX_POSITION_CHANGED":case 462:t.pullAtomId[r]=462;break;case"ATOM_REMOTE_KEY_PROVISIONING_ATTEMPT":case 463:t.pullAtomId[r]=463;break;case"ATOM_REMOTE_KEY_PROVISIONING_NETWORK_INFO":case 464:t.pullAtomId[r]=464;break;case"ATOM_REMOTE_KEY_PROVISIONING_TIMING":case 465:t.pullAtomId[r]=465;break;case"ATOM_MEDIAOUTPUT_OP_INTERACTION_REPORT":case 466:t.pullAtomId[r]=466;break;case"ATOM_SYNC_EXEMPTION_OCCURRED":case 468:t.pullAtomId[r]=468;break;case"ATOM_AUTOFILL_PRESENTATION_EVENT_REPORTED":case 469:t.pullAtomId[r]=469;break;case"ATOM_DOCK_STATE_CHANGED":case 470:t.pullAtomId[r]=470;break;case"ATOM_SAFETY_SOURCE_STATE_COLLECTED":case 471:t.pullAtomId[r]=471;break;case"ATOM_SAFETY_CENTER_SYSTEM_EVENT_REPORTED":case 472:t.pullAtomId[r]=472;break;case"ATOM_SAFETY_CENTER_INTERACTION_REPORTED":case 473:t.pullAtomId[r]=473;break;case"ATOM_SETTINGS_PROVIDER_SETTING_CHANGED":case 474:t.pullAtomId[r]=474;break;case"ATOM_BROADCAST_DELIVERY_EVENT_REPORTED":case 475:t.pullAtomId[r]=475;break;case"ATOM_SERVICE_REQUEST_EVENT_REPORTED":case 476:t.pullAtomId[r]=476;break;case"ATOM_PROVIDER_ACQUISITION_EVENT_REPORTED":case 477:t.pullAtomId[r]=477;break;case"ATOM_BLUETOOTH_DEVICE_NAME_REPORTED":case 478:t.pullAtomId[r]=478;break;case"ATOM_CB_CONFIG_UPDATED":case 479:t.pullAtomId[r]=479;break;case"ATOM_CB_MODULE_ERROR_REPORTED":case 480:t.pullAtomId[r]=480;break;case"ATOM_CB_SERVICE_FEATURE_CHANGED":case 481:t.pullAtomId[r]=481;break;case"ATOM_CB_RECEIVER_FEATURE_CHANGED":case 482:t.pullAtomId[r]=482;break;case"ATOM_JSSCRIPTENGINE_LATENCY_REPORTED":case 483:t.pullAtomId[r]=483;break;case"ATOM_PRIVACY_SIGNAL_NOTIFICATION_INTERACTION":case 484:t.pullAtomId[r]=484;break;case"ATOM_PRIVACY_SIGNAL_ISSUE_CARD_INTERACTION":case 485:t.pullAtomId[r]=485;break;case"ATOM_PRIVACY_SIGNALS_JOB_FAILURE":case 486:t.pullAtomId[r]=486;break;case"ATOM_VIBRATION_REPORTED":case 487:t.pullAtomId[r]=487;break;case"ATOM_UWB_RANGING_START":case 489:t.pullAtomId[r]=489;break;case"ATOM_MOBILE_DATA_DOWNLOAD_FILE_GROUP_STATUS_REPORTED":case 490:t.pullAtomId[r]=490;break;case"ATOM_APP_COMPACTED_V2":case 491:t.pullAtomId[r]=491;break;case"ATOM_AD_SERVICES_SETTINGS_USAGE_REPORTED":case 493:t.pullAtomId[r]=493;break;case"ATOM_DISPLAY_BRIGHTNESS_CHANGED":case 494:t.pullAtomId[r]=494;break;case"ATOM_ACTIVITY_ACTION_BLOCKED":case 495:t.pullAtomId[r]=495;break;case"ATOM_BACKGROUND_FETCH_PROCESS_REPORTED":case 496:t.pullAtomId[r]=496;break;case"ATOM_UPDATE_CUSTOM_AUDIENCE_PROCESS_REPORTED":case 497:t.pullAtomId[r]=497;break;case"ATOM_RUN_AD_BIDDING_PROCESS_REPORTED":case 498:t.pullAtomId[r]=498;break;case"ATOM_RUN_AD_SCORING_PROCESS_REPORTED":case 499:t.pullAtomId[r]=499;break;case"ATOM_RUN_AD_SELECTION_PROCESS_REPORTED":case 500:t.pullAtomId[r]=500;break;case"ATOM_RUN_AD_BIDDING_PER_CA_PROCESS_REPORTED":case 501:t.pullAtomId[r]=501;break;case"ATOM_MOBILE_DATA_DOWNLOAD_DOWNLOAD_RESULT_REPORTED":case 502:t.pullAtomId[r]=502;break;case"ATOM_MOBILE_DATA_DOWNLOAD_FILE_GROUP_STORAGE_STATS_REPORTED":case 503:t.pullAtomId[r]=503;break;case"ATOM_NETWORK_DNS_SERVER_SUPPORT_REPORTED":case 504:t.pullAtomId[r]=504;break;case"ATOM_VM_BOOTED":case 505:t.pullAtomId[r]=505;break;case"ATOM_VM_EXITED":case 506:t.pullAtomId[r]=506;break;case"ATOM_AMBIENT_BRIGHTNESS_STATS_REPORTED":case 507:t.pullAtomId[r]=507;break;case"ATOM_MEDIAMETRICS_SPATIALIZERCAPABILITIES_REPORTED":case 508:t.pullAtomId[r]=508;break;case"ATOM_MEDIAMETRICS_SPATIALIZERDEVICEENABLED_REPORTED":case 509:t.pullAtomId[r]=509;break;case"ATOM_MEDIAMETRICS_HEADTRACKERDEVICEENABLED_REPORTED":case 510:t.pullAtomId[r]=510;break;case"ATOM_MEDIAMETRICS_HEADTRACKERDEVICESUPPORTED_REPORTED":case 511:t.pullAtomId[r]=511;break;case"ATOM_AD_SERVICES_MEASUREMENT_REGISTRATIONS":case 512:t.pullAtomId[r]=512;break;case"ATOM_HEARING_AID_INFO_REPORTED":case 513:t.pullAtomId[r]=513;break;case"ATOM_DEVICE_WIDE_JOB_CONSTRAINT_CHANGED":case 514:t.pullAtomId[r]=514;break;case"ATOM_AMBIENT_MODE_CHANGED":case 515:t.pullAtomId[r]=515;break;case"ATOM_ANR_LATENCY_REPORTED":case 516:t.pullAtomId[r]=516;break;case"ATOM_RESOURCE_API_INFO":case 517:t.pullAtomId[r]=517;break;case"ATOM_SYSTEM_DEFAULT_NETWORK_CHANGED":case 518:t.pullAtomId[r]=518;break;case"ATOM_IWLAN_SETUP_DATA_CALL_RESULT_REPORTED":case 519:t.pullAtomId[r]=519;break;case"ATOM_IWLAN_PDN_DISCONNECTED_REASON_REPORTED":case 520:t.pullAtomId[r]=520;break;case"ATOM_AIRPLANE_MODE_SESSION_REPORTED":case 521:t.pullAtomId[r]=521;break;case"ATOM_VM_CPU_STATUS_REPORTED":case 522:t.pullAtomId[r]=522;break;case"ATOM_VM_MEM_STATUS_REPORTED":case 523:t.pullAtomId[r]=523;break;case"ATOM_PACKAGE_INSTALLATION_SESSION_REPORTED":case 524:t.pullAtomId[r]=524;break;case"ATOM_DEFAULT_NETWORK_REMATCH_INFO":case 525:t.pullAtomId[r]=525;break;case"ATOM_NETWORK_SELECTION_PERFORMANCE":case 526:t.pullAtomId[r]=526;break;case"ATOM_NETWORK_NSD_REPORTED":case 527:t.pullAtomId[r]=527;break;case"ATOM_BLUETOOTH_DISCONNECTION_REASON_REPORTED":case 529:t.pullAtomId[r]=529;break;case"ATOM_BLUETOOTH_LOCAL_VERSIONS_REPORTED":case 530:t.pullAtomId[r]=530;break;case"ATOM_BLUETOOTH_REMOTE_SUPPORTED_FEATURES_REPORTED":case 531:t.pullAtomId[r]=531;break;case"ATOM_BLUETOOTH_LOCAL_SUPPORTED_FEATURES_REPORTED":case 532:t.pullAtomId[r]=532;break;case"ATOM_BLUETOOTH_GATT_APP_INFO":case 533:t.pullAtomId[r]=533;break;case"ATOM_BRIGHTNESS_CONFIGURATION_UPDATED":case 534:t.pullAtomId[r]=534;break;case"ATOM_AD_SERVICES_GET_TOPICS_REPORTED":case 535:t.pullAtomId[r]=535;break;case"ATOM_AD_SERVICES_EPOCH_COMPUTATION_GET_TOP_TOPICS_REPORTED":case 536:t.pullAtomId[r]=536;break;case"ATOM_AD_SERVICES_EPOCH_COMPUTATION_CLASSIFIER_REPORTED":case 537:t.pullAtomId[r]=537;break;case"ATOM_WEAR_MEDIA_OUTPUT_SWITCHER_LAUNCHED":case 538:t.pullAtomId[r]=538;break;case"ATOM_WEAR_MEDIA_OUTPUT_SWITCHER_FINISHED":case 539:t.pullAtomId[r]=539;break;case"ATOM_WEAR_MEDIA_OUTPUT_SWITCHER_CONNECTION_REPORTED":case 540:t.pullAtomId[r]=540;break;case"ATOM_WEAR_MEDIA_OUTPUT_SWITCHER_DEVICE_SCAN_TRIGGERED":case 541:t.pullAtomId[r]=541;break;case"ATOM_WEAR_MEDIA_OUTPUT_SWITCHER_FIRST_DEVICE_SCAN_LATENCY":case 542:t.pullAtomId[r]=542;break;case"ATOM_WEAR_MEDIA_OUTPUT_SWITCHER_CONNECT_DEVICE_LATENCY":case 543:t.pullAtomId[r]=543;break;case"ATOM_PACKAGE_MANAGER_SNAPSHOT_REPORTED":case 544:t.pullAtomId[r]=544;break;case"ATOM_PACKAGE_MANAGER_APPS_FILTER_CACHE_BUILD_REPORTED":case 545:t.pullAtomId[r]=545;break;case"ATOM_PACKAGE_MANAGER_APPS_FILTER_CACHE_UPDATE_REPORTED":case 546:t.pullAtomId[r]=546;break;case"ATOM_LAUNCHER_IMPRESSION_EVENT":case 547:t.pullAtomId[r]=547;break;case"ATOM_WEAR_MEDIA_OUTPUT_SWITCHER_ALL_DEVICES_SCAN_LATENCY":case 549:t.pullAtomId[r]=549;break;case"ATOM_WS_WATCH_FACE_EDITED":case 551:t.pullAtomId[r]=551;break;case"ATOM_WS_WATCH_FACE_FAVORITE_ACTION_REPORTED":case 552:t.pullAtomId[r]=552;break;case"ATOM_WS_WATCH_FACE_SET_ACTION_REPORTED":case 553:t.pullAtomId[r]=553;break;case"ATOM_PACKAGE_UNINSTALLATION_REPORTED":case 554:t.pullAtomId[r]=554;break;case"ATOM_GAME_MODE_CHANGED":case 555:t.pullAtomId[r]=555;break;case"ATOM_GAME_MODE_CONFIGURATION_CHANGED":case 556:t.pullAtomId[r]=556;break;case"ATOM_BEDTIME_MODE_STATE_CHANGED":case 557:t.pullAtomId[r]=557;break;case"ATOM_NETWORK_SLICE_SESSION_ENDED":case 558:t.pullAtomId[r]=558;break;case"ATOM_NETWORK_SLICE_DAILY_DATA_USAGE_REPORTED":case 559:t.pullAtomId[r]=559;break;case"ATOM_NFC_TAG_TYPE_OCCURRED":case 560:t.pullAtomId[r]=560;break;case"ATOM_NFC_AID_CONFLICT_OCCURRED":case 561:t.pullAtomId[r]=561;break;case"ATOM_NFC_READER_CONFLICT_OCCURRED":case 562:t.pullAtomId[r]=562;break;case"ATOM_WS_TILE_LIST_CHANGED":case 563:t.pullAtomId[r]=563;break;case"ATOM_GET_TYPE_ACCESSED_WITHOUT_PERMISSION":case 564:t.pullAtomId[r]=564;break;case"ATOM_MOBILE_BUNDLED_APP_INFO_GATHERED":case 566:t.pullAtomId[r]=566;break;case"ATOM_WS_WATCH_FACE_COMPLICATION_SET_CHANGED":case 567:t.pullAtomId[r]=567;break;case"ATOM_MEDIA_DRM_CREATED":case 568:t.pullAtomId[r]=568;break;case"ATOM_MEDIA_DRM_ERRORED":case 569:t.pullAtomId[r]=569;break;case"ATOM_MEDIA_DRM_SESSION_OPENED":case 570:t.pullAtomId[r]=570;break;case"ATOM_MEDIA_DRM_SESSION_CLOSED":case 571:t.pullAtomId[r]=571;break;case"ATOM_USER_SELECTED_RESOLUTION":case 572:t.pullAtomId[r]=572;break;case"ATOM_UNSAFE_INTENT_EVENT_REPORTED":case 573:t.pullAtomId[r]=573;break;case"ATOM_PERFORMANCE_HINT_SESSION_REPORTED":case 574:t.pullAtomId[r]=574;break;case"ATOM_MEDIAMETRICS_MIDI_DEVICE_CLOSE_REPORTED":case 576:t.pullAtomId[r]=576;break;case"ATOM_BIOMETRIC_TOUCH_REPORTED":case 577:t.pullAtomId[r]=577;break;case"ATOM_HOTWORD_AUDIO_EGRESS_EVENT_REPORTED":case 578:t.pullAtomId[r]=578;break;case"ATOM_APP_SEARCH_SCHEMA_MIGRATION_STATS_REPORTED":case 579:t.pullAtomId[r]=579;break;case"ATOM_LOCATION_ENABLED_STATE_CHANGED":case 580:t.pullAtomId[r]=580;break;case"ATOM_IME_REQUEST_FINISHED":case 581:t.pullAtomId[r]=581;break;case"ATOM_USB_COMPLIANCE_WARNINGS_REPORTED":case 582:t.pullAtomId[r]=582;break;case"ATOM_APP_SUPPORTED_LOCALES_CHANGED":case 583:t.pullAtomId[r]=583;break;case"ATOM_GRAMMATICAL_INFLECTION_CHANGED":case 584:t.pullAtomId[r]=584;break;case"ATOM_MEDIA_PROVIDER_VOLUME_RECOVERY_REPORTED":case 586:t.pullAtomId[r]=586;break;case"ATOM_BIOMETRIC_PROPERTIES_COLLECTED":case 587:t.pullAtomId[r]=587;break;case"ATOM_KERNEL_WAKEUP_ATTRIBUTED":case 588:t.pullAtomId[r]=588;break;case"ATOM_SCREEN_STATE_CHANGED_V2":case 589:t.pullAtomId[r]=589;break;case"ATOM_WS_BACKUP_ACTION_REPORTED":case 590:t.pullAtomId[r]=590;break;case"ATOM_WS_RESTORE_ACTION_REPORTED":case 591:t.pullAtomId[r]=591;break;case"ATOM_DEVICE_LOG_ACCESS_EVENT_REPORTED":case 592:t.pullAtomId[r]=592;break;case"ATOM_MEDIA_SESSION_UPDATED":case 594:t.pullAtomId[r]=594;break;case"ATOM_WEAR_OOBE_STATE_CHANGED":case 595:t.pullAtomId[r]=595;break;case"ATOM_WS_NOTIFICATION_UPDATED":case 596:t.pullAtomId[r]=596;break;case"ATOM_NETWORK_VALIDATION_FAILURE_STATS_DAILY_REPORTED":case 601:t.pullAtomId[r]=601;break;case"ATOM_WS_COMPLICATION_TAPPED":case 602:t.pullAtomId[r]=602;break;case"ATOM_WS_WEAR_TIME_SESSION":case 610:t.pullAtomId[r]=610;break;case"ATOM_WIFI_BYTES_TRANSFER":case 1e4:t.pullAtomId[r]=1e4;break;case"ATOM_WIFI_BYTES_TRANSFER_BY_FG_BG":case 10001:t.pullAtomId[r]=10001;break;case"ATOM_MOBILE_BYTES_TRANSFER":case 10002:t.pullAtomId[r]=10002;break;case"ATOM_MOBILE_BYTES_TRANSFER_BY_FG_BG":case 10003:t.pullAtomId[r]=10003;break;case"ATOM_BLUETOOTH_BYTES_TRANSFER":case 10006:t.pullAtomId[r]=10006;break;case"ATOM_KERNEL_WAKELOCK":case 10004:t.pullAtomId[r]=10004;break;case"ATOM_SUBSYSTEM_SLEEP_STATE":case 10005:t.pullAtomId[r]=10005;break;case"ATOM_CPU_TIME_PER_UID":case 10009:t.pullAtomId[r]=10009;break;case"ATOM_CPU_TIME_PER_UID_FREQ":case 10010:t.pullAtomId[r]=10010;break;case"ATOM_WIFI_ACTIVITY_INFO":case 10011:t.pullAtomId[r]=10011;break;case"ATOM_MODEM_ACTIVITY_INFO":case 10012:t.pullAtomId[r]=10012;break;case"ATOM_BLUETOOTH_ACTIVITY_INFO":case 10007:t.pullAtomId[r]=10007;break;case"ATOM_PROCESS_MEMORY_STATE":case 10013:t.pullAtomId[r]=10013;break;case"ATOM_SYSTEM_ELAPSED_REALTIME":case 10014:t.pullAtomId[r]=10014;break;case"ATOM_SYSTEM_UPTIME":case 10015:t.pullAtomId[r]=10015;break;case"ATOM_CPU_ACTIVE_TIME":case 10016:t.pullAtomId[r]=10016;break;case"ATOM_CPU_CLUSTER_TIME":case 10017:t.pullAtomId[r]=10017;break;case"ATOM_DISK_SPACE":case 10018:t.pullAtomId[r]=10018;break;case"ATOM_REMAINING_BATTERY_CAPACITY":case 10019:t.pullAtomId[r]=10019;break;case"ATOM_FULL_BATTERY_CAPACITY":case 10020:t.pullAtomId[r]=10020;break;case"ATOM_TEMPERATURE":case 10021:t.pullAtomId[r]=10021;break;case"ATOM_BINDER_CALLS":case 10022:t.pullAtomId[r]=10022;break;case"ATOM_BINDER_CALLS_EXCEPTIONS":case 10023:t.pullAtomId[r]=10023;break;case"ATOM_LOOPER_STATS":case 10024:t.pullAtomId[r]=10024;break;case"ATOM_DISK_STATS":case 10025:t.pullAtomId[r]=10025;break;case"ATOM_DIRECTORY_USAGE":case 10026:t.pullAtomId[r]=10026;break;case"ATOM_APP_SIZE":case 10027:t.pullAtomId[r]=10027;break;case"ATOM_CATEGORY_SIZE":case 10028:t.pullAtomId[r]=10028;break;case"ATOM_PROC_STATS":case 10029:t.pullAtomId[r]=10029;break;case"ATOM_BATTERY_VOLTAGE":case 10030:t.pullAtomId[r]=10030;break;case"ATOM_NUM_FINGERPRINTS_ENROLLED":case 10031:t.pullAtomId[r]=10031;break;case"ATOM_DISK_IO":case 10032:t.pullAtomId[r]=10032;break;case"ATOM_POWER_PROFILE":case 10033:t.pullAtomId[r]=10033;break;case"ATOM_PROC_STATS_PKG_PROC":case 10034:t.pullAtomId[r]=10034;break;case"ATOM_PROCESS_CPU_TIME":case 10035:t.pullAtomId[r]=10035;break;case"ATOM_CPU_TIME_PER_THREAD_FREQ":case 10037:t.pullAtomId[r]=10037;break;case"ATOM_ON_DEVICE_POWER_MEASUREMENT":case 10038:t.pullAtomId[r]=10038;break;case"ATOM_DEVICE_CALCULATED_POWER_USE":case 10039:t.pullAtomId[r]=10039;break;case"ATOM_PROCESS_MEMORY_HIGH_WATER_MARK":case 10042:t.pullAtomId[r]=10042;break;case"ATOM_BATTERY_LEVEL":case 10043:t.pullAtomId[r]=10043;break;case"ATOM_BUILD_INFORMATION":case 10044:t.pullAtomId[r]=10044;break;case"ATOM_BATTERY_CYCLE_COUNT":case 10045:t.pullAtomId[r]=10045;break;case"ATOM_DEBUG_ELAPSED_CLOCK":case 10046:t.pullAtomId[r]=10046;break;case"ATOM_DEBUG_FAILING_ELAPSED_CLOCK":case 10047:t.pullAtomId[r]=10047;break;case"ATOM_NUM_FACES_ENROLLED":case 10048:t.pullAtomId[r]=10048;break;case"ATOM_ROLE_HOLDER":case 10049:t.pullAtomId[r]=10049;break;case"ATOM_DANGEROUS_PERMISSION_STATE":case 10050:t.pullAtomId[r]=10050;break;case"ATOM_TRAIN_INFO":case 10051:t.pullAtomId[r]=10051;break;case"ATOM_TIME_ZONE_DATA_INFO":case 10052:t.pullAtomId[r]=10052;break;case"ATOM_EXTERNAL_STORAGE_INFO":case 10053:t.pullAtomId[r]=10053;break;case"ATOM_GPU_STATS_GLOBAL_INFO":case 10054:t.pullAtomId[r]=10054;break;case"ATOM_GPU_STATS_APP_INFO":case 10055:t.pullAtomId[r]=10055;break;case"ATOM_SYSTEM_ION_HEAP_SIZE":case 10056:t.pullAtomId[r]=10056;break;case"ATOM_APPS_ON_EXTERNAL_STORAGE_INFO":case 10057:t.pullAtomId[r]=10057;break;case"ATOM_FACE_SETTINGS":case 10058:t.pullAtomId[r]=10058;break;case"ATOM_COOLING_DEVICE":case 10059:t.pullAtomId[r]=10059;break;case"ATOM_APP_OPS":case 10060:t.pullAtomId[r]=10060;break;case"ATOM_PROCESS_SYSTEM_ION_HEAP_SIZE":case 10061:t.pullAtomId[r]=10061;break;case"ATOM_SURFACEFLINGER_STATS_GLOBAL_INFO":case 10062:t.pullAtomId[r]=10062;break;case"ATOM_SURFACEFLINGER_STATS_LAYER_INFO":case 10063:t.pullAtomId[r]=10063;break;case"ATOM_PROCESS_MEMORY_SNAPSHOT":case 10064:t.pullAtomId[r]=10064;break;case"ATOM_VMS_CLIENT_STATS":case 10065:t.pullAtomId[r]=10065;break;case"ATOM_NOTIFICATION_REMOTE_VIEWS":case 10066:t.pullAtomId[r]=10066;break;case"ATOM_DANGEROUS_PERMISSION_STATE_SAMPLED":case 10067:t.pullAtomId[r]=10067;break;case"ATOM_GRAPHICS_STATS":case 10068:t.pullAtomId[r]=10068;break;case"ATOM_RUNTIME_APP_OP_ACCESS":case 10069:t.pullAtomId[r]=10069;break;case"ATOM_ION_HEAP_SIZE":case 10070:t.pullAtomId[r]=10070;break;case"ATOM_PACKAGE_NOTIFICATION_PREFERENCES":case 10071:t.pullAtomId[r]=10071;break;case"ATOM_PACKAGE_NOTIFICATION_CHANNEL_PREFERENCES":case 10072:t.pullAtomId[r]=10072;break;case"ATOM_PACKAGE_NOTIFICATION_CHANNEL_GROUP_PREFERENCES":case 10073:t.pullAtomId[r]=10073;break;case"ATOM_GNSS_STATS":case 10074:t.pullAtomId[r]=10074;break;case"ATOM_ATTRIBUTED_APP_OPS":case 10075:t.pullAtomId[r]=10075;break;case"ATOM_VOICE_CALL_SESSION":case 10076:t.pullAtomId[r]=10076;break;case"ATOM_VOICE_CALL_RAT_USAGE":case 10077:t.pullAtomId[r]=10077;break;case"ATOM_SIM_SLOT_STATE":case 10078:t.pullAtomId[r]=10078;break;case"ATOM_SUPPORTED_RADIO_ACCESS_FAMILY":case 10079:t.pullAtomId[r]=10079;break;case"ATOM_SETTING_SNAPSHOT":case 10080:t.pullAtomId[r]=10080;break;case"ATOM_BLOB_INFO":case 10081:t.pullAtomId[r]=10081;break;case"ATOM_DATA_USAGE_BYTES_TRANSFER":case 10082:t.pullAtomId[r]=10082;break;case"ATOM_BYTES_TRANSFER_BY_TAG_AND_METERED":case 10083:t.pullAtomId[r]=10083;break;case"ATOM_DND_MODE_RULE":case 10084:t.pullAtomId[r]=10084;break;case"ATOM_GENERAL_EXTERNAL_STORAGE_ACCESS_STATS":case 10085:t.pullAtomId[r]=10085;break;case"ATOM_INCOMING_SMS":case 10086:t.pullAtomId[r]=10086;break;case"ATOM_OUTGOING_SMS":case 10087:t.pullAtomId[r]=10087;break;case"ATOM_CARRIER_ID_TABLE_VERSION":case 10088:t.pullAtomId[r]=10088;break;case"ATOM_DATA_CALL_SESSION":case 10089:t.pullAtomId[r]=10089;break;case"ATOM_CELLULAR_SERVICE_STATE":case 10090:t.pullAtomId[r]=10090;break;case"ATOM_CELLULAR_DATA_SERVICE_SWITCH":case 10091:t.pullAtomId[r]=10091;break;case"ATOM_SYSTEM_MEMORY":case 10092:t.pullAtomId[r]=10092;break;case"ATOM_IMS_REGISTRATION_TERMINATION":case 10093:t.pullAtomId[r]=10093;break;case"ATOM_IMS_REGISTRATION_STATS":case 10094:t.pullAtomId[r]=10094;break;case"ATOM_CPU_TIME_PER_CLUSTER_FREQ":case 10095:t.pullAtomId[r]=10095;break;case"ATOM_CPU_CYCLES_PER_UID_CLUSTER":case 10096:t.pullAtomId[r]=10096;break;case"ATOM_DEVICE_ROTATED_DATA":case 10097:t.pullAtomId[r]=10097;break;case"ATOM_CPU_CYCLES_PER_THREAD_GROUP_CLUSTER":case 10098:t.pullAtomId[r]=10098;break;case"ATOM_MEDIA_DRM_ACTIVITY_INFO":case 10099:t.pullAtomId[r]=10099;break;case"ATOM_OEM_MANAGED_BYTES_TRANSFER":case 10100:t.pullAtomId[r]=10100;break;case"ATOM_GNSS_POWER_STATS":case 10101:t.pullAtomId[r]=10101;break;case"ATOM_TIME_ZONE_DETECTOR_STATE":case 10102:t.pullAtomId[r]=10102;break;case"ATOM_KEYSTORE2_STORAGE_STATS":case 10103:t.pullAtomId[r]=10103;break;case"ATOM_RKP_POOL_STATS":case 10104:t.pullAtomId[r]=10104;break;case"ATOM_PROCESS_DMABUF_MEMORY":case 10105:t.pullAtomId[r]=10105;break;case"ATOM_PENDING_ALARM_INFO":case 10106:t.pullAtomId[r]=10106;break;case"ATOM_USER_LEVEL_HIBERNATED_APPS":case 10107:t.pullAtomId[r]=10107;break;case"ATOM_LAUNCHER_LAYOUT_SNAPSHOT":case 10108:t.pullAtomId[r]=10108;break;case"ATOM_GLOBAL_HIBERNATED_APPS":case 10109:t.pullAtomId[r]=10109;break;case"ATOM_INPUT_EVENT_LATENCY_SKETCH":case 10110:t.pullAtomId[r]=10110;break;case"ATOM_BATTERY_USAGE_STATS_BEFORE_RESET":case 10111:t.pullAtomId[r]=10111;break;case"ATOM_BATTERY_USAGE_STATS_SINCE_RESET":case 10112:t.pullAtomId[r]=10112;break;case"ATOM_BATTERY_USAGE_STATS_SINCE_RESET_USING_POWER_PROFILE_MODEL":case 10113:t.pullAtomId[r]=10113;break;case"ATOM_INSTALLED_INCREMENTAL_PACKAGE":case 10114:t.pullAtomId[r]=10114;break;case"ATOM_TELEPHONY_NETWORK_REQUESTS":case 10115:t.pullAtomId[r]=10115;break;case"ATOM_APP_SEARCH_STORAGE_INFO":case 10116:t.pullAtomId[r]=10116;break;case"ATOM_VMSTAT":case 10117:t.pullAtomId[r]=10117;break;case"ATOM_KEYSTORE2_KEY_CREATION_WITH_GENERAL_INFO":case 10118:t.pullAtomId[r]=10118;break;case"ATOM_KEYSTORE2_KEY_CREATION_WITH_AUTH_INFO":case 10119:t.pullAtomId[r]=10119;break;case"ATOM_KEYSTORE2_KEY_CREATION_WITH_PURPOSE_AND_MODES_INFO":case 10120:t.pullAtomId[r]=10120;break;case"ATOM_KEYSTORE2_ATOM_WITH_OVERFLOW":case 10121:t.pullAtomId[r]=10121;break;case"ATOM_KEYSTORE2_KEY_OPERATION_WITH_PURPOSE_AND_MODES_INFO":case 10122:t.pullAtomId[r]=10122;break;case"ATOM_KEYSTORE2_KEY_OPERATION_WITH_GENERAL_INFO":case 10123:t.pullAtomId[r]=10123;break;case"ATOM_RKP_ERROR_STATS":case 10124:t.pullAtomId[r]=10124;break;case"ATOM_KEYSTORE2_CRASH_STATS":case 10125:t.pullAtomId[r]=10125;break;case"ATOM_VENDOR_APEX_INFO":case 10126:t.pullAtomId[r]=10126;break;case"ATOM_ACCESSIBILITY_SHORTCUT_STATS":case 10127:t.pullAtomId[r]=10127;break;case"ATOM_ACCESSIBILITY_FLOATING_MENU_STATS":case 10128:t.pullAtomId[r]=10128;break;case"ATOM_DATA_USAGE_BYTES_TRANSFER_V2":case 10129:t.pullAtomId[r]=10129;break;case"ATOM_MEDIA_CAPABILITIES":case 10130:t.pullAtomId[r]=10130;break;case"ATOM_CAR_WATCHDOG_SYSTEM_IO_USAGE_SUMMARY":case 10131:t.pullAtomId[r]=10131;break;case"ATOM_CAR_WATCHDOG_UID_IO_USAGE_SUMMARY":case 10132:t.pullAtomId[r]=10132;break;case"ATOM_IMS_REGISTRATION_FEATURE_TAG_STATS":case 10133:t.pullAtomId[r]=10133;break;case"ATOM_RCS_CLIENT_PROVISIONING_STATS":case 10134:t.pullAtomId[r]=10134;break;case"ATOM_RCS_ACS_PROVISIONING_STATS":case 10135:t.pullAtomId[r]=10135;break;case"ATOM_SIP_DELEGATE_STATS":case 10136:t.pullAtomId[r]=10136;break;case"ATOM_SIP_TRANSPORT_FEATURE_TAG_STATS":case 10137:t.pullAtomId[r]=10137;break;case"ATOM_SIP_MESSAGE_RESPONSE":case 10138:t.pullAtomId[r]=10138;break;case"ATOM_SIP_TRANSPORT_SESSION":case 10139:t.pullAtomId[r]=10139;break;case"ATOM_IMS_DEDICATED_BEARER_LISTENER_EVENT":case 10140:t.pullAtomId[r]=10140;break;case"ATOM_IMS_DEDICATED_BEARER_EVENT":case 10141:t.pullAtomId[r]=10141;break;case"ATOM_IMS_REGISTRATION_SERVICE_DESC_STATS":case 10142:t.pullAtomId[r]=10142;break;case"ATOM_UCE_EVENT_STATS":case 10143:t.pullAtomId[r]=10143;break;case"ATOM_PRESENCE_NOTIFY_EVENT":case 10144:t.pullAtomId[r]=10144;break;case"ATOM_GBA_EVENT":case 10145:t.pullAtomId[r]=10145;break;case"ATOM_PER_SIM_STATUS":case 10146:t.pullAtomId[r]=10146;break;case"ATOM_GPU_WORK_PER_UID":case 10147:t.pullAtomId[r]=10147;break;case"ATOM_PERSISTENT_URI_PERMISSIONS_AMOUNT_PER_PACKAGE":case 10148:t.pullAtomId[r]=10148;break;case"ATOM_SIGNED_PARTITION_INFO":case 10149:t.pullAtomId[r]=10149;break;case"ATOM_PINNED_FILE_SIZES_PER_PACKAGE":case 10150:t.pullAtomId[r]=10150;break;case"ATOM_PENDING_INTENTS_PER_PACKAGE":case 10151:t.pullAtomId[r]=10151;break;case"ATOM_USER_INFO":case 10152:t.pullAtomId[r]=10152;break;case"ATOM_TELEPHONY_NETWORK_REQUESTS_V2":case 10153:t.pullAtomId[r]=10153;break;case"ATOM_DEVICE_TELEPHONY_PROPERTIES":case 10154:t.pullAtomId[r]=10154;break;case"ATOM_REMOTE_KEY_PROVISIONING_ERROR_COUNTS":case 10155:t.pullAtomId[r]=10155;break;case"ATOM_SAFETY_STATE":case 10156:t.pullAtomId[r]=10156;break;case"ATOM_INCOMING_MMS":case 10157:t.pullAtomId[r]=10157;break;case"ATOM_OUTGOING_MMS":case 10158:t.pullAtomId[r]=10158;break;case"ATOM_MULTI_USER_INFO":case 10160:t.pullAtomId[r]=10160;break;case"ATOM_NETWORK_BPF_MAP_INFO":case 10161:t.pullAtomId[r]=10161;break;case"ATOM_OUTGOING_SHORT_CODE_SMS":case 10162:t.pullAtomId[r]=10162;break;case"ATOM_CONNECTIVITY_STATE_SAMPLE":case 10163:t.pullAtomId[r]=10163;break;case"ATOM_NETWORK_SELECTION_REMATCH_REASONS_INFO":case 10164:t.pullAtomId[r]=10164;break;case"ATOM_GAME_MODE_INFO":case 10165:t.pullAtomId[r]=10165;break;case"ATOM_GAME_MODE_CONFIGURATION":case 10166:t.pullAtomId[r]=10166;break;case"ATOM_GAME_MODE_LISTENER":case 10167:t.pullAtomId[r]=10167;break;case"ATOM_NETWORK_SLICE_REQUEST_COUNT":case 10168:t.pullAtomId[r]=10168;break;case"ATOM_WS_TILE_SNAPSHOT":case 10169:t.pullAtomId[r]=10169;break;case"ATOM_WS_ACTIVE_WATCH_FACE_COMPLICATION_SET_SNAPSHOT":case 10170:t.pullAtomId[r]=10170;break;case"ATOM_PROCESS_STATE":case 10171:t.pullAtomId[r]=10171;break;case"ATOM_PROCESS_ASSOCIATION":case 10172:t.pullAtomId[r]=10172;break;case"ATOM_ADPF_SYSTEM_COMPONENT_INFO":case 10173:t.pullAtomId[r]=10173;break;case"ATOM_NOTIFICATION_MEMORY_USE":case 10174:t.pullAtomId[r]=10174;break;case"ATOM_HDR_CAPABILITIES":case 10175:t.pullAtomId[r]=10175;break;case"ATOM_WS_FAVOURITE_WATCH_FACE_LIST_SNAPSHOT":case 10176:t.pullAtomId[r]=10176;break;case"ATOM_WIFI_AWARE_NDP_REPORTED":case 638:t.pullAtomId[r]=638;break;case"ATOM_WIFI_AWARE_ATTACH_REPORTED":case 639:t.pullAtomId[r]=639;break;case"ATOM_WIFI_SELF_RECOVERY_TRIGGERED":case 661:t.pullAtomId[r]=661;break;case"ATOM_SOFT_AP_STARTED":case 680:t.pullAtomId[r]=680;break;case"ATOM_SOFT_AP_STOPPED":case 681:t.pullAtomId[r]=681;break;case"ATOM_WIFI_LOCK_RELEASED":case 687:t.pullAtomId[r]=687;break;case"ATOM_WIFI_LOCK_DEACTIVATED":case 688:t.pullAtomId[r]=688;break;case"ATOM_WIFI_CONFIG_SAVED":case 689:t.pullAtomId[r]=689;break;case"ATOM_WIFI_AWARE_RESOURCE_USING_CHANGED":case 690:t.pullAtomId[r]=690;break;case"ATOM_WIFI_AWARE_HAL_API_CALLED":case 691:t.pullAtomId[r]=691;break;case"ATOM_WIFI_LOCAL_ONLY_REQUEST_RECEIVED":case 692:t.pullAtomId[r]=692;break;case"ATOM_WIFI_LOCAL_ONLY_REQUEST_SCAN_TRIGGERED":case 693:t.pullAtomId[r]=693;break;case"ATOM_WIFI_THREAD_TASK_EXECUTED":case 694:t.pullAtomId[r]=694;break;case"ATOM_WIFI_STATE_CHANGED":case 700:t.pullAtomId[r]=700;break;case"ATOM_WIFI_AWARE_CAPABILITIES":case 10190:t.pullAtomId[r]=10190;break;case"ATOM_WIFI_MODULE_INFO":case 10193:t.pullAtomId[r]=10193;break;case"ATOM_SETTINGS_SPA_REPORTED":case 622:t.pullAtomId[r]=622;break;case"ATOM_EXPRESS_EVENT_REPORTED":case 528:t.pullAtomId[r]=528;break;case"ATOM_EXPRESS_HISTOGRAM_SAMPLE_REPORTED":case 593:t.pullAtomId[r]=593;break;case"ATOM_EXPRESS_UID_EVENT_REPORTED":case 644:t.pullAtomId[r]=644;break;case"ATOM_EXPRESS_UID_HISTOGRAM_SAMPLE_REPORTED":case 658:t.pullAtomId[r]=658;break;case"ATOM_PERMISSION_RATIONALE_DIALOG_VIEWED":case 645:t.pullAtomId[r]=645;break;case"ATOM_PERMISSION_RATIONALE_DIALOG_ACTION_REPORTED":case 646:t.pullAtomId[r]=646;break;case"ATOM_APP_DATA_SHARING_UPDATES_NOTIFICATION_INTERACTION":case 647:t.pullAtomId[r]=647;break;case"ATOM_APP_DATA_SHARING_UPDATES_FRAGMENT_VIEWED":case 648:t.pullAtomId[r]=648;break;case"ATOM_APP_DATA_SHARING_UPDATES_FRAGMENT_ACTION_REPORTED":case 649:t.pullAtomId[r]=649;break;case"ATOM_WS_INCOMING_CALL_ACTION_REPORTED":case 626:t.pullAtomId[r]=626;break;case"ATOM_WS_CALL_DISCONNECTION_REPORTED":case 627:t.pullAtomId[r]=627;break;case"ATOM_WS_CALL_DURATION_REPORTED":case 628:t.pullAtomId[r]=628;break;case"ATOM_WS_CALL_USER_EXPERIENCE_LATENCY_REPORTED":case 629:t.pullAtomId[r]=629;break;case"ATOM_WS_CALL_INTERACTION_REPORTED":case 630:t.pullAtomId[r]=630;break;case"ATOM_FULL_SCREEN_INTENT_LAUNCHED":case 631:t.pullAtomId[r]=631;break;case"ATOM_BAL_ALLOWED":case 632:t.pullAtomId[r]=632;break;case"ATOM_IN_TASK_ACTIVITY_STARTED":case 685:t.pullAtomId[r]=685;break;case"ATOM_CACHED_APPS_HIGH_WATERMARK":case 10189:t.pullAtomId[r]=10189;break;case"ATOM_ODREFRESH_REPORTED":case 366:t.pullAtomId[r]=366;break;case"ATOM_ODSIGN_REPORTED":case 548:t.pullAtomId[r]=548;break;case"ATOM_ART_DATUM_REPORTED":case 332:t.pullAtomId[r]=332;break;case"ATOM_ART_DEVICE_DATUM_REPORTED":case 550:t.pullAtomId[r]=550;break;case"ATOM_ART_DATUM_DELTA_REPORTED":case 565:t.pullAtomId[r]=565;break;case"ATOM_BACKGROUND_DEXOPT_JOB_ENDED":case 467:t.pullAtomId[r]=467;break;case"ATOM_WEAR_ADAPTIVE_SUSPEND_STATS_REPORTED":case 619:t.pullAtomId[r]=619;break;case"ATOM_WEAR_POWER_ANOMALY_SERVICE_OPERATIONAL_STATS_REPORTED":case 620:t.pullAtomId[r]=620;break;case"ATOM_WEAR_POWER_ANOMALY_SERVICE_EVENT_STATS_REPORTED":case 621:t.pullAtomId[r]=621;break;case"ATOM_EMERGENCY_STATE_CHANGED":case 633:t.pullAtomId[r]=633;break;case"ATOM_DND_STATE_CHANGED":case 657:t.pullAtomId[r]=657;break;case"ATOM_MTE_STATE":case 10181:t.pullAtomId[r]=10181;break;case"ATOM_AD_SERVICES_BACK_COMPAT_GET_TOPICS_REPORTED":case 598:t.pullAtomId[r]=598;break;case"ATOM_AD_SERVICES_BACK_COMPAT_EPOCH_COMPUTATION_CLASSIFIER_REPORTED":case 599:t.pullAtomId[r]=599;break;case"ATOM_AD_SERVICES_MEASUREMENT_DEBUG_KEYS":case 640:t.pullAtomId[r]=640;break;case"ATOM_AD_SERVICES_ERROR_REPORTED":case 662:t.pullAtomId[r]=662;break;case"ATOM_AD_SERVICES_BACKGROUND_JOBS_EXECUTION_REPORTED":case 663:t.pullAtomId[r]=663;break;case"ATOM_AD_SERVICES_MEASUREMENT_DELAYED_SOURCE_REGISTRATION":case 673:t.pullAtomId[r]=673;break;case"ATOM_AD_SERVICES_MEASUREMENT_ATTRIBUTION":case 674:t.pullAtomId[r]=674;break;case"ATOM_AD_SERVICES_MEASUREMENT_JOBS":case 675:t.pullAtomId[r]=675;break;case"ATOM_AD_SERVICES_MEASUREMENT_WIPEOUT":case 676:t.pullAtomId[r]=676;break;case"ATOM_AD_SERVICES_CONSENT_MIGRATED":case 702:t.pullAtomId[r]=702;break;case"ATOM_RKPD_POOL_STATS":case 664:t.pullAtomId[r]=664;break;case"ATOM_RKPD_CLIENT_OPERATION":case 665:t.pullAtomId[r]=665;break;case"ATOM_AUTOFILL_UI_EVENT_REPORTED":case 603:t.pullAtomId[r]=603;break;case"ATOM_AUTOFILL_FILL_REQUEST_REPORTED":case 604:t.pullAtomId[r]=604;break;case"ATOM_AUTOFILL_FILL_RESPONSE_REPORTED":case 605:t.pullAtomId[r]=605;break;case"ATOM_AUTOFILL_SAVE_EVENT_REPORTED":case 606:t.pullAtomId[r]=606;break;case"ATOM_AUTOFILL_SESSION_COMMITTED":case 607:t.pullAtomId[r]=607;break;case"ATOM_AUTOFILL_FIELD_CLASSIFICATION_EVENT_REPORTED":case 659:t.pullAtomId[r]=659;break;case"ATOM_TEST_EXTENSION_ATOM_REPORTED":case 660:t.pullAtomId[r]=660;break;case"ATOM_TEST_RESTRICTED_ATOM_REPORTED":case 672:t.pullAtomId[r]=672;break;case"ATOM_STATS_SOCKET_LOSS_REPORTED":case 752:t.pullAtomId[r]=752;break;case"ATOM_PLUGIN_INITIALIZED":case 655:t.pullAtomId[r]=655;break;case"ATOM_TV_LOW_POWER_STANDBY_POLICY":case 679:t.pullAtomId[r]=679;break;case"ATOM_LOCKSCREEN_SHORTCUT_SELECTED":case 611:t.pullAtomId[r]=611;break;case"ATOM_LOCKSCREEN_SHORTCUT_TRIGGERED":case 612:t.pullAtomId[r]=612;break;case"ATOM_EMERGENCY_NUMBERS_INFO":case 10180:t.pullAtomId[r]=10180;break;case"ATOM_QUALIFIED_RAT_LIST_CHANGED":case 634:t.pullAtomId[r]=634;break;case"ATOM_QNS_IMS_CALL_DROP_STATS":case 635:t.pullAtomId[r]=635;break;case"ATOM_QNS_FALLBACK_RESTRICTION_CHANGED":case 636:t.pullAtomId[r]=636;break;case"ATOM_QNS_RAT_PREFERENCE_MISMATCH_INFO":case 10177:t.pullAtomId[r]=10177;break;case"ATOM_QNS_HANDOVER_TIME_MILLIS":case 10178:t.pullAtomId[r]=10178;break;case"ATOM_QNS_HANDOVER_PINGPONG":case 10179:t.pullAtomId[r]=10179;break;case"ATOM_SATELLITE_CONTROLLER":case 10182:t.pullAtomId[r]=10182;break;case"ATOM_SATELLITE_SESSION":case 10183:t.pullAtomId[r]=10183;break;case"ATOM_SATELLITE_INCOMING_DATAGRAM":case 10184:t.pullAtomId[r]=10184;break;case"ATOM_SATELLITE_OUTGOING_DATAGRAM":case 10185:t.pullAtomId[r]=10185;break;case"ATOM_SATELLITE_PROVISION":case 10186:t.pullAtomId[r]=10186;break;case"ATOM_SATELLITE_SOS_MESSAGE_RECOMMENDER":case 10187:t.pullAtomId[r]=10187;break;case"ATOM_IKE_SESSION_TERMINATED":case 678:t.pullAtomId[r]=678;break;case"ATOM_IKE_LIVENESS_CHECK_SESSION_VALIDATED":case 760:t.pullAtomId[r]=760;break;case"ATOM_BLUETOOTH_HASHED_DEVICE_NAME_REPORTED":case 613:t.pullAtomId[r]=613;break;case"ATOM_BLUETOOTH_L2CAP_COC_CLIENT_CONNECTION":case 614:t.pullAtomId[r]=614;break;case"ATOM_BLUETOOTH_L2CAP_COC_SERVER_CONNECTION":case 615:t.pullAtomId[r]=615;break;case"ATOM_BLUETOOTH_LE_SESSION_CONNECTED":case 656:t.pullAtomId[r]=656;break;case"ATOM_RESTRICTED_BLUETOOTH_DEVICE_NAME_REPORTED":case 666:t.pullAtomId[r]=666;break;case"ATOM_BLUETOOTH_PROFILE_CONNECTION_ATTEMPTED":case 696:t.pullAtomId[r]=696;break;case"ATOM_HEALTH_CONNECT_UI_IMPRESSION":case 623:t.pullAtomId[r]=623;break;case"ATOM_HEALTH_CONNECT_UI_INTERACTION":case 624:t.pullAtomId[r]=624;break;case"ATOM_HEALTH_CONNECT_APP_OPENED_REPORTED":case 625:t.pullAtomId[r]=625;break;case"ATOM_HEALTH_CONNECT_API_CALLED":case 616:t.pullAtomId[r]=616;break;case"ATOM_HEALTH_CONNECT_USAGE_STATS":case 617:t.pullAtomId[r]=617;break;case"ATOM_HEALTH_CONNECT_STORAGE_STATS":case 618:t.pullAtomId[r]=618;break;case"ATOM_HEALTH_CONNECT_API_INVOKED":case 643:t.pullAtomId[r]=643;break;case"ATOM_EXERCISE_ROUTE_API_CALLED":case 654:t.pullAtomId[r]=654;break;case"ATOM_ATOM_9999":case 9999:t.pullAtomId[r]=9999;break;case"ATOM_ATOM_99999":case 99999:t.pullAtomId[r]=99999;break;case"ATOM_THREADNETWORK_TELEMETRY_DATA_REPORTED":case 738:t.pullAtomId[r]=738;break;case"ATOM_THREADNETWORK_TOPO_ENTRY_REPEATED":case 739:t.pullAtomId[r]=739;break;case"ATOM_THREADNETWORK_DEVICE_INFO_REPORTED":case 740:t.pullAtomId[r]=740;break;case"ATOM_EMERGENCY_NUMBER_DIALED":case 637:t.pullAtomId[r]=637;break;case"ATOM_SANDBOX_API_CALLED":case 488:t.pullAtomId[r]=488;break;case"ATOM_SANDBOX_ACTIVITY_EVENT_OCCURRED":case 735:t.pullAtomId[r]=735;break;case"ATOM_SANDBOX_SDK_STORAGE":case 10159:t.pullAtomId[r]=10159;break;case"ATOM_CRONET_ENGINE_CREATED":case 703:t.pullAtomId[r]=703;break;case"ATOM_CRONET_TRAFFIC_REPORTED":case 704:t.pullAtomId[r]=704;break;case"ATOM_CRONET_ENGINE_BUILDER_INITIALIZED":case 762:t.pullAtomId[r]=762;break;case"ATOM_CRONET_HTTP_FLAGS_INITIALIZED":case 763:t.pullAtomId[r]=763;break;case"ATOM_CRONET_INITIALIZED":case 764:t.pullAtomId[r]=764;break;case"ATOM_DAILY_KEEPALIVE_INFO_REPORTED":case 650:t.pullAtomId[r]=650;break;case"ATOM_IP_CLIENT_RA_INFO_REPORTED":case 778:t.pullAtomId[r]=778;break;case"ATOM_APF_SESSION_INFO_REPORTED":case 777:t.pullAtomId[r]=777;break;case"ATOM_CREDENTIAL_MANAGER_API_CALLED":case 585:t.pullAtomId[r]=585;break;case"ATOM_CREDENTIAL_MANAGER_INIT_PHASE_REPORTED":case 651:t.pullAtomId[r]=651;break;case"ATOM_CREDENTIAL_MANAGER_CANDIDATE_PHASE_REPORTED":case 652:t.pullAtomId[r]=652;break;case"ATOM_CREDENTIAL_MANAGER_FINAL_PHASE_REPORTED":case 653:t.pullAtomId[r]=653;break;case"ATOM_CREDENTIAL_MANAGER_TOTAL_REPORTED":case 667:t.pullAtomId[r]=667;break;case"ATOM_CREDENTIAL_MANAGER_FINALNOUID_REPORTED":case 668:t.pullAtomId[r]=668;break;case"ATOM_CREDENTIAL_MANAGER_GET_REPORTED":case 669:t.pullAtomId[r]=669;break;case"ATOM_CREDENTIAL_MANAGER_AUTH_CLICK_REPORTED":case 670:t.pullAtomId[r]=670;break;case"ATOM_CREDENTIAL_MANAGER_APIV2_CALLED":case 671:t.pullAtomId[r]=671;break;case"ATOM_UWB_ACTIVITY_INFO":case 10188:t.pullAtomId[r]=10188;break;case"ATOM_MEDIA_ACTION_REPORTED":case 608:t.pullAtomId[r]=608;break;case"ATOM_MEDIA_CONTROLS_LAUNCHED":case 609:t.pullAtomId[r]=609;break;case"ATOM_MEDIA_CODEC_RECLAIM_REQUEST_COMPLETED":case 600:t.pullAtomId[r]=600;break;case"ATOM_MEDIA_CODEC_STARTED":case 641:t.pullAtomId[r]=641;break;case"ATOM_MEDIA_CODEC_STOPPED":case 642:t.pullAtomId[r]=642;break;case"ATOM_MEDIA_CODEC_RENDERED":case 684:t.pullAtomId[r]=684}}if(e.rawPullAtomId){if(!Array.isArray(e.rawPullAtomId))throw TypeError(".perfetto.protos.StatsdPullAtomConfig.rawPullAtomId: array expected");t.rawPullAtomId=[];for(r=0;r<e.rawPullAtomId.length;++r)t.rawPullAtomId[r]=0|e.rawPullAtomId[r]}if(null!=e.pullFrequencyMs&&(t.pullFrequencyMs=0|e.pullFrequencyMs),e.packages){if(!Array.isArray(e.packages))throw TypeError(".perfetto.protos.StatsdPullAtomConfig.packages: array expected");t.packages=[];for(r=0;r<e.packages.length;++r)t.packages[r]=String(e.packages[r])}return t},yt.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.pullAtomId=[],r.rawPullAtomId=[],r.packages=[]),t.defaults&&(r.pullFrequencyMs=0),e.pullAtomId&&e.pullAtomId.length){r.pullAtomId=[];for(var n=0;n<e.pullAtomId.length;++n)r.pullAtomId[n]=t.enums!==String||void 0===s.perfetto.protos.AtomId[e.pullAtomId[n]]?e.pullAtomId[n]:s.perfetto.protos.AtomId[e.pullAtomId[n]]}if(e.rawPullAtomId&&e.rawPullAtomId.length){r.rawPullAtomId=[];for(n=0;n<e.rawPullAtomId.length;++n)r.rawPullAtomId[n]=e.rawPullAtomId[n]}if(null!=e.pullFrequencyMs&&e.hasOwnProperty("pullFrequencyMs")&&(r.pullFrequencyMs=e.pullFrequencyMs),e.packages&&e.packages.length){r.packages=[];for(n=0;n<e.packages.length;++n)r.packages[n]=e.packages[n]}return r},yt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},yt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.StatsdPullAtomConfig"},yt),r.AtomId=(t={},(e=Object.create(t))[t[0]="ATOM_UNSPECIFIED"]=0,e[t[2]="ATOM_BLE_SCAN_STATE_CHANGED"]=2,e[t[3]="ATOM_PROCESS_STATE_CHANGED"]=3,e[t[4]="ATOM_BLE_SCAN_RESULT_RECEIVED"]=4,e[t[5]="ATOM_SENSOR_STATE_CHANGED"]=5,e[t[6]="ATOM_GPS_SCAN_STATE_CHANGED"]=6,e[t[7]="ATOM_SYNC_STATE_CHANGED"]=7,e[t[8]="ATOM_SCHEDULED_JOB_STATE_CHANGED"]=8,e[t[9]="ATOM_SCREEN_BRIGHTNESS_CHANGED"]=9,e[t[10]="ATOM_WAKELOCK_STATE_CHANGED"]=10,e[t[11]="ATOM_LONG_PARTIAL_WAKELOCK_STATE_CHANGED"]=11,e[t[12]="ATOM_MOBILE_RADIO_POWER_STATE_CHANGED"]=12,e[t[13]="ATOM_WIFI_RADIO_POWER_STATE_CHANGED"]=13,e[t[14]="ATOM_ACTIVITY_MANAGER_SLEEP_STATE_CHANGED"]=14,e[t[15]="ATOM_MEMORY_FACTOR_STATE_CHANGED"]=15,e[t[16]="ATOM_EXCESSIVE_CPU_USAGE_REPORTED"]=16,e[t[17]="ATOM_CACHED_KILL_REPORTED"]=17,e[t[18]="ATOM_PROCESS_MEMORY_STAT_REPORTED"]=18,e[t[19]="ATOM_LAUNCHER_EVENT"]=19,e[t[20]="ATOM_BATTERY_SAVER_MODE_STATE_CHANGED"]=20,e[t[21]="ATOM_DEVICE_IDLE_MODE_STATE_CHANGED"]=21,e[t[22]="ATOM_DEVICE_IDLING_MODE_STATE_CHANGED"]=22,e[t[23]="ATOM_AUDIO_STATE_CHANGED"]=23,e[t[24]="ATOM_MEDIA_CODEC_STATE_CHANGED"]=24,e[t[25]="ATOM_CAMERA_STATE_CHANGED"]=25,e[t[26]="ATOM_FLASHLIGHT_STATE_CHANGED"]=26,e[t[27]="ATOM_UID_PROCESS_STATE_CHANGED"]=27,e[t[28]="ATOM_PROCESS_LIFE_CYCLE_STATE_CHANGED"]=28,e[t[29]="ATOM_SCREEN_STATE_CHANGED"]=29,e[t[30]="ATOM_BATTERY_LEVEL_CHANGED"]=30,e[t[31]="ATOM_CHARGING_STATE_CHANGED"]=31,e[t[32]="ATOM_PLUGGED_STATE_CHANGED"]=32,e[t[33]="ATOM_INTERACTIVE_STATE_CHANGED"]=33,e[t[34]="ATOM_TOUCH_EVENT_REPORTED"]=34,e[t[35]="ATOM_WAKEUP_ALARM_OCCURRED"]=35,e[t[36]="ATOM_KERNEL_WAKEUP_REPORTED"]=36,e[t[37]="ATOM_WIFI_LOCK_STATE_CHANGED"]=37,e[t[38]="ATOM_WIFI_SIGNAL_STRENGTH_CHANGED"]=38,e[t[39]="ATOM_WIFI_SCAN_STATE_CHANGED"]=39,e[t[40]="ATOM_PHONE_SIGNAL_STRENGTH_CHANGED"]=40,e[t[41]="ATOM_SETTING_CHANGED"]=41,e[t[42]="ATOM_ACTIVITY_FOREGROUND_STATE_CHANGED"]=42,e[t[43]="ATOM_ISOLATED_UID_CHANGED"]=43,e[t[44]="ATOM_PACKET_WAKEUP_OCCURRED"]=44,e[t[45]="ATOM_WALL_CLOCK_TIME_SHIFTED"]=45,e[t[46]="ATOM_ANOMALY_DETECTED"]=46,e[t[47]="ATOM_APP_BREADCRUMB_REPORTED"]=47,e[t[48]="ATOM_APP_START_OCCURRED"]=48,e[t[49]="ATOM_APP_START_CANCELED"]=49,e[t[50]="ATOM_APP_START_FULLY_DRAWN"]=50,e[t[51]="ATOM_LMK_KILL_OCCURRED"]=51,e[t[52]="ATOM_PICTURE_IN_PICTURE_STATE_CHANGED"]=52,e[t[53]="ATOM_WIFI_MULTICAST_LOCK_STATE_CHANGED"]=53,e[t[54]="ATOM_LMK_STATE_CHANGED"]=54,e[t[55]="ATOM_APP_START_MEMORY_STATE_CAPTURED"]=55,e[t[56]="ATOM_SHUTDOWN_SEQUENCE_REPORTED"]=56,e[t[57]="ATOM_BOOT_SEQUENCE_REPORTED"]=57,e[t[58]="ATOM_DAVEY_OCCURRED"]=58,e[t[59]="ATOM_OVERLAY_STATE_CHANGED"]=59,e[t[60]="ATOM_FOREGROUND_SERVICE_STATE_CHANGED"]=60,e[t[61]="ATOM_CALL_STATE_CHANGED"]=61,e[t[62]="ATOM_KEYGUARD_STATE_CHANGED"]=62,e[t[63]="ATOM_KEYGUARD_BOUNCER_STATE_CHANGED"]=63,e[t[64]="ATOM_KEYGUARD_BOUNCER_PASSWORD_ENTERED"]=64,e[t[65]="ATOM_APP_DIED"]=65,e[t[66]="ATOM_RESOURCE_CONFIGURATION_CHANGED"]=66,e[t[67]="ATOM_BLUETOOTH_ENABLED_STATE_CHANGED"]=67,e[t[68]="ATOM_BLUETOOTH_CONNECTION_STATE_CHANGED"]=68,e[t[69]="ATOM_GPS_SIGNAL_QUALITY_CHANGED"]=69,e[t[70]="ATOM_USB_CONNECTOR_STATE_CHANGED"]=70,e[t[71]="ATOM_SPEAKER_IMPEDANCE_REPORTED"]=71,e[t[72]="ATOM_HARDWARE_FAILED"]=72,e[t[73]="ATOM_PHYSICAL_DROP_DETECTED"]=73,e[t[74]="ATOM_CHARGE_CYCLES_REPORTED"]=74,e[t[75]="ATOM_MOBILE_CONNECTION_STATE_CHANGED"]=75,e[t[76]="ATOM_MOBILE_RADIO_TECHNOLOGY_CHANGED"]=76,e[t[77]="ATOM_USB_DEVICE_ATTACHED"]=77,e[t[78]="ATOM_APP_CRASH_OCCURRED"]=78,e[t[79]="ATOM_ANR_OCCURRED"]=79,e[t[80]="ATOM_WTF_OCCURRED"]=80,e[t[81]="ATOM_LOW_MEM_REPORTED"]=81,e[t[82]="ATOM_GENERIC_ATOM"]=82,e[t[84]="ATOM_VIBRATOR_STATE_CHANGED"]=84,e[t[85]="ATOM_DEFERRED_JOB_STATS_REPORTED"]=85,e[t[86]="ATOM_THERMAL_THROTTLING"]=86,e[t[87]="ATOM_BIOMETRIC_ACQUIRED"]=87,e[t[88]="ATOM_BIOMETRIC_AUTHENTICATED"]=88,e[t[89]="ATOM_BIOMETRIC_ERROR_OCCURRED"]=89,e[t[90]="ATOM_UI_EVENT_REPORTED"]=90,e[t[91]="ATOM_BATTERY_HEALTH_SNAPSHOT"]=91,e[t[92]="ATOM_SLOW_IO"]=92,e[t[93]="ATOM_BATTERY_CAUSED_SHUTDOWN"]=93,e[t[94]="ATOM_PHONE_SERVICE_STATE_CHANGED"]=94,e[t[95]="ATOM_PHONE_STATE_CHANGED"]=95,e[t[96]="ATOM_USER_RESTRICTION_CHANGED"]=96,e[t[97]="ATOM_SETTINGS_UI_CHANGED"]=97,e[t[98]="ATOM_CONNECTIVITY_STATE_CHANGED"]=98,e[t[99]="ATOM_SERVICE_STATE_CHANGED"]=99,e[t[100]="ATOM_SERVICE_LAUNCH_REPORTED"]=100,e[t[101]="ATOM_FLAG_FLIP_UPDATE_OCCURRED"]=101,e[t[102]="ATOM_BINARY_PUSH_STATE_CHANGED"]=102,e[t[103]="ATOM_DEVICE_POLICY_EVENT"]=103,e[t[104]="ATOM_DOCS_UI_FILE_OP_CANCELED"]=104,e[t[105]="ATOM_DOCS_UI_FILE_OP_COPY_MOVE_MODE_REPORTED"]=105,e[t[106]="ATOM_DOCS_UI_FILE_OP_FAILURE"]=106,e[t[107]="ATOM_DOCS_UI_PROVIDER_FILE_OP"]=107,e[t[108]="ATOM_DOCS_UI_INVALID_SCOPED_ACCESS_REQUEST"]=108,e[t[109]="ATOM_DOCS_UI_LAUNCH_REPORTED"]=109,e[t[110]="ATOM_DOCS_UI_ROOT_VISITED"]=110,e[t[111]="ATOM_DOCS_UI_STARTUP_MS"]=111,e[t[112]="ATOM_DOCS_UI_USER_ACTION_REPORTED"]=112,e[t[113]="ATOM_WIFI_ENABLED_STATE_CHANGED"]=113,e[t[114]="ATOM_WIFI_RUNNING_STATE_CHANGED"]=114,e[t[115]="ATOM_APP_COMPACTED"]=115,e[t[116]="ATOM_NETWORK_DNS_EVENT_REPORTED"]=116,e[t[117]="ATOM_DOCS_UI_PICKER_LAUNCHED_FROM_REPORTED"]=117,e[t[118]="ATOM_DOCS_UI_PICK_RESULT_REPORTED"]=118,e[t[119]="ATOM_DOCS_UI_SEARCH_MODE_REPORTED"]=119,e[t[120]="ATOM_DOCS_UI_SEARCH_TYPE_REPORTED"]=120,e[t[121]="ATOM_DATA_STALL_EVENT"]=121,e[t[122]="ATOM_RESCUE_PARTY_RESET_REPORTED"]=122,e[t[123]="ATOM_SIGNED_CONFIG_REPORTED"]=123,e[t[124]="ATOM_GNSS_NI_EVENT_REPORTED"]=124,e[t[125]="ATOM_BLUETOOTH_LINK_LAYER_CONNECTION_EVENT"]=125,e[t[126]="ATOM_BLUETOOTH_ACL_CONNECTION_STATE_CHANGED"]=126,e[t[127]="ATOM_BLUETOOTH_SCO_CONNECTION_STATE_CHANGED"]=127,e[t[128]="ATOM_APP_DOWNGRADED"]=128,e[t[129]="ATOM_APP_OPTIMIZED_AFTER_DOWNGRADED"]=129,e[t[130]="ATOM_LOW_STORAGE_STATE_CHANGED"]=130,e[t[131]="ATOM_GNSS_NFW_NOTIFICATION_REPORTED"]=131,e[t[132]="ATOM_GNSS_CONFIGURATION_REPORTED"]=132,e[t[133]="ATOM_USB_PORT_OVERHEAT_EVENT_REPORTED"]=133,e[t[134]="ATOM_NFC_ERROR_OCCURRED"]=134,e[t[135]="ATOM_NFC_STATE_CHANGED"]=135,e[t[136]="ATOM_NFC_BEAM_OCCURRED"]=136,e[t[137]="ATOM_NFC_CARDEMULATION_OCCURRED"]=137,e[t[138]="ATOM_NFC_TAG_OCCURRED"]=138,e[t[139]="ATOM_NFC_HCE_TRANSACTION_OCCURRED"]=139,e[t[140]="ATOM_SE_STATE_CHANGED"]=140,e[t[141]="ATOM_SE_OMAPI_REPORTED"]=141,e[t[142]="ATOM_BROADCAST_DISPATCH_LATENCY_REPORTED"]=142,e[t[143]="ATOM_ATTENTION_MANAGER_SERVICE_RESULT_REPORTED"]=143,e[t[144]="ATOM_ADB_CONNECTION_CHANGED"]=144,e[t[145]="ATOM_SPEECH_DSP_STAT_REPORTED"]=145,e[t[146]="ATOM_USB_CONTAMINANT_REPORTED"]=146,e[t[147]="ATOM_WATCHDOG_ROLLBACK_OCCURRED"]=147,e[t[148]="ATOM_BIOMETRIC_SYSTEM_HEALTH_ISSUE_DETECTED"]=148,e[t[149]="ATOM_BUBBLE_UI_CHANGED"]=149,e[t[150]="ATOM_SCHEDULED_JOB_CONSTRAINT_CHANGED"]=150,e[t[151]="ATOM_BLUETOOTH_ACTIVE_DEVICE_CHANGED"]=151,e[t[152]="ATOM_BLUETOOTH_A2DP_PLAYBACK_STATE_CHANGED"]=152,e[t[153]="ATOM_BLUETOOTH_A2DP_CODEC_CONFIG_CHANGED"]=153,e[t[154]="ATOM_BLUETOOTH_A2DP_CODEC_CAPABILITY_CHANGED"]=154,e[t[155]="ATOM_BLUETOOTH_A2DP_AUDIO_UNDERRUN_REPORTED"]=155,e[t[156]="ATOM_BLUETOOTH_A2DP_AUDIO_OVERRUN_REPORTED"]=156,e[t[157]="ATOM_BLUETOOTH_DEVICE_RSSI_REPORTED"]=157,e[t[158]="ATOM_BLUETOOTH_DEVICE_FAILED_CONTACT_COUNTER_REPORTED"]=158,e[t[159]="ATOM_BLUETOOTH_DEVICE_TX_POWER_LEVEL_REPORTED"]=159,e[t[160]="ATOM_BLUETOOTH_HCI_TIMEOUT_REPORTED"]=160,e[t[161]="ATOM_BLUETOOTH_QUALITY_REPORT_REPORTED"]=161,e[t[162]="ATOM_BLUETOOTH_DEVICE_INFO_REPORTED"]=162,e[t[163]="ATOM_BLUETOOTH_REMOTE_VERSION_INFO_REPORTED"]=163,e[t[164]="ATOM_BLUETOOTH_SDP_ATTRIBUTE_REPORTED"]=164,e[t[165]="ATOM_BLUETOOTH_BOND_STATE_CHANGED"]=165,e[t[166]="ATOM_BLUETOOTH_CLASSIC_PAIRING_EVENT_REPORTED"]=166,e[t[167]="ATOM_BLUETOOTH_SMP_PAIRING_EVENT_REPORTED"]=167,e[t[168]="ATOM_SCREEN_TIMEOUT_EXTENSION_REPORTED"]=168,e[t[169]="ATOM_PROCESS_START_TIME"]=169,e[t[170]="ATOM_PERMISSION_GRANT_REQUEST_RESULT_REPORTED"]=170,e[t[171]="ATOM_BLUETOOTH_SOCKET_CONNECTION_STATE_CHANGED"]=171,e[t[172]="ATOM_DEVICE_IDENTIFIER_ACCESS_DENIED"]=172,e[t[173]="ATOM_BUBBLE_DEVELOPER_ERROR_REPORTED"]=173,e[t[174]="ATOM_ASSIST_GESTURE_STAGE_REPORTED"]=174,e[t[175]="ATOM_ASSIST_GESTURE_FEEDBACK_REPORTED"]=175,e[t[176]="ATOM_ASSIST_GESTURE_PROGRESS_REPORTED"]=176,e[t[177]="ATOM_TOUCH_GESTURE_CLASSIFIED"]=177,e[t[178]="ATOM_HIDDEN_API_USED"]=178,e[t[179]="ATOM_STYLE_UI_CHANGED"]=179,e[t[180]="ATOM_PRIVACY_INDICATORS_INTERACTED"]=180,e[t[181]="ATOM_APP_INSTALL_ON_EXTERNAL_STORAGE_REPORTED"]=181,e[t[182]="ATOM_NETWORK_STACK_REPORTED"]=182,e[t[183]="ATOM_APP_MOVED_STORAGE_REPORTED"]=183,e[t[184]="ATOM_BIOMETRIC_ENROLLED"]=184,e[t[185]="ATOM_SYSTEM_SERVER_WATCHDOG_OCCURRED"]=185,e[t[186]="ATOM_TOMB_STONE_OCCURRED"]=186,e[t[187]="ATOM_BLUETOOTH_CLASS_OF_DEVICE_REPORTED"]=187,e[t[188]="ATOM_INTELLIGENCE_EVENT_REPORTED"]=188,e[t[189]="ATOM_THERMAL_THROTTLING_SEVERITY_STATE_CHANGED"]=189,e[t[190]="ATOM_ROLE_REQUEST_RESULT_REPORTED"]=190,e[t[191]="ATOM_MEDIAMETRICS_AUDIOPOLICY_REPORTED"]=191,e[t[192]="ATOM_MEDIAMETRICS_AUDIORECORD_REPORTED"]=192,e[t[193]="ATOM_MEDIAMETRICS_AUDIOTHREAD_REPORTED"]=193,e[t[194]="ATOM_MEDIAMETRICS_AUDIOTRACK_REPORTED"]=194,e[t[195]="ATOM_MEDIAMETRICS_CODEC_REPORTED"]=195,e[t[196]="ATOM_MEDIAMETRICS_DRM_WIDEVINE_REPORTED"]=196,e[t[197]="ATOM_MEDIAMETRICS_EXTRACTOR_REPORTED"]=197,e[t[198]="ATOM_MEDIAMETRICS_MEDIADRM_REPORTED"]=198,e[t[199]="ATOM_MEDIAMETRICS_NUPLAYER_REPORTED"]=199,e[t[200]="ATOM_MEDIAMETRICS_RECORDER_REPORTED"]=200,e[t[201]="ATOM_MEDIAMETRICS_DRMMANAGER_REPORTED"]=201,e[t[203]="ATOM_CAR_POWER_STATE_CHANGED"]=203,e[t[204]="ATOM_GARAGE_MODE_INFO"]=204,e[t[205]="ATOM_TEST_ATOM_REPORTED"]=205,e[t[206]="ATOM_CONTENT_CAPTURE_CALLER_MISMATCH_REPORTED"]=206,e[t[207]="ATOM_CONTENT_CAPTURE_SERVICE_EVENTS"]=207,e[t[208]="ATOM_CONTENT_CAPTURE_SESSION_EVENTS"]=208,e[t[209]="ATOM_CONTENT_CAPTURE_FLUSHED"]=209,e[t[210]="ATOM_LOCATION_MANAGER_API_USAGE_REPORTED"]=210,e[t[211]="ATOM_REVIEW_PERMISSIONS_FRAGMENT_RESULT_REPORTED"]=211,e[t[212]="ATOM_RUNTIME_PERMISSIONS_UPGRADE_RESULT"]=212,e[t[213]="ATOM_GRANT_PERMISSIONS_ACTIVITY_BUTTON_ACTIONS"]=213,e[t[214]="ATOM_LOCATION_ACCESS_CHECK_NOTIFICATION_ACTION"]=214,e[t[215]="ATOM_APP_PERMISSION_FRAGMENT_ACTION_REPORTED"]=215,e[t[216]="ATOM_APP_PERMISSION_FRAGMENT_VIEWED"]=216,e[t[217]="ATOM_APP_PERMISSIONS_FRAGMENT_VIEWED"]=217,e[t[218]="ATOM_PERMISSION_APPS_FRAGMENT_VIEWED"]=218,e[t[219]="ATOM_TEXT_SELECTION_EVENT"]=219,e[t[220]="ATOM_TEXT_LINKIFY_EVENT"]=220,e[t[221]="ATOM_CONVERSATION_ACTIONS_EVENT"]=221,e[t[222]="ATOM_LANGUAGE_DETECTION_EVENT"]=222,e[t[223]="ATOM_EXCLUSION_RECT_STATE_CHANGED"]=223,e[t[224]="ATOM_BACK_GESTURE_REPORTED_REPORTED"]=224,e[t[225]="ATOM_UPDATE_ENGINE_UPDATE_ATTEMPT_REPORTED"]=225,e[t[226]="ATOM_UPDATE_ENGINE_SUCCESSFUL_UPDATE_REPORTED"]=226,e[t[227]="ATOM_CAMERA_ACTION_EVENT"]=227,e[t[228]="ATOM_APP_COMPATIBILITY_CHANGE_REPORTED"]=228,e[t[229]="ATOM_PERFETTO_UPLOADED"]=229,e[t[230]="ATOM_VMS_CLIENT_CONNECTION_STATE_CHANGED"]=230,e[t[233]="ATOM_MEDIA_PROVIDER_SCAN_OCCURRED"]=233,e[t[234]="ATOM_MEDIA_CONTENT_DELETED"]=234,e[t[235]="ATOM_MEDIA_PROVIDER_PERMISSION_REQUESTED"]=235,e[t[236]="ATOM_MEDIA_PROVIDER_SCHEMA_CHANGED"]=236,e[t[237]="ATOM_MEDIA_PROVIDER_IDLE_MAINTENANCE_FINISHED"]=237,e[t[238]="ATOM_REBOOT_ESCROW_RECOVERY_REPORTED"]=238,e[t[239]="ATOM_BOOT_TIME_EVENT_DURATION_REPORTED"]=239,e[t[240]="ATOM_BOOT_TIME_EVENT_ELAPSED_TIME_REPORTED"]=240,e[t[241]="ATOM_BOOT_TIME_EVENT_UTC_TIME_REPORTED"]=241,e[t[242]="ATOM_BOOT_TIME_EVENT_ERROR_CODE_REPORTED"]=242,e[t[243]="ATOM_USERSPACE_REBOOT_REPORTED"]=243,e[t[244]="ATOM_NOTIFICATION_REPORTED"]=244,e[t[245]="ATOM_NOTIFICATION_PANEL_REPORTED"]=245,e[t[246]="ATOM_NOTIFICATION_CHANNEL_MODIFIED"]=246,e[t[247]="ATOM_INTEGRITY_CHECK_RESULT_REPORTED"]=247,e[t[248]="ATOM_INTEGRITY_RULES_PUSHED"]=248,e[t[249]="ATOM_CB_MESSAGE_REPORTED"]=249,e[t[250]="ATOM_CB_MESSAGE_ERROR"]=250,e[t[251]="ATOM_WIFI_HEALTH_STAT_REPORTED"]=251,e[t[252]="ATOM_WIFI_FAILURE_STAT_REPORTED"]=252,e[t[253]="ATOM_WIFI_CONNECTION_RESULT_REPORTED"]=253,e[t[254]="ATOM_APP_FREEZE_CHANGED"]=254,e[t[255]="ATOM_SNAPSHOT_MERGE_REPORTED"]=255,e[t[256]="ATOM_FOREGROUND_SERVICE_APP_OP_SESSION_ENDED"]=256,e[t[257]="ATOM_DISPLAY_JANK_REPORTED"]=257,e[t[258]="ATOM_APP_STANDBY_BUCKET_CHANGED"]=258,e[t[259]="ATOM_SHARESHEET_STARTED"]=259,e[t[260]="ATOM_RANKING_SELECTED"]=260,e[t[261]="ATOM_TVSETTINGS_UI_INTERACTED"]=261,e[t[262]="ATOM_LAUNCHER_SNAPSHOT"]=262,e[t[263]="ATOM_PACKAGE_INSTALLER_V2_REPORTED"]=263,e[t[264]="ATOM_USER_LIFECYCLE_JOURNEY_REPORTED"]=264,e[t[265]="ATOM_USER_LIFECYCLE_EVENT_OCCURRED"]=265,e[t[266]="ATOM_ACCESSIBILITY_SHORTCUT_REPORTED"]=266,e[t[267]="ATOM_ACCESSIBILITY_SERVICE_REPORTED"]=267,e[t[268]="ATOM_DOCS_UI_DRAG_AND_DROP_REPORTED"]=268,e[t[269]="ATOM_APP_USAGE_EVENT_OCCURRED"]=269,e[t[270]="ATOM_AUTO_REVOKE_NOTIFICATION_CLICKED"]=270,e[t[271]="ATOM_AUTO_REVOKE_FRAGMENT_APP_VIEWED"]=271,e[t[272]="ATOM_AUTO_REVOKED_APP_INTERACTION"]=272,e[t[273]="ATOM_APP_PERMISSION_GROUPS_FRAGMENT_AUTO_REVOKE_ACTION"]=273,e[t[274]="ATOM_EVS_USAGE_STATS_REPORTED"]=274,e[t[275]="ATOM_AUDIO_POWER_USAGE_DATA_REPORTED"]=275,e[t[276]="ATOM_TV_TUNER_STATE_CHANGED"]=276,e[t[277]="ATOM_MEDIAOUTPUT_OP_SWITCH_REPORTED"]=277,e[t[278]="ATOM_CB_MESSAGE_FILTERED"]=278,e[t[279]="ATOM_TV_TUNER_DVR_STATUS"]=279,e[t[280]="ATOM_TV_CAS_SESSION_OPEN_STATUS"]=280,e[t[281]="ATOM_ASSISTANT_INVOCATION_REPORTED"]=281,e[t[282]="ATOM_DISPLAY_WAKE_REPORTED"]=282,e[t[283]="ATOM_CAR_USER_HAL_MODIFY_USER_REQUEST_REPORTED"]=283,e[t[284]="ATOM_CAR_USER_HAL_MODIFY_USER_RESPONSE_REPORTED"]=284,e[t[285]="ATOM_CAR_USER_HAL_POST_SWITCH_RESPONSE_REPORTED"]=285,e[t[286]="ATOM_CAR_USER_HAL_INITIAL_USER_INFO_REQUEST_REPORTED"]=286,e[t[287]="ATOM_CAR_USER_HAL_INITIAL_USER_INFO_RESPONSE_REPORTED"]=287,e[t[288]="ATOM_CAR_USER_HAL_USER_ASSOCIATION_REQUEST_REPORTED"]=288,e[t[289]="ATOM_CAR_USER_HAL_SET_USER_ASSOCIATION_RESPONSE_REPORTED"]=289,e[t[290]="ATOM_NETWORK_IP_PROVISIONING_REPORTED"]=290,e[t[291]="ATOM_NETWORK_DHCP_RENEW_REPORTED"]=291,e[t[292]="ATOM_NETWORK_VALIDATION_REPORTED"]=292,e[t[293]="ATOM_NETWORK_STACK_QUIRK_REPORTED"]=293,e[t[294]="ATOM_MEDIAMETRICS_AUDIORECORDDEVICEUSAGE_REPORTED"]=294,e[t[295]="ATOM_MEDIAMETRICS_AUDIOTHREADDEVICEUSAGE_REPORTED"]=295,e[t[296]="ATOM_MEDIAMETRICS_AUDIOTRACKDEVICEUSAGE_REPORTED"]=296,e[t[297]="ATOM_MEDIAMETRICS_AUDIODEVICECONNECTION_REPORTED"]=297,e[t[298]="ATOM_BLOB_COMMITTED"]=298,e[t[299]="ATOM_BLOB_LEASED"]=299,e[t[300]="ATOM_BLOB_OPENED"]=300,e[t[301]="ATOM_CONTACTS_PROVIDER_STATUS_REPORTED"]=301,e[t[302]="ATOM_KEYSTORE_KEY_EVENT_REPORTED"]=302,e[t[303]="ATOM_NETWORK_TETHERING_REPORTED"]=303,e[t[304]="ATOM_IME_TOUCH_REPORTED"]=304,e[t[305]="ATOM_UI_INTERACTION_FRAME_INFO_REPORTED"]=305,e[t[306]="ATOM_UI_ACTION_LATENCY_REPORTED"]=306,e[t[307]="ATOM_WIFI_DISCONNECT_REPORTED"]=307,e[t[308]="ATOM_WIFI_CONNECTION_STATE_CHANGED"]=308,e[t[309]="ATOM_HDMI_CEC_ACTIVE_SOURCE_CHANGED"]=309,e[t[310]="ATOM_HDMI_CEC_MESSAGE_REPORTED"]=310,e[t[311]="ATOM_AIRPLANE_MODE"]=311,e[t[312]="ATOM_MODEM_RESTART"]=312,e[t[313]="ATOM_CARRIER_ID_MISMATCH_REPORTED"]=313,e[t[314]="ATOM_CARRIER_ID_TABLE_UPDATED"]=314,e[t[315]="ATOM_DATA_STALL_RECOVERY_REPORTED"]=315,e[t[316]="ATOM_MEDIAMETRICS_MEDIAPARSER_REPORTED"]=316,e[t[317]="ATOM_TLS_HANDSHAKE_REPORTED"]=317,e[t[318]="ATOM_TEXT_CLASSIFIER_API_USAGE_REPORTED"]=318,e[t[319]="ATOM_CAR_WATCHDOG_KILL_STATS_REPORTED"]=319,e[t[320]="ATOM_MEDIAMETRICS_PLAYBACK_REPORTED"]=320,e[t[321]="ATOM_MEDIA_NETWORK_INFO_CHANGED"]=321,e[t[322]="ATOM_MEDIA_PLAYBACK_STATE_CHANGED"]=322,e[t[323]="ATOM_MEDIA_PLAYBACK_ERROR_REPORTED"]=323,e[t[324]="ATOM_MEDIA_PLAYBACK_TRACK_CHANGED"]=324,e[t[325]="ATOM_WIFI_SCAN_REPORTED"]=325,e[t[326]="ATOM_WIFI_PNO_SCAN_REPORTED"]=326,e[t[327]="ATOM_TIF_TUNE_CHANGED"]=327,e[t[328]="ATOM_AUTO_ROTATE_REPORTED"]=328,e[t[329]="ATOM_PERFETTO_TRIGGER"]=329,e[t[330]="ATOM_TRANSCODING_DATA"]=330,e[t[331]="ATOM_IMS_SERVICE_ENTITLEMENT_UPDATED"]=331,e[t[333]="ATOM_DEVICE_ROTATED"]=333,e[t[334]="ATOM_SIM_SPECIFIC_SETTINGS_RESTORED"]=334,e[t[335]="ATOM_TEXT_CLASSIFIER_DOWNLOAD_REPORTED"]=335,e[t[336]="ATOM_PIN_STORAGE_EVENT"]=336,e[t[337]="ATOM_FACE_DOWN_REPORTED"]=337,e[t[338]="ATOM_BLUETOOTH_HAL_CRASH_REASON_REPORTED"]=338,e[t[339]="ATOM_REBOOT_ESCROW_PREPARATION_REPORTED"]=339,e[t[340]="ATOM_REBOOT_ESCROW_LSKF_CAPTURE_REPORTED"]=340,e[t[341]="ATOM_REBOOT_ESCROW_REBOOT_REPORTED"]=341,e[t[342]="ATOM_BINDER_LATENCY_REPORTED"]=342,e[t[343]="ATOM_MEDIAMETRICS_AAUDIOSTREAM_REPORTED"]=343,e[t[344]="ATOM_MEDIA_TRANSCODING_SESSION_ENDED"]=344,e[t[345]="ATOM_MAGNIFICATION_USAGE_REPORTED"]=345,e[t[346]="ATOM_MAGNIFICATION_MODE_WITH_IME_ON_REPORTED"]=346,e[t[347]="ATOM_APP_SEARCH_CALL_STATS_REPORTED"]=347,e[t[348]="ATOM_APP_SEARCH_PUT_DOCUMENT_STATS_REPORTED"]=348,e[t[349]="ATOM_DEVICE_CONTROL_CHANGED"]=349,e[t[350]="ATOM_DEVICE_STATE_CHANGED"]=350,e[t[351]="ATOM_INPUTDEVICE_REGISTERED"]=351,e[t[352]="ATOM_SMARTSPACE_CARD_REPORTED"]=352,e[t[353]="ATOM_AUTH_PROMPT_AUTHENTICATE_INVOKED"]=353,e[t[354]="ATOM_AUTH_MANAGER_CAN_AUTHENTICATE_INVOKED"]=354,e[t[355]="ATOM_AUTH_ENROLL_ACTION_INVOKED"]=355,e[t[356]="ATOM_AUTH_DEPRECATED_API_USED"]=356,e[t[357]="ATOM_UNATTENDED_REBOOT_OCCURRED"]=357,e[t[358]="ATOM_LONG_REBOOT_BLOCKING_REPORTED"]=358,e[t[359]="ATOM_LOCATION_TIME_ZONE_PROVIDER_STATE_CHANGED"]=359,e[t[364]="ATOM_FDTRACK_EVENT_OCCURRED"]=364,e[t[365]="ATOM_TIMEOUT_AUTO_EXTENDED_REPORTED"]=365,e[t[367]="ATOM_ALARM_BATCH_DELIVERED"]=367,e[t[368]="ATOM_ALARM_SCHEDULED"]=368,e[t[369]="ATOM_CAR_WATCHDOG_IO_OVERUSE_STATS_REPORTED"]=369,e[t[370]="ATOM_USER_LEVEL_HIBERNATION_STATE_CHANGED"]=370,e[t[371]="ATOM_APP_SEARCH_INITIALIZE_STATS_REPORTED"]=371,e[t[372]="ATOM_APP_SEARCH_QUERY_STATS_REPORTED"]=372,e[t[373]="ATOM_APP_PROCESS_DIED"]=373,e[t[374]="ATOM_NETWORK_IP_REACHABILITY_MONITOR_REPORTED"]=374,e[t[375]="ATOM_SLOW_INPUT_EVENT_REPORTED"]=375,e[t[376]="ATOM_ANR_OCCURRED_PROCESSING_STARTED"]=376,e[t[377]="ATOM_APP_SEARCH_REMOVE_STATS_REPORTED"]=377,e[t[378]="ATOM_MEDIA_CODEC_REPORTED"]=378,e[t[379]="ATOM_PERMISSION_USAGE_FRAGMENT_INTERACTION"]=379,e[t[380]="ATOM_PERMISSION_DETAILS_INTERACTION"]=380,e[t[381]="ATOM_PRIVACY_SENSOR_TOGGLE_INTERACTION"]=381,e[t[382]="ATOM_PRIVACY_TOGGLE_DIALOG_INTERACTION"]=382,e[t[383]="ATOM_APP_SEARCH_OPTIMIZE_STATS_REPORTED"]=383,e[t[384]="ATOM_NON_A11Y_TOOL_SERVICE_WARNING_REPORT"]=384,e[t[385]="ATOM_APP_SEARCH_SET_SCHEMA_STATS_REPORTED"]=385,e[t[386]="ATOM_APP_COMPAT_STATE_CHANGED"]=386,e[t[387]="ATOM_SIZE_COMPAT_RESTART_BUTTON_EVENT_REPORTED"]=387,e[t[388]="ATOM_SPLITSCREEN_UI_CHANGED"]=388,e[t[389]="ATOM_NETWORK_DNS_HANDSHAKE_REPORTED"]=389,e[t[390]="ATOM_BLUETOOTH_CODE_PATH_COUNTER"]=390,e[t[392]="ATOM_BLUETOOTH_LE_BATCH_SCAN_REPORT_DELAY"]=392,e[t[393]="ATOM_ACCESSIBILITY_FLOATING_MENU_UI_CHANGED"]=393,e[t[394]="ATOM_NEURALNETWORKS_COMPILATION_COMPLETED"]=394,e[t[395]="ATOM_NEURALNETWORKS_EXECUTION_COMPLETED"]=395,e[t[396]="ATOM_NEURALNETWORKS_COMPILATION_FAILED"]=396,e[t[397]="ATOM_NEURALNETWORKS_EXECUTION_FAILED"]=397,e[t[398]="ATOM_CONTEXT_HUB_BOOTED"]=398,e[t[399]="ATOM_CONTEXT_HUB_RESTARTED"]=399,e[t[400]="ATOM_CONTEXT_HUB_LOADED_NANOAPP_SNAPSHOT_REPORTED"]=400,e[t[401]="ATOM_CHRE_CODE_DOWNLOAD_TRANSACTED"]=401,e[t[402]="ATOM_UWB_SESSION_INITED"]=402,e[t[403]="ATOM_UWB_SESSION_CLOSED"]=403,e[t[404]="ATOM_UWB_FIRST_RANGING_RECEIVED"]=404,e[t[405]="ATOM_UWB_RANGING_MEASUREMENT_RECEIVED"]=405,e[t[406]="ATOM_TEXT_CLASSIFIER_DOWNLOAD_WORK_SCHEDULED"]=406,e[t[407]="ATOM_TEXT_CLASSIFIER_DOWNLOAD_WORK_COMPLETED"]=407,e[t[408]="ATOM_CLIPBOARD_CLEARED"]=408,e[t[409]="ATOM_VM_CREATION_REQUESTED"]=409,e[t[410]="ATOM_NEARBY_DEVICE_SCAN_STATE_CHANGED"]=410,e[t[411]="ATOM_CAMERA_COMPAT_CONTROL_EVENT_REPORTED"]=411,e[t[412]="ATOM_APPLICATION_LOCALES_CHANGED"]=412,e[t[413]="ATOM_MEDIAMETRICS_AUDIOTRACKSTATUS_REPORTED"]=413,e[t[414]="ATOM_FOLD_STATE_DURATION_REPORTED"]=414,e[t[415]="ATOM_LOCATION_TIME_ZONE_PROVIDER_CONTROLLER_STATE_CHANGED"]=415,e[t[416]="ATOM_DISPLAY_HBM_STATE_CHANGED"]=416,e[t[417]="ATOM_DISPLAY_HBM_BRIGHTNESS_CHANGED"]=417,e[t[418]="ATOM_PERSISTENT_URI_PERMISSIONS_FLUSHED"]=418,e[t[419]="ATOM_EARLY_BOOT_COMP_OS_ARTIFACTS_CHECK_REPORTED"]=419,e[t[420]="ATOM_VBMETA_DIGEST_REPORTED"]=420,e[t[421]="ATOM_APEX_INFO_GATHERED"]=421,e[t[422]="ATOM_PVM_INFO_GATHERED"]=422,e[t[423]="ATOM_WEAR_SETTINGS_UI_INTERACTED"]=423,e[t[424]="ATOM_TRACING_SERVICE_REPORT_EVENT"]=424,e[t[425]="ATOM_MEDIAMETRICS_AUDIORECORDSTATUS_REPORTED"]=425,e[t[426]="ATOM_LAUNCHER_LATENCY"]=426,e[t[427]="ATOM_DROPBOX_ENTRY_DROPPED"]=427,e[t[428]="ATOM_WIFI_P2P_CONNECTION_REPORTED"]=428,e[t[429]="ATOM_GAME_STATE_CHANGED"]=429,e[t[430]="ATOM_HOTWORD_DETECTOR_CREATE_REQUESTED"]=430,e[t[431]="ATOM_HOTWORD_DETECTION_SERVICE_INIT_RESULT_REPORTED"]=431,e[t[432]="ATOM_HOTWORD_DETECTION_SERVICE_RESTARTED"]=432,e[t[433]="ATOM_HOTWORD_DETECTOR_KEYPHRASE_TRIGGERED"]=433,e[t[434]="ATOM_HOTWORD_DETECTOR_EVENTS"]=434,e[t[435]="ATOM_AD_SERVICES_API_CALLED"]=435,e[t[436]="ATOM_AD_SERVICES_MESUREMENT_REPORTS_UPLOADED"]=436,e[t[437]="ATOM_BOOT_COMPLETED_BROADCAST_COMPLETION_LATENCY_REPORTED"]=437,e[t[440]="ATOM_CONTACTS_INDEXER_UPDATE_STATS_REPORTED"]=440,e[t[441]="ATOM_APP_BACKGROUND_RESTRICTIONS_INFO"]=441,e[t[442]="ATOM_MMS_SMS_PROVIDER_GET_THREAD_ID_FAILED"]=442,e[t[443]="ATOM_MMS_SMS_DATABASE_HELPER_ON_UPGRADE_FAILED"]=443,e[t[444]="ATOM_PERMISSION_REMINDER_NOTIFICATION_INTERACTED"]=444,e[t[445]="ATOM_RECENT_PERMISSION_DECISIONS_INTERACTED"]=445,e[t[446]="ATOM_GNSS_PSDS_DOWNLOAD_REPORTED"]=446,e[t[447]="ATOM_LE_AUDIO_CONNECTION_SESSION_REPORTED"]=447,e[t[448]="ATOM_LE_AUDIO_BROADCAST_SESSION_REPORTED"]=448,e[t[449]="ATOM_DREAM_UI_EVENT_REPORTED"]=449,e[t[450]="ATOM_TASK_MANAGER_EVENT_REPORTED"]=450,e[t[451]="ATOM_CDM_ASSOCIATION_ACTION"]=451,e[t[452]="ATOM_MAGNIFICATION_TRIPLE_TAP_AND_HOLD_ACTIVATED_SESSION_REPORTED"]=452,e[t[453]="ATOM_MAGNIFICATION_FOLLOW_TYPING_FOCUS_ACTIVATED_SESSION_REPORTED"]=453,e[t[454]="ATOM_ACCESSIBILITY_TEXT_READING_OPTIONS_CHANGED"]=454,e[t[455]="ATOM_WIFI_SETUP_FAILURE_CRASH_REPORTED"]=455,e[t[456]="ATOM_UWB_DEVICE_ERROR_REPORTED"]=456,e[t[457]="ATOM_ISOLATED_COMPILATION_SCHEDULED"]=457,e[t[458]="ATOM_ISOLATED_COMPILATION_ENDED"]=458,e[t[459]="ATOM_ONS_OPPORTUNISTIC_ESIM_PROVISIONING_COMPLETE"]=459,e[t[460]="ATOM_SYSTEM_SERVER_PRE_WATCHDOG_OCCURRED"]=460,e[t[461]="ATOM_TELEPHONY_ANOMALY_DETECTED"]=461,e[t[462]="ATOM_LETTERBOX_POSITION_CHANGED"]=462,e[t[463]="ATOM_REMOTE_KEY_PROVISIONING_ATTEMPT"]=463,e[t[464]="ATOM_REMOTE_KEY_PROVISIONING_NETWORK_INFO"]=464,e[t[465]="ATOM_REMOTE_KEY_PROVISIONING_TIMING"]=465,e[t[466]="ATOM_MEDIAOUTPUT_OP_INTERACTION_REPORT"]=466,e[t[468]="ATOM_SYNC_EXEMPTION_OCCURRED"]=468,e[t[469]="ATOM_AUTOFILL_PRESENTATION_EVENT_REPORTED"]=469,e[t[470]="ATOM_DOCK_STATE_CHANGED"]=470,e[t[471]="ATOM_SAFETY_SOURCE_STATE_COLLECTED"]=471,e[t[472]="ATOM_SAFETY_CENTER_SYSTEM_EVENT_REPORTED"]=472,e[t[473]="ATOM_SAFETY_CENTER_INTERACTION_REPORTED"]=473,e[t[474]="ATOM_SETTINGS_PROVIDER_SETTING_CHANGED"]=474,e[t[475]="ATOM_BROADCAST_DELIVERY_EVENT_REPORTED"]=475,e[t[476]="ATOM_SERVICE_REQUEST_EVENT_REPORTED"]=476,e[t[477]="ATOM_PROVIDER_ACQUISITION_EVENT_REPORTED"]=477,e[t[478]="ATOM_BLUETOOTH_DEVICE_NAME_REPORTED"]=478,e[t[479]="ATOM_CB_CONFIG_UPDATED"]=479,e[t[480]="ATOM_CB_MODULE_ERROR_REPORTED"]=480,e[t[481]="ATOM_CB_SERVICE_FEATURE_CHANGED"]=481,e[t[482]="ATOM_CB_RECEIVER_FEATURE_CHANGED"]=482,e[t[483]="ATOM_JSSCRIPTENGINE_LATENCY_REPORTED"]=483,e[t[484]="ATOM_PRIVACY_SIGNAL_NOTIFICATION_INTERACTION"]=484,e[t[485]="ATOM_PRIVACY_SIGNAL_ISSUE_CARD_INTERACTION"]=485,e[t[486]="ATOM_PRIVACY_SIGNALS_JOB_FAILURE"]=486,e[t[487]="ATOM_VIBRATION_REPORTED"]=487,e[t[489]="ATOM_UWB_RANGING_START"]=489,e[t[490]="ATOM_MOBILE_DATA_DOWNLOAD_FILE_GROUP_STATUS_REPORTED"]=490,e[t[491]="ATOM_APP_COMPACTED_V2"]=491,e[t[493]="ATOM_AD_SERVICES_SETTINGS_USAGE_REPORTED"]=493,e[t[494]="ATOM_DISPLAY_BRIGHTNESS_CHANGED"]=494,e[t[495]="ATOM_ACTIVITY_ACTION_BLOCKED"]=495,e[t[496]="ATOM_BACKGROUND_FETCH_PROCESS_REPORTED"]=496,e[t[497]="ATOM_UPDATE_CUSTOM_AUDIENCE_PROCESS_REPORTED"]=497,e[t[498]="ATOM_RUN_AD_BIDDING_PROCESS_REPORTED"]=498,e[t[499]="ATOM_RUN_AD_SCORING_PROCESS_REPORTED"]=499,e[t[500]="ATOM_RUN_AD_SELECTION_PROCESS_REPORTED"]=500,e[t[501]="ATOM_RUN_AD_BIDDING_PER_CA_PROCESS_REPORTED"]=501,e[t[502]="ATOM_MOBILE_DATA_DOWNLOAD_DOWNLOAD_RESULT_REPORTED"]=502,e[t[503]="ATOM_MOBILE_DATA_DOWNLOAD_FILE_GROUP_STORAGE_STATS_REPORTED"]=503,e[t[504]="ATOM_NETWORK_DNS_SERVER_SUPPORT_REPORTED"]=504,e[t[505]="ATOM_VM_BOOTED"]=505,e[t[506]="ATOM_VM_EXITED"]=506,e[t[507]="ATOM_AMBIENT_BRIGHTNESS_STATS_REPORTED"]=507,e[t[508]="ATOM_MEDIAMETRICS_SPATIALIZERCAPABILITIES_REPORTED"]=508,e[t[509]="ATOM_MEDIAMETRICS_SPATIALIZERDEVICEENABLED_REPORTED"]=509,e[t[510]="ATOM_MEDIAMETRICS_HEADTRACKERDEVICEENABLED_REPORTED"]=510,e[t[511]="ATOM_MEDIAMETRICS_HEADTRACKERDEVICESUPPORTED_REPORTED"]=511,e[t[512]="ATOM_AD_SERVICES_MEASUREMENT_REGISTRATIONS"]=512,e[t[513]="ATOM_HEARING_AID_INFO_REPORTED"]=513,e[t[514]="ATOM_DEVICE_WIDE_JOB_CONSTRAINT_CHANGED"]=514,e[t[515]="ATOM_AMBIENT_MODE_CHANGED"]=515,e[t[516]="ATOM_ANR_LATENCY_REPORTED"]=516,e[t[517]="ATOM_RESOURCE_API_INFO"]=517,e[t[518]="ATOM_SYSTEM_DEFAULT_NETWORK_CHANGED"]=518,e[t[519]="ATOM_IWLAN_SETUP_DATA_CALL_RESULT_REPORTED"]=519,e[t[520]="ATOM_IWLAN_PDN_DISCONNECTED_REASON_REPORTED"]=520,e[t[521]="ATOM_AIRPLANE_MODE_SESSION_REPORTED"]=521,e[t[522]="ATOM_VM_CPU_STATUS_REPORTED"]=522,e[t[523]="ATOM_VM_MEM_STATUS_REPORTED"]=523,e[t[524]="ATOM_PACKAGE_INSTALLATION_SESSION_REPORTED"]=524,e[t[525]="ATOM_DEFAULT_NETWORK_REMATCH_INFO"]=525,e[t[526]="ATOM_NETWORK_SELECTION_PERFORMANCE"]=526,e[t[527]="ATOM_NETWORK_NSD_REPORTED"]=527,e[t[529]="ATOM_BLUETOOTH_DISCONNECTION_REASON_REPORTED"]=529,e[t[530]="ATOM_BLUETOOTH_LOCAL_VERSIONS_REPORTED"]=530,e[t[531]="ATOM_BLUETOOTH_REMOTE_SUPPORTED_FEATURES_REPORTED"]=531,e[t[532]="ATOM_BLUETOOTH_LOCAL_SUPPORTED_FEATURES_REPORTED"]=532,e[t[533]="ATOM_BLUETOOTH_GATT_APP_INFO"]=533,e[t[534]="ATOM_BRIGHTNESS_CONFIGURATION_UPDATED"]=534,e[t[535]="ATOM_AD_SERVICES_GET_TOPICS_REPORTED"]=535,e[t[536]="ATOM_AD_SERVICES_EPOCH_COMPUTATION_GET_TOP_TOPICS_REPORTED"]=536,e[t[537]="ATOM_AD_SERVICES_EPOCH_COMPUTATION_CLASSIFIER_REPORTED"]=537,e[t[538]="ATOM_WEAR_MEDIA_OUTPUT_SWITCHER_LAUNCHED"]=538,e[t[539]="ATOM_WEAR_MEDIA_OUTPUT_SWITCHER_FINISHED"]=539,e[t[540]="ATOM_WEAR_MEDIA_OUTPUT_SWITCHER_CONNECTION_REPORTED"]=540,e[t[541]="ATOM_WEAR_MEDIA_OUTPUT_SWITCHER_DEVICE_SCAN_TRIGGERED"]=541,e[t[542]="ATOM_WEAR_MEDIA_OUTPUT_SWITCHER_FIRST_DEVICE_SCAN_LATENCY"]=542,e[t[543]="ATOM_WEAR_MEDIA_OUTPUT_SWITCHER_CONNECT_DEVICE_LATENCY"]=543,e[t[544]="ATOM_PACKAGE_MANAGER_SNAPSHOT_REPORTED"]=544,e[t[545]="ATOM_PACKAGE_MANAGER_APPS_FILTER_CACHE_BUILD_REPORTED"]=545,e[t[546]="ATOM_PACKAGE_MANAGER_APPS_FILTER_CACHE_UPDATE_REPORTED"]=546,e[t[547]="ATOM_LAUNCHER_IMPRESSION_EVENT"]=547,e[t[549]="ATOM_WEAR_MEDIA_OUTPUT_SWITCHER_ALL_DEVICES_SCAN_LATENCY"]=549,e[t[551]="ATOM_WS_WATCH_FACE_EDITED"]=551,e[t[552]="ATOM_WS_WATCH_FACE_FAVORITE_ACTION_REPORTED"]=552,e[t[553]="ATOM_WS_WATCH_FACE_SET_ACTION_REPORTED"]=553,e[t[554]="ATOM_PACKAGE_UNINSTALLATION_REPORTED"]=554,e[t[555]="ATOM_GAME_MODE_CHANGED"]=555,e[t[556]="ATOM_GAME_MODE_CONFIGURATION_CHANGED"]=556,e[t[557]="ATOM_BEDTIME_MODE_STATE_CHANGED"]=557,e[t[558]="ATOM_NETWORK_SLICE_SESSION_ENDED"]=558,e[t[559]="ATOM_NETWORK_SLICE_DAILY_DATA_USAGE_REPORTED"]=559,e[t[560]="ATOM_NFC_TAG_TYPE_OCCURRED"]=560,e[t[561]="ATOM_NFC_AID_CONFLICT_OCCURRED"]=561,e[t[562]="ATOM_NFC_READER_CONFLICT_OCCURRED"]=562,e[t[563]="ATOM_WS_TILE_LIST_CHANGED"]=563,e[t[564]="ATOM_GET_TYPE_ACCESSED_WITHOUT_PERMISSION"]=564,e[t[566]="ATOM_MOBILE_BUNDLED_APP_INFO_GATHERED"]=566,e[t[567]="ATOM_WS_WATCH_FACE_COMPLICATION_SET_CHANGED"]=567,e[t[568]="ATOM_MEDIA_DRM_CREATED"]=568,e[t[569]="ATOM_MEDIA_DRM_ERRORED"]=569,e[t[570]="ATOM_MEDIA_DRM_SESSION_OPENED"]=570,e[t[571]="ATOM_MEDIA_DRM_SESSION_CLOSED"]=571,e[t[572]="ATOM_USER_SELECTED_RESOLUTION"]=572,e[t[573]="ATOM_UNSAFE_INTENT_EVENT_REPORTED"]=573,e[t[574]="ATOM_PERFORMANCE_HINT_SESSION_REPORTED"]=574,e[t[576]="ATOM_MEDIAMETRICS_MIDI_DEVICE_CLOSE_REPORTED"]=576,e[t[577]="ATOM_BIOMETRIC_TOUCH_REPORTED"]=577,e[t[578]="ATOM_HOTWORD_AUDIO_EGRESS_EVENT_REPORTED"]=578,e[t[579]="ATOM_APP_SEARCH_SCHEMA_MIGRATION_STATS_REPORTED"]=579,e[t[580]="ATOM_LOCATION_ENABLED_STATE_CHANGED"]=580,e[t[581]="ATOM_IME_REQUEST_FINISHED"]=581,e[t[582]="ATOM_USB_COMPLIANCE_WARNINGS_REPORTED"]=582,e[t[583]="ATOM_APP_SUPPORTED_LOCALES_CHANGED"]=583,e[t[584]="ATOM_GRAMMATICAL_INFLECTION_CHANGED"]=584,e[t[586]="ATOM_MEDIA_PROVIDER_VOLUME_RECOVERY_REPORTED"]=586,e[t[587]="ATOM_BIOMETRIC_PROPERTIES_COLLECTED"]=587,e[t[588]="ATOM_KERNEL_WAKEUP_ATTRIBUTED"]=588,e[t[589]="ATOM_SCREEN_STATE_CHANGED_V2"]=589,e[t[590]="ATOM_WS_BACKUP_ACTION_REPORTED"]=590,e[t[591]="ATOM_WS_RESTORE_ACTION_REPORTED"]=591,e[t[592]="ATOM_DEVICE_LOG_ACCESS_EVENT_REPORTED"]=592,e[t[594]="ATOM_MEDIA_SESSION_UPDATED"]=594,e[t[595]="ATOM_WEAR_OOBE_STATE_CHANGED"]=595,e[t[596]="ATOM_WS_NOTIFICATION_UPDATED"]=596,e[t[601]="ATOM_NETWORK_VALIDATION_FAILURE_STATS_DAILY_REPORTED"]=601,e[t[602]="ATOM_WS_COMPLICATION_TAPPED"]=602,e[t[610]="ATOM_WS_WEAR_TIME_SESSION"]=610,e[t[1e4]="ATOM_WIFI_BYTES_TRANSFER"]=1e4,e[t[10001]="ATOM_WIFI_BYTES_TRANSFER_BY_FG_BG"]=10001,e[t[10002]="ATOM_MOBILE_BYTES_TRANSFER"]=10002,e[t[10003]="ATOM_MOBILE_BYTES_TRANSFER_BY_FG_BG"]=10003,e[t[10006]="ATOM_BLUETOOTH_BYTES_TRANSFER"]=10006,e[t[10004]="ATOM_KERNEL_WAKELOCK"]=10004,e[t[10005]="ATOM_SUBSYSTEM_SLEEP_STATE"]=10005,e[t[10009]="ATOM_CPU_TIME_PER_UID"]=10009,e[t[10010]="ATOM_CPU_TIME_PER_UID_FREQ"]=10010,e[t[10011]="ATOM_WIFI_ACTIVITY_INFO"]=10011,e[t[10012]="ATOM_MODEM_ACTIVITY_INFO"]=10012,e[t[10007]="ATOM_BLUETOOTH_ACTIVITY_INFO"]=10007,e[t[10013]="ATOM_PROCESS_MEMORY_STATE"]=10013,e[t[10014]="ATOM_SYSTEM_ELAPSED_REALTIME"]=10014,e[t[10015]="ATOM_SYSTEM_UPTIME"]=10015,e[t[10016]="ATOM_CPU_ACTIVE_TIME"]=10016,e[t[10017]="ATOM_CPU_CLUSTER_TIME"]=10017,e[t[10018]="ATOM_DISK_SPACE"]=10018,e[t[10019]="ATOM_REMAINING_BATTERY_CAPACITY"]=10019,e[t[10020]="ATOM_FULL_BATTERY_CAPACITY"]=10020,e[t[10021]="ATOM_TEMPERATURE"]=10021,e[t[10022]="ATOM_BINDER_CALLS"]=10022,e[t[10023]="ATOM_BINDER_CALLS_EXCEPTIONS"]=10023,e[t[10024]="ATOM_LOOPER_STATS"]=10024,e[t[10025]="ATOM_DISK_STATS"]=10025,e[t[10026]="ATOM_DIRECTORY_USAGE"]=10026,e[t[10027]="ATOM_APP_SIZE"]=10027,e[t[10028]="ATOM_CATEGORY_SIZE"]=10028,e[t[10029]="ATOM_PROC_STATS"]=10029,e[t[10030]="ATOM_BATTERY_VOLTAGE"]=10030,e[t[10031]="ATOM_NUM_FINGERPRINTS_ENROLLED"]=10031,e[t[10032]="ATOM_DISK_IO"]=10032,e[t[10033]="ATOM_POWER_PROFILE"]=10033,e[t[10034]="ATOM_PROC_STATS_PKG_PROC"]=10034,e[t[10035]="ATOM_PROCESS_CPU_TIME"]=10035,e[t[10037]="ATOM_CPU_TIME_PER_THREAD_FREQ"]=10037,e[t[10038]="ATOM_ON_DEVICE_POWER_MEASUREMENT"]=10038,e[t[10039]="ATOM_DEVICE_CALCULATED_POWER_USE"]=10039,e[t[10042]="ATOM_PROCESS_MEMORY_HIGH_WATER_MARK"]=10042,e[t[10043]="ATOM_BATTERY_LEVEL"]=10043,e[t[10044]="ATOM_BUILD_INFORMATION"]=10044,e[t[10045]="ATOM_BATTERY_CYCLE_COUNT"]=10045,e[t[10046]="ATOM_DEBUG_ELAPSED_CLOCK"]=10046,e[t[10047]="ATOM_DEBUG_FAILING_ELAPSED_CLOCK"]=10047,e[t[10048]="ATOM_NUM_FACES_ENROLLED"]=10048,e[t[10049]="ATOM_ROLE_HOLDER"]=10049,e[t[10050]="ATOM_DANGEROUS_PERMISSION_STATE"]=10050,e[t[10051]="ATOM_TRAIN_INFO"]=10051,e[t[10052]="ATOM_TIME_ZONE_DATA_INFO"]=10052,e[t[10053]="ATOM_EXTERNAL_STORAGE_INFO"]=10053,e[t[10054]="ATOM_GPU_STATS_GLOBAL_INFO"]=10054,e[t[10055]="ATOM_GPU_STATS_APP_INFO"]=10055,e[t[10056]="ATOM_SYSTEM_ION_HEAP_SIZE"]=10056,e[t[10057]="ATOM_APPS_ON_EXTERNAL_STORAGE_INFO"]=10057,e[t[10058]="ATOM_FACE_SETTINGS"]=10058,e[t[10059]="ATOM_COOLING_DEVICE"]=10059,e[t[10060]="ATOM_APP_OPS"]=10060,e[t[10061]="ATOM_PROCESS_SYSTEM_ION_HEAP_SIZE"]=10061,e[t[10062]="ATOM_SURFACEFLINGER_STATS_GLOBAL_INFO"]=10062,e[t[10063]="ATOM_SURFACEFLINGER_STATS_LAYER_INFO"]=10063,e[t[10064]="ATOM_PROCESS_MEMORY_SNAPSHOT"]=10064,e[t[10065]="ATOM_VMS_CLIENT_STATS"]=10065,e[t[10066]="ATOM_NOTIFICATION_REMOTE_VIEWS"]=10066,e[t[10067]="ATOM_DANGEROUS_PERMISSION_STATE_SAMPLED"]=10067,e[t[10068]="ATOM_GRAPHICS_STATS"]=10068,e[t[10069]="ATOM_RUNTIME_APP_OP_ACCESS"]=10069,e[t[10070]="ATOM_ION_HEAP_SIZE"]=10070,e[t[10071]="ATOM_PACKAGE_NOTIFICATION_PREFERENCES"]=10071,e[t[10072]="ATOM_PACKAGE_NOTIFICATION_CHANNEL_PREFERENCES"]=10072,e[t[10073]="ATOM_PACKAGE_NOTIFICATION_CHANNEL_GROUP_PREFERENCES"]=10073,e[t[10074]="ATOM_GNSS_STATS"]=10074,e[t[10075]="ATOM_ATTRIBUTED_APP_OPS"]=10075,e[t[10076]="ATOM_VOICE_CALL_SESSION"]=10076,e[t[10077]="ATOM_VOICE_CALL_RAT_USAGE"]=10077,e[t[10078]="ATOM_SIM_SLOT_STATE"]=10078,e[t[10079]="ATOM_SUPPORTED_RADIO_ACCESS_FAMILY"]=10079,e[t[10080]="ATOM_SETTING_SNAPSHOT"]=10080,e[t[10081]="ATOM_BLOB_INFO"]=10081,e[t[10082]="ATOM_DATA_USAGE_BYTES_TRANSFER"]=10082,e[t[10083]="ATOM_BYTES_TRANSFER_BY_TAG_AND_METERED"]=10083,e[t[10084]="ATOM_DND_MODE_RULE"]=10084,e[t[10085]="ATOM_GENERAL_EXTERNAL_STORAGE_ACCESS_STATS"]=10085,e[t[10086]="ATOM_INCOMING_SMS"]=10086,e[t[10087]="ATOM_OUTGOING_SMS"]=10087,e[t[10088]="ATOM_CARRIER_ID_TABLE_VERSION"]=10088,e[t[10089]="ATOM_DATA_CALL_SESSION"]=10089,e[t[10090]="ATOM_CELLULAR_SERVICE_STATE"]=10090,e[t[10091]="ATOM_CELLULAR_DATA_SERVICE_SWITCH"]=10091,e[t[10092]="ATOM_SYSTEM_MEMORY"]=10092,e[t[10093]="ATOM_IMS_REGISTRATION_TERMINATION"]=10093,e[t[10094]="ATOM_IMS_REGISTRATION_STATS"]=10094,e[t[10095]="ATOM_CPU_TIME_PER_CLUSTER_FREQ"]=10095,e[t[10096]="ATOM_CPU_CYCLES_PER_UID_CLUSTER"]=10096,e[t[10097]="ATOM_DEVICE_ROTATED_DATA"]=10097,e[t[10098]="ATOM_CPU_CYCLES_PER_THREAD_GROUP_CLUSTER"]=10098,e[t[10099]="ATOM_MEDIA_DRM_ACTIVITY_INFO"]=10099,e[t[10100]="ATOM_OEM_MANAGED_BYTES_TRANSFER"]=10100,e[t[10101]="ATOM_GNSS_POWER_STATS"]=10101,e[t[10102]="ATOM_TIME_ZONE_DETECTOR_STATE"]=10102,e[t[10103]="ATOM_KEYSTORE2_STORAGE_STATS"]=10103,e[t[10104]="ATOM_RKP_POOL_STATS"]=10104,e[t[10105]="ATOM_PROCESS_DMABUF_MEMORY"]=10105,e[t[10106]="ATOM_PENDING_ALARM_INFO"]=10106,e[t[10107]="ATOM_USER_LEVEL_HIBERNATED_APPS"]=10107,e[t[10108]="ATOM_LAUNCHER_LAYOUT_SNAPSHOT"]=10108,e[t[10109]="ATOM_GLOBAL_HIBERNATED_APPS"]=10109,e[t[10110]="ATOM_INPUT_EVENT_LATENCY_SKETCH"]=10110,e[t[10111]="ATOM_BATTERY_USAGE_STATS_BEFORE_RESET"]=10111,e[t[10112]="ATOM_BATTERY_USAGE_STATS_SINCE_RESET"]=10112,e[t[10113]="ATOM_BATTERY_USAGE_STATS_SINCE_RESET_USING_POWER_PROFILE_MODEL"]=10113,e[t[10114]="ATOM_INSTALLED_INCREMENTAL_PACKAGE"]=10114,e[t[10115]="ATOM_TELEPHONY_NETWORK_REQUESTS"]=10115,e[t[10116]="ATOM_APP_SEARCH_STORAGE_INFO"]=10116,e[t[10117]="ATOM_VMSTAT"]=10117,e[t[10118]="ATOM_KEYSTORE2_KEY_CREATION_WITH_GENERAL_INFO"]=10118,e[t[10119]="ATOM_KEYSTORE2_KEY_CREATION_WITH_AUTH_INFO"]=10119,e[t[10120]="ATOM_KEYSTORE2_KEY_CREATION_WITH_PURPOSE_AND_MODES_INFO"]=10120,e[t[10121]="ATOM_KEYSTORE2_ATOM_WITH_OVERFLOW"]=10121,e[t[10122]="ATOM_KEYSTORE2_KEY_OPERATION_WITH_PURPOSE_AND_MODES_INFO"]=10122,e[t[10123]="ATOM_KEYSTORE2_KEY_OPERATION_WITH_GENERAL_INFO"]=10123,e[t[10124]="ATOM_RKP_ERROR_STATS"]=10124,e[t[10125]="ATOM_KEYSTORE2_CRASH_STATS"]=10125,e[t[10126]="ATOM_VENDOR_APEX_INFO"]=10126,e[t[10127]="ATOM_ACCESSIBILITY_SHORTCUT_STATS"]=10127,e[t[10128]="ATOM_ACCESSIBILITY_FLOATING_MENU_STATS"]=10128,e[t[10129]="ATOM_DATA_USAGE_BYTES_TRANSFER_V2"]=10129,e[t[10130]="ATOM_MEDIA_CAPABILITIES"]=10130,e[t[10131]="ATOM_CAR_WATCHDOG_SYSTEM_IO_USAGE_SUMMARY"]=10131,e[t[10132]="ATOM_CAR_WATCHDOG_UID_IO_USAGE_SUMMARY"]=10132,e[t[10133]="ATOM_IMS_REGISTRATION_FEATURE_TAG_STATS"]=10133,e[t[10134]="ATOM_RCS_CLIENT_PROVISIONING_STATS"]=10134,e[t[10135]="ATOM_RCS_ACS_PROVISIONING_STATS"]=10135,e[t[10136]="ATOM_SIP_DELEGATE_STATS"]=10136,e[t[10137]="ATOM_SIP_TRANSPORT_FEATURE_TAG_STATS"]=10137,e[t[10138]="ATOM_SIP_MESSAGE_RESPONSE"]=10138,e[t[10139]="ATOM_SIP_TRANSPORT_SESSION"]=10139,e[t[10140]="ATOM_IMS_DEDICATED_BEARER_LISTENER_EVENT"]=10140,e[t[10141]="ATOM_IMS_DEDICATED_BEARER_EVENT"]=10141,e[t[10142]="ATOM_IMS_REGISTRATION_SERVICE_DESC_STATS"]=10142,e[t[10143]="ATOM_UCE_EVENT_STATS"]=10143,e[t[10144]="ATOM_PRESENCE_NOTIFY_EVENT"]=10144,e[t[10145]="ATOM_GBA_EVENT"]=10145,e[t[10146]="ATOM_PER_SIM_STATUS"]=10146,e[t[10147]="ATOM_GPU_WORK_PER_UID"]=10147,e[t[10148]="ATOM_PERSISTENT_URI_PERMISSIONS_AMOUNT_PER_PACKAGE"]=10148,e[t[10149]="ATOM_SIGNED_PARTITION_INFO"]=10149,e[t[10150]="ATOM_PINNED_FILE_SIZES_PER_PACKAGE"]=10150,e[t[10151]="ATOM_PENDING_INTENTS_PER_PACKAGE"]=10151,e[t[10152]="ATOM_USER_INFO"]=10152,e[t[10153]="ATOM_TELEPHONY_NETWORK_REQUESTS_V2"]=10153,e[t[10154]="ATOM_DEVICE_TELEPHONY_PROPERTIES"]=10154,e[t[10155]="ATOM_REMOTE_KEY_PROVISIONING_ERROR_COUNTS"]=10155,e[t[10156]="ATOM_SAFETY_STATE"]=10156,e[t[10157]="ATOM_INCOMING_MMS"]=10157,e[t[10158]="ATOM_OUTGOING_MMS"]=10158,e[t[10160]="ATOM_MULTI_USER_INFO"]=10160,e[t[10161]="ATOM_NETWORK_BPF_MAP_INFO"]=10161,e[t[10162]="ATOM_OUTGOING_SHORT_CODE_SMS"]=10162,e[t[10163]="ATOM_CONNECTIVITY_STATE_SAMPLE"]=10163,e[t[10164]="ATOM_NETWORK_SELECTION_REMATCH_REASONS_INFO"]=10164,e[t[10165]="ATOM_GAME_MODE_INFO"]=10165,e[t[10166]="ATOM_GAME_MODE_CONFIGURATION"]=10166,e[t[10167]="ATOM_GAME_MODE_LISTENER"]=10167,e[t[10168]="ATOM_NETWORK_SLICE_REQUEST_COUNT"]=10168,e[t[10169]="ATOM_WS_TILE_SNAPSHOT"]=10169,e[t[10170]="ATOM_WS_ACTIVE_WATCH_FACE_COMPLICATION_SET_SNAPSHOT"]=10170,e[t[10171]="ATOM_PROCESS_STATE"]=10171,e[t[10172]="ATOM_PROCESS_ASSOCIATION"]=10172,e[t[10173]="ATOM_ADPF_SYSTEM_COMPONENT_INFO"]=10173,e[t[10174]="ATOM_NOTIFICATION_MEMORY_USE"]=10174,e[t[10175]="ATOM_HDR_CAPABILITIES"]=10175,e[t[10176]="ATOM_WS_FAVOURITE_WATCH_FACE_LIST_SNAPSHOT"]=10176,e[t[638]="ATOM_WIFI_AWARE_NDP_REPORTED"]=638,e[t[639]="ATOM_WIFI_AWARE_ATTACH_REPORTED"]=639,e[t[661]="ATOM_WIFI_SELF_RECOVERY_TRIGGERED"]=661,e[t[680]="ATOM_SOFT_AP_STARTED"]=680,e[t[681]="ATOM_SOFT_AP_STOPPED"]=681,e[t[687]="ATOM_WIFI_LOCK_RELEASED"]=687,e[t[688]="ATOM_WIFI_LOCK_DEACTIVATED"]=688,e[t[689]="ATOM_WIFI_CONFIG_SAVED"]=689,e[t[690]="ATOM_WIFI_AWARE_RESOURCE_USING_CHANGED"]=690,e[t[691]="ATOM_WIFI_AWARE_HAL_API_CALLED"]=691,e[t[692]="ATOM_WIFI_LOCAL_ONLY_REQUEST_RECEIVED"]=692,e[t[693]="ATOM_WIFI_LOCAL_ONLY_REQUEST_SCAN_TRIGGERED"]=693,e[t[694]="ATOM_WIFI_THREAD_TASK_EXECUTED"]=694,e[t[700]="ATOM_WIFI_STATE_CHANGED"]=700,e[t[10190]="ATOM_WIFI_AWARE_CAPABILITIES"]=10190,e[t[10193]="ATOM_WIFI_MODULE_INFO"]=10193,e[t[622]="ATOM_SETTINGS_SPA_REPORTED"]=622,e[t[528]="ATOM_EXPRESS_EVENT_REPORTED"]=528,e[t[593]="ATOM_EXPRESS_HISTOGRAM_SAMPLE_REPORTED"]=593,e[t[644]="ATOM_EXPRESS_UID_EVENT_REPORTED"]=644,e[t[658]="ATOM_EXPRESS_UID_HISTOGRAM_SAMPLE_REPORTED"]=658,e[t[645]="ATOM_PERMISSION_RATIONALE_DIALOG_VIEWED"]=645,e[t[646]="ATOM_PERMISSION_RATIONALE_DIALOG_ACTION_REPORTED"]=646,e[t[647]="ATOM_APP_DATA_SHARING_UPDATES_NOTIFICATION_INTERACTION"]=647,e[t[648]="ATOM_APP_DATA_SHARING_UPDATES_FRAGMENT_VIEWED"]=648,e[t[649]="ATOM_APP_DATA_SHARING_UPDATES_FRAGMENT_ACTION_REPORTED"]=649,e[t[626]="ATOM_WS_INCOMING_CALL_ACTION_REPORTED"]=626,e[t[627]="ATOM_WS_CALL_DISCONNECTION_REPORTED"]=627,e[t[628]="ATOM_WS_CALL_DURATION_REPORTED"]=628,e[t[629]="ATOM_WS_CALL_USER_EXPERIENCE_LATENCY_REPORTED"]=629,e[t[630]="ATOM_WS_CALL_INTERACTION_REPORTED"]=630,e[t[631]="ATOM_FULL_SCREEN_INTENT_LAUNCHED"]=631,e[t[632]="ATOM_BAL_ALLOWED"]=632,e[t[685]="ATOM_IN_TASK_ACTIVITY_STARTED"]=685,e[t[10189]="ATOM_CACHED_APPS_HIGH_WATERMARK"]=10189,e[t[366]="ATOM_ODREFRESH_REPORTED"]=366,e[t[548]="ATOM_ODSIGN_REPORTED"]=548,e[t[332]="ATOM_ART_DATUM_REPORTED"]=332,e[t[550]="ATOM_ART_DEVICE_DATUM_REPORTED"]=550,e[t[565]="ATOM_ART_DATUM_DELTA_REPORTED"]=565,e[t[467]="ATOM_BACKGROUND_DEXOPT_JOB_ENDED"]=467,e[t[619]="ATOM_WEAR_ADAPTIVE_SUSPEND_STATS_REPORTED"]=619,e[t[620]="ATOM_WEAR_POWER_ANOMALY_SERVICE_OPERATIONAL_STATS_REPORTED"]=620,e[t[621]="ATOM_WEAR_POWER_ANOMALY_SERVICE_EVENT_STATS_REPORTED"]=621,e[t[633]="ATOM_EMERGENCY_STATE_CHANGED"]=633,e[t[657]="ATOM_DND_STATE_CHANGED"]=657,e[t[10181]="ATOM_MTE_STATE"]=10181,e[t[598]="ATOM_AD_SERVICES_BACK_COMPAT_GET_TOPICS_REPORTED"]=598,e[t[599]="ATOM_AD_SERVICES_BACK_COMPAT_EPOCH_COMPUTATION_CLASSIFIER_REPORTED"]=599,e[t[640]="ATOM_AD_SERVICES_MEASUREMENT_DEBUG_KEYS"]=640,e[t[662]="ATOM_AD_SERVICES_ERROR_REPORTED"]=662,e[t[663]="ATOM_AD_SERVICES_BACKGROUND_JOBS_EXECUTION_REPORTED"]=663,e[t[673]="ATOM_AD_SERVICES_MEASUREMENT_DELAYED_SOURCE_REGISTRATION"]=673,e[t[674]="ATOM_AD_SERVICES_MEASUREMENT_ATTRIBUTION"]=674,e[t[675]="ATOM_AD_SERVICES_MEASUREMENT_JOBS"]=675,e[t[676]="ATOM_AD_SERVICES_MEASUREMENT_WIPEOUT"]=676,e[t[702]="ATOM_AD_SERVICES_CONSENT_MIGRATED"]=702,e[t[664]="ATOM_RKPD_POOL_STATS"]=664,e[t[665]="ATOM_RKPD_CLIENT_OPERATION"]=665,e[t[603]="ATOM_AUTOFILL_UI_EVENT_REPORTED"]=603,e[t[604]="ATOM_AUTOFILL_FILL_REQUEST_REPORTED"]=604,e[t[605]="ATOM_AUTOFILL_FILL_RESPONSE_REPORTED"]=605,e[t[606]="ATOM_AUTOFILL_SAVE_EVENT_REPORTED"]=606,e[t[607]="ATOM_AUTOFILL_SESSION_COMMITTED"]=607,e[t[659]="ATOM_AUTOFILL_FIELD_CLASSIFICATION_EVENT_REPORTED"]=659,e[t[660]="ATOM_TEST_EXTENSION_ATOM_REPORTED"]=660,e[t[672]="ATOM_TEST_RESTRICTED_ATOM_REPORTED"]=672,e[t[752]="ATOM_STATS_SOCKET_LOSS_REPORTED"]=752,e[t[655]="ATOM_PLUGIN_INITIALIZED"]=655,e[t[679]="ATOM_TV_LOW_POWER_STANDBY_POLICY"]=679,e[t[611]="ATOM_LOCKSCREEN_SHORTCUT_SELECTED"]=611,e[t[612]="ATOM_LOCKSCREEN_SHORTCUT_TRIGGERED"]=612,e[t[10180]="ATOM_EMERGENCY_NUMBERS_INFO"]=10180,e[t[634]="ATOM_QUALIFIED_RAT_LIST_CHANGED"]=634,e[t[635]="ATOM_QNS_IMS_CALL_DROP_STATS"]=635,e[t[636]="ATOM_QNS_FALLBACK_RESTRICTION_CHANGED"]=636,e[t[10177]="ATOM_QNS_RAT_PREFERENCE_MISMATCH_INFO"]=10177,e[t[10178]="ATOM_QNS_HANDOVER_TIME_MILLIS"]=10178,e[t[10179]="ATOM_QNS_HANDOVER_PINGPONG"]=10179,e[t[10182]="ATOM_SATELLITE_CONTROLLER"]=10182,e[t[10183]="ATOM_SATELLITE_SESSION"]=10183,e[t[10184]="ATOM_SATELLITE_INCOMING_DATAGRAM"]=10184,e[t[10185]="ATOM_SATELLITE_OUTGOING_DATAGRAM"]=10185,e[t[10186]="ATOM_SATELLITE_PROVISION"]=10186,e[t[10187]="ATOM_SATELLITE_SOS_MESSAGE_RECOMMENDER"]=10187,e[t[678]="ATOM_IKE_SESSION_TERMINATED"]=678,e[t[760]="ATOM_IKE_LIVENESS_CHECK_SESSION_VALIDATED"]=760,e[t[613]="ATOM_BLUETOOTH_HASHED_DEVICE_NAME_REPORTED"]=613,e[t[614]="ATOM_BLUETOOTH_L2CAP_COC_CLIENT_CONNECTION"]=614,e[t[615]="ATOM_BLUETOOTH_L2CAP_COC_SERVER_CONNECTION"]=615,e[t[656]="ATOM_BLUETOOTH_LE_SESSION_CONNECTED"]=656,e[t[666]="ATOM_RESTRICTED_BLUETOOTH_DEVICE_NAME_REPORTED"]=666,e[t[696]="ATOM_BLUETOOTH_PROFILE_CONNECTION_ATTEMPTED"]=696,e[t[623]="ATOM_HEALTH_CONNECT_UI_IMPRESSION"]=623,e[t[624]="ATOM_HEALTH_CONNECT_UI_INTERACTION"]=624,e[t[625]="ATOM_HEALTH_CONNECT_APP_OPENED_REPORTED"]=625,e[t[616]="ATOM_HEALTH_CONNECT_API_CALLED"]=616,e[t[617]="ATOM_HEALTH_CONNECT_USAGE_STATS"]=617,e[t[618]="ATOM_HEALTH_CONNECT_STORAGE_STATS"]=618,e[t[643]="ATOM_HEALTH_CONNECT_API_INVOKED"]=643,e[t[654]="ATOM_EXERCISE_ROUTE_API_CALLED"]=654,e[t[9999]="ATOM_ATOM_9999"]=9999,e[t[99999]="ATOM_ATOM_99999"]=99999,e[t[738]="ATOM_THREADNETWORK_TELEMETRY_DATA_REPORTED"]=738,e[t[739]="ATOM_THREADNETWORK_TOPO_ENTRY_REPEATED"]=739,e[t[740]="ATOM_THREADNETWORK_DEVICE_INFO_REPORTED"]=740,e[t[637]="ATOM_EMERGENCY_NUMBER_DIALED"]=637,e[t[488]="ATOM_SANDBOX_API_CALLED"]=488,e[t[735]="ATOM_SANDBOX_ACTIVITY_EVENT_OCCURRED"]=735,e[t[10159]="ATOM_SANDBOX_SDK_STORAGE"]=10159,e[t[703]="ATOM_CRONET_ENGINE_CREATED"]=703,e[t[704]="ATOM_CRONET_TRAFFIC_REPORTED"]=704,e[t[762]="ATOM_CRONET_ENGINE_BUILDER_INITIALIZED"]=762,e[t[763]="ATOM_CRONET_HTTP_FLAGS_INITIALIZED"]=763,e[t[764]="ATOM_CRONET_INITIALIZED"]=764,e[t[650]="ATOM_DAILY_KEEPALIVE_INFO_REPORTED"]=650,e[t[778]="ATOM_IP_CLIENT_RA_INFO_REPORTED"]=778,e[t[777]="ATOM_APF_SESSION_INFO_REPORTED"]=777,e[t[585]="ATOM_CREDENTIAL_MANAGER_API_CALLED"]=585,e[t[651]="ATOM_CREDENTIAL_MANAGER_INIT_PHASE_REPORTED"]=651,e[t[652]="ATOM_CREDENTIAL_MANAGER_CANDIDATE_PHASE_REPORTED"]=652,e[t[653]="ATOM_CREDENTIAL_MANAGER_FINAL_PHASE_REPORTED"]=653,e[t[667]="ATOM_CREDENTIAL_MANAGER_TOTAL_REPORTED"]=667,e[t[668]="ATOM_CREDENTIAL_MANAGER_FINALNOUID_REPORTED"]=668,e[t[669]="ATOM_CREDENTIAL_MANAGER_GET_REPORTED"]=669,e[t[670]="ATOM_CREDENTIAL_MANAGER_AUTH_CLICK_REPORTED"]=670,e[t[671]="ATOM_CREDENTIAL_MANAGER_APIV2_CALLED"]=671,e[t[10188]="ATOM_UWB_ACTIVITY_INFO"]=10188,e[t[608]="ATOM_MEDIA_ACTION_REPORTED"]=608,e[t[609]="ATOM_MEDIA_CONTROLS_LAUNCHED"]=609,e[t[600]="ATOM_MEDIA_CODEC_RECLAIM_REQUEST_COMPLETED"]=600,e[t[641]="ATOM_MEDIA_CODEC_STARTED"]=641,e[t[642]="ATOM_MEDIA_CODEC_STOPPED"]=642,e[t[684]="ATOM_MEDIA_CODEC_RENDERED"]=684,e),r.ProcessStatsConfig=(v.prototype.quirks=i.emptyArray,v.prototype.scanAllProcessesOnStart=!1,v.prototype.recordThreadNames=!1,v.prototype.procStatsPollMs=0,v.prototype.procStatsCacheTtlMs=0,v.prototype.resolveProcessFds=!1,v.prototype.scanSmapsRollup=!1,v.prototype.recordProcessAge=!1,v.prototype.recordProcessRuntime=!1,v.create=function(e){return new v(e)},v.encode=function(e,t){if(t=t||a.create(),null!=e.quirks&&e.quirks.length)for(var r=0;r<e.quirks.length;++r)t.uint32(8).int32(e.quirks[r]);return null!=e.scanAllProcessesOnStart&&Object.hasOwnProperty.call(e,"scanAllProcessesOnStart")&&t.uint32(16).bool(e.scanAllProcessesOnStart),null!=e.recordThreadNames&&Object.hasOwnProperty.call(e,"recordThreadNames")&&t.uint32(24).bool(e.recordThreadNames),null!=e.procStatsPollMs&&Object.hasOwnProperty.call(e,"procStatsPollMs")&&t.uint32(32).uint32(e.procStatsPollMs),null!=e.procStatsCacheTtlMs&&Object.hasOwnProperty.call(e,"procStatsCacheTtlMs")&&t.uint32(48).uint32(e.procStatsCacheTtlMs),null!=e.resolveProcessFds&&Object.hasOwnProperty.call(e,"resolveProcessFds")&&t.uint32(72).bool(e.resolveProcessFds),null!=e.scanSmapsRollup&&Object.hasOwnProperty.call(e,"scanSmapsRollup")&&t.uint32(80).bool(e.scanSmapsRollup),null!=e.recordProcessAge&&Object.hasOwnProperty.call(e,"recordProcessAge")&&t.uint32(88).bool(e.recordProcessAge),null!=e.recordProcessRuntime&&Object.hasOwnProperty.call(e,"recordProcessRuntime")&&t.uint32(96).bool(e.recordProcessRuntime),t},v.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.ProcessStatsConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:if(n.quirks&&n.quirks.length||(n.quirks=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.quirks.push(e.int32());else n.quirks.push(e.int32());break;case 2:n.scanAllProcessesOnStart=e.bool();break;case 3:n.recordThreadNames=e.bool();break;case 4:n.procStatsPollMs=e.uint32();break;case 6:n.procStatsCacheTtlMs=e.uint32();break;case 9:n.resolveProcessFds=e.bool();break;case 10:n.scanSmapsRollup=e.bool();break;case 11:n.recordProcessAge=e.bool();break;case 12:n.recordProcessRuntime=e.bool();break;default:e.skipType(7&a)}}return n},v.fromObject=function(e){if(e instanceof s.perfetto.protos.ProcessStatsConfig)return e;var t=new s.perfetto.protos.ProcessStatsConfig;if(e.quirks){if(!Array.isArray(e.quirks))throw TypeError(".perfetto.protos.ProcessStatsConfig.quirks: array expected");t.quirks=[];for(var r=0;r<e.quirks.length;++r)switch(e.quirks[r]){default:if("number"==typeof e.quirks[r]){t.quirks[r]=e.quirks[r];break}case"QUIRKS_UNSPECIFIED":case 0:t.quirks[r]=0;break;case"DISABLE_INITIAL_DUMP":case 1:t.quirks[r]=1;break;case"DISABLE_ON_DEMAND":case 2:t.quirks[r]=2}}return null!=e.scanAllProcessesOnStart&&(t.scanAllProcessesOnStart=Boolean(e.scanAllProcessesOnStart)),null!=e.recordThreadNames&&(t.recordThreadNames=Boolean(e.recordThreadNames)),null!=e.procStatsPollMs&&(t.procStatsPollMs=e.procStatsPollMs>>>0),null!=e.procStatsCacheTtlMs&&(t.procStatsCacheTtlMs=e.procStatsCacheTtlMs>>>0),null!=e.resolveProcessFds&&(t.resolveProcessFds=Boolean(e.resolveProcessFds)),null!=e.scanSmapsRollup&&(t.scanSmapsRollup=Boolean(e.scanSmapsRollup)),null!=e.recordProcessAge&&(t.recordProcessAge=Boolean(e.recordProcessAge)),null!=e.recordProcessRuntime&&(t.recordProcessRuntime=Boolean(e.recordProcessRuntime)),t},v.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.quirks=[]),t.defaults&&(r.scanAllProcessesOnStart=!1,r.recordThreadNames=!1,r.procStatsPollMs=0,r.procStatsCacheTtlMs=0,r.resolveProcessFds=!1,r.scanSmapsRollup=!1,r.recordProcessAge=!1,r.recordProcessRuntime=!1),e.quirks&&e.quirks.length){r.quirks=[];for(var n=0;n<e.quirks.length;++n)r.quirks[n]=t.enums!==String||void 0===s.perfetto.protos.ProcessStatsConfig.Quirks[e.quirks[n]]?e.quirks[n]:s.perfetto.protos.ProcessStatsConfig.Quirks[e.quirks[n]]}return null!=e.scanAllProcessesOnStart&&e.hasOwnProperty("scanAllProcessesOnStart")&&(r.scanAllProcessesOnStart=e.scanAllProcessesOnStart),null!=e.recordThreadNames&&e.hasOwnProperty("recordThreadNames")&&(r.recordThreadNames=e.recordThreadNames),null!=e.procStatsPollMs&&e.hasOwnProperty("procStatsPollMs")&&(r.procStatsPollMs=e.procStatsPollMs),null!=e.procStatsCacheTtlMs&&e.hasOwnProperty("procStatsCacheTtlMs")&&(r.procStatsCacheTtlMs=e.procStatsCacheTtlMs),null!=e.resolveProcessFds&&e.hasOwnProperty("resolveProcessFds")&&(r.resolveProcessFds=e.resolveProcessFds),null!=e.scanSmapsRollup&&e.hasOwnProperty("scanSmapsRollup")&&(r.scanSmapsRollup=e.scanSmapsRollup),null!=e.recordProcessAge&&e.hasOwnProperty("recordProcessAge")&&(r.recordProcessAge=e.recordProcessAge),null!=e.recordProcessRuntime&&e.hasOwnProperty("recordProcessRuntime")&&(r.recordProcessRuntime=e.recordProcessRuntime),r},v.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},v.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.ProcessStatsConfig"},v.Quirks=(t={},(e=Object.create(t))[t[0]="QUIRKS_UNSPECIFIED"]=0,e[t[1]="DISABLE_INITIAL_DUMP"]=1,e[t[2]="DISABLE_ON_DEMAND"]=2,e),v),r.HeapprofdConfig=(E.prototype.samplingIntervalBytes=i.Long?i.Long.fromBits(0,0,!0):0,E.prototype.adaptiveSamplingShmemThreshold=i.Long?i.Long.fromBits(0,0,!0):0,E.prototype.adaptiveSamplingMaxSamplingIntervalBytes=i.Long?i.Long.fromBits(0,0,!0):0,E.prototype.processCmdline=i.emptyArray,E.prototype.pid=i.emptyArray,E.prototype.targetInstalledBy=i.emptyArray,E.prototype.heaps=i.emptyArray,E.prototype.excludeHeaps=i.emptyArray,E.prototype.streamAllocations=!1,E.prototype.heapSamplingIntervals=i.emptyArray,E.prototype.allHeaps=!1,E.prototype.all=!1,E.prototype.minAnonymousMemoryKb=0,E.prototype.maxHeapprofdMemoryKb=0,E.prototype.maxHeapprofdCpuSecs=i.Long?i.Long.fromBits(0,0,!0):0,E.prototype.skipSymbolPrefix=i.emptyArray,E.prototype.continuousDumpConfig=null,E.prototype.shmemSizeBytes=i.Long?i.Long.fromBits(0,0,!0):0,E.prototype.blockClient=!1,E.prototype.blockClientTimeoutUs=0,E.prototype.noStartup=!1,E.prototype.noRunning=!1,E.prototype.dumpAtMax=!1,E.prototype.disableForkTeardown=!1,E.prototype.disableVforkDetection=!1,E.create=function(e){return new E(e)},E.encode=function(e,t){if(t=t||a.create(),null!=e.samplingIntervalBytes&&Object.hasOwnProperty.call(e,"samplingIntervalBytes")&&t.uint32(8).uint64(e.samplingIntervalBytes),null!=e.processCmdline&&e.processCmdline.length)for(var r=0;r<e.processCmdline.length;++r)t.uint32(18).string(e.processCmdline[r]);if(null!=e.pid&&e.pid.length)for(r=0;r<e.pid.length;++r)t.uint32(32).uint64(e.pid[r]);if(null!=e.all&&Object.hasOwnProperty.call(e,"all")&&t.uint32(40).bool(e.all),null!=e.continuousDumpConfig&&Object.hasOwnProperty.call(e,"continuousDumpConfig")&&s.perfetto.protos.HeapprofdConfig.ContinuousDumpConfig.encode(e.continuousDumpConfig,t.uint32(50).fork()).ldelim(),null!=e.skipSymbolPrefix&&e.skipSymbolPrefix.length)for(r=0;r<e.skipSymbolPrefix.length;++r)t.uint32(58).string(e.skipSymbolPrefix[r]);if(null!=e.shmemSizeBytes&&Object.hasOwnProperty.call(e,"shmemSizeBytes")&&t.uint32(64).uint64(e.shmemSizeBytes),null!=e.blockClient&&Object.hasOwnProperty.call(e,"blockClient")&&t.uint32(72).bool(e.blockClient),null!=e.noStartup&&Object.hasOwnProperty.call(e,"noStartup")&&t.uint32(80).bool(e.noStartup),null!=e.noRunning&&Object.hasOwnProperty.call(e,"noRunning")&&t.uint32(88).bool(e.noRunning),null!=e.dumpAtMax&&Object.hasOwnProperty.call(e,"dumpAtMax")&&t.uint32(104).bool(e.dumpAtMax),null!=e.blockClientTimeoutUs&&Object.hasOwnProperty.call(e,"blockClientTimeoutUs")&&t.uint32(112).uint32(e.blockClientTimeoutUs),null!=e.minAnonymousMemoryKb&&Object.hasOwnProperty.call(e,"minAnonymousMemoryKb")&&t.uint32(120).uint32(e.minAnonymousMemoryKb),null!=e.maxHeapprofdMemoryKb&&Object.hasOwnProperty.call(e,"maxHeapprofdMemoryKb")&&t.uint32(128).uint32(e.maxHeapprofdMemoryKb),null!=e.maxHeapprofdCpuSecs&&Object.hasOwnProperty.call(e,"maxHeapprofdCpuSecs")&&t.uint32(136).uint64(e.maxHeapprofdCpuSecs),null!=e.disableForkTeardown&&Object.hasOwnProperty.call(e,"disableForkTeardown")&&t.uint32(144).bool(e.disableForkTeardown),null!=e.disableVforkDetection&&Object.hasOwnProperty.call(e,"disableVforkDetection")&&t.uint32(152).bool(e.disableVforkDetection),null!=e.heaps&&e.heaps.length)for(r=0;r<e.heaps.length;++r)t.uint32(162).string(e.heaps[r]);if(null!=e.allHeaps&&Object.hasOwnProperty.call(e,"allHeaps")&&t.uint32(168).bool(e.allHeaps),null!=e.heapSamplingIntervals&&e.heapSamplingIntervals.length)for(r=0;r<e.heapSamplingIntervals.length;++r)t.uint32(176).uint64(e.heapSamplingIntervals[r]);if(null!=e.streamAllocations&&Object.hasOwnProperty.call(e,"streamAllocations")&&t.uint32(184).bool(e.streamAllocations),null!=e.adaptiveSamplingShmemThreshold&&Object.hasOwnProperty.call(e,"adaptiveSamplingShmemThreshold")&&t.uint32(192).uint64(e.adaptiveSamplingShmemThreshold),null!=e.adaptiveSamplingMaxSamplingIntervalBytes&&Object.hasOwnProperty.call(e,"adaptiveSamplingMaxSamplingIntervalBytes")&&t.uint32(200).uint64(e.adaptiveSamplingMaxSamplingIntervalBytes),null!=e.targetInstalledBy&&e.targetInstalledBy.length)for(r=0;r<e.targetInstalledBy.length;++r)t.uint32(210).string(e.targetInstalledBy[r]);if(null!=e.excludeHeaps&&e.excludeHeaps.length)for(r=0;r<e.excludeHeaps.length;++r)t.uint32(218).string(e.excludeHeaps[r]);return t},E.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.HeapprofdConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.samplingIntervalBytes=e.uint64();break;case 24:n.adaptiveSamplingShmemThreshold=e.uint64();break;case 25:n.adaptiveSamplingMaxSamplingIntervalBytes=e.uint64();break;case 2:n.processCmdline&&n.processCmdline.length||(n.processCmdline=[]),n.processCmdline.push(e.string());break;case 4:if(n.pid&&n.pid.length||(n.pid=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.pid.push(e.uint64());else n.pid.push(e.uint64());break;case 26:n.targetInstalledBy&&n.targetInstalledBy.length||(n.targetInstalledBy=[]),n.targetInstalledBy.push(e.string());break;case 20:n.heaps&&n.heaps.length||(n.heaps=[]),n.heaps.push(e.string());break;case 27:n.excludeHeaps&&n.excludeHeaps.length||(n.excludeHeaps=[]),n.excludeHeaps.push(e.string());break;case 23:n.streamAllocations=e.bool();break;case 22:if(n.heapSamplingIntervals&&n.heapSamplingIntervals.length||(n.heapSamplingIntervals=[]),2==(7&a))for(i=e.uint32()+e.pos;e.pos<i;)n.heapSamplingIntervals.push(e.uint64());else n.heapSamplingIntervals.push(e.uint64());break;case 21:n.allHeaps=e.bool();break;case 5:n.all=e.bool();break;case 15:n.minAnonymousMemoryKb=e.uint32();break;case 16:n.maxHeapprofdMemoryKb=e.uint32();break;case 17:n.maxHeapprofdCpuSecs=e.uint64();break;case 7:n.skipSymbolPrefix&&n.skipSymbolPrefix.length||(n.skipSymbolPrefix=[]),n.skipSymbolPrefix.push(e.string());break;case 6:n.continuousDumpConfig=s.perfetto.protos.HeapprofdConfig.ContinuousDumpConfig.decode(e,e.uint32());break;case 8:n.shmemSizeBytes=e.uint64();break;case 9:n.blockClient=e.bool();break;case 14:n.blockClientTimeoutUs=e.uint32();break;case 10:n.noStartup=e.bool();break;case 11:n.noRunning=e.bool();break;case 13:n.dumpAtMax=e.bool();break;case 18:n.disableForkTeardown=e.bool();break;case 19:n.disableVforkDetection=e.bool();break;default:e.skipType(7&a)}}return n},E.fromObject=function(e){if(e instanceof s.perfetto.protos.HeapprofdConfig)return e;var t=new s.perfetto.protos.HeapprofdConfig;if(null!=e.samplingIntervalBytes&&(i.Long?(t.samplingIntervalBytes=i.Long.fromValue(e.samplingIntervalBytes)).unsigned=!0:"string"==typeof e.samplingIntervalBytes?t.samplingIntervalBytes=parseInt(e.samplingIntervalBytes,10):"number"==typeof e.samplingIntervalBytes?t.samplingIntervalBytes=e.samplingIntervalBytes:"object"==typeof e.samplingIntervalBytes&&(t.samplingIntervalBytes=new i.LongBits(e.samplingIntervalBytes.low>>>0,e.samplingIntervalBytes.high>>>0).toNumber(!0))),null!=e.adaptiveSamplingShmemThreshold&&(i.Long?(t.adaptiveSamplingShmemThreshold=i.Long.fromValue(e.adaptiveSamplingShmemThreshold)).unsigned=!0:"string"==typeof e.adaptiveSamplingShmemThreshold?t.adaptiveSamplingShmemThreshold=parseInt(e.adaptiveSamplingShmemThreshold,10):"number"==typeof e.adaptiveSamplingShmemThreshold?t.adaptiveSamplingShmemThreshold=e.adaptiveSamplingShmemThreshold:"object"==typeof e.adaptiveSamplingShmemThreshold&&(t.adaptiveSamplingShmemThreshold=new i.LongBits(e.adaptiveSamplingShmemThreshold.low>>>0,e.adaptiveSamplingShmemThreshold.high>>>0).toNumber(!0))),null!=e.adaptiveSamplingMaxSamplingIntervalBytes&&(i.Long?(t.adaptiveSamplingMaxSamplingIntervalBytes=i.Long.fromValue(e.adaptiveSamplingMaxSamplingIntervalBytes)).unsigned=!0:"string"==typeof e.adaptiveSamplingMaxSamplingIntervalBytes?t.adaptiveSamplingMaxSamplingIntervalBytes=parseInt(e.adaptiveSamplingMaxSamplingIntervalBytes,10):"number"==typeof e.adaptiveSamplingMaxSamplingIntervalBytes?t.adaptiveSamplingMaxSamplingIntervalBytes=e.adaptiveSamplingMaxSamplingIntervalBytes:"object"==typeof e.adaptiveSamplingMaxSamplingIntervalBytes&&(t.adaptiveSamplingMaxSamplingIntervalBytes=new i.LongBits(e.adaptiveSamplingMaxSamplingIntervalBytes.low>>>0,e.adaptiveSamplingMaxSamplingIntervalBytes.high>>>0).toNumber(!0))),e.processCmdline){if(!Array.isArray(e.processCmdline))throw TypeError(".perfetto.protos.HeapprofdConfig.processCmdline: array expected");t.processCmdline=[];for(var r=0;r<e.processCmdline.length;++r)t.processCmdline[r]=String(e.processCmdline[r])}if(e.pid){if(!Array.isArray(e.pid))throw TypeError(".perfetto.protos.HeapprofdConfig.pid: array expected");t.pid=[];for(r=0;r<e.pid.length;++r)i.Long?(t.pid[r]=i.Long.fromValue(e.pid[r])).unsigned=!0:"string"==typeof e.pid[r]?t.pid[r]=parseInt(e.pid[r],10):"number"==typeof e.pid[r]?t.pid[r]=e.pid[r]:"object"==typeof e.pid[r]&&(t.pid[r]=new i.LongBits(e.pid[r].low>>>0,e.pid[r].high>>>0).toNumber(!0))}if(e.targetInstalledBy){if(!Array.isArray(e.targetInstalledBy))throw TypeError(".perfetto.protos.HeapprofdConfig.targetInstalledBy: array expected");t.targetInstalledBy=[];for(r=0;r<e.targetInstalledBy.length;++r)t.targetInstalledBy[r]=String(e.targetInstalledBy[r])}if(e.heaps){if(!Array.isArray(e.heaps))throw TypeError(".perfetto.protos.HeapprofdConfig.heaps: array expected");t.heaps=[];for(r=0;r<e.heaps.length;++r)t.heaps[r]=String(e.heaps[r])}if(e.excludeHeaps){if(!Array.isArray(e.excludeHeaps))throw TypeError(".perfetto.protos.HeapprofdConfig.excludeHeaps: array expected");t.excludeHeaps=[];for(r=0;r<e.excludeHeaps.length;++r)t.excludeHeaps[r]=String(e.excludeHeaps[r])}if(null!=e.streamAllocations&&(t.streamAllocations=Boolean(e.streamAllocations)),e.heapSamplingIntervals){if(!Array.isArray(e.heapSamplingIntervals))throw TypeError(".perfetto.protos.HeapprofdConfig.heapSamplingIntervals: array expected");t.heapSamplingIntervals=[];for(r=0;r<e.heapSamplingIntervals.length;++r)i.Long?(t.heapSamplingIntervals[r]=i.Long.fromValue(e.heapSamplingIntervals[r])).unsigned=!0:"string"==typeof e.heapSamplingIntervals[r]?t.heapSamplingIntervals[r]=parseInt(e.heapSamplingIntervals[r],10):"number"==typeof e.heapSamplingIntervals[r]?t.heapSamplingIntervals[r]=e.heapSamplingIntervals[r]:"object"==typeof e.heapSamplingIntervals[r]&&(t.heapSamplingIntervals[r]=new i.LongBits(e.heapSamplingIntervals[r].low>>>0,e.heapSamplingIntervals[r].high>>>0).toNumber(!0))}if(null!=e.allHeaps&&(t.allHeaps=Boolean(e.allHeaps)),null!=e.all&&(t.all=Boolean(e.all)),null!=e.minAnonymousMemoryKb&&(t.minAnonymousMemoryKb=e.minAnonymousMemoryKb>>>0),null!=e.maxHeapprofdMemoryKb&&(t.maxHeapprofdMemoryKb=e.maxHeapprofdMemoryKb>>>0),null!=e.maxHeapprofdCpuSecs&&(i.Long?(t.maxHeapprofdCpuSecs=i.Long.fromValue(e.maxHeapprofdCpuSecs)).unsigned=!0:"string"==typeof e.maxHeapprofdCpuSecs?t.maxHeapprofdCpuSecs=parseInt(e.maxHeapprofdCpuSecs,10):"number"==typeof e.maxHeapprofdCpuSecs?t.maxHeapprofdCpuSecs=e.maxHeapprofdCpuSecs:"object"==typeof e.maxHeapprofdCpuSecs&&(t.maxHeapprofdCpuSecs=new i.LongBits(e.maxHeapprofdCpuSecs.low>>>0,e.maxHeapprofdCpuSecs.high>>>0).toNumber(!0))),e.skipSymbolPrefix){if(!Array.isArray(e.skipSymbolPrefix))throw TypeError(".perfetto.protos.HeapprofdConfig.skipSymbolPrefix: array expected");t.skipSymbolPrefix=[];for(r=0;r<e.skipSymbolPrefix.length;++r)t.skipSymbolPrefix[r]=String(e.skipSymbolPrefix[r])}if(null!=e.continuousDumpConfig){if("object"!=typeof e.continuousDumpConfig)throw TypeError(".perfetto.protos.HeapprofdConfig.continuousDumpConfig: object expected");t.continuousDumpConfig=s.perfetto.protos.HeapprofdConfig.ContinuousDumpConfig.fromObject(e.continuousDumpConfig)}return null!=e.shmemSizeBytes&&(i.Long?(t.shmemSizeBytes=i.Long.fromValue(e.shmemSizeBytes)).unsigned=!0:"string"==typeof e.shmemSizeBytes?t.shmemSizeBytes=parseInt(e.shmemSizeBytes,10):"number"==typeof e.shmemSizeBytes?t.shmemSizeBytes=e.shmemSizeBytes:"object"==typeof e.shmemSizeBytes&&(t.shmemSizeBytes=new i.LongBits(e.shmemSizeBytes.low>>>0,e.shmemSizeBytes.high>>>0).toNumber(!0))),null!=e.blockClient&&(t.blockClient=Boolean(e.blockClient)),null!=e.blockClientTimeoutUs&&(t.blockClientTimeoutUs=e.blockClientTimeoutUs>>>0),null!=e.noStartup&&(t.noStartup=Boolean(e.noStartup)),null!=e.noRunning&&(t.noRunning=Boolean(e.noRunning)),null!=e.dumpAtMax&&(t.dumpAtMax=Boolean(e.dumpAtMax)),null!=e.disableForkTeardown&&(t.disableForkTeardown=Boolean(e.disableForkTeardown)),null!=e.disableVforkDetection&&(t.disableVforkDetection=Boolean(e.disableVforkDetection)),t},E.toObject=function(e,t){var r,n={};if(((t=t||{}).arrays||t.defaults)&&(n.processCmdline=[],n.pid=[],n.skipSymbolPrefix=[],n.heaps=[],n.heapSamplingIntervals=[],n.targetInstalledBy=[],n.excludeHeaps=[]),t.defaults&&(i.Long?(r=new i.Long(0,0,!0),n.samplingIntervalBytes=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.samplingIntervalBytes=t.longs===String?"0":0,n.all=!1,n.continuousDumpConfig=null,i.Long?(r=new i.Long(0,0,!0),n.shmemSizeBytes=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.shmemSizeBytes=t.longs===String?"0":0,n.blockClient=!1,n.noStartup=!1,n.noRunning=!1,n.dumpAtMax=!1,n.blockClientTimeoutUs=0,n.minAnonymousMemoryKb=0,n.maxHeapprofdMemoryKb=0,i.Long?(r=new i.Long(0,0,!0),n.maxHeapprofdCpuSecs=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.maxHeapprofdCpuSecs=t.longs===String?"0":0,n.disableForkTeardown=!1,n.disableVforkDetection=!1,n.allHeaps=!1,n.streamAllocations=!1,i.Long?(r=new i.Long(0,0,!0),n.adaptiveSamplingShmemThreshold=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.adaptiveSamplingShmemThreshold=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.adaptiveSamplingMaxSamplingIntervalBytes=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.adaptiveSamplingMaxSamplingIntervalBytes=t.longs===String?"0":0),null!=e.samplingIntervalBytes&&e.hasOwnProperty("samplingIntervalBytes")&&("number"==typeof e.samplingIntervalBytes?n.samplingIntervalBytes=t.longs===String?String(e.samplingIntervalBytes):e.samplingIntervalBytes:n.samplingIntervalBytes=t.longs===String?i.Long.prototype.toString.call(e.samplingIntervalBytes):t.longs===Number?new i.LongBits(e.samplingIntervalBytes.low>>>0,e.samplingIntervalBytes.high>>>0).toNumber(!0):e.samplingIntervalBytes),e.processCmdline&&e.processCmdline.length){n.processCmdline=[];for(var a=0;a<e.processCmdline.length;++a)n.processCmdline[a]=e.processCmdline[a]}if(e.pid&&e.pid.length){n.pid=[];for(a=0;a<e.pid.length;++a)"number"==typeof e.pid[a]?n.pid[a]=t.longs===String?String(e.pid[a]):e.pid[a]:n.pid[a]=t.longs===String?i.Long.prototype.toString.call(e.pid[a]):t.longs===Number?new i.LongBits(e.pid[a].low>>>0,e.pid[a].high>>>0).toNumber(!0):e.pid[a]}if(null!=e.all&&e.hasOwnProperty("all")&&(n.all=e.all),null!=e.continuousDumpConfig&&e.hasOwnProperty("continuousDumpConfig")&&(n.continuousDumpConfig=s.perfetto.protos.HeapprofdConfig.ContinuousDumpConfig.toObject(e.continuousDumpConfig,t)),e.skipSymbolPrefix&&e.skipSymbolPrefix.length){n.skipSymbolPrefix=[];for(a=0;a<e.skipSymbolPrefix.length;++a)n.skipSymbolPrefix[a]=e.skipSymbolPrefix[a]}if(null!=e.shmemSizeBytes&&e.hasOwnProperty("shmemSizeBytes")&&("number"==typeof e.shmemSizeBytes?n.shmemSizeBytes=t.longs===String?String(e.shmemSizeBytes):e.shmemSizeBytes:n.shmemSizeBytes=t.longs===String?i.Long.prototype.toString.call(e.shmemSizeBytes):t.longs===Number?new i.LongBits(e.shmemSizeBytes.low>>>0,e.shmemSizeBytes.high>>>0).toNumber(!0):e.shmemSizeBytes),null!=e.blockClient&&e.hasOwnProperty("blockClient")&&(n.blockClient=e.blockClient),null!=e.noStartup&&e.hasOwnProperty("noStartup")&&(n.noStartup=e.noStartup),null!=e.noRunning&&e.hasOwnProperty("noRunning")&&(n.noRunning=e.noRunning),null!=e.dumpAtMax&&e.hasOwnProperty("dumpAtMax")&&(n.dumpAtMax=e.dumpAtMax),null!=e.blockClientTimeoutUs&&e.hasOwnProperty("blockClientTimeoutUs")&&(n.blockClientTimeoutUs=e.blockClientTimeoutUs),null!=e.minAnonymousMemoryKb&&e.hasOwnProperty("minAnonymousMemoryKb")&&(n.minAnonymousMemoryKb=e.minAnonymousMemoryKb),null!=e.maxHeapprofdMemoryKb&&e.hasOwnProperty("maxHeapprofdMemoryKb")&&(n.maxHeapprofdMemoryKb=e.maxHeapprofdMemoryKb),null!=e.maxHeapprofdCpuSecs&&e.hasOwnProperty("maxHeapprofdCpuSecs")&&("number"==typeof e.maxHeapprofdCpuSecs?n.maxHeapprofdCpuSecs=t.longs===String?String(e.maxHeapprofdCpuSecs):e.maxHeapprofdCpuSecs:n.maxHeapprofdCpuSecs=t.longs===String?i.Long.prototype.toString.call(e.maxHeapprofdCpuSecs):t.longs===Number?new i.LongBits(e.maxHeapprofdCpuSecs.low>>>0,e.maxHeapprofdCpuSecs.high>>>0).toNumber(!0):e.maxHeapprofdCpuSecs),null!=e.disableForkTeardown&&e.hasOwnProperty("disableForkTeardown")&&(n.disableForkTeardown=e.disableForkTeardown),null!=e.disableVforkDetection&&e.hasOwnProperty("disableVforkDetection")&&(n.disableVforkDetection=e.disableVforkDetection),e.heaps&&e.heaps.length){n.heaps=[];for(a=0;a<e.heaps.length;++a)n.heaps[a]=e.heaps[a]}if(null!=e.allHeaps&&e.hasOwnProperty("allHeaps")&&(n.allHeaps=e.allHeaps),e.heapSamplingIntervals&&e.heapSamplingIntervals.length){n.heapSamplingIntervals=[];for(a=0;a<e.heapSamplingIntervals.length;++a)"number"==typeof e.heapSamplingIntervals[a]?n.heapSamplingIntervals[a]=t.longs===String?String(e.heapSamplingIntervals[a]):e.heapSamplingIntervals[a]:n.heapSamplingIntervals[a]=t.longs===String?i.Long.prototype.toString.call(e.heapSamplingIntervals[a]):t.longs===Number?new i.LongBits(e.heapSamplingIntervals[a].low>>>0,e.heapSamplingIntervals[a].high>>>0).toNumber(!0):e.heapSamplingIntervals[a]}if(null!=e.streamAllocations&&e.hasOwnProperty("streamAllocations")&&(n.streamAllocations=e.streamAllocations),null!=e.adaptiveSamplingShmemThreshold&&e.hasOwnProperty("adaptiveSamplingShmemThreshold")&&("number"==typeof e.adaptiveSamplingShmemThreshold?n.adaptiveSamplingShmemThreshold=t.longs===String?String(e.adaptiveSamplingShmemThreshold):e.adaptiveSamplingShmemThreshold:n.adaptiveSamplingShmemThreshold=t.longs===String?i.Long.prototype.toString.call(e.adaptiveSamplingShmemThreshold):t.longs===Number?new i.LongBits(e.adaptiveSamplingShmemThreshold.low>>>0,e.adaptiveSamplingShmemThreshold.high>>>0).toNumber(!0):e.adaptiveSamplingShmemThreshold),null!=e.adaptiveSamplingMaxSamplingIntervalBytes&&e.hasOwnProperty("adaptiveSamplingMaxSamplingIntervalBytes")&&("number"==typeof e.adaptiveSamplingMaxSamplingIntervalBytes?n.adaptiveSamplingMaxSamplingIntervalBytes=t.longs===String?String(e.adaptiveSamplingMaxSamplingIntervalBytes):e.adaptiveSamplingMaxSamplingIntervalBytes:n.adaptiveSamplingMaxSamplingIntervalBytes=t.longs===String?i.Long.prototype.toString.call(e.adaptiveSamplingMaxSamplingIntervalBytes):t.longs===Number?new i.LongBits(e.adaptiveSamplingMaxSamplingIntervalBytes.low>>>0,e.adaptiveSamplingMaxSamplingIntervalBytes.high>>>0).toNumber(!0):e.adaptiveSamplingMaxSamplingIntervalBytes),e.targetInstalledBy&&e.targetInstalledBy.length){n.targetInstalledBy=[];for(a=0;a<e.targetInstalledBy.length;++a)n.targetInstalledBy[a]=e.targetInstalledBy[a]}if(e.excludeHeaps&&e.excludeHeaps.length){n.excludeHeaps=[];for(a=0;a<e.excludeHeaps.length;++a)n.excludeHeaps[a]=e.excludeHeaps[a]}return n},E.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},E.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.HeapprofdConfig"},E.ContinuousDumpConfig=(Tt.prototype.dumpPhaseMs=0,Tt.prototype.dumpIntervalMs=0,Tt.create=function(e){return new Tt(e)},Tt.encode=function(e,t){return t=t||a.create(),null!=e.dumpPhaseMs&&Object.hasOwnProperty.call(e,"dumpPhaseMs")&&t.uint32(40).uint32(e.dumpPhaseMs),null!=e.dumpIntervalMs&&Object.hasOwnProperty.call(e,"dumpIntervalMs")&&t.uint32(48).uint32(e.dumpIntervalMs),t},Tt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.HeapprofdConfig.ContinuousDumpConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 5:n.dumpPhaseMs=e.uint32();break;case 6:n.dumpIntervalMs=e.uint32();break;default:e.skipType(7&a)}}return n},Tt.fromObject=function(e){var t;return e instanceof s.perfetto.protos.HeapprofdConfig.ContinuousDumpConfig?e:(t=new s.perfetto.protos.HeapprofdConfig.ContinuousDumpConfig,null!=e.dumpPhaseMs&&(t.dumpPhaseMs=e.dumpPhaseMs>>>0),null!=e.dumpIntervalMs&&(t.dumpIntervalMs=e.dumpIntervalMs>>>0),t)},Tt.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.dumpPhaseMs=0,r.dumpIntervalMs=0),null!=e.dumpPhaseMs&&e.hasOwnProperty("dumpPhaseMs")&&(r.dumpPhaseMs=e.dumpPhaseMs),null!=e.dumpIntervalMs&&e.hasOwnProperty("dumpIntervalMs")&&(r.dumpIntervalMs=e.dumpIntervalMs),r},Tt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Tt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.HeapprofdConfig.ContinuousDumpConfig"},Tt),E),r.JavaHprofConfig=(S.prototype.processCmdline=i.emptyArray,S.prototype.pid=i.emptyArray,S.prototype.targetInstalledBy=i.emptyArray,S.prototype.continuousDumpConfig=null,S.prototype.minAnonymousMemoryKb=0,S.prototype.dumpSmaps=!1,S.prototype.ignoredTypes=i.emptyArray,S.create=function(e){return new S(e)},S.encode=function(e,t){if(t=t||a.create(),null!=e.processCmdline&&e.processCmdline.length)for(var r=0;r<e.processCmdline.length;++r)t.uint32(10).string(e.processCmdline[r]);if(null!=e.pid&&e.pid.length)for(r=0;r<e.pid.length;++r)t.uint32(16).uint64(e.pid[r]);if(null!=e.continuousDumpConfig&&Object.hasOwnProperty.call(e,"continuousDumpConfig")&&s.perfetto.protos.JavaHprofConfig.ContinuousDumpConfig.encode(e.continuousDumpConfig,t.uint32(26).fork()).ldelim(),null!=e.minAnonymousMemoryKb&&Object.hasOwnProperty.call(e,"minAnonymousMemoryKb")&&t.uint32(32).uint32(e.minAnonymousMemoryKb),null!=e.dumpSmaps&&Object.hasOwnProperty.call(e,"dumpSmaps")&&t.uint32(40).bool(e.dumpSmaps),null!=e.ignoredTypes&&e.ignoredTypes.length)for(r=0;r<e.ignoredTypes.length;++r)t.uint32(50).string(e.ignoredTypes[r]);if(null!=e.targetInstalledBy&&e.targetInstalledBy.length)for(r=0;r<e.targetInstalledBy.length;++r)t.uint32(58).string(e.targetInstalledBy[r]);return t},S.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.JavaHprofConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.processCmdline&&n.processCmdline.length||(n.processCmdline=[]),n.processCmdline.push(e.string());break;case 2:if(n.pid&&n.pid.length||(n.pid=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.pid.push(e.uint64());else n.pid.push(e.uint64());break;case 7:n.targetInstalledBy&&n.targetInstalledBy.length||(n.targetInstalledBy=[]),n.targetInstalledBy.push(e.string());break;case 3:n.continuousDumpConfig=s.perfetto.protos.JavaHprofConfig.ContinuousDumpConfig.decode(e,e.uint32());break;case 4:n.minAnonymousMemoryKb=e.uint32();break;case 5:n.dumpSmaps=e.bool();break;case 6:n.ignoredTypes&&n.ignoredTypes.length||(n.ignoredTypes=[]),n.ignoredTypes.push(e.string());break;default:e.skipType(7&a)}}return n},S.fromObject=function(e){if(e instanceof s.perfetto.protos.JavaHprofConfig)return e;var t=new s.perfetto.protos.JavaHprofConfig;if(e.processCmdline){if(!Array.isArray(e.processCmdline))throw TypeError(".perfetto.protos.JavaHprofConfig.processCmdline: array expected");t.processCmdline=[];for(var r=0;r<e.processCmdline.length;++r)t.processCmdline[r]=String(e.processCmdline[r])}if(e.pid){if(!Array.isArray(e.pid))throw TypeError(".perfetto.protos.JavaHprofConfig.pid: array expected");t.pid=[];for(r=0;r<e.pid.length;++r)i.Long?(t.pid[r]=i.Long.fromValue(e.pid[r])).unsigned=!0:"string"==typeof e.pid[r]?t.pid[r]=parseInt(e.pid[r],10):"number"==typeof e.pid[r]?t.pid[r]=e.pid[r]:"object"==typeof e.pid[r]&&(t.pid[r]=new i.LongBits(e.pid[r].low>>>0,e.pid[r].high>>>0).toNumber(!0))}if(e.targetInstalledBy){if(!Array.isArray(e.targetInstalledBy))throw TypeError(".perfetto.protos.JavaHprofConfig.targetInstalledBy: array expected");t.targetInstalledBy=[];for(r=0;r<e.targetInstalledBy.length;++r)t.targetInstalledBy[r]=String(e.targetInstalledBy[r])}if(null!=e.continuousDumpConfig){if("object"!=typeof e.continuousDumpConfig)throw TypeError(".perfetto.protos.JavaHprofConfig.continuousDumpConfig: object expected");t.continuousDumpConfig=s.perfetto.protos.JavaHprofConfig.ContinuousDumpConfig.fromObject(e.continuousDumpConfig)}if(null!=e.minAnonymousMemoryKb&&(t.minAnonymousMemoryKb=e.minAnonymousMemoryKb>>>0),null!=e.dumpSmaps&&(t.dumpSmaps=Boolean(e.dumpSmaps)),e.ignoredTypes){if(!Array.isArray(e.ignoredTypes))throw TypeError(".perfetto.protos.JavaHprofConfig.ignoredTypes: array expected");t.ignoredTypes=[];for(r=0;r<e.ignoredTypes.length;++r)t.ignoredTypes[r]=String(e.ignoredTypes[r])}return t},S.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.processCmdline=[],r.pid=[],r.ignoredTypes=[],r.targetInstalledBy=[]),t.defaults&&(r.continuousDumpConfig=null,r.minAnonymousMemoryKb=0,r.dumpSmaps=!1),e.processCmdline&&e.processCmdline.length){r.processCmdline=[];for(var n=0;n<e.processCmdline.length;++n)r.processCmdline[n]=e.processCmdline[n]}if(e.pid&&e.pid.length){r.pid=[];for(n=0;n<e.pid.length;++n)"number"==typeof e.pid[n]?r.pid[n]=t.longs===String?String(e.pid[n]):e.pid[n]:r.pid[n]=t.longs===String?i.Long.prototype.toString.call(e.pid[n]):t.longs===Number?new i.LongBits(e.pid[n].low>>>0,e.pid[n].high>>>0).toNumber(!0):e.pid[n]}if(null!=e.continuousDumpConfig&&e.hasOwnProperty("continuousDumpConfig")&&(r.continuousDumpConfig=s.perfetto.protos.JavaHprofConfig.ContinuousDumpConfig.toObject(e.continuousDumpConfig,t)),null!=e.minAnonymousMemoryKb&&e.hasOwnProperty("minAnonymousMemoryKb")&&(r.minAnonymousMemoryKb=e.minAnonymousMemoryKb),null!=e.dumpSmaps&&e.hasOwnProperty("dumpSmaps")&&(r.dumpSmaps=e.dumpSmaps),e.ignoredTypes&&e.ignoredTypes.length){r.ignoredTypes=[];for(n=0;n<e.ignoredTypes.length;++n)r.ignoredTypes[n]=e.ignoredTypes[n]}if(e.targetInstalledBy&&e.targetInstalledBy.length){r.targetInstalledBy=[];for(n=0;n<e.targetInstalledBy.length;++n)r.targetInstalledBy[n]=e.targetInstalledBy[n]}return r},S.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},S.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.JavaHprofConfig"},S.ContinuousDumpConfig=(bt.prototype.dumpPhaseMs=0,bt.prototype.dumpIntervalMs=0,bt.prototype.scanPidsOnlyOnStart=!1,bt.create=function(e){return new bt(e)},bt.encode=function(e,t){return t=t||a.create(),null!=e.dumpPhaseMs&&Object.hasOwnProperty.call(e,"dumpPhaseMs")&&t.uint32(8).uint32(e.dumpPhaseMs),null!=e.dumpIntervalMs&&Object.hasOwnProperty.call(e,"dumpIntervalMs")&&t.uint32(16).uint32(e.dumpIntervalMs),null!=e.scanPidsOnlyOnStart&&Object.hasOwnProperty.call(e,"scanPidsOnlyOnStart")&&t.uint32(24).bool(e.scanPidsOnlyOnStart),t},bt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.JavaHprofConfig.ContinuousDumpConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.dumpPhaseMs=e.uint32();break;case 2:n.dumpIntervalMs=e.uint32();break;case 3:n.scanPidsOnlyOnStart=e.bool();break;default:e.skipType(7&a)}}return n},bt.fromObject=function(e){var t;return e instanceof s.perfetto.protos.JavaHprofConfig.ContinuousDumpConfig?e:(t=new s.perfetto.protos.JavaHprofConfig.ContinuousDumpConfig,null!=e.dumpPhaseMs&&(t.dumpPhaseMs=e.dumpPhaseMs>>>0),null!=e.dumpIntervalMs&&(t.dumpIntervalMs=e.dumpIntervalMs>>>0),null!=e.scanPidsOnlyOnStart&&(t.scanPidsOnlyOnStart=Boolean(e.scanPidsOnlyOnStart)),t)},bt.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.dumpPhaseMs=0,r.dumpIntervalMs=0,r.scanPidsOnlyOnStart=!1),null!=e.dumpPhaseMs&&e.hasOwnProperty("dumpPhaseMs")&&(r.dumpPhaseMs=e.dumpPhaseMs),null!=e.dumpIntervalMs&&e.hasOwnProperty("dumpIntervalMs")&&(r.dumpIntervalMs=e.dumpIntervalMs),null!=e.scanPidsOnlyOnStart&&e.hasOwnProperty("scanPidsOnlyOnStart")&&(r.scanPidsOnlyOnStart=e.scanPidsOnlyOnStart),r},bt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},bt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.JavaHprofConfig.ContinuousDumpConfig"},bt),S),r.PerfEventConfig=(A.prototype.timebase=null,A.prototype.callstackSampling=null,A.prototype.ringBufferReadPeriodMs=0,A.prototype.ringBufferPages=0,A.prototype.maxEnqueuedFootprintKb=i.Long?i.Long.fromBits(0,0,!0):0,A.prototype.maxDaemonMemoryKb=0,A.prototype.remoteDescriptorTimeoutMs=0,A.prototype.unwindStateClearPeriodMs=0,A.prototype.targetInstalledBy=i.emptyArray,A.prototype.allCpus=!1,A.prototype.samplingFrequency=0,A.prototype.kernelFrames=!1,A.prototype.targetPid=i.emptyArray,A.prototype.targetCmdline=i.emptyArray,A.prototype.excludePid=i.emptyArray,A.prototype.excludeCmdline=i.emptyArray,A.prototype.additionalCmdlineCount=0,A.create=function(e){return new A(e)},A.encode=function(e,t){if(t=t||a.create(),null!=e.allCpus&&Object.hasOwnProperty.call(e,"allCpus")&&t.uint32(8).bool(e.allCpus),null!=e.samplingFrequency&&Object.hasOwnProperty.call(e,"samplingFrequency")&&t.uint32(16).uint32(e.samplingFrequency),null!=e.ringBufferPages&&Object.hasOwnProperty.call(e,"ringBufferPages")&&t.uint32(24).uint32(e.ringBufferPages),null!=e.targetPid&&e.targetPid.length)for(var r=0;r<e.targetPid.length;++r)t.uint32(32).int32(e.targetPid[r]);if(null!=e.targetCmdline&&e.targetCmdline.length)for(r=0;r<e.targetCmdline.length;++r)t.uint32(42).string(e.targetCmdline[r]);if(null!=e.excludePid&&e.excludePid.length)for(r=0;r<e.excludePid.length;++r)t.uint32(48).int32(e.excludePid[r]);if(null!=e.excludeCmdline&&e.excludeCmdline.length)for(r=0;r<e.excludeCmdline.length;++r)t.uint32(58).string(e.excludeCmdline[r]);if(null!=e.ringBufferReadPeriodMs&&Object.hasOwnProperty.call(e,"ringBufferReadPeriodMs")&&t.uint32(64).uint32(e.ringBufferReadPeriodMs),null!=e.remoteDescriptorTimeoutMs&&Object.hasOwnProperty.call(e,"remoteDescriptorTimeoutMs")&&t.uint32(72).uint32(e.remoteDescriptorTimeoutMs),null!=e.unwindStateClearPeriodMs&&Object.hasOwnProperty.call(e,"unwindStateClearPeriodMs")&&t.uint32(80).uint32(e.unwindStateClearPeriodMs),null!=e.additionalCmdlineCount&&Object.hasOwnProperty.call(e,"additionalCmdlineCount")&&t.uint32(88).uint32(e.additionalCmdlineCount),null!=e.kernelFrames&&Object.hasOwnProperty.call(e,"kernelFrames")&&t.uint32(96).bool(e.kernelFrames),null!=e.maxDaemonMemoryKb&&Object.hasOwnProperty.call(e,"maxDaemonMemoryKb")&&t.uint32(104).uint32(e.maxDaemonMemoryKb),null!=e.timebase&&Object.hasOwnProperty.call(e,"timebase")&&s.perfetto.protos.PerfEvents.Timebase.encode(e.timebase,t.uint32(122).fork()).ldelim(),null!=e.callstackSampling&&Object.hasOwnProperty.call(e,"callstackSampling")&&s.perfetto.protos.PerfEventConfig.CallstackSampling.encode(e.callstackSampling,t.uint32(130).fork()).ldelim(),null!=e.maxEnqueuedFootprintKb&&Object.hasOwnProperty.call(e,"maxEnqueuedFootprintKb")&&t.uint32(136).uint64(e.maxEnqueuedFootprintKb),null!=e.targetInstalledBy&&e.targetInstalledBy.length)for(r=0;r<e.targetInstalledBy.length;++r)t.uint32(146).string(e.targetInstalledBy[r]);return t},A.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.PerfEventConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 15:n.timebase=s.perfetto.protos.PerfEvents.Timebase.decode(e,e.uint32());break;case 16:n.callstackSampling=s.perfetto.protos.PerfEventConfig.CallstackSampling.decode(e,e.uint32());break;case 8:n.ringBufferReadPeriodMs=e.uint32();break;case 3:n.ringBufferPages=e.uint32();break;case 17:n.maxEnqueuedFootprintKb=e.uint64();break;case 13:n.maxDaemonMemoryKb=e.uint32();break;case 9:n.remoteDescriptorTimeoutMs=e.uint32();break;case 10:n.unwindStateClearPeriodMs=e.uint32();break;case 18:n.targetInstalledBy&&n.targetInstalledBy.length||(n.targetInstalledBy=[]),n.targetInstalledBy.push(e.string());break;case 1:n.allCpus=e.bool();break;case 2:n.samplingFrequency=e.uint32();break;case 12:n.kernelFrames=e.bool();break;case 4:if(n.targetPid&&n.targetPid.length||(n.targetPid=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.targetPid.push(e.int32());else n.targetPid.push(e.int32());break;case 5:n.targetCmdline&&n.targetCmdline.length||(n.targetCmdline=[]),n.targetCmdline.push(e.string());break;case 6:if(n.excludePid&&n.excludePid.length||(n.excludePid=[]),2==(7&a))for(i=e.uint32()+e.pos;e.pos<i;)n.excludePid.push(e.int32());else n.excludePid.push(e.int32());break;case 7:n.excludeCmdline&&n.excludeCmdline.length||(n.excludeCmdline=[]),n.excludeCmdline.push(e.string());break;case 11:n.additionalCmdlineCount=e.uint32();break;default:e.skipType(7&a)}}return n},A.fromObject=function(e){if(e instanceof s.perfetto.protos.PerfEventConfig)return e;var t=new s.perfetto.protos.PerfEventConfig;if(null!=e.timebase){if("object"!=typeof e.timebase)throw TypeError(".perfetto.protos.PerfEventConfig.timebase: object expected");t.timebase=s.perfetto.protos.PerfEvents.Timebase.fromObject(e.timebase)}if(null!=e.callstackSampling){if("object"!=typeof e.callstackSampling)throw TypeError(".perfetto.protos.PerfEventConfig.callstackSampling: object expected");t.callstackSampling=s.perfetto.protos.PerfEventConfig.CallstackSampling.fromObject(e.callstackSampling)}if(null!=e.ringBufferReadPeriodMs&&(t.ringBufferReadPeriodMs=e.ringBufferReadPeriodMs>>>0),null!=e.ringBufferPages&&(t.ringBufferPages=e.ringBufferPages>>>0),null!=e.maxEnqueuedFootprintKb&&(i.Long?(t.maxEnqueuedFootprintKb=i.Long.fromValue(e.maxEnqueuedFootprintKb)).unsigned=!0:"string"==typeof e.maxEnqueuedFootprintKb?t.maxEnqueuedFootprintKb=parseInt(e.maxEnqueuedFootprintKb,10):"number"==typeof e.maxEnqueuedFootprintKb?t.maxEnqueuedFootprintKb=e.maxEnqueuedFootprintKb:"object"==typeof e.maxEnqueuedFootprintKb&&(t.maxEnqueuedFootprintKb=new i.LongBits(e.maxEnqueuedFootprintKb.low>>>0,e.maxEnqueuedFootprintKb.high>>>0).toNumber(!0))),null!=e.maxDaemonMemoryKb&&(t.maxDaemonMemoryKb=e.maxDaemonMemoryKb>>>0),null!=e.remoteDescriptorTimeoutMs&&(t.remoteDescriptorTimeoutMs=e.remoteDescriptorTimeoutMs>>>0),null!=e.unwindStateClearPeriodMs&&(t.unwindStateClearPeriodMs=e.unwindStateClearPeriodMs>>>0),e.targetInstalledBy){if(!Array.isArray(e.targetInstalledBy))throw TypeError(".perfetto.protos.PerfEventConfig.targetInstalledBy: array expected");t.targetInstalledBy=[];for(var r=0;r<e.targetInstalledBy.length;++r)t.targetInstalledBy[r]=String(e.targetInstalledBy[r])}if(null!=e.allCpus&&(t.allCpus=Boolean(e.allCpus)),null!=e.samplingFrequency&&(t.samplingFrequency=e.samplingFrequency>>>0),null!=e.kernelFrames&&(t.kernelFrames=Boolean(e.kernelFrames)),e.targetPid){if(!Array.isArray(e.targetPid))throw TypeError(".perfetto.protos.PerfEventConfig.targetPid: array expected");t.targetPid=[];for(r=0;r<e.targetPid.length;++r)t.targetPid[r]=0|e.targetPid[r]}if(e.targetCmdline){if(!Array.isArray(e.targetCmdline))throw TypeError(".perfetto.protos.PerfEventConfig.targetCmdline: array expected");t.targetCmdline=[];for(r=0;r<e.targetCmdline.length;++r)t.targetCmdline[r]=String(e.targetCmdline[r])}if(e.excludePid){if(!Array.isArray(e.excludePid))throw TypeError(".perfetto.protos.PerfEventConfig.excludePid: array expected");t.excludePid=[];for(r=0;r<e.excludePid.length;++r)t.excludePid[r]=0|e.excludePid[r]}if(e.excludeCmdline){if(!Array.isArray(e.excludeCmdline))throw TypeError(".perfetto.protos.PerfEventConfig.excludeCmdline: array expected");t.excludeCmdline=[];for(r=0;r<e.excludeCmdline.length;++r)t.excludeCmdline[r]=String(e.excludeCmdline[r])}return null!=e.additionalCmdlineCount&&(t.additionalCmdlineCount=e.additionalCmdlineCount>>>0),t},A.toObject=function(e,t){var r,n={};if(((t=t||{}).arrays||t.defaults)&&(n.targetPid=[],n.targetCmdline=[],n.excludePid=[],n.excludeCmdline=[],n.targetInstalledBy=[]),t.defaults&&(n.allCpus=!1,n.samplingFrequency=0,n.ringBufferPages=0,n.ringBufferReadPeriodMs=0,n.remoteDescriptorTimeoutMs=0,n.unwindStateClearPeriodMs=0,n.additionalCmdlineCount=0,n.kernelFrames=!1,n.maxDaemonMemoryKb=0,n.timebase=null,n.callstackSampling=null,i.Long?(r=new i.Long(0,0,!0),n.maxEnqueuedFootprintKb=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.maxEnqueuedFootprintKb=t.longs===String?"0":0),null!=e.allCpus&&e.hasOwnProperty("allCpus")&&(n.allCpus=e.allCpus),null!=e.samplingFrequency&&e.hasOwnProperty("samplingFrequency")&&(n.samplingFrequency=e.samplingFrequency),null!=e.ringBufferPages&&e.hasOwnProperty("ringBufferPages")&&(n.ringBufferPages=e.ringBufferPages),e.targetPid&&e.targetPid.length){n.targetPid=[];for(var a=0;a<e.targetPid.length;++a)n.targetPid[a]=e.targetPid[a]}if(e.targetCmdline&&e.targetCmdline.length){n.targetCmdline=[];for(a=0;a<e.targetCmdline.length;++a)n.targetCmdline[a]=e.targetCmdline[a]}if(e.excludePid&&e.excludePid.length){n.excludePid=[];for(a=0;a<e.excludePid.length;++a)n.excludePid[a]=e.excludePid[a]}if(e.excludeCmdline&&e.excludeCmdline.length){n.excludeCmdline=[];for(a=0;a<e.excludeCmdline.length;++a)n.excludeCmdline[a]=e.excludeCmdline[a]}if(null!=e.ringBufferReadPeriodMs&&e.hasOwnProperty("ringBufferReadPeriodMs")&&(n.ringBufferReadPeriodMs=e.ringBufferReadPeriodMs),null!=e.remoteDescriptorTimeoutMs&&e.hasOwnProperty("remoteDescriptorTimeoutMs")&&(n.remoteDescriptorTimeoutMs=e.remoteDescriptorTimeoutMs),null!=e.unwindStateClearPeriodMs&&e.hasOwnProperty("unwindStateClearPeriodMs")&&(n.unwindStateClearPeriodMs=e.unwindStateClearPeriodMs),null!=e.additionalCmdlineCount&&e.hasOwnProperty("additionalCmdlineCount")&&(n.additionalCmdlineCount=e.additionalCmdlineCount),null!=e.kernelFrames&&e.hasOwnProperty("kernelFrames")&&(n.kernelFrames=e.kernelFrames),null!=e.maxDaemonMemoryKb&&e.hasOwnProperty("maxDaemonMemoryKb")&&(n.maxDaemonMemoryKb=e.maxDaemonMemoryKb),null!=e.timebase&&e.hasOwnProperty("timebase")&&(n.timebase=s.perfetto.protos.PerfEvents.Timebase.toObject(e.timebase,t)),null!=e.callstackSampling&&e.hasOwnProperty("callstackSampling")&&(n.callstackSampling=s.perfetto.protos.PerfEventConfig.CallstackSampling.toObject(e.callstackSampling,t)),null!=e.maxEnqueuedFootprintKb&&e.hasOwnProperty("maxEnqueuedFootprintKb")&&("number"==typeof e.maxEnqueuedFootprintKb?n.maxEnqueuedFootprintKb=t.longs===String?String(e.maxEnqueuedFootprintKb):e.maxEnqueuedFootprintKb:n.maxEnqueuedFootprintKb=t.longs===String?i.Long.prototype.toString.call(e.maxEnqueuedFootprintKb):t.longs===Number?new i.LongBits(e.maxEnqueuedFootprintKb.low>>>0,e.maxEnqueuedFootprintKb.high>>>0).toNumber(!0):e.maxEnqueuedFootprintKb),e.targetInstalledBy&&e.targetInstalledBy.length){n.targetInstalledBy=[];for(a=0;a<e.targetInstalledBy.length;++a)n.targetInstalledBy[a]=e.targetInstalledBy[a]}return n},A.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},A.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.PerfEventConfig"},A.CallstackSampling=(vt.prototype.scope=null,vt.prototype.kernelFrames=!1,vt.prototype.userFrames=0,vt.create=function(e){return new vt(e)},vt.encode=function(e,t){return t=t||a.create(),null!=e.scope&&Object.hasOwnProperty.call(e,"scope")&&s.perfetto.protos.PerfEventConfig.Scope.encode(e.scope,t.uint32(10).fork()).ldelim(),null!=e.kernelFrames&&Object.hasOwnProperty.call(e,"kernelFrames")&&t.uint32(16).bool(e.kernelFrames),null!=e.userFrames&&Object.hasOwnProperty.call(e,"userFrames")&&t.uint32(24).int32(e.userFrames),t},vt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.PerfEventConfig.CallstackSampling;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.scope=s.perfetto.protos.PerfEventConfig.Scope.decode(e,e.uint32());break;case 2:n.kernelFrames=e.bool();break;case 3:n.userFrames=e.int32();break;default:e.skipType(7&a)}}return n},vt.fromObject=function(e){if(e instanceof s.perfetto.protos.PerfEventConfig.CallstackSampling)return e;var t=new s.perfetto.protos.PerfEventConfig.CallstackSampling;if(null!=e.scope){if("object"!=typeof e.scope)throw TypeError(".perfetto.protos.PerfEventConfig.CallstackSampling.scope: object expected");t.scope=s.perfetto.protos.PerfEventConfig.Scope.fromObject(e.scope)}switch(null!=e.kernelFrames&&(t.kernelFrames=Boolean(e.kernelFrames)),e.userFrames){default:"number"==typeof e.userFrames&&(t.userFrames=e.userFrames);break;case"UNWIND_UNKNOWN":case 0:t.userFrames=0;break;case"UNWIND_SKIP":case 1:t.userFrames=1;break;case"UNWIND_DWARF":case 2:t.userFrames=2}return t},vt.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.scope=null,r.kernelFrames=!1,r.userFrames=t.enums===String?"UNWIND_UNKNOWN":0),null!=e.scope&&e.hasOwnProperty("scope")&&(r.scope=s.perfetto.protos.PerfEventConfig.Scope.toObject(e.scope,t)),null!=e.kernelFrames&&e.hasOwnProperty("kernelFrames")&&(r.kernelFrames=e.kernelFrames),null!=e.userFrames&&e.hasOwnProperty("userFrames")&&(r.userFrames=t.enums!==String||void 0===s.perfetto.protos.PerfEventConfig.UnwindMode[e.userFrames]?e.userFrames:s.perfetto.protos.PerfEventConfig.UnwindMode[e.userFrames]),r},vt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},vt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.PerfEventConfig.CallstackSampling"},vt),A.Scope=(Et.prototype.targetPid=i.emptyArray,Et.prototype.targetCmdline=i.emptyArray,Et.prototype.excludePid=i.emptyArray,Et.prototype.excludeCmdline=i.emptyArray,Et.prototype.additionalCmdlineCount=0,Et.prototype.processShardCount=0,Et.create=function(e){return new Et(e)},Et.encode=function(e,t){if(t=t||a.create(),null!=e.targetPid&&e.targetPid.length)for(var r=0;r<e.targetPid.length;++r)t.uint32(8).int32(e.targetPid[r]);if(null!=e.targetCmdline&&e.targetCmdline.length)for(r=0;r<e.targetCmdline.length;++r)t.uint32(18).string(e.targetCmdline[r]);if(null!=e.excludePid&&e.excludePid.length)for(r=0;r<e.excludePid.length;++r)t.uint32(24).int32(e.excludePid[r]);if(null!=e.excludeCmdline&&e.excludeCmdline.length)for(r=0;r<e.excludeCmdline.length;++r)t.uint32(34).string(e.excludeCmdline[r]);return null!=e.additionalCmdlineCount&&Object.hasOwnProperty.call(e,"additionalCmdlineCount")&&t.uint32(40).uint32(e.additionalCmdlineCount),null!=e.processShardCount&&Object.hasOwnProperty.call(e,"processShardCount")&&t.uint32(48).uint32(e.processShardCount),t},Et.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.PerfEventConfig.Scope;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:if(n.targetPid&&n.targetPid.length||(n.targetPid=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.targetPid.push(e.int32());else n.targetPid.push(e.int32());break;case 2:n.targetCmdline&&n.targetCmdline.length||(n.targetCmdline=[]),n.targetCmdline.push(e.string());break;case 3:if(n.excludePid&&n.excludePid.length||(n.excludePid=[]),2==(7&a))for(i=e.uint32()+e.pos;e.pos<i;)n.excludePid.push(e.int32());else n.excludePid.push(e.int32());break;case 4:n.excludeCmdline&&n.excludeCmdline.length||(n.excludeCmdline=[]),n.excludeCmdline.push(e.string());break;case 5:n.additionalCmdlineCount=e.uint32();break;case 6:n.processShardCount=e.uint32();break;default:e.skipType(7&a)}}return n},Et.fromObject=function(e){if(e instanceof s.perfetto.protos.PerfEventConfig.Scope)return e;var t=new s.perfetto.protos.PerfEventConfig.Scope;if(e.targetPid){if(!Array.isArray(e.targetPid))throw TypeError(".perfetto.protos.PerfEventConfig.Scope.targetPid: array expected");t.targetPid=[];for(var r=0;r<e.targetPid.length;++r)t.targetPid[r]=0|e.targetPid[r]}if(e.targetCmdline){if(!Array.isArray(e.targetCmdline))throw TypeError(".perfetto.protos.PerfEventConfig.Scope.targetCmdline: array expected");t.targetCmdline=[];for(r=0;r<e.targetCmdline.length;++r)t.targetCmdline[r]=String(e.targetCmdline[r])}if(e.excludePid){if(!Array.isArray(e.excludePid))throw TypeError(".perfetto.protos.PerfEventConfig.Scope.excludePid: array expected");t.excludePid=[];for(r=0;r<e.excludePid.length;++r)t.excludePid[r]=0|e.excludePid[r]}if(e.excludeCmdline){if(!Array.isArray(e.excludeCmdline))throw TypeError(".perfetto.protos.PerfEventConfig.Scope.excludeCmdline: array expected");t.excludeCmdline=[];for(r=0;r<e.excludeCmdline.length;++r)t.excludeCmdline[r]=String(e.excludeCmdline[r])}return null!=e.additionalCmdlineCount&&(t.additionalCmdlineCount=e.additionalCmdlineCount>>>0),null!=e.processShardCount&&(t.processShardCount=e.processShardCount>>>0),t},Et.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.targetPid=[],r.targetCmdline=[],r.excludePid=[],r.excludeCmdline=[]),t.defaults&&(r.additionalCmdlineCount=0,r.processShardCount=0),e.targetPid&&e.targetPid.length){r.targetPid=[];for(var n=0;n<e.targetPid.length;++n)r.targetPid[n]=e.targetPid[n]}if(e.targetCmdline&&e.targetCmdline.length){r.targetCmdline=[];for(n=0;n<e.targetCmdline.length;++n)r.targetCmdline[n]=e.targetCmdline[n]}if(e.excludePid&&e.excludePid.length){r.excludePid=[];for(n=0;n<e.excludePid.length;++n)r.excludePid[n]=e.excludePid[n]}if(e.excludeCmdline&&e.excludeCmdline.length){r.excludeCmdline=[];for(n=0;n<e.excludeCmdline.length;++n)r.excludeCmdline[n]=e.excludeCmdline[n]}return null!=e.additionalCmdlineCount&&e.hasOwnProperty("additionalCmdlineCount")&&(r.additionalCmdlineCount=e.additionalCmdlineCount),null!=e.processShardCount&&e.hasOwnProperty("processShardCount")&&(r.processShardCount=e.processShardCount),r},Et.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Et.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.PerfEventConfig.Scope"},Et),A.UnwindMode=(t={},(e=Object.create(t))[t[0]="UNWIND_UNKNOWN"]=0,e[t[1]="UNWIND_SKIP"]=1,e[t[2]="UNWIND_DWARF"]=2,e),A),r.PerfEvents=(St.create=function(e){return new St(e)},St.encode=function(e,t){return t=t||a.create()},St.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,t=new s.perfetto.protos.PerfEvents;e.pos<r;){var n=e.uint32();e.skipType(7&n)}return t},St.fromObject=function(e){return e instanceof s.perfetto.protos.PerfEvents?e:new s.perfetto.protos.PerfEvents},St.toObject=function(){return{}},St.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},St.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.PerfEvents"},St.Timebase=(O.prototype.frequency=null,O.prototype.period=null,O.prototype.counter=null,O.prototype.tracepoint=null,O.prototype.rawEvent=null,O.prototype.timestampClock=0,O.prototype.name="",Object.defineProperty(O.prototype,"interval",{get:i.oneOfGetter(t=["frequency","period"]),set:i.oneOfSetter(t)}),Object.defineProperty(O.prototype,"event",{get:i.oneOfGetter(t=["counter","tracepoint","rawEvent"]),set:i.oneOfSetter(t)}),O.create=function(e){return new O(e)},O.encode=function(e,t){return t=t||a.create(),null!=e.period&&Object.hasOwnProperty.call(e,"period")&&t.uint32(8).uint64(e.period),null!=e.frequency&&Object.hasOwnProperty.call(e,"frequency")&&t.uint32(16).uint64(e.frequency),null!=e.tracepoint&&Object.hasOwnProperty.call(e,"tracepoint")&&s.perfetto.protos.PerfEvents.Tracepoint.encode(e.tracepoint,t.uint32(26).fork()).ldelim(),null!=e.counter&&Object.hasOwnProperty.call(e,"counter")&&t.uint32(32).int32(e.counter),null!=e.rawEvent&&Object.hasOwnProperty.call(e,"rawEvent")&&s.perfetto.protos.PerfEvents.RawEvent.encode(e.rawEvent,t.uint32(42).fork()).ldelim(),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(82).string(e.name),null!=e.timestampClock&&Object.hasOwnProperty.call(e,"timestampClock")&&t.uint32(88).int32(e.timestampClock),t},O.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.PerfEvents.Timebase;e.pos<r;){var a=e.uint32();switch(a>>>3){case 2:n.frequency=e.uint64();break;case 1:n.period=e.uint64();break;case 4:n.counter=e.int32();break;case 3:n.tracepoint=s.perfetto.protos.PerfEvents.Tracepoint.decode(e,e.uint32());break;case 5:n.rawEvent=s.perfetto.protos.PerfEvents.RawEvent.decode(e,e.uint32());break;case 11:n.timestampClock=e.int32();break;case 10:n.name=e.string();break;default:e.skipType(7&a)}}return n},O.fromObject=function(e){if(e instanceof s.perfetto.protos.PerfEvents.Timebase)return e;var t=new s.perfetto.protos.PerfEvents.Timebase;switch(null!=e.frequency&&(i.Long?(t.frequency=i.Long.fromValue(e.frequency)).unsigned=!0:"string"==typeof e.frequency?t.frequency=parseInt(e.frequency,10):"number"==typeof e.frequency?t.frequency=e.frequency:"object"==typeof e.frequency&&(t.frequency=new i.LongBits(e.frequency.low>>>0,e.frequency.high>>>0).toNumber(!0))),null!=e.period&&(i.Long?(t.period=i.Long.fromValue(e.period)).unsigned=!0:"string"==typeof e.period?t.period=parseInt(e.period,10):"number"==typeof e.period?t.period=e.period:"object"==typeof e.period&&(t.period=new i.LongBits(e.period.low>>>0,e.period.high>>>0).toNumber(!0))),e.counter){default:"number"==typeof e.counter&&(t.counter=e.counter);break;case"UNKNOWN_COUNTER":case 0:t.counter=0;break;case"SW_CPU_CLOCK":case 1:t.counter=1;break;case"SW_PAGE_FAULTS":case 2:t.counter=2;break;case"SW_TASK_CLOCK":case 3:t.counter=3;break;case"SW_CONTEXT_SWITCHES":case 4:t.counter=4;break;case"SW_CPU_MIGRATIONS":case 5:t.counter=5;break;case"SW_PAGE_FAULTS_MIN":case 6:t.counter=6;break;case"SW_PAGE_FAULTS_MAJ":case 7:t.counter=7;break;case"SW_ALIGNMENT_FAULTS":case 8:t.counter=8;break;case"SW_EMULATION_FAULTS":case 9:t.counter=9;break;case"SW_DUMMY":case 20:t.counter=20;break;case"HW_CPU_CYCLES":case 10:t.counter=10;break;case"HW_INSTRUCTIONS":case 11:t.counter=11;break;case"HW_CACHE_REFERENCES":case 12:t.counter=12;break;case"HW_CACHE_MISSES":case 13:t.counter=13;break;case"HW_BRANCH_INSTRUCTIONS":case 14:t.counter=14;break;case"HW_BRANCH_MISSES":case 15:t.counter=15;break;case"HW_BUS_CYCLES":case 16:t.counter=16;break;case"HW_STALLED_CYCLES_FRONTEND":case 17:t.counter=17;break;case"HW_STALLED_CYCLES_BACKEND":case 18:t.counter=18;break;case"HW_REF_CPU_CYCLES":case 19:t.counter=19}if(null!=e.tracepoint){if("object"!=typeof e.tracepoint)throw TypeError(".perfetto.protos.PerfEvents.Timebase.tracepoint: object expected");t.tracepoint=s.perfetto.protos.PerfEvents.Tracepoint.fromObject(e.tracepoint)}if(null!=e.rawEvent){if("object"!=typeof e.rawEvent)throw TypeError(".perfetto.protos.PerfEvents.Timebase.rawEvent: object expected");t.rawEvent=s.perfetto.protos.PerfEvents.RawEvent.fromObject(e.rawEvent)}switch(e.timestampClock){default:"number"==typeof e.timestampClock&&(t.timestampClock=e.timestampClock);break;case"UNKNOWN_PERF_CLOCK":case 0:t.timestampClock=0;break;case"PERF_CLOCK_REALTIME":case 1:t.timestampClock=1;break;case"PERF_CLOCK_MONOTONIC":case 2:t.timestampClock=2;break;case"PERF_CLOCK_MONOTONIC_RAW":case 3:t.timestampClock=3;break;case"PERF_CLOCK_BOOTTIME":case 4:t.timestampClock=4}return null!=e.name&&(t.name=String(e.name)),t},O.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.name="",r.timestampClock=t.enums===String?"UNKNOWN_PERF_CLOCK":0),null!=e.period&&e.hasOwnProperty("period")&&("number"==typeof e.period?r.period=t.longs===String?String(e.period):e.period:r.period=t.longs===String?i.Long.prototype.toString.call(e.period):t.longs===Number?new i.LongBits(e.period.low>>>0,e.period.high>>>0).toNumber(!0):e.period,t.oneofs)&&(r.interval="period"),null!=e.frequency&&e.hasOwnProperty("frequency")&&("number"==typeof e.frequency?r.frequency=t.longs===String?String(e.frequency):e.frequency:r.frequency=t.longs===String?i.Long.prototype.toString.call(e.frequency):t.longs===Number?new i.LongBits(e.frequency.low>>>0,e.frequency.high>>>0).toNumber(!0):e.frequency,t.oneofs)&&(r.interval="frequency"),null!=e.tracepoint&&e.hasOwnProperty("tracepoint")&&(r.tracepoint=s.perfetto.protos.PerfEvents.Tracepoint.toObject(e.tracepoint,t),t.oneofs)&&(r.event="tracepoint"),null!=e.counter&&e.hasOwnProperty("counter")&&(r.counter=t.enums!==String||void 0===s.perfetto.protos.PerfEvents.Counter[e.counter]?e.counter:s.perfetto.protos.PerfEvents.Counter[e.counter],t.oneofs)&&(r.event="counter"),null!=e.rawEvent&&e.hasOwnProperty("rawEvent")&&(r.rawEvent=s.perfetto.protos.PerfEvents.RawEvent.toObject(e.rawEvent,t),t.oneofs)&&(r.event="rawEvent"),null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.timestampClock&&e.hasOwnProperty("timestampClock")&&(r.timestampClock=t.enums!==String||void 0===s.perfetto.protos.PerfEvents.PerfClock[e.timestampClock]?e.timestampClock:s.perfetto.protos.PerfEvents.PerfClock[e.timestampClock]),r},O.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},O.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.PerfEvents.Timebase"},O),St.Counter=(t={},(e=Object.create(t))[t[0]="UNKNOWN_COUNTER"]=0,e[t[1]="SW_CPU_CLOCK"]=1,e[t[2]="SW_PAGE_FAULTS"]=2,e[t[3]="SW_TASK_CLOCK"]=3,e[t[4]="SW_CONTEXT_SWITCHES"]=4,e[t[5]="SW_CPU_MIGRATIONS"]=5,e[t[6]="SW_PAGE_FAULTS_MIN"]=6,e[t[7]="SW_PAGE_FAULTS_MAJ"]=7,e[t[8]="SW_ALIGNMENT_FAULTS"]=8,e[t[9]="SW_EMULATION_FAULTS"]=9,e[t[20]="SW_DUMMY"]=20,e[t[10]="HW_CPU_CYCLES"]=10,e[t[11]="HW_INSTRUCTIONS"]=11,e[t[12]="HW_CACHE_REFERENCES"]=12,e[t[13]="HW_CACHE_MISSES"]=13,e[t[14]="HW_BRANCH_INSTRUCTIONS"]=14,e[t[15]="HW_BRANCH_MISSES"]=15,e[t[16]="HW_BUS_CYCLES"]=16,e[t[17]="HW_STALLED_CYCLES_FRONTEND"]=17,e[t[18]="HW_STALLED_CYCLES_BACKEND"]=18,e[t[19]="HW_REF_CPU_CYCLES"]=19,e),St.Tracepoint=(At.prototype.name="",At.prototype.filter="",At.create=function(e){return new At(e)},At.encode=function(e,t){return t=t||a.create(),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.filter&&Object.hasOwnProperty.call(e,"filter")&&t.uint32(18).string(e.filter),t},At.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.PerfEvents.Tracepoint;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.name=e.string();break;case 2:n.filter=e.string();break;default:e.skipType(7&a)}}return n},At.fromObject=function(e){var t;return e instanceof s.perfetto.protos.PerfEvents.Tracepoint?e:(t=new s.perfetto.protos.PerfEvents.Tracepoint,null!=e.name&&(t.name=String(e.name)),null!=e.filter&&(t.filter=String(e.filter)),t)},At.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.name="",r.filter=""),null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.filter&&e.hasOwnProperty("filter")&&(r.filter=e.filter),r},At.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},At.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.PerfEvents.Tracepoint"},At),St.RawEvent=(Ot.prototype.type=0,Ot.prototype.config=i.Long?i.Long.fromBits(0,0,!0):0,Ot.prototype.config1=i.Long?i.Long.fromBits(0,0,!0):0,Ot.prototype.config2=i.Long?i.Long.fromBits(0,0,!0):0,Ot.create=function(e){return new Ot(e)},Ot.encode=function(e,t){return t=t||a.create(),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(8).uint32(e.type),null!=e.config&&Object.hasOwnProperty.call(e,"config")&&t.uint32(16).uint64(e.config),null!=e.config1&&Object.hasOwnProperty.call(e,"config1")&&t.uint32(24).uint64(e.config1),null!=e.config2&&Object.hasOwnProperty.call(e,"config2")&&t.uint32(32).uint64(e.config2),t},Ot.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.PerfEvents.RawEvent;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.type=e.uint32();break;case 2:n.config=e.uint64();break;case 3:n.config1=e.uint64();break;case 4:n.config2=e.uint64();break;default:e.skipType(7&a)}}return n},Ot.fromObject=function(e){var t;return e instanceof s.perfetto.protos.PerfEvents.RawEvent?e:(t=new s.perfetto.protos.PerfEvents.RawEvent,null!=e.type&&(t.type=e.type>>>0),null!=e.config&&(i.Long?(t.config=i.Long.fromValue(e.config)).unsigned=!0:"string"==typeof e.config?t.config=parseInt(e.config,10):"number"==typeof e.config?t.config=e.config:"object"==typeof e.config&&(t.config=new i.LongBits(e.config.low>>>0,e.config.high>>>0).toNumber(!0))),null!=e.config1&&(i.Long?(t.config1=i.Long.fromValue(e.config1)).unsigned=!0:"string"==typeof e.config1?t.config1=parseInt(e.config1,10):"number"==typeof e.config1?t.config1=e.config1:"object"==typeof e.config1&&(t.config1=new i.LongBits(e.config1.low>>>0,e.config1.high>>>0).toNumber(!0))),null!=e.config2&&(i.Long?(t.config2=i.Long.fromValue(e.config2)).unsigned=!0:"string"==typeof e.config2?t.config2=parseInt(e.config2,10):"number"==typeof e.config2?t.config2=e.config2:"object"==typeof e.config2&&(t.config2=new i.LongBits(e.config2.low>>>0,e.config2.high>>>0).toNumber(!0))),t)},Ot.toObject=function(e,t){var r,n={};return(t=t||{}).defaults&&(n.type=0,i.Long?(r=new i.Long(0,0,!0),n.config=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.config=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.config1=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.config1=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!0),n.config2=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.config2=t.longs===String?"0":0),null!=e.type&&e.hasOwnProperty("type")&&(n.type=e.type),null!=e.config&&e.hasOwnProperty("config")&&("number"==typeof e.config?n.config=t.longs===String?String(e.config):e.config:n.config=t.longs===String?i.Long.prototype.toString.call(e.config):t.longs===Number?new i.LongBits(e.config.low>>>0,e.config.high>>>0).toNumber(!0):e.config),null!=e.config1&&e.hasOwnProperty("config1")&&("number"==typeof e.config1?n.config1=t.longs===String?String(e.config1):e.config1:n.config1=t.longs===String?i.Long.prototype.toString.call(e.config1):t.longs===Number?new i.LongBits(e.config1.low>>>0,e.config1.high>>>0).toNumber(!0):e.config1),null!=e.config2&&e.hasOwnProperty("config2")&&("number"==typeof e.config2?n.config2=t.longs===String?String(e.config2):e.config2:n.config2=t.longs===String?i.Long.prototype.toString.call(e.config2):t.longs===Number?new i.LongBits(e.config2.low>>>0,e.config2.high>>>0).toNumber(!0):e.config2),n},Ot.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Ot.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.PerfEvents.RawEvent"},Ot),St.PerfClock=(t={},(e=Object.create(t))[t[0]="UNKNOWN_PERF_CLOCK"]=0,e[t[1]="PERF_CLOCK_REALTIME"]=1,e[t[2]="PERF_CLOCK_MONOTONIC"]=2,e[t[3]="PERF_CLOCK_MONOTONIC_RAW"]=3,e[t[4]="PERF_CLOCK_BOOTTIME"]=4,e),St),r.SysStatsConfig=(C.prototype.meminfoPeriodMs=0,C.prototype.meminfoCounters=i.emptyArray,C.prototype.vmstatPeriodMs=0,C.prototype.vmstatCounters=i.emptyArray,C.prototype.statPeriodMs=0,C.prototype.statCounters=i.emptyArray,C.prototype.devfreqPeriodMs=0,C.prototype.cpufreqPeriodMs=0,C.prototype.buddyinfoPeriodMs=0,C.prototype.diskstatPeriodMs=0,C.prototype.psiPeriodMs=0,C.prototype.thermalPeriodMs=0,C.prototype.cpuidlePeriodMs=0,C.create=function(e){return new C(e)},C.encode=function(e,t){if(t=t||a.create(),null!=e.meminfoPeriodMs&&Object.hasOwnProperty.call(e,"meminfoPeriodMs")&&t.uint32(8).uint32(e.meminfoPeriodMs),null!=e.meminfoCounters&&e.meminfoCounters.length)for(var r=0;r<e.meminfoCounters.length;++r)t.uint32(16).int32(e.meminfoCounters[r]);if(null!=e.vmstatPeriodMs&&Object.hasOwnProperty.call(e,"vmstatPeriodMs")&&t.uint32(24).uint32(e.vmstatPeriodMs),null!=e.vmstatCounters&&e.vmstatCounters.length)for(r=0;r<e.vmstatCounters.length;++r)t.uint32(32).int32(e.vmstatCounters[r]);if(null!=e.statPeriodMs&&Object.hasOwnProperty.call(e,"statPeriodMs")&&t.uint32(40).uint32(e.statPeriodMs),null!=e.statCounters&&e.statCounters.length)for(r=0;r<e.statCounters.length;++r)t.uint32(48).int32(e.statCounters[r]);return null!=e.devfreqPeriodMs&&Object.hasOwnProperty.call(e,"devfreqPeriodMs")&&t.uint32(56).uint32(e.devfreqPeriodMs),null!=e.cpufreqPeriodMs&&Object.hasOwnProperty.call(e,"cpufreqPeriodMs")&&t.uint32(64).uint32(e.cpufreqPeriodMs),null!=e.buddyinfoPeriodMs&&Object.hasOwnProperty.call(e,"buddyinfoPeriodMs")&&t.uint32(72).uint32(e.buddyinfoPeriodMs),null!=e.diskstatPeriodMs&&Object.hasOwnProperty.call(e,"diskstatPeriodMs")&&t.uint32(80).uint32(e.diskstatPeriodMs),null!=e.psiPeriodMs&&Object.hasOwnProperty.call(e,"psiPeriodMs")&&t.uint32(88).uint32(e.psiPeriodMs),null!=e.thermalPeriodMs&&Object.hasOwnProperty.call(e,"thermalPeriodMs")&&t.uint32(96).uint32(e.thermalPeriodMs),null!=e.cpuidlePeriodMs&&Object.hasOwnProperty.call(e,"cpuidlePeriodMs")&&t.uint32(104).uint32(e.cpuidlePeriodMs),t},C.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.SysStatsConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.meminfoPeriodMs=e.uint32();break;case 2:if(n.meminfoCounters&&n.meminfoCounters.length||(n.meminfoCounters=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.meminfoCounters.push(e.int32());else n.meminfoCounters.push(e.int32());break;case 3:n.vmstatPeriodMs=e.uint32();break;case 4:if(n.vmstatCounters&&n.vmstatCounters.length||(n.vmstatCounters=[]),2==(7&a))for(i=e.uint32()+e.pos;e.pos<i;)n.vmstatCounters.push(e.int32());else n.vmstatCounters.push(e.int32());break;case 5:n.statPeriodMs=e.uint32();break;case 6:if(n.statCounters&&n.statCounters.length||(n.statCounters=[]),2==(7&a))for(i=e.uint32()+e.pos;e.pos<i;)n.statCounters.push(e.int32());else n.statCounters.push(e.int32());break;case 7:n.devfreqPeriodMs=e.uint32();break;case 8:n.cpufreqPeriodMs=e.uint32();break;case 9:n.buddyinfoPeriodMs=e.uint32();break;case 10:n.diskstatPeriodMs=e.uint32();break;case 11:n.psiPeriodMs=e.uint32();break;case 12:n.thermalPeriodMs=e.uint32();break;case 13:n.cpuidlePeriodMs=e.uint32();break;default:e.skipType(7&a)}}return n},C.fromObject=function(e){if(e instanceof s.perfetto.protos.SysStatsConfig)return e;var t=new s.perfetto.protos.SysStatsConfig;if(null!=e.meminfoPeriodMs&&(t.meminfoPeriodMs=e.meminfoPeriodMs>>>0),e.meminfoCounters){if(!Array.isArray(e.meminfoCounters))throw TypeError(".perfetto.protos.SysStatsConfig.meminfoCounters: array expected");t.meminfoCounters=[];for(var r=0;r<e.meminfoCounters.length;++r)switch(e.meminfoCounters[r]){default:if("number"==typeof e.meminfoCounters[r]){t.meminfoCounters[r]=e.meminfoCounters[r];break}case"MEMINFO_UNSPECIFIED":case 0:t.meminfoCounters[r]=0;break;case"MEMINFO_MEM_TOTAL":case 1:t.meminfoCounters[r]=1;break;case"MEMINFO_MEM_FREE":case 2:t.meminfoCounters[r]=2;break;case"MEMINFO_MEM_AVAILABLE":case 3:t.meminfoCounters[r]=3;break;case"MEMINFO_BUFFERS":case 4:t.meminfoCounters[r]=4;break;case"MEMINFO_CACHED":case 5:t.meminfoCounters[r]=5;break;case"MEMINFO_SWAP_CACHED":case 6:t.meminfoCounters[r]=6;break;case"MEMINFO_ACTIVE":case 7:t.meminfoCounters[r]=7;break;case"MEMINFO_INACTIVE":case 8:t.meminfoCounters[r]=8;break;case"MEMINFO_ACTIVE_ANON":case 9:t.meminfoCounters[r]=9;break;case"MEMINFO_INACTIVE_ANON":case 10:t.meminfoCounters[r]=10;break;case"MEMINFO_ACTIVE_FILE":case 11:t.meminfoCounters[r]=11;break;case"MEMINFO_INACTIVE_FILE":case 12:t.meminfoCounters[r]=12;break;case"MEMINFO_UNEVICTABLE":case 13:t.meminfoCounters[r]=13;break;case"MEMINFO_MLOCKED":case 14:t.meminfoCounters[r]=14;break;case"MEMINFO_SWAP_TOTAL":case 15:t.meminfoCounters[r]=15;break;case"MEMINFO_SWAP_FREE":case 16:t.meminfoCounters[r]=16;break;case"MEMINFO_DIRTY":case 17:t.meminfoCounters[r]=17;break;case"MEMINFO_WRITEBACK":case 18:t.meminfoCounters[r]=18;break;case"MEMINFO_ANON_PAGES":case 19:t.meminfoCounters[r]=19;break;case"MEMINFO_MAPPED":case 20:t.meminfoCounters[r]=20;break;case"MEMINFO_SHMEM":case 21:t.meminfoCounters[r]=21;break;case"MEMINFO_SLAB":case 22:t.meminfoCounters[r]=22;break;case"MEMINFO_SLAB_RECLAIMABLE":case 23:t.meminfoCounters[r]=23;break;case"MEMINFO_SLAB_UNRECLAIMABLE":case 24:t.meminfoCounters[r]=24;break;case"MEMINFO_KERNEL_STACK":case 25:t.meminfoCounters[r]=25;break;case"MEMINFO_PAGE_TABLES":case 26:t.meminfoCounters[r]=26;break;case"MEMINFO_COMMIT_LIMIT":case 27:t.meminfoCounters[r]=27;break;case"MEMINFO_COMMITED_AS":case 28:t.meminfoCounters[r]=28;break;case"MEMINFO_VMALLOC_TOTAL":case 29:t.meminfoCounters[r]=29;break;case"MEMINFO_VMALLOC_USED":case 30:t.meminfoCounters[r]=30;break;case"MEMINFO_VMALLOC_CHUNK":case 31:t.meminfoCounters[r]=31;break;case"MEMINFO_CMA_TOTAL":case 32:t.meminfoCounters[r]=32;break;case"MEMINFO_CMA_FREE":case 33:t.meminfoCounters[r]=33;break;case"MEMINFO_GPU":case 34:t.meminfoCounters[r]=34;break;case"MEMINFO_ZRAM":case 35:t.meminfoCounters[r]=35;break;case"MEMINFO_MISC":case 36:t.meminfoCounters[r]=36;break;case"MEMINFO_ION_HEAP":case 37:t.meminfoCounters[r]=37;break;case"MEMINFO_ION_HEAP_POOL":case 38:t.meminfoCounters[r]=38}}if(null!=e.vmstatPeriodMs&&(t.vmstatPeriodMs=e.vmstatPeriodMs>>>0),e.vmstatCounters){if(!Array.isArray(e.vmstatCounters))throw TypeError(".perfetto.protos.SysStatsConfig.vmstatCounters: array expected");t.vmstatCounters=[];for(r=0;r<e.vmstatCounters.length;++r)switch(e.vmstatCounters[r]){default:if("number"==typeof e.vmstatCounters[r]){t.vmstatCounters[r]=e.vmstatCounters[r];break}case"VMSTAT_UNSPECIFIED":case 0:t.vmstatCounters[r]=0;break;case"VMSTAT_NR_FREE_PAGES":case 1:t.vmstatCounters[r]=1;break;case"VMSTAT_NR_ALLOC_BATCH":case 2:t.vmstatCounters[r]=2;break;case"VMSTAT_NR_INACTIVE_ANON":case 3:t.vmstatCounters[r]=3;break;case"VMSTAT_NR_ACTIVE_ANON":case 4:t.vmstatCounters[r]=4;break;case"VMSTAT_NR_INACTIVE_FILE":case 5:t.vmstatCounters[r]=5;break;case"VMSTAT_NR_ACTIVE_FILE":case 6:t.vmstatCounters[r]=6;break;case"VMSTAT_NR_UNEVICTABLE":case 7:t.vmstatCounters[r]=7;break;case"VMSTAT_NR_MLOCK":case 8:t.vmstatCounters[r]=8;break;case"VMSTAT_NR_ANON_PAGES":case 9:t.vmstatCounters[r]=9;break;case"VMSTAT_NR_MAPPED":case 10:t.vmstatCounters[r]=10;break;case"VMSTAT_NR_FILE_PAGES":case 11:t.vmstatCounters[r]=11;break;case"VMSTAT_NR_DIRTY":case 12:t.vmstatCounters[r]=12;break;case"VMSTAT_NR_WRITEBACK":case 13:t.vmstatCounters[r]=13;break;case"VMSTAT_NR_SLAB_RECLAIMABLE":case 14:t.vmstatCounters[r]=14;break;case"VMSTAT_NR_SLAB_UNRECLAIMABLE":case 15:t.vmstatCounters[r]=15;break;case"VMSTAT_NR_PAGE_TABLE_PAGES":case 16:t.vmstatCounters[r]=16;break;case"VMSTAT_NR_KERNEL_STACK":case 17:t.vmstatCounters[r]=17;break;case"VMSTAT_NR_OVERHEAD":case 18:t.vmstatCounters[r]=18;break;case"VMSTAT_NR_UNSTABLE":case 19:t.vmstatCounters[r]=19;break;case"VMSTAT_NR_BOUNCE":case 20:t.vmstatCounters[r]=20;break;case"VMSTAT_NR_VMSCAN_WRITE":case 21:t.vmstatCounters[r]=21;break;case"VMSTAT_NR_VMSCAN_IMMEDIATE_RECLAIM":case 22:t.vmstatCounters[r]=22;break;case"VMSTAT_NR_WRITEBACK_TEMP":case 23:t.vmstatCounters[r]=23;break;case"VMSTAT_NR_ISOLATED_ANON":case 24:t.vmstatCounters[r]=24;break;case"VMSTAT_NR_ISOLATED_FILE":case 25:t.vmstatCounters[r]=25;break;case"VMSTAT_NR_SHMEM":case 26:t.vmstatCounters[r]=26;break;case"VMSTAT_NR_DIRTIED":case 27:t.vmstatCounters[r]=27;break;case"VMSTAT_NR_WRITTEN":case 28:t.vmstatCounters[r]=28;break;case"VMSTAT_NR_PAGES_SCANNED":case 29:t.vmstatCounters[r]=29;break;case"VMSTAT_WORKINGSET_REFAULT":case 30:t.vmstatCounters[r]=30;break;case"VMSTAT_WORKINGSET_ACTIVATE":case 31:t.vmstatCounters[r]=31;break;case"VMSTAT_WORKINGSET_NODERECLAIM":case 32:t.vmstatCounters[r]=32;break;case"VMSTAT_NR_ANON_TRANSPARENT_HUGEPAGES":case 33:t.vmstatCounters[r]=33;break;case"VMSTAT_NR_FREE_CMA":case 34:t.vmstatCounters[r]=34;break;case"VMSTAT_NR_SWAPCACHE":case 35:t.vmstatCounters[r]=35;break;case"VMSTAT_NR_DIRTY_THRESHOLD":case 36:t.vmstatCounters[r]=36;break;case"VMSTAT_NR_DIRTY_BACKGROUND_THRESHOLD":case 37:t.vmstatCounters[r]=37;break;case"VMSTAT_PGPGIN":case 38:t.vmstatCounters[r]=38;break;case"VMSTAT_PGPGOUT":case 39:t.vmstatCounters[r]=39;break;case"VMSTAT_PGPGOUTCLEAN":case 40:t.vmstatCounters[r]=40;break;case"VMSTAT_PSWPIN":case 41:t.vmstatCounters[r]=41;break;case"VMSTAT_PSWPOUT":case 42:t.vmstatCounters[r]=42;break;case"VMSTAT_PGALLOC_DMA":case 43:t.vmstatCounters[r]=43;break;case"VMSTAT_PGALLOC_NORMAL":case 44:t.vmstatCounters[r]=44;break;case"VMSTAT_PGALLOC_MOVABLE":case 45:t.vmstatCounters[r]=45;break;case"VMSTAT_PGFREE":case 46:t.vmstatCounters[r]=46;break;case"VMSTAT_PGACTIVATE":case 47:t.vmstatCounters[r]=47;break;case"VMSTAT_PGDEACTIVATE":case 48:t.vmstatCounters[r]=48;break;case"VMSTAT_PGFAULT":case 49:t.vmstatCounters[r]=49;break;case"VMSTAT_PGMAJFAULT":case 50:t.vmstatCounters[r]=50;break;case"VMSTAT_PGREFILL_DMA":case 51:t.vmstatCounters[r]=51;break;case"VMSTAT_PGREFILL_NORMAL":case 52:t.vmstatCounters[r]=52;break;case"VMSTAT_PGREFILL_MOVABLE":case 53:t.vmstatCounters[r]=53;break;case"VMSTAT_PGSTEAL_KSWAPD_DMA":case 54:t.vmstatCounters[r]=54;break;case"VMSTAT_PGSTEAL_KSWAPD_NORMAL":case 55:t.vmstatCounters[r]=55;break;case"VMSTAT_PGSTEAL_KSWAPD_MOVABLE":case 56:t.vmstatCounters[r]=56;break;case"VMSTAT_PGSTEAL_DIRECT_DMA":case 57:t.vmstatCounters[r]=57;break;case"VMSTAT_PGSTEAL_DIRECT_NORMAL":case 58:t.vmstatCounters[r]=58;break;case"VMSTAT_PGSTEAL_DIRECT_MOVABLE":case 59:t.vmstatCounters[r]=59;break;case"VMSTAT_PGSCAN_KSWAPD_DMA":case 60:t.vmstatCounters[r]=60;break;case"VMSTAT_PGSCAN_KSWAPD_NORMAL":case 61:t.vmstatCounters[r]=61;break;case"VMSTAT_PGSCAN_KSWAPD_MOVABLE":case 62:t.vmstatCounters[r]=62;break;case"VMSTAT_PGSCAN_DIRECT_DMA":case 63:t.vmstatCounters[r]=63;break;case"VMSTAT_PGSCAN_DIRECT_NORMAL":case 64:t.vmstatCounters[r]=64;break;case"VMSTAT_PGSCAN_DIRECT_MOVABLE":case 65:t.vmstatCounters[r]=65;break;case"VMSTAT_PGSCAN_DIRECT_THROTTLE":case 66:t.vmstatCounters[r]=66;break;case"VMSTAT_PGINODESTEAL":case 67:t.vmstatCounters[r]=67;break;case"VMSTAT_SLABS_SCANNED":case 68:t.vmstatCounters[r]=68;break;case"VMSTAT_KSWAPD_INODESTEAL":case 69:t.vmstatCounters[r]=69;break;case"VMSTAT_KSWAPD_LOW_WMARK_HIT_QUICKLY":case 70:t.vmstatCounters[r]=70;break;case"VMSTAT_KSWAPD_HIGH_WMARK_HIT_QUICKLY":case 71:t.vmstatCounters[r]=71;break;case"VMSTAT_PAGEOUTRUN":case 72:t.vmstatCounters[r]=72;break;case"VMSTAT_ALLOCSTALL":case 73:t.vmstatCounters[r]=73;break;case"VMSTAT_PGROTATED":case 74:t.vmstatCounters[r]=74;break;case"VMSTAT_DROP_PAGECACHE":case 75:t.vmstatCounters[r]=75;break;case"VMSTAT_DROP_SLAB":case 76:t.vmstatCounters[r]=76;break;case"VMSTAT_PGMIGRATE_SUCCESS":case 77:t.vmstatCounters[r]=77;break;case"VMSTAT_PGMIGRATE_FAIL":case 78:t.vmstatCounters[r]=78;break;case"VMSTAT_COMPACT_MIGRATE_SCANNED":case 79:t.vmstatCounters[r]=79;break;case"VMSTAT_COMPACT_FREE_SCANNED":case 80:t.vmstatCounters[r]=80;break;case"VMSTAT_COMPACT_ISOLATED":case 81:t.vmstatCounters[r]=81;break;case"VMSTAT_COMPACT_STALL":case 82:t.vmstatCounters[r]=82;break;case"VMSTAT_COMPACT_FAIL":case 83:t.vmstatCounters[r]=83;break;case"VMSTAT_COMPACT_SUCCESS":case 84:t.vmstatCounters[r]=84;break;case"VMSTAT_COMPACT_DAEMON_WAKE":case 85:t.vmstatCounters[r]=85;break;case"VMSTAT_UNEVICTABLE_PGS_CULLED":case 86:t.vmstatCounters[r]=86;break;case"VMSTAT_UNEVICTABLE_PGS_SCANNED":case 87:t.vmstatCounters[r]=87;break;case"VMSTAT_UNEVICTABLE_PGS_RESCUED":case 88:t.vmstatCounters[r]=88;break;case"VMSTAT_UNEVICTABLE_PGS_MLOCKED":case 89:t.vmstatCounters[r]=89;break;case"VMSTAT_UNEVICTABLE_PGS_MUNLOCKED":case 90:t.vmstatCounters[r]=90;break;case"VMSTAT_UNEVICTABLE_PGS_CLEARED":case 91:t.vmstatCounters[r]=91;break;case"VMSTAT_UNEVICTABLE_PGS_STRANDED":case 92:t.vmstatCounters[r]=92;break;case"VMSTAT_NR_ZSPAGES":case 93:t.vmstatCounters[r]=93;break;case"VMSTAT_NR_ION_HEAP":case 94:t.vmstatCounters[r]=94;break;case"VMSTAT_NR_GPU_HEAP":case 95:t.vmstatCounters[r]=95;break;case"VMSTAT_ALLOCSTALL_DMA":case 96:t.vmstatCounters[r]=96;break;case"VMSTAT_ALLOCSTALL_MOVABLE":case 97:t.vmstatCounters[r]=97;break;case"VMSTAT_ALLOCSTALL_NORMAL":case 98:t.vmstatCounters[r]=98;break;case"VMSTAT_COMPACT_DAEMON_FREE_SCANNED":case 99:t.vmstatCounters[r]=99;break;case"VMSTAT_COMPACT_DAEMON_MIGRATE_SCANNED":case 100:t.vmstatCounters[r]=100;break;case"VMSTAT_NR_FASTRPC":case 101:t.vmstatCounters[r]=101;break;case"VMSTAT_NR_INDIRECTLY_RECLAIMABLE":case 102:t.vmstatCounters[r]=102;break;case"VMSTAT_NR_ION_HEAP_POOL":case 103:t.vmstatCounters[r]=103;break;case"VMSTAT_NR_KERNEL_MISC_RECLAIMABLE":case 104:t.vmstatCounters[r]=104;break;case"VMSTAT_NR_SHADOW_CALL_STACK_BYTES":case 105:t.vmstatCounters[r]=105;break;case"VMSTAT_NR_SHMEM_HUGEPAGES":case 106:t.vmstatCounters[r]=106;break;case"VMSTAT_NR_SHMEM_PMDMAPPED":case 107:t.vmstatCounters[r]=107;break;case"VMSTAT_NR_UNRECLAIMABLE_PAGES":case 108:t.vmstatCounters[r]=108;break;case"VMSTAT_NR_ZONE_ACTIVE_ANON":case 109:t.vmstatCounters[r]=109;break;case"VMSTAT_NR_ZONE_ACTIVE_FILE":case 110:t.vmstatCounters[r]=110;break;case"VMSTAT_NR_ZONE_INACTIVE_ANON":case 111:t.vmstatCounters[r]=111;break;case"VMSTAT_NR_ZONE_INACTIVE_FILE":case 112:t.vmstatCounters[r]=112;break;case"VMSTAT_NR_ZONE_UNEVICTABLE":case 113:t.vmstatCounters[r]=113;break;case"VMSTAT_NR_ZONE_WRITE_PENDING":case 114:t.vmstatCounters[r]=114;break;case"VMSTAT_OOM_KILL":case 115:t.vmstatCounters[r]=115;break;case"VMSTAT_PGLAZYFREE":case 116:t.vmstatCounters[r]=116;break;case"VMSTAT_PGLAZYFREED":case 117:t.vmstatCounters[r]=117;break;case"VMSTAT_PGREFILL":case 118:t.vmstatCounters[r]=118;break;case"VMSTAT_PGSCAN_DIRECT":case 119:t.vmstatCounters[r]=119;break;case"VMSTAT_PGSCAN_KSWAPD":case 120:t.vmstatCounters[r]=120;break;case"VMSTAT_PGSKIP_DMA":case 121:t.vmstatCounters[r]=121;break;case"VMSTAT_PGSKIP_MOVABLE":case 122:t.vmstatCounters[r]=122;break;case"VMSTAT_PGSKIP_NORMAL":case 123:t.vmstatCounters[r]=123;break;case"VMSTAT_PGSTEAL_DIRECT":case 124:t.vmstatCounters[r]=124;break;case"VMSTAT_PGSTEAL_KSWAPD":case 125:t.vmstatCounters[r]=125;break;case"VMSTAT_SWAP_RA":case 126:t.vmstatCounters[r]=126;break;case"VMSTAT_SWAP_RA_HIT":case 127:t.vmstatCounters[r]=127;break;case"VMSTAT_WORKINGSET_RESTORE":case 128:t.vmstatCounters[r]=128;break;case"VMSTAT_ALLOCSTALL_DEVICE":case 129:t.vmstatCounters[r]=129;break;case"VMSTAT_ALLOCSTALL_DMA32":case 130:t.vmstatCounters[r]=130;break;case"VMSTAT_BALLOON_DEFLATE":case 131:t.vmstatCounters[r]=131;break;case"VMSTAT_BALLOON_INFLATE":case 132:t.vmstatCounters[r]=132;break;case"VMSTAT_BALLOON_MIGRATE":case 133:t.vmstatCounters[r]=133;break;case"VMSTAT_CMA_ALLOC_FAIL":case 134:t.vmstatCounters[r]=134;break;case"VMSTAT_CMA_ALLOC_SUCCESS":case 135:t.vmstatCounters[r]=135;break;case"VMSTAT_NR_FILE_HUGEPAGES":case 136:t.vmstatCounters[r]=136;break;case"VMSTAT_NR_FILE_PMDMAPPED":case 137:t.vmstatCounters[r]=137;break;case"VMSTAT_NR_FOLL_PIN_ACQUIRED":case 138:t.vmstatCounters[r]=138;break;case"VMSTAT_NR_FOLL_PIN_RELEASED":case 139:t.vmstatCounters[r]=139;break;case"VMSTAT_NR_SEC_PAGE_TABLE_PAGES":case 140:t.vmstatCounters[r]=140;break;case"VMSTAT_NR_SHADOW_CALL_STACK":case 141:t.vmstatCounters[r]=141;break;case"VMSTAT_NR_SWAPCACHED":case 142:t.vmstatCounters[r]=142;break;case"VMSTAT_NR_THROTTLED_WRITTEN":case 143:t.vmstatCounters[r]=143;break;case"VMSTAT_PGALLOC_DEVICE":case 144:t.vmstatCounters[r]=144;break;case"VMSTAT_PGALLOC_DMA32":case 145:t.vmstatCounters[r]=145;break;case"VMSTAT_PGDEMOTE_DIRECT":case 146:t.vmstatCounters[r]=146;break;case"VMSTAT_PGDEMOTE_KSWAPD":case 147:t.vmstatCounters[r]=147;break;case"VMSTAT_PGREUSE":case 148:t.vmstatCounters[r]=148;break;case"VMSTAT_PGSCAN_ANON":case 149:t.vmstatCounters[r]=149;break;case"VMSTAT_PGSCAN_FILE":case 150:t.vmstatCounters[r]=150;break;case"VMSTAT_PGSKIP_DEVICE":case 151:t.vmstatCounters[r]=151;break;case"VMSTAT_PGSKIP_DMA32":case 152:t.vmstatCounters[r]=152;break;case"VMSTAT_PGSTEAL_ANON":case 153:t.vmstatCounters[r]=153;break;case"VMSTAT_PGSTEAL_FILE":case 154:t.vmstatCounters[r]=154;break;case"VMSTAT_THP_COLLAPSE_ALLOC":case 155:t.vmstatCounters[r]=155;break;case"VMSTAT_THP_COLLAPSE_ALLOC_FAILED":case 156:t.vmstatCounters[r]=156;break;case"VMSTAT_THP_DEFERRED_SPLIT_PAGE":case 157:t.vmstatCounters[r]=157;break;case"VMSTAT_THP_FAULT_ALLOC":case 158:t.vmstatCounters[r]=158;break;case"VMSTAT_THP_FAULT_FALLBACK":case 159:t.vmstatCounters[r]=159;break;case"VMSTAT_THP_FAULT_FALLBACK_CHARGE":case 160:t.vmstatCounters[r]=160;break;case"VMSTAT_THP_FILE_ALLOC":case 161:t.vmstatCounters[r]=161;break;case"VMSTAT_THP_FILE_FALLBACK":case 162:t.vmstatCounters[r]=162;break;case"VMSTAT_THP_FILE_FALLBACK_CHARGE":case 163:t.vmstatCounters[r]=163;break;case"VMSTAT_THP_FILE_MAPPED":case 164:t.vmstatCounters[r]=164;break;case"VMSTAT_THP_MIGRATION_FAIL":case 165:t.vmstatCounters[r]=165;break;case"VMSTAT_THP_MIGRATION_SPLIT":case 166:t.vmstatCounters[r]=166;break;case"VMSTAT_THP_MIGRATION_SUCCESS":case 167:t.vmstatCounters[r]=167;break;case"VMSTAT_THP_SCAN_EXCEED_NONE_PTE":case 168:t.vmstatCounters[r]=168;break;case"VMSTAT_THP_SCAN_EXCEED_SHARE_PTE":case 169:t.vmstatCounters[r]=169;break;case"VMSTAT_THP_SCAN_EXCEED_SWAP_PTE":case 170:t.vmstatCounters[r]=170;break;case"VMSTAT_THP_SPLIT_PAGE":case 171:t.vmstatCounters[r]=171;break;case"VMSTAT_THP_SPLIT_PAGE_FAILED":case 172:t.vmstatCounters[r]=172;break;case"VMSTAT_THP_SPLIT_PMD":case 173:t.vmstatCounters[r]=173;break;case"VMSTAT_THP_SWPOUT":case 174:t.vmstatCounters[r]=174;break;case"VMSTAT_THP_SWPOUT_FALLBACK":case 175:t.vmstatCounters[r]=175;break;case"VMSTAT_THP_ZERO_PAGE_ALLOC":case 176:t.vmstatCounters[r]=176;break;case"VMSTAT_THP_ZERO_PAGE_ALLOC_FAILED":case 177:t.vmstatCounters[r]=177;break;case"VMSTAT_VMA_LOCK_ABORT":case 178:t.vmstatCounters[r]=178;break;case"VMSTAT_VMA_LOCK_MISS":case 179:t.vmstatCounters[r]=179;break;case"VMSTAT_VMA_LOCK_RETRY":case 180:t.vmstatCounters[r]=180;break;case"VMSTAT_VMA_LOCK_SUCCESS":case 181:t.vmstatCounters[r]=181;break;case"VMSTAT_WORKINGSET_ACTIVATE_ANON":case 182:t.vmstatCounters[r]=182;break;case"VMSTAT_WORKINGSET_ACTIVATE_FILE":case 183:t.vmstatCounters[r]=183;break;case"VMSTAT_WORKINGSET_NODES":case 184:t.vmstatCounters[r]=184;break;case"VMSTAT_WORKINGSET_REFAULT_ANON":case 185:t.vmstatCounters[r]=185;break;case"VMSTAT_WORKINGSET_REFAULT_FILE":case 186:t.vmstatCounters[r]=186;break;case"VMSTAT_WORKINGSET_RESTORE_ANON":case 187:t.vmstatCounters[r]=187;break;case"VMSTAT_WORKINGSET_RESTORE_FILE":case 188:t.vmstatCounters[r]=188}}if(null!=e.statPeriodMs&&(t.statPeriodMs=e.statPeriodMs>>>0),e.statCounters){if(!Array.isArray(e.statCounters))throw TypeError(".perfetto.protos.SysStatsConfig.statCounters: array expected");t.statCounters=[];for(r=0;r<e.statCounters.length;++r)switch(e.statCounters[r]){default:if("number"==typeof e.statCounters[r]){t.statCounters[r]=e.statCounters[r];break}case"STAT_UNSPECIFIED":case 0:t.statCounters[r]=0;break;case"STAT_CPU_TIMES":case 1:t.statCounters[r]=1;break;case"STAT_IRQ_COUNTS":case 2:t.statCounters[r]=2;break;case"STAT_SOFTIRQ_COUNTS":case 3:t.statCounters[r]=3;break;case"STAT_FORK_COUNT":case 4:t.statCounters[r]=4}}return null!=e.devfreqPeriodMs&&(t.devfreqPeriodMs=e.devfreqPeriodMs>>>0),null!=e.cpufreqPeriodMs&&(t.cpufreqPeriodMs=e.cpufreqPeriodMs>>>0),null!=e.buddyinfoPeriodMs&&(t.buddyinfoPeriodMs=e.buddyinfoPeriodMs>>>0),null!=e.diskstatPeriodMs&&(t.diskstatPeriodMs=e.diskstatPeriodMs>>>0),null!=e.psiPeriodMs&&(t.psiPeriodMs=e.psiPeriodMs>>>0),null!=e.thermalPeriodMs&&(t.thermalPeriodMs=e.thermalPeriodMs>>>0),null!=e.cpuidlePeriodMs&&(t.cpuidlePeriodMs=e.cpuidlePeriodMs>>>0),t},C.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.meminfoCounters=[],r.vmstatCounters=[],r.statCounters=[]),t.defaults&&(r.meminfoPeriodMs=0,r.vmstatPeriodMs=0,r.statPeriodMs=0,r.devfreqPeriodMs=0,r.cpufreqPeriodMs=0,r.buddyinfoPeriodMs=0,r.diskstatPeriodMs=0,r.psiPeriodMs=0,r.thermalPeriodMs=0,r.cpuidlePeriodMs=0),null!=e.meminfoPeriodMs&&e.hasOwnProperty("meminfoPeriodMs")&&(r.meminfoPeriodMs=e.meminfoPeriodMs),e.meminfoCounters&&e.meminfoCounters.length){r.meminfoCounters=[];for(var n=0;n<e.meminfoCounters.length;++n)r.meminfoCounters[n]=t.enums!==String||void 0===s.perfetto.protos.MeminfoCounters[e.meminfoCounters[n]]?e.meminfoCounters[n]:s.perfetto.protos.MeminfoCounters[e.meminfoCounters[n]]}if(null!=e.vmstatPeriodMs&&e.hasOwnProperty("vmstatPeriodMs")&&(r.vmstatPeriodMs=e.vmstatPeriodMs),e.vmstatCounters&&e.vmstatCounters.length){r.vmstatCounters=[];for(n=0;n<e.vmstatCounters.length;++n)r.vmstatCounters[n]=t.enums!==String||void 0===s.perfetto.protos.VmstatCounters[e.vmstatCounters[n]]?e.vmstatCounters[n]:s.perfetto.protos.VmstatCounters[e.vmstatCounters[n]]}if(null!=e.statPeriodMs&&e.hasOwnProperty("statPeriodMs")&&(r.statPeriodMs=e.statPeriodMs),e.statCounters&&e.statCounters.length){r.statCounters=[];for(n=0;n<e.statCounters.length;++n)r.statCounters[n]=t.enums!==String||void 0===s.perfetto.protos.SysStatsConfig.StatCounters[e.statCounters[n]]?e.statCounters[n]:s.perfetto.protos.SysStatsConfig.StatCounters[e.statCounters[n]]}return null!=e.devfreqPeriodMs&&e.hasOwnProperty("devfreqPeriodMs")&&(r.devfreqPeriodMs=e.devfreqPeriodMs),null!=e.cpufreqPeriodMs&&e.hasOwnProperty("cpufreqPeriodMs")&&(r.cpufreqPeriodMs=e.cpufreqPeriodMs),null!=e.buddyinfoPeriodMs&&e.hasOwnProperty("buddyinfoPeriodMs")&&(r.buddyinfoPeriodMs=e.buddyinfoPeriodMs),null!=e.diskstatPeriodMs&&e.hasOwnProperty("diskstatPeriodMs")&&(r.diskstatPeriodMs=e.diskstatPeriodMs),null!=e.psiPeriodMs&&e.hasOwnProperty("psiPeriodMs")&&(r.psiPeriodMs=e.psiPeriodMs),null!=e.thermalPeriodMs&&e.hasOwnProperty("thermalPeriodMs")&&(r.thermalPeriodMs=e.thermalPeriodMs),null!=e.cpuidlePeriodMs&&e.hasOwnProperty("cpuidlePeriodMs")&&(r.cpuidlePeriodMs=e.cpuidlePeriodMs),r},C.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},C.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.SysStatsConfig"},C.StatCounters=(t={},(e=Object.create(t))[t[0]="STAT_UNSPECIFIED"]=0,e[t[1]="STAT_CPU_TIMES"]=1,e[t[2]="STAT_IRQ_COUNTS"]=2,e[t[3]="STAT_SOFTIRQ_COUNTS"]=3,e[t[4]="STAT_FORK_COUNT"]=4,e),C),r.MeminfoCounters=(t={},(e=Object.create(t))[t[0]="MEMINFO_UNSPECIFIED"]=0,e[t[1]="MEMINFO_MEM_TOTAL"]=1,e[t[2]="MEMINFO_MEM_FREE"]=2,e[t[3]="MEMINFO_MEM_AVAILABLE"]=3,e[t[4]="MEMINFO_BUFFERS"]=4,e[t[5]="MEMINFO_CACHED"]=5,e[t[6]="MEMINFO_SWAP_CACHED"]=6,e[t[7]="MEMINFO_ACTIVE"]=7,e[t[8]="MEMINFO_INACTIVE"]=8,e[t[9]="MEMINFO_ACTIVE_ANON"]=9,e[t[10]="MEMINFO_INACTIVE_ANON"]=10,e[t[11]="MEMINFO_ACTIVE_FILE"]=11,e[t[12]="MEMINFO_INACTIVE_FILE"]=12,e[t[13]="MEMINFO_UNEVICTABLE"]=13,e[t[14]="MEMINFO_MLOCKED"]=14,e[t[15]="MEMINFO_SWAP_TOTAL"]=15,e[t[16]="MEMINFO_SWAP_FREE"]=16,e[t[17]="MEMINFO_DIRTY"]=17,e[t[18]="MEMINFO_WRITEBACK"]=18,e[t[19]="MEMINFO_ANON_PAGES"]=19,e[t[20]="MEMINFO_MAPPED"]=20,e[t[21]="MEMINFO_SHMEM"]=21,e[t[22]="MEMINFO_SLAB"]=22,e[t[23]="MEMINFO_SLAB_RECLAIMABLE"]=23,e[t[24]="MEMINFO_SLAB_UNRECLAIMABLE"]=24,e[t[25]="MEMINFO_KERNEL_STACK"]=25,e[t[26]="MEMINFO_PAGE_TABLES"]=26,e[t[27]="MEMINFO_COMMIT_LIMIT"]=27,e[t[28]="MEMINFO_COMMITED_AS"]=28,e[t[29]="MEMINFO_VMALLOC_TOTAL"]=29,e[t[30]="MEMINFO_VMALLOC_USED"]=30,e[t[31]="MEMINFO_VMALLOC_CHUNK"]=31,e[t[32]="MEMINFO_CMA_TOTAL"]=32,e[t[33]="MEMINFO_CMA_FREE"]=33,e[t[34]="MEMINFO_GPU"]=34,e[t[35]="MEMINFO_ZRAM"]=35,e[t[36]="MEMINFO_MISC"]=36,e[t[37]="MEMINFO_ION_HEAP"]=37,e[t[38]="MEMINFO_ION_HEAP_POOL"]=38,e),r.VmstatCounters=(t={},(e=Object.create(t))[t[0]="VMSTAT_UNSPECIFIED"]=0,e[t[1]="VMSTAT_NR_FREE_PAGES"]=1,e[t[2]="VMSTAT_NR_ALLOC_BATCH"]=2,e[t[3]="VMSTAT_NR_INACTIVE_ANON"]=3,e[t[4]="VMSTAT_NR_ACTIVE_ANON"]=4,e[t[5]="VMSTAT_NR_INACTIVE_FILE"]=5,e[t[6]="VMSTAT_NR_ACTIVE_FILE"]=6,e[t[7]="VMSTAT_NR_UNEVICTABLE"]=7,e[t[8]="VMSTAT_NR_MLOCK"]=8,e[t[9]="VMSTAT_NR_ANON_PAGES"]=9,e[t[10]="VMSTAT_NR_MAPPED"]=10,e[t[11]="VMSTAT_NR_FILE_PAGES"]=11,e[t[12]="VMSTAT_NR_DIRTY"]=12,e[t[13]="VMSTAT_NR_WRITEBACK"]=13,e[t[14]="VMSTAT_NR_SLAB_RECLAIMABLE"]=14,e[t[15]="VMSTAT_NR_SLAB_UNRECLAIMABLE"]=15,e[t[16]="VMSTAT_NR_PAGE_TABLE_PAGES"]=16,e[t[17]="VMSTAT_NR_KERNEL_STACK"]=17,e[t[18]="VMSTAT_NR_OVERHEAD"]=18,e[t[19]="VMSTAT_NR_UNSTABLE"]=19,e[t[20]="VMSTAT_NR_BOUNCE"]=20,e[t[21]="VMSTAT_NR_VMSCAN_WRITE"]=21,e[t[22]="VMSTAT_NR_VMSCAN_IMMEDIATE_RECLAIM"]=22,e[t[23]="VMSTAT_NR_WRITEBACK_TEMP"]=23,e[t[24]="VMSTAT_NR_ISOLATED_ANON"]=24,e[t[25]="VMSTAT_NR_ISOLATED_FILE"]=25,e[t[26]="VMSTAT_NR_SHMEM"]=26,e[t[27]="VMSTAT_NR_DIRTIED"]=27,e[t[28]="VMSTAT_NR_WRITTEN"]=28,e[t[29]="VMSTAT_NR_PAGES_SCANNED"]=29,e[t[30]="VMSTAT_WORKINGSET_REFAULT"]=30,e[t[31]="VMSTAT_WORKINGSET_ACTIVATE"]=31,e[t[32]="VMSTAT_WORKINGSET_NODERECLAIM"]=32,e[t[33]="VMSTAT_NR_ANON_TRANSPARENT_HUGEPAGES"]=33,e[t[34]="VMSTAT_NR_FREE_CMA"]=34,e[t[35]="VMSTAT_NR_SWAPCACHE"]=35,e[t[36]="VMSTAT_NR_DIRTY_THRESHOLD"]=36,e[t[37]="VMSTAT_NR_DIRTY_BACKGROUND_THRESHOLD"]=37,e[t[38]="VMSTAT_PGPGIN"]=38,e[t[39]="VMSTAT_PGPGOUT"]=39,e[t[40]="VMSTAT_PGPGOUTCLEAN"]=40,e[t[41]="VMSTAT_PSWPIN"]=41,e[t[42]="VMSTAT_PSWPOUT"]=42,e[t[43]="VMSTAT_PGALLOC_DMA"]=43,e[t[44]="VMSTAT_PGALLOC_NORMAL"]=44,e[t[45]="VMSTAT_PGALLOC_MOVABLE"]=45,e[t[46]="VMSTAT_PGFREE"]=46,e[t[47]="VMSTAT_PGACTIVATE"]=47,e[t[48]="VMSTAT_PGDEACTIVATE"]=48,e[t[49]="VMSTAT_PGFAULT"]=49,e[t[50]="VMSTAT_PGMAJFAULT"]=50,e[t[51]="VMSTAT_PGREFILL_DMA"]=51,e[t[52]="VMSTAT_PGREFILL_NORMAL"]=52,e[t[53]="VMSTAT_PGREFILL_MOVABLE"]=53,e[t[54]="VMSTAT_PGSTEAL_KSWAPD_DMA"]=54,e[t[55]="VMSTAT_PGSTEAL_KSWAPD_NORMAL"]=55,e[t[56]="VMSTAT_PGSTEAL_KSWAPD_MOVABLE"]=56,e[t[57]="VMSTAT_PGSTEAL_DIRECT_DMA"]=57,e[t[58]="VMSTAT_PGSTEAL_DIRECT_NORMAL"]=58,e[t[59]="VMSTAT_PGSTEAL_DIRECT_MOVABLE"]=59,e[t[60]="VMSTAT_PGSCAN_KSWAPD_DMA"]=60,e[t[61]="VMSTAT_PGSCAN_KSWAPD_NORMAL"]=61,e[t[62]="VMSTAT_PGSCAN_KSWAPD_MOVABLE"]=62,e[t[63]="VMSTAT_PGSCAN_DIRECT_DMA"]=63,e[t[64]="VMSTAT_PGSCAN_DIRECT_NORMAL"]=64,e[t[65]="VMSTAT_PGSCAN_DIRECT_MOVABLE"]=65,e[t[66]="VMSTAT_PGSCAN_DIRECT_THROTTLE"]=66,e[t[67]="VMSTAT_PGINODESTEAL"]=67,e[t[68]="VMSTAT_SLABS_SCANNED"]=68,e[t[69]="VMSTAT_KSWAPD_INODESTEAL"]=69,e[t[70]="VMSTAT_KSWAPD_LOW_WMARK_HIT_QUICKLY"]=70,e[t[71]="VMSTAT_KSWAPD_HIGH_WMARK_HIT_QUICKLY"]=71,e[t[72]="VMSTAT_PAGEOUTRUN"]=72,e[t[73]="VMSTAT_ALLOCSTALL"]=73,e[t[74]="VMSTAT_PGROTATED"]=74,e[t[75]="VMSTAT_DROP_PAGECACHE"]=75,e[t[76]="VMSTAT_DROP_SLAB"]=76,e[t[77]="VMSTAT_PGMIGRATE_SUCCESS"]=77,e[t[78]="VMSTAT_PGMIGRATE_FAIL"]=78,e[t[79]="VMSTAT_COMPACT_MIGRATE_SCANNED"]=79,e[t[80]="VMSTAT_COMPACT_FREE_SCANNED"]=80,e[t[81]="VMSTAT_COMPACT_ISOLATED"]=81,e[t[82]="VMSTAT_COMPACT_STALL"]=82,e[t[83]="VMSTAT_COMPACT_FAIL"]=83,e[t[84]="VMSTAT_COMPACT_SUCCESS"]=84,e[t[85]="VMSTAT_COMPACT_DAEMON_WAKE"]=85,e[t[86]="VMSTAT_UNEVICTABLE_PGS_CULLED"]=86,e[t[87]="VMSTAT_UNEVICTABLE_PGS_SCANNED"]=87,e[t[88]="VMSTAT_UNEVICTABLE_PGS_RESCUED"]=88,e[t[89]="VMSTAT_UNEVICTABLE_PGS_MLOCKED"]=89,e[t[90]="VMSTAT_UNEVICTABLE_PGS_MUNLOCKED"]=90,e[t[91]="VMSTAT_UNEVICTABLE_PGS_CLEARED"]=91,e[t[92]="VMSTAT_UNEVICTABLE_PGS_STRANDED"]=92,e[t[93]="VMSTAT_NR_ZSPAGES"]=93,e[t[94]="VMSTAT_NR_ION_HEAP"]=94,e[t[95]="VMSTAT_NR_GPU_HEAP"]=95,e[t[96]="VMSTAT_ALLOCSTALL_DMA"]=96,e[t[97]="VMSTAT_ALLOCSTALL_MOVABLE"]=97,e[t[98]="VMSTAT_ALLOCSTALL_NORMAL"]=98,e[t[99]="VMSTAT_COMPACT_DAEMON_FREE_SCANNED"]=99,e[t[100]="VMSTAT_COMPACT_DAEMON_MIGRATE_SCANNED"]=100,e[t[101]="VMSTAT_NR_FASTRPC"]=101,e[t[102]="VMSTAT_NR_INDIRECTLY_RECLAIMABLE"]=102,e[t[103]="VMSTAT_NR_ION_HEAP_POOL"]=103,e[t[104]="VMSTAT_NR_KERNEL_MISC_RECLAIMABLE"]=104,e[t[105]="VMSTAT_NR_SHADOW_CALL_STACK_BYTES"]=105,e[t[106]="VMSTAT_NR_SHMEM_HUGEPAGES"]=106,e[t[107]="VMSTAT_NR_SHMEM_PMDMAPPED"]=107,e[t[108]="VMSTAT_NR_UNRECLAIMABLE_PAGES"]=108,e[t[109]="VMSTAT_NR_ZONE_ACTIVE_ANON"]=109,e[t[110]="VMSTAT_NR_ZONE_ACTIVE_FILE"]=110,e[t[111]="VMSTAT_NR_ZONE_INACTIVE_ANON"]=111,e[t[112]="VMSTAT_NR_ZONE_INACTIVE_FILE"]=112,e[t[113]="VMSTAT_NR_ZONE_UNEVICTABLE"]=113,e[t[114]="VMSTAT_NR_ZONE_WRITE_PENDING"]=114,e[t[115]="VMSTAT_OOM_KILL"]=115,e[t[116]="VMSTAT_PGLAZYFREE"]=116,e[t[117]="VMSTAT_PGLAZYFREED"]=117,e[t[118]="VMSTAT_PGREFILL"]=118,e[t[119]="VMSTAT_PGSCAN_DIRECT"]=119,e[t[120]="VMSTAT_PGSCAN_KSWAPD"]=120,e[t[121]="VMSTAT_PGSKIP_DMA"]=121,e[t[122]="VMSTAT_PGSKIP_MOVABLE"]=122,e[t[123]="VMSTAT_PGSKIP_NORMAL"]=123,e[t[124]="VMSTAT_PGSTEAL_DIRECT"]=124,e[t[125]="VMSTAT_PGSTEAL_KSWAPD"]=125,e[t[126]="VMSTAT_SWAP_RA"]=126,e[t[127]="VMSTAT_SWAP_RA_HIT"]=127,e[t[128]="VMSTAT_WORKINGSET_RESTORE"]=128,e[t[129]="VMSTAT_ALLOCSTALL_DEVICE"]=129,e[t[130]="VMSTAT_ALLOCSTALL_DMA32"]=130,e[t[131]="VMSTAT_BALLOON_DEFLATE"]=131,e[t[132]="VMSTAT_BALLOON_INFLATE"]=132,e[t[133]="VMSTAT_BALLOON_MIGRATE"]=133,e[t[134]="VMSTAT_CMA_ALLOC_FAIL"]=134,e[t[135]="VMSTAT_CMA_ALLOC_SUCCESS"]=135,e[t[136]="VMSTAT_NR_FILE_HUGEPAGES"]=136,e[t[137]="VMSTAT_NR_FILE_PMDMAPPED"]=137,e[t[138]="VMSTAT_NR_FOLL_PIN_ACQUIRED"]=138,e[t[139]="VMSTAT_NR_FOLL_PIN_RELEASED"]=139,e[t[140]="VMSTAT_NR_SEC_PAGE_TABLE_PAGES"]=140,e[t[141]="VMSTAT_NR_SHADOW_CALL_STACK"]=141,e[t[142]="VMSTAT_NR_SWAPCACHED"]=142,e[t[143]="VMSTAT_NR_THROTTLED_WRITTEN"]=143,e[t[144]="VMSTAT_PGALLOC_DEVICE"]=144,e[t[145]="VMSTAT_PGALLOC_DMA32"]=145,e[t[146]="VMSTAT_PGDEMOTE_DIRECT"]=146,e[t[147]="VMSTAT_PGDEMOTE_KSWAPD"]=147,e[t[148]="VMSTAT_PGREUSE"]=148,e[t[149]="VMSTAT_PGSCAN_ANON"]=149,e[t[150]="VMSTAT_PGSCAN_FILE"]=150,e[t[151]="VMSTAT_PGSKIP_DEVICE"]=151,e[t[152]="VMSTAT_PGSKIP_DMA32"]=152,e[t[153]="VMSTAT_PGSTEAL_ANON"]=153,e[t[154]="VMSTAT_PGSTEAL_FILE"]=154,e[t[155]="VMSTAT_THP_COLLAPSE_ALLOC"]=155,e[t[156]="VMSTAT_THP_COLLAPSE_ALLOC_FAILED"]=156,e[t[157]="VMSTAT_THP_DEFERRED_SPLIT_PAGE"]=157,e[t[158]="VMSTAT_THP_FAULT_ALLOC"]=158,e[t[159]="VMSTAT_THP_FAULT_FALLBACK"]=159,e[t[160]="VMSTAT_THP_FAULT_FALLBACK_CHARGE"]=160,e[t[161]="VMSTAT_THP_FILE_ALLOC"]=161,e[t[162]="VMSTAT_THP_FILE_FALLBACK"]=162,e[t[163]="VMSTAT_THP_FILE_FALLBACK_CHARGE"]=163,e[t[164]="VMSTAT_THP_FILE_MAPPED"]=164,e[t[165]="VMSTAT_THP_MIGRATION_FAIL"]=165,e[t[166]="VMSTAT_THP_MIGRATION_SPLIT"]=166,e[t[167]="VMSTAT_THP_MIGRATION_SUCCESS"]=167,e[t[168]="VMSTAT_THP_SCAN_EXCEED_NONE_PTE"]=168,e[t[169]="VMSTAT_THP_SCAN_EXCEED_SHARE_PTE"]=169,e[t[170]="VMSTAT_THP_SCAN_EXCEED_SWAP_PTE"]=170,e[t[171]="VMSTAT_THP_SPLIT_PAGE"]=171,e[t[172]="VMSTAT_THP_SPLIT_PAGE_FAILED"]=172,e[t[173]="VMSTAT_THP_SPLIT_PMD"]=173,e[t[174]="VMSTAT_THP_SWPOUT"]=174,e[t[175]="VMSTAT_THP_SWPOUT_FALLBACK"]=175,e[t[176]="VMSTAT_THP_ZERO_PAGE_ALLOC"]=176,e[t[177]="VMSTAT_THP_ZERO_PAGE_ALLOC_FAILED"]=177,e[t[178]="VMSTAT_VMA_LOCK_ABORT"]=178,e[t[179]="VMSTAT_VMA_LOCK_MISS"]=179,e[t[180]="VMSTAT_VMA_LOCK_RETRY"]=180,e[t[181]="VMSTAT_VMA_LOCK_SUCCESS"]=181,e[t[182]="VMSTAT_WORKINGSET_ACTIVATE_ANON"]=182,e[t[183]="VMSTAT_WORKINGSET_ACTIVATE_FILE"]=183,e[t[184]="VMSTAT_WORKINGSET_NODES"]=184,e[t[185]="VMSTAT_WORKINGSET_REFAULT_ANON"]=185,e[t[186]="VMSTAT_WORKINGSET_REFAULT_FILE"]=186,e[t[187]="VMSTAT_WORKINGSET_RESTORE_ANON"]=187,e[t[188]="VMSTAT_WORKINGSET_RESTORE_FILE"]=188,e),r.TestConfig=(Ct.prototype.messageCount=0,Ct.prototype.maxMessagesPerSecond=0,Ct.prototype.seed=0,Ct.prototype.messageSize=0,Ct.prototype.sendBatchOnRegister=!1,Ct.prototype.dummyFields=null,Ct.create=function(e){return new Ct(e)},Ct.encode=function(e,t){return t=t||a.create(),null!=e.messageCount&&Object.hasOwnProperty.call(e,"messageCount")&&t.uint32(8).uint32(e.messageCount),null!=e.maxMessagesPerSecond&&Object.hasOwnProperty.call(e,"maxMessagesPerSecond")&&t.uint32(16).uint32(e.maxMessagesPerSecond),null!=e.seed&&Object.hasOwnProperty.call(e,"seed")&&t.uint32(24).uint32(e.seed),null!=e.messageSize&&Object.hasOwnProperty.call(e,"messageSize")&&t.uint32(32).uint32(e.messageSize),null!=e.sendBatchOnRegister&&Object.hasOwnProperty.call(e,"sendBatchOnRegister")&&t.uint32(40).bool(e.sendBatchOnRegister),null!=e.dummyFields&&Object.hasOwnProperty.call(e,"dummyFields")&&s.perfetto.protos.TestConfig.DummyFields.encode(e.dummyFields,t.uint32(50).fork()).ldelim(),t},Ct.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TestConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.messageCount=e.uint32();break;case 2:n.maxMessagesPerSecond=e.uint32();break;case 3:n.seed=e.uint32();break;case 4:n.messageSize=e.uint32();break;case 5:n.sendBatchOnRegister=e.bool();break;case 6:n.dummyFields=s.perfetto.protos.TestConfig.DummyFields.decode(e,e.uint32());break;default:e.skipType(7&a)}}return n},Ct.fromObject=function(e){if(e instanceof s.perfetto.protos.TestConfig)return e;var t=new s.perfetto.protos.TestConfig;if(null!=e.messageCount&&(t.messageCount=e.messageCount>>>0),null!=e.maxMessagesPerSecond&&(t.maxMessagesPerSecond=e.maxMessagesPerSecond>>>0),null!=e.seed&&(t.seed=e.seed>>>0),null!=e.messageSize&&(t.messageSize=e.messageSize>>>0),null!=e.sendBatchOnRegister&&(t.sendBatchOnRegister=Boolean(e.sendBatchOnRegister)),null!=e.dummyFields){if("object"!=typeof e.dummyFields)throw TypeError(".perfetto.protos.TestConfig.dummyFields: object expected");t.dummyFields=s.perfetto.protos.TestConfig.DummyFields.fromObject(e.dummyFields)}return t},Ct.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.messageCount=0,r.maxMessagesPerSecond=0,r.seed=0,r.messageSize=0,r.sendBatchOnRegister=!1,r.dummyFields=null),null!=e.messageCount&&e.hasOwnProperty("messageCount")&&(r.messageCount=e.messageCount),null!=e.maxMessagesPerSecond&&e.hasOwnProperty("maxMessagesPerSecond")&&(r.maxMessagesPerSecond=e.maxMessagesPerSecond),null!=e.seed&&e.hasOwnProperty("seed")&&(r.seed=e.seed),null!=e.messageSize&&e.hasOwnProperty("messageSize")&&(r.messageSize=e.messageSize),null!=e.sendBatchOnRegister&&e.hasOwnProperty("sendBatchOnRegister")&&(r.sendBatchOnRegister=e.sendBatchOnRegister),null!=e.dummyFields&&e.hasOwnProperty("dummyFields")&&(r.dummyFields=s.perfetto.protos.TestConfig.DummyFields.toObject(e.dummyFields,t)),r},Ct.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Ct.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TestConfig"},Ct.DummyFields=(k.prototype.fieldUint32=0,k.prototype.fieldInt32=0,k.prototype.fieldUint64=i.Long?i.Long.fromBits(0,0,!0):0,k.prototype.fieldInt64=i.Long?i.Long.fromBits(0,0,!1):0,k.prototype.fieldFixed64=i.Long?i.Long.fromBits(0,0,!1):0,k.prototype.fieldSfixed64=i.Long?i.Long.fromBits(0,0,!1):0,k.prototype.fieldFixed32=0,k.prototype.fieldSfixed32=0,k.prototype.fieldDouble=0,k.prototype.fieldFloat=0,k.prototype.fieldSint64=i.Long?i.Long.fromBits(0,0,!1):0,k.prototype.fieldSint32=0,k.prototype.fieldString="",k.prototype.fieldBytes=i.newBuffer([]),k.create=function(e){return new k(e)},k.encode=function(e,t){return t=t||a.create(),null!=e.fieldUint32&&Object.hasOwnProperty.call(e,"fieldUint32")&&t.uint32(8).uint32(e.fieldUint32),null!=e.fieldInt32&&Object.hasOwnProperty.call(e,"fieldInt32")&&t.uint32(16).int32(e.fieldInt32),null!=e.fieldUint64&&Object.hasOwnProperty.call(e,"fieldUint64")&&t.uint32(24).uint64(e.fieldUint64),null!=e.fieldInt64&&Object.hasOwnProperty.call(e,"fieldInt64")&&t.uint32(32).int64(e.fieldInt64),null!=e.fieldFixed64&&Object.hasOwnProperty.call(e,"fieldFixed64")&&t.uint32(41).fixed64(e.fieldFixed64),null!=e.fieldSfixed64&&Object.hasOwnProperty.call(e,"fieldSfixed64")&&t.uint32(49).sfixed64(e.fieldSfixed64),null!=e.fieldFixed32&&Object.hasOwnProperty.call(e,"fieldFixed32")&&t.uint32(61).fixed32(e.fieldFixed32),null!=e.fieldSfixed32&&Object.hasOwnProperty.call(e,"fieldSfixed32")&&t.uint32(69).sfixed32(e.fieldSfixed32),null!=e.fieldDouble&&Object.hasOwnProperty.call(e,"fieldDouble")&&t.uint32(73).double(e.fieldDouble),null!=e.fieldFloat&&Object.hasOwnProperty.call(e,"fieldFloat")&&t.uint32(85).float(e.fieldFloat),null!=e.fieldSint64&&Object.hasOwnProperty.call(e,"fieldSint64")&&t.uint32(88).sint64(e.fieldSint64),null!=e.fieldSint32&&Object.hasOwnProperty.call(e,"fieldSint32")&&t.uint32(96).sint32(e.fieldSint32),null!=e.fieldString&&Object.hasOwnProperty.call(e,"fieldString")&&t.uint32(106).string(e.fieldString),null!=e.fieldBytes&&Object.hasOwnProperty.call(e,"fieldBytes")&&t.uint32(114).bytes(e.fieldBytes),t},k.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TestConfig.DummyFields;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.fieldUint32=e.uint32();break;case 2:n.fieldInt32=e.int32();break;case 3:n.fieldUint64=e.uint64();break;case 4:n.fieldInt64=e.int64();break;case 5:n.fieldFixed64=e.fixed64();break;case 6:n.fieldSfixed64=e.sfixed64();break;case 7:n.fieldFixed32=e.fixed32();break;case 8:n.fieldSfixed32=e.sfixed32();break;case 9:n.fieldDouble=e.double();break;case 10:n.fieldFloat=e.float();break;case 11:n.fieldSint64=e.sint64();break;case 12:n.fieldSint32=e.sint32();break;case 13:n.fieldString=e.string();break;case 14:n.fieldBytes=e.bytes();break;default:e.skipType(7&a)}}return n},k.fromObject=function(e){var t;return e instanceof s.perfetto.protos.TestConfig.DummyFields?e:(t=new s.perfetto.protos.TestConfig.DummyFields,null!=e.fieldUint32&&(t.fieldUint32=e.fieldUint32>>>0),null!=e.fieldInt32&&(t.fieldInt32=0|e.fieldInt32),null!=e.fieldUint64&&(i.Long?(t.fieldUint64=i.Long.fromValue(e.fieldUint64)).unsigned=!0:"string"==typeof e.fieldUint64?t.fieldUint64=parseInt(e.fieldUint64,10):"number"==typeof e.fieldUint64?t.fieldUint64=e.fieldUint64:"object"==typeof e.fieldUint64&&(t.fieldUint64=new i.LongBits(e.fieldUint64.low>>>0,e.fieldUint64.high>>>0).toNumber(!0))),null!=e.fieldInt64&&(i.Long?(t.fieldInt64=i.Long.fromValue(e.fieldInt64)).unsigned=!1:"string"==typeof e.fieldInt64?t.fieldInt64=parseInt(e.fieldInt64,10):"number"==typeof e.fieldInt64?t.fieldInt64=e.fieldInt64:"object"==typeof e.fieldInt64&&(t.fieldInt64=new i.LongBits(e.fieldInt64.low>>>0,e.fieldInt64.high>>>0).toNumber())),null!=e.fieldFixed64&&(i.Long?(t.fieldFixed64=i.Long.fromValue(e.fieldFixed64)).unsigned=!1:"string"==typeof e.fieldFixed64?t.fieldFixed64=parseInt(e.fieldFixed64,10):"number"==typeof e.fieldFixed64?t.fieldFixed64=e.fieldFixed64:"object"==typeof e.fieldFixed64&&(t.fieldFixed64=new i.LongBits(e.fieldFixed64.low>>>0,e.fieldFixed64.high>>>0).toNumber())),null!=e.fieldSfixed64&&(i.Long?(t.fieldSfixed64=i.Long.fromValue(e.fieldSfixed64)).unsigned=!1:"string"==typeof e.fieldSfixed64?t.fieldSfixed64=parseInt(e.fieldSfixed64,10):"number"==typeof e.fieldSfixed64?t.fieldSfixed64=e.fieldSfixed64:"object"==typeof e.fieldSfixed64&&(t.fieldSfixed64=new i.LongBits(e.fieldSfixed64.low>>>0,e.fieldSfixed64.high>>>0).toNumber())),null!=e.fieldFixed32&&(t.fieldFixed32=e.fieldFixed32>>>0),null!=e.fieldSfixed32&&(t.fieldSfixed32=0|e.fieldSfixed32),null!=e.fieldDouble&&(t.fieldDouble=Number(e.fieldDouble)),null!=e.fieldFloat&&(t.fieldFloat=Number(e.fieldFloat)),null!=e.fieldSint64&&(i.Long?(t.fieldSint64=i.Long.fromValue(e.fieldSint64)).unsigned=!1:"string"==typeof e.fieldSint64?t.fieldSint64=parseInt(e.fieldSint64,10):"number"==typeof e.fieldSint64?t.fieldSint64=e.fieldSint64:"object"==typeof e.fieldSint64&&(t.fieldSint64=new i.LongBits(e.fieldSint64.low>>>0,e.fieldSint64.high>>>0).toNumber())),null!=e.fieldSint32&&(t.fieldSint32=0|e.fieldSint32),null!=e.fieldString&&(t.fieldString=String(e.fieldString)),null!=e.fieldBytes&&("string"==typeof e.fieldBytes?i.base64.decode(e.fieldBytes,t.fieldBytes=i.newBuffer(i.base64.length(e.fieldBytes)),0):0<=e.fieldBytes.length&&(t.fieldBytes=e.fieldBytes)),t)},k.toObject=function(e,t){var r,n={};return(t=t||{}).defaults&&(n.fieldUint32=0,n.fieldInt32=0,i.Long?(r=new i.Long(0,0,!0),n.fieldUint64=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.fieldUint64=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!1),n.fieldInt64=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.fieldInt64=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!1),n.fieldFixed64=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.fieldFixed64=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!1),n.fieldSfixed64=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.fieldSfixed64=t.longs===String?"0":0,n.fieldFixed32=0,n.fieldSfixed32=0,n.fieldDouble=0,n.fieldFloat=0,i.Long?(r=new i.Long(0,0,!1),n.fieldSint64=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.fieldSint64=t.longs===String?"0":0,n.fieldSint32=0,n.fieldString="",t.bytes===String?n.fieldBytes="":(n.fieldBytes=[],t.bytes!==Array&&(n.fieldBytes=i.newBuffer(n.fieldBytes)))),null!=e.fieldUint32&&e.hasOwnProperty("fieldUint32")&&(n.fieldUint32=e.fieldUint32),null!=e.fieldInt32&&e.hasOwnProperty("fieldInt32")&&(n.fieldInt32=e.fieldInt32),null!=e.fieldUint64&&e.hasOwnProperty("fieldUint64")&&("number"==typeof e.fieldUint64?n.fieldUint64=t.longs===String?String(e.fieldUint64):e.fieldUint64:n.fieldUint64=t.longs===String?i.Long.prototype.toString.call(e.fieldUint64):t.longs===Number?new i.LongBits(e.fieldUint64.low>>>0,e.fieldUint64.high>>>0).toNumber(!0):e.fieldUint64),null!=e.fieldInt64&&e.hasOwnProperty("fieldInt64")&&("number"==typeof e.fieldInt64?n.fieldInt64=t.longs===String?String(e.fieldInt64):e.fieldInt64:n.fieldInt64=t.longs===String?i.Long.prototype.toString.call(e.fieldInt64):t.longs===Number?new i.LongBits(e.fieldInt64.low>>>0,e.fieldInt64.high>>>0).toNumber():e.fieldInt64),null!=e.fieldFixed64&&e.hasOwnProperty("fieldFixed64")&&("number"==typeof e.fieldFixed64?n.fieldFixed64=t.longs===String?String(e.fieldFixed64):e.fieldFixed64:n.fieldFixed64=t.longs===String?i.Long.prototype.toString.call(e.fieldFixed64):t.longs===Number?new i.LongBits(e.fieldFixed64.low>>>0,e.fieldFixed64.high>>>0).toNumber():e.fieldFixed64),null!=e.fieldSfixed64&&e.hasOwnProperty("fieldSfixed64")&&("number"==typeof e.fieldSfixed64?n.fieldSfixed64=t.longs===String?String(e.fieldSfixed64):e.fieldSfixed64:n.fieldSfixed64=t.longs===String?i.Long.prototype.toString.call(e.fieldSfixed64):t.longs===Number?new i.LongBits(e.fieldSfixed64.low>>>0,e.fieldSfixed64.high>>>0).toNumber():e.fieldSfixed64),null!=e.fieldFixed32&&e.hasOwnProperty("fieldFixed32")&&(n.fieldFixed32=e.fieldFixed32),null!=e.fieldSfixed32&&e.hasOwnProperty("fieldSfixed32")&&(n.fieldSfixed32=e.fieldSfixed32),null!=e.fieldDouble&&e.hasOwnProperty("fieldDouble")&&(n.fieldDouble=t.json&&!isFinite(e.fieldDouble)?String(e.fieldDouble):e.fieldDouble),null!=e.fieldFloat&&e.hasOwnProperty("fieldFloat")&&(n.fieldFloat=t.json&&!isFinite(e.fieldFloat)?String(e.fieldFloat):e.fieldFloat),null!=e.fieldSint64&&e.hasOwnProperty("fieldSint64")&&("number"==typeof e.fieldSint64?n.fieldSint64=t.longs===String?String(e.fieldSint64):e.fieldSint64:n.fieldSint64=t.longs===String?i.Long.prototype.toString.call(e.fieldSint64):t.longs===Number?new i.LongBits(e.fieldSint64.low>>>0,e.fieldSint64.high>>>0).toNumber():e.fieldSint64),null!=e.fieldSint32&&e.hasOwnProperty("fieldSint32")&&(n.fieldSint32=e.fieldSint32),null!=e.fieldString&&e.hasOwnProperty("fieldString")&&(n.fieldString=e.fieldString),null!=e.fieldBytes&&e.hasOwnProperty("fieldBytes")&&(n.fieldBytes=t.bytes===String?i.base64.encode(e.fieldBytes,0,e.fieldBytes.length):t.bytes===Array?Array.prototype.slice.call(e.fieldBytes):e.fieldBytes),n},k.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},k.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TestConfig.DummyFields"},k),Ct),r.TrackEventConfig=(w.prototype.disabledCategories=i.emptyArray,w.prototype.enabledCategories=i.emptyArray,w.prototype.disabledTags=i.emptyArray,w.prototype.enabledTags=i.emptyArray,w.prototype.disableIncrementalTimestamps=!1,w.prototype.timestampUnitMultiplier=i.Long?i.Long.fromBits(0,0,!0):0,w.prototype.filterDebugAnnotations=!1,w.prototype.enableThreadTimeSampling=!1,w.prototype.filterDynamicEventNames=!1,w.create=function(e){return new w(e)},w.encode=function(e,t){if(t=t||a.create(),null!=e.disabledCategories&&e.disabledCategories.length)for(var r=0;r<e.disabledCategories.length;++r)t.uint32(10).string(e.disabledCategories[r]);if(null!=e.enabledCategories&&e.enabledCategories.length)for(r=0;r<e.enabledCategories.length;++r)t.uint32(18).string(e.enabledCategories[r]);if(null!=e.disabledTags&&e.disabledTags.length)for(r=0;r<e.disabledTags.length;++r)t.uint32(26).string(e.disabledTags[r]);if(null!=e.enabledTags&&e.enabledTags.length)for(r=0;r<e.enabledTags.length;++r)t.uint32(34).string(e.enabledTags[r]);return null!=e.disableIncrementalTimestamps&&Object.hasOwnProperty.call(e,"disableIncrementalTimestamps")&&t.uint32(40).bool(e.disableIncrementalTimestamps),null!=e.timestampUnitMultiplier&&Object.hasOwnProperty.call(e,"timestampUnitMultiplier")&&t.uint32(48).uint64(e.timestampUnitMultiplier),null!=e.filterDebugAnnotations&&Object.hasOwnProperty.call(e,"filterDebugAnnotations")&&t.uint32(56).bool(e.filterDebugAnnotations),null!=e.enableThreadTimeSampling&&Object.hasOwnProperty.call(e,"enableThreadTimeSampling")&&t.uint32(64).bool(e.enableThreadTimeSampling),null!=e.filterDynamicEventNames&&Object.hasOwnProperty.call(e,"filterDynamicEventNames")&&t.uint32(72).bool(e.filterDynamicEventNames),t},w.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TrackEventConfig;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.disabledCategories&&n.disabledCategories.length||(n.disabledCategories=[]),n.disabledCategories.push(e.string());break;case 2:n.enabledCategories&&n.enabledCategories.length||(n.enabledCategories=[]),n.enabledCategories.push(e.string());break;case 3:n.disabledTags&&n.disabledTags.length||(n.disabledTags=[]),n.disabledTags.push(e.string());break;case 4:n.enabledTags&&n.enabledTags.length||(n.enabledTags=[]),n.enabledTags.push(e.string());break;case 5:n.disableIncrementalTimestamps=e.bool();break;case 6:n.timestampUnitMultiplier=e.uint64();break;case 7:n.filterDebugAnnotations=e.bool();break;case 8:n.enableThreadTimeSampling=e.bool();break;case 9:n.filterDynamicEventNames=e.bool();break;default:e.skipType(7&a)}}return n},w.fromObject=function(e){if(e instanceof s.perfetto.protos.TrackEventConfig)return e;var t=new s.perfetto.protos.TrackEventConfig;if(e.disabledCategories){if(!Array.isArray(e.disabledCategories))throw TypeError(".perfetto.protos.TrackEventConfig.disabledCategories: array expected");t.disabledCategories=[];for(var r=0;r<e.disabledCategories.length;++r)t.disabledCategories[r]=String(e.disabledCategories[r])}if(e.enabledCategories){if(!Array.isArray(e.enabledCategories))throw TypeError(".perfetto.protos.TrackEventConfig.enabledCategories: array expected");t.enabledCategories=[];for(r=0;r<e.enabledCategories.length;++r)t.enabledCategories[r]=String(e.enabledCategories[r])}if(e.disabledTags){if(!Array.isArray(e.disabledTags))throw TypeError(".perfetto.protos.TrackEventConfig.disabledTags: array expected");t.disabledTags=[];for(r=0;r<e.disabledTags.length;++r)t.disabledTags[r]=String(e.disabledTags[r])}if(e.enabledTags){if(!Array.isArray(e.enabledTags))throw TypeError(".perfetto.protos.TrackEventConfig.enabledTags: array expected");t.enabledTags=[];for(r=0;r<e.enabledTags.length;++r)t.enabledTags[r]=String(e.enabledTags[r])}return null!=e.disableIncrementalTimestamps&&(t.disableIncrementalTimestamps=Boolean(e.disableIncrementalTimestamps)),null!=e.timestampUnitMultiplier&&(i.Long?(t.timestampUnitMultiplier=i.Long.fromValue(e.timestampUnitMultiplier)).unsigned=!0:"string"==typeof e.timestampUnitMultiplier?t.timestampUnitMultiplier=parseInt(e.timestampUnitMultiplier,10):"number"==typeof e.timestampUnitMultiplier?t.timestampUnitMultiplier=e.timestampUnitMultiplier:"object"==typeof e.timestampUnitMultiplier&&(t.timestampUnitMultiplier=new i.LongBits(e.timestampUnitMultiplier.low>>>0,e.timestampUnitMultiplier.high>>>0).toNumber(!0))),null!=e.filterDebugAnnotations&&(t.filterDebugAnnotations=Boolean(e.filterDebugAnnotations)),null!=e.enableThreadTimeSampling&&(t.enableThreadTimeSampling=Boolean(e.enableThreadTimeSampling)),null!=e.filterDynamicEventNames&&(t.filterDynamicEventNames=Boolean(e.filterDynamicEventNames)),t},w.toObject=function(e,t){var r,n={};if(((t=t||{}).arrays||t.defaults)&&(n.disabledCategories=[],n.enabledCategories=[],n.disabledTags=[],n.enabledTags=[]),t.defaults&&(n.disableIncrementalTimestamps=!1,i.Long?(r=new i.Long(0,0,!0),n.timestampUnitMultiplier=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.timestampUnitMultiplier=t.longs===String?"0":0,n.filterDebugAnnotations=!1,n.enableThreadTimeSampling=!1,n.filterDynamicEventNames=!1),e.disabledCategories&&e.disabledCategories.length){n.disabledCategories=[];for(var a=0;a<e.disabledCategories.length;++a)n.disabledCategories[a]=e.disabledCategories[a]}if(e.enabledCategories&&e.enabledCategories.length){n.enabledCategories=[];for(a=0;a<e.enabledCategories.length;++a)n.enabledCategories[a]=e.enabledCategories[a]}if(e.disabledTags&&e.disabledTags.length){n.disabledTags=[];for(a=0;a<e.disabledTags.length;++a)n.disabledTags[a]=e.disabledTags[a]}if(e.enabledTags&&e.enabledTags.length){n.enabledTags=[];for(a=0;a<e.enabledTags.length;++a)n.enabledTags[a]=e.enabledTags[a]}return null!=e.disableIncrementalTimestamps&&e.hasOwnProperty("disableIncrementalTimestamps")&&(n.disableIncrementalTimestamps=e.disableIncrementalTimestamps),null!=e.timestampUnitMultiplier&&e.hasOwnProperty("timestampUnitMultiplier")&&("number"==typeof e.timestampUnitMultiplier?n.timestampUnitMultiplier=t.longs===String?String(e.timestampUnitMultiplier):e.timestampUnitMultiplier:n.timestampUnitMultiplier=t.longs===String?i.Long.prototype.toString.call(e.timestampUnitMultiplier):t.longs===Number?new i.LongBits(e.timestampUnitMultiplier.low>>>0,e.timestampUnitMultiplier.high>>>0).toNumber(!0):e.timestampUnitMultiplier),null!=e.filterDebugAnnotations&&e.hasOwnProperty("filterDebugAnnotations")&&(n.filterDebugAnnotations=e.filterDebugAnnotations),null!=e.enableThreadTimeSampling&&e.hasOwnProperty("enableThreadTimeSampling")&&(n.enableThreadTimeSampling=e.enableThreadTimeSampling),null!=e.filterDynamicEventNames&&e.hasOwnProperty("filterDynamicEventNames")&&(n.filterDynamicEventNames=e.filterDynamicEventNames),n},w.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},w.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TrackEventConfig"},w),r.SystemInfoConfig=(kt.create=function(e){return new kt(e)},kt.encode=function(e,t){return t=t||a.create()},kt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,t=new s.perfetto.protos.SystemInfoConfig;e.pos<r;){var n=e.uint32();e.skipType(7&n)}return t},kt.fromObject=function(e){return e instanceof s.perfetto.protos.SystemInfoConfig?e:new s.perfetto.protos.SystemInfoConfig},kt.toObject=function(){return{}},kt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},kt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.SystemInfoConfig"},kt),r.IPCFrame=(R.prototype.requestId=i.Long?i.Long.fromBits(0,0,!0):0,R.prototype.msgBindService=null,R.prototype.msgBindServiceReply=null,R.prototype.msgInvokeMethod=null,R.prototype.msgInvokeMethodReply=null,R.prototype.msgRequestError=null,R.prototype.setPeerIdentity=null,R.prototype.dataForTesting=i.emptyArray,Object.defineProperty(R.prototype,"msg",{get:i.oneOfGetter(t=["msgBindService","msgBindServiceReply","msgInvokeMethod","msgInvokeMethodReply","msgRequestError","setPeerIdentity"]),set:i.oneOfSetter(t)}),R.create=function(e){return new R(e)},R.encode=function(e,t){if(t=t||a.create(),null!=e.dataForTesting&&e.dataForTesting.length)for(var r=0;r<e.dataForTesting.length;++r)t.uint32(10).bytes(e.dataForTesting[r]);return null!=e.requestId&&Object.hasOwnProperty.call(e,"requestId")&&t.uint32(16).uint64(e.requestId),null!=e.msgBindService&&Object.hasOwnProperty.call(e,"msgBindService")&&s.perfetto.protos.IPCFrame.BindService.encode(e.msgBindService,t.uint32(26).fork()).ldelim(),null!=e.msgBindServiceReply&&Object.hasOwnProperty.call(e,"msgBindServiceReply")&&s.perfetto.protos.IPCFrame.BindServiceReply.encode(e.msgBindServiceReply,t.uint32(34).fork()).ldelim(),null!=e.msgInvokeMethod&&Object.hasOwnProperty.call(e,"msgInvokeMethod")&&s.perfetto.protos.IPCFrame.InvokeMethod.encode(e.msgInvokeMethod,t.uint32(42).fork()).ldelim(),null!=e.msgInvokeMethodReply&&Object.hasOwnProperty.call(e,"msgInvokeMethodReply")&&s.perfetto.protos.IPCFrame.InvokeMethodReply.encode(e.msgInvokeMethodReply,t.uint32(50).fork()).ldelim(),null!=e.msgRequestError&&Object.hasOwnProperty.call(e,"msgRequestError")&&s.perfetto.protos.IPCFrame.RequestError.encode(e.msgRequestError,t.uint32(58).fork()).ldelim(),null!=e.setPeerIdentity&&Object.hasOwnProperty.call(e,"setPeerIdentity")&&s.perfetto.protos.IPCFrame.SetPeerIdentity.encode(e.setPeerIdentity,t.uint32(66).fork()).ldelim(),t},R.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.IPCFrame;e.pos<r;){var a=e.uint32();switch(a>>>3){case 2:n.requestId=e.uint64();break;case 3:n.msgBindService=s.perfetto.protos.IPCFrame.BindService.decode(e,e.uint32());break;case 4:n.msgBindServiceReply=s.perfetto.protos.IPCFrame.BindServiceReply.decode(e,e.uint32());break;case 5:n.msgInvokeMethod=s.perfetto.protos.IPCFrame.InvokeMethod.decode(e,e.uint32());break;case 6:n.msgInvokeMethodReply=s.perfetto.protos.IPCFrame.InvokeMethodReply.decode(e,e.uint32());break;case 7:n.msgRequestError=s.perfetto.protos.IPCFrame.RequestError.decode(e,e.uint32());break;case 8:n.setPeerIdentity=s.perfetto.protos.IPCFrame.SetPeerIdentity.decode(e,e.uint32());break;case 1:n.dataForTesting&&n.dataForTesting.length||(n.dataForTesting=[]),n.dataForTesting.push(e.bytes());break;default:e.skipType(7&a)}}return n},R.fromObject=function(e){if(e instanceof s.perfetto.protos.IPCFrame)return e;var t=new s.perfetto.protos.IPCFrame;if(null!=e.requestId&&(i.Long?(t.requestId=i.Long.fromValue(e.requestId)).unsigned=!0:"string"==typeof e.requestId?t.requestId=parseInt(e.requestId,10):"number"==typeof e.requestId?t.requestId=e.requestId:"object"==typeof e.requestId&&(t.requestId=new i.LongBits(e.requestId.low>>>0,e.requestId.high>>>0).toNumber(!0))),null!=e.msgBindService){if("object"!=typeof e.msgBindService)throw TypeError(".perfetto.protos.IPCFrame.msgBindService: object expected");t.msgBindService=s.perfetto.protos.IPCFrame.BindService.fromObject(e.msgBindService)}if(null!=e.msgBindServiceReply){if("object"!=typeof e.msgBindServiceReply)throw TypeError(".perfetto.protos.IPCFrame.msgBindServiceReply: object expected");t.msgBindServiceReply=s.perfetto.protos.IPCFrame.BindServiceReply.fromObject(e.msgBindServiceReply)}if(null!=e.msgInvokeMethod){if("object"!=typeof e.msgInvokeMethod)throw TypeError(".perfetto.protos.IPCFrame.msgInvokeMethod: object expected");t.msgInvokeMethod=s.perfetto.protos.IPCFrame.InvokeMethod.fromObject(e.msgInvokeMethod)}if(null!=e.msgInvokeMethodReply){if("object"!=typeof e.msgInvokeMethodReply)throw TypeError(".perfetto.protos.IPCFrame.msgInvokeMethodReply: object expected");t.msgInvokeMethodReply=s.perfetto.protos.IPCFrame.InvokeMethodReply.fromObject(e.msgInvokeMethodReply)}if(null!=e.msgRequestError){if("object"!=typeof e.msgRequestError)throw TypeError(".perfetto.protos.IPCFrame.msgRequestError: object expected");t.msgRequestError=s.perfetto.protos.IPCFrame.RequestError.fromObject(e.msgRequestError)}if(null!=e.setPeerIdentity){if("object"!=typeof e.setPeerIdentity)throw TypeError(".perfetto.protos.IPCFrame.setPeerIdentity: object expected");t.setPeerIdentity=s.perfetto.protos.IPCFrame.SetPeerIdentity.fromObject(e.setPeerIdentity)}if(e.dataForTesting){if(!Array.isArray(e.dataForTesting))throw TypeError(".perfetto.protos.IPCFrame.dataForTesting: array expected");t.dataForTesting=[];for(var r=0;r<e.dataForTesting.length;++r)"string"==typeof e.dataForTesting[r]?i.base64.decode(e.dataForTesting[r],t.dataForTesting[r]=i.newBuffer(i.base64.length(e.dataForTesting[r])),0):0<=e.dataForTesting[r].length&&(t.dataForTesting[r]=e.dataForTesting[r])}return t},R.toObject=function(e,t){var r,n={};if(((t=t||{}).arrays||t.defaults)&&(n.dataForTesting=[]),t.defaults&&(i.Long?(r=new i.Long(0,0,!0),n.requestId=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.requestId=t.longs===String?"0":0),e.dataForTesting&&e.dataForTesting.length){n.dataForTesting=[];for(var a=0;a<e.dataForTesting.length;++a)n.dataForTesting[a]=t.bytes===String?i.base64.encode(e.dataForTesting[a],0,e.dataForTesting[a].length):t.bytes===Array?Array.prototype.slice.call(e.dataForTesting[a]):e.dataForTesting[a]}return null!=e.requestId&&e.hasOwnProperty("requestId")&&("number"==typeof e.requestId?n.requestId=t.longs===String?String(e.requestId):e.requestId:n.requestId=t.longs===String?i.Long.prototype.toString.call(e.requestId):t.longs===Number?new i.LongBits(e.requestId.low>>>0,e.requestId.high>>>0).toNumber(!0):e.requestId),null!=e.msgBindService&&e.hasOwnProperty("msgBindService")&&(n.msgBindService=s.perfetto.protos.IPCFrame.BindService.toObject(e.msgBindService,t),t.oneofs)&&(n.msg="msgBindService"),null!=e.msgBindServiceReply&&e.hasOwnProperty("msgBindServiceReply")&&(n.msgBindServiceReply=s.perfetto.protos.IPCFrame.BindServiceReply.toObject(e.msgBindServiceReply,t),t.oneofs)&&(n.msg="msgBindServiceReply"),null!=e.msgInvokeMethod&&e.hasOwnProperty("msgInvokeMethod")&&(n.msgInvokeMethod=s.perfetto.protos.IPCFrame.InvokeMethod.toObject(e.msgInvokeMethod,t),t.oneofs)&&(n.msg="msgInvokeMethod"),null!=e.msgInvokeMethodReply&&e.hasOwnProperty("msgInvokeMethodReply")&&(n.msgInvokeMethodReply=s.perfetto.protos.IPCFrame.InvokeMethodReply.toObject(e.msgInvokeMethodReply,t),t.oneofs)&&(n.msg="msgInvokeMethodReply"),null!=e.msgRequestError&&e.hasOwnProperty("msgRequestError")&&(n.msgRequestError=s.perfetto.protos.IPCFrame.RequestError.toObject(e.msgRequestError,t),t.oneofs)&&(n.msg="msgRequestError"),null!=e.setPeerIdentity&&e.hasOwnProperty("setPeerIdentity")&&(n.setPeerIdentity=s.perfetto.protos.IPCFrame.SetPeerIdentity.toObject(e.setPeerIdentity,t),t.oneofs)&&(n.msg="setPeerIdentity"),n},R.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},R.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.IPCFrame"},R.BindService=(wt.prototype.serviceName="",wt.create=function(e){return new wt(e)},wt.encode=function(e,t){return t=t||a.create(),null!=e.serviceName&&Object.hasOwnProperty.call(e,"serviceName")&&t.uint32(10).string(e.serviceName),t},wt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.IPCFrame.BindService;e.pos<r;){var a=e.uint32();a>>>3==1?n.serviceName=e.string():e.skipType(7&a)}return n},wt.fromObject=function(e){var t;return e instanceof s.perfetto.protos.IPCFrame.BindService?e:(t=new s.perfetto.protos.IPCFrame.BindService,null!=e.serviceName&&(t.serviceName=String(e.serviceName)),t)},wt.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.serviceName=""),null!=e.serviceName&&e.hasOwnProperty("serviceName")&&(r.serviceName=e.serviceName),r},wt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},wt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.IPCFrame.BindService"},wt),R.BindServiceReply=(Rt.prototype.success=!1,Rt.prototype.serviceId=0,Rt.prototype.methods=i.emptyArray,Rt.create=function(e){return new Rt(e)},Rt.encode=function(e,t){if(t=t||a.create(),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.serviceId&&Object.hasOwnProperty.call(e,"serviceId")&&t.uint32(16).uint32(e.serviceId),null!=e.methods&&e.methods.length)for(var r=0;r<e.methods.length;++r)s.perfetto.protos.IPCFrame.BindServiceReply.MethodInfo.encode(e.methods[r],t.uint32(26).fork()).ldelim();return t},Rt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.IPCFrame.BindServiceReply;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.success=e.bool();break;case 2:n.serviceId=e.uint32();break;case 3:n.methods&&n.methods.length||(n.methods=[]),n.methods.push(s.perfetto.protos.IPCFrame.BindServiceReply.MethodInfo.decode(e,e.uint32()));break;default:e.skipType(7&a)}}return n},Rt.fromObject=function(e){if(e instanceof s.perfetto.protos.IPCFrame.BindServiceReply)return e;var t=new s.perfetto.protos.IPCFrame.BindServiceReply;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.serviceId&&(t.serviceId=e.serviceId>>>0),e.methods){if(!Array.isArray(e.methods))throw TypeError(".perfetto.protos.IPCFrame.BindServiceReply.methods: array expected");t.methods=[];for(var r=0;r<e.methods.length;++r){if("object"!=typeof e.methods[r])throw TypeError(".perfetto.protos.IPCFrame.BindServiceReply.methods: object expected");t.methods[r]=s.perfetto.protos.IPCFrame.BindServiceReply.MethodInfo.fromObject(e.methods[r])}}return t},Rt.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.methods=[]),t.defaults&&(r.success=!1,r.serviceId=0),null!=e.success&&e.hasOwnProperty("success")&&(r.success=e.success),null!=e.serviceId&&e.hasOwnProperty("serviceId")&&(r.serviceId=e.serviceId),e.methods&&e.methods.length){r.methods=[];for(var n=0;n<e.methods.length;++n)r.methods[n]=s.perfetto.protos.IPCFrame.BindServiceReply.MethodInfo.toObject(e.methods[n],t)}return r},Rt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Rt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.IPCFrame.BindServiceReply"},Rt.MethodInfo=(It.prototype.id=0,It.prototype.name="",It.create=function(e){return new It(e)},It.encode=function(e,t){return t=t||a.create(),null!=e.id&&Object.hasOwnProperty.call(e,"id")&&t.uint32(8).uint32(e.id),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(18).string(e.name),t},It.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.IPCFrame.BindServiceReply.MethodInfo;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.id=e.uint32();break;case 2:n.name=e.string();break;default:e.skipType(7&a)}}return n},It.fromObject=function(e){var t;return e instanceof s.perfetto.protos.IPCFrame.BindServiceReply.MethodInfo?e:(t=new s.perfetto.protos.IPCFrame.BindServiceReply.MethodInfo,null!=e.id&&(t.id=e.id>>>0),null!=e.name&&(t.name=String(e.name)),t)},It.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.id=0,r.name=""),null!=e.id&&e.hasOwnProperty("id")&&(r.id=e.id),null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),r},It.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},It.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.IPCFrame.BindServiceReply.MethodInfo"},It),Rt),R.InvokeMethod=(Mt.prototype.serviceId=0,Mt.prototype.methodId=0,Mt.prototype.argsProto=i.newBuffer([]),Mt.prototype.dropReply=!1,Mt.create=function(e){return new Mt(e)},Mt.encode=function(e,t){return t=t||a.create(),null!=e.serviceId&&Object.hasOwnProperty.call(e,"serviceId")&&t.uint32(8).uint32(e.serviceId),null!=e.methodId&&Object.hasOwnProperty.call(e,"methodId")&&t.uint32(16).uint32(e.methodId),null!=e.argsProto&&Object.hasOwnProperty.call(e,"argsProto")&&t.uint32(26).bytes(e.argsProto),null!=e.dropReply&&Object.hasOwnProperty.call(e,"dropReply")&&t.uint32(32).bool(e.dropReply),t},Mt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.IPCFrame.InvokeMethod;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.serviceId=e.uint32();break;case 2:n.methodId=e.uint32();break;case 3:n.argsProto=e.bytes();break;case 4:n.dropReply=e.bool();break;default:e.skipType(7&a)}}return n},Mt.fromObject=function(e){var t;return e instanceof s.perfetto.protos.IPCFrame.InvokeMethod?e:(t=new s.perfetto.protos.IPCFrame.InvokeMethod,null!=e.serviceId&&(t.serviceId=e.serviceId>>>0),null!=e.methodId&&(t.methodId=e.methodId>>>0),null!=e.argsProto&&("string"==typeof e.argsProto?i.base64.decode(e.argsProto,t.argsProto=i.newBuffer(i.base64.length(e.argsProto)),0):0<=e.argsProto.length&&(t.argsProto=e.argsProto)),null!=e.dropReply&&(t.dropReply=Boolean(e.dropReply)),t)},Mt.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.serviceId=0,r.methodId=0,t.bytes===String?r.argsProto="":(r.argsProto=[],t.bytes!==Array&&(r.argsProto=i.newBuffer(r.argsProto))),r.dropReply=!1),null!=e.serviceId&&e.hasOwnProperty("serviceId")&&(r.serviceId=e.serviceId),null!=e.methodId&&e.hasOwnProperty("methodId")&&(r.methodId=e.methodId),null!=e.argsProto&&e.hasOwnProperty("argsProto")&&(r.argsProto=t.bytes===String?i.base64.encode(e.argsProto,0,e.argsProto.length):t.bytes===Array?Array.prototype.slice.call(e.argsProto):e.argsProto),null!=e.dropReply&&e.hasOwnProperty("dropReply")&&(r.dropReply=e.dropReply),r},Mt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Mt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.IPCFrame.InvokeMethod"},Mt),R.InvokeMethodReply=(Pt.prototype.success=!1,Pt.prototype.hasMore=!1,Pt.prototype.replyProto=i.newBuffer([]),Pt.create=function(e){return new Pt(e)},Pt.encode=function(e,t){return t=t||a.create(),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.hasMore&&Object.hasOwnProperty.call(e,"hasMore")&&t.uint32(16).bool(e.hasMore),null!=e.replyProto&&Object.hasOwnProperty.call(e,"replyProto")&&t.uint32(26).bytes(e.replyProto),t},Pt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.IPCFrame.InvokeMethodReply;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.success=e.bool();break;case 2:n.hasMore=e.bool();break;case 3:n.replyProto=e.bytes();break;default:e.skipType(7&a)}}return n},Pt.fromObject=function(e){var t;return e instanceof s.perfetto.protos.IPCFrame.InvokeMethodReply?e:(t=new s.perfetto.protos.IPCFrame.InvokeMethodReply,null!=e.success&&(t.success=Boolean(e.success)),null!=e.hasMore&&(t.hasMore=Boolean(e.hasMore)),null!=e.replyProto&&("string"==typeof e.replyProto?i.base64.decode(e.replyProto,t.replyProto=i.newBuffer(i.base64.length(e.replyProto)),0):0<=e.replyProto.length&&(t.replyProto=e.replyProto)),t)},Pt.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.success=!1,r.hasMore=!1,t.bytes===String?r.replyProto="":(r.replyProto=[],t.bytes!==Array&&(r.replyProto=i.newBuffer(r.replyProto)))),null!=e.success&&e.hasOwnProperty("success")&&(r.success=e.success),null!=e.hasMore&&e.hasOwnProperty("hasMore")&&(r.hasMore=e.hasMore),null!=e.replyProto&&e.hasOwnProperty("replyProto")&&(r.replyProto=t.bytes===String?i.base64.encode(e.replyProto,0,e.replyProto.length):t.bytes===Array?Array.prototype.slice.call(e.replyProto):e.replyProto),r},Pt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Pt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.IPCFrame.InvokeMethodReply"},Pt),R.RequestError=(Nt.prototype.error="",Nt.create=function(e){return new Nt(e)},Nt.encode=function(e,t){return t=t||a.create(),null!=e.error&&Object.hasOwnProperty.call(e,"error")&&t.uint32(10).string(e.error),t},Nt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.IPCFrame.RequestError;e.pos<r;){var a=e.uint32();a>>>3==1?n.error=e.string():e.skipType(7&a)}return n},Nt.fromObject=function(e){var t;return e instanceof s.perfetto.protos.IPCFrame.RequestError?e:(t=new s.perfetto.protos.IPCFrame.RequestError,null!=e.error&&(t.error=String(e.error)),t)},Nt.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.error=""),null!=e.error&&e.hasOwnProperty("error")&&(r.error=e.error),r},Nt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Nt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.IPCFrame.RequestError"},Nt),R.SetPeerIdentity=(Dt.prototype.pid=0,Dt.prototype.uid=0,Dt.prototype.machineIdHint="",Dt.create=function(e){return new Dt(e)},Dt.encode=function(e,t){return t=t||a.create(),null!=e.pid&&Object.hasOwnProperty.call(e,"pid")&&t.uint32(8).int32(e.pid),null!=e.uid&&Object.hasOwnProperty.call(e,"uid")&&t.uint32(16).int32(e.uid),null!=e.machineIdHint&&Object.hasOwnProperty.call(e,"machineIdHint")&&t.uint32(26).string(e.machineIdHint),t},Dt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.IPCFrame.SetPeerIdentity;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.pid=e.int32();break;case 2:n.uid=e.int32();break;case 3:n.machineIdHint=e.string();break;default:e.skipType(7&a)}}return n},Dt.fromObject=function(e){var t;return e instanceof s.perfetto.protos.IPCFrame.SetPeerIdentity?e:(t=new s.perfetto.protos.IPCFrame.SetPeerIdentity,null!=e.pid&&(t.pid=0|e.pid),null!=e.uid&&(t.uid=0|e.uid),null!=e.machineIdHint&&(t.machineIdHint=String(e.machineIdHint)),t)},Dt.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.pid=0,r.uid=0,r.machineIdHint=""),null!=e.pid&&e.hasOwnProperty("pid")&&(r.pid=e.pid),null!=e.uid&&e.hasOwnProperty("uid")&&(r.uid=e.uid),null!=e.machineIdHint&&e.hasOwnProperty("machineIdHint")&&(r.machineIdHint=e.machineIdHint),r},Dt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Dt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.IPCFrame.SetPeerIdentity"},Dt),R),r.PerfettoMetatrace=(I.prototype.eventId=null,I.prototype.counterId=null,I.prototype.eventName=null,I.prototype.eventNameIid=null,I.prototype.counterName=null,I.prototype.eventDurationNs=i.Long?i.Long.fromBits(0,0,!0):0,I.prototype.counterValue=0,I.prototype.threadId=0,I.prototype.hasOverruns=!1,I.prototype.args=i.emptyArray,I.prototype.internedStrings=i.emptyArray,Object.defineProperty(I.prototype,"recordType",{get:i.oneOfGetter(e=["eventId","counterId","eventName","eventNameIid","counterName"]),set:i.oneOfSetter(e)}),I.create=function(e){return new I(e)},I.encode=function(e,t){if(t=t||a.create(),null!=e.eventId&&Object.hasOwnProperty.call(e,"eventId")&&t.uint32(8).uint32(e.eventId),null!=e.counterId&&Object.hasOwnProperty.call(e,"counterId")&&t.uint32(16).uint32(e.counterId),null!=e.eventDurationNs&&Object.hasOwnProperty.call(e,"eventDurationNs")&&t.uint32(24).uint64(e.eventDurationNs),null!=e.counterValue&&Object.hasOwnProperty.call(e,"counterValue")&&t.uint32(32).int32(e.counterValue),null!=e.threadId&&Object.hasOwnProperty.call(e,"threadId")&&t.uint32(40).uint32(e.threadId),null!=e.hasOverruns&&Object.hasOwnProperty.call(e,"hasOverruns")&&t.uint32(48).bool(e.hasOverruns),null!=e.args&&e.args.length)for(var r=0;r<e.args.length;++r)s.perfetto.protos.PerfettoMetatrace.Arg.encode(e.args[r],t.uint32(58).fork()).ldelim();if(null!=e.eventName&&Object.hasOwnProperty.call(e,"eventName")&&t.uint32(66).string(e.eventName),null!=e.counterName&&Object.hasOwnProperty.call(e,"counterName")&&t.uint32(74).string(e.counterName),null!=e.internedStrings&&e.internedStrings.length)for(r=0;r<e.internedStrings.length;++r)s.perfetto.protos.PerfettoMetatrace.InternedString.encode(e.internedStrings[r],t.uint32(82).fork()).ldelim();return null!=e.eventNameIid&&Object.hasOwnProperty.call(e,"eventNameIid")&&t.uint32(88).uint64(e.eventNameIid),t},I.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.PerfettoMetatrace;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.eventId=e.uint32();break;case 2:n.counterId=e.uint32();break;case 8:n.eventName=e.string();break;case 11:n.eventNameIid=e.uint64();break;case 9:n.counterName=e.string();break;case 3:n.eventDurationNs=e.uint64();break;case 4:n.counterValue=e.int32();break;case 5:n.threadId=e.uint32();break;case 6:n.hasOverruns=e.bool();break;case 7:n.args&&n.args.length||(n.args=[]),n.args.push(s.perfetto.protos.PerfettoMetatrace.Arg.decode(e,e.uint32()));break;case 10:n.internedStrings&&n.internedStrings.length||(n.internedStrings=[]),n.internedStrings.push(s.perfetto.protos.PerfettoMetatrace.InternedString.decode(e,e.uint32()));break;default:e.skipType(7&a)}}return n},I.fromObject=function(e){if(e instanceof s.perfetto.protos.PerfettoMetatrace)return e;var t=new s.perfetto.protos.PerfettoMetatrace;if(null!=e.eventId&&(t.eventId=e.eventId>>>0),null!=e.counterId&&(t.counterId=e.counterId>>>0),null!=e.eventName&&(t.eventName=String(e.eventName)),null!=e.eventNameIid&&(i.Long?(t.eventNameIid=i.Long.fromValue(e.eventNameIid)).unsigned=!0:"string"==typeof e.eventNameIid?t.eventNameIid=parseInt(e.eventNameIid,10):"number"==typeof e.eventNameIid?t.eventNameIid=e.eventNameIid:"object"==typeof e.eventNameIid&&(t.eventNameIid=new i.LongBits(e.eventNameIid.low>>>0,e.eventNameIid.high>>>0).toNumber(!0))),null!=e.counterName&&(t.counterName=String(e.counterName)),null!=e.eventDurationNs&&(i.Long?(t.eventDurationNs=i.Long.fromValue(e.eventDurationNs)).unsigned=!0:"string"==typeof e.eventDurationNs?t.eventDurationNs=parseInt(e.eventDurationNs,10):"number"==typeof e.eventDurationNs?t.eventDurationNs=e.eventDurationNs:"object"==typeof e.eventDurationNs&&(t.eventDurationNs=new i.LongBits(e.eventDurationNs.low>>>0,e.eventDurationNs.high>>>0).toNumber(!0))),null!=e.counterValue&&(t.counterValue=0|e.counterValue),null!=e.threadId&&(t.threadId=e.threadId>>>0),null!=e.hasOverruns&&(t.hasOverruns=Boolean(e.hasOverruns)),e.args){if(!Array.isArray(e.args))throw TypeError(".perfetto.protos.PerfettoMetatrace.args: array expected");t.args=[];for(var r=0;r<e.args.length;++r){if("object"!=typeof e.args[r])throw TypeError(".perfetto.protos.PerfettoMetatrace.args: object expected");t.args[r]=s.perfetto.protos.PerfettoMetatrace.Arg.fromObject(e.args[r])}}if(e.internedStrings){if(!Array.isArray(e.internedStrings))throw TypeError(".perfetto.protos.PerfettoMetatrace.internedStrings: array expected");t.internedStrings=[];for(r=0;r<e.internedStrings.length;++r){if("object"!=typeof e.internedStrings[r])throw TypeError(".perfetto.protos.PerfettoMetatrace.internedStrings: object expected");t.internedStrings[r]=s.perfetto.protos.PerfettoMetatrace.InternedString.fromObject(e.internedStrings[r])}}return t},I.toObject=function(e,t){var r,n={};if(((t=t||{}).arrays||t.defaults)&&(n.args=[],n.internedStrings=[]),t.defaults&&(i.Long?(r=new i.Long(0,0,!0),n.eventDurationNs=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.eventDurationNs=t.longs===String?"0":0,n.counterValue=0,n.threadId=0,n.hasOverruns=!1),null!=e.eventId&&e.hasOwnProperty("eventId")&&(n.eventId=e.eventId,t.oneofs)&&(n.recordType="eventId"),null!=e.counterId&&e.hasOwnProperty("counterId")&&(n.counterId=e.counterId,t.oneofs)&&(n.recordType="counterId"),null!=e.eventDurationNs&&e.hasOwnProperty("eventDurationNs")&&("number"==typeof e.eventDurationNs?n.eventDurationNs=t.longs===String?String(e.eventDurationNs):e.eventDurationNs:n.eventDurationNs=t.longs===String?i.Long.prototype.toString.call(e.eventDurationNs):t.longs===Number?new i.LongBits(e.eventDurationNs.low>>>0,e.eventDurationNs.high>>>0).toNumber(!0):e.eventDurationNs),null!=e.counterValue&&e.hasOwnProperty("counterValue")&&(n.counterValue=e.counterValue),null!=e.threadId&&e.hasOwnProperty("threadId")&&(n.threadId=e.threadId),null!=e.hasOverruns&&e.hasOwnProperty("hasOverruns")&&(n.hasOverruns=e.hasOverruns),e.args&&e.args.length){n.args=[];for(var a=0;a<e.args.length;++a)n.args[a]=s.perfetto.protos.PerfettoMetatrace.Arg.toObject(e.args[a],t)}if(null!=e.eventName&&e.hasOwnProperty("eventName")&&(n.eventName=e.eventName,t.oneofs)&&(n.recordType="eventName"),null!=e.counterName&&e.hasOwnProperty("counterName")&&(n.counterName=e.counterName,t.oneofs)&&(n.recordType="counterName"),e.internedStrings&&e.internedStrings.length){n.internedStrings=[];for(a=0;a<e.internedStrings.length;++a)n.internedStrings[a]=s.perfetto.protos.PerfettoMetatrace.InternedString.toObject(e.internedStrings[a],t)}return null!=e.eventNameIid&&e.hasOwnProperty("eventNameIid")&&("number"==typeof e.eventNameIid?n.eventNameIid=t.longs===String?String(e.eventNameIid):e.eventNameIid:n.eventNameIid=t.longs===String?i.Long.prototype.toString.call(e.eventNameIid):t.longs===Number?new i.LongBits(e.eventNameIid.low>>>0,e.eventNameIid.high>>>0).toNumber(!0):e.eventNameIid,t.oneofs)&&(n.recordType="eventNameIid"),n},I.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},I.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.PerfettoMetatrace"},I.Arg=(xt.prototype.key=null,xt.prototype.keyIid=null,xt.prototype.value=null,xt.prototype.valueIid=null,Object.defineProperty(xt.prototype,"keyOrInternedKey",{get:i.oneOfGetter(e=["key","keyIid"]),set:i.oneOfSetter(e)}),Object.defineProperty(xt.prototype,"valueOrInternedValue",{get:i.oneOfGetter(e=["value","valueIid"]),set:i.oneOfSetter(e)}),xt.create=function(e){return new xt(e)},xt.encode=function(e,t){return t=t||a.create(),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).string(e.value),null!=e.keyIid&&Object.hasOwnProperty.call(e,"keyIid")&&t.uint32(24).uint64(e.keyIid),null!=e.valueIid&&Object.hasOwnProperty.call(e,"valueIid")&&t.uint32(32).uint64(e.valueIid),t},xt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.PerfettoMetatrace.Arg;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.key=e.string();break;case 3:n.keyIid=e.uint64();break;case 2:n.value=e.string();break;case 4:n.valueIid=e.uint64();break;default:e.skipType(7&a)}}return n},xt.fromObject=function(e){var t;return e instanceof s.perfetto.protos.PerfettoMetatrace.Arg?e:(t=new s.perfetto.protos.PerfettoMetatrace.Arg,null!=e.key&&(t.key=String(e.key)),null!=e.keyIid&&(i.Long?(t.keyIid=i.Long.fromValue(e.keyIid)).unsigned=!0:"string"==typeof e.keyIid?t.keyIid=parseInt(e.keyIid,10):"number"==typeof e.keyIid?t.keyIid=e.keyIid:"object"==typeof e.keyIid&&(t.keyIid=new i.LongBits(e.keyIid.low>>>0,e.keyIid.high>>>0).toNumber(!0))),null!=e.value&&(t.value=String(e.value)),null!=e.valueIid&&(i.Long?(t.valueIid=i.Long.fromValue(e.valueIid)).unsigned=!0:"string"==typeof e.valueIid?t.valueIid=parseInt(e.valueIid,10):"number"==typeof e.valueIid?t.valueIid=e.valueIid:"object"==typeof e.valueIid&&(t.valueIid=new i.LongBits(e.valueIid.low>>>0,e.valueIid.high>>>0).toNumber(!0))),t)},xt.toObject=function(e,t){t=t||{};var r={};return null!=e.key&&e.hasOwnProperty("key")&&(r.key=e.key,t.oneofs)&&(r.keyOrInternedKey="key"),null!=e.value&&e.hasOwnProperty("value")&&(r.value=e.value,t.oneofs)&&(r.valueOrInternedValue="value"),null!=e.keyIid&&e.hasOwnProperty("keyIid")&&("number"==typeof e.keyIid?r.keyIid=t.longs===String?String(e.keyIid):e.keyIid:r.keyIid=t.longs===String?i.Long.prototype.toString.call(e.keyIid):t.longs===Number?new i.LongBits(e.keyIid.low>>>0,e.keyIid.high>>>0).toNumber(!0):e.keyIid,t.oneofs)&&(r.keyOrInternedKey="keyIid"),null!=e.valueIid&&e.hasOwnProperty("valueIid")&&("number"==typeof e.valueIid?r.valueIid=t.longs===String?String(e.valueIid):e.valueIid:r.valueIid=t.longs===String?i.Long.prototype.toString.call(e.valueIid):t.longs===Number?new i.LongBits(e.valueIid.low>>>0,e.valueIid.high>>>0).toNumber(!0):e.valueIid,t.oneofs)&&(r.valueOrInternedValue="valueIid"),r},xt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},xt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.PerfettoMetatrace.Arg"},xt),I.InternedString=(Lt.prototype.iid=i.Long?i.Long.fromBits(0,0,!0):0,Lt.prototype.value="",Lt.create=function(e){return new Lt(e)},Lt.encode=function(e,t){return t=t||a.create(),null!=e.iid&&Object.hasOwnProperty.call(e,"iid")&&t.uint32(8).uint64(e.iid),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).string(e.value),t},Lt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.PerfettoMetatrace.InternedString;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.iid=e.uint64();break;case 2:n.value=e.string();break;default:e.skipType(7&a)}}return n},Lt.fromObject=function(e){var t;return e instanceof s.perfetto.protos.PerfettoMetatrace.InternedString?e:(t=new s.perfetto.protos.PerfettoMetatrace.InternedString,null!=e.iid&&(i.Long?(t.iid=i.Long.fromValue(e.iid)).unsigned=!0:"string"==typeof e.iid?t.iid=parseInt(e.iid,10):"number"==typeof e.iid?t.iid=e.iid:"object"==typeof e.iid&&(t.iid=new i.LongBits(e.iid.low>>>0,e.iid.high>>>0).toNumber(!0))),null!=e.value&&(t.value=String(e.value)),t)},Lt.toObject=function(e,t){var r,n={};return(t=t||{}).defaults&&(i.Long?(r=new i.Long(0,0,!0),n.iid=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.iid=t.longs===String?"0":0,n.value=""),null!=e.iid&&e.hasOwnProperty("iid")&&("number"==typeof e.iid?n.iid=t.longs===String?String(e.iid):e.iid:n.iid=t.longs===String?i.Long.prototype.toString.call(e.iid):t.longs===Number?new i.LongBits(e.iid.low>>>0,e.iid.high>>>0).toNumber(!0):e.iid),null!=e.value&&e.hasOwnProperty("value")&&(n.value=e.value),n},Lt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Lt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.PerfettoMetatrace.InternedString"},Lt),I),r.TraceProcessorApiVersion=(t={},(e=Object.create(t))[t[12]="TRACE_PROCESSOR_CURRENT_API_VERSION"]=12,e),r.TraceProcessorRpcStream=(Ft.prototype.msg=i.emptyArray,Ft.create=function(e){return new Ft(e)},Ft.encode=function(e,t){if(t=t||a.create(),null!=e.msg&&e.msg.length)for(var r=0;r<e.msg.length;++r)s.perfetto.protos.TraceProcessorRpc.encode(e.msg[r],t.uint32(10).fork()).ldelim();return t},Ft.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TraceProcessorRpcStream;e.pos<r;){var a=e.uint32();a>>>3==1?(n.msg&&n.msg.length||(n.msg=[]),n.msg.push(s.perfetto.protos.TraceProcessorRpc.decode(e,e.uint32()))):e.skipType(7&a)}return n},Ft.fromObject=function(e){if(e instanceof s.perfetto.protos.TraceProcessorRpcStream)return e;var t=new s.perfetto.protos.TraceProcessorRpcStream;if(e.msg){if(!Array.isArray(e.msg))throw TypeError(".perfetto.protos.TraceProcessorRpcStream.msg: array expected");t.msg=[];for(var r=0;r<e.msg.length;++r){if("object"!=typeof e.msg[r])throw TypeError(".perfetto.protos.TraceProcessorRpcStream.msg: object expected");t.msg[r]=s.perfetto.protos.TraceProcessorRpc.fromObject(e.msg[r])}}return t},Ft.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.msg=[]),e.msg&&e.msg.length){r.msg=[];for(var n=0;n<e.msg.length;++n)r.msg[n]=s.perfetto.protos.TraceProcessorRpc.toObject(e.msg[n],t)}return r},Ft.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Ft.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TraceProcessorRpcStream"},Ft),r.TraceProcessorRpc=(M.prototype.seq=i.Long?i.Long.fromBits(0,0,!1):0,M.prototype.fatalError="",M.prototype.request=null,M.prototype.response=null,M.prototype.invalidRequest=null,M.prototype.appendTraceData=null,M.prototype.queryArgs=null,M.prototype.computeMetricArgs=null,M.prototype.enableMetatraceArgs=null,M.prototype.resetTraceProcessorArgs=null,M.prototype.appendResult=null,M.prototype.queryResult=null,M.prototype.metricResult=null,M.prototype.metricDescriptors=null,M.prototype.metatrace=null,M.prototype.status=null,Object.defineProperty(M.prototype,"type",{get:i.oneOfGetter(t=["request","response","invalidRequest"]),set:i.oneOfSetter(t)}),Object.defineProperty(M.prototype,"args",{get:i.oneOfGetter(t=["appendTraceData","queryArgs","computeMetricArgs","enableMetatraceArgs","resetTraceProcessorArgs","appendResult","queryResult","metricResult","metricDescriptors","metatrace","status"]),set:i.oneOfSetter(t)}),M.create=function(e){return new M(e)},M.encode=function(e,t){return t=t||a.create(),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).int64(e.seq),null!=e.request&&Object.hasOwnProperty.call(e,"request")&&t.uint32(16).int32(e.request),null!=e.response&&Object.hasOwnProperty.call(e,"response")&&t.uint32(24).int32(e.response),null!=e.invalidRequest&&Object.hasOwnProperty.call(e,"invalidRequest")&&t.uint32(32).int32(e.invalidRequest),null!=e.fatalError&&Object.hasOwnProperty.call(e,"fatalError")&&t.uint32(42).string(e.fatalError),null!=e.appendTraceData&&Object.hasOwnProperty.call(e,"appendTraceData")&&t.uint32(810).bytes(e.appendTraceData),null!=e.queryArgs&&Object.hasOwnProperty.call(e,"queryArgs")&&s.perfetto.protos.QueryArgs.encode(e.queryArgs,t.uint32(826).fork()).ldelim(),null!=e.computeMetricArgs&&Object.hasOwnProperty.call(e,"computeMetricArgs")&&s.perfetto.protos.ComputeMetricArgs.encode(e.computeMetricArgs,t.uint32(842).fork()).ldelim(),null!=e.enableMetatraceArgs&&Object.hasOwnProperty.call(e,"enableMetatraceArgs")&&s.perfetto.protos.EnableMetatraceArgs.encode(e.enableMetatraceArgs,t.uint32(850).fork()).ldelim(),null!=e.resetTraceProcessorArgs&&Object.hasOwnProperty.call(e,"resetTraceProcessorArgs")&&s.perfetto.protos.ResetTraceProcessorArgs.encode(e.resetTraceProcessorArgs,t.uint32(858).fork()).ldelim(),null!=e.appendResult&&Object.hasOwnProperty.call(e,"appendResult")&&s.perfetto.protos.AppendTraceDataResult.encode(e.appendResult,t.uint32(1610).fork()).ldelim(),null!=e.queryResult&&Object.hasOwnProperty.call(e,"queryResult")&&s.perfetto.protos.QueryResult.encode(e.queryResult,t.uint32(1626).fork()).ldelim(),null!=e.metricResult&&Object.hasOwnProperty.call(e,"metricResult")&&s.perfetto.protos.ComputeMetricResult.encode(e.metricResult,t.uint32(1642).fork()).ldelim(),null!=e.metricDescriptors&&Object.hasOwnProperty.call(e,"metricDescriptors")&&s.perfetto.protos.DescriptorSet.encode(e.metricDescriptors,t.uint32(1650).fork()).ldelim(),null!=e.metatrace&&Object.hasOwnProperty.call(e,"metatrace")&&s.perfetto.protos.DisableAndReadMetatraceResult.encode(e.metatrace,t.uint32(1674).fork()).ldelim(),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&s.perfetto.protos.StatusResult.encode(e.status,t.uint32(1682).fork()).ldelim(),t},M.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.TraceProcessorRpc;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.seq=e.int64();break;case 5:n.fatalError=e.string();break;case 2:n.request=e.int32();break;case 3:n.response=e.int32();break;case 4:n.invalidRequest=e.int32();break;case 101:n.appendTraceData=e.bytes();break;case 103:n.queryArgs=s.perfetto.protos.QueryArgs.decode(e,e.uint32());break;case 105:n.computeMetricArgs=s.perfetto.protos.ComputeMetricArgs.decode(e,e.uint32());break;case 106:n.enableMetatraceArgs=s.perfetto.protos.EnableMetatraceArgs.decode(e,e.uint32());break;case 107:n.resetTraceProcessorArgs=s.perfetto.protos.ResetTraceProcessorArgs.decode(e,e.uint32());break;case 201:n.appendResult=s.perfetto.protos.AppendTraceDataResult.decode(e,e.uint32());break;case 203:n.queryResult=s.perfetto.protos.QueryResult.decode(e,e.uint32());break;case 205:n.metricResult=s.perfetto.protos.ComputeMetricResult.decode(e,e.uint32());break;case 206:n.metricDescriptors=s.perfetto.protos.DescriptorSet.decode(e,e.uint32());break;case 209:n.metatrace=s.perfetto.protos.DisableAndReadMetatraceResult.decode(e,e.uint32());break;case 210:n.status=s.perfetto.protos.StatusResult.decode(e,e.uint32());break;default:e.skipType(7&a)}}return n},M.fromObject=function(e){if(e instanceof s.perfetto.protos.TraceProcessorRpc)return e;var t=new s.perfetto.protos.TraceProcessorRpc;switch(null!=e.seq&&(i.Long?(t.seq=i.Long.fromValue(e.seq)).unsigned=!1:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"==typeof e.seq&&(t.seq=new i.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber())),null!=e.fatalError&&(t.fatalError=String(e.fatalError)),e.request){default:"number"==typeof e.request&&(t.request=e.request);break;case"TPM_UNSPECIFIED":case 0:t.request=0;break;case"TPM_APPEND_TRACE_DATA":case 1:t.request=1;break;case"TPM_FINALIZE_TRACE_DATA":case 2:t.request=2;break;case"TPM_QUERY_STREAMING":case 3:t.request=3;break;case"TPM_COMPUTE_METRIC":case 5:t.request=5;break;case"TPM_GET_METRIC_DESCRIPTORS":case 6:t.request=6;break;case"TPM_RESTORE_INITIAL_TABLES":case 7:t.request=7;break;case"TPM_ENABLE_METATRACE":case 8:t.request=8;break;case"TPM_DISABLE_AND_READ_METATRACE":case 9:t.request=9;break;case"TPM_GET_STATUS":case 10:t.request=10;break;case"TPM_RESET_TRACE_PROCESSOR":case 11:t.request=11}switch(e.response){default:"number"==typeof e.response&&(t.response=e.response);break;case"TPM_UNSPECIFIED":case 0:t.response=0;break;case"TPM_APPEND_TRACE_DATA":case 1:t.response=1;break;case"TPM_FINALIZE_TRACE_DATA":case 2:t.response=2;break;case"TPM_QUERY_STREAMING":case 3:t.response=3;break;case"TPM_COMPUTE_METRIC":case 5:t.response=5;break;case"TPM_GET_METRIC_DESCRIPTORS":case 6:t.response=6;break;case"TPM_RESTORE_INITIAL_TABLES":case 7:t.response=7;break;case"TPM_ENABLE_METATRACE":case 8:t.response=8;break;case"TPM_DISABLE_AND_READ_METATRACE":case 9:t.response=9;break;case"TPM_GET_STATUS":case 10:t.response=10;break;case"TPM_RESET_TRACE_PROCESSOR":case 11:t.response=11}switch(e.invalidRequest){default:"number"==typeof e.invalidRequest&&(t.invalidRequest=e.invalidRequest);break;case"TPM_UNSPECIFIED":case 0:t.invalidRequest=0;break;case"TPM_APPEND_TRACE_DATA":case 1:t.invalidRequest=1;break;case"TPM_FINALIZE_TRACE_DATA":case 2:t.invalidRequest=2;break;case"TPM_QUERY_STREAMING":case 3:t.invalidRequest=3;break;case"TPM_COMPUTE_METRIC":case 5:t.invalidRequest=5;break;case"TPM_GET_METRIC_DESCRIPTORS":case 6:t.invalidRequest=6;break;case"TPM_RESTORE_INITIAL_TABLES":case 7:t.invalidRequest=7;break;case"TPM_ENABLE_METATRACE":case 8:t.invalidRequest=8;break;case"TPM_DISABLE_AND_READ_METATRACE":case 9:t.invalidRequest=9;break;case"TPM_GET_STATUS":case 10:t.invalidRequest=10;break;case"TPM_RESET_TRACE_PROCESSOR":case 11:t.invalidRequest=11}if(null!=e.appendTraceData&&("string"==typeof e.appendTraceData?i.base64.decode(e.appendTraceData,t.appendTraceData=i.newBuffer(i.base64.length(e.appendTraceData)),0):0<=e.appendTraceData.length&&(t.appendTraceData=e.appendTraceData)),null!=e.queryArgs){if("object"!=typeof e.queryArgs)throw TypeError(".perfetto.protos.TraceProcessorRpc.queryArgs: object expected");t.queryArgs=s.perfetto.protos.QueryArgs.fromObject(e.queryArgs)}if(null!=e.computeMetricArgs){if("object"!=typeof e.computeMetricArgs)throw TypeError(".perfetto.protos.TraceProcessorRpc.computeMetricArgs: object expected");t.computeMetricArgs=s.perfetto.protos.ComputeMetricArgs.fromObject(e.computeMetricArgs)}if(null!=e.enableMetatraceArgs){if("object"!=typeof e.enableMetatraceArgs)throw TypeError(".perfetto.protos.TraceProcessorRpc.enableMetatraceArgs: object expected");t.enableMetatraceArgs=s.perfetto.protos.EnableMetatraceArgs.fromObject(e.enableMetatraceArgs)}if(null!=e.resetTraceProcessorArgs){if("object"!=typeof e.resetTraceProcessorArgs)throw TypeError(".perfetto.protos.TraceProcessorRpc.resetTraceProcessorArgs: object expected");t.resetTraceProcessorArgs=s.perfetto.protos.ResetTraceProcessorArgs.fromObject(e.resetTraceProcessorArgs)}if(null!=e.appendResult){if("object"!=typeof e.appendResult)throw TypeError(".perfetto.protos.TraceProcessorRpc.appendResult: object expected");t.appendResult=s.perfetto.protos.AppendTraceDataResult.fromObject(e.appendResult)}if(null!=e.queryResult){if("object"!=typeof e.queryResult)throw TypeError(".perfetto.protos.TraceProcessorRpc.queryResult: object expected");t.queryResult=s.perfetto.protos.QueryResult.fromObject(e.queryResult)}if(null!=e.metricResult){if("object"!=typeof e.metricResult)throw TypeError(".perfetto.protos.TraceProcessorRpc.metricResult: object expected");t.metricResult=s.perfetto.protos.ComputeMetricResult.fromObject(e.metricResult)}if(null!=e.metricDescriptors){if("object"!=typeof e.metricDescriptors)throw TypeError(".perfetto.protos.TraceProcessorRpc.metricDescriptors: object expected");t.metricDescriptors=s.perfetto.protos.DescriptorSet.fromObject(e.metricDescriptors)}if(null!=e.metatrace){if("object"!=typeof e.metatrace)throw TypeError(".perfetto.protos.TraceProcessorRpc.metatrace: object expected");t.metatrace=s.perfetto.protos.DisableAndReadMetatraceResult.fromObject(e.metatrace)}if(null!=e.status){if("object"!=typeof e.status)throw TypeError(".perfetto.protos.TraceProcessorRpc.status: object expected");t.status=s.perfetto.protos.StatusResult.fromObject(e.status)}return t},M.toObject=function(e,t){var r,n={};return(t=t||{}).defaults&&(i.Long?(r=new i.Long(0,0,!1),n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.seq=t.longs===String?"0":0,n.fatalError=""),null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?i.Long.prototype.toString.call(e.seq):t.longs===Number?new i.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber():e.seq),null!=e.request&&e.hasOwnProperty("request")&&(n.request=t.enums!==String||void 0===s.perfetto.protos.TraceProcessorRpc.TraceProcessorMethod[e.request]?e.request:s.perfetto.protos.TraceProcessorRpc.TraceProcessorMethod[e.request],t.oneofs)&&(n.type="request"),null!=e.response&&e.hasOwnProperty("response")&&(n.response=t.enums!==String||void 0===s.perfetto.protos.TraceProcessorRpc.TraceProcessorMethod[e.response]?e.response:s.perfetto.protos.TraceProcessorRpc.TraceProcessorMethod[e.response],t.oneofs)&&(n.type="response"),null!=e.invalidRequest&&e.hasOwnProperty("invalidRequest")&&(n.invalidRequest=t.enums!==String||void 0===s.perfetto.protos.TraceProcessorRpc.TraceProcessorMethod[e.invalidRequest]?e.invalidRequest:s.perfetto.protos.TraceProcessorRpc.TraceProcessorMethod[e.invalidRequest],t.oneofs)&&(n.type="invalidRequest"),null!=e.fatalError&&e.hasOwnProperty("fatalError")&&(n.fatalError=e.fatalError),null!=e.appendTraceData&&e.hasOwnProperty("appendTraceData")&&(n.appendTraceData=t.bytes===String?i.base64.encode(e.appendTraceData,0,e.appendTraceData.length):t.bytes===Array?Array.prototype.slice.call(e.appendTraceData):e.appendTraceData,t.oneofs)&&(n.args="appendTraceData"),null!=e.queryArgs&&e.hasOwnProperty("queryArgs")&&(n.queryArgs=s.perfetto.protos.QueryArgs.toObject(e.queryArgs,t),t.oneofs)&&(n.args="queryArgs"),null!=e.computeMetricArgs&&e.hasOwnProperty("computeMetricArgs")&&(n.computeMetricArgs=s.perfetto.protos.ComputeMetricArgs.toObject(e.computeMetricArgs,t),t.oneofs)&&(n.args="computeMetricArgs"),null!=e.enableMetatraceArgs&&e.hasOwnProperty("enableMetatraceArgs")&&(n.enableMetatraceArgs=s.perfetto.protos.EnableMetatraceArgs.toObject(e.enableMetatraceArgs,t),t.oneofs)&&(n.args="enableMetatraceArgs"),null!=e.resetTraceProcessorArgs&&e.hasOwnProperty("resetTraceProcessorArgs")&&(n.resetTraceProcessorArgs=s.perfetto.protos.ResetTraceProcessorArgs.toObject(e.resetTraceProcessorArgs,t),t.oneofs)&&(n.args="resetTraceProcessorArgs"),null!=e.appendResult&&e.hasOwnProperty("appendResult")&&(n.appendResult=s.perfetto.protos.AppendTraceDataResult.toObject(e.appendResult,t),t.oneofs)&&(n.args="appendResult"),null!=e.queryResult&&e.hasOwnProperty("queryResult")&&(n.queryResult=s.perfetto.protos.QueryResult.toObject(e.queryResult,t),t.oneofs)&&(n.args="queryResult"),null!=e.metricResult&&e.hasOwnProperty("metricResult")&&(n.metricResult=s.perfetto.protos.ComputeMetricResult.toObject(e.metricResult,t),t.oneofs)&&(n.args="metricResult"),null!=e.metricDescriptors&&e.hasOwnProperty("metricDescriptors")&&(n.metricDescriptors=s.perfetto.protos.DescriptorSet.toObject(e.metricDescriptors,t),t.oneofs)&&(n.args="metricDescriptors"),null!=e.metatrace&&e.hasOwnProperty("metatrace")&&(n.metatrace=s.perfetto.protos.DisableAndReadMetatraceResult.toObject(e.metatrace,t),t.oneofs)&&(n.args="metatrace"),null!=e.status&&e.hasOwnProperty("status")&&(n.status=s.perfetto.protos.StatusResult.toObject(e.status,t),t.oneofs)&&(n.args="status"),n},M.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},M.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.TraceProcessorRpc"},M.TraceProcessorMethod=(t={},(e=Object.create(t))[t[0]="TPM_UNSPECIFIED"]=0,e[t[1]="TPM_APPEND_TRACE_DATA"]=1,e[t[2]="TPM_FINALIZE_TRACE_DATA"]=2,e[t[3]="TPM_QUERY_STREAMING"]=3,e[t[5]="TPM_COMPUTE_METRIC"]=5,e[t[6]="TPM_GET_METRIC_DESCRIPTORS"]=6,e[t[7]="TPM_RESTORE_INITIAL_TABLES"]=7,e[t[8]="TPM_ENABLE_METATRACE"]=8,e[t[9]="TPM_DISABLE_AND_READ_METATRACE"]=9,e[t[10]="TPM_GET_STATUS"]=10,e[t[11]="TPM_RESET_TRACE_PROCESSOR"]=11,e),M),r.AppendTraceDataResult=(Ut.prototype.totalBytesParsed=i.Long?i.Long.fromBits(0,0,!1):0,Ut.prototype.error="",Ut.create=function(e){return new Ut(e)},Ut.encode=function(e,t){return t=t||a.create(),null!=e.totalBytesParsed&&Object.hasOwnProperty.call(e,"totalBytesParsed")&&t.uint32(8).int64(e.totalBytesParsed),null!=e.error&&Object.hasOwnProperty.call(e,"error")&&t.uint32(18).string(e.error),t},Ut.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.AppendTraceDataResult;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.totalBytesParsed=e.int64();break;case 2:n.error=e.string();break;default:e.skipType(7&a)}}return n},Ut.fromObject=function(e){var t;return e instanceof s.perfetto.protos.AppendTraceDataResult?e:(t=new s.perfetto.protos.AppendTraceDataResult,null!=e.totalBytesParsed&&(i.Long?(t.totalBytesParsed=i.Long.fromValue(e.totalBytesParsed)).unsigned=!1:"string"==typeof e.totalBytesParsed?t.totalBytesParsed=parseInt(e.totalBytesParsed,10):"number"==typeof e.totalBytesParsed?t.totalBytesParsed=e.totalBytesParsed:"object"==typeof e.totalBytesParsed&&(t.totalBytesParsed=new i.LongBits(e.totalBytesParsed.low>>>0,e.totalBytesParsed.high>>>0).toNumber())),null!=e.error&&(t.error=String(e.error)),t)},Ut.toObject=function(e,t){var r,n={};return(t=t||{}).defaults&&(i.Long?(r=new i.Long(0,0,!1),n.totalBytesParsed=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.totalBytesParsed=t.longs===String?"0":0,n.error=""),null!=e.totalBytesParsed&&e.hasOwnProperty("totalBytesParsed")&&("number"==typeof e.totalBytesParsed?n.totalBytesParsed=t.longs===String?String(e.totalBytesParsed):e.totalBytesParsed:n.totalBytesParsed=t.longs===String?i.Long.prototype.toString.call(e.totalBytesParsed):t.longs===Number?new i.LongBits(e.totalBytesParsed.low>>>0,e.totalBytesParsed.high>>>0).toNumber():e.totalBytesParsed),null!=e.error&&e.hasOwnProperty("error")&&(n.error=e.error),n},Ut.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Ut.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.AppendTraceDataResult"},Ut),r.QueryArgs=(Bt.prototype.sqlQuery="",Bt.prototype.tag="",Bt.create=function(e){return new Bt(e)},Bt.encode=function(e,t){return t=t||a.create(),null!=e.sqlQuery&&Object.hasOwnProperty.call(e,"sqlQuery")&&t.uint32(10).string(e.sqlQuery),null!=e.tag&&Object.hasOwnProperty.call(e,"tag")&&t.uint32(26).string(e.tag),t},Bt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.QueryArgs;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.sqlQuery=e.string();break;case 3:n.tag=e.string();break;default:e.skipType(7&a)}}return n},Bt.fromObject=function(e){var t;return e instanceof s.perfetto.protos.QueryArgs?e:(t=new s.perfetto.protos.QueryArgs,null!=e.sqlQuery&&(t.sqlQuery=String(e.sqlQuery)),null!=e.tag&&(t.tag=String(e.tag)),t)},Bt.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.sqlQuery="",r.tag=""),null!=e.sqlQuery&&e.hasOwnProperty("sqlQuery")&&(r.sqlQuery=e.sqlQuery),null!=e.tag&&e.hasOwnProperty("tag")&&(r.tag=e.tag),r},Bt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Bt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.QueryArgs"},Bt),r.QueryResult=(jt.prototype.columnNames=i.emptyArray,jt.prototype.error="",jt.prototype.batch=i.emptyArray,jt.prototype.statementCount=0,jt.prototype.statementWithOutputCount=0,jt.prototype.lastStatementSql="",jt.create=function(e){return new jt(e)},jt.encode=function(e,t){if(t=t||a.create(),null!=e.columnNames&&e.columnNames.length)for(var r=0;r<e.columnNames.length;++r)t.uint32(10).string(e.columnNames[r]);if(null!=e.error&&Object.hasOwnProperty.call(e,"error")&&t.uint32(18).string(e.error),null!=e.batch&&e.batch.length)for(r=0;r<e.batch.length;++r)s.perfetto.protos.QueryResult.CellsBatch.encode(e.batch[r],t.uint32(26).fork()).ldelim();return null!=e.statementCount&&Object.hasOwnProperty.call(e,"statementCount")&&t.uint32(32).uint32(e.statementCount),null!=e.statementWithOutputCount&&Object.hasOwnProperty.call(e,"statementWithOutputCount")&&t.uint32(40).uint32(e.statementWithOutputCount),null!=e.lastStatementSql&&Object.hasOwnProperty.call(e,"lastStatementSql")&&t.uint32(50).string(e.lastStatementSql),t},jt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.QueryResult;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.columnNames&&n.columnNames.length||(n.columnNames=[]),n.columnNames.push(e.string());break;case 2:n.error=e.string();break;case 3:n.batch&&n.batch.length||(n.batch=[]),n.batch.push(s.perfetto.protos.QueryResult.CellsBatch.decode(e,e.uint32()));break;case 4:n.statementCount=e.uint32();break;case 5:n.statementWithOutputCount=e.uint32();break;case 6:n.lastStatementSql=e.string();break;default:e.skipType(7&a)}}return n},jt.fromObject=function(e){if(e instanceof s.perfetto.protos.QueryResult)return e;var t=new s.perfetto.protos.QueryResult;if(e.columnNames){if(!Array.isArray(e.columnNames))throw TypeError(".perfetto.protos.QueryResult.columnNames: array expected");t.columnNames=[];for(var r=0;r<e.columnNames.length;++r)t.columnNames[r]=String(e.columnNames[r])}if(null!=e.error&&(t.error=String(e.error)),e.batch){if(!Array.isArray(e.batch))throw TypeError(".perfetto.protos.QueryResult.batch: array expected");t.batch=[];for(r=0;r<e.batch.length;++r){if("object"!=typeof e.batch[r])throw TypeError(".perfetto.protos.QueryResult.batch: object expected");t.batch[r]=s.perfetto.protos.QueryResult.CellsBatch.fromObject(e.batch[r])}}return null!=e.statementCount&&(t.statementCount=e.statementCount>>>0),null!=e.statementWithOutputCount&&(t.statementWithOutputCount=e.statementWithOutputCount>>>0),null!=e.lastStatementSql&&(t.lastStatementSql=String(e.lastStatementSql)),t},jt.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.columnNames=[],r.batch=[]),t.defaults&&(r.error="",r.statementCount=0,r.statementWithOutputCount=0,r.lastStatementSql=""),e.columnNames&&e.columnNames.length){r.columnNames=[];for(var n=0;n<e.columnNames.length;++n)r.columnNames[n]=e.columnNames[n]}if(null!=e.error&&e.hasOwnProperty("error")&&(r.error=e.error),e.batch&&e.batch.length){r.batch=[];for(n=0;n<e.batch.length;++n)r.batch[n]=s.perfetto.protos.QueryResult.CellsBatch.toObject(e.batch[n],t)}return null!=e.statementCount&&e.hasOwnProperty("statementCount")&&(r.statementCount=e.statementCount),null!=e.statementWithOutputCount&&e.hasOwnProperty("statementWithOutputCount")&&(r.statementWithOutputCount=e.statementWithOutputCount),null!=e.lastStatementSql&&e.hasOwnProperty("lastStatementSql")&&(r.lastStatementSql=e.lastStatementSql),r},jt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},jt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.QueryResult"},jt.CellsBatch=(Ht.prototype.cells=i.emptyArray,Ht.prototype.varintCells=i.emptyArray,Ht.prototype.float64Cells=i.emptyArray,Ht.prototype.blobCells=i.emptyArray,Ht.prototype.stringCells="",Ht.prototype.isLastBatch=!1,Ht.create=function(e){return new Ht(e)},Ht.encode=function(e,t){if(t=t||a.create(),null!=e.cells&&e.cells.length){t.uint32(10).fork();for(var r=0;r<e.cells.length;++r)t.int32(e.cells[r]);t.ldelim()}if(null!=e.varintCells&&e.varintCells.length){t.uint32(18).fork();for(r=0;r<e.varintCells.length;++r)t.int64(e.varintCells[r]);t.ldelim()}if(null!=e.float64Cells&&e.float64Cells.length){t.uint32(26).fork();for(r=0;r<e.float64Cells.length;++r)t.double(e.float64Cells[r]);t.ldelim()}if(null!=e.blobCells&&e.blobCells.length)for(r=0;r<e.blobCells.length;++r)t.uint32(34).bytes(e.blobCells[r]);return null!=e.stringCells&&Object.hasOwnProperty.call(e,"stringCells")&&t.uint32(42).string(e.stringCells),null!=e.isLastBatch&&Object.hasOwnProperty.call(e,"isLastBatch")&&t.uint32(48).bool(e.isLastBatch),t},Ht.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.QueryResult.CellsBatch;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:if(n.cells&&n.cells.length||(n.cells=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.cells.push(e.int32());else n.cells.push(e.int32());break;case 2:if(n.varintCells&&n.varintCells.length||(n.varintCells=[]),2==(7&a))for(i=e.uint32()+e.pos;e.pos<i;)n.varintCells.push(e.int64());else n.varintCells.push(e.int64());break;case 3:if(n.float64Cells&&n.float64Cells.length||(n.float64Cells=[]),2==(7&a))for(i=e.uint32()+e.pos;e.pos<i;)n.float64Cells.push(e.double());else n.float64Cells.push(e.double());break;case 4:n.blobCells&&n.blobCells.length||(n.blobCells=[]),n.blobCells.push(e.bytes());break;case 5:n.stringCells=e.string();break;case 6:n.isLastBatch=e.bool();break;default:e.skipType(7&a)}}return n},Ht.fromObject=function(e){if(e instanceof s.perfetto.protos.QueryResult.CellsBatch)return e;var t=new s.perfetto.protos.QueryResult.CellsBatch;if(e.cells){if(!Array.isArray(e.cells))throw TypeError(".perfetto.protos.QueryResult.CellsBatch.cells: array expected");t.cells=[];for(var r=0;r<e.cells.length;++r)switch(e.cells[r]){default:if("number"==typeof e.cells[r]){t.cells[r]=e.cells[r];break}case"CELL_INVALID":case 0:t.cells[r]=0;break;case"CELL_NULL":case 1:t.cells[r]=1;break;case"CELL_VARINT":case 2:t.cells[r]=2;break;case"CELL_FLOAT64":case 3:t.cells[r]=3;break;case"CELL_STRING":case 4:t.cells[r]=4;break;case"CELL_BLOB":case 5:t.cells[r]=5}}if(e.varintCells){if(!Array.isArray(e.varintCells))throw TypeError(".perfetto.protos.QueryResult.CellsBatch.varintCells: array expected");t.varintCells=[];for(r=0;r<e.varintCells.length;++r)i.Long?(t.varintCells[r]=i.Long.fromValue(e.varintCells[r])).unsigned=!1:"string"==typeof e.varintCells[r]?t.varintCells[r]=parseInt(e.varintCells[r],10):"number"==typeof e.varintCells[r]?t.varintCells[r]=e.varintCells[r]:"object"==typeof e.varintCells[r]&&(t.varintCells[r]=new i.LongBits(e.varintCells[r].low>>>0,e.varintCells[r].high>>>0).toNumber())}if(e.float64Cells){if(!Array.isArray(e.float64Cells))throw TypeError(".perfetto.protos.QueryResult.CellsBatch.float64Cells: array expected");t.float64Cells=[];for(r=0;r<e.float64Cells.length;++r)t.float64Cells[r]=Number(e.float64Cells[r])}if(e.blobCells){if(!Array.isArray(e.blobCells))throw TypeError(".perfetto.protos.QueryResult.CellsBatch.blobCells: array expected");t.blobCells=[];for(r=0;r<e.blobCells.length;++r)"string"==typeof e.blobCells[r]?i.base64.decode(e.blobCells[r],t.blobCells[r]=i.newBuffer(i.base64.length(e.blobCells[r])),0):0<=e.blobCells[r].length&&(t.blobCells[r]=e.blobCells[r])}return null!=e.stringCells&&(t.stringCells=String(e.stringCells)),null!=e.isLastBatch&&(t.isLastBatch=Boolean(e.isLastBatch)),t},Ht.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.cells=[],r.varintCells=[],r.float64Cells=[],r.blobCells=[]),t.defaults&&(r.stringCells="",r.isLastBatch=!1),e.cells&&e.cells.length){r.cells=[];for(var n=0;n<e.cells.length;++n)r.cells[n]=t.enums!==String||void 0===s.perfetto.protos.QueryResult.CellsBatch.CellType[e.cells[n]]?e.cells[n]:s.perfetto.protos.QueryResult.CellsBatch.CellType[e.cells[n]]}if(e.varintCells&&e.varintCells.length){r.varintCells=[];for(n=0;n<e.varintCells.length;++n)"number"==typeof e.varintCells[n]?r.varintCells[n]=t.longs===String?String(e.varintCells[n]):e.varintCells[n]:r.varintCells[n]=t.longs===String?i.Long.prototype.toString.call(e.varintCells[n]):t.longs===Number?new i.LongBits(e.varintCells[n].low>>>0,e.varintCells[n].high>>>0).toNumber():e.varintCells[n]}if(e.float64Cells&&e.float64Cells.length){r.float64Cells=[];for(n=0;n<e.float64Cells.length;++n)r.float64Cells[n]=t.json&&!isFinite(e.float64Cells[n])?String(e.float64Cells[n]):e.float64Cells[n]}if(e.blobCells&&e.blobCells.length){r.blobCells=[];for(n=0;n<e.blobCells.length;++n)r.blobCells[n]=t.bytes===String?i.base64.encode(e.blobCells[n],0,e.blobCells[n].length):t.bytes===Array?Array.prototype.slice.call(e.blobCells[n]):e.blobCells[n]}return null!=e.stringCells&&e.hasOwnProperty("stringCells")&&(r.stringCells=e.stringCells),null!=e.isLastBatch&&e.hasOwnProperty("isLastBatch")&&(r.isLastBatch=e.isLastBatch),r},Ht.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Ht.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.QueryResult.CellsBatch"},Ht.CellType=(t={},(e=Object.create(t))[t[0]="CELL_INVALID"]=0,e[t[1]="CELL_NULL"]=1,e[t[2]="CELL_VARINT"]=2,e[t[3]="CELL_FLOAT64"]=3,e[t[4]="CELL_STRING"]=4,e[t[5]="CELL_BLOB"]=5,e),Ht),jt),r.StatusArgs=(Gt.create=function(e){return new Gt(e)},Gt.encode=function(e,t){return t=t||a.create()},Gt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,t=new s.perfetto.protos.StatusArgs;e.pos<r;){var n=e.uint32();e.skipType(7&n)}return t},Gt.fromObject=function(e){return e instanceof s.perfetto.protos.StatusArgs?e:new s.perfetto.protos.StatusArgs},Gt.toObject=function(){return{}},Gt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Gt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.StatusArgs"},Gt),r.StatusResult=(Vt.prototype.loadedTraceName="",Vt.prototype.humanReadableVersion="",Vt.prototype.apiVersion=0,Vt.prototype.versionCode="",Vt.create=function(e){return new Vt(e)},Vt.encode=function(e,t){return t=t||a.create(),null!=e.loadedTraceName&&Object.hasOwnProperty.call(e,"loadedTraceName")&&t.uint32(10).string(e.loadedTraceName),null!=e.humanReadableVersion&&Object.hasOwnProperty.call(e,"humanReadableVersion")&&t.uint32(18).string(e.humanReadableVersion),null!=e.apiVersion&&Object.hasOwnProperty.call(e,"apiVersion")&&t.uint32(24).int32(e.apiVersion),null!=e.versionCode&&Object.hasOwnProperty.call(e,"versionCode")&&t.uint32(34).string(e.versionCode),t},Vt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.StatusResult;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.loadedTraceName=e.string();break;case 2:n.humanReadableVersion=e.string();break;case 3:n.apiVersion=e.int32();break;case 4:n.versionCode=e.string();break;default:e.skipType(7&a)}}return n},Vt.fromObject=function(e){var t;return e instanceof s.perfetto.protos.StatusResult?e:(t=new s.perfetto.protos.StatusResult,null!=e.loadedTraceName&&(t.loadedTraceName=String(e.loadedTraceName)),null!=e.humanReadableVersion&&(t.humanReadableVersion=String(e.humanReadableVersion)),null!=e.apiVersion&&(t.apiVersion=0|e.apiVersion),null!=e.versionCode&&(t.versionCode=String(e.versionCode)),t)},Vt.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.loadedTraceName="",r.humanReadableVersion="",r.apiVersion=0,r.versionCode=""),null!=e.loadedTraceName&&e.hasOwnProperty("loadedTraceName")&&(r.loadedTraceName=e.loadedTraceName),null!=e.humanReadableVersion&&e.hasOwnProperty("humanReadableVersion")&&(r.humanReadableVersion=e.humanReadableVersion),null!=e.apiVersion&&e.hasOwnProperty("apiVersion")&&(r.apiVersion=e.apiVersion),null!=e.versionCode&&e.hasOwnProperty("versionCode")&&(r.versionCode=e.versionCode),r},Vt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Vt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.StatusResult"},Vt),r.ComputeMetricArgs=(Wt.prototype.metricNames=i.emptyArray,Wt.prototype.format=0,Wt.create=function(e){return new Wt(e)},Wt.encode=function(e,t){if(t=t||a.create(),null!=e.metricNames&&e.metricNames.length)for(var r=0;r<e.metricNames.length;++r)t.uint32(10).string(e.metricNames[r]);return null!=e.format&&Object.hasOwnProperty.call(e,"format")&&t.uint32(16).int32(e.format),t},Wt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.ComputeMetricArgs;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.metricNames&&n.metricNames.length||(n.metricNames=[]),n.metricNames.push(e.string());break;case 2:n.format=e.int32();break;default:e.skipType(7&a)}}return n},Wt.fromObject=function(e){if(e instanceof s.perfetto.protos.ComputeMetricArgs)return e;var t=new s.perfetto.protos.ComputeMetricArgs;if(e.metricNames){if(!Array.isArray(e.metricNames))throw TypeError(".perfetto.protos.ComputeMetricArgs.metricNames: array expected");t.metricNames=[];for(var r=0;r<e.metricNames.length;++r)t.metricNames[r]=String(e.metricNames[r])}switch(e.format){default:"number"==typeof e.format&&(t.format=e.format);break;case"BINARY_PROTOBUF":case 0:t.format=0;break;case"TEXTPROTO":case 1:t.format=1;break;case"JSON":case 2:t.format=2}return t},Wt.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.metricNames=[]),t.defaults&&(r.format=t.enums===String?"BINARY_PROTOBUF":0),e.metricNames&&e.metricNames.length){r.metricNames=[];for(var n=0;n<e.metricNames.length;++n)r.metricNames[n]=e.metricNames[n]}return null!=e.format&&e.hasOwnProperty("format")&&(r.format=t.enums!==String||void 0===s.perfetto.protos.ComputeMetricArgs.ResultFormat[e.format]?e.format:s.perfetto.protos.ComputeMetricArgs.ResultFormat[e.format]),r},Wt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Wt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.ComputeMetricArgs"},Wt.ResultFormat=(t={},(e=Object.create(t))[t[0]="BINARY_PROTOBUF"]=0,e[t[1]="TEXTPROTO"]=1,e[t[2]="JSON"]=2,e),Wt),r.ComputeMetricResult=(qt.prototype.metrics=null,qt.prototype.metricsAsPrototext=null,qt.prototype.metricsAsJson=null,qt.prototype.error="",Object.defineProperty(qt.prototype,"result",{get:i.oneOfGetter(t=["metrics","metricsAsPrototext","metricsAsJson"]),set:i.oneOfSetter(t)}),qt.create=function(e){return new qt(e)},qt.encode=function(e,t){return t=t||a.create(),null!=e.metrics&&Object.hasOwnProperty.call(e,"metrics")&&t.uint32(10).bytes(e.metrics),null!=e.error&&Object.hasOwnProperty.call(e,"error")&&t.uint32(18).string(e.error),null!=e.metricsAsPrototext&&Object.hasOwnProperty.call(e,"metricsAsPrototext")&&t.uint32(26).string(e.metricsAsPrototext),null!=e.metricsAsJson&&Object.hasOwnProperty.call(e,"metricsAsJson")&&t.uint32(34).string(e.metricsAsJson),t},qt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.ComputeMetricResult;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.metrics=e.bytes();break;case 3:n.metricsAsPrototext=e.string();break;case 4:n.metricsAsJson=e.string();break;case 2:n.error=e.string();break;default:e.skipType(7&a)}}return n},qt.fromObject=function(e){var t;return e instanceof s.perfetto.protos.ComputeMetricResult?e:(t=new s.perfetto.protos.ComputeMetricResult,null!=e.metrics&&("string"==typeof e.metrics?i.base64.decode(e.metrics,t.metrics=i.newBuffer(i.base64.length(e.metrics)),0):0<=e.metrics.length&&(t.metrics=e.metrics)),null!=e.metricsAsPrototext&&(t.metricsAsPrototext=String(e.metricsAsPrototext)),null!=e.metricsAsJson&&(t.metricsAsJson=String(e.metricsAsJson)),null!=e.error&&(t.error=String(e.error)),t)},qt.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.error=""),null!=e.metrics&&e.hasOwnProperty("metrics")&&(r.metrics=t.bytes===String?i.base64.encode(e.metrics,0,e.metrics.length):t.bytes===Array?Array.prototype.slice.call(e.metrics):e.metrics,t.oneofs)&&(r.result="metrics"),null!=e.error&&e.hasOwnProperty("error")&&(r.error=e.error),null!=e.metricsAsPrototext&&e.hasOwnProperty("metricsAsPrototext")&&(r.metricsAsPrototext=e.metricsAsPrototext,t.oneofs)&&(r.result="metricsAsPrototext"),null!=e.metricsAsJson&&e.hasOwnProperty("metricsAsJson")&&(r.metricsAsJson=e.metricsAsJson,t.oneofs)&&(r.result="metricsAsJson"),r},qt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},qt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.ComputeMetricResult"},qt),r.EnableMetatraceArgs=($t.prototype.categories=1,$t.create=function(e){return new $t(e)},$t.encode=function(e,t){return t=t||a.create(),null!=e.categories&&Object.hasOwnProperty.call(e,"categories")&&t.uint32(8).int32(e.categories),t},$t.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.EnableMetatraceArgs;e.pos<r;){var a=e.uint32();a>>>3==1?n.categories=e.int32():e.skipType(7&a)}return n},$t.fromObject=function(e){if(e instanceof s.perfetto.protos.EnableMetatraceArgs)return e;var t=new s.perfetto.protos.EnableMetatraceArgs;switch(e.categories){default:"number"==typeof e.categories&&(t.categories=e.categories);break;case"QUERY_TIMELINE":case 1:t.categories=1;break;case"QUERY_DETAILED":case 2:t.categories=2;break;case"FUNCTION_CALL":case 4:t.categories=4;break;case"DB":case 8:t.categories=8;break;case"API_TIMELINE":case 16:t.categories=16;break;case"NONE":case 0:t.categories=0;break;case"ALL":case 31:t.categories=31}return t},$t.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.categories=t.enums===String?"QUERY_TIMELINE":1),null!=e.categories&&e.hasOwnProperty("categories")&&(r.categories=t.enums!==String||void 0===s.perfetto.protos.MetatraceCategories[e.categories]?e.categories:s.perfetto.protos.MetatraceCategories[e.categories]),r},$t.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},$t.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.EnableMetatraceArgs"},$t),r.EnableMetatraceResult=(zt.create=function(e){return new zt(e)},zt.encode=function(e,t){return t=t||a.create()},zt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,t=new s.perfetto.protos.EnableMetatraceResult;e.pos<r;){var n=e.uint32();e.skipType(7&n)}return t},zt.fromObject=function(e){return e instanceof s.perfetto.protos.EnableMetatraceResult?e:new s.perfetto.protos.EnableMetatraceResult},zt.toObject=function(){return{}},zt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},zt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.EnableMetatraceResult"},zt),r.DisableAndReadMetatraceArgs=(Kt.create=function(e){return new Kt(e)},Kt.encode=function(e,t){return t=t||a.create()},Kt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,t=new s.perfetto.protos.DisableAndReadMetatraceArgs;e.pos<r;){var n=e.uint32();e.skipType(7&n)}return t},Kt.fromObject=function(e){return e instanceof s.perfetto.protos.DisableAndReadMetatraceArgs?e:new s.perfetto.protos.DisableAndReadMetatraceArgs},Kt.toObject=function(){return{}},Kt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Kt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.DisableAndReadMetatraceArgs"},Kt),r.DisableAndReadMetatraceResult=(Yt.prototype.metatrace=i.newBuffer([]),Yt.prototype.error="",Yt.create=function(e){return new Yt(e)},Yt.encode=function(e,t){return t=t||a.create(),null!=e.metatrace&&Object.hasOwnProperty.call(e,"metatrace")&&t.uint32(10).bytes(e.metatrace),null!=e.error&&Object.hasOwnProperty.call(e,"error")&&t.uint32(18).string(e.error),t},Yt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.DisableAndReadMetatraceResult;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.metatrace=e.bytes();break;case 2:n.error=e.string();break;default:e.skipType(7&a)}}return n},Yt.fromObject=function(e){var t;return e instanceof s.perfetto.protos.DisableAndReadMetatraceResult?e:(t=new s.perfetto.protos.DisableAndReadMetatraceResult,null!=e.metatrace&&("string"==typeof e.metatrace?i.base64.decode(e.metatrace,t.metatrace=i.newBuffer(i.base64.length(e.metatrace)),0):0<=e.metatrace.length&&(t.metatrace=e.metatrace)),null!=e.error&&(t.error=String(e.error)),t)},Yt.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(t.bytes===String?r.metatrace="":(r.metatrace=[],t.bytes!==Array&&(r.metatrace=i.newBuffer(r.metatrace))),r.error=""),null!=e.metatrace&&e.hasOwnProperty("metatrace")&&(r.metatrace=t.bytes===String?i.base64.encode(e.metatrace,0,e.metatrace.length):t.bytes===Array?Array.prototype.slice.call(e.metatrace):e.metatrace),null!=e.error&&e.hasOwnProperty("error")&&(r.error=e.error),r},Yt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Yt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.DisableAndReadMetatraceResult"},Yt),r.DescriptorSet=(Jt.prototype.descriptors=i.emptyArray,Jt.create=function(e){return new Jt(e)},Jt.encode=function(e,t){if(t=t||a.create(),null!=e.descriptors&&e.descriptors.length)for(var r=0;r<e.descriptors.length;++r)s.perfetto.protos.DescriptorProto.encode(e.descriptors[r],t.uint32(10).fork()).ldelim();return t},Jt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.DescriptorSet;e.pos<r;){var a=e.uint32();a>>>3==1?(n.descriptors&&n.descriptors.length||(n.descriptors=[]),n.descriptors.push(s.perfetto.protos.DescriptorProto.decode(e,e.uint32()))):e.skipType(7&a)}return n},Jt.fromObject=function(e){if(e instanceof s.perfetto.protos.DescriptorSet)return e;var t=new s.perfetto.protos.DescriptorSet;if(e.descriptors){if(!Array.isArray(e.descriptors))throw TypeError(".perfetto.protos.DescriptorSet.descriptors: array expected");t.descriptors=[];for(var r=0;r<e.descriptors.length;++r){if("object"!=typeof e.descriptors[r])throw TypeError(".perfetto.protos.DescriptorSet.descriptors: object expected");t.descriptors[r]=s.perfetto.protos.DescriptorProto.fromObject(e.descriptors[r])}}return t},Jt.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.descriptors=[]),e.descriptors&&e.descriptors.length){r.descriptors=[];for(var n=0;n<e.descriptors.length;++n)r.descriptors[n]=s.perfetto.protos.DescriptorProto.toObject(e.descriptors[n],t)}return r},Jt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Jt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.DescriptorSet"},Jt),r.ResetTraceProcessorArgs=(Zt.prototype.dropTrackEventDataBefore=0,Zt.prototype.ingestFtraceInRawTable=!1,Zt.prototype.analyzeTraceProtoContent=!1,Zt.prototype.ftraceDropUntilAllCpusValid=!1,Zt.create=function(e){return new Zt(e)},Zt.encode=function(e,t){return t=t||a.create(),null!=e.dropTrackEventDataBefore&&Object.hasOwnProperty.call(e,"dropTrackEventDataBefore")&&t.uint32(8).int32(e.dropTrackEventDataBefore),null!=e.ingestFtraceInRawTable&&Object.hasOwnProperty.call(e,"ingestFtraceInRawTable")&&t.uint32(16).bool(e.ingestFtraceInRawTable),null!=e.analyzeTraceProtoContent&&Object.hasOwnProperty.call(e,"analyzeTraceProtoContent")&&t.uint32(24).bool(e.analyzeTraceProtoContent),null!=e.ftraceDropUntilAllCpusValid&&Object.hasOwnProperty.call(e,"ftraceDropUntilAllCpusValid")&&t.uint32(32).bool(e.ftraceDropUntilAllCpusValid),t},Zt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.ResetTraceProcessorArgs;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.dropTrackEventDataBefore=e.int32();break;case 2:n.ingestFtraceInRawTable=e.bool();break;case 3:n.analyzeTraceProtoContent=e.bool();break;case 4:n.ftraceDropUntilAllCpusValid=e.bool();break;default:e.skipType(7&a)}}return n},Zt.fromObject=function(e){if(e instanceof s.perfetto.protos.ResetTraceProcessorArgs)return e;var t=new s.perfetto.protos.ResetTraceProcessorArgs;switch(e.dropTrackEventDataBefore){default:"number"==typeof e.dropTrackEventDataBefore&&(t.dropTrackEventDataBefore=e.dropTrackEventDataBefore);break;case"NO_DROP":case 0:t.dropTrackEventDataBefore=0;break;case"TRACK_EVENT_RANGE_OF_INTEREST":case 1:t.dropTrackEventDataBefore=1}return null!=e.ingestFtraceInRawTable&&(t.ingestFtraceInRawTable=Boolean(e.ingestFtraceInRawTable)),null!=e.analyzeTraceProtoContent&&(t.analyzeTraceProtoContent=Boolean(e.analyzeTraceProtoContent)),null!=e.ftraceDropUntilAllCpusValid&&(t.ftraceDropUntilAllCpusValid=Boolean(e.ftraceDropUntilAllCpusValid)),t},Zt.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.dropTrackEventDataBefore=t.enums===String?"NO_DROP":0,r.ingestFtraceInRawTable=!1,r.analyzeTraceProtoContent=!1,r.ftraceDropUntilAllCpusValid=!1),null!=e.dropTrackEventDataBefore&&e.hasOwnProperty("dropTrackEventDataBefore")&&(r.dropTrackEventDataBefore=t.enums!==String||void 0===s.perfetto.protos.ResetTraceProcessorArgs.DropTrackEventDataBefore[e.dropTrackEventDataBefore]?e.dropTrackEventDataBefore:s.perfetto.protos.ResetTraceProcessorArgs.DropTrackEventDataBefore[e.dropTrackEventDataBefore]),null!=e.ingestFtraceInRawTable&&e.hasOwnProperty("ingestFtraceInRawTable")&&(r.ingestFtraceInRawTable=e.ingestFtraceInRawTable),null!=e.analyzeTraceProtoContent&&e.hasOwnProperty("analyzeTraceProtoContent")&&(r.analyzeTraceProtoContent=e.analyzeTraceProtoContent),null!=e.ftraceDropUntilAllCpusValid&&e.hasOwnProperty("ftraceDropUntilAllCpusValid")&&(r.ftraceDropUntilAllCpusValid=e.ftraceDropUntilAllCpusValid),r},Zt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Zt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.ResetTraceProcessorArgs"},Zt.DropTrackEventDataBefore=(e={},(t=Object.create(e))[e[0]="NO_DROP"]=0,t[e[1]="TRACK_EVENT_RANGE_OF_INTEREST"]=1,t),Zt),r.FileDescriptorSet=(Qt.prototype.file=i.emptyArray,Qt.create=function(e){return new Qt(e)},Qt.encode=function(e,t){if(t=t||a.create(),null!=e.file&&e.file.length)for(var r=0;r<e.file.length;++r)s.perfetto.protos.FileDescriptorProto.encode(e.file[r],t.uint32(10).fork()).ldelim();return t},Qt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.FileDescriptorSet;e.pos<r;){var a=e.uint32();a>>>3==1?(n.file&&n.file.length||(n.file=[]),n.file.push(s.perfetto.protos.FileDescriptorProto.decode(e,e.uint32()))):e.skipType(7&a)}return n},Qt.fromObject=function(e){if(e instanceof s.perfetto.protos.FileDescriptorSet)return e;var t=new s.perfetto.protos.FileDescriptorSet;if(e.file){if(!Array.isArray(e.file))throw TypeError(".perfetto.protos.FileDescriptorSet.file: array expected");t.file=[];for(var r=0;r<e.file.length;++r){if("object"!=typeof e.file[r])throw TypeError(".perfetto.protos.FileDescriptorSet.file: object expected");t.file[r]=s.perfetto.protos.FileDescriptorProto.fromObject(e.file[r])}}return t},Qt.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.file=[]),e.file&&e.file.length){r.file=[];for(var n=0;n<e.file.length;++n)r.file[n]=s.perfetto.protos.FileDescriptorProto.toObject(e.file[n],t)}return r},Qt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Qt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.FileDescriptorSet"},Qt),r.FileDescriptorProto=(P.prototype.name="",P.prototype.package="",P.prototype.dependency=i.emptyArray,P.prototype.publicDependency=i.emptyArray,P.prototype.weakDependency=i.emptyArray,P.prototype.messageType=i.emptyArray,P.prototype.enumType=i.emptyArray,P.prototype.extension=i.emptyArray,P.create=function(e){return new P(e)},P.encode=function(e,t){if(t=t||a.create(),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.package&&Object.hasOwnProperty.call(e,"package")&&t.uint32(18).string(e.package),null!=e.dependency&&e.dependency.length)for(var r=0;r<e.dependency.length;++r)t.uint32(26).string(e.dependency[r]);if(null!=e.messageType&&e.messageType.length)for(r=0;r<e.messageType.length;++r)s.perfetto.protos.DescriptorProto.encode(e.messageType[r],t.uint32(34).fork()).ldelim();if(null!=e.enumType&&e.enumType.length)for(r=0;r<e.enumType.length;++r)s.perfetto.protos.EnumDescriptorProto.encode(e.enumType[r],t.uint32(42).fork()).ldelim();if(null!=e.extension&&e.extension.length)for(r=0;r<e.extension.length;++r)s.perfetto.protos.FieldDescriptorProto.encode(e.extension[r],t.uint32(58).fork()).ldelim();if(null!=e.publicDependency&&e.publicDependency.length)for(r=0;r<e.publicDependency.length;++r)t.uint32(80).int32(e.publicDependency[r]);if(null!=e.weakDependency&&e.weakDependency.length)for(r=0;r<e.weakDependency.length;++r)t.uint32(88).int32(e.weakDependency[r]);return t},P.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.FileDescriptorProto;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.name=e.string();break;case 2:n.package=e.string();break;case 3:n.dependency&&n.dependency.length||(n.dependency=[]),n.dependency.push(e.string());break;case 10:if(n.publicDependency&&n.publicDependency.length||(n.publicDependency=[]),2==(7&a))for(var i=e.uint32()+e.pos;e.pos<i;)n.publicDependency.push(e.int32());else n.publicDependency.push(e.int32());break;case 11:if(n.weakDependency&&n.weakDependency.length||(n.weakDependency=[]),2==(7&a))for(i=e.uint32()+e.pos;e.pos<i;)n.weakDependency.push(e.int32());else n.weakDependency.push(e.int32());break;case 4:n.messageType&&n.messageType.length||(n.messageType=[]),n.messageType.push(s.perfetto.protos.DescriptorProto.decode(e,e.uint32()));break;case 5:n.enumType&&n.enumType.length||(n.enumType=[]),n.enumType.push(s.perfetto.protos.EnumDescriptorProto.decode(e,e.uint32()));break;case 7:n.extension&&n.extension.length||(n.extension=[]),n.extension.push(s.perfetto.protos.FieldDescriptorProto.decode(e,e.uint32()));break;default:e.skipType(7&a)}}return n},P.fromObject=function(e){if(e instanceof s.perfetto.protos.FileDescriptorProto)return e;var t=new s.perfetto.protos.FileDescriptorProto;if(null!=e.name&&(t.name=String(e.name)),null!=e.package&&(t.package=String(e.package)),e.dependency){if(!Array.isArray(e.dependency))throw TypeError(".perfetto.protos.FileDescriptorProto.dependency: array expected");t.dependency=[];for(var r=0;r<e.dependency.length;++r)t.dependency[r]=String(e.dependency[r])}if(e.publicDependency){if(!Array.isArray(e.publicDependency))throw TypeError(".perfetto.protos.FileDescriptorProto.publicDependency: array expected");t.publicDependency=[];for(r=0;r<e.publicDependency.length;++r)t.publicDependency[r]=0|e.publicDependency[r]}if(e.weakDependency){if(!Array.isArray(e.weakDependency))throw TypeError(".perfetto.protos.FileDescriptorProto.weakDependency: array expected");t.weakDependency=[];for(r=0;r<e.weakDependency.length;++r)t.weakDependency[r]=0|e.weakDependency[r]}if(e.messageType){if(!Array.isArray(e.messageType))throw TypeError(".perfetto.protos.FileDescriptorProto.messageType: array expected");t.messageType=[];for(r=0;r<e.messageType.length;++r){if("object"!=typeof e.messageType[r])throw TypeError(".perfetto.protos.FileDescriptorProto.messageType: object expected");t.messageType[r]=s.perfetto.protos.DescriptorProto.fromObject(e.messageType[r])}}if(e.enumType){if(!Array.isArray(e.enumType))throw TypeError(".perfetto.protos.FileDescriptorProto.enumType: array expected");t.enumType=[];for(r=0;r<e.enumType.length;++r){if("object"!=typeof e.enumType[r])throw TypeError(".perfetto.protos.FileDescriptorProto.enumType: object expected");t.enumType[r]=s.perfetto.protos.EnumDescriptorProto.fromObject(e.enumType[r])}}if(e.extension){if(!Array.isArray(e.extension))throw TypeError(".perfetto.protos.FileDescriptorProto.extension: array expected");t.extension=[];for(r=0;r<e.extension.length;++r){if("object"!=typeof e.extension[r])throw TypeError(".perfetto.protos.FileDescriptorProto.extension: object expected");t.extension[r]=s.perfetto.protos.FieldDescriptorProto.fromObject(e.extension[r])}}return t},P.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.dependency=[],r.messageType=[],r.enumType=[],r.extension=[],r.publicDependency=[],r.weakDependency=[]),t.defaults&&(r.name="",r.package=""),null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.package&&e.hasOwnProperty("package")&&(r.package=e.package),e.dependency&&e.dependency.length){r.dependency=[];for(var n=0;n<e.dependency.length;++n)r.dependency[n]=e.dependency[n]}if(e.messageType&&e.messageType.length){r.messageType=[];for(n=0;n<e.messageType.length;++n)r.messageType[n]=s.perfetto.protos.DescriptorProto.toObject(e.messageType[n],t)}if(e.enumType&&e.enumType.length){r.enumType=[];for(n=0;n<e.enumType.length;++n)r.enumType[n]=s.perfetto.protos.EnumDescriptorProto.toObject(e.enumType[n],t)}if(e.extension&&e.extension.length){r.extension=[];for(n=0;n<e.extension.length;++n)r.extension[n]=s.perfetto.protos.FieldDescriptorProto.toObject(e.extension[n],t)}if(e.publicDependency&&e.publicDependency.length){r.publicDependency=[];for(n=0;n<e.publicDependency.length;++n)r.publicDependency[n]=e.publicDependency[n]}if(e.weakDependency&&e.weakDependency.length){r.weakDependency=[];for(n=0;n<e.weakDependency.length;++n)r.weakDependency[n]=e.weakDependency[n]}return r},P.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},P.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.FileDescriptorProto"},P),r.DescriptorProto=(N.prototype.name="",N.prototype.field=i.emptyArray,N.prototype.extension=i.emptyArray,N.prototype.nestedType=i.emptyArray,N.prototype.enumType=i.emptyArray,N.prototype.oneofDecl=i.emptyArray,N.prototype.reservedRange=i.emptyArray,N.prototype.reservedName=i.emptyArray,N.create=function(e){return new N(e)},N.encode=function(e,t){if(t=t||a.create(),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.field&&e.field.length)for(var r=0;r<e.field.length;++r)s.perfetto.protos.FieldDescriptorProto.encode(e.field[r],t.uint32(18).fork()).ldelim();if(null!=e.nestedType&&e.nestedType.length)for(r=0;r<e.nestedType.length;++r)s.perfetto.protos.DescriptorProto.encode(e.nestedType[r],t.uint32(26).fork()).ldelim();if(null!=e.enumType&&e.enumType.length)for(r=0;r<e.enumType.length;++r)s.perfetto.protos.EnumDescriptorProto.encode(e.enumType[r],t.uint32(34).fork()).ldelim();if(null!=e.extension&&e.extension.length)for(r=0;r<e.extension.length;++r)s.perfetto.protos.FieldDescriptorProto.encode(e.extension[r],t.uint32(50).fork()).ldelim();if(null!=e.oneofDecl&&e.oneofDecl.length)for(r=0;r<e.oneofDecl.length;++r)s.perfetto.protos.OneofDescriptorProto.encode(e.oneofDecl[r],t.uint32(66).fork()).ldelim();if(null!=e.reservedRange&&e.reservedRange.length)for(r=0;r<e.reservedRange.length;++r)s.perfetto.protos.DescriptorProto.ReservedRange.encode(e.reservedRange[r],t.uint32(74).fork()).ldelim();if(null!=e.reservedName&&e.reservedName.length)for(r=0;r<e.reservedName.length;++r)t.uint32(82).string(e.reservedName[r]);return t},N.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.DescriptorProto;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.name=e.string();break;case 2:n.field&&n.field.length||(n.field=[]),n.field.push(s.perfetto.protos.FieldDescriptorProto.decode(e,e.uint32()));break;case 6:n.extension&&n.extension.length||(n.extension=[]),n.extension.push(s.perfetto.protos.FieldDescriptorProto.decode(e,e.uint32()));break;case 3:n.nestedType&&n.nestedType.length||(n.nestedType=[]),n.nestedType.push(s.perfetto.protos.DescriptorProto.decode(e,e.uint32()));break;case 4:n.enumType&&n.enumType.length||(n.enumType=[]),n.enumType.push(s.perfetto.protos.EnumDescriptorProto.decode(e,e.uint32()));break;case 8:n.oneofDecl&&n.oneofDecl.length||(n.oneofDecl=[]),n.oneofDecl.push(s.perfetto.protos.OneofDescriptorProto.decode(e,e.uint32()));break;case 9:n.reservedRange&&n.reservedRange.length||(n.reservedRange=[]),n.reservedRange.push(s.perfetto.protos.DescriptorProto.ReservedRange.decode(e,e.uint32()));break;case 10:n.reservedName&&n.reservedName.length||(n.reservedName=[]),n.reservedName.push(e.string());break;default:e.skipType(7&a)}}return n},N.fromObject=function(e){if(e instanceof s.perfetto.protos.DescriptorProto)return e;var t=new s.perfetto.protos.DescriptorProto;if(null!=e.name&&(t.name=String(e.name)),e.field){if(!Array.isArray(e.field))throw TypeError(".perfetto.protos.DescriptorProto.field: array expected");t.field=[];for(var r=0;r<e.field.length;++r){if("object"!=typeof e.field[r])throw TypeError(".perfetto.protos.DescriptorProto.field: object expected");t.field[r]=s.perfetto.protos.FieldDescriptorProto.fromObject(e.field[r])}}if(e.extension){if(!Array.isArray(e.extension))throw TypeError(".perfetto.protos.DescriptorProto.extension: array expected");t.extension=[];for(r=0;r<e.extension.length;++r){if("object"!=typeof e.extension[r])throw TypeError(".perfetto.protos.DescriptorProto.extension: object expected");t.extension[r]=s.perfetto.protos.FieldDescriptorProto.fromObject(e.extension[r])}}if(e.nestedType){if(!Array.isArray(e.nestedType))throw TypeError(".perfetto.protos.DescriptorProto.nestedType: array expected");t.nestedType=[];for(r=0;r<e.nestedType.length;++r){if("object"!=typeof e.nestedType[r])throw TypeError(".perfetto.protos.DescriptorProto.nestedType: object expected");t.nestedType[r]=s.perfetto.protos.DescriptorProto.fromObject(e.nestedType[r])}}if(e.enumType){if(!Array.isArray(e.enumType))throw TypeError(".perfetto.protos.DescriptorProto.enumType: array expected");t.enumType=[];for(r=0;r<e.enumType.length;++r){if("object"!=typeof e.enumType[r])throw TypeError(".perfetto.protos.DescriptorProto.enumType: object expected");t.enumType[r]=s.perfetto.protos.EnumDescriptorProto.fromObject(e.enumType[r])}}if(e.oneofDecl){if(!Array.isArray(e.oneofDecl))throw TypeError(".perfetto.protos.DescriptorProto.oneofDecl: array expected");t.oneofDecl=[];for(r=0;r<e.oneofDecl.length;++r){if("object"!=typeof e.oneofDecl[r])throw TypeError(".perfetto.protos.DescriptorProto.oneofDecl: object expected");t.oneofDecl[r]=s.perfetto.protos.OneofDescriptorProto.fromObject(e.oneofDecl[r])}}if(e.reservedRange){if(!Array.isArray(e.reservedRange))throw TypeError(".perfetto.protos.DescriptorProto.reservedRange: array expected");t.reservedRange=[];for(r=0;r<e.reservedRange.length;++r){if("object"!=typeof e.reservedRange[r])throw TypeError(".perfetto.protos.DescriptorProto.reservedRange: object expected");t.reservedRange[r]=s.perfetto.protos.DescriptorProto.ReservedRange.fromObject(e.reservedRange[r])}}if(e.reservedName){if(!Array.isArray(e.reservedName))throw TypeError(".perfetto.protos.DescriptorProto.reservedName: array expected");t.reservedName=[];for(r=0;r<e.reservedName.length;++r)t.reservedName[r]=String(e.reservedName[r])}return t},N.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.field=[],r.nestedType=[],r.enumType=[],r.extension=[],r.oneofDecl=[],r.reservedRange=[],r.reservedName=[]),t.defaults&&(r.name=""),null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),e.field&&e.field.length){r.field=[];for(var n=0;n<e.field.length;++n)r.field[n]=s.perfetto.protos.FieldDescriptorProto.toObject(e.field[n],t)}if(e.nestedType&&e.nestedType.length){r.nestedType=[];for(n=0;n<e.nestedType.length;++n)r.nestedType[n]=s.perfetto.protos.DescriptorProto.toObject(e.nestedType[n],t)}if(e.enumType&&e.enumType.length){r.enumType=[];for(n=0;n<e.enumType.length;++n)r.enumType[n]=s.perfetto.protos.EnumDescriptorProto.toObject(e.enumType[n],t)}if(e.extension&&e.extension.length){r.extension=[];for(n=0;n<e.extension.length;++n)r.extension[n]=s.perfetto.protos.FieldDescriptorProto.toObject(e.extension[n],t)}if(e.oneofDecl&&e.oneofDecl.length){r.oneofDecl=[];for(n=0;n<e.oneofDecl.length;++n)r.oneofDecl[n]=s.perfetto.protos.OneofDescriptorProto.toObject(e.oneofDecl[n],t)}if(e.reservedRange&&e.reservedRange.length){r.reservedRange=[];for(n=0;n<e.reservedRange.length;++n)r.reservedRange[n]=s.perfetto.protos.DescriptorProto.ReservedRange.toObject(e.reservedRange[n],t)}if(e.reservedName&&e.reservedName.length){r.reservedName=[];for(n=0;n<e.reservedName.length;++n)r.reservedName[n]=e.reservedName[n]}return r},N.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},N.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.DescriptorProto"},N.ReservedRange=(Xt.prototype.start=0,Xt.prototype.end=0,Xt.create=function(e){return new Xt(e)},Xt.encode=function(e,t){return t=t||a.create(),null!=e.start&&Object.hasOwnProperty.call(e,"start")&&t.uint32(8).int32(e.start),null!=e.end&&Object.hasOwnProperty.call(e,"end")&&t.uint32(16).int32(e.end),t},Xt.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.DescriptorProto.ReservedRange;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.start=e.int32();break;case 2:n.end=e.int32();break;default:e.skipType(7&a)}}return n},Xt.fromObject=function(e){var t;return e instanceof s.perfetto.protos.DescriptorProto.ReservedRange?e:(t=new s.perfetto.protos.DescriptorProto.ReservedRange,null!=e.start&&(t.start=0|e.start),null!=e.end&&(t.end=0|e.end),t)},Xt.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.start=0,r.end=0),null!=e.start&&e.hasOwnProperty("start")&&(r.start=e.start),null!=e.end&&e.hasOwnProperty("end")&&(r.end=e.end),r},Xt.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},Xt.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.DescriptorProto.ReservedRange"},Xt),N),r.UninterpretedOption=(D.prototype.name=i.emptyArray,D.prototype.identifierValue="",D.prototype.positiveIntValue=i.Long?i.Long.fromBits(0,0,!0):0,D.prototype.negativeIntValue=i.Long?i.Long.fromBits(0,0,!1):0,D.prototype.doubleValue=0,D.prototype.stringValue=i.newBuffer([]),D.prototype.aggregateValue="",D.create=function(e){return new D(e)},D.encode=function(e,t){if(t=t||a.create(),null!=e.name&&e.name.length)for(var r=0;r<e.name.length;++r)s.perfetto.protos.UninterpretedOption.NamePart.encode(e.name[r],t.uint32(18).fork()).ldelim();return null!=e.identifierValue&&Object.hasOwnProperty.call(e,"identifierValue")&&t.uint32(26).string(e.identifierValue),null!=e.positiveIntValue&&Object.hasOwnProperty.call(e,"positiveIntValue")&&t.uint32(32).uint64(e.positiveIntValue),null!=e.negativeIntValue&&Object.hasOwnProperty.call(e,"negativeIntValue")&&t.uint32(40).int64(e.negativeIntValue),null!=e.doubleValue&&Object.hasOwnProperty.call(e,"doubleValue")&&t.uint32(49).double(e.doubleValue),null!=e.stringValue&&Object.hasOwnProperty.call(e,"stringValue")&&t.uint32(58).bytes(e.stringValue),null!=e.aggregateValue&&Object.hasOwnProperty.call(e,"aggregateValue")&&t.uint32(66).string(e.aggregateValue),t},D.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.UninterpretedOption;e.pos<r;){var a=e.uint32();switch(a>>>3){case 2:n.name&&n.name.length||(n.name=[]),n.name.push(s.perfetto.protos.UninterpretedOption.NamePart.decode(e,e.uint32()));break;case 3:n.identifierValue=e.string();break;case 4:n.positiveIntValue=e.uint64();break;case 5:n.negativeIntValue=e.int64();break;case 6:n.doubleValue=e.double();break;case 7:n.stringValue=e.bytes();break;case 8:n.aggregateValue=e.string();break;default:e.skipType(7&a)}}return n},D.fromObject=function(e){if(e instanceof s.perfetto.protos.UninterpretedOption)return e;var t=new s.perfetto.protos.UninterpretedOption;if(e.name){if(!Array.isArray(e.name))throw TypeError(".perfetto.protos.UninterpretedOption.name: array expected");t.name=[];for(var r=0;r<e.name.length;++r){if("object"!=typeof e.name[r])throw TypeError(".perfetto.protos.UninterpretedOption.name: object expected");t.name[r]=s.perfetto.protos.UninterpretedOption.NamePart.fromObject(e.name[r])}}return null!=e.identifierValue&&(t.identifierValue=String(e.identifierValue)),null!=e.positiveIntValue&&(i.Long?(t.positiveIntValue=i.Long.fromValue(e.positiveIntValue)).unsigned=!0:"string"==typeof e.positiveIntValue?t.positiveIntValue=parseInt(e.positiveIntValue,10):"number"==typeof e.positiveIntValue?t.positiveIntValue=e.positiveIntValue:"object"==typeof e.positiveIntValue&&(t.positiveIntValue=new i.LongBits(e.positiveIntValue.low>>>0,e.positiveIntValue.high>>>0).toNumber(!0))),null!=e.negativeIntValue&&(i.Long?(t.negativeIntValue=i.Long.fromValue(e.negativeIntValue)).unsigned=!1:"string"==typeof e.negativeIntValue?t.negativeIntValue=parseInt(e.negativeIntValue,10):"number"==typeof e.negativeIntValue?t.negativeIntValue=e.negativeIntValue:"object"==typeof e.negativeIntValue&&(t.negativeIntValue=new i.LongBits(e.negativeIntValue.low>>>0,e.negativeIntValue.high>>>0).toNumber())),null!=e.doubleValue&&(t.doubleValue=Number(e.doubleValue)),null!=e.stringValue&&("string"==typeof e.stringValue?i.base64.decode(e.stringValue,t.stringValue=i.newBuffer(i.base64.length(e.stringValue)),0):0<=e.stringValue.length&&(t.stringValue=e.stringValue)),null!=e.aggregateValue&&(t.aggregateValue=String(e.aggregateValue)),t},D.toObject=function(e,t){var r,n={};if(((t=t||{}).arrays||t.defaults)&&(n.name=[]),t.defaults&&(n.identifierValue="",i.Long?(r=new i.Long(0,0,!0),n.positiveIntValue=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.positiveIntValue=t.longs===String?"0":0,i.Long?(r=new i.Long(0,0,!1),n.negativeIntValue=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.negativeIntValue=t.longs===String?"0":0,n.doubleValue=0,t.bytes===String?n.stringValue="":(n.stringValue=[],t.bytes!==Array&&(n.stringValue=i.newBuffer(n.stringValue))),n.aggregateValue=""),e.name&&e.name.length){n.name=[];for(var a=0;a<e.name.length;++a)n.name[a]=s.perfetto.protos.UninterpretedOption.NamePart.toObject(e.name[a],t)}return null!=e.identifierValue&&e.hasOwnProperty("identifierValue")&&(n.identifierValue=e.identifierValue),null!=e.positiveIntValue&&e.hasOwnProperty("positiveIntValue")&&("number"==typeof e.positiveIntValue?n.positiveIntValue=t.longs===String?String(e.positiveIntValue):e.positiveIntValue:n.positiveIntValue=t.longs===String?i.Long.prototype.toString.call(e.positiveIntValue):t.longs===Number?new i.LongBits(e.positiveIntValue.low>>>0,e.positiveIntValue.high>>>0).toNumber(!0):e.positiveIntValue),null!=e.negativeIntValue&&e.hasOwnProperty("negativeIntValue")&&("number"==typeof e.negativeIntValue?n.negativeIntValue=t.longs===String?String(e.negativeIntValue):e.negativeIntValue:n.negativeIntValue=t.longs===String?i.Long.prototype.toString.call(e.negativeIntValue):t.longs===Number?new i.LongBits(e.negativeIntValue.low>>>0,e.negativeIntValue.high>>>0).toNumber():e.negativeIntValue),null!=e.doubleValue&&e.hasOwnProperty("doubleValue")&&(n.doubleValue=t.json&&!isFinite(e.doubleValue)?String(e.doubleValue):e.doubleValue),null!=e.stringValue&&e.hasOwnProperty("stringValue")&&(n.stringValue=t.bytes===String?i.base64.encode(e.stringValue,0,e.stringValue.length):t.bytes===Array?Array.prototype.slice.call(e.stringValue):e.stringValue),null!=e.aggregateValue&&e.hasOwnProperty("aggregateValue")&&(n.aggregateValue=e.aggregateValue),n},D.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},D.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.UninterpretedOption"},D.NamePart=(er.prototype.namePart="",er.prototype.isExtension=!1,er.create=function(e){return new er(e)},er.encode=function(e,t){return t=t||a.create(),null!=e.namePart&&Object.hasOwnProperty.call(e,"namePart")&&t.uint32(10).string(e.namePart),null!=e.isExtension&&Object.hasOwnProperty.call(e,"isExtension")&&t.uint32(16).bool(e.isExtension),t},er.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.UninterpretedOption.NamePart;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.namePart=e.string();break;case 2:n.isExtension=e.bool();break;default:e.skipType(7&a)}}return n},er.fromObject=function(e){var t;return e instanceof s.perfetto.protos.UninterpretedOption.NamePart?e:(t=new s.perfetto.protos.UninterpretedOption.NamePart,null!=e.namePart&&(t.namePart=String(e.namePart)),null!=e.isExtension&&(t.isExtension=Boolean(e.isExtension)),t)},er.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.namePart="",r.isExtension=!1),null!=e.namePart&&e.hasOwnProperty("namePart")&&(r.namePart=e.namePart),null!=e.isExtension&&e.hasOwnProperty("isExtension")&&(r.isExtension=e.isExtension),r},er.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},er.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.UninterpretedOption.NamePart"},er),D),r.FieldOptions=(tr.prototype.packed=!1,tr.prototype.uninterpretedOption=i.emptyArray,tr.create=function(e){return new tr(e)},tr.encode=function(e,t){if(t=t||a.create(),null!=e.packed&&Object.hasOwnProperty.call(e,"packed")&&t.uint32(16).bool(e.packed),null!=e.uninterpretedOption&&e.uninterpretedOption.length)for(var r=0;r<e.uninterpretedOption.length;++r)s.perfetto.protos.UninterpretedOption.encode(e.uninterpretedOption[r],t.uint32(7994).fork()).ldelim();return t},tr.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.FieldOptions;e.pos<r;){var a=e.uint32();switch(a>>>3){case 2:n.packed=e.bool();break;case 999:n.uninterpretedOption&&n.uninterpretedOption.length||(n.uninterpretedOption=[]),n.uninterpretedOption.push(s.perfetto.protos.UninterpretedOption.decode(e,e.uint32()));break;default:e.skipType(7&a)}}return n},tr.fromObject=function(e){if(e instanceof s.perfetto.protos.FieldOptions)return e;var t=new s.perfetto.protos.FieldOptions;if(null!=e.packed&&(t.packed=Boolean(e.packed)),e.uninterpretedOption){if(!Array.isArray(e.uninterpretedOption))throw TypeError(".perfetto.protos.FieldOptions.uninterpretedOption: array expected");t.uninterpretedOption=[];for(var r=0;r<e.uninterpretedOption.length;++r){if("object"!=typeof e.uninterpretedOption[r])throw TypeError(".perfetto.protos.FieldOptions.uninterpretedOption: object expected");t.uninterpretedOption[r]=s.perfetto.protos.UninterpretedOption.fromObject(e.uninterpretedOption[r])}}return t},tr.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.uninterpretedOption=[]),t.defaults&&(r.packed=!1),null!=e.packed&&e.hasOwnProperty("packed")&&(r.packed=e.packed),e.uninterpretedOption&&e.uninterpretedOption.length){r.uninterpretedOption=[];for(var n=0;n<e.uninterpretedOption.length;++n)r.uninterpretedOption[n]=s.perfetto.protos.UninterpretedOption.toObject(e.uninterpretedOption[n],t)}return r},tr.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},tr.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.FieldOptions"},tr),r.FieldDescriptorProto=(x.prototype.name="",x.prototype.number=0,x.prototype.label=1,x.prototype.type=1,x.prototype.typeName="",x.prototype.extendee="",x.prototype.defaultValue="",x.prototype.options=null,x.prototype.oneofIndex=0,x.create=function(e){return new x(e)},x.encode=function(e,t){return t=t||a.create(),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.extendee&&Object.hasOwnProperty.call(e,"extendee")&&t.uint32(18).string(e.extendee),null!=e.number&&Object.hasOwnProperty.call(e,"number")&&t.uint32(24).int32(e.number),null!=e.label&&Object.hasOwnProperty.call(e,"label")&&t.uint32(32).int32(e.label),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(40).int32(e.type),null!=e.typeName&&Object.hasOwnProperty.call(e,"typeName")&&t.uint32(50).string(e.typeName),null!=e.defaultValue&&Object.hasOwnProperty.call(e,"defaultValue")&&t.uint32(58).string(e.defaultValue),null!=e.options&&Object.hasOwnProperty.call(e,"options")&&s.perfetto.protos.FieldOptions.encode(e.options,t.uint32(66).fork()).ldelim(),null!=e.oneofIndex&&Object.hasOwnProperty.call(e,"oneofIndex")&&t.uint32(72).int32(e.oneofIndex),t},x.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.FieldDescriptorProto;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.name=e.string();break;case 3:n.number=e.int32();break;case 4:n.label=e.int32();break;case 5:n.type=e.int32();break;case 6:n.typeName=e.string();break;case 2:n.extendee=e.string();break;case 7:n.defaultValue=e.string();break;case 8:n.options=s.perfetto.protos.FieldOptions.decode(e,e.uint32());break;case 9:n.oneofIndex=e.int32();break;default:e.skipType(7&a)}}return n},x.fromObject=function(e){if(e instanceof s.perfetto.protos.FieldDescriptorProto)return e;var t=new s.perfetto.protos.FieldDescriptorProto;switch(null!=e.name&&(t.name=String(e.name)),null!=e.number&&(t.number=0|e.number),e.label){default:"number"==typeof e.label&&(t.label=e.label);break;case"LABEL_OPTIONAL":case 1:t.label=1;break;case"LABEL_REQUIRED":case 2:t.label=2;break;case"LABEL_REPEATED":case 3:t.label=3}switch(e.type){default:"number"==typeof e.type&&(t.type=e.type);break;case"TYPE_DOUBLE":case 1:t.type=1;break;case"TYPE_FLOAT":case 2:t.type=2;break;case"TYPE_INT64":case 3:t.type=3;break;case"TYPE_UINT64":case 4:t.type=4;break;case"TYPE_INT32":case 5:t.type=5;break;case"TYPE_FIXED64":case 6:t.type=6;break;case"TYPE_FIXED32":case 7:t.type=7;break;case"TYPE_BOOL":case 8:t.type=8;break;case"TYPE_STRING":case 9:t.type=9;break;case"TYPE_GROUP":case 10:t.type=10;break;case"TYPE_MESSAGE":case 11:t.type=11;break;case"TYPE_BYTES":case 12:t.type=12;break;case"TYPE_UINT32":case 13:t.type=13;break;case"TYPE_ENUM":case 14:t.type=14;break;case"TYPE_SFIXED32":case 15:t.type=15;break;case"TYPE_SFIXED64":case 16:t.type=16;break;case"TYPE_SINT32":case 17:t.type=17;break;case"TYPE_SINT64":case 18:t.type=18}if(null!=e.typeName&&(t.typeName=String(e.typeName)),null!=e.extendee&&(t.extendee=String(e.extendee)),null!=e.defaultValue&&(t.defaultValue=String(e.defaultValue)),null!=e.options){if("object"!=typeof e.options)throw TypeError(".perfetto.protos.FieldDescriptorProto.options: object expected");t.options=s.perfetto.protos.FieldOptions.fromObject(e.options)}return null!=e.oneofIndex&&(t.oneofIndex=0|e.oneofIndex),t},x.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.name="",r.extendee="",r.number=0,r.label=t.enums===String?"LABEL_OPTIONAL":1,r.type=t.enums===String?"TYPE_DOUBLE":1,r.typeName="",r.defaultValue="",r.options=null,r.oneofIndex=0),null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.extendee&&e.hasOwnProperty("extendee")&&(r.extendee=e.extendee),null!=e.number&&e.hasOwnProperty("number")&&(r.number=e.number),null!=e.label&&e.hasOwnProperty("label")&&(r.label=t.enums!==String||void 0===s.perfetto.protos.FieldDescriptorProto.Label[e.label]?e.label:s.perfetto.protos.FieldDescriptorProto.Label[e.label]),null!=e.type&&e.hasOwnProperty("type")&&(r.type=t.enums!==String||void 0===s.perfetto.protos.FieldDescriptorProto.Type[e.type]?e.type:s.perfetto.protos.FieldDescriptorProto.Type[e.type]),null!=e.typeName&&e.hasOwnProperty("typeName")&&(r.typeName=e.typeName),null!=e.defaultValue&&e.hasOwnProperty("defaultValue")&&(r.defaultValue=e.defaultValue),null!=e.options&&e.hasOwnProperty("options")&&(r.options=s.perfetto.protos.FieldOptions.toObject(e.options,t)),null!=e.oneofIndex&&e.hasOwnProperty("oneofIndex")&&(r.oneofIndex=e.oneofIndex),r},x.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},x.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.FieldDescriptorProto"},x.Type=(e={},(t=Object.create(e))[e[1]="TYPE_DOUBLE"]=1,t[e[2]="TYPE_FLOAT"]=2,t[e[3]="TYPE_INT64"]=3,t[e[4]="TYPE_UINT64"]=4,t[e[5]="TYPE_INT32"]=5,t[e[6]="TYPE_FIXED64"]=6,t[e[7]="TYPE_FIXED32"]=7,t[e[8]="TYPE_BOOL"]=8,t[e[9]="TYPE_STRING"]=9,t[e[10]="TYPE_GROUP"]=10,t[e[11]="TYPE_MESSAGE"]=11,t[e[12]="TYPE_BYTES"]=12,t[e[13]="TYPE_UINT32"]=13,t[e[14]="TYPE_ENUM"]=14,t[e[15]="TYPE_SFIXED32"]=15,t[e[16]="TYPE_SFIXED64"]=16,t[e[17]="TYPE_SINT32"]=17,t[e[18]="TYPE_SINT64"]=18,t),x.Label=(e={},(t=Object.create(e))[e[1]="LABEL_OPTIONAL"]=1,t[e[2]="LABEL_REQUIRED"]=2,t[e[3]="LABEL_REPEATED"]=3,t),x),r.OneofDescriptorProto=(rr.prototype.name="",rr.prototype.options=null,rr.create=function(e){return new rr(e)},rr.encode=function(e,t){return t=t||a.create(),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.options&&Object.hasOwnProperty.call(e,"options")&&s.perfetto.protos.OneofOptions.encode(e.options,t.uint32(18).fork()).ldelim(),t},rr.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.OneofDescriptorProto;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.name=e.string();break;case 2:n.options=s.perfetto.protos.OneofOptions.decode(e,e.uint32());break;default:e.skipType(7&a)}}return n},rr.fromObject=function(e){if(e instanceof s.perfetto.protos.OneofDescriptorProto)return e;var t=new s.perfetto.protos.OneofDescriptorProto;if(null!=e.name&&(t.name=String(e.name)),null!=e.options){if("object"!=typeof e.options)throw TypeError(".perfetto.protos.OneofDescriptorProto.options: object expected");t.options=s.perfetto.protos.OneofOptions.fromObject(e.options)}return t},rr.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.name="",r.options=null),null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.options&&e.hasOwnProperty("options")&&(r.options=s.perfetto.protos.OneofOptions.toObject(e.options,t)),r},rr.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},rr.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.OneofDescriptorProto"},rr),r.EnumDescriptorProto=(nr.prototype.name="",nr.prototype.value=i.emptyArray,nr.prototype.reservedName=i.emptyArray,nr.create=function(e){return new nr(e)},nr.encode=function(e,t){if(t=t||a.create(),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.value&&e.value.length)for(var r=0;r<e.value.length;++r)s.perfetto.protos.EnumValueDescriptorProto.encode(e.value[r],t.uint32(18).fork()).ldelim();if(null!=e.reservedName&&e.reservedName.length)for(r=0;r<e.reservedName.length;++r)t.uint32(42).string(e.reservedName[r]);return t},nr.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.EnumDescriptorProto;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.name=e.string();break;case 2:n.value&&n.value.length||(n.value=[]),n.value.push(s.perfetto.protos.EnumValueDescriptorProto.decode(e,e.uint32()));break;case 5:n.reservedName&&n.reservedName.length||(n.reservedName=[]),n.reservedName.push(e.string());break;default:e.skipType(7&a)}}return n},nr.fromObject=function(e){if(e instanceof s.perfetto.protos.EnumDescriptorProto)return e;var t=new s.perfetto.protos.EnumDescriptorProto;if(null!=e.name&&(t.name=String(e.name)),e.value){if(!Array.isArray(e.value))throw TypeError(".perfetto.protos.EnumDescriptorProto.value: array expected");t.value=[];for(var r=0;r<e.value.length;++r){if("object"!=typeof e.value[r])throw TypeError(".perfetto.protos.EnumDescriptorProto.value: object expected");t.value[r]=s.perfetto.protos.EnumValueDescriptorProto.fromObject(e.value[r])}}if(e.reservedName){if(!Array.isArray(e.reservedName))throw TypeError(".perfetto.protos.EnumDescriptorProto.reservedName: array expected");t.reservedName=[];for(r=0;r<e.reservedName.length;++r)t.reservedName[r]=String(e.reservedName[r])}return t},nr.toObject=function(e,t){var r={};if(((t=t||{}).arrays||t.defaults)&&(r.value=[],r.reservedName=[]),t.defaults&&(r.name=""),null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),e.value&&e.value.length){r.value=[];for(var n=0;n<e.value.length;++n)r.value[n]=s.perfetto.protos.EnumValueDescriptorProto.toObject(e.value[n],t)}if(e.reservedName&&e.reservedName.length){r.reservedName=[];for(n=0;n<e.reservedName.length;++n)r.reservedName[n]=e.reservedName[n]}return r},nr.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},nr.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.EnumDescriptorProto"},nr),r.EnumValueDescriptorProto=(ar.prototype.name="",ar.prototype.number=0,ar.create=function(e){return new ar(e)},ar.encode=function(e,t){return t=t||a.create(),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.number&&Object.hasOwnProperty.call(e,"number")&&t.uint32(16).int32(e.number),t},ar.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new s.perfetto.protos.EnumValueDescriptorProto;e.pos<r;){var a=e.uint32();switch(a>>>3){case 1:n.name=e.string();break;case 2:n.number=e.int32();break;default:e.skipType(7&a)}}return n},ar.fromObject=function(e){var t;return e instanceof s.perfetto.protos.EnumValueDescriptorProto?e:(t=new s.perfetto.protos.EnumValueDescriptorProto,null!=e.name&&(t.name=String(e.name)),null!=e.number&&(t.number=0|e.number),t)},ar.toObject=function(e,t){var r={};return(t=t||{}).defaults&&(r.name="",r.number=0),null!=e.name&&e.hasOwnProperty("name")&&(r.name=e.name),null!=e.number&&e.hasOwnProperty("number")&&(r.number=e.number),r},ar.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},ar.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.EnumValueDescriptorProto"},ar),r.OneofOptions=(ir.create=function(e){return new ir(e)},ir.encode=function(e,t){return t=t||a.create()},ir.decode=function(e,t){e instanceof o||(e=o.create(e));for(var r=void 0===t?e.len:e.pos+t,t=new s.perfetto.protos.OneofOptions;e.pos<r;){var n=e.uint32();e.skipType(7&n)}return t},ir.fromObject=function(e){return e instanceof s.perfetto.protos.OneofOptions?e:new s.perfetto.protos.OneofOptions},ir.toObject=function(){return{}},ir.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},ir.getTypeUrl=function(e){return(e=void 0===e?"type.googleapis.com":e)+"/perfetto.protos.OneofOptions"},ir),r.MetatraceCategories=(e={},(t=Object.create(e))[e[1]="QUERY_TIMELINE"]=1,t[e[2]="QUERY_DETAILED"]=2,t[e[4]="FUNCTION_CALL"]=4,t[e[8]="DB"]=8,t[e[16]="API_TIMELINE"]=16,t[e[0]="NONE"]=0,t[e[31]="ALL"]=31,t),r),L),_a=s),_a))).default.perfetto.protos.AndroidLogConfig,sr.AndroidLogConfig=t,r=e.default.perfetto.protos.AndroidLogId,sr.AndroidLogId=r,L=e.default.perfetto.protos.AndroidPowerConfig,sr.AndroidPowerConfig=L,l=e.default.perfetto.protos.AndroidPowerConfig.BatteryCounters,sr.BatteryCounters=l,l=e.default.perfetto.protos.TraceConfig.BufferConfig,sr.BufferConfig=l,l=e.default.perfetto.protos.ChromeConfig,sr.ChromeConfig=l,l=e.default.perfetto.protos.ComputeMetricArgs,sr.ComputeMetricArgs=l,l=e.default.perfetto.protos.ComputeMetricResult,sr.ComputeMetricResult=l,l=e.default.perfetto.protos.ConsumerPort,sr.ConsumerPort=l,l=e.default.perfetto.protos.DataSourceConfig,sr.DataSourceConfig=l,l=e.default.perfetto.protos.DataSourceDescriptor,sr.DataSourceDescriptor=l,l=e.default.perfetto.protos.DisableAndReadMetatraceResult,sr.DisableAndReadMetatraceResult=l,l=e.default.perfetto.protos.DisableTracingRequest,sr.DisableTracingRequest=l,l=e.default.perfetto.protos.DisableTracingResponse,sr.DisableTracingResponse=l,l=e.default.perfetto.protos.EnableMetatraceArgs,sr.EnableMetatraceArgs=l,l=e.default.perfetto.protos.EnableTracingRequest,sr.EnableTracingRequest=l,l=e.default.perfetto.protos.EnableTracingResponse,sr.EnableTracingResponse=l,l=e.default.perfetto.protos.EtwConfig,sr.EtwConfig=l,l=e.default.perfetto.protos.FreeBuffersRequest,sr.FreeBuffersRequest=l,l=e.default.perfetto.protos.FreeBuffersResponse,sr.FreeBuffersResponse=l,l=e.default.perfetto.protos.FtraceConfig,sr.FtraceConfig=l,l=e.default.perfetto.protos.GetTraceStatsRequest,sr.GetTraceStatsRequest=l,l=e.default.perfetto.protos.GetTraceStatsResponse,sr.GetTraceStatsResponse=l,l=e.default.perfetto.protos.HeapprofdConfig,sr.HeapprofdConfig=l,l=e.default.perfetto.protos.IPCFrame,sr.IPCFrame=l,l=e.default.perfetto.protos.JavaHprofConfig.ContinuousDumpConfig,sr.JavaContinuousDumpConfig=l,l=e.default.perfetto.protos.JavaHprofConfig,sr.JavaHprofConfig=l,l=e.default.perfetto.protos.MeminfoCounters,sr.MeminfoCounters=l,l=e.default.perfetto.protos.MetatraceCategories,sr.MetatraceCategories=l,l=e.default.perfetto.protos.HeapprofdConfig.ContinuousDumpConfig,sr.NativeContinuousDumpConfig=l,l=e.default.perfetto.protos.NetworkPacketTraceConfig,sr.NetworkPacketTraceConfig=l,l=e.default.perfetto.protos.PerfEventConfig,sr.PerfEventConfig=l,l=e.default.perfetto.protos.PerfEvents,sr.PerfEvents=l,l=e.default.perfetto.protos.PerfettoMetatrace,sr.PerfettoMetatrace=l,l=e.default.perfetto.protos.ProcessStatsConfig,sr.ProcessStatsConfig=l,l=e.default.perfetto.protos.QueryArgs,sr.QueryArgs=l,l=e.default.perfetto.protos.QueryResult,sr.QueryResult=l,l=e.default.perfetto.protos.QueryServiceStateRequest,sr.QueryServiceStateRequest=l,l=e.default.perfetto.protos.QueryServiceStateResponse,sr.QueryServiceStateResponse=l,l=e.default.perfetto.protos.ReadBuffersRequest,sr.ReadBuffersRequest=l,l=e.default.perfetto.protos.ReadBuffersResponse,sr.ReadBuffersResponse=l,l=e.default.perfetto.protos.ResetTraceProcessorArgs,sr.ResetTraceProcessorArgs=l,l=e.default.perfetto.protos.SysStatsConfig.StatCounters,sr.StatCounters=l,l=e.default.perfetto.protos.StatusResult,sr.StatusResult=l,l=e.default.perfetto.protos.SysStatsConfig,sr.SysStatsConfig=l,l=e.default.perfetto.protos.TraceConfig,sr.TraceConfig=l,l=e.default.perfetto.protos.TraceProcessorApiVersion,sr.TraceProcessorApiVersion=l,l=e.default.perfetto.protos.TraceProcessorRpc,sr.TraceProcessorRpc=l,l=e.default.perfetto.protos.TraceProcessorRpcStream,sr.TraceProcessorRpcStream=l,l=e.default.perfetto.protos.TrackEventConfig,sr.TrackEventConfig=l,l=e.default.perfetto.protos.VmstatCounters,sr.VmstatCounters=l),sr;function c(e,t,r){n.rpc.Service.call(this,e,t,r)}function F(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function U(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function B(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function j(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function H(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function G(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function V(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function W(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function q(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function $(e){if(this.slices=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function z(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function K(e){if(this.bufferIds=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Y(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function J(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Z(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Q(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function X(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ee(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function te(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function re(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ne(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ae(e){if(this.eventsToObserve=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ie(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function oe(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function se(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function le(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ce(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ue(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function de(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function fe(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function pe(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function he(e){if(this.instanceStateChanges=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ge(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function me(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function u(e){if(this.producers=[],this.dataSources=[],this.tracingSessions=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function _e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ye(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function d(e){if(this.bufferSizeKb=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function f(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Te(e){if(this.atraceCategories=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function be(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function p(e){if(this.specs=[],this.blocks=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function h(e){if(this.numeratorUnits=[],this.denominatorUnits=[],this.groups=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ve(e){if(this.counterIds=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Ee(e){if(this.tags=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Se(e){if(this.availableCategories=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Ae(e){if(this.observableEvents=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function g(e){if(this.bufferStats=[],this.chunkPayloadHistogramDef=[],this.writerStats=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function m(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Oe(e){if(this.chunkPayloadHistogramCounts=[],this.chunkPayloadHistogramSum=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Ce(e){if(this.bytesDiscardedPerBuffer=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function _(e){if(this.buffers=[],this.dataSources=[],this.producers=[],this.activateTriggers=[],this.sessionSemaphores=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ke(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function we(e){if(this.producerNameFilter=[],this.producerNameRegexFilter=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function y(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Re(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Ie(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Me(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Pe(e){if(this.triggers=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Ne(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function De(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function xe(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Le(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Fe(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Ue(e){if(this.rules=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Be(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function je(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function He(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function T(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Ge(e){if(this.packageNameFilter=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Ve(e){if(this.rules=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function We(e){if(this.matchAllPackages=[],this.matchAnyPackages=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function qe(e){if(this.logIds=[],this.filterTags=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function $e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ze(e){if(this.propertyName=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Ke(e){if(this.hwuiPackageNameFilter=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Ye(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Je(e){if(this.packageNameFilter=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Ze(e){if(this.pigweedHashAllowList=[],this.pigweedHashDenyList=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Qe(e){if(this.groupOverrides=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Xe(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function et(e){if(this.traceFlags=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function tt(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function rt(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function nt(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function at(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function it(e){if(this.kernelFlags=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function b(e){if(this.ftraceEvents=[],this.atraceCategories=[],this.atraceApps=[],this.atraceCategoriesPreferSdk=[],this.syscallEvents=[],this.functionFilters=[],this.functionGraphRoots=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ot(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function st(e){if(this.rules=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function lt(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ct(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ut(e){if(this.counterIds=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function dt(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ft(e){if(this.scanMountPoints=[],this.mountPointMapping=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function pt(e){if(this.scanRoots=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ht(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function gt(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function mt(e){if(this.batteryCounters=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function _t(e){if(this.pushAtomId=[],this.rawPushAtomId=[],this.pullConfig=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function yt(e){if(this.pullAtomId=[],this.rawPullAtomId=[],this.packages=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function v(e){if(this.quirks=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function E(e){if(this.processCmdline=[],this.pid=[],this.targetInstalledBy=[],this.heaps=[],this.excludeHeaps=[],this.heapSamplingIntervals=[],this.skipSymbolPrefix=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Tt(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function S(e){if(this.processCmdline=[],this.pid=[],this.targetInstalledBy=[],this.ignoredTypes=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function bt(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function A(e){if(this.targetInstalledBy=[],this.targetPid=[],this.targetCmdline=[],this.excludePid=[],this.excludeCmdline=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function vt(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Et(e){if(this.targetPid=[],this.targetCmdline=[],this.excludePid=[],this.excludeCmdline=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function St(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function O(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function At(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Ot(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function C(e){if(this.meminfoCounters=[],this.vmstatCounters=[],this.statCounters=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Ct(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function k(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function w(e){if(this.disabledCategories=[],this.enabledCategories=[],this.disabledTags=[],this.enabledTags=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function kt(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function R(e){if(this.dataForTesting=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function wt(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Rt(e){if(this.methods=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function It(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Mt(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Pt(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Nt(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Dt(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function I(e){if(this.args=[],this.internedStrings=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function xt(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Lt(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Ft(e){if(this.msg=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function M(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Ut(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Bt(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function jt(e){if(this.columnNames=[],this.batch=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Ht(e){if(this.cells=[],this.varintCells=[],this.float64Cells=[],this.blobCells=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Gt(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Vt(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Wt(e){if(this.metricNames=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function qt(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function $t(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function zt(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Kt(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Yt(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Jt(e){if(this.descriptors=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Zt(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Qt(e){if(this.file=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function P(e){if(this.dependency=[],this.publicDependency=[],this.weakDependency=[],this.messageType=[],this.enumType=[],this.extension=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function N(e){if(this.field=[],this.extension=[],this.nestedType=[],this.enumType=[],this.oneofDecl=[],this.reservedRange=[],this.reservedName=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function Xt(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function D(e){if(this.name=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function er(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function tr(e){if(this.uninterpretedOption=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function x(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function rr(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function nr(e){if(this.value=[],this.reservedName=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ar(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}function ir(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}}function Aa(){if(!ba){ba=1,Object.defineProperty(Ea,"__esModule",{value:!0}),Ea.MetatraceTrackId=void 0,Ea.enableMetatracing=function(e){t=void 0===e||e===l.MetatraceCategories.NONE?l.MetatraceCategories.ALL:e},Ea.disableMetatracingAndGetTrace=function(){return t=void 0,function(){var e=[];for(const a of p)e.push((e=>{var t,r,n=l.PerfettoMetatrace.create({eventName:e.eventName,threadId:e.track,eventDurationNs:e.durNs});for([t,r]of Object.entries(e.args??{}))n.args.push(l.PerfettoMetatrace.Arg.create({key:t,value:r}));var a=c.default.Writer.create();return a.uint32(10),a.fork(),a.uint32(64).int64(e.startNs),a.uint32(464).int32(1),a.uint32(394).bytes(l.PerfettoMetatrace.encode(n).finish()),a.ldelim(),a.finish()})(a));var t=e.reduce((e,t)=>e+t.length,0),r=new Uint8Array(t);let n=0;for(const i of e)r.set(i,n),n+=i.length;return r}()},Ea.isMetatracingEnabled=a,Ea.getEnabledMetatracingCategories=function(){return t},Ea.traceEvent=function(e,t,r){e=o(e,r);try{return t()}finally{s(e)}},Ea.traceEventBegin=o,Ea.traceEventEnd=s,Ea.flattenArgs=function n(e,a=""){if("object"!=typeof e||null===e)return{[a]:String(e)};if(Array.isArray(e)){const i={};return e.forEach((e,t)=>{const r=a+`[${t}]`;Object.assign(i,n(e,r))}),i}const i={};Object.entries(e).forEach(([e,t])=>{const r=a?a+"."+e:e;Object.assign(i,n(t,r))});return i};var r,e=or,n=re();const l=Sa(),c=e.__importDefault(lr()),u=1e5,d=((e=r||(Ea.MetatraceTrackId=r={}))[e.kMainThread=2]="kMainThread",e[e.kOmniboxStatus=3]="kOmniboxStatus",n.featureFlags.register({id:"alwaysOnMetatracing",name:"Enable always-on-metatracing",description:"Enables trace events in the UI and trace processor",defaultValue:!1})),f=n.featureFlags.register({id:"alwaysOnMetatracing_detailed",name:"Detailed always-on-metatracing",description:"Enables recording additional events for trace event",defaultValue:!1});let t=function(){if(d.get())return f.get()?l.MetatraceCategories.ALL:l.MetatraceCategories.QUERY_TIMELINE|l.MetatraceCategories.API_TIMELINE}();const p=[],h=(new Date).getTime()-performance.now();function a(){return void 0!==t}function i(){return e=h+performance.now(),Math.round(1e6*e);var e}function o(e,t){return{eventName:e,startNs:i(),params:t}}function s(e){if(a())for(p.push({eventName:e.eventName,startNs:e.startNs,durNs:i()-e.startNs,track:e.params?.track??r.kMainThread,args:e.params?.args});p.length>u;)p.shift()}}return Ea}function ne(){if(!va){va=1,Object.defineProperty(Qr,"__esModule",{value:!0}),Qr.Actions=Qr.StateActions=void 0;const a=ee(),o=M(),s=En(),l=On(),c=ma(),u=Aa(),d=Y();let r;function n(e){var t=e.nextId,r=e.recordConfig,n=e.recordingTarget,a=e.fetchChromeCategories,i=e.extensionInstalled,o=e.availableAdbDevices,s=e.chromeCategories,l=e.newEngineMode;Object.assign(e,(0,c.createEmptyState)()),e.nextId=t,e.recordConfig=r,e.recordingTarget=n,e.fetchChromeCategories=a,e.extensionInstalled=i,e.availableAdbDevices=o,e.chromeCategories=s,e.newEngineMode=l}function i(e){var t=String(Number(e.nextId)+1);return e.nextId=t}Qr.StateActions={openTraceFromFile(e,t){n(e);var r=i(e);e.engine={id:r,ready:!1,source:{type:"FILE",file:t.file}}},openTraceFromBuffer(e,t){n(e);var r=i(e);e.engine={id:r,ready:!1,source:{type:"ARRAY_BUFFER",...t}}},openTraceFromUrl(e,t){n(e);var r=i(e);e.engine={id:r,ready:!1,source:{type:"URL",url:t.url}}},openTraceFromHttpRpc(e,t){n(e);var r=i(e);e.engine={id:r,ready:!1,source:{type:"HTTP_RPC"}}},setTraceUuid(e,t){e.traceUuid=t.traceUuid},addTracks(n,e){e.tracks.forEach(e=>{var t=void 0===e.key?i(n):e.key,r=e.name;n.tracks[t]={key:t,name:r,trackSortKey:e.trackSortKey,trackGroup:e.trackGroup,uri:e.uri,closeable:e.closeable},e.trackGroup===d.SCROLLING_TRACK_GROUP?n.scrollingTracks.push(t):void 0!==e.trackGroup&&void 0!==(r=n.trackGroups[e.trackGroup])&&r.tracks.push(t)})},removeTracks(e,t){for(const r of t.trackKeys)!function(e,r){var t,n=e.tracks[r];void 0!==n&&(delete e.tracks[r],t=e=>{var t=e.indexOf(r);-1!==t&&e.splice(t,1)},n.trackGroup===d.SCROLLING_TRACK_GROUP?t(e.scrollingTracks):void 0!==n.trackGroup&&void 0!==(n=e.trackGroups[n.trackGroup])&&t(n.tracks),e.pinnedTracks=e.pinnedTracks.filter(e=>e!==r))}(e,r)},setUtidToTrackSortKey(e,t){e.utidToThreadSortKey=t.threadOrderingMetadata},addTrack(e,t){this.addTracks(e,{tracks:[t]})},addTrackGroup(e,t){e.trackGroups[t.key]={name:t.name,key:t.key,collapsed:t.collapsed,tracks:[],summaryTrack:t.summaryTrackKey,fixedOrdering:t.fixedOrdering}},maybeExpandOnlyTrackGroup(e,t){e=Object.values(e.trackGroups);1===e.length&&(e[0].collapsed=!1)},sortThreadTracks(a,e){const i=e=>{var e=a.tracks[e],t=e.trackSortKey;return void 0===t.utid?[e.trackSortKey,0,0,0]:[(e=a.utidToThreadSortKey[t.utid])?e.sortKey:d.PrimaryTrackSortKey.ORDINARY_THREAD,e&&void 0!==e.tid?e.tid:Number.MAX_VALUE,t.utid,t.priority]},o=new Intl.Collator([],{sensitivity:"base",numeric:!0});for(const t of Object.values(a.trackGroups))t.fixedOrdering||t.tracks.sort((e,t)=>{var r=i(e),n=i(t);for(let e=0;e<r.length;e++)if(r[e]!==n[e])return r[e]-n[e];e=a.tracks[e].name.toLocaleLowerCase(),t=a.tracks[t].name.toLocaleLowerCase();return o.compare(e,t)})},updateAggregateSorting(e,t){let r=e.aggregatePreferences[t.id];r||(r={id:t.id},e.aggregatePreferences[t.id]=r),r.sorting&&r.sorting.column===t.column?"DESC"===r.sorting.direction?e.aggregatePreferences[t.id].sorting={column:t.column,direction:"ASC"}:e.aggregatePreferences[t.id].sorting=void 0:e.aggregatePreferences[t.id].sorting={column:t.column,direction:"DESC"}},moveTrack(e,a){var t=t=>{var r=[];for(let e=0;e<t.length;e++){var n=t[e];n===a.dstId&&"before"===a.op&&r.push(a.srcId),n!==a.srcId&&r.push(n),n===a.dstId&&"after"===a.op&&r.push(a.srcId)}t.splice(0),r.forEach(e=>{t.push(e)})};t(e.pinnedTracks),t(e.scrollingTracks)},toggleTrackPinned(e,t){var t=t.trackKey,r=e.pinnedTracks.includes(t),n=(0,a.assertExists)(e.tracks[t]).trackGroup;r?(e.pinnedTracks.splice(e.pinnedTracks.indexOf(t),1),n===d.SCROLLING_TRACK_GROUP&&e.scrollingTracks.unshift(t)):(n===d.SCROLLING_TRACK_GROUP&&e.scrollingTracks.splice(e.scrollingTracks.indexOf(t),1),e.pinnedTracks.push(t))},toggleTrackGroupCollapsed(e,t){e=(0,a.assertExists)(e.trackGroups[t.groupKey]);e.collapsed=!e.collapsed},requestTrackReload(e,t){e.lastTrackReloadRequest?e.lastTrackReloadRequest++:e.lastTrackReloadRequest=1},maybeSetPendingDeeplink(e,t){e.pendingDeeplink=t},clearPendingDeeplink(e,t){e.pendingDeeplink=void 0},setEngineReady(e,t){e=e.engine;void 0!==e&&e.id===t.engineId&&(e.ready=t.ready,e.mode=t.mode)},setNewEngineMode(e,t){e.newEngineMode=t.mode},setEngineFailed(e,t){void 0!==e.engine&&e.engine.mode===t.mode&&(e.engine.failed=t.failure)},updateStatus(e,t){r&&(0,u.traceEventEnd)(r),r=(0,u.traceEventBegin)(t.msg,{track:u.MetatraceTrackId.kOmniboxStatus}),e.status=t},setState(e,t){for(const r of Object.keys(e))delete e[r];for(const n of Object.keys(t.newState))e[n]=t.newState[n];void 0!==e.engine&&(e.engine.ready=!1)},setRecordConfig(e,t){e.recordConfig=t.config,e.lastLoadedConfig=t.configType||{type:"NONE"}},selectNote(e,t){e.selection={kind:"note",id:t.id}},addNote(e,t){var{timestamp:t,color:r,id:n=i(e),text:a=""}=t;e.notes[n]={noteType:"DEFAULT",id:n,timestamp:t,color:r,text:a}},addSpanNote(e,t){var{id:t=i(e),color:r=(0,o.randomColor)(),end:n,start:a}=t;e.notes[t]={noteType:"SPAN",start:a,end:n,color:r,id:t,text:""}},changeNoteColor(e,t){e=e.notes[t.id];void 0!==e&&(e.color=t.newColor)},changeNoteText(e,t){e=e.notes[t.id];void 0!==e&&(e.text=t.newText)},removeNote(e,t){delete e.notes[t.id],"note"===e.selection.kind&&e.selection.id===t.id&&(e.selection={kind:"empty"})},selectHeapProfile(e,t){e.selection={kind:"legacy",legacySelection:{kind:"HEAP_PROFILE",id:t.id,upid:t.upid,ts:t.ts,type:t.type}}},selectPerfSamples(e,t){e.selection={kind:"legacy",legacySelection:{kind:"PERF_SAMPLES",id:t.id,utid:t.utid,upid:t.upid,leftTs:t.leftTs,rightTs:t.rightTs,type:t.type}}},selectCpuProfileSample(e,t){e.selection={kind:"legacy",legacySelection:{kind:"CPU_PROFILE_SAMPLE",id:t.id,utid:t.utid,ts:t.ts}}},selectSlice(e,t){e.selection={kind:"legacy",legacySelection:{kind:"SLICE",id:t.id,trackKey:t.trackKey,table:t.table}},e.pendingScrollId=t.scroll?t.id:void 0},selectGenericSlice(e,t){var r={id:t.id,...t.detailsPanelConfig.config};e.selection={kind:"legacy",legacySelection:{kind:"GENERIC_SLICE",id:t.id,sqlTableName:t.sqlTableName,start:t.start,duration:t.duration,trackKey:t.trackKey,detailsPanelConfig:{kind:t.detailsPanelConfig.kind,config:r}}}},setPendingScrollId(e,t){e.pendingScrollId=t.pendingScrollId},clearPendingScrollId(e,t){e.pendingScrollId=void 0},selectThreadState(e,t){e.selection={kind:"legacy",legacySelection:{kind:"THREAD_STATE",id:t.id,trackKey:t.trackKey}}},startRecording(e,t){e.recordingInProgress=!0,e.lastRecordingError=void 0,e.recordingCancelled=!1},stopRecording(e,t){e.recordingInProgress=!1},cancelRecording(e,t){e.recordingInProgress=!1,e.recordingCancelled=!0},setExtensionAvailable(e,t){e.extensionInstalled=t.available},setRecordingTarget(e,t){e.recordingTarget=t.target},setFetchChromeCategories(e,t){e.fetchChromeCategories=t.fetch},setAvailableAdbDevices(e,t){e.availableAdbDevices=t.devices},setOmnibox(e,t){e.omniboxState=t},setOmniboxMode(e,t){e.omniboxState.mode=t.mode},selectArea(e,t){var{start:t,end:r,tracks:n}=t;(0,a.assertTrue)(t<=r),e.selection={kind:"area",start:t,end:r,tracks:n}},toggleTrackSelection(e,t){var r=e.selection;if("area"===r.kind){var n=r.tracks.indexOf(t.key);if(-1<n){if(r.tracks.splice(n,1),t.isTrackGroup)for(const i of e.trackGroups[t.key].tracks){var a=r.tracks.indexOf(i);-1<a&&r.tracks.splice(a,1)}}else if(r.tracks.push(t.key),t.isTrackGroup)for(const o of e.trackGroups[t.key].tracks)r.tracks.includes(o)||r.tracks.push(o);e.selection=Object.assign({},e.selection)}},setChromeCategories(e,t){e.chromeCategories=t.categories},setLastRecordingError(e,t){e.lastRecordingError=t.error,e.recordingStatus=void 0},setRecordingStatus(e,t){e.recordingStatus=t.status,e.lastRecordingError=void 0},togglePerfDebug(e,t){e.perfDebug=!e.perfDebug},setSidebar(e,t){e.sidebarVisible=t.visible},setHoveredUtidAndPid(e,t){e.hoveredPid=t.pid,e.hoveredUtid=t.utid},setHighlightedSliceId(e,t){e.highlightedSliceId=t.sliceId},setHighlightedFlowLeftId(e,t){e.focusedFlowIdLeft=t.flowId},setHighlightedFlowRightId(e,t){e.focusedFlowIdRight=t.flowId},setSearchIndex(e,t){e.searchIndex=t.index},setHoverCursorTimestamp(e,t){e.hoverCursorTimestamp=t.ts},setHoveredNoteTimestamp(e,t){e.hoveredNoteTimestamp=t.ts},showTab(e,t){"current_selection"===t.uri||e.tabs.openTabs.some(e=>e===t.uri)||e.tabs.openTabs.push(t.uri),e.tabs.currentTab=t.uri},hideTab(e,t){var r,e=e.tabs;t.uri===e.currentTab?(r=e.openTabs.findIndex(e=>e===t.uri),e.openTabs=e.openTabs.filter(e=>e!==t.uri),-1!==r&&(0===e.openTabs.length?e.currentTab="current_selection":r<e.openTabs.length-1?e.currentTab=e.openTabs[r]:(r=e.openTabs[e.openTabs.length-1],e.currentTab=r))):e.openTabs=e.openTabs.filter(e=>e!==t.uri)},clearAllPinnedTracks(t,e){var r=t.pinnedTracks.slice();for(let e=r.length-1;0<=e;e--){var n=r[e];this.toggleTrackPinned(t,{trackKey:n})}},togglePivotTable(e,t){e.nonSerializableState.pivotTable.selectionArea=t.area,e.nonSerializableState.pivotTable.queryResult=null},setPivotStateQueryResult(e,t){e.nonSerializableState.pivotTable.queryResult=t.queryResult},setPivotTableConstrainToArea(e,t){e.nonSerializableState.pivotTable.constrainToArea=t.constrain},dismissFlamegraphModal(e,t){e.flamegraphModalDismissed=!0},addPivotTableAggregation(e,t){e.nonSerializableState.pivotTable.selectedAggregations.splice(t.after,0,t.aggregation)},removePivotTableAggregation(e,t){e.nonSerializableState.pivotTable.selectedAggregations.splice(t.index,1)},setPivotTableQueryRequested(e,t){e.nonSerializableState.pivotTable.queryRequested=t.queryRequested},setPivotTablePivotSelected(e,t){(0,s.toggleEnabled)(s.tableColumnEquals,e.nonSerializableState.pivotTable.selectedPivots,t.column,t.selected)},setPivotTableAggregationFunction(e,t){e.nonSerializableState.pivotTable.selectedAggregations[t.index].aggregationFunction=t.function},setPivotTableSortColumn(e,r){e.nonSerializableState.pivotTable.selectedAggregations=e.nonSerializableState.pivotTable.selectedAggregations.map((e,t)=>({column:e.column,aggregationFunction:e.aggregationFunction,sortDirection:t===r.aggregationIndex?r.order:void 0}))},changePivotTablePivotOrder(e,t){var r=e.nonSerializableState.pivotTable.selectedPivots;e.nonSerializableState.pivotTable.selectedPivots=(0,l.performReordering)((0,l.computeIntervals)(r.length,t.from,t.to,t.direction),r)},changePivotTableAggregationOrder(e,t){var r=e.nonSerializableState.pivotTable.selectedAggregations;e.nonSerializableState.pivotTable.selectedAggregations=(0,l.performReordering)((0,l.computeIntervals)(r.length,t.from,t.to,t.direction),r)},setTrackFilterTerm(e,t){e.trackFilterTerm=t.filterTerm}},Qr.Actions=new Proxy({},{get(e,t,r){return e=>({type:t,args:e})}})}return Qr}var Oa,Ca,ka={},wa={};function Ra(){if(!Oa){Oa=1,Object.defineProperty(wa,"__esModule",{value:!0}),wa.FuzzyFinder=void 0,wa.fuzzyMatch=function(e,...t){for(const n of t){var r=new Array(n.length);if(s(n,e,r))return{matches:!0,segments:o(r,e)}}return{matches:!1,segments:[]}};function o(e,t){var r=[];let n=0,a="";for(const i of e)n<i&&(""!==a&&(r.push({matching:!0,value:a}),a=""),r.push({matching:!1,value:t.slice(n,i)})),a+=t[i],n=i+1;return""!==a&&r.push({matching:!0,value:a}),n<t.length&&r.push({matching:!1,value:t.slice(n)}),r}function s(t,r,n){let a=0,i=!0;for(let e=0;e<t.length;++e){for(var o=t[e].toLowerCase();a<r.length;++a)if(r[a].toLowerCase()===o){n[e]=a;break}if(a===r.length){i=!1;break}++a}return i}wa.FuzzyFinder=class{items;keyLookup;constructor(e,t){this.items=Array.from(e),this.keyLookup=t}find(...e){var t=[];for(const a of this.items){var r=this.keyLookup(a);for(const i of e){var n=new Array(i.length);if(s(i,r,n)){n=o(n,r);t.push({item:a,segments:n});break}}}return t}}}return wa}var Ia,Ma={};function Pa(){return Ia||(Ia=1,Object.defineProperty(Ma,"__esModule",{value:!0}),Ma.ConversionJobStatus=void 0,Ma.ConversionJobStatus={InProgress:"InProgress",NotRunning:"NotRunning"}),Ma}var Na,Da={};var xa,La={};function Fa(){if(!xa){xa=1,Object.defineProperty(La,"__esModule",{value:!0}),La.DurationPrecision=La.TimestampFormat=void 0,La.timestampFormat=function(){{var e;return void 0!==t?t:(e=localStorage.getItem(o),t=e&&(0,i.isEnumValue)(n,e)?e:s)}},La.setTimestampFormat=function(e){t=e,localStorage.setItem(o,e)},La.durationPrecision=function(){{var e;return void 0!==r?r:(e=localStorage.getItem(l),r=e&&(0,i.isEnumValue)(a,e)?e:c)}},La.setDurationPrecision=function(e){r=e,localStorage.setItem(l,e)};const i=te();var n,a,e;(e=n||(La.TimestampFormat=n={})).Timecode="timecode",e.Raw="raw",e.RawLocale="rawLocale",e.Seconds="seconds",e.UTC="utc",e.TraceTz="traceTz";let t;const o="timestampFormat",s=n.Timecode;(e=a||(La.DurationPrecision=a={})).Full="full",e.HumanReadable="human_readable";let r;const l="durationFormat",c=a.Full}return La}var Ua,Ba,ja,Ha={},Ga={},Va={};function Wa(){return Ua||(Ua=1,Object.defineProperty(Va,"__esModule",{value:!0}),Va.defer=function(){let r=null,n=null;var e=new Promise((e,t)=>[r,n]=[e,t]);return Object.assign(e,{resolve:r,reject:n})}),Va}function qa(){if(!Ba){Ba=1,Object.defineProperty(Ga,"__esModule",{value:!0}),Ga.AsyncLimiter=void 0;const r=Wa();Ga.AsyncLimiter=class{taskQueue=[];isRunning=!1;schedule(e){var t=(0,r.defer)();return this.taskQueue.push({work:e,deferred:t}),this.isRunning||(this.isRunning=!0,this.runTaskQueue().finally(()=>this.isRunning=!1)),t}async runTaskQueue(){for(var t;t=this.taskQueue.shift();)if(0<this.taskQueue.length)t.deferred.resolve();else try{await t.work(),t.deferred.resolve()}catch(e){t.deferred.reject(e)}}}}return Ga}function $a(){if(ja)return Ha;ja=1,Object.defineProperty(Ha,"__esModule",{value:!0}),Ha.TrackManager=void 0;const i=z();var e=Or(),t=qa();const r=ee();Ha.TrackManager=class{_trackKeyByTrackId=new Map;newTracks=new Map;currentTracks=new Map;trackRegistry=new e.Registry(({uri:e})=>e);defaultTracks=new Set;store;trackState;constructor(e){this.store=e}get trackKeyByTrackId(){return this.updateTrackKeyByTrackIdMap(),this._trackKeyByTrackId}registerTrack(e){return this.trackRegistry.register(e)}addPotentialTrack(e){return this.defaultTracks.add(e),{[Symbol.dispose]:()=>this.defaultTracks.delete(e)}}findPotentialTracks(){return Array.from(this.defaultTracks)}getAllTracks(){return Array.from(this.trackRegistry.values())}resolveTrackInfo(e){return this.trackRegistry.tryGet(e)}resolveTrack(e,t){var r,n=this.currentTracks.get(e);return n&&t.trackFactory===n.desc.trackFactory?(n.desc=t,this.newTracks.set(e,n),n):(r=t.trackFactory(n={trackKey:e}),r=new a(e,r,t,n),this.newTracks.set(e,r),r)}flushOldTracks(){for(var[e,t]of this.currentTracks.entries())this.newTracks.has(e)||t[Symbol.dispose]();this.currentTracks=this.newTracks,this.newTracks=new Map}updateTrackKeyByTrackIdMap(){if(this.trackState!==this.store.state.tracks){const a=new Map;Object.entries(this.store.state.tracks).forEach(([e,{uri:t}])=>{for(const n of this.trackRegistry.get(t)?.tags?.trackIds??[]){var r=a.get(n);if((0,i.exists)(r))throw new Error(`Trying to map track id ${n} to UI track ${e}, already mapped to `+r);a.set(n,e)}}),this._trackKeyByTrackId=a,this.trackState=this.store.state.tracks}}};class a{trackKey;track;desc;limiter=new t.AsyncLimiter;ctx;generator;error;isDisposed=!1;constructor(e,t,r,n){this.trackKey=e,this.track=t,this.desc=r,this.ctx=n,this.generator=async function*(e,t){try{var r=yield;for(await Promise.resolve(e.onCreate?.(t)),await Promise.resolve(e.onUpdate?.(r));;)await Promise.resolve(e.onUpdate?.(yield))}finally{await Promise.resolve(e.onDestroy?.())}}(this.track,this.ctx),this.generator.next()}render(e){(0,r.assertFalse)(this.isDisposed),this.limiter.schedule(async()=>{await this.generator.next(e)}).catch(e=>{this.error=e}),this.track.render(e)}[Symbol.dispose](){(0,r.assertFalse)(this.isDisposed),this.isDisposed=!0,this.generator.return()}getError(){return this.error}}return Ha}var za,Ka,Ya,Ja,Za,Qa,Xa,ei,ti,ri,ni,ai,ii,oi,si={};function li(){return Ka||(Ka=1,a.normalize=function(e){return Array.isArray(e)?a("[",void 0,void 0,a.normalizeChildren(e),void 0,void 0):null==e||"boolean"==typeof e?null:"object"==typeof e?e:a("#",void 0,void 0,String(e),void 0,void 0)},a.normalizeChildren=function(e){var t=[];if(e.length){for(var r=null!=e[0]&&null!=e[0].key,n=1;n<e.length;n++)if((null!=e[n]&&null!=e[n].key)!=r)throw new TypeError(!r||null==e[n]&&"boolean"!=typeof e[n]?"In fragments, vnodes must either all have keys or none have keys.":"In fragments, vnodes must either all have keys or none have keys. You may wish to consider using an explicit keyed empty fragment, m.fragment({key: ...}), instead of a hole.");for(n=0;n<e.length;n++)t[n]=a.normalize(e[n])}return t},za=a),za;function a(e,t,r,n,a,i){return{tag:e,key:t,attrs:r,children:n,text:a,dom:i,domSize:void 0,state:void 0,events:void 0,instance:void 0}}}function ci(){var n;return Ja||(Ja=1,n=li(),Ya=function(){var e,t=arguments[this],r=this+1;if(null==t?t={}:"object"==typeof t&&null==t.tag&&!Array.isArray(t)||(t={},r=this),arguments.length===r+1)e=arguments[r],Array.isArray(e)||(e=[e]);else for(e=[];r<arguments.length;)e.push(arguments[r++]);return n("",t.key,t,e)}),Ya}function ui(){return Qa||(Qa=1,Za={}.hasOwnProperty),Za}function di(){var s,l,c,u,d;return ei||(ei=1,s=li(),l=ci(),c=ui(),u=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,d={},Xa=function(e){if(null==e||"string"!=typeof e&&"function"!=typeof e&&"function"!=typeof e.view)throw Error("The selector must be either a string or a component.");var t=l.apply(1,arguments);if("string"!=typeof e||(t.children=s.normalizeChildren(t.children),"["===e))return t.tag=e,t;var r=d[e]||function(e){for(var t,r="div",n=[],a={};t=u.exec(e);){var i=t[1],o=t[2];""===i&&""!==o?r=o:"#"===i?a.id=o:"."===i?n.push(o):"["===t[3][0]&&(i=(i=t[6])&&i.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\"),"class"===t[4]?n.push(i):a[t[4]]=""===i?i:i||!0)}return 0<n.length&&(a.className=n.join(" ")),d[e]={tag:r,attrs:a}}(e),n=t,a=n.attrs,e=c.call(a,"class"),t=e?a.class:a.className;if(n.tag=r.tag,n.attrs={},!f(r.attrs)&&!f(a)){var i,o={};for(i in a)c.call(a,i)&&(o[i]=a[i]);a=o}for(i in r.attrs)c.call(r.attrs,i)&&"className"!==i&&!c.call(a,i)&&(a[i]=r.attrs[i]);for(i in null==t&&null==r.attrs.className||(a.className=null!=t?null!=r.attrs.className?String(r.attrs.className)+" "+String(t):t:null!=r.attrs.className?r.attrs.className:null),e&&(a.class=null),a)if(c.call(a,i)&&"key"!==i){n.attrs=a;break}return n}),Xa;function f(e){for(var t in e)if(c.call(e,t))return;return 1}}function fi(){var e,t,r,n;return oi||(oi=1,(e=di()).trust=(ri||(ri=1,t=li(),ti=function(e){return t("<",void 0,void 0,e=null==e?"":e,void 0,void 0)}),ti),e.fragment=(ai||(ai=1,r=li(),n=ci(),ni=function(){var e=n.apply(0,arguments);return e.tag="[",e.children=r.normalizeChildren(e.children),e}),ni),ii=e),ii}var pi,hi,gi,mi,_i,yi,Ti,bi,vi,Ei,Si,Ai,Oi,Ci,ki,wi,Ri,Ii,Mi,Pi,Ni,Di,xi,Li,Fi,Ui,Bi,ji,Hi,Gi,Vi,Wi,qi,$i,zi,Ki,Yi={exports:{}};function Ji(){var f;return hi||(hi=1,(f=function(e){if(!(this instanceof f))throw new Error("Promise must be called with 'new'.");if("function"!=typeof e)throw new TypeError("executor must be a function.");var i=this,o=[],s=[],a=t(o,!0),l=t(s,!1),c=i._instance={resolvers:o,rejectors:s},u="function"==typeof setImmediate?setImmediate:setTimeout;function t(n,a){return function t(r){var e;try{if(!a||null==r||"object"!=typeof r&&"function"!=typeof r||"function"!=typeof(e=r.then))u(function(){a||0!==n.length||console.error("Possible unhandled promise rejection:",r);for(var e=0;e<n.length;e++)n[e](r);o.length=0,s.length=0,c.state=a,c.retry=function(){t(r)}});else{if(r===i)throw new TypeError("Promise can't be resolved with itself.");d(e.bind(r))}}catch(e){l(e)}}}function d(e){var r=0;function t(t){return function(e){0<r++||t(e)}}var n=t(l);try{e(t(a),n)}catch(e){n(e)}}d(e)}).prototype.then=function(e,t){var a,i,o=this._instance;function r(t,e,r,n){e.push(function(e){if("function"!=typeof t)r(e);else try{a(t(e))}catch(e){i&&i(e)}}),"function"==typeof o.retry&&n===o.state&&o.retry()}var n=new f(function(e,t){a=e,i=t});return r(e,o.resolvers,a,!0),r(t,o.rejectors,i,!1),n},f.prototype.catch=function(e){return this.then(null,e)},f.prototype.finally=function(t){return this.then(function(e){return f.resolve(t()).then(function(){return e})},function(e){return f.resolve(t()).then(function(){return f.reject(e)})})},f.resolve=function(t){return t instanceof f?t:new f(function(e){e(t)})},f.reject=function(r){return new f(function(e,t){t(r)})},f.all=function(s){return new f(function(r,n){var a=s.length,i=0,o=[];if(0===s.length)r([]);else for(var e=0;e<s.length;e++)!function(t){function e(e){i++,o[t]=e,i===a&&r(o)}null==s[t]||"object"!=typeof s[t]&&"function"!=typeof s[t]||"function"!=typeof s[t].then?e(s[t]):s[t].then(e,n)}(e)})},f.race=function(n){return new f(function(e,t){for(var r=0;r<n.length;r++)n[r].then(e,t)})},pi=f),pi}function Zi(){var e;return gi||(gi=1,e=Ji(),"undefined"!=typeof window?(void 0===window.Promise?window.Promise=e:window.Promise.prototype.finally||(window.Promise.prototype.finally=e.prototype.finally),Yi.exports=window.Promise):void 0!==be?(void 0===be.Promise?be.Promise=e:be.Promise.prototype.finally||(be.Promise.prototype.finally=e.prototype.finally),Yi.exports=be.Promise):Yi.exports=e),Yi.exports}function Qi(){var ee;return _i||(_i=1,ee=li(),mi=function(e){var c,C=e&&e.document,t={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"};function U(e){return e.attrs&&e.attrs.xmlns||t[e.tag]}function u(e,t){if(e.state!==t)throw new Error("'vnode.state' must not be modified.")}function B(e){var t=e.state;try{return this.apply(t,arguments)}finally{u(e,t)}}function j(){try{return C.activeElement}catch(e){return null}}function k(e,t,r,n,a,i,o){for(var s=r;s<n;s++){var l=t[s];null!=l&&H(e,l,a,o,i)}}function H(e,t,r,n,a){var i,o,s,l,c=t.tag;if("string"==typeof c)switch(t.state={},null!=t.attrs&&N(t.attrs,t,r),c){case"#":u=e,f=a,(d=t).dom=C.createTextNode(d.children),M(u,d.dom,f);break;case"<":G(e,t,n,a);break;case"[":var u=e,d=t,f=r,p=n,h=a,g=C.createDocumentFragment();null!=d.children&&(m=d.children,k(g,m,0,m.length,f,null,p)),d.dom=g.firstChild,d.domSize=g.childNodes.length,M(u,g,h);break;default:var m=e,p=t,g=r,h=n,_=a,y=p.tag,T=p.attrs,b=T&&T.is,b=(h=U(p)||h)?b?C.createElementNS(h,y,{is:b}):C.createElementNS(h,y):b?C.createElement(y,{is:b}):C.createElement(y);if(p.dom=b,null!=T){var v=p;var E=T;var S=h;"input"===v.tag&&null!=E.type&&v.dom.setAttribute("type",E.type);var A,O=null!=E&&"input"===v.tag&&"file"===E.type;for(A in E)K(v,A,null,E[A],S,O)}if(M(m,b,_),!q(p))if(null!=p.children&&(y=p.children,k(b,y,0,y.length,g,null,h),"select"===p.tag)&&null!=T){_=p;b=T;"value"in b&&(null===b.value?-1!==_.dom.selectedIndex&&(_.dom.value=null):(y=""+b.value,_.dom.value===y&&-1!==_.dom.selectedIndex||(_.dom.value=y)));"selectedIndex"in b&&K(_,"selectedIndex",null,b.selectedIndex,void 0)}return}else c=e,s=n,l=a,function(e,t){var r;if("function"==typeof e.tag.view){if(e.state=Object.create(e.tag),null!=(r=e.state.view).$$reentrantLock$$)return;r.$$reentrantLock$$=!0}else{if(e.state=void 0,null!=(r=e.tag).$$reentrantLock$$)return;r.$$reentrantLock$$=!0,e.state=null!=e.tag.prototype&&"function"==typeof e.tag.prototype.view?new e.tag(e):e.tag(e)}N(e.state,e,t),null!=e.attrs&&N(e.attrs,e,t);if(e.instance=ee.normalize(B.call(e.state.view,e)),e.instance===e)throw Error("A view cannot return the vnode it received as argument");r.$$reentrantLock$$=null}(i=t,o=r),null!=i.instance?(H(c,i.instance,o,s,l),i.dom=i.instance.dom,i.domSize=null!=i.dom?i.instance.domSize:0):i.domSize=0}var l={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"};function G(e,t,r,n){for(var a,i=t.children.match(/^\s*?<(\w+)/im)||[],o=C.createElement(l[i[1]]||"div"),s=("http://www.w3.org/2000/svg"===r?(o.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+t.children+"</svg>",o=o.firstChild):o.innerHTML=t.children,t.dom=o.firstChild,t.domSize=o.childNodes.length,t.instance=[],C.createDocumentFragment());a=o.firstChild;)t.instance.push(a),s.appendChild(a);M(e,s,n)}function V(e,t,r,n,a,i){if(t!==r&&(null!=t||null!=r))if(null==t||0===t.length)k(e,r,0,r.length,n,a,i);else if(null==r||0===r.length)P(e,t,0,t.length);else{var o=null!=t[0]&&null!=t[0].key,s=null!=r[0]&&null!=r[0].key,l=0,c=0;if(!o)for(;c<t.length&&null==t[c];)c++;if(!s)for(;l<r.length&&null==r[l];)l++;if(o!=s)P(e,t,c,t.length),k(e,r,l,r.length,n,a,i);else if(s){for(var u,d,f,p,h=t.length-1,g=r.length-1;c<=h&&l<=g&&(f=t[h],A=r[g],f.key===A.key);)f!==A&&W(e,f,A,n,a,i),null!=A.dom&&(a=A.dom),h--,g--;for(;c<=h&&l<=g&&(u=t[c],d=r[l],u.key===d.key);)c++,l++,u!==d&&W(e,u,d,n,R(t,c,a),i);for(;c<=h&&l<=g&&l!==g&&u.key===A.key&&f.key===d.key;)I(e,f,p=R(t,c,a)),f!==d&&W(e,f,d,n,p,i),++l<=--g&&I(e,u,a),u!==A&&W(e,u,A,n,a,i),null!=A.dom&&(a=A.dom),f=t[--h],A=r[g],u=t[++c],d=r[l];for(;c<=h&&l<=g&&f.key===A.key;)f!==A&&W(e,f,A,n,a,i),null!=A.dom&&(a=A.dom),f=t[--h],A=r[--g];if(g<l)P(e,t,c,h+1);else if(h<c)k(e,r,l,g+1,n,a,i);else{for(var m,_,o=a,y=g-l+1,T=new Array(y),b=0,v=0,E=2147483647,S=0,v=0;v<y;v++)T[v]=-1;for(v=g;l<=v;v--){var A,O=(m=null==m?function(e,t,r){for(var n=Object.create(null);t<r;t++){var a=e[t];null!=a&&null!=(a=a.key)&&(n[a]=t)}return n}(t,c,h+1):m)[(A=r[v]).key];null!=O&&(E=O<E?O:-1,f=t[T[v-l]=O],t[O]=null,f!==A&&W(e,f,A,n,a,i),null!=A.dom&&(a=A.dom),S++)}if(a=o,S!==h-c+1&&P(e,t,c,h+1),0===S)k(e,r,l,g+1,n,a,i);else if(-1===E)for(b=(_=function(e){for(var t=[0],r=0,n=0,a=0,i=w.length=e.length,a=0;a<i;a++)w[a]=e[a];for(a=0;a<i;++a)if(-1!==e[a]){var o=t[t.length-1];if(e[o]<e[a])w[a]=o,t.push(a);else{for(r=0,n=t.length-1;r<n;){var s=(r>>>1)+(n>>>1)+(r&n&1);e[t[s]]<e[a]?r=1+s:n=s}e[a]<e[t[r]]&&(0<r&&(w[a]=t[r-1]),t[r]=a)}}r=t.length,n=t[r-1];for(;0<r--;)t[r]=n,n=w[n];return w.length=0,t}(T)).length-1,v=g;l<=v;v--)d=r[v],-1===T[v-l]?H(e,d,n,i,a):_[b]===v-l?b--:I(e,d,a),null!=d.dom&&(a=r[v].dom);else for(v=g;l<=v;v--)d=r[v],-1===T[v-l]&&H(e,d,n,i,a),null!=d.dom&&(a=r[v].dom)}}else{for(var C=(t.length<r.length?t:r).length,l=l<c?l:c;l<C;l++)(u=t[l])===(d=r[l])||null==u&&null==d||(null==u?H(e,d,n,i,R(t,l+1,a)):null==d?$(e,u):W(e,u,d,n,R(t,l+1,a),i));t.length>C&&P(e,t,l,t.length),r.length>C&&k(e,r,l,r.length,n,a,i)}}}function W(e,t,r,n,a,i){var o=t.tag;if(o===r.tag){if(r.state=t.state,r.events=t.events,!function(e,t){do{var r;if(null!=e.attrs&&"function"==typeof e.attrs.onbeforeupdate)if(void 0!==(r=B.call(e.attrs.onbeforeupdate,e,t))&&!r)break;if("string"!=typeof e.tag&&"function"==typeof e.state.onbeforeupdate)if(void 0!==(r=B.call(e.state.onbeforeupdate,e,t))&&!r)break;return}while(0);return e.dom=t.dom,e.domSize=t.domSize,e.instance=t.instance,e.attrs=t.attrs,e.children=t.children,e.text=t.text,1}(r,t))if("string"==typeof o)switch(null!=r.attrs&&X(r.attrs,r,n),o){case"#":var s=t,l=r;s.children.toString()!==l.children.toString()&&(s.dom.nodeValue=l.children),l.dom=s.dom;break;case"<":l=e,s=r,u=i,d=a,(f=t).children!==s.children?(z(l,f),G(l,s,u,d)):(s.dom=f.dom,s.domSize=f.domSize,s.instance=f.instance);break;case"[":var c=r,u=n,d=a,f=i,p=(V(e,t.children,c.children,u,d,f),0),h=c.children;if((c.dom=null)!=h){for(var g=0;g<h.length;g++){var m=h[g];null!=m&&null!=m.dom&&(null==c.dom&&(c.dom=m.dom),p+=m.domSize||1)}1!==p&&(c.domSize=p)}break;default:var _,y=t,T=r,b=n,v=i,L=T.dom=y.dom,E=(v=U(T)||v,"textarea"!==T.tag||null==T.attrs&&(T.attrs={}),T),S=y.attrs,A=T.attrs,O=v;if(S&&S===A&&console.warn("Don't reuse attrs object, use new object for every redraw, this will throw in next major"),null!=A){"input"===E.tag&&null!=A.type&&E.dom.setAttribute("type",A.type);var F="input"===E.tag&&"file"===A.type;for(C in A)K(E,C,S&&S[C],A[C],O,F)}if(null!=S)for(var C in S)if(null!=(_=S[C])&&(null==A||null==A[C])){k=void 0;w=void 0;R=void 0;I=void 0;var k=E;var w=C;var R=_;var I=O;"key"===w||"is"===w||null==R||Y(w)||("o"===w[0]&&"n"===w[1]?Q(k,w,void 0):"style"===w?Z(k.dom,R,null):!J(k,w,I)||"className"===w||"title"===w||"value"===w&&("option"===k.tag||"select"===k.tag&&-1===k.dom.selectedIndex&&k.dom===j())||"input"===k.tag&&"type"===w?(-1!==(I=w.indexOf(":"))&&(w=w.slice(I+1)),!1!==R&&k.dom.removeAttribute("className"===w?"class":w)):k.dom[w]=null)}return void(q(T)||V(L,y.children,T.children,b,null,v))}else{var o=e,M=t,P=r,N=n,D=a,x=i;if(P.instance=ee.normalize(B.call(P.state.view,P)),P.instance===P)throw Error("A view cannot return the vnode it received as argument");X(P.state,P,N),null!=P.attrs&&X(P.attrs,P,N),null!=P.instance?(null==M.instance?H(o,P.instance,N,x,D):W(o,M.instance,P.instance,N,D,x),P.dom=P.instance.dom,P.domSize=P.instance.domSize):null!=M.instance?($(o,M.instance),P.dom=void 0,P.domSize=0):(P.dom=M.dom,P.domSize=M.domSize)}}else $(e,t),H(e,r,n,i,a)}var w=[];function R(e,t,r){for(;t<e.length;t++)if(null!=e[t]&&null!=e[t].dom)return e[t].dom;return r}function I(e,t,r){var n=C.createDocumentFragment();!function e(t,r,n){for(;null!=n.dom&&n.dom.parentNode===t;){if("string"!=typeof n.tag){if(null!=(n=n.instance))continue}else if("<"===n.tag)for(var a=0;a<n.instance.length;a++)r.appendChild(n.instance[a]);else if("["!==n.tag)r.appendChild(n.dom);else if(1===n.children.length){if(null!=(n=n.children[0]))continue}else for(a=0;a<n.children.length;a++){var i=n.children[a];null!=i&&e(t,r,i)}break}}(e,n,t),M(e,n,r)}function M(e,t,r){null!=r?e.insertBefore(t,r):e.appendChild(t)}function q(e){if(null!=e.attrs&&(null!=e.attrs.contenteditable||null!=e.attrs.contentEditable)){var t=e.children;if(null!=t&&1===t.length&&"<"===t[0].tag){var r=t[0].children;e.dom.innerHTML!==r&&(e.dom.innerHTML=r)}else if(null!=t&&0!==t.length)throw new Error("Child node of a contenteditable must be trusted.");return 1}}function P(e,t,r,n){for(var a=r;a<n;a++){var i=t[a];null!=i&&$(e,i)}}function $(e,t){var r,n,a,i,o=0,s=t.state;function l(){u(t,s),f(t),d(e,t)}"string"!=typeof t.tag&&"function"==typeof t.state.onbeforeremove&&null!=(a=B.call(t.state.onbeforeremove,t))&&"function"==typeof a.then&&(o=1,r=a),t.attrs&&"function"==typeof t.attrs.onbeforeremove&&null!=(a=B.call(t.attrs.onbeforeremove,t))&&"function"==typeof a.then&&(o|=2,n=a),u(t,s),o?(null!=r&&r.then(i=function(){1&o&&((o&=2)||l())},i),null!=n&&n.then(i=function(){2&o&&((o&=1)||l())},i)):(f(t),d(e,t))}function z(e,t){for(var r=0;r<t.instance.length;r++)e.removeChild(t.instance[r])}function d(e,t){for(;null!=t.dom&&t.dom.parentNode===e;){if("string"!=typeof t.tag){if(null!=(t=t.instance))continue}else if("<"===t.tag)z(e,t);else{if("["!==t.tag&&(e.removeChild(t.dom),!Array.isArray(t.children)))break;if(1===t.children.length){if(null!=(t=t.children[0]))continue}else for(var r=0;r<t.children.length;r++){var n=t.children[r];null!=n&&d(e,n)}}break}}function f(e){if("string"!=typeof e.tag&&"function"==typeof e.state.onremove&&B.call(e.state.onremove,e),e.attrs&&"function"==typeof e.attrs.onremove&&B.call(e.attrs.onremove,e),"string"!=typeof e.tag)null!=e.instance&&f(e.instance);else{var t=e.children;if(Array.isArray(t))for(var r=0;r<t.length;r++){var n=t[r];null!=n&&f(n)}}}function K(e,t,r,n,a,i){if("key"!==t&&"is"!==t&&null!=n&&!Y(t)&&(r!==n||(o=e,"value"===(s=t))||"checked"===s||"selectedIndex"===s||"selected"===s&&o.dom===j()||"option"===o.tag&&o.dom.parentNode===C.activeElement||"object"==typeof n)&&("type"!==t||"input"!==e.tag)){var o,s;if("o"===t[0]&&"n"===t[1])return Q(e,t,n);if("xlink:"===t.slice(0,6))e.dom.setAttributeNS("http://www.w3.org/1999/xlink",t.slice(6),n);else if("style"===t)Z(e.dom,r,n);else if(J(e,t,a)){if("value"===t){if(("input"===e.tag||"textarea"===e.tag)&&e.dom.value===""+n&&(i||e.dom===j()))return;if("select"===e.tag&&null!==r&&e.dom.value===""+n)return;if("option"===e.tag&&null!==r&&e.dom.value===""+n)return;if(i&&""+n!="")return void console.error("`value` is read-only on file inputs!")}e.dom[t]=n}else"boolean"==typeof n?n?e.dom.setAttribute(t,""):e.dom.removeAttribute(t):e.dom.setAttribute("className"===t?"class":t,n)}}function Y(e){return"oninit"===e||"oncreate"===e||"onupdate"===e||"onremove"===e||"onbeforeremove"===e||"onbeforeupdate"===e}function J(e,t,r){return void 0===r&&(-1<e.tag.indexOf("-")||null!=e.attrs&&e.attrs.is||"href"!==t&&"list"!==t&&"form"!==t&&"width"!==t&&"height"!==t)&&t in e.dom}var p,r=/[A-Z]/g;function n(e){return"-"+e.toLowerCase()}function i(e){return"-"===e[0]&&"-"===e[1]?e:"cssFloat"===e?"float":e.replace(r,n)}function Z(e,t,r){if(t!==r)if(null==r)e.style.cssText="";else if("object"!=typeof r)e.style.cssText=r;else if(null==t||"object"!=typeof t)for(var n in e.style.cssText="",r)null!=(a=r[n])&&e.style.setProperty(i(n),String(a));else{for(var n in r){var a;null!=(a=r[n])&&(a=String(a))!==String(t[n])&&e.style.setProperty(i(n),a)}for(var n in t)null!=t[n]&&null==r[n]&&e.style.removeProperty(i(n))}}function a(){this._=c}function Q(e,t,r){null!=e.events?(e.events._=c,e.events[t]!==r&&(null==r||"function"!=typeof r&&"object"!=typeof r?(null!=e.events[t]&&e.dom.removeEventListener(t.slice(2),e.events,!1),e.events[t]=void 0):(null==e.events[t]&&e.dom.addEventListener(t.slice(2),e.events,!1),e.events[t]=r))):null==r||"function"!=typeof r&&"object"!=typeof r||(e.events=new a,e.dom.addEventListener(t.slice(2),e.events,!1),e.events[t]=r)}function N(e,t,r){"function"==typeof e.oninit&&B.call(e.oninit,t),"function"==typeof e.oncreate&&r.push(B.bind(e.oncreate,t))}function X(e,t,r){"function"==typeof e.onupdate&&r.push(B.bind(e.onupdate,t))}return(a.prototype=Object.create(null)).handleEvent=function(e){var t,r=this["on"+e.type];"function"==typeof r?t=r.call(e.currentTarget,e):"function"==typeof r.handleEvent&&r.handleEvent(e),this._&&!1!==e.redraw&&(0,this._)(),!1===t&&(e.preventDefault(),e.stopPropagation())},function(e,t,r){if(!e)throw new TypeError("DOM element being rendered to does not exist.");if(null!=p&&e.contains(p))throw new TypeError("Node is currently being rendered to and thus is locked.");var n=c,a=p,i=[],o=j(),s=e.namespaceURI;p=e,c="function"==typeof r?r:void 0;try{null==e.vnodes&&(e.textContent=""),t=ee.normalizeChildren(Array.isArray(t)?t:[t]),V(e,e.vnodes,t,i,null,"http://www.w3.org/1999/xhtml"===s?void 0:s),e.vnodes=t,null!=o&&j()!==o&&"function"==typeof o.focus&&o.focus();for(var l=0;l<i.length;l++)i[l]()}finally{c=n,p=a}}}),mi}function Xi(){return Ti||(Ti=1,yi=Qi()("undefined"!=typeof window?window:null)),yi}function eo(){var l;return vi||(vi=1,l=li(),bi=function(n,e,t){var a=[],r=!1,i=-1;function o(){for(i=0;i<a.length;i+=2)try{n(a[i],l(a[i+1]),s)}catch(e){t.error(e)}i=-1}function s(){r||(r=!0,e(function(){r=!1,o()}))}return s.sync=o,{mount:function(e,t){if(null!=t&&null==t.view&&"function"!=typeof t)throw new TypeError("m.mount expects a component, not a vnode.");var r=a.indexOf(e);0<=r&&(a.splice(r,2),r<=i&&(i-=2),n(e,[])),null!=t&&(a.push(e,t),n(e,l(t),s))},redraw:s}}),bi}function to(){var e;return Si||(Si=1,e=Xi(),Ei=eo()(e,"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:null,"undefined"!=typeof console?console:null)),Ei}function ro(){return Oi||(Oi=1,Ai=function(e){if("[object Object]"!==Object.prototype.toString.call(e))return"";var t,a=[];for(t in e)!function e(t,r){if(Array.isArray(r))for(var n=0;n<r.length;n++)e(t+"["+n+"]",r[n]);else if("[object Object]"===Object.prototype.toString.call(r))for(var n in r)e(t+"["+n+"]",r[n]);else a.push(encodeURIComponent(t)+(null!=r&&""!==r?"="+encodeURIComponent(r):""))}(t,e[t]);return a.join("&")}),Ai}function no(){var n;return ki||(ki=1,n=ui(),Ci=Object.assign||function(e,t){for(var r in t)n.call(t,r)&&(e[r]=t[r])}),Ci}function ao(){var d,f;return Ri||(Ri=1,d=ro(),f=no(),wi=function(e,n){if(/:([^\/\.-]+)(\.{3})?:/.test(e))throw new SyntaxError("Template parameter names must be separated by either a '/', '-', or '.'.");var t,r,a,i,o,s,l,c,u;return null==n?e:(t=e.indexOf("?"),u=(r=e.indexOf("#"))<0?e.length:r,i=e.slice(0,t<0?u:t),f(a={},n),o=(i=i.replace(/:([^\/\.-]+)(\.{3})?/g,function(e,t,r){return delete a[t],null==n[t]?e:r?n[t]:encodeURIComponent(String(n[t]))})).indexOf("?"),l=(s=i.indexOf("#"))<0?i.length:s,c=i.slice(0,o<0?l:o),0<=t&&(c+=e.slice(t,u)),0<=o&&(c+=(t<0?"?":"&")+i.slice(o,l)),(u=d(a))&&(c+=(t<0&&o<0?"?":"&")+u),0<=r&&(c+=e.slice(r)),0<=s&&(c+=(r<0?"":"&")+i.slice(s)),c)}),wi}function io(){var c,_;return Mi||(Mi=1,c=ao(),_=ui(),Ii=function(g,r,s){var o=0;function l(e){return new r(e)}function e(o){return function(t,n){"string"!=typeof t?t=(n=t).url:null==n&&(n={});var a,e=new r(function(r,e){o(c(t,n.params),n,function(e){if("function"==typeof n.type)if(Array.isArray(e))for(var t=0;t<e.length;t++)e[t]=new n.type(e[t]);else e=new n.type(e);r(e)},e)});return!0===n.background?e:(a=0,function t(r){var n=r.then;r.constructor=l;r.then=function(){a++;var e=n.apply(r,arguments);return e.then(i,function(e){if(i(),0===a)throw e}),t(e)};return r}(e));function i(){0==--a&&"function"==typeof s&&s()}}}function m(e,t){for(var r in e.headers)if(_.call(e.headers,r)&&r.toLowerCase()===t)return 1}return l.prototype=r.prototype,l.__proto__=r,{request:e(function(i,o,s,l){var e,t,r=null!=o.method?o.method.toUpperCase():"GET",n=o.body,a=(null==o.serialize||o.serialize===JSON.serialize)&&!(n instanceof g.FormData||n instanceof g.URLSearchParams),c=o.responseType||("function"==typeof o.extract?"":"json"),u=new g.XMLHttpRequest,d=!1,f=!1,p=u,h=u.abort;for(t in u.abort=function(){d=!0,h.call(this)},u.open(r,i,!1!==o.async,"string"==typeof o.user?o.user:void 0,"string"==typeof o.password?o.password:void 0),a&&null!=n&&!m(o,"content-type")&&u.setRequestHeader("Content-Type","application/json; charset=utf-8"),"function"==typeof o.deserialize||m(o,"accept")||u.setRequestHeader("Accept","application/json, text/*"),o.withCredentials&&(u.withCredentials=o.withCredentials),o.timeout&&(u.timeout=o.timeout),u.responseType=c,o.headers)_.call(o.headers,t)&&u.setRequestHeader(t,o.headers[t]);u.onreadystatechange=function(t){if(!d&&4===t.target.readyState)try{var r,e,n=200<=t.target.status&&t.target.status<300||304===t.target.status||/^file:\/\//i.test(i),a=t.target.response;if("json"===c){if(!t.target.responseType&&"function"!=typeof o.extract)try{a=JSON.parse(t.target.responseText)}catch(e){a=null}}else c&&"text"!==c||null==a&&(a=t.target.responseText);"function"==typeof o.extract?(a=o.extract(t.target,o),n=!0):"function"==typeof o.deserialize&&(a=o.deserialize(a)),n?s(a):(e=function(){try{r=t.target.responseText}catch(e){r=a}var e=new Error(r);e.code=t.target.status,e.response=a,l(e)},0===u.status?setTimeout(function(){f||e()}):e())}catch(e){l(e)}},u.ontimeout=function(e){f=!0;var t=new Error("Request timed out");t.code=e.target.status,l(t)},"function"==typeof o.config&&(u=o.config(u,o,i)||u)!==p&&(e=u.abort,u.abort=function(){d=!0,e.call(this)}),null==n?u.send():"function"==typeof o.serialize?u.send(o.serialize(n)):n instanceof g.FormData||n instanceof g.URLSearchParams?u.send(n):u.send(JSON.stringify(n))}),jsonp:e(function(e,t,r,n){var a=t.callbackName||"_mithril_"+Math.round(1e16*Math.random())+"_"+o++,i=g.document.createElement("script");g[a]=function(e){delete g[a],i.parentNode.removeChild(i),r(e)},i.onerror=function(){delete g[a],i.parentNode.removeChild(i),n(new Error("JSONP request failed"))},i.src=e+(e.indexOf("?")<0?"?":"&")+encodeURIComponent(t.callbackKey||"callback")+"="+encodeURIComponent(a),g.document.documentElement.appendChild(i)})}}),Ii}function oo(){return xi||(xi=1,Di=function(e){if(""===e||null==e)return{};for(var t=(e="?"===e.charAt(0)?e.slice(1):e).split("&"),r={},n={},a=0;a<t.length;a++){var i=t[a].split("="),o=h(i[0]),s=2===i.length?h(i[1]):"",l=("true"===s?s=!0:"false"===s&&(s=!1),o.split(/\]\[?|\[/)),c=n;-1<o.indexOf("[")&&l.pop();for(var u=0;u<l.length;u++){var d,f=l[u],p=l[u+1],p=""==p||!isNaN(parseInt(p,10));if(""===f)null==r[o=l.slice(0,u).join()]&&(r[o]=Array.isArray(c)?c.length:0),f=r[o]++;else if("__proto__"===f)break;u===l.length-1?c[f]=s:(null==(d=null!=(d=Object.getOwnPropertyDescriptor(c,f))?d.value:d)&&(c[f]=d=p?[]:{}),c=d)}}return n}),Di;function h(t){try{return decodeURIComponent(t)}catch(e){return t}}}function so(){var a;return Fi||(Fi=1,a=oo(),Li=function(e){var t=e.indexOf("?"),r=e.indexOf("#"),r=r<0?e.length:r,n=e.slice(0,t<0?r:t).replace(/\/{2,}/g,"/");return n?1<(n="/"!==n[0]?"/"+n:n).length&&"/"===n[n.length-1]&&(n=n.slice(0,-1)):n="/",{path:n,params:t<0?{}:a(e.slice(t+1,r))}}),Li}function lo(){var a,i;return Hi||(Hi=1,a=ui(),i=new RegExp("^(?:key|oninit|oncreate|onbeforeupdate|onupdate|onbeforeremove|onremove)$"),ji=function(e,t){var r={};if(null!=t)for(var n in e)a.call(e,n)&&!i.test(n)&&t.indexOf(n)<0&&(r[n]=e[n]);else for(var n in e)a.call(e,n)&&!i.test(n)&&(r[n]=e[n]);return r}),ji}function co(){var r,E,n,S,A,O,t,C,k,w;return Vi||(Vi=1,r=li(),E=di(),n=Zi(),S=ao(),A=so(),Bi||(Bi=1,t=so(),Ui=function(e){var n=t(e),a=Object.keys(n.params),i=[],o=new RegExp("^"+n.path.replace(/:([^\/.-]+)(\.{3}|\.(?!\.)|-)?|[\\^$*+.()|\[\]{}]/g,function(e,t,r){return null==t?"\\"+e:(i.push({k:t,r:"..."===r}),"..."===r?"(.*)":"."===r?"([^/]+)\\.":"([^/]+)"+(r||""))})+"$");return function(e){for(var t=0;t<a.length;t++)if(n.params[a[t]]!==e.params[a[t]])return!1;if(!i.length)return o.test(e.path);var r=o.exec(e.path);if(null==r)return!1;for(t=0;t<i.length;t++)e.params[i[t].k]=i[t].r?r[t+1]:decodeURIComponent(r[t+1]);return!0}}),O=Ui,C=no(),k=lo(),w={},Gi=function(a,c){var u,d,f,p,h,g,e=null==a?null:"function"==typeof a.setImmediate?a.setImmediate:a.setTimeout,m=n.resolve(),t=!1,i=!1,_=0,y=w,o={onbeforeupdate:function(){return!(!(_=_?2:1)||w===y)},onremove:function(){a.removeEventListener("popstate",l,!1),a.removeEventListener("hashchange",s,!1)},view:function(){var e;if(_&&w!==y)return e=[r(f,p.key,p)],y?y.render(e[0]):e}},T=v.SKIP={};function s(){t=!1;var e=a.location.hash,o=(e="#"!==v.prefix[0]&&(e=a.location.search+e,"?"!==v.prefix[0])&&"/"!==(e=a.location.pathname+e)[0]?"/"+e:e).concat().replace(/(?:%[a-f89][a-f0-9])+/gim,R).slice(v.prefix.length),s=A(o);function l(e){console.error(e),b(d,null,{replace:!0})}C(s.params,a.history.state),function t(r){for(;r<u.length;r++){var n,e,a,i;if(u[r].check(s))return n=u[r].component,e=u[r].route,i=g=function(e){if(i===g){if(e===T)return t(r+1);f=null==e||"function"!=typeof e.view&&"function"!=typeof e?"div":e,p=s.params,h=o,g=null,y=n.render?n:null,2===_?c.redraw():(_=2,c.redraw.sync())}},void((a=n).view||"function"==typeof n?(n={},i(a)):n.onmatch?m.then(function(){return n.onmatch(s.params,o,e)}).then(i,o===d?null:l):i("div"))}if(o===d)throw new Error("Could not resolve default route "+d+".");b(d,null,{replace:!0})}(0)}function l(){t||(t=!0,e(s))}function b(e,t,r){var n;e=S(e,t),i?(l(),t=r?r.state:null,n=r?r.title:null,r&&r.replace?a.history.replaceState(t,n,v.prefix+e):a.history.pushState(t,n,v.prefix+e)):a.location.href=v.prefix+e}function v(e,t,r){if(!e)throw new TypeError("DOM element being rendered to does not exist.");if(u=Object.keys(r).map(function(e){if("/"!==e[0])throw new SyntaxError("Routes must start with a '/'.");if(/:([^\/\.-]+)(\.{3})?:/.test(e))throw new SyntaxError("Route parameter names must be separated with either '/', '.', or '-'.");return{route:e,component:r[e],check:O(e)}}),null!=(d=t)){var n=A(t);if(!u.some(function(e){return e.check(n)}))throw new ReferenceError("Default route doesn't match any known routes.")}"function"==typeof a.history.pushState?a.addEventListener("popstate",l,!1):"#"===v.prefix[0]&&a.addEventListener("hashchange",s,!1),i=!0,c.mount(e,o),s()}return v.set=function(e,t,r){null!=g&&((r=r||{}).replace=!0),g=null,b(e,t,r)},v.get=function(){return h},v.prefix="#!",v.Link={view:function(e){var r,n,a,t=E(e.attrs.selector||"a",k(e.attrs,["options","params","selector","onclick"]),e.children);return(t.attrs.disabled=Boolean(t.attrs.disabled))?(t.attrs.href=null,t.attrs["aria-disabled"]="true"):(r=e.attrs.options,n=e.attrs.onclick,a=S(t.attrs.href,e.attrs.params),t.attrs.href=v.prefix+a,t.attrs.onclick=function(e){var t;"function"==typeof n?t=n.call(e.currentTarget,e):null!=n&&"object"==typeof n&&"function"==typeof n.handleEvent&&n.handleEvent(e),!1===t||e.defaultPrevented||0!==e.button&&0!==e.which&&1!==e.which||e.currentTarget.target&&"_self"!==e.currentTarget.target||e.ctrlKey||e.metaKey||e.shiftKey||e.altKey||(e.preventDefault(),e.redraw=!1,v.set(a,null,r))}),t}},v.param=function(e){return p&&null!=e?p[e]:p},v}),Gi;function R(t){try{return decodeURIComponent(t)}catch(e){return t}}}function ae(){var e,t,r,n,a;return zi||(zi=1,e=fi(),Ni||(Ni=1,t=Zi(),r=to(),Pi=io()("undefined"!=typeof window?window:null,t,r.redraw)),t=Pi,r=to(),(n=function(){return e.apply(this,arguments)}).m=e,n.trust=e.trust,n.fragment=e.fragment,n.Fragment="[",n.mount=r.mount,n.route=(qi||(qi=1,a=to(),Wi=co()("undefined"!=typeof window?window:null,a)),Wi),n.render=Xi(),n.redraw=r.redraw,n.request=t.request,n.jsonp=t.jsonp,n.parseQueryString=oo(),n.buildQueryString=ro(),n.parsePathname=so(),n.buildPathname=ao(),n.vnode=li(),n.PromisePolyfill=Ji(),n.censor=lo(),$i=n),$i}function uo(){if(!Ki){Ki=1;{var r=si;Object.defineProperty(r,"__esModule",{value:!0}),r.perfDisplay=r.RunningStatistics=r.debugNow=r.perfDebug=void 0,r.setPerfHooks=function(e,t){a.isDebug=e,a.toggleDebug=t},r.measure=function(e){var t=(0,r.debugNow)();return e(),(0,r.debugNow)()-t},r.runningStatStr=function(e){return`Last: ${e.last.toFixed(2)}ms | `+`Avg: ${e.mean.toFixed(2)}ms | `+`Avg${e.maxBufferSize}: ${e.bufferMean.toFixed(2)}ms`};const n=or.__importDefault(ae()),a={isDebug:()=>!1,toggleDebug:()=>{}};r.perfDebug=()=>a.isDebug();r.debugNow=()=>(0,r.perfDebug)()?performance.now():0;r.RunningStatistics=class{_maxBufferSize;_count=0;_mean=0;_lastValue=0;_ptr=0;buffer=[];constructor(e=10){this._maxBufferSize=e}addValue(e){this._lastValue=e,this.buffer.length>=this._maxBufferSize?(this.buffer[this._ptr++]=e,this._ptr>=this.buffer.length&&(this._ptr-=this.buffer.length)):this.buffer.push(e),this._mean=(this._mean*this._count+e)/(this._count+1),this._count++}get mean(){return this._mean}get count(){return this._count}get bufferMean(){return this.buffer.reduce((e,t)=>e+t,0)/this.buffer.length}get bufferSize(){return this.buffer.length}get maxBufferSize(){return this._maxBufferSize}get last(){return this._lastValue}};r.perfDisplay=new class{containers=[];addContainer(e){this.containers.push(e)}removeContainer(e){e=this.containers.indexOf(e);this.containers.splice(e,1)}renderPerfStats(e){var t;(0,r.perfDebug)()&&(t=document.querySelector(".perf-stats"))&&n.default.render(t,[(0,n.default)("section",e.renderPerfStats()),(0,n.default)("button.close-button",{onclick:a.toggleDebug},(0,n.default)("i.material-icons","close")),this.containers.map((e,t)=>(0,n.default)("section",(0,n.default)("div","Panel Container "+(t+1)),e.renderPerfStats()))])}}}}return si}var fo,po={};function ie(){if(!fo){fo=1,Object.defineProperty(po,"__esModule",{value:!0}),po.raf=po.RafScheduler=void 0;const r=or.__importDefault(ae()),o=uo();class t{actionCallbacks=new Set;canvasRedrawCallbacks=new Set;_syncDomRedraw=e=>{};hasScheduledNextFrame=!1;requestedFullRedraw=!1;isRedrawing=!1;_shutdown=!1;_beforeRedraw=()=>{};_afterRedraw=()=>{};_pendingCallbacks=[];perfStats={rafActions:new o.RunningStatistics,rafCanvas:new o.RunningStatistics,rafDom:new o.RunningStatistics,rafTotal:new o.RunningStatistics,domRedraw:new o.RunningStatistics};start(e){this.actionCallbacks.add(e),this.maybeScheduleAnimationFrame()}stop(e){this.actionCallbacks.delete(e)}addRedrawCallback(e){this.canvasRedrawCallbacks.add(e)}removeRedrawCallback(e){this.canvasRedrawCallbacks.delete(e)}addPendingCallback(e){this._pendingCallbacks.push(e)}scheduleRedraw(){this.maybeScheduleAnimationFrame(!0)}shutdown(){this._shutdown=!0}set domRedraw(e){this._syncDomRedraw=e}set beforeRedraw(e){this._beforeRedraw=e}set afterRedraw(e){this._afterRedraw=e}scheduleFullRedraw(){this.requestedFullRedraw=!0,this.maybeScheduleAnimationFrame(!0)}scheduleDelayedFullRedraw(){setTimeout(()=>this.scheduleFullRedraw(),50)}syncDomRedraw(e){var t=(0,o.debugNow)();this._syncDomRedraw(e),(0,o.perfDebug)()&&this.perfStats.domRedraw.addValue((0,o.debugNow)()-t)}get hasPendingRedraws(){return this.isRedrawing||this.hasScheduledNextFrame}syncCanvasRedraw(e){var t=(0,o.debugNow)();if(!this.isRedrawing){this._beforeRedraw(),this.isRedrawing=!0;for(const r of this.canvasRedrawCallbacks)r(e);this.isRedrawing=!1,this._afterRedraw();for(const n of this._pendingCallbacks)n(e);this._pendingCallbacks.splice(0,this._pendingCallbacks.length),(0,o.perfDebug)()&&this.perfStats.rafCanvas.addValue((0,o.debugNow)()-t)}}maybeScheduleAnimationFrame(e=!1){this.hasScheduledNextFrame||0===this.actionCallbacks.size&&!e||(this.hasScheduledNextFrame=!0,window.requestAnimationFrame(this.onAnimationFrame.bind(this)))}onAnimationFrame(t){if(!this._shutdown){var e=(0,o.debugNow)();this.hasScheduledNextFrame=!1;const i=this.requestedFullRedraw;var r=(this.requestedFullRedraw=!1,o.measure)(()=>{for(const e of this.actionCallbacks)e(t)}),n=(0,o.measure)(()=>{i&&this.syncDomRedraw(t)}),a=(0,o.measure)(()=>this.syncCanvasRedraw(t)),e=(0,o.debugNow)()-e;this.updatePerfStats(r,n,a,e),o.perfDisplay.renderPerfStats(this),this.maybeScheduleAnimationFrame()}}updatePerfStats(e,t,r,n){(0,o.perfDebug)()&&(this.perfStats.rafActions.addValue(e),this.perfStats.rafDom.addValue(t),this.perfStats.rafCanvas.addValue(r),this.perfStats.rafTotal.addValue(n))}renderPerfStats(){return(0,r.default)("div",(0,r.default)("div",[(0,r.default)("button",{onclick:()=>this.scheduleRedraw()},"Do Canvas Redraw"),"   |   ",(0,r.default)("button",{onclick:()=>this.scheduleFullRedraw()},"Do Full Redraw")]),(0,r.default)("div","Raf Timing (Total may not add up due to imprecision)"),(0,r.default)("table",(0,r.default)("tr",(0,r.default)("th",""),(0,r.default)("th","Last (ms)"),(0,r.default)("th","Avg (ms)"),(0,r.default)("th","Avg-10 (ms)")),e("Actions",this.perfStats.rafActions),e("Dom",this.perfStats.rafDom),e("Canvas",this.perfStats.rafCanvas),e("Total",this.perfStats.rafTotal)),(0,r.default)("div","Dom redraw: "+`Count: ${this.perfStats.domRedraw.count} | `+(0,o.runningStatStr)(this.perfStats.domRedraw)))}}function e(e,t){return(0,r.default)("tr",(0,r.default)("td",e),(0,r.default)("td",t.last.toFixed(2)),(0,r.default)("td",t.mean.toFixed(2)),(0,r.default)("td",t.bufferMean.toFixed(2)))}po.RafScheduler=t,po.raf=new t}return po}var ho,go={};var mo,_o={},yo={};function To(){if(!mo){mo=1;{var r=yo;Object.defineProperty(r,"__esModule",{value:!0}),r.DEFAULT_CHANNEL=void 0,r.getCurrentChannel=n,r.getNextChannel=a,r.channelChanged=function(){return n()!==a()},r.setChannel=function(e){n(),t=e,localStorage.setItem(o,e),i.raf.scheduleFullRedraw()};const i=ie(),o=(r.DEFAULT_CHANNEL="stable","perfettoUiChannel");let e=void 0,t=void 0;function n(){return e=void 0===e?localStorage.getItem(o)??r.DEFAULT_CHANNEL:e}function a(){return void 0!==t?t:n()}}}return yo}var bo,vo,Eo={};function So(){if(!bo){bo=1;{var c=Eo;Object.defineProperty(c,"__esModule",{value:!0}),c.Router=c.ROUTE_PREFIX=void 0;const a=or.__importDefault(ae()),r=ee();var e=ra();c.ROUTE_PREFIX="#!";const t=e.z.object({local_cache_key:e.z.string().optional().catch(void 0),openFromAndroidBugTool:e.z.boolean().optional().catch(void 0),s:e.z.string().optional().catch(void 0),p:e.z.string().optional().catch(void 0),url:e.z.string().optional().catch(void 0),rpc_port:e.z.string().regex(/\d+/).optional().catch(void 0),referrer:e.z.string().optional().catch(void 0),mode:e.z.enum(["embedded"]).optional().catch(void 0),hideSidebar:e.z.boolean().optional().catch(void 0),ts:e.z.string().optional().catch(void 0),dur:e.z.string().optional().catch(void 0),tid:e.z.string().optional().catch(void 0),pid:e.z.string().optional().catch(void 0),query:e.z.string().optional().catch(void 0),visStart:e.z.string().optional().catch(void 0),visEnd:e.z.string().optional().catch(void 0)}).default({});function u(e){e=t.safeParse(e);return e.success?e.data:{}}class d{recentChanges=[];routes;onRouteChanged=()=>{};constructor(e){(0,r.assertExists)(e["/"]),this.routes=e,window.onhashchange=e=>this.onHashChange(e);e=d.parseUrl(window.location.href);this.onRouteChanged(e)}onHashChange(e){this.crashIfLivelock();var t=d.parseUrl(e.oldURL),r=d.parseUrl(e.newURL),t=(void 0===r.args.local_cache_key&&t.args.local_cache_key&&(r.args.local_cache_key=t.args.local_cache_key),a.default.buildQueryString(r.args));let n="#!"+r.page+r.subpage;t.length&&(n+="?"+t),r.fragment&&(n+="#"+r.fragment),e.newURL.endsWith(n)?this.onRouteChanged(r):location.replace(n)}resolve(){var e=d.parseFragment(location.hash);let t=this.routes[e.page];return void 0===t&&(t=(0,r.assertExists)(this.routes["/"])),(0,a.default)(t,{subpage:e.subpage})}static navigate(e){(0,r.assertTrue)(e.startsWith(c.ROUTE_PREFIX)),window.location.hash=e}static parseFragment(e){e=e.startsWith(c.ROUTE_PREFIX)?e.substring(c.ROUTE_PREFIX.length):"";var e=new URL("https://example.com"+e),t=e.pathname;let r=t,n="";var a=t.indexOf("/",1);0<a&&(r=t.substring(0,a),n=t.substring(a)),"/"===r&&(r="");let i={};var o=u(i=e.search?d.parseQueryString(e.search):i);for(const l of Object.keys(o))void 0===o[l]&&delete o[l];let s=e.hash;return s.startsWith("#")&&(s=s.substring(1)),{page:r,subpage:n,args:o,fragment:s}}static parseQueryString(e){return e=e.replaceAll("+"," "),a.default.parseQueryString(e)}static parseSearchParams(e){e=new URL(e).search;return u(d.parseQueryString(e))}static parseUrl(e){var t=d.parseSearchParams(e),r=e.indexOf("#"),e=r<0?"":e.substring(r),r=d.parseFragment(e);return r.args=Object.assign({},t,r.args),r}crashIfLivelock(){for(var e=Date.now();0<this.recentChanges.length&&1e3<e-this.recentChanges[0];)this.recentChanges.shift();if(this.recentChanges.push(e),20<this.recentChanges.length)throw new Error("History rewriting livelock")}static getUrlForVersion(e){return window.location.origin+`/${e}/`}static async isVersionAvailable(t){if(""!==t){const a=new AbortController;var r=setTimeout(()=>a.abort(),1e3),n=d.getUrlForVersion(t);let e;try{e=await fetch(n,{signal:a.signal})}catch(e){return void console.error(`No UI version for ${t} at ${n}. This is an error if ${t} is a released Perfetto version`)}finally{clearTimeout(r)}if(e.ok)return n}}static navigateToVersion(e){var t=d.getUrlForVersion(e);if(void 0===t)throw new Error(`No URL known for UI version ${e}.`);window.location.replace(t)}}c.Router=d}}return Eo}function Ao(){if(vo)return _o;vo=1,Object.defineProperty(_o,"__esModule",{value:!0}),_o.NullAnalytics=void 0,_o.initAnalytics=function(){return new(!window.location.origin.startsWith("http://localhost:")&&!window.location.origin.endsWith(".perfetto.dev")||n.globals.testing||n.globals.embeddedMode?e:u)};const t=To(),r=Nr(),n=oe(),a=So(),i="G-BD89KT2P3C",o="no-page-title";function s(){var e=a.Router.parseUrl(window.location.href).args.referrer;if(e)return e}function l(){var e=s();return e?function(e){let t;try{t=new URL(e)}catch(e){return}return"http:"===t.protocol||"https:"===t.protocol}(e)?e:`https://${e.replaceAll("_","-")}.example.com/converted_non_url_referrer`:document.referrer.split("?")[0]}const c=window;class e{initialize(){}updatePath(e){}logEvent(e,t){}logError(e){}isEnabled(){return!1}}_o.NullAnalytics=e;class u{initialized_=!1;constructor(){c.dataLayer=c.dataLayer||[],c.gtag=function(){c.dataLayer.push(arguments)},c.gtag("js",new Date)}initialize(){var e;this.initialized_||(this.initialized_=!0,(e=document.createElement("script")).src="https://www.googletagmanager.com/gtag/js?id="+i,e.defer=!0,document.head.appendChild(e),e=window.location.href,console.log("GA initialized. route="+e,"isInternalUser="+n.globals.isInternalUser),c.gtag("config",i,{allow_google_signals:!1,anonymize_ip:!0,page_location:e,page_referrer:l(),send_page_view:!1,page_title:o,perfetto_is_internal_user:n.globals.isInternalUser?"1":"0",perfetto_version:r.VERSION,perfetto_channel:(0,t.getCurrentChannel)(),perfetto_referrer_override:s()??""}),this.updatePath(e))}updatePath(e){c.gtag("event","page_view",{page_path:e,page_title:o})}logEvent(e,t){c.gtag("event",t,{event_category:e})}logError(e){let t="";for(const n of e.stack){var r=n.location.replace("frontend_bundle.js","$");t+=n.name+`(${r}),`}t=t.substring(0,t.length-1),c.gtag("event","exception",{description:e.message,error_type:e.errType,page_location:"http://crash?/"+encodeURI(t)})}isEnabled(){return!0}}return _o}var Oo,Co,ko={},wo={},Ro={};function Io(){if(!Oo){Oo=1,Object.defineProperty(Ro,"__esModule",{value:!0}),Ro.HighPrecisionTime=void 0;const t=ee(),r=K();class n{static ZERO=new n(r.Time.fromRaw(0n));integral;fractional;constructor(e,t=0){var r=Math.floor(t);this.integral=e+BigInt(r),this.fractional=t-r}toTime(e="floor"){switch(e){case"round":return r.Time.fromRaw(this.integral+BigInt(Math.round(this.fractional)));case"floor":return r.Time.fromRaw(this.integral);case"ceil":return r.Time.fromRaw(this.integral+BigInt(Math.ceil(this.fractional)));default:(0,t.assertUnreachable)(e)}}toNumber(){return Number(this.integral)+this.fractional}add(e){return new n(r.Time.add(this.integral,e.integral),this.fractional+e.fractional)}addTime(e){return new n(r.Time.add(this.integral,e),this.fractional)}addNumber(e){return new n(this.integral,this.fractional+e)}sub(e){return new n(r.Time.sub(this.integral,e.integral),this.fractional-e.fractional)}subTime(e){return new n(r.Time.sub(this.integral,e),this.fractional)}subNumber(e){return new n(this.integral,this.fractional-e)}equals(e,t=1e-6){return Math.abs(this.sub(e).toNumber())<t}containedWithin(e,t){return this.integral>=e&&this.integral<t}lt(e){return this.integral<e}lte(e){return this.integral<e||this.integral===e&&Math.abs(+this.fractional)<Number.EPSILON}gt(e){return this.integral>e||this.integral===e&&Math.abs(+this.fractional)>Number.EPSILON}gte(e){return this.integral>=e}clamp(e,t){return this.integral<e?new n(e):this.integral>=t?new n(t):this}abs(){var e,t;return 0n<=this.integral?this:(e=r.Time.fromRaw(-this.integral),t=-this.fractional,new n(e,t))}toString(){var e=this.fractional.toString();return"0"===e?this.integral.toString():""+this.integral+e.substring(1)}}Ro.HighPrecisionTime=n}return Ro}function Mo(){if(!Co){Co=1,Object.defineProperty(wo,"__esModule",{value:!0}),wo.HighPrecisionTimeSpan=void 0;const e=K(),r=Io();class a{static ZERO=new a(r.HighPrecisionTime.ZERO,0);start;duration;constructor(e,t){this.start=e,this.duration=t}static fromTime(e,t){return new a(new r.HighPrecisionTime(e),Number(t-e))}get midpoint(){return this.start.addNumber(this.duration/2)}get end(){return this.start.addNumber(this.duration)}equals(e){return this.start.equals(e.start)&&this.duration===e.duration}translate(e){return new a(this.start.addNumber(e),this.duration)}pad(e){return new a(this.start.subNumber(e),this.duration+2*e)}scale(e,t,r){var n=this.duration,e=Math.max(n*e,r),r=this.start.addNumber((n-e)*t);return new a(r,e)}intersect(e,t){var r;return this.overlaps(e,t)?(r=this.start.clamp(e,t),e=this.end.clamp(e,t).sub(r).toNumber(),new a(r,e)):a.ZERO}fitWithin(e,t){return this.duration>Number(t-e)?a.fromTime(e,t):this.start.integral<e?new a(new r.HighPrecisionTime(e),this.duration):this.end.gt(t)?new a(new r.HighPrecisionTime(t).subNumber(this.duration),this.duration):this}clampDuration(e){return this.duration<e?new a(this.start,e):this}contains(e){return this.start.lte(e)&&this.end.gt(e)}containsSpan(e,t){return this.start.lte(e)&&this.end.gte(t)}overlaps(e,t){return!(this.start.gte(t)||this.end.lte(e))}toTimeSpan(){return new e.TimeSpan(this.start.toTime("floor"),this.end.toTime("ceil"))}}wo.HighPrecisionTimeSpan=a}return wo}var Po,No,Do={};function xo(){return Po||(Po=1,Object.defineProperty(Do,"__esModule",{value:!0}),Do.ratelimit=function(e,t){let r=!1;return()=>{r||(r=!0,setTimeout(()=>{e(),r=!1},t))}},Do.debounce=function(e,t){let r;return()=>{r&&clearTimeout(r),r=setTimeout(()=>{e(),r=void 0},t)}}),Do}var Lo,Fo={};function Uo(){if(!Lo){Lo=1,Object.defineProperty(Fo,"__esModule",{value:!0}),Fo.OmniboxManager=Fo.OmniboxMode=void 0;const a=ie();var t,e;(e=t||(Fo.OmniboxMode=t={}))[e.Search=0]="Search",e[e.Query=1]="Query",e[e.Command=2]="Command",e[e.Prompt=3]="Prompt";const r=t.Search;Fo.OmniboxManager=class{_omniboxMode=r;_focusOmniboxNextRender=!1;_pendingCursorPlacement;_pendingPrompt;_text="";_omniboxSelectionIndex=0;get omniboxMode(){return this._omniboxMode}get pendingPrompt(){return this._pendingPrompt}get text(){return this._text}get omniboxSelectionIndex(){return this._omniboxSelectionIndex}get focusOmniboxNextRender(){return this._focusOmniboxNextRender}get pendingCursorPlacement(){return this._pendingCursorPlacement}setText(e){this._text=e}setOmniboxSelectionIndex(e){this._omniboxSelectionIndex=e}focusOmnibox(e){this._focusOmniboxNextRender=!0,this._pendingCursorPlacement=e,a.raf.scheduleFullRedraw()}clearOmniboxFocusFlag(){this._focusOmniboxNextRender=!1,this._pendingCursorPlacement=void 0}setMode(e){this._omniboxMode=e,this._focusOmniboxNextRender=!0,this.resetOmniboxText(),this.rejectPendingPrompt(),a.raf.scheduleFullRedraw()}prompt(r,n){this._omniboxMode=t.Prompt,this.resetOmniboxText(),this.rejectPendingPrompt();var e=new Promise((e,t)=>{this._pendingPrompt={text:r,options:n,resolve:e,reject:t}});return this._focusOmniboxNextRender=!0,a.raf.scheduleFullRedraw(),e}resolvePrompt(e){this._pendingPrompt&&(this._pendingPrompt.resolve(e),this._pendingPrompt=void 0),this.setMode(t.Search)}rejectPrompt(){this._pendingPrompt&&(this._pendingPrompt.reject(),this._pendingPrompt=void 0),this.setMode(t.Search)}reset(){this.setMode(r),this.resetOmniboxText(),a.raf.scheduleFullRedraw()}rejectPendingPrompt(){this._pendingPrompt&&(this._pendingPrompt.reject(),this._pendingPrompt=void 0)}resetOmniboxText(){this._text="",this._omniboxSelectionIndex=0}}}return Fo}var Bo,Ho={};function Go(){if(!Bo){Bo=1,Object.defineProperty(Ho,"__esModule",{value:!0}),Ho.LegacyFlamegraphCache=void 0;Ho.LegacyFlamegraphCache=class{cache;prefix;tableId;cacheSizeLimit;constructor(e){this.cache=new Map,this.prefix=e,this.tableId=0,this.cacheSizeLimit=10}async getTableName(e,t){let r=this.cache.get(t);if(void 0===r){if(this.cache.size>this.cacheSizeLimit){for(const n of this.cache.values())await e.query("drop table "+n);this.cache.clear()}r=this.prefix+"_"+this.tableId++,await e.query(`create temp table if not exists ${r} as `+t),this.cache.set(t,r)}return r}hasQuery(e){return void 0!==this.cache.get(e)}}}return Ho}var Vo,Wo={};function qo(){if(!Vo){Vo=1,Object.defineProperty(Wo,"__esModule",{value:!0}),Wo.fetchWithTimeout=function(n,a,i){return new Promise((t,r)=>{const e=setTimeout(()=>r(new Error(`fetch(${n}) timed out after ${i} ms`)),i);fetch(n,a).then(e=>t(e)).catch(e=>r(e)).finally(()=>clearTimeout(e))})},Wo.getServingRoot=function(){var e=document.currentScript;if(null===e)return(0,r.assertTrue)("undefined"!=typeof jest),"";let t=e.src;return t=t.substring(0,t.lastIndexOf("/")+1)};const r=ee()}return Wo}var $o,zo={},Ko={};function Yo(){if(!$o){$o=1,Object.defineProperty(Ko,"__esModule",{value:!0}),Ko.PxSpan=Ko.TimeScale=void 0;Ko.TimeScale=class{timeSpan;pxSpan;timePerPx;constructor(e,t){this.pxSpan=t,(this.timeSpan=e).duration<=0||t.delta<=0?this.timePerPx=1:this.timePerPx=e.duration/t.delta}timeToPx(e){e=Number(e-this.timeSpan.start.integral)-this.timeSpan.start.fractional;return this.pxSpan.start+e/this.timePerPx}hpTimeToPx(e){e=e.sub(this.timeSpan.start).toNumber();return this.pxSpan.start+e/this.timePerPx}pxToHpTime(e){e=(e-this.pxSpan.start)*this.timePerPx;return this.timeSpan.start.addNumber(e)}durationToPx(e){return Number(e)/this.timePerPx}pxToDuration(e){return e*this.timePerPx}};class e{static ZERO=new e(0,0);start;end;constructor(e,t){this.start=e,this.end=t}get delta(){return this.end-this.start}}Ko.PxSpan=e}return Ko}var Jo,Zo={};function V(){if(!Jo){Jo=1,Object.defineProperty(Zo,"__esModule",{value:!0}),Zo.AsyncDisposableStack=Zo.DisposableStack=void 0;class r{resources;isDisposed=!1;constructor(){this.resources=[]}use(e){return null!=e&&this.resources.push(e),e}defer(e){this.resources.push({[Symbol.dispose]:e})}[Symbol.dispose](){for(this.isDisposed=!0;;){var e=this.resources.pop();if(void 0===e)break;e[Symbol.dispose]()}}dispose(){this[Symbol.dispose]()}adopt(e,t){return this.resources.push({[Symbol.dispose]:()=>t(e)}),e}move(){var e=new r;for(const t of this.resources)e.resources.push(t);return this.resources.length=0,e}[Symbol.toStringTag]="DisposableStack";get disposed(){return this.isDisposed}}Zo.DisposableStack=r;class n{resources;isDisposed=!1;constructor(){this.resources=[]}use(e){return null!=e&&(Symbol.asyncDispose in e?this.resources.push(e):Symbol.dispose in e&&this.resources.push({[Symbol.asyncDispose]:async()=>{e[Symbol.dispose]()}})),e}defer(e){this.resources.push({[Symbol.asyncDispose]:e})}async[Symbol.asyncDispose](){for(this.isDisposed=!0;;){var e=this.resources.pop();if(void 0===e)break;await e[Symbol.asyncDispose]()}}asyncDispose(){return this[Symbol.asyncDispose]()}adopt(e,t){return this.resources.push({[Symbol.asyncDispose]:async()=>t(e)}),e}move(){var e=new n;for(const t of this.resources)e.resources.push(t);return this.resources.length=0,e}[Symbol.toStringTag]="AsyncDisposableStack";get disposed(){return this.isDisposed}}Zo.AsyncDisposableStack=n}return Zo}var Qo,Xo={},es={};function J(){if(!Qo){Qo=1,Object.defineProperty(es,"__esModule",{value:!0}),es.base64Encode=function(e){return(0,n.encode)(e,0,e.length)},es.base64Decode=function(e){var e=e.replaceAll("-","+").replaceAll("_","/"),t=new Uint8Array((0,n.length)(e)),e=(0,n.decode)(e,t,0);return(0,a.assertTrue)(e===t.length),t},es.hexEncode=function(e){return e.reduce((e,t)=>e+("0"+t.toString(16)).slice(-2),"")},es.utf8Encode=function(e){return(r=r??new TextEncoder).encode(e)},es.utf8Decode=function(e){return(t=t??new TextDecoder).decode(e)},es.binaryEncode=function(t){let r="";for(let e=0;e<t.length;e++)r+=String.fromCharCode(t[e]);return r},es.binaryDecode=function(t){var r=new Uint8Array(t.length),n=t.length;for(let e=0;e<n;e++)r[e]=t.charCodeAt(e);return r},es.sqliteString=function(e){return`'${e.replaceAll("'","''")}'`},es.undoCommonChatAppReplacements=function(e){return e.replaceAll(" "," ")},es.cropText=function(r,n,a){let i="";a=Math.floor(a/n)-1;if(r.length<=a)i=r;else{let e=a,t="";1<a&&(e=a-1,t="…");n=r.charCodeAt(e-1);e+=55296<=n&&n<56320?1:0,i=r.substring(0,e)+t}return i};const n=Me(),a=ee();let t=void 0,r=void 0}return es}var ts,rs,ns={};function Z(){return ts||(ts=1,function(l){Object.defineProperty(l,"__esModule",{value:!0}),l.QueryError=l.LONG_NULL=l.LONG=l.BLOB_NULL=l.BLOB=l.STR_NULL=l.NUM_NULL=l.STR=l.NUM=l.UNKNOWN=void 0,l.decodeInt64Varint=p,l.createQueryResult=function(e){return new _(e)},l.timeFromSql=function(e){{if("bigint"==typeof e)return r.Time.fromRaw(e);if("number"==typeof e)return r.Time.fromRaw(BigInt(Math.floor(e)));if(null===e)return r.Time.ZERO;throw Error("Refusing to create time from unrelated type "+e)}},l.durationFromSql=function(e){{if("bigint"==typeof e)return e;if("number"==typeof e)return BigInt(Math.floor(e));if(null===e)return r.Duration.ZERO;throw Error("Refusing to create duration from unrelated type "+e)}};var c,e=or;pt();const u=e.__importDefault(lr()),t=Wa(),d=ee(),s=J(),r=K(),f=(l.UNKNOWN=null,l.NUM=0,l.STR="str",l.NUM_NULL=1,l.STR_NULL="str_null",l.BLOB=new Uint8Array,l.BLOB_NULL=new Uint8Array,l.LONG=0n,l.LONG_NULL=1n,32n);function p(e,t){let r=0,n=0,a=0;if(!(4<e.length-t)){for(;a<3;++a){if(t>=e.length)throw Error("Index out of range");if(n=(n|(127&e[t])<<7*a)>>>0,e[t++]<128)return BigInt(n)}return n=(n|(127&e[t++])<<7*a)>>>0,BigInt(r)<<f|BigInt(n)}for(;a<4;++a)if(n=(n|(127&e[t])<<7*a)>>>0,e[t++]<128)return BigInt(n);if(n=(n|(127&e[t])<<28)>>>0,r=(r|(127&e[t])>>4)>>>0,e[t++]<128)return BigInt(r)<<f|BigInt(n);if(a=0,4<e.length-t)for(;a<5;++a){var i;if(r=(r|(127&e[t])<<7*a+3)>>>0,e[t++]<128)return i=BigInt(r)<<f|BigInt(n),BigInt.asIntN(64,i)}else for(;a<5;++a){if(t>=e.length)throw Error("Index out of range");var o;if(r=(r|(127&e[t])<<7*a+3)>>>0,e[t++]<128)return o=BigInt(r)<<f|BigInt(n),BigInt.asIntN(64,o)}throw Error("invalid varint encoding")}class n extends Error{query;constructor(e,t){super(e),this.query=t.query}toString(){return super.toString()+`
Query:
`+this.query}}function o(e){switch(e){case l.NUM:return"NUM";case l.NUM_NULL:return"NUM_NULL";case l.STR:return"STR";case l.STR_NULL:return"STR_NULL";case l.BLOB:return"BLOB";case l.BLOB_NULL:return"BLOB_NULL";case l.LONG:return"LONG";case l.LONG_NULL:return"LONG_NULL";case l.UNKNOWN:return"UNKNOWN";default:return`INVALID(${e})`}}l.QueryError=n,(e=c=c||{})[e.CELL_NULL=1]="CELL_NULL",e[e.CELL_VARINT=2]="CELL_VARINT",e[e.CELL_FLOAT64=3]="CELL_FLOAT64",e[e.CELL_STRING=4]="CELL_STRING",e[e.CELL_BLOB=5]="CELL_BLOB";const h=["UNKNOWN","NULL","VARINT","FLOAT64","STRING","BLOB"];class a{columnNames=[];_error;_numRows=0;_isComplete=!1;_errorInfo;_statementCount=0;_statementWithOutputCount=0;_lastStatementSql="";constructor(e){this._errorInfo=e}batches=[];allRowsPromise;moreRowsPromise;isComplete(){return this._isComplete}numRows(){return this._numRows}error(){return this._error}columns(){return this.columnNames}statementCount(){return this._statementCount}statementWithOutputCount(){return this._statementWithOutputCount}lastStatementSql(){return this._lastStatementSql}iter(e){return new m(e,this)}firstRow(e){e=new m(e,this);return(0,d.assertTrue)(e.valid()),e}waitAllRows(){return(0,d.assertTrue)(void 0===this.allRowsPromise),this.allRowsPromise=(0,t.defer)(),this._isComplete&&this.resolveOrReject(this.allRowsPromise,this),this.allRowsPromise}waitMoreRows(){var e;return void 0!==this.moreRowsPromise?this.moreRowsPromise:(e=(0,t.defer)(),this._isComplete?this.resolveOrReject(e,this):this.moreRowsPromise=e,e)}appendResultBatch(e){for(var r=u.default.Reader.create(e),n=((0,d.assertTrue)(0===r.pos),0===this.columnNames.length),a=new Set;r.pos<r.len;){var i=r.uint32();switch(i>>>3){case 1:(0,d.assertTrue)(n);var o=r.string();let t=o;for(let e=1;a.has(t);++e)t=o+"_"+e,(0,d.assertTrue)(e<100);a.add(t),this.columnNames.push(t);break;case 2:var s=r.string();this._error=void 0!==s&&s.length?s:void 0;break;case 3:var s=r.uint32(),l=e.subarray(r.pos,r.pos+s),l=(r.pos+=s,new g(l)),c=(this.batches.push(l),this._isComplete=l.isLastBatch,this.columnNames.length);0!==c?((0,d.assertTrue)(l.numCells%c==0),this._numRows+=l.numCells/c):(0,d.assertTrue)(0===l.numCells);break;case 4:this._statementCount=r.uint32();break;case 5:this._statementWithOutputCount=r.uint32();break;case 6:this._lastStatementSql=r.string();break;default:console.warn("Unexpected QueryResult field "+(i>>>3)),r.skipType(7&i)}}void 0!==this.moreRowsPromise&&(this.resolveOrReject(this.moreRowsPromise,this),this.moreRowsPromise=void 0),this._isComplete&&void 0!==this.allRowsPromise&&this.resolveOrReject(this.allRowsPromise,this)}ensureAllRowsPromise(){return void 0===this.allRowsPromise&&this.waitAllRows(),(0,d.assertExists)(this.allRowsPromise)}get errorInfo(){return this._errorInfo}resolveOrReject(e,t){void 0===this._error?e.resolve(t):e.reject(new n(this._error,this._errorInfo))}}class g{isLastBatch=!1;batchBytes;cellTypesOff=0;cellTypesLen=0;varintOff=0;varintLen=0;float64Cells=new Float64Array;blobCells=[];stringCells=[];constructor(e){this.batchBytes=e;for(var t=u.default.Reader.create(e),r=((0,d.assertTrue)(0===t.pos),t.len);t.pos<r;){var n=t.uint32();switch(n>>>3){case 1:(0,d.assertTrue)(2==(7&n)),this.cellTypesLen=t.uint32(),this.cellTypesOff=t.pos,t.pos+=this.cellTypesLen;break;case 2:(0,d.assertTrue)(2==(7&n));var a=t.uint32();this.varintOff=t.pos,this.varintLen=a,(0,d.assertTrue)(t.buf===e),(0,d.assertTrue)(this.varintOff+this.varintLen<=e.byteOffset+e.byteLength),t.pos+=a;break;case 3:(0,d.assertTrue)(2==(7&n));var a=t.uint32(),i=((0,d.assertTrue)(a%8==0),a/8),o=e.byteOffset+t.pos;o%8==0?this.float64Cells=new Float64Array(e.buffer,o,i):(i=e.buffer.slice(o,o+a),this.float64Cells=new Float64Array(i)),t.pos+=a;break;case 4:(0,d.assertTrue)(2==(7&n)),this.blobCells.push(new Uint8Array(t.bytes()));break;case 5:(0,d.assertTrue)(2==(7&n));o=t.uint32(),i=((0,d.assertTrue)(t.pos+o<=r),e.subarray(t.pos,t.pos+o));(0,d.assertTrue)(i.length===o),this.stringCells=(0,s.utf8Decode)(i).split("\0"),t.pos+=o;break;case 6:this.isLastBatch=!!t.bool();break;case 7:t.skipType(7&n);break;default:console.warn("Unexpected QueryResult.CellsBatch field "+(n>>>3)),t.skipType(7&n)}}}get numCells(){return this.cellTypesLen}}class i{rowSpec;rowData;resultObj;batchIdx=-1;batchBytes=new Uint8Array;columnNames=[];numColumns=0;cellTypesEnd=-1;float64Cells=new Float64Array;varIntReader=u.default.Reader.create(this.batchBytes);blobCells=[];stringCells=[];nextCellTypeOff=0;nextFloat64Cell=0;nextStringCell=0;nextBlobCell=0;isValid=!1;constructor(e,t,r){Object.assign(this,e),this.rowData=t,this.rowSpec={...e},this.resultObj=r,this.next()}valid(){return this.isValid}makeError(e){return new n(e,this.resultObj.errorInfo)}get(e){var t=this.rowData[e];if(void 0===t)throw this.makeError(`Column '${e}' doesn't exist. `+`Actual columns: [${this.columnNames.join(",")}]`);return t}next(){for(;this.nextCellTypeOff+this.numColumns>this.cellTypesEnd;)if((0,d.assertTrue)(this.nextCellTypeOff===this.cellTypesEnd||-1===this.cellTypesEnd),!this.tryMoveToNextBatch())return void(this.isValid=!1);var t=this.rowData,r=this.numColumns;for(let e=0;e<r;e++){var n,a=this.batchBytes[this.nextCellTypeOff++],i=this.columnNames[e],o=this.rowSpec[i];switch(a){case c.CELL_NULL:t[i]=null;break;case c.CELL_VARINT:o===l.NUM||o===l.NUM_NULL?(n=this.varIntReader.int64(),t[i]=n):(n=p(this.batchBytes,this.varIntReader.pos),t[i]=n,this.varIntReader.skip());break;case c.CELL_FLOAT64:t[i]=this.float64Cells[this.nextFloat64Cell++];break;case c.CELL_STRING:t[i]=this.stringCells[this.nextStringCell++];break;case c.CELL_BLOB:var s=this.blobCells[this.nextBlobCell++];t[i]=s;break;default:throw this.makeError("Invalid cell type "+a)}}this.isValid=!0}tryMoveToNextBatch(){var e=this.batchIdx+1;if(e>=this.resultObj.batches.length)return!1;this.columnNames=this.resultObj.columnNames,this.numColumns=this.columnNames.length,this.batchIdx=e;e=(0,d.assertExists)(this.resultObj.batches[e]);this.batchBytes=e.batchBytes,this.nextCellTypeOff=e.cellTypesOff,this.cellTypesEnd=e.cellTypesOff+e.cellTypesLen,this.float64Cells=e.float64Cells,this.blobCells=e.blobCells,this.stringCells=e.stringCells,this.varIntReader=u.default.Reader.create(e.batchBytes),this.varIntReader.pos=e.varintOff,this.varIntReader.len=e.varintOff+e.varintLen,this.nextFloat64Cell=0,this.nextStringCell=0,this.nextBlobCell=0;for(const t of Object.keys(this.rowSpec))if(this.columnNames.indexOf(t)<0)throw this.makeError(`Column ${t} not found in the SQL result `+`set {${this.columnNames.join(" ")}}`);var r=this.numColumns;if(0===e.numCells)return(0,d.assertTrue)(e.isLastBatch),!1;(0,d.assertTrue)(0<r);for(let t=this.nextCellTypeOff;t<this.cellTypesEnd;t++){var n=(t-this.nextCellTypeOff)%r,n=this.columnNames[n],a=this.batchBytes[t],i=this.rowSpec[n];if(void 0!==i){let e="";if(0<(e=!function(e,t){switch(e){case c.CELL_NULL:return t===l.NUM_NULL||t===l.STR_NULL||t===l.BLOB_NULL||t===l.LONG_NULL||t===l.UNKNOWN;case c.CELL_VARINT:return t===l.NUM||t===l.NUM_NULL||t===l.LONG||t===l.LONG_NULL||t===l.UNKNOWN;case c.CELL_FLOAT64:return t===l.NUM||t===l.NUM_NULL||t===l.UNKNOWN;case c.CELL_STRING:return t===l.STR||t===l.STR_NULL||t===l.UNKNOWN;case c.CELL_BLOB:return t===l.BLOB||t===l.BLOB_NULL||t===l.UNKNOWN;default:throw new Error("Unknown CellType "+e)}}(a,i)?a===c.CELL_NULL?"SQL value is NULL but that was not expected"+` (expected type: ${o(i)}). `+"Did you mean NUM_NULL, LONG_NULL, STR_NULL or BLOB_NULL?":`Incompatible cell type. Expected: ${o(i)} actual: `+h[a]:e).length)throw i=`Error @ row: ${Math.floor(t/r)} col: '${n}': `+e,this.makeError(i)}}return!0}}class m{_impl;next;valid;get;constructor(e,t){Object.assign(this,e),this._impl=new i(e,this,t),this.next=this._impl.next.bind(this._impl),this.valid=this._impl.valid.bind(this._impl),this.get=this._impl.get.bind(this._impl)}}class _{impl;thenCalled=!1;constructor(e){this.impl=new a(e)}iter(e){return this.impl.iter(e)}firstRow(e){return this.impl.firstRow(e)}waitAllRows(){return this.impl.waitAllRows()}waitMoreRows(){return this.impl.waitMoreRows()}isComplete(){return this.impl.isComplete()}numRows(){return this.impl.numRows()}columns(){return this.impl.columns()}error(){return this.impl.error()}statementCount(){return this.impl.statementCount()}statementWithOutputCount(){return this.impl.statementWithOutputCount()}lastStatementSql(){return this.impl.lastStatementSql()}appendResultBatch(e){return this.impl.appendResultBatch(e)}then(e,t){return(0,d.assertFalse)(this.thenCalled),this.thenCalled=!0,this.impl.ensureAllRowsPromise().then(e,t)}catch(e){return this.impl.ensureAllRowsPromise().catch(e)}finally(e){return this.impl.ensureAllRowsPromise().finally(e)}get[Symbol.toStringTag](){return"Promise<WaitableQueryResult>"}}}(ns)),ns}function D(){if(!rs){rs=1,Object.defineProperty(Xo,"__esModule",{value:!0}),Xo.constraintsToQueryPrefix=function(e){e=Object.entries(e.commonTableExpressions??{}).filter(([,e])=>n(e));if(0===e.length)return"";e=e.map(([e,t])=>e+` AS (${t})`);return"WITH "+e.join(",\n")},Xo.constraintsToQuerySuffix=function(e){var t=[],r=(e.joins??[]).filter(n);0<r.length&&t.push(...r);r=(e.filters??[]).filter(n);0<r.length&&t.push("WHERE "+r.join(" and "));r=(e.groupBy??[]).filter(n);0<r.length&&(r=r.join(", "),t.push("GROUP BY "+r));r=(e.orderBy??[]).filter(n);0<r.length&&(r=r.map(e=>{var t;return(0,a.isString)(e)?e:(t=e.direction?" "+e.direction:"",e.fieldName+t)}),t.push("ORDER BY "+r.join(", ")));e.limit&&t.push("LIMIT "+e.limit);return t.join("\n")},Xo.fromNumNull=function(e){if(null!==e)return e},Xo.sqlValueToReadableString=function(e){if(void 0===e)return;if(e instanceof Uint8Array)return`<blob length=${e.length}>`;return null!==e?e.toString():"NULL"},Xo.sqlValueToSqliteString=t,Xo.matchesSqlValue=function(e){return null!==e?"= "+t(e):"IS NULL"},Xo.getTableRowCount=async function(e,t){e=await e.query("SELECT COUNT() as count FROM "+t);if(0!==e.numRows())return e.firstRow({count:i.NUM}).count},Xo.createPerfettoTable=async function(e,t,r){return await e.query(`CREATE PERFETTO TABLE ${t} AS `+r),{[Symbol.asyncDispose]:async()=>{await e.tryQuery("DROP TABLE IF EXISTS "+t)}}},Xo.createView=async function(e,t,r){return await e.query(`CREATE VIEW ${t} AS `+r),{[Symbol.asyncDispose]:async()=>{await e.tryQuery("DROP VIEW IF EXISTS "+t)}}},Xo.createVirtualTable=async function(e,t,r){return await e.query(`CREATE VIRTUAL TABLE ${t} USING `+r),{[Symbol.asyncDispose]:async()=>{await e.tryQuery("DROP TABLE IF EXISTS "+t)}}},Xo.createPerfettoIndex=async function(e,t,r){return await e.query(`create perfetto index ${t} on `+r),{[Symbol.asyncDispose]:async()=>{await e.tryQuery("drop perfetto index "+t)}}};const a=te(),r=J(),i=Z();function n(e){return void 0!==e}function t(e){if(e instanceof Uint8Array)throw new Error("Can't pass blob back to trace processor as value");return null===e?"NULL":"string"==typeof e?(0,r.sqliteString)(e):""+e}}return Xo}var as,is={};function os(){var r,e;return as||(as=1,Object.defineProperty(is,"__esModule",{value:!0}),is.escapeQuery=function(e){return t(e)},is.escapeSearchQuery=function(e){return t(e,r.CaseInsensitive|r.MatchAny)},is.escapeGlob=function(e){return`'*${e=e.replaceAll("'","''")}*'`},(e=r=r||{})[e.CaseInsensitive=1]="CaseInsensitive",e[e.MatchAny=2]="MatchAny"),is;function t(e,t){return t=void 0===t?0:t,e=(e=e.replaceAll("'","''")).replaceAll("[","[[]"),e=(e=(e=t&r.CaseInsensitive?e.replace(/[a-zA-Z]/g,e=>{return`[${e.toLowerCase()}${e.toUpperCase()}]`}):e).replaceAll("?","[?]")).replaceAll("*","[*]"),e=`'${e=t&r.MatchAny?`*${e}*`:e}'`}}var ss,ls,cs,us={};function ds(){if(!ss){ss=1,Object.defineProperty(us,"__esModule",{value:!0}),us.calculateResolution=function(e,t){e=Number(e.duration)/t;return r.BigintMath.bitFloor(BigInt(Math.floor(e)))};const r=Rr()}return us}function fs(){if(!ls){ls=1,Object.defineProperty(zo,"__esModule",{value:!0}),zo.createSearchOverviewTrack=async function(s,l){const e=new r.AsyncDisposableStack;e.use(await(0,n.createVirtualTable)(s,"search_summary_window","window")),e.use(await(0,n.createVirtualTable)(s,"search_summary_sched_span","span_join(sched PARTITIONED cpu, search_summary_window)")),e.use(await(0,n.createVirtualTable)(s,"search_summary_slice_span","span_join(slice PARTITIONED track_id, search_summary_window)"));let c,u,d,f;const p=new t.AsyncLimiter;function h(e){var t=l.state.omniboxState;if(void 0!==t&&"COMMAND"!==t.mode){var r=l.timeline.visibleWindow;const n=t,a=(0,y.calculateResolution)(r,e.width);t=r.toTimeSpan();if(!u?.containsSpan(t.start,t.end)||c!==a||d!==n){const{start:i,end:o}=t.pad(t.duration);u=new g.TimeSpan(i,o),c=a;e=(d=n).omnibox;""===e||e.length<4&&!n.force?f={tsStarts:new BigInt64Array(0),tsEnds:new BigInt64Array(0),count:new Uint8Array(0)}:p.schedule(async()=>{var e=await async function(e,t,r,n){e=(0,_.escapeSearchQuery)(e),n*=10n,t=g.Time.quantFloor(t,n),r=g.Duration.max(g.Time.diff(r,t),1n),await s.query(`update search_summary_window set
      window_start=${t},
      window_dur=${r},
      quantum=${n}
      where rowid = 0;`);var a=[];for(const o=(await s.query(`select utid from thread join process
      using(upid) where thread.name glob ${e}
      or process.name glob `+e)).iter({utid:T.NUM});o.valid();o.next())a.push(o.utid);var r=l.traceContext.cpus,r=Math.max(...r,-1),t=(n=await s.query(`
        select
          (quantum_ts * ${n} + ${t}) as tsStart,
          ((quantum_ts+1) * ${n} + ${t}) as tsEnd,
          min(count(*), 255) as count
          from (
              select
              quantum_ts
              from search_summary_sched_span
              where utid in (${a.join(",")}) and cpu <= ${r}
            union all
              select
              quantum_ts
              from search_summary_slice_span
              where name glob ${e}
          )
          group by quantum_ts
          order by quantum_ts;`)).numRows(),i={tsStarts:new BigInt64Array(t),tsEnds:new BigInt64Array(t),count:new Uint8Array(t)};const o=n.iter({tsStart:T.LONG,tsEnd:T.LONG,count:T.NUM});for(let e=0;o.valid();o.next(),++e)i.tsStarts[e]=o.tsStart,i.tsEnds[e]=o.tsEnd,i.count[e]=o.count;return i}(n.omnibox,i,o,a);f=e})}}}return{render(e,t){h(t);var r=e,n=t,a=l.timeline.visibleWindow,i=new m.TimeScale(a,new m.PxSpan(0,n.width));if(f){for(let e=0;e<f.tsStarts.length;e++){var o=g.Time.fromRaw(f.tsStarts[e]),s=g.Time.fromRaw(f.tsEnds[e]);a.overlaps(o,s)&&(o=Math.max(i.timeToPx(o),0),s=i.timeToPx(s),r.fillStyle="#ffe263",r.fillRect(Math.floor(o),0,Math.ceil(s-o),n.height))}e=l.state.searchIndex;-1!==e&&e<l.currentSearchResults.tses.length&&-1n!==(e=l.currentSearchResults.tses[e])&&(e=Math.max(i.timeToPx(g.Time.fromRaw(e)),0),r.fillStyle="#000",r.beginPath(),r.moveTo(e,n.height),r.lineTo(e-3,0),r.lineTo(e+3,0),r.lineTo(e,n.height),r.fill(),r.closePath()),r.restore()}},async[Symbol.asyncDispose](){return e.asyncDispose()}}};const g=K(),m=Yo(),t=qa(),r=V(),n=D(),_=os(),y=ds(),T=Z()}return zo}function oe(){return cs||(cs=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.globals=a.defaultTraceContext=void 0,a.getTimeSpanOfSelectionOrVisibleWindow=async function(){var e=await a.globals.findTimeRangeOfSelection();return(0,y.exists)(e)?new o.TimeSpan(e.start,e.end):a.globals.timeline.visibleWindow.toTimeSpan()};const i=ee(),t=Vr(),o=K(),n=ne();var e=function(){if(!Ca){Ca=1,Object.defineProperty(ka,"__esModule",{value:!0}),ka.CommandManager=void 0;const t=Ra();var e=Or();ka.CommandManager=class{registry=new e.Registry(e=>e.id);getCommand(e){return this.registry.get(e)}get commands(){return Array.from(this.registry.values())}registerCommand(e){return this.registry.register(e)}runCommand(e,...t){return this.registry.get(e).callback(...t)}fuzzyFilterCommands(e){return new t.FuzzyFinder(this.commands,({name:e})=>e).find(e).map(e=>({segments:e.segments,...e.item}))}}}return ka}();const s=Pa();var r=ma();const l=Y();var c=function(){if(!Na){Na=1,Object.defineProperty(Da,"__esModule",{value:!0}),Da.TabManager=void 0;class e{_registry=new Map;_defaultTabs=new Set;_legacyDetailsPanelRegistry=new Set;_detailsPanelRegistry=new Set;_currentTabs=new Map;[Symbol.dispose](){for(const e of this._currentTabs.values())this.disposeTab(e);this._currentTabs.clear()}registerTab(e){return this._registry.set(e.uri,e),{[Symbol.dispose]:()=>this._registry.delete(e.uri)}}addDefaultTab(e){return this._defaultTabs.add(e),{[Symbol.dispose]:()=>this._defaultTabs.delete(e)}}registerLegacyDetailsPanel(e){return this._legacyDetailsPanelRegistry.add(e),{[Symbol.dispose]:()=>this._legacyDetailsPanelRegistry.delete(e)}}registerDetailsPanel(e){return this._detailsPanelRegistry.add(e),{[Symbol.dispose]:()=>this._detailsPanelRegistry.delete(e)}}resolveTab(e){return this._registry.get(e)}get tabs(){return Array.from(this._registry.values())}get defaultTabs(){return Array.from(this._defaultTabs)}get legacyDetailsPanels(){return Array.from(this._legacyDetailsPanelRegistry)}get detailsPanels(){return Array.from(this._detailsPanelRegistry)}resolveTabs(e){const r=new Map,n=[];e.forEach(e=>{var t=this._registry.get(e);n.push({uri:e,tab:t}),t&&r.set(e,t)});for(var[t,a]of r)this._currentTabs.get(t)||this.initTab(a);for(var[i,o]of this._currentTabs)r.get(i)||this.disposeTab(o);return this._currentTabs=r,n}initTab(e){e.onShow?.()}disposeTab(e){e.onHide?.(),e.isEphemeral&&this._registry.delete(e.uri)}}Da.TabManager=e}return Da}();const u=Fa();var d=$a();const f=uo(),p=ie(),h=function(){if(!ho){ho=1,Object.defineProperty(go,"__esModule",{value:!0}),go.ServiceWorkerController=void 0;const t=ee(),r=ie(),n="BYPASS_SERVICE_WORKER";class a{static async isBypassed(){try{return await caches.has(n)}catch(e){return!1}}static async setBypass(e){try{e?await caches.open(n):await caches.delete(n)}catch(e){}}}go.ServiceWorkerController=class{servingRoot;_bypassed=!1;_installing=!1;constructor(e){this.servingRoot=e}async setBypass(e){if("serviceWorker"in navigator){if(this._bypassed=e){await a.setBypass(!0);for(const t of await navigator.serviceWorker.getRegistrations())await t.unregister()}else await a.setBypass(!1),window.localStorage&&window.localStorage.setItem("bypassDisabled","1"),this.install();r.raf.scheduleFullRedraw()}}onStateChange(e){r.raf.scheduleFullRedraw(),"installing"===e.state?this._installing=!0:"activated"===e.state&&(this._installing=!1)}monitorWorker(e){e&&(e.addEventListener("error",e=>(0,t.reportError)(e)),e.addEventListener("statechange",()=>this.onStateChange(e)),this.onStateChange(e))}async install(){var e,t,r=this.servingRoot.split("/").slice(-2)[0];"serviceWorker"in navigator&&"/"===location.pathname&&(e=location.hostname,e=["127.0.0.1","::1","localhost"].includes(e),t=window.localStorage&&"1"===window.localStorage.getItem("bypassDisabled"),e&&!t&&await this.setBypass(!0),await a.isBypassed()?(this._bypassed=!0,console.log("Skipping service worker registration, disabled by the user")):navigator.serviceWorker.register("/service_worker.js?v="+r).then(e=>{this.monitorWorker(e.installing),this.monitorWorker(e.active),e.addEventListener("updatefound",()=>{this.monitorWorker(e.installing)})}))}get bypassed(){return this._bypassed}get installing(){return this._installing}}}return go}(),g=Ao(),m=function(){if(!No){No=1,Object.defineProperty(ko,"__esModule",{value:!0}),ko.Timeline=void 0;const n=ee(),r=Mo(),a=ie();var e=xo();ko.Timeline=class{_visibleWindow;traceSpan;store;areaY={};_selectedArea;constructor(e,t){this.store=e,this.traceSpan=t,this._visibleWindow=r.HighPrecisionTimeSpan.fromTime(t.start,t.end)}rateLimitedPoker=(0,e.ratelimit)(()=>this.store.edit(()=>{}),50);zoomVisibleWindow(e,t){this._visibleWindow=this._visibleWindow.scale(e,t,10).fitWithin(this.traceSpan.start,this.traceSpan.end),this.rateLimitedPoker()}panVisibleWindow(e){this._visibleWindow=this._visibleWindow.translate(e).fitWithin(this.traceSpan.start,this.traceSpan.end),this.rateLimitedPoker()}selectArea(e,t,r=this._selectedArea?this._selectedArea.tracks:[]){(0,n.assertTrue)(e<=t,`Impossible select area: start [${e}] >= end [${t}]`),this._selectedArea={start:e,end:t,tracks:r},a.raf.scheduleFullRedraw()}deselectArea(){this._selectedArea=void 0,a.raf.scheduleRedraw()}get selectedArea(){return this._selectedArea}updateVisibleTime(e){this.updateVisibleTimeHP(r.HighPrecisionTimeSpan.fromTime(e.start,e.end))}updateVisibleTimeHP(e){this._visibleWindow=e.clampDuration(10).fitWithin(this.traceSpan.start,this.traceSpan.end),this.rateLimitedPoker()}get visibleWindow(){return this._visibleWindow}}}return ko}();var _=ua();const y=z();var T=Uo(),b=Go();const v=qo(),E=fs();var S=Or();const A=1n,O=30000n;a.defaultTraceContext={traceTitle:"",traceUrl:"",start:o.Time.ZERO,end:o.Time.fromSeconds(10),realtimeOffset:o.Time.ZERO,utcOffset:o.Time.ZERO,traceTzOffset:o.Time.ZERO,cpus:[],gpuCount:0};function C(e){return(0,y.exists)(e.ts)&&(0,y.exists)(e.dur)?-1n===e.dur?{start:e.ts,end:o.Time.add(e.ts,O)}:0n===e.dur?{start:e.ts,end:o.Time.add(e.ts,A)}:{start:e.ts,end:o.Time.add(e.ts,e.dur)}:{start:o.Time.INVALID,end:o.Time.INVALID}}a.globals=new class{root=(0,v.getServingRoot)();_testing=!1;_dispatchMultiple=void 0;_store=(0,t.createStore)((0,r.createEmptyState)());_timeline=void 0;_serviceWorkerController=void 0;_logging=void 0;_isInternalUser=void 0;_trackDataStore=void 0;_queryResults=void 0;_overviewStore=void 0;_aggregateDataStore=void 0;_threadMap=void 0;_sliceDetails=void 0;_threadStateDetails=void 0;_connectedFlows=void 0;_selectedFlows=void 0;_visibleFlowCategories=void 0;_cpuProfileDetails=void 0;_numQueriesQueued=0;_bufferUsage=void 0;_recordingLog=void 0;_traceErrors=void 0;_metricError=void 0;_metricResult=void 0;_jobStatus=void 0;_embeddedMode=void 0;_hideSidebar=void 0;_cmdManager=new e.CommandManager;_tabManager=new c.TabManager;_trackManager=new d.TrackManager(this._store);_selectionManager=new _.SelectionManager(this._store);_hasFtrace=!1;_searchOverviewTrack;omnibox=new T.OmniboxManager;areaFlamegraphCache=new b.LegacyFlamegraphCache("area");scrollToTrackKey;httpRpcState={connected:!1};showPanningHint=!1;permalinkHash;showTraceErrorPopup=!0;traceContext=a.defaultTraceContext;sidebarMenuItems=new S.Registry(e=>e.commandId);async onTraceLoad(e,t){var{start:t,end:r}=this.traceContext=t,t=new o.TimeSpan(t,r);this._timeline=new m.Timeline(this._store,t),this._searchOverviewTrack=await(0,E.createSearchOverviewTrack)(e,this)}restoreAppStateAfterTraceLoad;_sourceFileStorage=void 0;_inVscode=void 0;_publishRedraw=void 0;_currentSearchResults={eventIds:new Float64Array(0),tses:new BigInt64Array(0),utids:new Float64Array(0),trackKeys:[],sources:[],totalResults:0};engines=new Map;constructor(){var{start:e,end:t}=a.defaultTraceContext;this._timeline=new m.Timeline(this._store,new o.TimeSpan(e,t))}initialize(e){this._dispatchMultiple=e,(0,f.setPerfHooks)(()=>this.state.perfDebug,()=>this.dispatch(n.Actions.togglePerfDebug({}))),this._serviceWorkerController=new h.ServiceWorkerController((0,v.getServingRoot)()),this._testing=self.location&&0<=self.location.search.indexOf("testing=1"),this._logging=(0,g.initAnalytics)(),this._trackDataStore=new Map,this._queryResults=new Map,this._overviewStore=new Map,this._aggregateDataStore=new Map,this._threadMap=new Map,this._sliceDetails={},this._connectedFlows=[],this._selectedFlows=[],this._visibleFlowCategories=new Map,this._threadStateDetails={},this._cpuProfileDetails={},this._sourceFileStorage={},this._inVscode=!1,this.engines.clear(),this._selectionManager.clear()}initStore(e){this._store=(0,t.createStore)(e)}get publishRedraw(){return this._publishRedraw||(()=>{})}set publishRedraw(e){this._publishRedraw=e}get state(){return(0,i.assertExists)(this._store).state}get store(){return(0,i.assertExists)(this._store)}dispatch(e){this.dispatchMultiple([e])}dispatchMultiple(e){(0,i.assertExists)(this._dispatchMultiple)(e)}get timeline(){return(0,i.assertExists)(this._timeline)}get logging(){return(0,i.assertExists)(this._logging)}get serviceWorkerController(){return(0,i.assertExists)(this._serviceWorkerController)}get overviewStore(){return(0,i.assertExists)(this._overviewStore)}get trackDataStore(){return(0,i.assertExists)(this._trackDataStore)}get queryResults(){return(0,i.assertExists)(this._queryResults)}get threads(){return(0,i.assertExists)(this._threadMap)}get sliceDetails(){return(0,i.assertExists)(this._sliceDetails)}set sliceDetails(e){this._sliceDetails=(0,i.assertExists)(e)}get threadStateDetails(){return(0,i.assertExists)(this._threadStateDetails)}set threadStateDetails(e){this._threadStateDetails=(0,i.assertExists)(e)}get connectedFlows(){return(0,i.assertExists)(this._connectedFlows)}set connectedFlows(e){this._connectedFlows=(0,i.assertExists)(e)}get selectedFlows(){return(0,i.assertExists)(this._selectedFlows)}set selectedFlows(e){this._selectedFlows=(0,i.assertExists)(e)}get visibleFlowCategories(){return(0,i.assertExists)(this._visibleFlowCategories)}set visibleFlowCategories(e){this._visibleFlowCategories=(0,i.assertExists)(e)}get aggregateDataStore(){return(0,i.assertExists)(this._aggregateDataStore)}get traceErrors(){return this._traceErrors}setTraceErrors(e){this._traceErrors=e}get metricError(){return this._metricError}setMetricError(e){this._metricError=e}get metricResult(){return this._metricResult}setMetricResult(e){this._metricResult=e}get cpuProfileDetails(){return(0,i.assertExists)(this._cpuProfileDetails)}set cpuProfileDetails(e){this._cpuProfileDetails=(0,i.assertExists)(e)}get sourceFileStorage(){return(0,i.assertExists)(this._sourceFileStorage)}set sourceFileStorage(e){this._sourceFileStorage=e}get inVscode(){return(0,i.assertExists)(this._inVscode)}set inVscode(e){this._inVscode=e}set numQueuedQueries(e){this._numQueriesQueued=e}get numQueuedQueries(){return this._numQueriesQueued}get bufferUsage(){return this._bufferUsage}get recordingLog(){return this._recordingLog}get currentSearchResults(){return this._currentSearchResults}set currentSearchResults(e){this._currentSearchResults=e}set hasFtrace(e){this._hasFtrace=e}get hasFtrace(){return this._hasFtrace}get searchOverviewTrack(){return this._searchOverviewTrack}getConversionJobStatus(e){return this.getJobStatusMap().get(e)??s.ConversionJobStatus.NotRunning}setConversionJobStatus(e,t){var r=this.getJobStatusMap();t===s.ConversionJobStatus.NotRunning?r.delete(e):r.set(e,t)}getJobStatusMap(){return this._jobStatus||(this._jobStatus=new Map),this._jobStatus}get embeddedMode(){return!!this._embeddedMode}set embeddedMode(e){this._embeddedMode=e}get hideSidebar(){return!!this._hideSidebar}set hideSidebar(e){this._hideSidebar=e}setBufferUsage(e){this._bufferUsage=e}setTrackData(e,t){this.trackDataStore.set(e,t)}setRecordingLog(e){this._recordingLog=e}setAggregateData(e,t){this.aggregateDataStore.set(e,t)}getCurrentEngine(){return this.state.engine}makeSelection(e,t={}){var{switchToCurrentSelectionTab:t=!0,clearSearch:r=!0}=t;r&&a.globals.dispatch(n.Actions.setSearchIndex({index:-1})),t&&a.globals.dispatch(n.Actions.showTab({uri:"current_selection"})),a.globals.dispatch(e)}setLegacySelection(e,t={}){this._selectionManager.setLegacy(e),this.handleSelectionArgs(t)}selectSingleEvent(e,t,r={}){this._selectionManager.setEvent(e,t),this.handleSelectionArgs(r)}handleSelectionArgs(e={}){var{clearSearch:e=!0,switchToCurrentSelectionTab:t=!0,pendingScrollId:r=void 0}=e;e&&a.globals.dispatch(n.Actions.setSearchIndex({index:-1})),void 0!==r&&a.globals.dispatch(n.Actions.setPendingScrollId({pendingScrollId:r})),t&&a.globals.dispatch(n.Actions.showTab({uri:"current_selection"}))}clearSelection(){a.globals.dispatch(n.Actions.setSearchIndex({index:-1})),this._selectionManager.clear()}resetForTesting(){this._dispatchMultiple=void 0,this._timeline=void 0,this._serviceWorkerController=void 0,this._trackDataStore=void 0,this._queryResults=void 0,this._overviewStore=void 0,this._threadMap=void 0,this._sliceDetails=void 0,this._threadStateDetails=void 0,this._aggregateDataStore=void 0,this._numQueriesQueued=0,this._metricResult=void 0,this._currentSearchResults={eventIds:new Float64Array(0),tses:new BigInt64Array(0),utids:new Float64Array(0),trackKeys:[],sources:[],totalResults:0}}get isInternalUser(){return void 0===this._isInternalUser&&(this._isInternalUser="1"===localStorage.getItem("isInternalUser")),this._isInternalUser}set isInternalUser(e){localStorage.setItem("isInternalUser",e?"1":"0"),this._isInternalUser=e,p.raf.scheduleFullRedraw()}get testing(){return this._testing}shutdown(){p.raf.shutdown()}get commandManager(){return(0,i.assertExists)(this._cmdManager)}get tabManager(){return this._tabManager}get trackManager(){return this._trackManager}timestampOffset(){var e=(0,u.timestampFormat)();switch(e){case u.TimestampFormat.Timecode:case u.TimestampFormat.Seconds:return this.traceContext.start;case u.TimestampFormat.Raw:case u.TimestampFormat.RawLocale:return o.Time.ZERO;case u.TimestampFormat.UTC:return this.traceContext.utcOffset;case u.TimestampFormat.TraceTz:return this.traceContext.traceTzOffset;default:throw new Error("Unsupported format "+e)}}toDomainTime(e){return o.Time.sub(e,this.timestampOffset())}async findTimeRangeOfSelection(){var e=a.globals.state.selection;if("area"===e.kind)return e;if("note"===e.kind){var t=this.state.notes[e.id];if(t){var r=t.noteType;switch(r){case"SPAN":return{start:t.start,end:t.end};case"DEFAULT":return{start:t.timestamp,end:o.Time.add(t.timestamp,A)};default:(0,i.assertUnreachable)(r)}}}else if("single"===e.kind){var n=a.globals.state.tracks[e.trackKey]?.uri;if(n){n=await a.globals.trackManager.resolveTrackInfo(n)?.getEventBounds?.(e.eventId);if(n)return{start:n.ts,end:o.Time.add(n.ts,n.dur)}}return}e=(0,l.getLegacySelection)(this.state);return null!==e?"SCHED_SLICE"===e.kind||"SLICE"===e.kind?C(this.sliceDetails):"THREAD_STATE"===e.kind?C(this.threadStateDetails):"LOG"!==e.kind&&"GENERIC_SLICE"===e.kind?C({ts:e.start,dur:e.duration}):void 0:void 0}}}(jr)),jr}var ps,hs={},gs={};function ms(){if(!ps){ps=1,Object.defineProperty(gs,"__esModule",{value:!0}),gs.BottomTabToTabAdapter=gs.BottomTabToSCSAdapter=void 0,gs.getTrackName=function(e){var{name:e,upid:t,utid:r,processName:n,threadName:a,pid:i,tid:o,userName:s,uid:l,kind:c,threadTrack:u,uidTrack:d}=e,f=null!=e&&"[NULL]"!==e,p=null!=t,h=null!=r,g=null!=n,m=null!=a,_=null!=s,y=null!=o,T=null!=i,b=null!=l,v=void 0!==c,u=void 0!==u&&u,d=void 0!==d&&d,E=v?` (${c})`:"";{if(u&&f&&y)return e+` (${o})`;if(d&&f&&_)return e+` (${s})`;if(d&&f&&b)return e+" "+l;if(f)return""+e;if(p&&T&&g)return n+" "+i;if(p&&T)return"Process "+i;if(m&&y)return a+" "+o;if(y)return"Thread "+o;if(p)return"upid: "+t+E;if(h)return"utid: "+r+E;if(b)return"uid: "+l+E;if(v)return"Unnamed "+c}return"Unknown"},gs.getThreadOrProcUri=function(e,t){{if((0,r.exists)(e))return"/process_"+e;if((0,r.exists)(t))return"/thread_"+t;throw new Error("No upid or utid defined...")}},gs.getThreadUriPrefix=function(e,t){return(0,r.exists)(e)?`/process_${e}/thread_`+t:"/thread_"+t};const r=z();gs.BottomTabToSCSAdapter=class{oldSelection;bottomTab;attrs;constructor(e){this.attrs=e}render(e){return e!==this.oldSelection&&(this.oldSelection=e,this.bottomTab=this.attrs.tabFactory(e)),this.bottomTab?.renderPanel()}isLoading(){return this.bottomTab?.isLoading()??!1}};gs.BottomTabToTabAdapter=class{bottomTab;constructor(e){this.bottomTab=e}getTitle(){return this.bottomTab.getTitle()}render(){return this.bottomTab.viewTab()}}}return gs}var _s,ys={},Ts={};function P(){var t,e;return _s||(_s=1,t=Ts,Object.defineProperty(t,"__esModule",{value:!0}),t.uuidv4=void 0,t.uuidv4Sql=function(e){e=e??(0,t.uuidv4)();return e.replace(/[^a-zA-Z0-9_]+/g,"_")},e=Er(),t.uuidv4=e.v4),Ts}var bs,vs={},Es={},Ss={};function As(){return bs||(bs=1,Object.defineProperty(Ss,"__esModule",{value:!0}),Ss.generateSqlWithInternalLayout=function(e){let t="SELECT "+e.columns.toString()+`, internal_layout(${e.ts}, ${e.dur}) OVER (ORDER BY `+e.ts+" ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS depth FROM "+e.sourceTable;void 0!==e.whereClause&&(t+=" WHERE "+e.whereClause);void 0!==e.orderByClause&&(t+=" ORDER BY "+e.orderByClause);return t}),Ss}var Os,Cs={},ks={},ws={};function Rs(){if(!Os){Os=1,Object.defineProperty(ws,"__esModule",{value:!0}),ws.drawDoubleHeadedArrow=function(e,t,r,n,a,i=2,o="black"){e.beginPath(),e.lineWidth=i,e.lineCap="round",e.strokeStyle=o,e.moveTo(t,r),e.lineTo(t+n,r),e.stroke(),e.closePath(),a&&(e.beginPath(),e.moveTo(t+n-8,r-4),e.lineTo(t+n,r),e.lineTo(t+n-8,r+4),e.stroke(),e.closePath(),e.beginPath(),e.moveTo(t+8,r-4),e.lineTo(t,r),e.lineTo(t+8,r+4),e.stroke(),e.closePath())},ws.drawIncompleteSlice=function(e,t,r,n,a,i=!0){if(!(n<=0||a<=0)){e.beginPath();var o=a/4,o=(e.moveTo(t,r),e.lineTo(t+n,r),e.lineTo(t+n-3,r+.5*o),e.lineTo(t+n,r+o),e.lineTo(t+n-3,r+1.5*o),e.lineTo(t+n,r+2*o),e.lineTo(t+n-3,r+2.5*o),e.lineTo(t+n,r+3*o),e.lineTo(t+n-3,r+3.5*o),e.lineTo(t+n,r+4*o),e.lineTo(t,r+a),e.fillStyle);if(!(0,s.isString)(o))throw new Error("drawIncompleteSlice() expects fillStyle to be a simple color not "+o);i&&((i=e.createLinearGradient(t,r,t+n,r+a)).addColorStop(.66,o),i.addColorStop(1,"#FFFFFF"),e.fillStyle=i),e.fill(),e.fillStyle=o}},ws.drawTrackHoverTooltip=function(e,t,r,n,a){e.font="10px Roboto Condensed",e.textBaseline="middle",e.textAlign="left";var i=e.measureText(n),o=e.measureText(a??"");let s=Math.max(i.width,o.width),l=(s+=8,0);l=(l+=i.fontBoundingBoxAscent)+i.fontBoundingBoxDescent,void 0!==a&&(l=(l+=o.fontBoundingBoxAscent)+o.fontBoundingBoxDescent);l+=8;let c=t.x,u=t.y;c+=10,u-=10;t=r.width;c+s>t&&(c-=c+s-t);u<0&&(u=0);u+l>r.height&&(u-=u+l-r.height);e.fillStyle="rgba(255, 255, 255, 0.9)",e.fillRect(c,u,s,l),e.fillStyle="hsl(200, 50%, 40%)",e.fillText(n,c+4,u+4+i.fontBoundingBoxAscent),void 0!==a&&(t=i.fontBoundingBoxAscent+i.fontBoundingBoxDescent+o.fontBoundingBoxAscent,e.fillText(a,c+4,u+4+t))},ws.canvasClip=function(e,t,r,n,a){e.beginPath(),e.rect(t,r,n,a),e.clip()};const s=te()}return ws}var Is,Ms={};function Ps(){if(!Is){Is=1,Object.defineProperty(Ms,"__esModule",{value:!0}),Ms.checkerboard=o,Ms.checkerboardExcept=function(e,t,r,n,a,i){i<=r||n<=a?o(e,t,r,n):(r<a&&o(e,t,r,a),i<n&&o(e,t,i,n))};const s="Loading...";let i=0;function o(e,t,r,n){var n=n-r,a=(e.font="12px Roboto Condensed",e.fillStyle="#eee",e.fillRect(r,0,n,t),e.fillStyle="#666",e.textBaseline);e.textBaseline="middle",(i=0===i?e.measureText(s).width:i)<=n&&e.fillText(s,r+n/2-i/2,t/2),e.textBaseline=a}}return Ms}var Ns,Ds={};function xs(){var e;return Ns||(Ns=1,e=Ds,Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_SLICE_LAYOUT=e.SLICE_LAYOUT_FLAT_DEFAULTS=e.SLICE_LAYOUT_FIT_CONTENT_DEFAULTS=e.SLICE_LAYOUT_FIXED_DEFAULTS=e.SLICE_LAYOUT_BASE_DEFAULTS=void 0,e.SLICE_LAYOUT_BASE_DEFAULTS=Object.freeze({padding:3,rowSpacing:0}),e.SLICE_LAYOUT_FIXED_DEFAULTS=Object.freeze({...e.SLICE_LAYOUT_BASE_DEFAULTS,heightMode:"FIXED",fixedHeight:30}),e.SLICE_LAYOUT_FIT_CONTENT_DEFAULTS=Object.freeze({...e.SLICE_LAYOUT_BASE_DEFAULTS,heightMode:"FIT_CONTENT",sliceHeight:18}),e.SLICE_LAYOUT_FLAT_DEFAULTS=Object.freeze({...e.SLICE_LAYOUT_BASE_DEFAULTS,depthGuess:0,isFlat:!0,heightMode:"FIXED",fixedHeight:18,titleSizePx:10,padding:3}),e.DEFAULT_SLICE_LAYOUT=e.SLICE_LAYOUT_FIT_CONTENT_DEFAULTS),Ds}var Ls,Fs,Us={};function Bs(){if(!Ls){Ls=1;{var a=Us;Object.defineProperty(a,"__esModule",{value:!0}),a.CacheKey=a.BUCKETS_PER_PIXEL=void 0;const i=Rr(),o=K();a.BUCKETS_PER_PIXEL=2;a.CacheKey=class s{start;end;bucketSize;windowSizePx;static create(e,t,r){var n=(t-e)/BigInt(Math.round(r*a.BUCKETS_PER_PIXEL));return new s(e,t,i.BigintMath.max(1n,n),r)}constructor(e,t,r,n){this.start=e,this.end=t,this.bucketSize=r,this.windowSizePx=n}static zero(){return new s(o.Time.ZERO,o.Time.ZERO,0n,100)}get normalizedBucketNs(){return i.BigintMath.max(1n,i.BigintMath.bitFloor(this.bucketSize))}get normalizedWindowSizePx(){return Math.max(100,100*Math.round(this.windowSizePx/100))}normalize(){var e=this.normalizedWindowSizePx,t=this.normalizedBucketNs,r=BigInt(e*a.BUCKETS_PER_PIXEL)*t,n=o.Time.quantFloor(this.start,r),r=o.Time.quantCeil(this.end,r);return new s(n,r,t,e)}isNormalized(){return this.toString()===this.normalize().toString()}isCoveredBy(e){return e.start<=this.start&&e.end>=this.end&&e.normalizedBucketNs===this.normalizedBucketNs&&e.normalizedWindowSizePx===this.normalizedWindowSizePx}toString(){return`CacheKey<${this.start}, ${this.end}, ${this.bucketSize}, ${this.windowSizePx}>`}}}}return Us}function js(){if(!Fs){Fs=1;{var N=ks;Object.defineProperty(N,"__esModule",{value:!0}),N.BaseSliceTrack=N.BASE_ROW=N.filterVisibleSlicesForTesting=N.FADE_THIN_SLICES_FLAG=N.CROP_INCOMPLETE_SLICE_FLAG=N.SLICE_FLAGS_INSTANT=N.SLICE_FLAGS_INCOMPLETE=void 0;const o=ee(),D=mn(),s=K(),l=z(),c=ne(),x=Rs(),L=J(),F=_n();var e=M();const U=Y();var t=re();const u=ie();var r=Z();const B=Ps(),j=oe();var n=xs();const d=Bs();var a=P();const f=V(),H=(N.SLICE_FLAGS_INCOMPLETE=1,N.SLICE_FLAGS_INSTANT=2,1/d.BUCKETS_PER_PIXEL),p=e.UNEXPECTED_PINK;function i(e,t,r){var n=e[0];return(0,l.exists)(n)&&n.startNs>r?[]:e.filter(e=>e.startNs<=r&&e.endNs>=t)}N.CROP_INCOMPLETE_SLICE_FLAG=t.featureFlags.register({id:"cropIncompleteSlice",name:"Crop incomplete slices",description:"Display incomplete slices in short form",defaultValue:!1}),N.FADE_THIN_SLICES_FLAG=t.featureFlags.register({id:"fadeThinSlices",name:"Fade thin slices",description:"Display sub-pixel slices in a faded way",defaultValue:!1}),N.filterVisibleSlicesForTesting=i,N.BASE_ROW={id:r.NUM,ts:r.LONG,dur:r.LONG,tsQ:r.LONG,durQ:r.LONG,depth:r.NUM};N.BaseSliceTrack=class{sliceLayout={...n.DEFAULT_SLICE_LAYOUT};engine;trackKey;trackUuid=(0,a.uuidv4Sql)();slicesKey=d.CacheKey.zero();slices=new Array;incomplete=new Array;selectedSlice;extraSqlColumns;charWidth=-1;hoverPos;hoveredSlice;hoverTooltip=[];maxDataDepth=0;computedTrackHeight=0;computedSliceHeight=0;computedRowSpacing=0;trash;async onInit(){}onSliceOver(e){}onSliceOut(e){}onSliceClick(e){}onUpdatedSlices(e){this.highlightHovererdAndSameTitle(e)}drawSchedLatencyArrow(e,t){}constructor(e){this.engine=e.engine,this.trackKey=e.trackKey;e=Object.keys(this.getRowSpec());const t=Object.keys(N.BASE_ROW);this.extraSqlColumns=e.filter(e=>!t.includes(e)),this.trash=new f.AsyncDisposableStack}setSliceLayout(e){var t,r;if(e.isFlat&&void 0!==e.depthGuess&&0!==e.depthGuess)throw{isFlat:t,depthGuess:r}=e,new Error(`if isFlat (${t}) then depthGuess (${r}) must be 0 if defined`);this.sliceLayout=e}onFullRedraw(){this.onUpdatedSlices(this.slices),this.onUpdatedSlices(this.incomplete),void 0!==this.selectedSlice&&this.onUpdatedSlices([this.selectedSlice])}isSelectionHandled(e){return["SCHED_SLICE","SLICE"].includes(e.kind)}getTitleFont(){return(this.sliceLayout.titleSizePx??12)+"px Roboto Condensed"}getSubtitleFont(){return(this.sliceLayout.subtitleSizePx??8)+"px Roboto Condensed"}getTableName(){return"slice_"+this.trackUuid}async onCreate(){var e=await this.onInit(),e=(e&&this.trash.use(e),this.extraSqlColumns.join(","));let t;t=N.CROP_INCOMPLETE_SLICE_FLAG.get()?await this.engine.query(`
          select
            ${this.depthColumn()},
            ts as tsQ,
            ts,
            -1 as durQ,
            -1 as dur,
            id
            ${e?","+e:""}
          from (${this.getSqlSource()})
          where dur = -1;
        `):await this.engine.query(`
        select
          ${this.depthColumn()},
          max(ts) as tsQ,
          ts,
          -1 as durQ,
          -1 as dur,
          id
          ${e?","+e:""}
        from (${this.getSqlSource()})
        group by 1
        having dur = -1
      `);var r=new Array(t.numRows()),n=t.iter(this.getRowSpec());for(let e=0;n.valid();n.next(),++e)r[e]=this.rowToSliceInternal(n);this.onUpdatedSlices(r),this.incomplete=r,await this.engine.query(`
      create virtual table ${this.getTableName()}
      using __intrinsic_slice_mipmap((
        select id, ts, dur, ${this.depthColumn()}
        from (${this.getSqlSource()})
        where dur != -1
      ));
    `),this.trash.defer(async()=>{await this.engine.tryQuery("drop table "+this.getTableName())})}async onUpdate({visibleWindow:e,size:t}){t=Math.max(1,t.width),e=e.toTimeSpan(),e=d.CacheKey.create(e.start,e.end,t);await this.maybeRequestData(e)}render({ctx:e,size:t,visibleWindow:r,timescale:n}){let a=this.charWidth;a<0&&(e.font=this.getTitleFont(),a=this.charWidth=e.measureText("dbpqaouk").width/8);r=this.getVisibleSlicesInternal(r.start.toTime("floor"),r.end.toTime("ceil"));let i=(0,U.getLegacySelection)(j.globals.state);var o=(i=i&&this.isSelectionHandled(i)?i:null)?i.id:void 0;void 0===o&&(this.selectedSlice=void 0);let s;var l=this.computedSliceHeight,c=this.sliceLayout.padding,u=this.computedRowSpacing,d=t.width;for(const w of r){if(w.x=n.timeToPx(w.startNs),w.w=n.durationToPx(w.durNs),w.flags&N.SLICE_FLAGS_INSTANT)w.x-=5,w.w=10;else if(w.flags&N.SLICE_FLAGS_INCOMPLETE){let e;N.CROP_INCOMPLETE_SLICE_FLAG.get()?(e=0<w.x?Math.min(d,20):Math.max(0,20+w.x),w.x=Math.max(w.x,0)):(w.x=Math.max(w.x,0),e=d-w.x),w.w=e}else{var f=Math.min(w.x+w.w,d);w.x=Math.max(w.x,0),w.w=f-w.x}o===w.id&&(s=w)}var p,h,g,m,_,y,T,b,v,E,S,A=r.slice();A.sort((e,t)=>(0,F.colorCompare)(e.colorScheme.base,t.colorScheme.base));let O=void 0;for(const R of A){var C,k=(R.isHighlighted?R.colorScheme.variant:R.colorScheme.base).cssString,k=(k!==O&&(O=k,e.fillStyle=k),c+R.depth*(l+u));R.flags&N.SLICE_FLAGS_INSTANT?this.drawChevron(e,R.x,k,l):R.flags&N.SLICE_FLAGS_INCOMPLETE?(C=N.CROP_INCOMPLETE_SLICE_FLAG.get()?R.w:Math.max(R.w-2,2),(0,x.drawIncompleteSlice)(e,R.x,k,C,l,!N.CROP_INCOMPLETE_SLICE_FLAG.get())):(C=Math.max(R.w,N.FADE_THIN_SLICES_FLAG.get()?.1:H),e.fillRect(R.x,k,C,l))}e.fillStyle="#FFFFFF50";for(const I of A)I.flags&(N.SLICE_FLAGS_INCOMPLETE|N.SLICE_FLAGS_INSTANT)||(p=(0,D.clamp)(I.fillRatio,0,1),(0,D.floatEqual)(p,1))||(p=(g=Math.max(I.w,H))*(1-p))<1||(h=c+I.depth*(l+u),g=I.x+(g-p),e.fillRect(g,h,p,l));e.textAlign="center",e.font=this.getTitleFont(),e.textBaseline="middle";for(const M of r)M.flags&N.SLICE_FLAGS_INSTANT||!M.title||M.w<5||(m=M.isHighlighted?M.colorScheme.textVariant:M.colorScheme.textBase,e.fillStyle=m.cssString,m=(0,L.cropText)(M.title,a,M.w),_=M.x+M.w/2,T=c+M.depth*(l+u),y=M.subTitle?3:2,T=Math.floor(T+l/y)+.5,e.fillText(m,_,T));e.fillStyle="rgba(255, 255, 255, 0.6)",e.font=this.getSubtitleFont();for(const P of r)P.w<5||!P.subTitle||P.flags&N.SLICE_FLAGS_INSTANT||(b=P.x+P.w/2,v=(0,L.cropText)(P.subTitle,a,P.w),E=c+P.depth*(l+u),E=Math.ceil(E+2*l/3)+1.5,e.fillText(v,b,E));void 0!==s&&(r=(A=this.selectedSlice=s).colorScheme,S=c+A.depth*(l+u),e.strokeStyle=r.base.setHSL({s:100,l:10}).cssString,e.beginPath(),e.lineWidth=3,e.strokeRect(A.x,S-1.5,A.w,l+3),e.closePath()),(0,B.checkerboardExcept)(e,this.getHeight(),0,t.width,n.timeToPx(this.slicesKey.start),n.timeToPx(this.slicesKey.end)),this.drawSchedLatencyArrow(e,this.selectedSlice);r=this.hoverTooltip;void 0!==this.hoveredSlice&&0<r.length&&void 0!==this.hoverPos&&(1===r.length?(0,x.drawTrackHoverTooltip)(e,this.hoverPos,t,r[0]):(0,x.drawTrackHoverTooltip)(e,this.hoverPos,t,r[0],r[1]))}async onDestroy(){await this.trash.asyncDispose()}async maybeRequestData(e){if(!e.isCoveredBy(this.slicesKey)){var r=e.normalize();if(!e.isCoveredBy(r))throw new Error(`Normalization error ${r.toString()} `+e.toString());var e=e.bucketSize,n=this.extraSqlColumns.join(","),e=await this.engine.query(`
      SELECT
        (z.ts / ${e}) * ${e} as tsQ,
        ((z.dur + ${e-1n}) / ${e}) * ${e} as durQ,
        s.ts as ts,
        s.dur as dur,
        s.id,
        z.depth
        ${n?","+n:""}
      FROM ${this.getTableName()}(
        ${r.start},
        ${r.end},
        ${r.bucketSize}
      ) z
      CROSS JOIN (${this.getSqlSource()}) s using (id)
    `),a=new Array,i=e.iter(this.getRowSpec());let t=this.maxDataDepth;this.slicesKey=r;for(let e=0;i.valid();i.next(),++e)-1n!==i.dur&&(t=Math.max(t,i.depth),a.push(this.rowToSliceInternal(i)));this.maxDataDepth=t,this.onUpdatedSlices(a),this.slices=a,u.raf.scheduleRedraw()}}rowToSliceInternal(e){e=this.rowToSlice(e);return this.selectedSlice?.id===e.id&&(this.selectedSlice=void 0),{...e,x:-1,w:-1}}rowToSliceBase(e){let t=0;return-1n===e.dur?t|=N.SLICE_FLAGS_INCOMPLETE:0n===e.dur&&(t|=N.SLICE_FLAGS_INSTANT),{id:e.id,startNs:s.Time.fromRaw(e.tsQ),endNs:s.Time.fromRaw(e.tsQ+e.durQ),durNs:e.durQ,ts:s.Time.fromRaw(e.ts),dur:e.dur,flags:t,depth:e.depth,title:"",subTitle:"",fillRatio:1,colorScheme:p,isHighlighted:!1}}findSlice({x:e,y:t,timescale:r}){var n=this.computedTrackHeight,a=this.computedSliceHeight,i=this.sliceLayout.padding,o=this.computedRowSpacing;if(0!==a){var s=Math.floor((t-i)/(a+o));if(i<=t&&t<=n-i)for(const u of this.slices)if(u.depth===s&&u.x<=e&&e<=u.x+u.w)return u;for(const d of this.incomplete){var l=N.CROP_INCOMPLETE_SLICE_FLAG.get()?r.timeToPx(d.startNs):d.x,c=!N.CROP_INCOMPLETE_SLICE_FLAG.get()||e<=l+20;if(d.depth===s&&l<=e&&c)return d}}}isFlat(){return this.sliceLayout.isFlat??!1}depthColumn(){return this.isFlat()?"0 as depth":"depth"}onMouseMove(e){var{x:t,y:r}=e;this.hoverPos={x:t,y:r},this.updateHoveredSlice(this.findSlice(e))}onMouseOut(){this.updateHoveredSlice(void 0)}updateHoveredSlice(e){var t=this.hoveredSlice;(this.hoveredSlice=e)!==t&&(void 0===this.hoveredSlice?(j.globals.dispatch(c.Actions.setHighlightedSliceId({sliceId:-1})),this.onSliceOut({slice:(0,o.assertExists)(t)}),this.hoverTooltip=[],this.hoverPos=void 0):(e={slice:this.hoveredSlice},j.globals.dispatch(c.Actions.setHighlightedSliceId({sliceId:this.hoveredSlice.id})),this.onSliceOver(e),this.hoverTooltip=e.tooltip||[]))}onMouseClick(e){e=this.findSlice(e);return void 0!==e&&(this.onSliceClick({slice:e}),!0)}getVisibleSlicesInternal(e,t){e=s.Time.sub(e,this.slicesKey.bucketSize),t=s.Time.add(t,this.slicesKey.bucketSize);let r=i(this.slices,e,t);return r=r.concat(this.incomplete),this.selectedSlice&&!this.slices.includes(this.selectedSlice)&&r.push(this.selectedSlice),r}updateSliceAndTrackHeight(){var e=this.sliceLayout,t=Math.max(this.maxDataDepth,e.depthGuess??0)+1;let r;r="FIXED"===e.heightMode?e.fixedHeight:2*e.padding+t*(e.sliceHeight+e.rowSpacing);let n,a=e.rowSpacing;"FIXED"===e.heightMode?(t=(r-2*e.padding)/t,n=Math.floor(Math.max(t-e.rowSpacing,.5)),a=Math.max(e.rowSpacing,t-n),a=Math.floor(2*a)/2):n=e.sliceHeight,this.computedSliceHeight=n,this.computedTrackHeight=r,this.computedRowSpacing=a}drawChevron(e,t,r,n){var a=t+5;e.beginPath(),e.moveTo(a,r),e.lineTo(t+10,r+n),e.lineTo(a,r+n-5),e.lineTo(t,r+n),e.lineTo(a,r),e.closePath(),e.fill()}highlightHovererdAndSameTitle(e){for(const r of e){var t=j.globals.state.highlightedSliceId===r.id||this.hoveredSlice&&this.hoveredSlice.title===r.title;r.isHighlighted=!!t}}getHeight(){return this.updateSliceAndTrackHeight(),this.computedTrackHeight}getSliceRect({visibleWindow:e,timescale:t,size:r},n,a,i){this.updateSliceAndTrackHeight();var r=r.width,o=Math.max(t.timeToPx(n),0),t=Math.min(t.timeToPx(a),r),r=e.overlaps(n,a),e=this.computedRowSpacing+this.computedSliceHeight;return{left:o,width:Math.max(t-o,1),top:this.sliceLayout.padding+i*e,height:this.computedSliceHeight,visible:r}}}}}return ks}var Hs,Gs={},Vs={};function Ws(){return Hs||(Hs=1,Object.defineProperty(Vs,"__esModule",{value:!0}),Vs.copyToClipboard=async function(t){try{await navigator.clipboard.writeText(t)}catch(e){console.error(`Failed to copy "${t}" to clipboard: `+e)}},Vs.download=function(e,t){var r=URL.createObjectURL(e),n=document.createElement("a");n.href=r,n.download=void 0===t?e.name:t,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r)}),Vs}var qs,$s={};function X(){if(!qs){qs=1,Object.defineProperty($s,"__esModule",{value:!0}),$s.Icons=void 0;$s.Icons=class{static ExternalLink="open_in_new";static UpdateSelection="call_made";static ChangeViewport="query_stats";static ContextMenu="arrow_drop_down";static Copy="content_copy";static Delete="delete";static SortedAsc="arrow_upward";static SortedDesc="arrow_downward";static GoBack="chevron_left";static GoForward="chevron_right";static AddColumn="add";static Close="close";static Hide="visibility_off";static Filter="filter_list";static BlankCheckbox="check_box_outline_blank";static Checkbox="check_box";static IndeterminateCheckbox="indeterminate_check_box";static ExpandDown="expand_more";static ExpandUp="expand_less";static Pin="push_pin";static LibraryAddCheck="library_add_check";static SelectAll="select_all";static Deselect="deselect";static Star="star";static ChangeTab="tab";static Crashed="warning";static Chart="bar_chart"}}return $s}var zs,Ks={};function se(){if(!zs){zs=1,Object.defineProperty(Ks,"__esModule",{value:!0}),Ks.Anchor=void 0;const a=or.__importDefault(ae());Ks.Anchor=class{view({attrs:e,children:t}){const{icon:r,...n}=e;return(0,a.default)("a.pf-anchor",n,r&&(0,a.default)("i.material-icons",r),t)}}}return Ks}var Ys,Js={},Zs={};function Qs(){return Ys||(Ys=1,Object.defineProperty(Zs,"__esModule",{value:!0}),Zs.classNames=function(...e){e=e.flat().filter(e=>e);if(0!==e.length)return e.join(" ")}),Zs}var Xs,el={};function tl(){if(!Xs){Xs=1,Object.defineProperty(el,"__esModule",{value:!0}),el.Gate=el.Passthrough=void 0,el.hasChildren=function({children:e}){return Array.isArray(e)&&0<e.length&&e.some(e=>e)};const r=or.__importDefault(ae());el.Passthrough={view({children:e}){return e}},el.Gate={view({attrs:e,children:t}){return(0,r.default)("",{style:{display:e.open?"contents":"none"}},t)}}}return el}var rl,nl={};function al(){if(!rl){rl=1,Object.defineProperty(nl,"__esModule",{value:!0}),nl.Icon=void 0;const a=or.__importDefault(ae());nl.Icon=class{view({attrs:e}){const{icon:t,filled:r,...n}=e;return(0,a.default)(r?"i.material-icons-filled":"i.material-icons",n,t)}}}return nl}var il,ol={},sl={};function ll(){var C,k,T,w,R,I,M,P,N,D,b,_,d,f,y,x,L,A,p,l,e,t,O,r,n,a,i,o,V,W,q,$,z,K,Y;return il||(il=1,Object.defineProperty(sl,"__esModule",{value:!0}),C=Math.max,k=Math.min,T=Math.round,P="auto",D="start",b="end",_="clippingParents",d="viewport",f="popper",y="reference",x=(N=[w="top",R="bottom",I="right",M="left"]).reduce(function(e,t){return e.concat([t+"-"+D,t+"-"+b])},[]),L=[].concat(N,[P]).reduce(function(e,t){return e.concat([t,t+"-"+D,t+"-"+b])},[]),A=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"],p={placement:"bottom",modifiers:[],strategy:"absolute"},O={top:"auto",right:"auto",bottom:"auto",left:"auto"},i={left:"right",right:"left",bottom:"top",top:"bottom"},o={start:"end",end:"start"},z=me({defaultModifiers:[e={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,r=e.instance,n=(e=e.options).scroll,a=void 0===n||n,i=void 0===(n=e.resize)||n,o=v(t.elements.popper),s=[].concat(t.scrollParents.reference,t.scrollParents.popper);return a&&s.forEach(function(e){e.addEventListener("scroll",r.update,l)}),i&&o.addEventListener("resize",r.update,l),function(){a&&s.forEach(function(e){e.removeEventListener("scroll",r.update,l)}),i&&o.removeEventListener("resize",r.update,l)}},data:{}},t={name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,e=e.name;t.modifiersData[e]=de({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},r={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,e=e.options,r=void 0===(r=e.gpuAcceleration)||r,n=void 0===(n=e.adaptive)||n,e=void 0===(e=e.roundOffsets)||e,r={placement:U(t.placement),variation:B(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:r,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,_e(Object.assign({},r,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:n,roundOffsets:e})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,_e(Object.assign({},r,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:e})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},n={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var a=e.state;Object.keys(a.elements).forEach(function(e){var t=a.styles[e]||{},r=a.attributes[e]||{},n=a.elements[e];c(n)&&u(n)&&(Object.assign(n.style,t),Object.keys(r).forEach(function(e){var t=r[e];!1===t?n.removeAttribute(e):n.setAttribute(e,!0===t?"":t)}))})},effect:function(e){var n=e.state,a={popper:{position:n.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(n.elements.popper.style,a.popper),n.styles=a,n.elements.arrow&&Object.assign(n.elements.arrow.style,a.arrow),function(){Object.keys(n.elements).forEach(function(e){var t=n.elements[e],r=n.attributes[e]||{},e=Object.keys((n.styles.hasOwnProperty(e)?n.styles:a)[e]).reduce(function(e,t){return e[t]="",e},{});c(t)&&u(t)&&(Object.assign(t.style,e),Object.keys(r).forEach(function(e){t.removeAttribute(e)}))})}},requires:["computeStyles"]}]}),Y=me({defaultModifiers:K=[e,t,r,n,a={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var o=e.state,t=e.options,e=e.name,s=void 0===(t=t.offset)?[0,0]:t,t=L.reduce(function(e,t){var r,n,a,i;return e[t]=(t=t,r=o.rects,n=s,a=U(t),i=0<=[M,w].indexOf(a)?-1:1,t=(r="function"==typeof n?n(Object.assign({},r,{placement:t})):n)[0]||0,n=(r[1]||0)*i,0<=[M,I].indexOf(a)?{x:n,y:t}:{x:t,y:n}),e},{}),r=(n=t[o.placement]).x,n=n.y;null!=o.modifiersData.popperOffsets&&(o.modifiersData.popperOffsets.x+=r,o.modifiersData.popperOffsets.y+=n),o.modifiersData[e]=t}},V={name:"flip",enabled:!0,phase:"main",fn:function(e){var d=e.state,t=e.options,e=e.name;if(!d.modifiersData[e]._skip){for(var r=t.mainAxis,n=void 0===r||r,r=t.altAxis,a=void 0===r||r,r=t.fallbackPlacements,f=t.padding,p=t.boundary,h=t.rootBoundary,i=t.altBoundary,o=t.flipVariations,g=void 0===o||o,m=t.allowedAutoPlacements,o=d.options.placement,t=U(o),r=r||(t===o||!g?[H(o)]:U(r=o)===P?[]:(t=H(r),[ye(r),t,ye(t)])),s=[o].concat(r).reduce(function(e,t){return e.concat(U(t)===P?(r=d,n=(e=e=void 0===(e={placement:t,boundary:p,rootBoundary:h,padding:f,flipVariations:g,allowedAutoPlacements:m})?{}:e).placement,a=e.boundary,i=e.rootBoundary,o=e.padding,s=e.flipVariations,l=void 0===(e=e.allowedAutoPlacements)?L:e,c=B(n),e=c?s?x:x.filter(function(e){return B(e)===c}):N,u=(n=0===(n=e.filter(function(e){return 0<=l.indexOf(e)})).length?e:n).reduce(function(e,t){return e[t]=j(r,{placement:t,boundary:a,rootBoundary:i,padding:o})[U(t)],e},{}),Object.keys(u).sort(function(e,t){return u[e]-u[t]})):t);var r,n,a,i,o,s,l,c,u},[]),l=d.rects.reference,c=d.rects.popper,u=new Map,_=!0,y=s[0],T=0;T<s.length;T++){var b=s[T],v=U(b),E=B(b)===D,S=0<=[w,R].indexOf(v),A=S?"width":"height",O=j(d,{placement:b,boundary:p,rootBoundary:h,altBoundary:i,padding:f}),S=S?E?I:M:E?R:w,E=(l[A]>c[A]&&(S=H(S)),H(S)),A=[];if(n&&A.push(O[v]<=0),a&&A.push(O[S]<=0,O[E]<=0),A.every(function(e){return e})){y=b,_=!1;break}u.set(b,A)}if(_)for(var C=g?3:1;0<C;C--)if("break"===function(t){var e=s.find(function(e){e=u.get(e);if(e)return e.slice(0,t).every(function(e){return e})});if(e)return y=e,"break"}(C))break;d.placement!==y&&(d.modifiersData[e]._skip=!0,d.placement=y,d.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!(l={passive:!0})}},W={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t,r,n,a,i,o,s,l,c,u=e.state,d=e.options,e=e.name,f=void 0===(f=d.mainAxis)||f,p=void 0!==(p=d.altAxis)&&p,h=d.boundary,g=d.rootBoundary,m=d.altBoundary,_=d.padding,y=void 0===(y=d.tether)||y,d=void 0===(d=d.tetherOffset)?0:d,h=j(u,{boundary:h,rootBoundary:g,padding:_,altBoundary:m}),g=U(u.placement),m=!(_=B(u.placement)),T=ue(g),b="x"===T?"y":"x",v=u.modifiersData.popperOffsets,E=u.rects.reference,S=u.rects.popper,d="number"==typeof(d="function"==typeof d?d(Object.assign({},u.rects,{placement:u.placement})):d)?{mainAxis:d,altAxis:d}:Object.assign({mainAxis:0,altAxis:0},d),A=u.modifiersData.offset?u.modifiersData.offset[u.placement]:null,O={x:0,y:0};v&&(f&&(f="y"===T?"height":"width",o=(s=v[T])+h[r="y"===T?w:M],l=s-h[c="y"===T?R:I],t=y?-S[f]/2:0,a=(_===D?E:S)[f],_=_===D?-S[f]:-E[f],i=u.elements.arrow,i=y&&i?ne(i):{width:0,height:0},r=(n=u.modifiersData["arrow#persistent"]?u.modifiersData["arrow#persistent"].padding:fe())[r],n=n[c],c=G(0,E[f],i[f]),i=m?E[f]/2-t-c-r-d.mainAxis:a-c-r-d.mainAxis,a=m?-E[f]/2+t+c+n+d.mainAxis:_+c+n+d.mainAxis,m=(r=u.elements.arrow&&F(u.elements.arrow))?"y"===T?r.clientTop||0:r.clientLeft||0:0,_=s+a-(t=null!=(f=null==A?void 0:A[T])?f:0),c=G(y?k(o,s+i-t-m):o,s,y?C(l,_):l),v[T]=c,O[T]=c-s),p&&(n="y"==b?"height":"width",a=(r=v[b])+h["x"===T?w:M],f=r-h["x"===T?R:I],i=-1!==[w,M].indexOf(g),m=null!=(t=null==A?void 0:A[b])?t:0,o=i?a:r-E[n]-S[n]-m+d.altAxis,_=i?r+E[n]+S[n]-m-d.altAxis:f,s=y&&i?(l=G(l=o,r,c=_),c<l?c:l):G(y?o:a,r,y?_:f),v[b]=s,O[b]=s-r),u.modifiersData[e]=O)},requiresIfExists:["offset"]},q={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,r,n,a,i=e.state,o=e.name,e=e.options,s=i.elements.arrow,l=i.modifiersData.popperOffsets,c=ue(u=U(i.placement)),u=0<=[M,I].indexOf(u)?"height":"width";s&&l&&(e=e.padding,r=i,r=pe("number"!=typeof(e="function"==typeof e?e(Object.assign({},r.rects,{placement:r.placement})):e)?e:he(e,N)),e=ne(s),a="y"===c?w:M,n="y"===c?R:I,t=i.rects.reference[u]+i.rects.reference[c]-l[c]-i.rects.popper[u],l=l[c]-i.rects.reference[c],s=(s=F(s))?"y"===c?s.clientHeight||0:s.clientWidth||0:0,a=r[a],r=s-e[u]-r[n],a=G(a,n=s/2-e[u]/2+(t/2-l/2),r),i.modifiersData[o]=((s={})[c]=a,s.centerOffset=a-n,s))},effect:function(e){var t=e.state;null!=(e=void 0===(e=e.options.element)?"[data-popper-arrow]":e)&&("string"!=typeof e||(e=t.elements.popper.querySelector(e)))&&oe(t.elements.popper,e)&&(t.elements.arrow=e)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},$={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,e=e.name,r=t.rects.reference,n=t.rects.popper,a=t.modifiersData.preventOverflow,i=j(t,{elementContext:"reference"}),o=j(t,{altBoundary:!0}),i=Te(i,r),r=Te(o,n,a),o=be(i),n=be(r);t.modifiersData[e]={referenceClippingOffsets:i,popperEscapeOffsets:r,isReferenceHidden:o,hasPopperEscaped:n},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":o,"data-popper-escaped":n})}}]}),sl.applyStyles=n,sl.arrow=q,sl.computeStyles=r,sl.createPopper=Y,sl.createPopperLite=z,sl.defaultModifiers=K,sl.detectOverflow=j,sl.eventListeners=e,sl.flip=V,sl.hide=$,sl.offset=a,sl.popperGenerator=me,sl.popperOffsets=t,sl.preventOverflow=W),sl;function v(e){var t;return null==e?window:"[object Window]"!==e.toString()?(t=e.ownerDocument)&&t.defaultView||window:e}function h(e){return e instanceof v(e).Element||e instanceof Element}function c(e){return e instanceof v(e).HTMLElement||e instanceof HTMLElement}function J(e){return"undefined"!=typeof ShadowRoot&&(e instanceof v(e).ShadowRoot||e instanceof ShadowRoot)}function Z(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Q(){return!/^((?!chrome|android).)*safari/i.test(Z())}function g(e,t,r){void 0===t&&(t=!1),void 0===r&&(r=!1);var n=e.getBoundingClientRect(),a=1,i=1;t&&c(e)&&(a=0<e.offsetWidth&&T(n.width)/e.offsetWidth||1,i=0<e.offsetHeight&&T(n.height)/e.offsetHeight||1);t=(h(e)?v(e):window).visualViewport,e=!Q()&&r,r=(n.left+(e&&t?t.offsetLeft:0))/a,e=(n.top+(e&&t?t.offsetTop:0))/i,t=n.width/a,a=n.height/i;return{width:t,height:a,top:e,right:r+t,bottom:e+a,left:r,x:r,y:e}}function X(e){e=v(e);return{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function u(e){return e?(e.nodeName||"").toLowerCase():null}function E(e){return((h(e)?e.ownerDocument:e.document)||window.document).documentElement}function ee(e){return g(E(e)).left+X(e).scrollLeft}function S(e){return v(e).getComputedStyle(e)}function te(e){var e=S(e),t=e.overflow,r=e.overflowX,e=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+e+r)}function re(e,t,r){void 0===r&&(r=!1);var n=c(t),a=c(t)&&(o=(a=t).getBoundingClientRect(),i=T(o.width)/a.offsetWidth||1,o=T(o.height)/a.offsetHeight||1,1!==i||1!==o),i=E(t),o=g(e,a,r),e={scrollLeft:0,scrollTop:0},s={x:0,y:0};return!n&&r||("body"===u(t)&&!te(i)||(e=(n=t)!==v(n)&&c(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:X(n)),c(t)?((s=g(t,!0)).x+=t.clientLeft,s.y+=t.clientTop):i&&(s.x=ee(i))),{x:o.left+e.scrollLeft-s.x,y:o.top+e.scrollTop-s.y,width:o.width,height:o.height}}function ne(e){var t=g(e),r=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-r)<=1&&(r=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:r,height:n}}function s(e){return"html"===u(e)?e:e.assignedSlot||e.parentNode||(J(e)?e.host:null)||E(e)}function m(e,t){void 0===t&&(t=[]);var r=function e(t){return 0<=["html","body","#document"].indexOf(u(t))?t.ownerDocument.body:c(t)&&te(t)?t:e(s(t))}(e),e=r===(null==(e=e.ownerDocument)?void 0:e.body),n=v(r),n=e?[n].concat(n.visualViewport||[],te(r)?r:[]):r,r=t.concat(n);return e?r:r.concat(m(s(n)))}function ae(e){return c(e)&&"fixed"!==S(e).position?e.offsetParent:null}function F(e){for(var t,r=v(e),n=ae(e);n&&(t=n,0<=["table","td","th"].indexOf(u(t)))&&"static"===S(n).position;)n=ae(n);return(!n||"html"!==u(n)&&("body"!==u(n)||"static"!==S(n).position))&&(n||function(e){var t=/firefox/i.test(Z()),r=/Trident/i.test(Z());if(!r||!c(e)||"fixed"!==S(e).position){var n=s(e);for(J(n)&&(n=n.host);c(n)&&["html","body"].indexOf(u(n))<0;){var a=S(n);if("none"!==a.transform||"none"!==a.perspective||"paint"===a.contain||-1!==["transform","perspective"].indexOf(a.willChange)||t&&"filter"===a.willChange||t&&a.filter&&"none"!==a.filter)return n;n=n.parentNode}}return null}(e))||r}function ie(e){var r=new Map,n=new Set,a=[];return e.forEach(function(e){r.set(e.name,e)}),e.forEach(function(e){n.has(e.name)||!function t(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach(function(e){n.has(e)||(e=r.get(e))&&t(e)}),a.push(e)}(e)}),a}function oe(e,t){var r=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(r&&J(r)){var n=t;do{if(n&&e.isSameNode(n))return!0}while(n=n.parentNode||n.host)}return!1}function se(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function le(e,t,r){return t===d?se((a=r,o=v(n=e),s=E(n),o=o.visualViewport,l=s.clientWidth,s=s.clientHeight,u=c=0,o&&(l=o.width,s=o.height,(i=Q())||!i&&"fixed"===a)&&(c=o.offsetLeft,u=o.offsetTop),{width:l,height:s,x:c+ee(n),y:u})):h(t)?((a=g(i=t,!1,"fixed"===(a=r))).top=a.top+i.clientTop,a.left=a.left+i.clientLeft,a.bottom=a.top+i.clientHeight,a.right=a.left+i.clientWidth,a.width=i.clientWidth,a.height=i.clientHeight,a.x=a.left,a.y=a.top,a):se((o=E(e),l=E(o),s=X(o),c=null==(c=o.ownerDocument)?void 0:c.body,n=C(l.scrollWidth,l.clientWidth,c?c.scrollWidth:0,c?c.clientWidth:0),u=C(l.scrollHeight,l.clientHeight,c?c.scrollHeight:0,c?c.clientHeight:0),o=-s.scrollLeft+ee(o),s=-s.scrollTop,"rtl"===S(c||l).direction&&(o+=C(l.clientWidth,c?c.clientWidth:0)-n),{width:n,height:u,x:o,y:s}));var n,a,i,o,s,l,c,u}function ce(r,e,t,n){var a,i="clippingParents"===e?(o=m(s(i=r)),h(a=0<=["absolute","fixed"].indexOf(S(i).position)&&c(i)?F(i):i)?o.filter(function(e){return h(e)&&oe(e,a)&&"body"!==u(e)}):[]):[].concat(e),o=[].concat(i,[t]),e=o[0],t=o.reduce(function(e,t){t=le(r,t,n);return e.top=C(t.top,e.top),e.right=k(t.right,e.right),e.bottom=k(t.bottom,e.bottom),e.left=C(t.left,e.left),e},le(r,e,n));return t.width=t.right-t.left,t.height=t.bottom-t.top,t.x=t.left,t.y=t.top,t}function U(e){return e.split("-")[0]}function B(e){return e.split("-")[1]}function ue(e){return 0<=["top","bottom"].indexOf(e)?"x":"y"}function de(e){var t,r=e.reference,n=e.element,e=e.placement,a=e?U(e):null,e=e?B(e):null,i=r.x+r.width/2-n.width/2,o=r.y+r.height/2-n.height/2;switch(a){case w:t={x:i,y:r.y-n.height};break;case R:t={x:i,y:r.y+r.height};break;case I:t={x:r.x+r.width,y:o};break;case M:t={x:r.x-n.width,y:o};break;default:t={x:r.x,y:r.y}}var s=a?ue(a):null;if(null!=s){var l="y"===s?"height":"width";switch(e){case D:t[s]=t[s]-(r[l]/2-n[l]/2);break;case b:t[s]=t[s]+(r[l]/2-n[l]/2)}}return t}function fe(){return{top:0,right:0,bottom:0,left:0}}function pe(e){return Object.assign({},fe(),e)}function he(r,e){return e.reduce(function(e,t){return e[t]=r,e},{})}function j(e,t){var n,t=t=void 0===t?{}:t,r=t.placement,r=void 0===r?e.placement:r,a=t.strategy,a=void 0===a?e.strategy:a,i=t.boundary,i=void 0===i?_:i,o=t.rootBoundary,o=void 0===o?d:o,s=t.elementContext,s=void 0===s?f:s,l=t.altBoundary,l=void 0!==l&&l,t=t.padding,t=void 0===t?0:t,t=pe("number"!=typeof t?t:he(t,N)),c=e.rects.popper,l=e.elements[l?s===f?y:f:s],l=ce(h(l)?l:l.contextElement||E(e.elements.popper),i,o,a),i=g(e.elements.reference),o=de({reference:i,element:c,strategy:"absolute",placement:r}),a=se(Object.assign({},c,o)),c=s===f?a:i,u={top:l.top-c.top+t.top,bottom:c.bottom-l.bottom+t.bottom,left:l.left-c.left+t.left,right:c.right-l.right+t.right},o=e.modifiersData.offset;return s===f&&o&&(n=o[r],Object.keys(u).forEach(function(e){var t=0<=[I,R].indexOf(e)?1:-1,r=0<=[w,R].indexOf(e)?"y":"x";u[e]+=n[r]*t})),u}function ge(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!t.some(function(e){return!(e&&"function"==typeof e.getBoundingClientRect)})}function me(e){var e=e=void 0===e?{}:e,t=e.defaultModifiers,d=void 0===t?[]:t,t=e.defaultOptions,f=void 0===t?p:t;return function(n,a,t){void 0===t&&(t=f);var r,i,o={placement:"bottom",orderedModifiers:[],options:Object.assign({},p,f),modifiersData:{},elements:{reference:n,popper:a},attributes:{},styles:{}},s=[],l=!1,c={state:o,setOptions:function(e){var r,t,e="function"==typeof e?e(o.options):e,e=(u(),o.options=Object.assign({},f,o.options,e),o.scrollParents={reference:h(n)?m(n):n.contextElement?m(n.contextElement):[],popper:m(a)},e=[].concat(d,o.options.modifiers),t=e.reduce(function(e,t){var r=e[t.name];return e[t.name]=r?Object.assign({},r,t,{options:Object.assign({},r.options,t.options),data:Object.assign({},r.data,t.data)}):t,e},{}),e=Object.keys(t).map(function(e){return t[e]}),r=ie(e),A.reduce(function(e,t){return e.concat(r.filter(function(e){return e.phase===t}))},[]));return o.orderedModifiers=e.filter(function(e){return e.enabled}),o.orderedModifiers.forEach(function(e){var t=e.name,r=e.options,e=e.effect;"function"==typeof e&&(e=e({state:o,name:t,instance:c,options:void 0===r?{}:r}),s.push(e||function(){}))}),c.update()},forceUpdate:function(){if(!l){var e=o.elements,t=e.reference,e=e.popper;if(ge(t,e)){o.rects={reference:re(t,F(e),"fixed"===o.options.strategy),popper:ne(e)},o.reset=!1,o.placement=o.options.placement,o.orderedModifiers.forEach(function(e){return o.modifiersData[e.name]=Object.assign({},e.data)});for(var r,n,a,i=0;i<o.orderedModifiers.length;i++)!0===o.reset?(o.reset=!1,i=-1):(r=(a=o.orderedModifiers[i]).fn,n=a.options,a=a.name,"function"==typeof r&&(o=r({state:o,options:void 0===n?{}:n,name:a,instance:c})||o))}}},update:(r=function(){return new Promise(function(e){c.forceUpdate(),e(o)})},function(){return i=i||new Promise(function(e){Promise.resolve().then(function(){i=void 0,e(r())})})}),destroy:function(){u(),l=!0}};return ge(n,a)&&c.setOptions(t).then(function(e){!l&&t.onFirstUpdate&&t.onFirstUpdate(e)}),c;function u(){s.forEach(function(e){return e()}),s=[]}}}function _e(e){var t,r=e.popper,n=e.popperRect,a=e.placement,i=e.variation,o=e.offsets,s=e.position,l=e.gpuAcceleration,c=e.adaptive,u=e.roundOffsets,e=e.isFixed,d=o.x,d=void 0===d?0:d,f=o.y,f=void 0===f?0:f,p="function"==typeof u?u({x:d,y:f}):{x:d,y:f},p=(d=p.x,f=p.y,o.hasOwnProperty("x")),o=o.hasOwnProperty("y"),h=M,g=w,m=window,_=(c&&(_="clientHeight",t="clientWidth",(y=F(r))===v(r)&&"static"!==S(y=E(r)).position&&"absolute"===s&&(_="scrollHeight",t="scrollWidth"),a!==w&&(a!==M&&a!==I||i!==b)||(g=R,f=(f-((e&&y===m&&m.visualViewport?m.visualViewport.height:y[_])-n.height))*(l?1:-1)),a!==M&&(a!==w&&a!==R||i!==b)||(h=I,d=(d-((e&&y===m&&m.visualViewport?m.visualViewport.width:y[t])-n.width))*(l?1:-1))),Object.assign({position:s},c&&O)),y=!0===u?(a={x:d,y:f},i=v(r),e=a.x,a=a.y,i=i.devicePixelRatio||1,{x:T(e*i)/i||0,y:T(a*i)/i||0}):{x:d,y:f};return d=y.x,f=y.y,l?Object.assign({},_,((t={})[g]=o?"0":"",t[h]=p?"0":"",t.transform=(m.devicePixelRatio||1)<=1?"translate("+d+"px, "+f+"px)":"translate3d("+d+"px, "+f+"px, 0)",t)):Object.assign({},_,((n={})[g]=o?f+"px":"",n[h]=p?d+"px":"",n.transform="",n))}function H(e){return e.replace(/left|right|bottom|top/g,function(e){return i[e]})}function ye(e){return e.replace(/start|end/g,function(e){return o[e]})}function G(e,t,r){return C(e,k(t,r))}function Te(e,t,r){return{top:e.top-t.height-(r=void 0===r?{x:0,y:0}:r).y,right:e.right-t.width+r.x,bottom:e.bottom-t.height+r.y,left:e.left-t.width-r.x}}function be(t){return[w,I,R,M].some(function(e){return 0<=t[e]})}}var cl,ul={};function dl(){if(!cl){cl=1,Object.defineProperty(ul,"__esModule",{value:!0}),ul.Portal=void 0;const i=or.__importDefault(ae());ul.Portal=class{portalElement;containerElement;view(){return(0,i.default)("span",{style:{display:"none"}})}oncreate({attrs:e,children:t,dom:r}){var{onContentMount:n=()=>{},onBeforeContentMount:a=()=>({})}=e,{container:a=document.body}=a(r);this.containerElement=a,this.portalElement=document.createElement("div"),a.appendChild(this.portalElement),this.applyPortalProps(e),i.default.render(this.portalElement,t),n(this.portalElement)}onupdate({attrs:e,children:t}){var{onContentUpdate:r=()=>{}}=e;this.portalElement&&(this.applyPortalProps(e),i.default.render(this.portalElement,t),r(this.portalElement))}applyPortalProps(e){this.portalElement&&(this.portalElement.className=e.className??"",Object.assign(this.portalElement.style,e.style))}onremove({attrs:e}){var{onContentUnmount:e=()=>{}}=e,t=this.containerElement??document.body;this.portalElement&&t.contains(this.portalElement)&&(e(this.portalElement),i.default.render(this.portalElement,null),t.removeChild(this.portalElement))}}}return ul}var fl,pl={};function hl(){return fl||(fl=1,Object.defineProperty(pl,"__esModule",{value:!0}),pl.isOrContains=function(e,t){return e===t||e.contains(t)},pl.findRef=function(e,t){t=`[ref=${t}]`;return e.matches(t)?e:e.querySelector(t)},pl.toHTMLElement=function(e){if(e instanceof HTMLElement)return e;throw new Error("Element is not an HTMLElement")},pl.elementIsEditable=function(e){if(null===e)return!1;if(!(e instanceof Element))return!1;e=e.closest("input, textarea, [contenteditable=true]");if(null===e)return!1;if(e instanceof HTMLInputElement&&["radio","checkbox","button"].includes(e.type))return!1;return!0},pl.currentTargetOffset=function(e){var t,r;if(e.currentTarget!==e.target&&e.currentTarget&&e.currentTarget instanceof Element)return r=e.currentTarget.getBoundingClientRect(),t=e.clientX-r.left,r=e.clientY-r.top,{x:t,y:r};return{x:e.offsetX,y:e.offsetY}}),pl}var gl,ml,_l,yl={};function Tl(){if(!gl){gl=1,Object.defineProperty(yl,"__esModule",{value:!0}),yl.setScheduleFullRedraw=function(e){t=e},yl.scheduleFullRedraw=function(){t()};let t=()=>{}}return yl}function bl(){if(!ml){ml=1,Object.defineProperty(ol,"__esModule",{value:!0}),ol.Popup=ol.PopupPosition=void 0;var s,e=or;const l=ll(),c=e.__importDefault(ae()),u=dl(),d=Qs(),f=hl(),p=ee(),t=Tl();(e=s||(ol.PopupPosition=s={})).Auto="auto",e.AutoStart="auto-start",e.AutoEnd="auto-end",e.Top="top",e.TopStart="top-start",e.TopEnd="top-end",e.Bottom="bottom",e.BottomStart="bottom-start",e.BottomEnd="bottom-end",e.Right="right",e.RightStart="right-start",e.RightEnd="right-end",e.Left="left",e.LeftStart="left-start",e.LeftEnd="left-end";ol.Popup=class h{isOpen=!1;triggerElement;popupElement;popper;onChange=()=>{};closeOnEscape;closeOnOutsideClick;static TRIGGER_REF="trigger";static POPUP_REF="popup";static POPUP_GROUP_CLASS="pf-popup-group";static DISMISS_POPUP_GROUP_CLASS="pf-dismiss-popup-group";view({attrs:e,children:t}){var{trigger:r,isOpen:n=this.isOpen,onChange:a=()=>{},closeOnEscape:i=!0,closeOnOutsideClick:o=!0}=e;return this.isOpen=n,this.onChange=a,this.closeOnEscape=i,this.closeOnOutsideClick=o,[this.renderTrigger(r),n&&this.renderPopup(e,t)]}renderTrigger(e){return e.attrs={...e.attrs,ref:h.TRIGGER_REF,onclick:e=>{this.togglePopup(),e.preventDefault()},active:this.isOpen},e}renderPopup(r,e){const{className:t,showArrow:n=!0,createNewGroup:a=!0,onPopupMount:i=()=>{},onPopupUnMount:o=()=>{}}=r;var s={className:"pf-popup-portal",onBeforeContentMount:e=>({container:e.closest(`[ref=${h.POPUP_REF}]`)??void 0}),onContentMount:e=>{var t=(0,f.toHTMLElement)((0,p.assertExists)((0,f.findRef)(e,h.POPUP_REF)));this.popupElement=t,this.createOrUpdatePopper(r),document.addEventListener("mousedown",this.handleDocMouseDown),document.addEventListener("keydown",this.handleDocKeyPress),e.addEventListener("click",this.handleContentClick),i(t)},onContentUpdate:()=>{this.popper&&this.popper.update()},onContentUnmount:e=>{this.popupElement&&o(this.popupElement),e.removeEventListener("click",this.handleContentClick),document.removeEventListener("keydown",this.handleDocKeyPress),document.removeEventListener("mousedown",this.handleDocMouseDown),this.popper&&this.popper.destroy(),this.popper=void 0,this.popupElement=void 0}};return(0,c.default)(u.Portal,s,(0,c.default)(".pf-popup",{class:(0,d.classNames)(t,a&&h.POPUP_GROUP_CLASS),ref:h.POPUP_REF},n&&(0,c.default)(".pf-popup-arrow[data-popper-arrow]"),(0,c.default)(".pf-popup-content",e)))}oncreate({dom:e}){this.triggerElement=(0,p.assertExists)((0,f.findRef)(e,h.TRIGGER_REF))}onupdate({attrs:e}){this.createOrUpdatePopper(e)}onremove(e){this.triggerElement=void 0}createOrUpdatePopper(e){const{position:t=s.Auto,showArrow:r=!0,matchWidth:n=!1,offset:a=0,edgeOffset:i=0}=e;let o;e={placement:t,modifiers:[{name:"offset",options:{offset:({placement:e})=>{let t=0;return e.includes("-end")?t=i:e.includes("-start")&&(t=-i),[t,r?a+8:a]}}},{name:"preventOverflow",options:{padding:8}},{name:"arrow",options:{padding:2}},...o=n?[{name:"sameWidth",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:({state:e})=>{e.styles.popper.width=e.rects.reference.width+"px"},effect:({state:e})=>{var t=e.elements.reference;e.elements.popper.style.width=t.offsetWidth+"px"}}]:[]]},this.popper?this.popper.setOptions(e):this.popupElement&&this.triggerElement&&(this.popper=(0,l.createPopper)(this.triggerElement,this.popupElement,e))}eventInPopupOrTrigger(e){var e=e.target,t=(0,f.isOrContains)((0,p.assertExists)(this.triggerElement),e),e=(0,f.isOrContains)((0,p.assertExists)(this.popupElement),e);return t||e}handleDocMouseDown=e=>{this.closeOnOutsideClick&&!this.eventInPopupOrTrigger(e)&&this.closePopup()};handleDocKeyPress=e=>{this.popupElement?.querySelector("."+h.POPUP_GROUP_CLASS)||this.closeOnEscape&&"Escape"===e.key&&this.closePopup()};handleContentClick=e=>{var e=e.target,t=this.popupElement?.querySelector("."+h.POPUP_GROUP_CLASS);t&&t.contains(e)||e.closest("."+h.DISMISS_POPUP_GROUP_CLASS)&&this.closePopup()};closePopup(){this.isOpen&&(this.isOpen=!1,this.onChange(this.isOpen),(0,t.scheduleFullRedraw)())}togglePopup(){this.isOpen=!this.isOpen,this.onChange(this.isOpen),(0,t.scheduleFullRedraw)()}}}return ol}function vl(){if(_l)return Js;_l=1,Object.defineProperty(Js,"__esModule",{value:!0}),Js.PopupMenu2=Js.Menu=Js.MenuDivider=Js.MenuItem=void 0;const c=or.__importDefault(ae()),u=Qs(),t=tl(),d=al(),f=bl();Js.MenuItem=class s{view(e){return(0,t.hasChildren)(e)?this.renderNested(e):this.renderSingle(e)}renderNested({attrs:e,children:t}){const{rightIcon:r="chevron_right",closePopupOnClick:n=!1,...a}=e;return(0,c.default)(o,{popupPosition:f.PopupPosition.RightStart,trigger:(0,c.default)(s,{rightIcon:r,closePopupOnClick:n,...a}),showArrow:!1,createNewGroup:!1,edgeOffset:5},t)}renderSingle({attrs:e}){const{label:t,icon:r,rightIcon:n,disabled:a,active:i,closePopupOnClick:o=!0,className:s,...l}=e;return e=(0,u.classNames)(i&&"pf-active",!a&&o&&f.Popup.DISMISS_POPUP_GROUP_CLASS,s),(0,c.default)("button.pf-menu-item"+(a?"[disabled]":""),{...l,className:e},r&&(0,c.default)(d.Icon,{className:"pf-left-icon",icon:r}),n&&(0,c.default)(d.Icon,{className:"pf-right-icon",icon:n}),t)}};Js.MenuDivider=class{view(){return(0,c.default)(".pf-menu-divider")}};class i{view({children:e}){return(0,c.default)(".pf-menu",e)}}Js.Menu=i;class o{view({attrs:e,children:t}){const{trigger:r,popupPosition:n=f.PopupPosition.Bottom,...a}=e;return(0,c.default)(f.Popup,{trigger:r,position:n,className:"pf-popup-menu",...a},(0,c.default)(i,t))}}return Js.PopupMenu2=o,Js}var El,Sl,Al,Ol,Cl={};function x(){if(!El){El=1,Object.defineProperty(Cl,"__esModule",{value:!0}),Cl.Timestamp=void 0,Cl.menuItemForFormat=r,Cl.renderTimecode=n;const a=or.__importDefault(ae()),i=Ws(),o=X(),s=K(),l=ne(),c=Fa(),u=ie(),d=se(),f=vl(),p=oe();function r(e,t){return(0,a.default)(f.MenuItem,{label:t,active:e===(0,c.timestampFormat)(),onclick:()=>{(0,c.setTimestampFormat)(e),u.raf.scheduleFullRedraw()}})}function n(e){var{dhhmmss:e,millis:t,micros:r,nanos:n}=s.Time.toTimecode(e);return(0,a.default)("span.pf-timecode",(0,a.default)("span.pf-timecode-hms",e),".",(0,a.default)("span.pf-timecode-millis",t),(0,a.default)("span.pf-timecode-micros",r),(0,a.default)("span.pf-timecode-nanos",n))}Cl.Timestamp=class{view({attrs:e}){const t=e["ts"];return(0,a.default)(f.PopupMenu2,{trigger:(0,a.default)(d.Anchor,{onmouseover:()=>{p.globals.dispatch(l.Actions.setHoverCursorTimestamp({ts:t}))},onmouseout:()=>{p.globals.dispatch(l.Actions.setHoverCursorTimestamp({ts:s.Time.INVALID}))}},e.display??function(e){var t=(0,c.timestampFormat)(),r=p.globals.toDomainTime(e);switch(t){case c.TimestampFormat.UTC:case c.TimestampFormat.TraceTz:case c.TimestampFormat.Timecode:return n(r);case c.TimestampFormat.Raw:return r.toString();case c.TimestampFormat.RawLocale:return r.toLocaleString();case c.TimestampFormat.Seconds:return s.Time.formatSeconds(r);default:throw new Error("Invalid timestamp "+t)}}(t))},(0,a.default)(f.MenuItem,{icon:o.Icons.Copy,label:"Copy raw value",onclick:()=>{(0,i.copyToClipboard)(t.toString())}}),(0,a.default)(f.MenuItem,{label:"Time format"},r(c.TimestampFormat.Timecode,"Timecode"),r(c.TimestampFormat.UTC,"Realtime (UTC)"),r(c.TimestampFormat.TraceTz,"Realtime (Trace TZ)"),r(c.TimestampFormat.Seconds,"Seconds"),r(c.TimestampFormat.Raw,"Raw"),r(c.TimestampFormat.RawLocale,"Raw (with locale-specific formatting)")),e.extraMenuItems?[(0,a.default)(f.MenuDivider),e.extraMenuItems]:null)}}}return Cl}function L(){if(!Sl){Sl=1,Object.defineProperty(Gs,"__esModule",{value:!0}),Gs.DurationWidget=void 0,Gs.renderDuration=n;const a=or.__importDefault(ae()),i=Ws(),o=X(),s=K(),l=Fa(),c=ie(),u=se(),d=vl(),f=x();function r(e,t){return(0,a.default)(d.MenuItem,{label:t,active:e===(0,l.durationPrecision)(),onclick:()=>{(0,l.setDurationPrecision)(e),c.raf.scheduleFullRedraw()}})}function n(e){var t=(0,l.timestampFormat)();switch(t){case l.TimestampFormat.UTC:case l.TimestampFormat.TraceTz:case l.TimestampFormat.Timecode:var r=e,n=(0,l.durationPrecision)();switch(n){case l.DurationPrecision.HumanReadable:return s.Duration.humanise(r);case l.DurationPrecision.Full:return s.Duration.format(r);default:throw new Error("Invalid format "+n)}return;case l.TimestampFormat.Raw:return e.toString();case l.TimestampFormat.RawLocale:return e.toLocaleString();case l.TimestampFormat.Seconds:return s.Duration.formatSeconds(e);default:throw new Error("Invalid format "+t)}}Gs.DurationWidget=class{view({attrs:e}){const t=e["dur"];return-1n===t?"(Did not end)":(0,a.default)(d.PopupMenu2,{trigger:(0,a.default)(u.Anchor,n(t))},(0,a.default)(d.MenuItem,{icon:o.Icons.Copy,label:"Copy raw value",onclick:()=>{(0,i.copyToClipboard)(t.toString())}}),(0,a.default)(d.MenuItem,{label:"Set time format"},(0,f.menuItemForFormat)(l.TimestampFormat.Timecode,"Timecode"),(0,f.menuItemForFormat)(l.TimestampFormat.UTC,"Realtime (UTC)"),(0,f.menuItemForFormat)(l.TimestampFormat.TraceTz,"Realtime (Trace TZ)"),(0,f.menuItemForFormat)(l.TimestampFormat.Seconds,"Seconds"),(0,f.menuItemForFormat)(l.TimestampFormat.Raw,"Raw"),(0,f.menuItemForFormat)(l.TimestampFormat.RawLocale,"Raw (with locale-specific formatting)")),(0,a.default)(d.MenuItem,{label:"Duration precision",disabled:!function(){switch((0,l.timestampFormat)()){case l.TimestampFormat.Timecode:case l.TimestampFormat.UTC:case l.TimestampFormat.TraceTz:return 1;default:return}}(),title:"Not configurable with current time format"},r(l.DurationPrecision.Full,"Full"),r(l.DurationPrecision.HumanReadable,"Human readable")),e.extraMenuItems?[(0,a.default)(d.MenuDivider),e.extraMenuItems]:null)}}}return Gs}function kl(){if(!Al){Al=1,Object.defineProperty(Cs,"__esModule",{value:!0}),Cs.NamedSliceTrack=Cs.NAMED_ROW=void 0;const n=M();var e=Z();const i=js(),t=oe(),o=L();Cs.NAMED_ROW={...i.BASE_ROW,name:e.STR_NULL};class r extends i.BaseSliceTrack{constructor(e){super(e)}rowToSliceBase(e){var t=super.rowToSliceBase(e),e=e.name??"",r=(0,n.getColorForSlice)(e);return{...t,title:e,colorScheme:r}}onSliceOver(e){var{title:t,dur:r,flags:n}=e.slice;let a;a=n&i.SLICE_FLAGS_INCOMPLETE?"Incomplete":n&i.SLICE_FLAGS_INSTANT?"Instant":(0,o.renderDuration)(r),e.tooltip=[`${t} - [${a}]`]}onSliceClick(e){t.globals.setLegacySelection({kind:"SLICE",id:e.slice.id,trackKey:this.trackKey,table:"slice"},{clearSearch:!0,pendingScrollId:void 0,switchToCurrentSelectionTab:!0})}}Cs.NamedSliceTrack=r}return Cs}function wl(){if(!Ol){Ol=1,Object.defineProperty(Es,"__esModule",{value:!0}),Es.CustomSqlTableSliceTrack=void 0;const r=ne(),n=As(),a=oe(),e=kl(),i=D(),t=P(),o=V();class s extends e.NamedSliceTrack{tableName;getRowSpec(){return e.NAMED_ROW}rowToSlice(e){return this.rowToSliceBase(e)}constructor(e){super(e),this.tableName="customsqltableslicetrack_"+(0,t.uuidv4)().split("-").join("_")}getSqlImports(){return{modules:[]}}async onInit(){await this.loadImports();var e=await Promise.resolve(this.getSqlDataSource());let t=["*"];void 0!==e.columns&&(t=e.columns);var r=new o.AsyncDisposableStack;return e.disposable&&r.use(e.disposable),r.use(await(0,i.createView)(this.engine,this.tableName,(0,n.generateSqlWithInternalLayout)({columns:t,sourceTable:e.sqlTableName,ts:"ts",dur:"dur",whereClause:e.whereClause}))),r}getSqlSource(){return"SELECT * FROM "+this.tableName}isSelectionHandled(e){return"GENERIC_SLICE"===e.kind&&e.trackKey===this.trackKey}onSliceClick(e){var t;void 0!==this.getDetailsPanel(e)&&(t=this.getDetailsPanel(e),a.globals.makeSelection(r.Actions.selectGenericSlice({id:e.slice.id,sqlTableName:this.tableName,start:e.slice.ts,duration:e.slice.dur,trackKey:this.trackKey,detailsPanelConfig:{kind:t.kind,config:t.config}})))}async loadImports(){for(const e of this.getSqlImports().modules)await this.engine.query(`INCLUDE PERFETTO MODULE ${e};`)}}Es.CustomSqlTableSliceTrack=s}return Es}var Rl,Il={},Ml={};function Pl(){if(Rl)return Ml;Rl=1,Object.defineProperty(Ml,"__esModule",{value:!0}),Ml.BottomTab=Ml.BottomTabBase=void 0;const e=or.__importDefault(ae());class t{config;engine;tag;uuid;constructor(e){this.config=e.config,this.engine=e.engine,this.tag=e.tag,this.uuid=e.uuid}isLoading(){return!1}}Ml.BottomTabBase=t;Ml.BottomTab=class extends t{constructor(e){super(e)}renderPanel(){return(0,e.default)(r,{key:this.uuid,panel:this})}};class r{view(e){return e.attrs.panel.viewTab()}}return Ml}var Nl,Dl={},xl={};function Ll(){if(!Nl){Nl=1,Object.defineProperty(xl,"__esModule",{value:!0}),xl.convertArgsToTree=t,xl.convertArgsToObject=function(e){e=t(e);return r(e)};const s=te(),n=z();function t(e){var t=[];for(const n of e){var r=n["key"];!function e(t,r,n,a){const i=r.shift();let o=t.find(e=>e.key===i);o||(o={key:i},t.push(o));0<r.length?(void 0===o.children&&(o.children=[]),e(o.children,r,n,a)):o.value=a}(t,function(e){var t=[];var r;var n=/([^\.\[\]]+)|\[(\d+)\]/g;for(;null!==(r=n.exec(e));)t.push(r[2]?parseInt(r[2]):r[1]);return t}(r),r,n)}return t}function r(e){if(e.every(({key:e})=>(0,s.isString)(e))){var t={};for(const a of e){if(a.key in t)throw new Error("Duplicate key "+a.key);t[a.key]=o(a)}return t}if(e.every(({key:e})=>"number"==typeof e)){var r=[];for(const i of e){var n=i.key;if(n in r)throw new Error("Duplicate array index "+n);r[n]=o(i)}return r}throw new Error("Invalid mix of node key types")}function o({value:e,children:t}){if((0,n.exists)(e)&&!(0,n.exists)(t))return e.value;if(!(0,n.exists)(e)&&(0,n.exists)(t))return r(t);throw new Error("Invalid node type")}}return xl}var Fl,Ul={},Bl={},jl={},Hl={};function Gl(){if(!Fl){Fl=1,Object.defineProperty(Hl,"__esModule",{value:!0}),Hl.Intent=void 0,Hl.classForIntent=function(e){switch(e){case t.None:return;case t.Primary:return"pf-intent-primary";default:return(0,r.assertUnreachable)(e)}};const r=ee();var t,e;(e=t||(Hl.Intent=t={})).None="none",e.Primary="primary"}return Hl}var Vl,Wl,ql={};function $l(){if(!Vl){Vl=1,Object.defineProperty(ql,"__esModule",{value:!0}),ql.Spinner=void 0;const r=or.__importDefault(ae()),n=Qs();ql.Spinner=class{view({attrs:e}){var{easing:e=!1,className:t}=e,e=(0,n.classNames)(e&&"easing",t);return(0,r.default)(".pf-spinner",{class:e})}}}return ql}function le(){if(!Wl){Wl=1,Object.defineProperty(jl,"__esModule",{value:!0}),jl.ButtonBar=jl.Button=void 0;const f=or.__importDefault(ae()),p=Qs(),h=Gl(),g=al(),m=bl(),a=$l();jl.Button=class{view({attrs:e}){const{icon:t,active:r,compact:n,rightIcon:a,className:i,dismissPopup:o,iconFilled:s,intent:l=h.Intent.None,...c}=e;var u="label"in e?e.label:void 0,d=(0,p.classNames)(r&&"pf-active",n&&"pf-compact",(0,h.classForIntent)(l),t&&!u&&"pf-icon-only",o&&m.Popup.DISMISS_POPUP_GROUP_CLASS,i);return(0,f.default)("button.pf-button",{...c,className:d},this.renderIcon(e),a&&(0,f.default)(g.Icon,{className:"pf-right-icon",icon:a,filled:s}),u||"​")}renderIcon(e){var{icon:t,iconFilled:r}=e,n="pf-left-icon";return e.loading?(0,f.default)(a.Spinner,{className:n}):t?(0,f.default)(g.Icon,{className:n,icon:t,filled:r}):void 0}};jl.ButtonBar=class{view({attrs:e,children:t}){return(0,f.default)(".pf-button-bar",e,t)}}}return jl}var zl,Kl,Yl,Jl={};function Zl(){if(!zl){zl=1;{var e=Jl;Object.defineProperty(e,"__esModule",{value:!0}),e.ThreadSliceTrack=e.THREAD_SLICE_ROW=void 0;const n=Rr(),a=mn(),i=oe();var t=kl();const o=xs();var r=Z();e.THREAD_SLICE_ROW={...t.NAMED_ROW,threadDur:r.LONG_NULL};class s extends t.NamedSliceTrack{trackId;tableName;constructor(e,t,r,n="slice"){super(e),this.trackId=t,this.tableName=n,this.sliceLayout={...o.SLICE_LAYOUT_FIT_CONTENT_DEFAULTS,depthGuess:r}}getRowSpec(){return e.THREAD_SLICE_ROW}getSqlSource(){return`
      select
        ts,
        dur,
        id,
        depth,
        ifnull(name, '') as name,
        thread_dur as threadDur
      from ${this.tableName}
      where track_id = ${this.trackId}
    `}rowToSlice(e){var t=this.rowToSliceBase(e);return 0n<e.dur&&null!==e.threadDur?(e=(0,a.clamp)(n.BigintMath.ratio(e.threadDur,e.dur),0,1),{...t,fillRatio:e}):t}onUpdatedSlices(e){for(const t of e)t.isHighlighted=t===this.hoveredSlice}onSliceClick(e){i.globals.setLegacySelection({kind:"SLICE",id:e.slice.id,trackKey:this.trackKey,table:this.tableName},{clearSearch:!0,pendingScrollId:void 0,switchToCurrentSelectionTab:!0})}}e.ThreadSliceTrack=s}}return Jl}function Ql(){if(!Yl){Yl=1,Object.defineProperty(Ul,"__esModule",{value:!0}),Ul.addVisualisedArgTracks=async function(t,r){var e=r.replace(/[^a-zA-Z]/g,"_"),e=`__arg_visualisation_helper_${e}_slice`,e=await t.engine.query(`
        drop table if exists ${e};

        create table ${e} as
        with slice_with_arg as (
          select
            slice.id,
            slice.track_id,
            slice.ts,
            slice.dur,
            slice.thread_dur,
            NULL as cat,
            args.display_value as name
          from slice
          join args using (arg_set_id)
          where args.key='${r}'
        )
        select
          *,
          (select count()
           from ancestor_slice(s1.id) s2
           join slice_with_arg s3 on s2.id=s3.id
          ) as depth
        from slice_with_arg s1
        order by id;

        select
          track_id as trackId,
          max(depth) as maxDepth
        from ${e}
        group by track_id;
    `),n=[],a=e.iter({trackId:g.NUM,maxDepth:g.NUM});for(;a.valid();a.next()){const c=a.trackId,u=a.maxDepth;var i=m.globals.trackManager.trackKeyByTrackId.get(c),i=m.globals.state.tracks[(0,d.assertExists)(i)],o=i.trackSortKey.utid,s=(0,f.uuidv4)(),l=y+"#"+(0,f.uuidv4)();t.registerTrack({uri:l,title:r,chips:["metric"],trackFactory:e=>new _.VisualisedArgsTrack({engine:t.engine,trackKey:e.trackKey,trackId:c,maxDepth:u,argName:r})}),n.push({key:s,trackGroup:i.trackGroup,name:r,trackSortKey:void 0===o?i.trackSortKey:{utid:o,priority:h.InThreadTrackSortKey.VISUALISED_ARGS_TRACK},uri:l})}m.globals.dispatchMultiple([p.Actions.addTracks({tracks:n}),p.Actions.sortThreadTracks({})])};const d=ee(),f=P(),p=ne(),h=Y(),g=Z(),m=oe(),_=function(){if(!Kl){Kl=1,Object.defineProperty(Bl,"__esModule",{value:!0}),Bl.VisualisedArgsTrack=void 0;const t=or.__importDefault(ae()),r=ne(),n=oe(),a=le(),i=X();var e=Zl();const o=P(),s=D();class l extends e.ThreadSliceTrack{viewName;argName;constructor({trackKey:e,engine:t,trackId:r,maxDepth:n,argName:a}){var i=(0,o.uuidv4Sql)(),i=`__arg_visualisation_helper_${a.replace(/[^a-zA-Z]/g,"_")}_${i}_slice`;super({engine:t,trackKey:e},r,n,i),this.viewName=i,this.argName=a}async onInit(){return(0,s.createView)(this.engine,this.viewName,`
        with slice_with_arg as (
          select
            slice.id,
            slice.track_id,
            slice.ts,
            slice.dur,
            slice.thread_dur,
            NULL as cat,
            args.display_value as name
          from slice
          join args using (arg_set_id)
          where args.key='${this.argName}'
        )
        select
          *,
          (select count()
          from ancestor_slice(s1.id) s2
          join slice_with_arg s3 on s2.id=s3.id
          ) as depth
        from slice_with_arg s1
        order by id
      `)}getTrackShellButtons(){return(0,t.default)(a.Button,{onclick:()=>{n.globals.dispatch(r.Actions.removeTracks({trackKeys:[this.trackKey]}))},icon:i.Icons.Close,title:"Close",compact:!0})}}Bl.VisualisedArgsTrack=l}return Bl}(),y="perfetto.VisualisedArgs"}return Ul}var Xl,ec={};function ce(){if(!Xl){Xl=1,Object.defineProperty(ec,"__esModule",{value:!0}),ec.LazyTreeNode=ec.TreeNode=ec.Tree=void 0,ec.dictToTreeNodes=t,ec.dictToTree=function(e){return(0,s.default)(r,t(e))};const s=or.__importDefault(ae()),i=Qs(),o=tl(),l=Tl();class r{view({attrs:e,children:t}){var{className:e=""}=e,e=(0,i.classNames)(e);return(0,s.default)(".pf-tree",{class:e},t)}}ec.Tree=r;class c{collapsed;constructor({attrs:e}){this.collapsed=e.startsCollapsed??!1}view(e){const{children:t,attrs:r,attrs:{left:n,onCollapseChanged:a=()=>{}}}=e;return[(0,s.default)(".pf-tree-node",{class:(0,i.classNames)(this.getClassNameForNode(e))},(0,s.default)(".pf-tree-left",(0,s.default)("span.pf-tree-gutter",{onclick:()=>{this.collapsed=!this.isCollapsed(e),a(this.collapsed,r),(0,l.scheduleFullRedraw)()}}),n),this.renderRight(e)),(0,o.hasChildren)(e)&&(0,s.default)(".pf-tree-children",t)]}getClassNameForNode(e){var{loading:t=!1,showCaret:r=!1}=e.attrs;return t?"pf-loading":(0,o.hasChildren)(e)||r?this.isCollapsed(e)?"pf-collapsed":"pf-expanded":void 0}renderRight(e){var{right:t,summary:r}=e["attrs"];return(0,o.hasChildren)(e)&&this.isCollapsed(e)?(0,s.default)(".pf-tree-right",r??t):(0,s.default)(".pf-tree-right",t)}isCollapsed({attrs:e}){var{collapsed:e=this.collapsed}=e;return e}}ec.TreeNode=c;function t(e){var t=[];for(const r of Object.keys(e))null!=e[r]&&t.push((0,s.default)(c,{left:r,right:e[r]}));return t}ec.LazyTreeNode=class{collapsed=!0;loading=!1;renderChildren;view({attrs:e}){const{left:t,right:r,icon:n,summary:a,fetchData:i,unloadOnCollapse:o=!1}=e;return(0,s.default)(c,{left:t,right:r,icon:n,summary:a,showCaret:!0,loading:this.loading,collapsed:this.collapsed,onCollapseChanged:e=>{e?o&&(this.renderChildren=void 0):this.renderChildren?(this.collapsed=!1,l.scheduleFullRedraw)():(this.loading=!0,i().then(e=>{this.loading=!1,this.collapsed=!1,this.renderChildren=e,(0,l.scheduleFullRedraw)()})),this.collapsed=e,(0,l.scheduleFullRedraw)()}},this.renderChildren&&this.renderChildren())}}}return ec}var tc,rc={},nc={};function F(){if(!tc){tc=1,Object.defineProperty(nc,"__esModule",{value:!0}),nc.DetailsShell=void 0;const i=or.__importDefault(ae()),o=Qs();nc.DetailsShell=class{view({attrs:e,children:t}){var{title:e,description:r,buttons:n,fillParent:a=!0}=e;return(0,i.default)("section.pf-details-shell",{class:(0,o.classNames)(a&&"pf-fill-parent")},(0,i.default)("header.pf-header-bar",(0,i.default)("h1.pf-header-title",e),(0,i.default)("span.pf-header-description",r),(0,i.default)("nav.pf-header-buttons",n)),(0,i.default)("article.pf-content",t))}}}return nc}var ac,ic={},oc={};function sc(){return ac||(ac=1,Object.defineProperty(oc,"__esModule",{value:!0}),oc.range=function(t){if(t<0)throw new Error("range size should be non-negative!");var r=new Array(t);for(let e=0;e<t;e++)r[e]=e;return r},oc.allUnique=function(e){return e.length==new Set(e).size},oc.arrayEquals=function(t,r){if(t.length!==r.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==r[e])return!1;return!0},oc.isArrayOf=function(e,t){return t.every(e)},oc.removeFalsyValues=function(e){return e.filter(Boolean)}),oc}var lc,cc,uc,dc={},fc={};function pc(){return lc||(lc=1,Object.defineProperty(fc,"__esModule",{value:!0}),fc.startsHidden=function(e){return!!t(e)||(e.startsHidden??!1)},fc.isArgSetIdColumn=t,fc.tableDisplayName=function(e){return e.displayName??e.name},fc.dependendentColumns=function(e){{if("slice_id"!==e?.type)return[];return[e.ts,e.dur,e.trackId]}}),fc;function t(e){return"arg_set_id"===e.type}}function hc(){if(!cc){cc=1,Object.defineProperty(dc,"__esModule",{value:!0}),dc.columnFromSqlTableColumn=function(e){return{expression:e.name,alias:e.name,title:e.title||e.name,display:e.display}},dc.argColumn=function(e,t,r){return{expression:`extract_arg(${e}.${t.name}, ${(0,n.sqliteString)(r)})`,alias:`_arg_${t.name}_`+r.replace(/[^A-Za-z0-9]/g,"_"),title:`${t.title??t.name} `+r}},dc.formatSqlProjection=function(e){return e.expression+" as "+e.alias},dc.sqlProjectionsForColumn=function(e){var t=[{expression:e.expression,alias:e.alias}];for(const r of(0,a.dependendentColumns)(e.display))t.push({expression:r,alias:r});return t};const n=J(),a=pc()}return dc}var gc,mc={},_c={};function yc(){if(!gc){gc=1,Object.defineProperty(_c,"__esModule",{value:!0}),_c.BasicTable=void 0;const r=or.__importDefault(ae());_c.BasicTable=class{renderColumnHeader(e,t){return(0,r.default)("td",t.title)}view(t){const e=t.attrs;return(0,r.default)("table.generic-table",{style:{"table-layout":"auto"}},(0,r.default)("thead",(0,r.default)("tr.header",e.columns.map(e=>this.renderColumnHeader(t,e)))),e.data.map(t=>(0,r.default)("tr",e.columns.map(e=>(0,r.default)("td",e.render(t))))))}}}return _c}var Tc,bc,vc,Ec={},Sc={},Ac={};function Oc(){if(!Tc){Tc=1,Object.defineProperty(Ac,"__esModule",{value:!0}),Ac.TextInput=void 0;const t=or.__importDefault(ae());Ac.TextInput=class{view({attrs:e}){return(0,t.default)("input.pf-text-input",e)}}}return Ac}function Cc(){if(!bc){bc=1,Object.defineProperty(Sc,"__esModule",{value:!0}),Sc.FilterableSelect=Sc.Select=void 0;const n=or.__importDefault(ae()),a=z(),i=vl(),o=Tl(),s=Oc();Sc.Select=class{view({attrs:e,children:t}){return(0,n.default)("select.pf-select",e,t)}};Sc.FilterableSelect=class{searchText="";view({attrs:t}){var e=t.values.filter(e=>e.toLowerCase().includes(this.searchText.toLowerCase())),r=void 0===t.maxDisplayedItems?e:e.slice(0,t.maxDisplayedItems),e=(0,a.exists)(t.maxDisplayedItems)&&Math.max(0,e.length-t.maxDisplayedItems);return(0,n.default)("div",(0,n.default)(".pf-search-bar",(0,n.default)(s.TextInput,{oninput:e=>{e=e.target;this.searchText=e.value,(0,o.scheduleFullRedraw)()},onload:e=>{t.autofocusInput&&e.target.focus()},value:this.searchText,placeholder:"Filter...",className:"pf-search-box"}),(0,n.default)(i.Menu,...r.map(e=>(0,n.default)(i.MenuItem,{label:e,onclick:()=>t.onSelected(e)})),Boolean(e)&&(0,n.default)("i",`+${e} more`))))}}}return Sc}var kc,wc={},Rc={};function Ic(){if(!kc){kc=1,Object.defineProperty(Rc,"__esModule",{value:!0}),Rc.renderError=function(e){return(0,t.default)(".pf-error",e)};const t=or.__importDefault(ae())}return Rc}var Mc,Pc={};function Nc(){return Mc||(Mc=1,Object.defineProperty(Pc,"__esModule",{value:!0}),Pc.asUpid=function(e){return e},Pc.asUtid=function(e){return e},Pc.asSliceSqlId=function(e){return e},Pc.asSchedSqlId=function(e){return e},Pc.asThreadStateSqlId=function(e){return e},Pc.asArgSetId=function(e){return e},Pc.asArgId=function(e){return e}),Pc}var Dc,xc,Lc,Fc={},Uc={};function Bc(){if(!Dc){Dc=1,Object.defineProperty(Uc,"__esModule",{value:!0}),Uc.horizontalScrollToTs=n,Uc.focusHorizontalRange=a,Uc.verticalScrollToTrack=i,Uc.scrollToTrackAndTs=function(e,t,r=!1){void 0!==e&&i(e,r);n(t)},Uc.reveal=function(e,t,r,n=!1){i(e,n),a(t,r)};const o=z(),s=ne(),l=Io(),c=Mo(),u=Y(),d=ie(),f=oe();function n(e){var t,r=f.globals.timeline.visibleWindow;r.contains(e)||(t=r.duration/2,e=new l.HighPrecisionTime(e).subNumber(t),t=new c.HighPrecisionTimeSpan(e,r.duration),f.globals.timeline.updateVisibleTimeHP(t))}function a(e,t,r){var n,a;(0,o.exists)(r)?(n=e,a=t,r=r,n=c.HighPrecisionTimeSpan.fromTime(n,a),(r<=0||1<r)&&(console.warn("Invalid value for [viewPercentage]. Value must be between 0.0 (exclusive) and 1.0 (inclusive)."),r=.5),a=1-r,r=n.duration*a/2,f.globals.timeline.updateVisibleTimeHP(n.pad(r))):(a=e,n=t,r=f.globals.timeline.visibleWindow,2*(a=c.HighPrecisionTimeSpan.fromTime(a,n)).duration>r.duration?(n=a.pad(2*a.duration),f.globals.timeline.updateVisibleTimeHP(n)):(n=a.midpoint.subNumber(r.duration/2),(n=new c.HighPrecisionTimeSpan(n,r.duration).fitWithin(f.globals.traceContext.start,f.globals.traceContext.end)).equals(r)?(r=a.pad(2*a.duration),f.globals.timeline.updateVisibleTimeHP(r)):f.globals.timeline.updateVisibleTimeHP(n))),d.raf.scheduleRedraw()}function i(t,r=!1){var n=""+t,a=document.querySelector("#track_"+n);if(a)a.scrollIntoView({behavior:"smooth",block:"nearest"});else{let e=null;a=(0,u.getContainingGroupKey)(f.globals.state,n);a&&(e=document.querySelector("#track_"+a)),a&&e?r?(f.globals.scrollToTrackKey=t,f.globals.dispatch(s.Actions.toggleTrackGroupCollapsed({groupKey:a}))):e.scrollIntoView({behavior:"smooth",block:"nearest"}):console.error(`Can't scroll, track (${n}) not found.`)}}}return Uc}function jc(){if(!xc){xc=1,Object.defineProperty(Fc,"__esModule",{value:!0}),Fc.SliceRef=void 0,Fc.sliceRef=function(e,t){return(0,a.default)(r,{id:e.id,name:t??e.name,ts:e.ts,dur:e.dur,sqlTrackId:e.trackId})};const a=or.__importDefault(ae()),i=K(),e=se(),t=X(),o=oe(),s=Bc(),l=Rr();class r{view(r){const n=r.attrs.switchToCurrentSelectionTab??!0;return(0,a.default)(e.Anchor,{icon:t.Icons.UpdateSelection,onclick:()=>{var e,t=o.globals.trackManager.trackKeyByTrackId.get(r.attrs.sqlTrackId);void 0!==t&&((0,s.verticalScrollToTrack)(t,!0),e=l.BigintMath.max(1n,r.attrs.dur),(0,s.focusHorizontalRange)(r.attrs.ts,i.Time.fromRaw(r.attrs.ts+e)),o.globals.setLegacySelection({kind:"SLICE",id:r.attrs.id,trackKey:t,table:"slice"},{clearSearch:!0,pendingScrollId:void 0,switchToCurrentSelectionTab:n}))}},r.attrs.name)}}Fc.SliceRef=r}return Fc}function Hc(){if(!Lc){Lc=1,Object.defineProperty(wc,"__esModule",{value:!0}),wc.renderCell=function(e,t,r){if(e.display)switch(e.display?.type){case"slice_id":return function(e,t){var r=e.display,e=t[e.alias],n=t[r.ts],a=null===t[r.dur]?-1n:t[r.dur],t=t[r.trackId],i=(e,t)=>(0,m.renderError)(e+` column ${t} not found`),o=(e,t,r)=>(0,m.renderError)(`Wrong type for ${e} column ${t}: bigint expected, ${typeof r} found`);return"bigint"==typeof e?void 0===n?i("Timestamp",r.ts):"bigint"!=typeof n?o("timestamp",r.ts,n):void 0===a?i("Duration",r.dur):"bigint"==typeof a?void 0===t?i("Track id",t):"bigint"==typeof t?(0,l.default)(v.SliceRef,{id:(0,b.asSliceSqlId)(Number(e)),name:""+e,ts:p.Time.fromRaw(n),dur:a,sqlTrackId:Number(t),switchToCurrentSelectionTab:!1}):o("track id",r.trackId,t):o("duration",r.dur,n):(0,h.sqlValueToReadableString)(e)}({alias:e.alias,display:e.display},t);case"timestamp":return function(e,t,r){var n=t[e.alias];return"bigint"==typeof n?(0,l.default)(y.Timestamp,{ts:p.Time.fromRaw(n),extraMenuItems:i(e,t,r)}):s(e,t,r)}(e,t,r);case"duration":case"thread_duration":return function(e,t,r){var n=t[e.alias];return"bigint"==typeof n?(0,l.default)(T.DurationWidget,{dur:p.Duration.fromRaw(n),extraMenuItems:i(e,t,r)}):s(e,t,r)}(e,t,r)}return s(e,t,r)};const l=or.__importDefault(ae()),c=Ws(),u=te(),d=X(),f=J(),p=K(),h=D(),g=se(),m=Ic(),_=vl(),y=x(),T=L(),b=Nc(),v=jc();function o(e,t,r){return(0,l.default)(_.MenuItem,{label:e,onclick:()=>{r.addFilter(t)}})}function a(e,t){t=t[e.alias];return null===(e=t)?(0,l.default)("i","NULL"):(0,h.sqlValueToReadableString)(e)}function i(e,t,r){var n,a,i=[],t=t[e.alias],t=((0,u.isString)(t)&&i.push((a="Copy",n=t,(0,l.default)(_.MenuItem,{icon:d.Icons.Copy,label:a,onclick:()=>{(0,c.copyToClipboard)(n)}}))),a=e,e=r,null===(r=t)?[o("is null",a.expression+" is null",e),o("is not null",a.expression+" is not null",e)]:(0,u.isString)(r)?[o("equals to",a.expression+" = "+(0,f.sqliteString)(r),e),o("not equals to",a.expression+" != "+(0,f.sqliteString)(r),e)]:"bigint"==typeof r||"number"==typeof r?[o("equals to",a.expression+" = "+r,e),o("not equals to",a.expression+" != "+r,e),o("greater than",a.expression+" > "+r,e),o("greater or equals than",a.expression+" >= "+r,e),o("less than",a.expression+" < "+r,e),o("less or equals than",a.expression+" <= "+r,e)]:[]);return 0<t.length&&i.push((0,l.default)(_.MenuItem,{label:"Add filter",icon:d.Icons.Filter},...t)),i}function s(e,t,r){var n=a(e,t),e=i(e,t,r);return(0,l.default)(_.PopupMenu2,{trigger:(0,l.default)(g.Anchor,n)},...e)}}return wc}var Gc,Vc={},Wc={},qc={},$c={exports:{}};function jo(){if(!Gc){Gc=1;var e=$c.exports;{function c(e,t,r){return e.fields=t||[],e.fname=r,e}function L(e){return null==e?null:e.fname}function s(e){return null==e?null:e.fields}function u(e){return 1===e.length?Se(e[0]):Ae(e)}const Se=t=>function(e){return e[t]},Ae=r=>{const n=r.length;return function(t){for(let e=0;e<n;++e)t=t[r[e]];return t}};function d(e){throw Error(e)}function f(e){const t=[],r=e.length;let n=null,a=0,i="",o,s,l;function c(){t.push(i+e.substring(o,s)),i="",o=s+1}for(e+="",o=s=0;s<r;++s)"\\"===(l=e[s])?(i+=e.substring(o,s++),o=s):l===n?(c(),n=null,a=-1):n||(o===a&&'"'===l||o===a&&"'"===l?(o=s+1,n=l):"."!==l||a?"["===l?(s>o&&c(),a=o=s+1):"]"===l&&(a||d("Access path missing open bracket: "+e),0<a&&c(),a=0,o=s+1):s>o?c():o=s+1);return a&&d("Access path missing closing bracket: "+e),n&&d("Access path missing closing quote: "+e),s>o&&(s++,c()),t}function l(e,t,r){var n=f(e);return e=1===n.length?n[0]:e,c((r&&r.get||u)(n),[e],t||e)}const Oe=l("id"),E=c(e=>e,[],"identity"),Ce=c(()=>0,[],"zero"),ke=c(()=>1,[],"one"),we=c(()=>!0,[],"true"),Re=c(()=>!1,[],"false");function F(e,t,r){t=[t].concat([].slice.call(r));console[e].apply(console,t)}const S=0,A=1,O=2,C=3,k=4;function U(e,t,r=F){let n=e||S;return{level(e){return arguments.length?(n=+e,this):n},error(){return n>=A&&r(t||"error","ERROR",arguments),this},warn(){return n>=O&&r(t||"warn","WARN",arguments),this},info(){return n>=C&&r(t||"log","INFO",arguments),this},debug(){return n>=k&&r(t||"log","DEBUG",arguments),this}}}var o=Array.isArray;function p(e){return e===Object(e)}const w=e=>"__proto__"!==e;function B(...e){return e.reduce((e,t)=>{for(const n in t){var r;"signals"===n?e.signals=j(e.signals,t.signals):(r="legend"===n?{layout:1}:"style"===n||null,h(e,n,t[n],r))}return e},{})}function h(r,n,a,i){if(w(n)){let e,t;if(p(a)&&!o(a))for(e in t=p(r[n])?r[n]:r[n]={},a)i&&(!0===i||i[e])?h(t,e,a[e]):w(e)&&(t[e]=a[e]);else r[n]=a}}function j(e,t){if(null==e)return t;const r={},n=[];function a(e){r[e.name]||(r[e.name]=1,n.push(e))}return t.forEach(a),e.forEach(a),n}function g(e){return e[e.length-1]}function n(e){return null==e||""===e?null:+e}const R=t=>e=>t*Math.exp(e),I=t=>e=>Math.log(t*e),M=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),P=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t,N=t=>e=>e<0?-Math.pow(-e,t):Math.pow(e,t);function a(e,t,r,n){var a=r(e[0]),r=r(g(e)),e=(r-a)*t;return[n(a-e),n(r-e)]}function H(e,t){return a(e,t,n,E)}function G(e,t){var r=Math.sign(e[0]);return a(e,t,I(r),R(r))}function V(e,t,r){return a(e,t,N(r),N(1/r))}function W(e,t,r){return a(e,t,M(r),P(r))}function i(e,t,r,n,a){var i=n(e[0]),e=n(g(e)),n=null!=t?n(t):(i+e)/2;return[a(n+(i-n)*r),a(n+(e-n)*r)]}function q(e,t,r){return i(e,t,r,n,E)}function $(e,t,r){var n=Math.sign(e[0]);return i(e,t,r,I(n),R(n))}function z(e,t,r,n){return i(e,t,r,N(n),N(1/n))}function K(e,t,r,n){return i(e,t,r,M(n),P(n))}function Y(e){return 1+~~(new Date(e).getMonth()/3)}function J(e){return 1+~~(new Date(e).getUTCMonth()/3)}function m(e){return null!=e?o(e)?e:[e]:[]}function Z(e,t,r){let n=e[0],a=e[1],i;return a<n&&(i=a,a=n,n=i),(i=a-n)>=r-t?[t,r]:[n=Math.min(Math.max(n,t),r-i),n+i]}function _(e){return"function"==typeof e}const Ie="descending";function Q(e,r,n){n=n||{},r=m(r)||[];const a=[],i=[],o={},t=n.comparator||Me;return m(e).forEach((e,t)=>{null!=e&&(a.push(r[t]===Ie?-1:1),i.push(e=_(e)?e:l(e,null,n)),(s(e)||[]).forEach(e=>o[e]=1))}),0===i.length?null:c(t(i,a),Object.keys(o))}const D=(e,t)=>(e<t||null==e)&&null!=t?-1:(t<e||null==t)&&null!=e?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t==t?-1:t!=t&&e==e?1:0),Me=(e,t)=>1===e.length?Pe(e[0],t[0]):Ne(e,t,e.length),Pe=(r,n)=>function(e,t){return D(r(e),r(t))*n},Ne=(i,o,s)=>(o.push(0),function(e,t){let r,n=0,a=-1;for(;0===n&&++a<s;)r=i[a],n=D(r(e),r(t));return n*o[a]});function X(e){return _(e)?e:()=>e}function ee(t,r){let n;return e=>{n&&clearTimeout(n),n=setTimeout(()=>(r(e),n=null),t)}}function y(a){for(let e,t,r=1,n=arguments.length;r<n;++r)for(t in e=arguments[r])a[t]=e[t];return a}function te(e,t){let r=0,n,a,i,o;if(e&&(n=e.length))if(null==t){for(a=e[r];r<n&&(null==a||a!=a);a=e[++r]);for(i=o=a;r<n;++r)null!=(a=e[r])&&(a<i&&(i=a),a>o)&&(o=a)}else{for(a=t(e[r]);r<n&&(null==a||a!=a);a=t(e[++r]));for(i=o=a;r<n;++r)null!=(a=t(e[r]))&&(a<i&&(i=a),a>o)&&(o=a)}return[i,o]}function re(e,t){var r=e.length;let n=-1,a,i,o,s,l;if(null==t){for(;++n<r;)if(null!=(i=e[n])&&i>=i){a=o=i;break}if(n===r)return[-1,-1];for(s=l=n;++n<r;)null!=(i=e[n])&&(a>i&&(a=i,s=n),o<i)&&(o=i,l=n)}else{for(;++n<r;)if(null!=(i=t(e[n],n,e))&&i>=i){a=o=i;break}if(n===r)return[-1,-1];for(s=l=n;++n<r;)null!=(i=t(e[n],n,e))&&(a>i&&(a=i,s=n),o<i)&&(o=i,l=n)}return[s,l]}const De=Object.prototype.hasOwnProperty;function T(e,t){return De.call(e,t)}const x={};function ne(t){let a={},i;function r(e){return T(a,e)&&a[e]!==x}const o={size:0,empty:0,object:a,has:r,get(e){return r(e)?a[e]:void 0},set(e,t){return r(e)||(++o.size,a[e]===x&&--o.empty),a[e]=t,this},delete(e){return r(e)&&(--o.size,++o.empty,a[e]=x),this},clear(){o.size=o.empty=0,o.object=a={}},test(e){return arguments.length?(i=e,o):i},clean(){var e={};let t=0;for(const n in a){var r=a[n];r===x||i&&i(r)||(e[n]=r,++t)}o.size=t,o.empty=0,o.object=a=e}};return t&&Object.keys(t).forEach(e=>{o.set(e,t[e])}),o}function ae(e,t,r,n,a,i){if(!r&&0!==r)return i;r=+r;let o=e[0],s=g(e),l;s<o&&(l=o,o=s,s=l),l=Math.abs(t-o);e=Math.abs(s-t);return l<e&&l<=r?n:e<=r?a:i}function ie(e,t,r){t=e.prototype=Object.create(t.prototype);return Object.defineProperty(t,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),y(t,r)}function oe(e,t,r,n){let a=t[0],i=t[t.length-1],o;return a>i&&(o=a,a=i,i=o),n=void 0===n||n,((r=void 0===r||r)?a<=e:a<e)&&(n?e<=i:e<i)}function se(e){return"boolean"==typeof e}function t(e){return"[object Date]"===Object.prototype.toString.call(e)}function le(e){return e&&_(e[Symbol.iterator])}function r(e){return"number"==typeof e}function ce(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function b(e){return"string"==typeof e}function ue(e,t,r){const n=(e=e&&(t?m(e).map(e=>e.replace(/\\(.)/g,"$1")):m(e)))&&e.length,a=r&&r.get||u,i=e=>a(t?[e]:f(e));let o;if(n)if(1===n){const s=i(e[0]);o=function(e){return""+s(e)}}else{const l=e.map(i);o=function(e){let t=""+l[0](e),r=0;for(;++r<n;)t+="|"+l[r](e);return t}}else o=function(){return""};return c(o,e,"key")}function de(e,t){var r=e[0],e=g(e),t=+t;return t?1==t?e:r+t*(e-r):r}const xe=1e4;function fe(r){r=+r||xe;let n,a,i;var e=()=>{n={},a={},i=0};const o=(e,t)=>(++i>r&&(a=n,n={},i=1),n[e]=t);return e(),{clear:e,has:e=>T(n,e)||T(a,e),get:e=>T(n,e)?n[e]:T(a,e)?o(e,a[e]):void 0,set:(e,t)=>T(n,e)?n[e]=t:o(e,t)}}function pe(e,t,r,n){var a=t.length,i=r.length;if(!i)return t;if(!a)return r;var o=n||new t.constructor(a+i);let s=0,l=0,c=0;for(;s<a&&l<i;++c)o[c]=0<e(t[s],r[l])?r[l++]:t[s++];for(;s<a;++s,++c)o[c]=t[s];for(;l<i;++l,++c)o[c]=r[l];return o}function v(e,t){let r="";for(;0<=--t;)r+=e;return r}function he(e,t,r,n){r=r||" ",e+="",t-=e.length;return t<=0?e:"left"===n?v(r,t)+e:"center"===n?v(r,~~(t/2))+e+v(r,Math.ceil(t/2)):e+v(r,t)}function ge(e){return e&&g(e)-e[0]||0}function me(e){return o(e)?"["+e.map(me)+"]":p(e)||b(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function _e(e){return null==e||""===e?null:!(!e||"false"===e||"0"===e||!e)}const Le=e=>r(e)||t(e)?e:Date.parse(e);function ye(e,t){return t=t||Le,null==e||""===e?null:t(e)}function Te(e){return null==e||""===e?null:e+""}function be(t){var r={},n=t.length;for(let e=0;e<n;++e)r[t[e]]=!0;return r}function ve(e,t,r,n){var n=null!=n?n:"…",e=e+"",a=e.length,i=Math.max(0,t-n.length);return a<=t?e:"left"===r?n+e.slice(a-i):"center"===r?e.slice(0,Math.ceil(i/2))+n+e.slice(a-~~(i/2)):e.slice(0,i)+n}function Ee(t,r,n){if(t)if(r){var a=t.length;for(let e=0;e<a;++e){var i=r(t[e]);i&&n(i,e,t)}}else t.forEach(n)}e.Debug=k,e.Error=A,e.Info=C,e.None=S,e.Warn=O,e.accessor=c,e.accessorFields=s,e.accessorName=L,e.array=m,e.ascending=D,e.clampRange=Z,e.compare=Q,e.constant=X,e.debounce=ee,e.error=d,e.extend=y,e.extent=te,e.extentIndex=re,e.falsy=Re,e.fastmap=ne,e.field=l,e.flush=ae,e.hasOwnProperty=T,e.id=Oe,e.identity=E,e.inherits=ie,e.inrange=oe,e.isArray=o,e.isBoolean=se,e.isDate=t,e.isFunction=_,e.isIterable=le,e.isNumber=r,e.isObject=p,e.isRegExp=ce,e.isString=b,e.key=ue,e.lerp=de,e.logger=U,e.lruCache=fe,e.merge=pe,e.mergeConfig=B,e.one=ke,e.pad=he,e.panLinear=H,e.panLog=G,e.panPow=V,e.panSymlog=W,e.peek=g,e.quarter=Y,e.repeat=v,e.span=ge,e.splitAccessPath=f,e.stringValue=me,e.toBoolean=_e,e.toDate=ye,e.toNumber=n,e.toSet=be,e.toString=Te,e.truncate=ve,e.truthy=we,e.utcquarter=J,e.visitArray=Ee,e.writeConfig=h,e.zero=Ce,e.zoomLinear=q,e.zoomLog=$,e.zoomPow=z,e.zoomSymlog=K}}return $c.exports}var zc,Kc={exports:{}},Yc={exports:{}},Jc={exports:{}};function Zc(){var e;return zc||(zc=1,(e=Jc.exports).bbox=h,e.feature=function(t,e){"string"==typeof e&&(e=t.objects[e]);return"GeometryCollection"===e.type?{type:"FeatureCollection",features:e.geometries.map(function(e){return r(t,e)})}:r(t,e)},e.merge=function(e){return u(e,a.apply(this,arguments))},e.mergeArcs=a,e.mesh=function(e){return u(e,n.apply(this,arguments))},e.meshArcs=n,e.neighbors=function(e){var n={},t=e.map(function(){return[]});function r(e,r){e.forEach(function(e){var t=n[e=e<0?~e:e];t?t.push(r):n[e]=[r]})}function a(e,t){e.forEach(function(e){r(e,t)})}var i,o={LineString:r,MultiLineString:a,Polygon:a,MultiPolygon:function(e,t){e.forEach(function(e){a(e,t)})}};for(i in e.forEach(function t(e,r){"GeometryCollection"===e.type?e.geometries.forEach(function(e){t(e,r)}):e.type in o&&o[e.type](e.arcs,r)}),n)for(var s=n[i],l=s.length,c=0;c<l;++c)for(var u=c+1;u<l;++u){var d,f=s[c],p=s[u];(d=t[f])[i=g(d,p)]!==p&&d.splice(i,0,p),(d=t[p])[i=g(d,f)]!==f&&d.splice(i,0,f)}return t},e.quantize=function(e,t){if(e.transform)throw new Error("already quantized");if(t&&t.scale)s=e.bbox;else{if(!(2<=(r=Math.floor(t))))throw new Error("n must be ≥2");var r,n=(s=e.bbox||h(e))[0],a=s[1],i=s[2],o=s[3];t={scale:[i-n?(i-n)/(r-1):1,o-a?(o-a)/(r-1):1],translate:[n,a]}}var s,l,c=m(t),u=e.objects,d={};function f(e){return c(e)}function p(e){var t;switch(e.type){case"GeometryCollection":t={type:"GeometryCollection",geometries:e.geometries.map(p)};break;case"Point":t={type:"Point",coordinates:f(e.coordinates)};break;case"MultiPoint":t={type:"MultiPoint",coordinates:e.coordinates.map(f)};break;default:return e}return null!=e.id&&(t.id=e.id),null!=e.bbox&&(t.bbox=e.bbox),null!=e.properties&&(t.properties=e.properties),t}for(l in u)d[l]=p(u[l]);return{type:"Topology",bbox:s,transform:t,objects:d,arcs:e.arcs.map(function(e){var t,r=0,n=1,a=e.length,i=new Array(a);for(i[0]=c(e[0],0);++r<a;)((t=c(e[r],r))[0]||t[1])&&(i[n++]=t);return 1===n&&(i[n++]=[0,0]),i.length=n,i})}},e.transform=c,e.untransform=m,Object.defineProperty(e,"__esModule",{value:!0})),Jc.exports;function t(e){return e}function c(e){var i,o,s,l,c,u;return null==e?t:(s=e.scale[0],l=e.scale[1],c=e.translate[0],u=e.translate[1],function(e,t){t||(i=o=0);var r=2,n=e.length,a=new Array(n);for(a[0]=(i+=e[0])*s+c,a[1]=(o+=e[1])*l+u;r<n;)a[r]=e[r],++r;return a})}function h(e){var t,a=c(e.transform),i=1/0,o=i,s=-i,l=-i;function r(e){(e=a(e))[0]<i&&(i=e[0]),e[0]>s&&(s=e[0]),e[1]<o&&(o=e[1]),e[1]>l&&(l=e[1])}function n(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(n);break;case"Point":r(e.coordinates);break;case"MultiPoint":e.coordinates.forEach(r)}}for(t in e.arcs.forEach(function(e){for(var t,r=-1,n=e.length;++r<n;)(t=a(e[r],r))[0]<i&&(i=t[0]),t[0]>s&&(s=t[0]),t[1]<o&&(o=t[1]),t[1]>l&&(l=t[1])}),e.objects)n(e.objects[t]);return[i,o,s,l]}function r(e,t){var r=t.id,n=t.bbox,a=null==t.properties?{}:t.properties,e=u(e,t);return null==r&&null==n?{type:"Feature",properties:a,geometry:e}:null==n?{type:"Feature",id:r,properties:a,geometry:e}:{type:"Feature",id:r,bbox:n,properties:a,geometry:e}}function u(e,t){var p=c(e.transform),h=e.arcs;function a(e){return p(e)}function i(e){for(var t=[],r=0,n=e.length;r<n;++r){f=d=c=u=l=s=o=i=a=void 0;var a=e[r],i=t;i.length&&i.pop();for(var o=h[a<0?~a:a],s=0,l=o.length;s<l;++s)i.push(p(o[s],s));if(a<0)for(var c,u=i,a=l,d=u.length,f=d-a;f<--d;)c=u[f],u[f++]=u[d],u[d]=c}return t.length<2&&t.push(t[0]),t}function r(e){for(var t=i(e);t.length<4;)t.push(t[0]);return t}function o(e){return e.map(r)}return function e(t){var r,n=t.type;switch(n){case"GeometryCollection":return{type:n,geometries:t.geometries.map(e)};case"Point":r=a(t.coordinates);break;case"MultiPoint":r=t.coordinates.map(a);break;case"LineString":r=i(t.arcs);break;case"MultiLineString":r=t.arcs.map(i);break;case"Polygon":r=o(t.arcs);break;case"MultiPolygon":r=t.arcs.map(o);break;default:return null}return{type:n,coordinates:r}}(t)}function p(o,n){var a={},s={},l={},i=[],c=-1;function e(e,t){for(var r in e){r=e[r];delete t[r.start],delete r.start,delete r.end,r.forEach(function(e){a[e<0?~e:e]=1}),i.push(r)}}return n.forEach(function(e,t){var r=o.arcs[e<0?~e:e];r.length<3&&!r[1][0]&&!r[1][1]&&(r=n[++c],n[c]=e,n[t]=r)}),n.forEach(function(e){var t,r,n,a=function(e){var t,r=o.arcs[e<0?~e:e],n=r[0];o.transform?(t=[0,0],r.forEach(function(e){t[0]+=e[0],t[1]+=e[1]})):t=r[r.length-1];return e<0?[t,n]:[n,t]}(e),i=a[0],a=a[1];(t=l[i])?(delete l[t.end],t.push(e),t.end=a,(r=s[a])?(delete s[r.start],n=r===t?t:t.concat(r),s[n.start=t.start]=l[n.end=r.end]=n):s[t.start]=l[t.end]=t):(t=s[a])?(delete s[t.start],t.unshift(e),t.start=i,(r=l[i])?(delete l[r.end],n=r===t?t:r.concat(t),s[n.start=r.start]=l[n.end=t.end]=n):s[t.start]=l[t.end]=t):s[(t=[e]).start=i]=l[t.end=a]=t}),e(l,s),e(s,l),n.forEach(function(e){a[e<0?~e:e]||i.push([e])}),i}function n(e,t,r){var n,a,i,o,s,l,c;if(1<arguments.length)o=r,l=[],c=[],function e(t){switch((s=t).type){case"GeometryCollection":t.geometries.forEach(e);break;case"LineString":d(t.arcs);break;case"MultiLineString":case"Polygon":f(t.arcs);break;case"MultiPolygon":t.arcs.forEach(f)}}(t),c.forEach(null==o?function(e){l.push(e[0].i)}:function(e){o(e[0].g,e[e.length-1].g)&&l.push(e[0].i)}),n=l;else for(a=0,n=new Array(i=e.arcs.length);a<i;++a)n[a]=a;function u(e){var t=e<0?~e:e;(c[t]||(c[t]=[])).push({i:e,g:s})}function d(e){e.forEach(u)}function f(e){e.forEach(d)}return{type:"MultiLineString",arcs:p(e,n)}}function a(s,e){var l={},r=[],n=[];function a(t){t.forEach(function(e){e.forEach(function(e){(l[e=e<0?~e:e]||(l[e]=[])).push(t)})}),r.push(t)}function c(e){for(var t,r=u(s,{type:"Polygon",arcs:[e]}).coordinates[0],n=-1,a=r.length,i=r[a-1],o=0;++n<a;)t=i,i=r[n],o+=t[0]*i[1]-t[1]*i[0];return Math.abs(o)}return e.forEach(function e(t){switch(t.type){case"GeometryCollection":t.geometries.forEach(e);break;case"Polygon":a(t.arcs);break;case"MultiPolygon":t.arcs.forEach(a)}}),r.forEach(function(e){if(!e._){var t=[],r=[e];for(e._=1,n.push(t);e=r.pop();)t.push(e),e.forEach(function(e){e.forEach(function(e){l[e<0?~e:e].forEach(function(e){e._||(e._=1,r.push(e))})})})}}),r.forEach(function(e){delete e._}),{type:"MultiPolygon",arcs:n.map(function(e){var t,r=[];if(e.forEach(function(e){e.forEach(function(e){e.forEach(function(e){l[e<0?~e:e].length<2&&r.push(e)})})}),1<(t=(r=p(s,r)).length))for(var n,a,i=1,o=c(r[0]);i<t;++i)(n=c(r[i]))>o&&(a=r[0],r[0]=r[i],r[i]=a,o=n);return r}).filter(function(e){return 0<e.length})}}function g(e,t){for(var r=0,n=e.length;r<n;){var a=r+n>>>1;e[a]<t?r=1+a:n=a}return r}function m(e){var o,s,l,c,u,d;return null==e?t:(l=e.scale[0],c=e.scale[1],u=e.translate[0],d=e.translate[1],function(e,t){t||(o=s=0);var r=2,n=e.length,a=new Array(n),t=Math.round((e[0]-u)/l),i=Math.round((e[1]-d)/c);for(a[0]=t-o,o=t,a[1]=i-s,s=i;r<n;)a[r]=e[r],++r;return a})}}var Qc,Xc,eu,tu,ru={exports:{}},nu={exports:{}};function au(){if(!Qc){Qc=1;{var e=nu.exports;var _=jo();const y="year",T="quarter",b="month",v="week",E="date",S="day",A="dayofyear",O="hours",C="minutes",k="seconds",w="milliseconds";var L=[y,T,b,v,E,S,A,O,C,k,w];const c=L.reduce((e,t,r)=>(e[t]=1+r,e),{});function F(e){const t=_.array(e).slice(),r={};return t.length||_.error("Missing time unit."),t.forEach(e=>{_.hasOwnProperty(c,e)?r[e]=1:_.error(`Invalid time unit: ${e}.`)}),1<(r[v]||r[S]?1:0)+(r[T]||r[b]||r[E]?1:0)+(r[A]?1:0)&&_.error("Incompatible time units: "+e),t.sort((e,t)=>c[e]-c[t]),t}const ue={[y]:"%Y ",[T]:"Q%q ",[b]:"%b ",[E]:"%d ",[v]:"W%U ",[S]:"%a ",[A]:"%j ",[O]:"%H:00",[C]:"00:%M",[k]:":%S",[w]:".%L",[y+"-"+b]:"%Y-%m ",[`${y}-${b}-`+E]:"%Y-%m-%d ",[O+"-"+C]:"%H:%M"};const u=new Date,d=new Date;function a(i,o,r,n){function s(e){return i(e=0===arguments.length?new Date:new Date(+e)),e}return s.floor=e=>(i(e=new Date(+e)),e),s.ceil=e=>(i(e=new Date(e-1)),o(e,1),i(e),e),s.round=e=>{var t=s(e),r=s.ceil(e);return e-t<r-e?t:r},s.offset=(e,t)=>(o(e=new Date(+e),null==t?1:Math.floor(t)),e),s.range=(e,t,r)=>{var n,a=[];if(e=s.ceil(e),r=null==r?1:Math.floor(r),e<t&&0<r)for(;a.push(n=new Date(+e)),o(e,r),i(e),n<e&&e<t;);return a},s.filter=r=>a(e=>{if(e<=e)for(;i(e),!r(e);)e.setTime(e-1)},(e,t)=>{if(e<=e)if(t<0)for(;++t<=0;)for(;o(e,-1),!r(e););else for(;0<=--t;)for(;o(e,1),!r(e););}),r&&(s.count=(e,t)=>(u.setTime(+e),d.setTime(+t),i(u),i(d),Math.floor(r(u,d))),s.every=t=>(t=Math.floor(t),isFinite(t)&&0<t?1<t?s.filter(n?e=>n(e)%t==0:e=>s.count(0,e)%t==0):s:null)),s}const f=a(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e),p=(f.every=r=>(r=Math.floor(r),isFinite(r)&&0<r?1<r?a(e=>{e.setTime(Math.floor(e/r)*r)},(e,t)=>{e.setTime(+e+t*r)},(e,t)=>(t-e)/r):f:null),f.range,6e4),h=60*p,g=24*h,de=7*g;var U=a(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+1e3*t)},(e,t)=>(t-e)/1e3,e=>e.getUTCSeconds()),B=(U.range,a(e=>{e.setTime(e-e.getMilliseconds()-1e3*e.getSeconds())},(e,t)=>{e.setTime(+e+t*p)},(e,t)=>(t-e)/p,e=>e.getMinutes())),j=(B.range,a(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*p)},(e,t)=>(t-e)/p,e=>e.getUTCMinutes())),H=(j.range,a(e=>{e.setTime(e-e.getMilliseconds()-1e3*e.getSeconds()-e.getMinutes()*p)},(e,t)=>{e.setTime(+e+t*h)},(e,t)=>(t-e)/h,e=>e.getHours())),G=(H.range,a(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*h)},(e,t)=>(t-e)/h,e=>e.getUTCHours()));G.range;const m=a(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*p)/g,e=>e.getDate()-1),R=(m.range,a(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/g,e=>e.getUTCDate()-1));function t(t){return a(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,t)=>{e.setDate(e.getDate()+7*t)},(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*p)/de)}R.range,a(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/g,e=>Math.floor(e/g)).range;const I=t(0);var r=t(1),n=t(2),i=t(3),o=t(4),V=t(5),W=t(6);function s(t){return a(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)},(e,t)=>(t-e)/de)}I.range,r.range,n.range,i.range,o.range,V.range,W.range;const fe=s(0);r=s(1),n=s(2),i=s(3),o=s(4),V=s(5),W=s(6),fe.range,r.range,n.range,i.range,o.range,V.range,W.range,r=a(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear()),e=>e.getMonth()),r.range,n=a(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear()),e=>e.getUTCMonth()),n.range,i=a(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear()),i.every=r=>isFinite(r=Math.floor(r))&&0<r?a(e=>{e.setFullYear(Math.floor(e.getFullYear()/r)*r),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t*r)}):null,i.range,o=a(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());function q(e,t){return null==e||null==t?NaN:e<t?-1:t<e?1:t<=e?0:NaN}function $(r){let i,o,a;function s(e,t,r=0,n=e.length){if(r<n){if(0!==i(t,t))return n;do{var a=r+n>>>1;o(e[a],t)<0?r=1+a:n=a}while(r<n)}return r}return a=2!==r.length?(i=q,o=(e,t)=>q(r(e),t),(e,t)=>r(e)-t):(i=r===q||r===function(e,t){return null==e||null==t?NaN:t<e?-1:e<t?1:e<=t?0:NaN}?r:z,o=r),{left:s,center:function(e,t,r=0,n=e.length){return n=s(e,t,r,n-1),r<n&&a(e[n-1],t)>-a(e[n],t)?n-1:n},right:function(e,t,r=0,n=e.length){if(r<n){if(0!==i(t,t))return n;do{var a=r+n>>>1;o(e[a],t)<=0?r=1+a:n=a}while(r<n)}return r}}}function z(){return 0}o.every=r=>isFinite(r=Math.floor(r))&&0<r?a(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/r)*r),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t*r)}):null,o.range;const pe=Math.sqrt(50),he=Math.sqrt(10),ge=Math.sqrt(2);function K(e,t,r){return function e(t,r,n){var a=(r-t)/Math.max(0,n),i=Math.floor(Math.log10(a)),a=a/Math.pow(10,i),a=a>=pe?10:a>=he?5:a>=ge?2:1;let o,s,l;return i<0?(l=Math.pow(10,-i)/a,o=Math.round(t*l),s=Math.round(r*l),o/l<t&&++o,s/l>r&&--s,l=-l):(l=Math.pow(10,i)*a,o=Math.round(t/l),s=Math.round(r/l),o*l<t&&++o,s*l>r&&--s),s<o&&.5<=n&&n<2?e(t,r,2*n):[o,s,l]}(e=+e,t=+t,r=+r)[2]}function Y(e,t,r){r=+r;var n=(t=+t)<(e=+e),e=n?K(t,e,r):K(e,t,r);return(n?-1:1)*(e<0?1/-e:e)}const M=new Date;function J(e){return M.setFullYear(e),M.setMonth(0),M.setDate(1),M.setHours(0,0,0,0),M}function Z(e){return m.count(J(e.getFullYear())-1,e)}function Q(e){return I.count(J(e.getFullYear())-1,e)}function X(e){return J(e).getDay()}function ee(e,t,r,n,a,i,o){var s;return 0<=e&&e<100?((s=new Date(-1,t,r,n,a,i,o)).setFullYear(e),s):new Date(e,t,r,n,a,i,o)}function te(e){var t=Date.UTC(e.getUTCFullYear(),0,1);return R.count(t-1,e)}function re(e){var t=Date.UTC(e.getUTCFullYear(),0,1);return fe.count(t-1,e)}function ne(e){return M.setTime(Date.UTC(e,0,1)),M.getUTCDay()}function ae(e,t,r,n,a,i,o){var s;return 0<=e&&e<100?((s=new Date(Date.UTC(-1,t,r,n,a,i,o))).setUTCFullYear(r.y),s):new Date(Date.UTC(e,t,r,n,a,i,o))}function ie(e,t,l,c,r){const u=t||1,d=_.peek(e),n=(e,t,r)=>{r=r||e;{var n=l[r],a=c[r],i=e===d&&u,o=t;const s=i<=1?n:o?(e,t)=>o+i*Math.floor((n(e,t)-o)/i):(e,t)=>i*Math.floor(n(e,t)/i);return a?(e,t)=>a(s(e,t),t):s}},a=new Date,i=_.toSet(e),o=i[y]?n(y):_.constant(2012),s=i[b]?n(b):i[T]?n(T):_.zero,f=i[v]&&i[S]?n(S,1,v+S):i[v]?n(v,1):i[S]?n(S,1):i[E]?n(E,1):i[A]?n(A,1):_.one,p=i[O]?n(O):_.zero,h=i[C]?n(C):_.zero,g=i[k]?n(k):_.zero,m=i[w]?n(w):_.zero;return function(e){a.setTime(+e);e=o(a);return r(e,s(a),f(a,e),p(a),h(a),g(a),m(a))}}function l(e,t,r){return t+7*e-(r+6)%7}const me={[y]:e=>e.getFullYear(),[T]:e=>Math.floor(e.getMonth()/3),[b]:e=>e.getMonth(),[E]:e=>e.getDate(),[O]:e=>e.getHours(),[C]:e=>e.getMinutes(),[k]:e=>e.getSeconds(),[w]:e=>e.getMilliseconds(),[A]:e=>Z(e),[v]:e=>Q(e),[v+S]:(e,t)=>l(Q(e),e.getDay(),X(t)),[S]:(e,t)=>l(1,e.getDay(),X(t))},_e={[T]:e=>3*e,[v]:(e,t)=>l(e,0,X(t))};const ye={[y]:e=>e.getUTCFullYear(),[T]:e=>Math.floor(e.getUTCMonth()/3),[b]:e=>e.getUTCMonth(),[E]:e=>e.getUTCDate(),[O]:e=>e.getUTCHours(),[C]:e=>e.getUTCMinutes(),[k]:e=>e.getUTCSeconds(),[w]:e=>e.getUTCMilliseconds(),[A]:e=>te(e),[v]:e=>re(e),[S]:(e,t)=>l(1,e.getUTCDay(),ne(t)),[v+S]:(e,t)=>l(re(e),e.getUTCDay(),ne(t))},Te={[T]:e=>3*e,[v]:(e,t)=>l(e,0,ne(t))};const be={[y]:i,[T]:r.every(3),[b]:r,[v]:I,[E]:m,[S]:m,[A]:m,[O]:H,[C]:B,[k]:U,[w]:f},ve={[y]:o,[T]:n.every(3),[b]:n,[v]:fe,[E]:R,[S]:R,[A]:R,[O]:G,[C]:j,[k]:U,[w]:f};function oe(e){return be[e]}function se(e){return ve[e]}function le(e,t,r){return e?e.offset(t,r):void 0}function ce(e,t,r,n){return e?e.range(t,r,n):void 0}const Ee=31536e6,Se=[y,b,E,O,C,k,w],P=Se.slice(0,-1),N=P.slice(0,-1),D=N.slice(0,-1),Ae=D.slice(0,-1),Oe=[y,v],Ce=[y,b],ke=[y],x=[[P,1,1e3],[P,5,5e3],[P,15,15e3],[P,30,3e4],[N,1,6e4],[N,5,3e5],[N,15,9e5],[N,30,18e5],[D,1,36e5],[D,3,108e5],[D,6,216e5],[D,12,432e5],[Ae,1,864e5],[Oe,1,6048e5],[Ce,1,2592e6],[Ce,3,7776e6],[ke,1,Ee]];e.DATE=E,e.DAY=S,e.DAYOFYEAR=A,e.HOURS=O,e.MILLISECONDS=w,e.MINUTES=C,e.MONTH=b,e.QUARTER=T,e.SECONDS=k,e.TIME_UNITS=L,e.WEEK=v,e.YEAR=y,e.dayofyear=function(e){return Z(new Date(e))},e.timeBin=function(e){var t=e.extent,e=e.maxbins||40,r=Math.abs(_.span(t))/e;let n=$(e=>e[2]).right(x,r),a,i;return i=n===x.length?(a=ke,Y(t[0]/Ee,t[1]/Ee,e)):n?(n=x[r/x[n-1][2]<x[n][2]/r?n-1:n],a=n[0],n[1]):(a=Se,Math.max(Y(t[0],t[1],e),1)),{units:a,step:i}},e.timeFloor=function(e,t){return ie(e,t||1,me,_e,ee)},e.timeInterval=oe,e.timeOffset=function(e,t,r){return le(oe(e),t,r)},e.timeSequence=function(e,t,r,n){return ce(oe(e),t,r,n)},e.timeUnitSpecifier=function(e,t){var r=_.extend({},ue,t),n=F(e),a=n.length;let i="",o=0,s,l;for(o=0;o<a;)for(s=n.length;s>o;--s)if(null!=r[l=n.slice(o,s).join("-")]){i+=r[l],o=s;break}return i.trim()},e.timeUnits=F,e.utcFloor=function(e,t){return ie(e,t||1,ye,Te,ae)},e.utcInterval=se,e.utcOffset=function(e,t,r){return le(se(e),t,r)},e.utcSequence=function(e,t,r,n){return ce(se(e),t,r,n)},e.utcdayofyear=function(e){return te(new Date(e))},e.utcweek=function(e){return re(new Date(e))},e.week=function(e){return Q(new Date(e))}}}return nu.exports}function iu(){if(!Xc){Xc=1;var e=ru.exports;{var b=au(),v=jo();function n(t){const r={};return e=>r[e]||(r[e]=t(e))}const Lt=Math.sqrt(50),Ft=Math.sqrt(10),Ut=Math.sqrt(2);function U(e,t,r){var n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),n=n/Math.pow(10,a),n=n>=Lt?10:n>=Ft?5:n>=Ut?2:1;let i,o,s;return a<0?(s=Math.pow(10,-a)/n,i=Math.round(e*s),o=Math.round(t*s),i/s<e&&++i,o/s>t&&--o,s=-s):(s=Math.pow(10,a)*n,i=Math.round(e/s),o=Math.round(t/s),i*s<e&&++i,o*s>t&&--o),o<i&&.5<=r&&r<2?U(e,t,2*r):[i,o,s]}function B(e,t,r){return U(e=+e,t=+t,r=+r)[2]}function j(e,t,r){r=+r;var n=(t=+t)<(e=+e),e=n?B(t,e,r):B(e,t,r);return(n?-1:1)*(e<0?1/-e:e)}function H(e){return 1e21<=Math.abs(e=Math.round(e))?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function i(e,t){var r;return(t=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0?null:[1<(r=e.slice(0,t)).length?r[0]+r.slice(2):r,+e.slice(t+1)]}function s(e){return(e=i(Math.abs(e)))?e[1]:NaN}function G(s,l){return function(e,t){for(var r=e.length,n=[],a=0,i=s[0],o=0;0<r&&0<i&&(t<o+i+1&&(i=Math.max(1,t-o)),n.push(e.substring(r-=i,r+i)),!((o+=i+1)>t));)i=s[a=(a+1)%s.length];return n.reverse().join(l)}}function V(t){return function(e){return e.replace(/[0-9]/g,function(e){return t[+e]})}}var W,q=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function k(e){var t;if(t=q.exec(e))return new a({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]});throw new Error("invalid format: "+e)}function a(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function $(e){e:for(var t,r=e.length,n=1,a=-1;n<r;++n)switch(e[n]){case".":a=t=n;break;case"0":0===a&&(a=n),t=n;break;default:if(!+e[n])break e;0<a&&(a=0)}return 0<a?e.slice(0,a)+e.slice(t+1):e}function z(e,t){var r,n,a=i(e,t);return a?(r=a[0],(a=(a=a[1])-(W=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1)===(n=r.length)?r:n<a?r+new Array(a-n+1).join("0"):0<a?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+i(e,Math.max(0,t+a-1))[0]):e+""}function K(e,t){var r,t=i(e,t);return t?(r=t[0],(t=t[1])<0?"0."+new Array(-t).join("0")+r:r.length>t+1?r.slice(0,t+1)+"."+r.slice(t+1):r+new Array(t-r.length+2).join("0")):e+""}k.prototype=a.prototype,a.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Y={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:H,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>K(100*e,t),r:K,s:z,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function J(e){return e}var o,Z,Q,X=Array.prototype.map,ee=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function te(e){var E=void 0===e.grouping||void 0===e.thousands?J:G(X.call(e.grouping,Number),e.thousands+""),n=void 0===e.currency?"":e.currency[0]+"",a=void 0===e.currency?"":e.currency[1]+"",S=void 0===e.decimal?".":e.decimal+"",A=void 0===e.numerals?J:V(X.call(e.numerals,String)),i=void 0===e.percent?"%":e.percent+"",O=void 0===e.minus?"−":e.minus+"",C=void 0===e.nan?"NaN":e.nan+"";function o(e){var c=(e=k(e)).fill,u=e.align,d=e.sign,t=e.symbol,f=e.zero,p=e.width,h=e.comma,g=e.precision,m=e.trim,_=e.type,y=("n"===_?(h=!0,_="g"):Y[_]||(void 0===g&&(g=12),m=!0,_="g"),(f||"0"===c&&"="===u)&&(f=!0,c="0",u="="),"$"===t?n:"#"===t&&/[boxX]/.test(_)?"0"+_.toLowerCase():""),T="$"===t?a:/[%p]/.test(_)?i:"",b=Y[_],v=/[defgprs%]/.test(_);function r(e){var t,r,n,a=y,i=T;if("c"===_)i=b(e)+i,e="";else{var o=(e=+e)<0||1/e<0;if(e=isNaN(e)?C:b(Math.abs(e),g),m&&(e=$(e)),a=((o=o&&0==+e&&"+"!==d?!1:o)?"("===d?d:O:"-"===d||"("===d?"":d)+a,i=("s"===_?ee[8+W/3]:"")+i+(o&&"("===d?")":""),v)for(t=-1,r=e.length;++t<r;)if((n=e.charCodeAt(t))<48||57<n){i=(46===n?S+e.slice(t+1):e.slice(t))+i,e=e.slice(0,t);break}}h&&!f&&(e=E(e,1/0));var s=a.length+e.length+i.length,l=s<p?new Array(p-s+1).join(c):"";switch(h&&f&&(e=E(l+e,l.length?p-i.length:1/0),l=""),u){case"<":e=a+e+i+l;break;case"=":e=a+l+e+i;break;case"^":e=l.slice(0,s=l.length>>1)+a+e+i+l.slice(s);break;default:e=l+a+e+i}return A(e)}return g=void 0===g?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),r.toString=function(){return e+""},r}return{format:o,formatPrefix:function(e,t){var r=o(((e=k(e)).type="f",e)),e=3*Math.max(-8,Math.min(8,Math.floor(s(t)/3))),n=Math.pow(10,-e),a=ee[8+e/3];return function(e){return r(n*e)+a}}}}function re(e){o=te(e),Z=o.format,Q=o.formatPrefix}function ne(e){return Math.max(0,-s(Math.abs(e)))}function ae(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(s(t)/3)))-s(Math.abs(e)))}function ie(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,s(t)-s(e))+1}function oe(a,i){return e=>{var t=a(e),r=t.indexOf(i);if(r<0)return t;let n=se(t,r);for(e=n<t.length?t.slice(n):"";--n>r;)if("0"!==t[n]){++n;break}return t.slice(0,n)+e}}function se(e,t){let r=e.lastIndexOf("e"),n;if(0<r)return r;for(r=e.length;--r>t;)if(48<=(n=e.charCodeAt(r))&&n<=57)return r+1}function le(e){const s=n(e.format),l=e.formatPrefix;return{format:s,formatPrefix:l,formatFloat(e){var t=k(e||",");if(null!=t.precision)return s(t);switch(t.precision=12,t.type){case"%":t.precision-=2;break;case"e":--t.precision}return oe(s(t),s(".1f")(1)[1])},formatSpan(e,t,r,n){n=k(null==n?",f":n);var a=j(e,t,r),i=Math.max(Math.abs(e),Math.abs(t));let o;if(null==n.precision)switch(n.type){case"s":return isNaN(o=ae(a,i))||(n.precision=o),l(n,i);case"":case"e":case"g":case"p":case"r":isNaN(o=ie(a,i))||(n.precision=o-("e"===n.type));break;case"f":case"%":isNaN(o=ne(a))||(n.precision=o-2*("%"===n.type))}return s(n)}}}re({thousands:",",grouping:[3],currency:["$",""]});let t;function l(){return t=le({format:Z,formatPrefix:Q})}function c(e){return le(te(e))}function u(e){return arguments.length?t=c(e):t}l();const y=new Date,T=new Date;function d(i,o,r,n){function s(e){return i(e=0===arguments.length?new Date:new Date(+e)),e}return s.floor=e=>(i(e=new Date(+e)),e),s.ceil=e=>(i(e=new Date(e-1)),o(e,1),i(e),e),s.round=e=>{var t=s(e),r=s.ceil(e);return e-t<r-e?t:r},s.offset=(e,t)=>(o(e=new Date(+e),null==t?1:Math.floor(t)),e),s.range=(e,t,r)=>{var n,a=[];if(e=s.ceil(e),r=null==r?1:Math.floor(r),e<t&&0<r)for(;a.push(n=new Date(+e)),o(e,r),i(e),n<e&&e<t;);return a},s.filter=r=>d(e=>{if(e<=e)for(;i(e),!r(e);)e.setTime(e-1)},(e,t)=>{if(e<=e)if(t<0)for(;++t<=0;)for(;o(e,-1),!r(e););else for(;0<=--t;)for(;o(e,1),!r(e););}),r&&(s.count=(e,t)=>(y.setTime(+e),T.setTime(+t),i(y),i(T),Math.floor(r(y,T))),s.every=t=>(t=Math.floor(t),isFinite(t)&&0<t?1<t?s.filter(n?e=>n(e)%t==0:e=>s.count(0,e)%t==0):s:null)),s}const E=6e4,Bt=60*E,S=24*Bt,jt=7*S,I=d(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*E)/S,e=>e.getDate()-1),M=(I.range,d(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/S,e=>e.getUTCDate()-1)),Ht=(M.range,d(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/S,e=>Math.floor(e/S)));function f(t){return d(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,t)=>{e.setDate(e.getDate()+7*t)},(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*E)/jt)}Ht.range;const Gt=f(0),P=f(1),Vt=f(2),Wt=f(3),A=f(4),qt=f(5),$t=f(6);function p(t){return d(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)},(e,t)=>(t-e)/jt)}Gt.range,P.range,Vt.range,Wt.range,A.range,qt.range,$t.range;const zt=p(0),N=p(1),Kt=p(2),Yt=p(3),D=p(4),Jt=p(5),Zt=p(6),x=(zt.range,N.range,Kt.range,Yt.range,D.range,Jt.range,Zt.range,d(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear())),L=(x.every=r=>isFinite(r=Math.floor(r))&&0<r?d(e=>{e.setFullYear(Math.floor(e.getFullYear()/r)*r),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t*r)}):null,x.range,d(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear()));function O(e){var t;return 0<=e.y&&e.y<100?((t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L)).setFullYear(e.y),t):new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function ce(e){var t;return 0<=e.y&&e.y<100?((t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L))).setUTCFullYear(e.y),t):new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function C(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function ue(e){var n=e.dateTime,a=e.date,i=e.time,t=e.periods,r=e.days,o=e.shortDays,s=e.months,l=e.shortMonths,c=w(t),u=R(t),d=w(r),f=R(r),p=w(o),h=R(o),g=w(s),m=R(s),_=w(l),y=R(l),T={a:function(e){return o[e.getDay()]},A:function(e){return r[e.getDay()]},b:function(e){return l[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:Be,e:Be,f:We,g:tt,G:nt,H:je,I:He,j:Ge,L:Ve,m:qe,M:$e,p:function(e){return t[+(12<=e.getHours())]},q:function(e){return 1+~~(e.getMonth()/3)},Q:Ct,s:kt,S:ze,u:Ke,U:Ye,V:Ze,w:Qe,W:Xe,x:null,X:null,y:et,Y:rt,Z:at,"%":Ot},b={a:function(e){return o[e.getUTCDay()]},A:function(e){return r[e.getUTCDay()]},b:function(e){return l[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:it,e:it,f:ut,g:vt,G:St,H:ot,I:st,j:lt,L:ct,m:dt,M:ft,p:function(e){return t[+(12<=e.getUTCHours())]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:Ct,s:kt,S:pt,u:ht,U:gt,V:_t,w:yt,W:Tt,x:null,X:null,y:bt,Y:Et,Z:At,"%":Ot},v={a:function(e,t,r){t=p.exec(t.slice(r));return t?(e.w=h.get(t[0].toLowerCase()),r+t[0].length):-1},A:function(e,t,r){t=d.exec(t.slice(r));return t?(e.w=f.get(t[0].toLowerCase()),r+t[0].length):-1},b:function(e,t,r){t=_.exec(t.slice(r));return t?(e.m=y.get(t[0].toLowerCase()),r+t[0].length):-1},B:function(e,t,r){t=g.exec(t.slice(r));return t?(e.m=m.get(t[0].toLowerCase()),r+t[0].length):-1},c:function(e,t,r){return A(e,n,t,r)},d:Re,e:Re,f:xe,g:Oe,G:Ae,H:Me,I:Me,j:Ie,L:De,m:we,M:Pe,p:function(e,t,r){t=c.exec(t.slice(r));return t?(e.p=u.get(t[0].toLowerCase()),r+t[0].length):-1},q:ke,Q:Fe,s:Ue,S:Ne,u:be,U:ve,V:Ee,w:Te,W:Se,x:function(e,t,r){return A(e,a,t,r)},X:function(e,t,r){return A(e,i,t,r)},y:Oe,Y:Ae,Z:Ce,"%":Le};function E(l,c){return function(e){var t,r,n,a=[],i=-1,o=0,s=l.length;for(e instanceof Date||(e=new Date(+e));++i<s;)37===l.charCodeAt(i)&&(a.push(l.slice(o,i)),null!=(r=ge[t=l.charAt(++i)])?t=l.charAt(++i):r="e"===t?" ":"0",(n=c[t])&&(t=n(e,r)),a.push(t),o=i+1);return a.push(l.slice(o,i)),a.join("")}}function S(a,i){return function(e){var t,r,n=C(1900,void 0,1);if(A(n,a,e+="",0)!=e.length)return null;if("Q"in n)return new Date(n.Q);if("s"in n)return new Date(1e3*n.s+("L"in n?n.L:0));if(!i||"Z"in n||(n.Z=0),"p"in n&&(n.H=n.H%12+12*n.p),void 0===n.m&&(n.m="q"in n?n.q:0),"V"in n){if(n.V<1||53<n.V)return null;"w"in n||(n.w=1),"Z"in n?(t=4<(r=(t=ce(C(n.y,0,1))).getUTCDay())||0===r?N.ceil(t):N(t),t=M.offset(t,7*(n.V-1)),n.y=t.getUTCFullYear(),n.m=t.getUTCMonth(),n.d=t.getUTCDate()+(n.w+6)%7):(t=4<(r=(t=O(C(n.y,0,1))).getDay())||0===r?P.ceil(t):P(t),t=I.offset(t,7*(n.V-1)),n.y=t.getFullYear(),n.m=t.getMonth(),n.d=t.getDate()+(n.w+6)%7)}else("W"in n||"U"in n)&&("w"in n||(n.w="u"in n?n.u%7:"W"in n?1:0),r="Z"in n?ce(C(n.y,0,1)).getUTCDay():O(C(n.y,0,1)).getDay(),n.m=0,n.d="W"in n?(n.w+6)%7+7*n.W-(r+5)%7:n.w+7*n.U-(r+6)%7);return("Z"in n?(n.H+=n.Z/100|0,n.M+=n.Z%100,ce):O)(n)}}function A(e,t,r,n){for(var a,i,o=0,s=t.length,l=r.length;o<s;){if(l<=n)return-1;if(37===(a=t.charCodeAt(o++))){if(a=t.charAt(o++),!(i=v[a in ge?t.charAt(o++):a])||(n=i(e,r,n))<0)return-1}else if(a!=r.charCodeAt(n++))return-1}return n}return T.x=E(a,T),T.X=E(i,T),T.c=E(n,T),b.x=E(a,b),b.X=E(i,b),b.c=E(n,b),{format:function(e){var t=E(e+="",T);return t.toString=function(){return e},t},parse:function(e){var t=S(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=E(e+="",b);return t.toString=function(){return e},t},utcParse:function(e){var t=S(e+="",!0);return t.toString=function(){return e},t}}}L.every=r=>isFinite(r=Math.floor(r))&&0<r?d(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/r)*r),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t*r)}):null,L.range;var h,de,fe,pe,he,ge={"-":"",_:" ",0:"0"},g=/^\s*\d+/,me=/^%/,_e=/[\\^$*+?|[\]().{}]/g;function m(e,t,r){var n=e<0?"-":"",e=(n?-e:e)+"",a=e.length;return n+(a<r?new Array(r-a+1).join(t)+e:e)}function ye(e){return e.replace(_e,"\\$&")}function w(e){return new RegExp("^(?:"+e.map(ye).join("|")+")","i")}function R(e){return new Map(e.map((e,t)=>[e.toLowerCase(),t]))}function Te(e,t,r){t=g.exec(t.slice(r,r+1));return t?(e.w=+t[0],r+t[0].length):-1}function be(e,t,r){t=g.exec(t.slice(r,r+1));return t?(e.u=+t[0],r+t[0].length):-1}function ve(e,t,r){t=g.exec(t.slice(r,r+2));return t?(e.U=+t[0],r+t[0].length):-1}function Ee(e,t,r){t=g.exec(t.slice(r,r+2));return t?(e.V=+t[0],r+t[0].length):-1}function Se(e,t,r){t=g.exec(t.slice(r,r+2));return t?(e.W=+t[0],r+t[0].length):-1}function Ae(e,t,r){t=g.exec(t.slice(r,r+4));return t?(e.y=+t[0],r+t[0].length):-1}function Oe(e,t,r){t=g.exec(t.slice(r,r+2));return t?(e.y=+t[0]+(68<+t[0]?1900:2e3),r+t[0].length):-1}function Ce(e,t,r){t=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return t?(e.Z=t[1]?0:-(t[2]+(t[3]||"00")),r+t[0].length):-1}function ke(e,t,r){t=g.exec(t.slice(r,r+1));return t?(e.q=3*t[0]-3,r+t[0].length):-1}function we(e,t,r){t=g.exec(t.slice(r,r+2));return t?(e.m=t[0]-1,r+t[0].length):-1}function Re(e,t,r){t=g.exec(t.slice(r,r+2));return t?(e.d=+t[0],r+t[0].length):-1}function Ie(e,t,r){t=g.exec(t.slice(r,r+3));return t?(e.m=0,e.d=+t[0],r+t[0].length):-1}function Me(e,t,r){t=g.exec(t.slice(r,r+2));return t?(e.H=+t[0],r+t[0].length):-1}function Pe(e,t,r){t=g.exec(t.slice(r,r+2));return t?(e.M=+t[0],r+t[0].length):-1}function Ne(e,t,r){t=g.exec(t.slice(r,r+2));return t?(e.S=+t[0],r+t[0].length):-1}function De(e,t,r){t=g.exec(t.slice(r,r+3));return t?(e.L=+t[0],r+t[0].length):-1}function xe(e,t,r){t=g.exec(t.slice(r,r+6));return t?(e.L=Math.floor(t[0]/1e3),r+t[0].length):-1}function Le(e,t,r){t=me.exec(t.slice(r,r+1));return t?r+t[0].length:-1}function Fe(e,t,r){t=g.exec(t.slice(r));return t?(e.Q=+t[0],r+t[0].length):-1}function Ue(e,t,r){t=g.exec(t.slice(r));return t?(e.s=+t[0],r+t[0].length):-1}function Be(e,t){return m(e.getDate(),t,2)}function je(e,t){return m(e.getHours(),t,2)}function He(e,t){return m(e.getHours()%12||12,t,2)}function Ge(e,t){return m(1+I.count(x(e),e),t,3)}function Ve(e,t){return m(e.getMilliseconds(),t,3)}function We(e,t){return Ve(e,t)+"000"}function qe(e,t){return m(e.getMonth()+1,t,2)}function $e(e,t){return m(e.getMinutes(),t,2)}function ze(e,t){return m(e.getSeconds(),t,2)}function Ke(e){e=e.getDay();return 0===e?7:e}function Ye(e,t){return m(Gt.count(x(e)-1,e),t,2)}function Je(e){var t=e.getDay();return 4<=t||0===t?A(e):A.ceil(e)}function Ze(e,t){return e=Je(e),m(A.count(x(e),e)+(4===x(e).getDay()),t,2)}function Qe(e){return e.getDay()}function Xe(e,t){return m(P.count(x(e)-1,e),t,2)}function et(e,t){return m(e.getFullYear()%100,t,2)}function tt(e,t){return m((e=Je(e)).getFullYear()%100,t,2)}function rt(e,t){return m(e.getFullYear()%1e4,t,4)}function nt(e,t){var r=e.getDay();return m((e=4<=r||0===r?A(e):A.ceil(e)).getFullYear()%1e4,t,4)}function at(e){e=e.getTimezoneOffset();return(0<e?"-":(e*=-1,"+"))+m(e/60|0,"0",2)+m(e%60,"0",2)}function it(e,t){return m(e.getUTCDate(),t,2)}function ot(e,t){return m(e.getUTCHours(),t,2)}function st(e,t){return m(e.getUTCHours()%12||12,t,2)}function lt(e,t){return m(1+M.count(L(e),e),t,3)}function ct(e,t){return m(e.getUTCMilliseconds(),t,3)}function ut(e,t){return ct(e,t)+"000"}function dt(e,t){return m(e.getUTCMonth()+1,t,2)}function ft(e,t){return m(e.getUTCMinutes(),t,2)}function pt(e,t){return m(e.getUTCSeconds(),t,2)}function ht(e){e=e.getUTCDay();return 0===e?7:e}function gt(e,t){return m(zt.count(L(e)-1,e),t,2)}function mt(e){var t=e.getUTCDay();return 4<=t||0===t?D(e):D.ceil(e)}function _t(e,t){return e=mt(e),m(D.count(L(e),e)+(4===L(e).getUTCDay()),t,2)}function yt(e){return e.getUTCDay()}function Tt(e,t){return m(N.count(L(e)-1,e),t,2)}function bt(e,t){return m(e.getUTCFullYear()%100,t,2)}function vt(e,t){return m((e=mt(e)).getUTCFullYear()%100,t,2)}function Et(e,t){return m(e.getUTCFullYear()%1e4,t,4)}function St(e,t){var r=e.getUTCDay();return m((e=4<=r||0===r?D(e):D.ceil(e)).getUTCFullYear()%1e4,t,4)}function At(){return"+0000"}function Ot(){return"%"}function Ct(e){return+e}function kt(e){return Math.floor(+e/1e3)}function wt(e){h=ue(e),de=h.format,fe=h.parse,pe=h.utcFormat,he=h.utcParse}function Rt(e,t,r){v.isObject(r=r||{})||v.error("Invalid time multi-format specifier: "+r);const n=t(b.SECONDS),a=t(b.MINUTES),i=t(b.HOURS),o=t(b.DATE),s=t(b.WEEK),l=t(b.MONTH),c=t(b.QUARTER),u=t(b.YEAR),d=e(r[b.MILLISECONDS]||".%L"),f=e(r[b.SECONDS]||":%S"),p=e(r[b.MINUTES]||"%I:%M"),h=e(r[b.HOURS]||"%I %p"),g=e(r[b.DATE]||r[b.DAY]||"%a %d"),m=e(r[b.WEEK]||"%b %d"),_=e(r[b.MONTH]||"%B"),y=e(r[b.QUARTER]||"%B"),T=e(r[b.YEAR]||"%Y");return e=>(n(e)<e?d:a(e)<e?f:i(e)<e?p:o(e)<e?h:l(e)<e?s(e)<e?g:m:u(e)<e?c(e)<e?_:y:T)(e)}function It(e){const t=n(e.format),r=n(e.utcFormat);return{timeFormat:e=>v.isString(e)?t(e):Rt(t,b.timeInterval,e),utcFormat:e=>v.isString(e)?r(e):Rt(r,b.utcInterval,e),timeParse:n(e.parse),utcParse:n(e.utcParse)}}wt({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});let r;function Mt(){return r=It({format:de,parse:fe,utcFormat:pe,utcParse:he})}function Pt(e){return It(ue(e))}function _(e){return arguments.length?r=Pt(e):r}Mt();const F=(e,t)=>v.extend({},e,t);function Nt(e,t){e=e?c(e):u(),t=t?Pt(t):_();return F(e,t)}function Dt(e,t){var r=arguments.length;return r&&2!==r&&v.error("defaultLocale expects either zero or two arguments."),r?F(u(e),_(t)):F(u(),_())}function xt(){return l(),Mt(),Dt()}e.defaultLocale=Dt,e.locale=Nt,e.numberFormatDefaultLocale=u,e.numberFormatLocale=c,e.resetDefaultLocale=xt,e.resetNumberFormatDefaultLocale=l,e.resetTimeFormatDefaultLocale=Mt,e.timeFormatDefaultLocale=_,e.timeFormatLocale=Pt}}return ru.exports}function ou(){if(!eu){eu=1;var e=Yc.exports;{var l=jo(),o=Zc(),p=iu();const E=/^(data:|([A-Za-z]+:)?\/\/)/,S=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,A=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,O="file://";function t(t,r){return e=>({options:e||{},sanitize:a,load:n,fileAccess:!!r,file:L(r),http:U(t)})}async function n(e,t){var e=await this.sanitize(e,t),r=e.href;return e.localFile?this.file(r):this.http(r,t)}async function a(e,t){t=l.extend({},this.options,t);var r=this.fileAccess,n={href:null};let a,i,o;var s=S.test(e.replace(A,"")),s=(null!=e&&"string"==typeof e&&s||l.error("Sanitize failure, invalid URI: "+l.stringValue(e)),E.test(e));return(o=t.baseURL)&&!s&&(e.startsWith("/")||o.endsWith("/")||(e="/"+e),e=o+e),i=(a=e.startsWith(O))||"file"===t.mode||"http"!==t.mode&&!s&&r,a?e=e.slice(O.length):e.startsWith("//")&&("file"===t.defaultProtocol?(e=e.slice(2),i=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(n,"localFile",{value:!!i}),n.href=e,t.target&&(n.target=t.target+""),t.rel&&(n.rel=t.rel+""),"image"===t.context&&t.crossOrigin&&(n.crossOrigin=t.crossOrigin+""),n}function L(t){return t?e=>new Promise((r,n)=>{t.readFile(e,(e,t)=>{e?n(e):r(t)})}):F}async function F(){l.error("No file system access.")}function U(n){return n?async function(e,t){var r=l.extend({},this.options.http,t),t=t&&t.response,e=await n(e,r);return e.ok?l.isFunction(e[t])?e[t]():e.text():l.error(e.status+""+e.statusText)}:B}async function B(){l.error("No HTTP fetch method available.")}const C=e=>null!=e&&e==e,k=e=>"true"===e||"false"===e||!0===e||!1===e,w=e=>!Number.isNaN(Date.parse(e)),R=e=>!(Number.isNaN(+e)||e instanceof Date),I=e=>R(e)&&Number.isInteger(+e),M={boolean:l.toBoolean,integer:l.toNumber,number:l.toNumber,date:l.toDate,string:l.toString,unknown:l.identity},P=[k,I,R,w],N=["boolean","integer","number","date"];function i(a,i){if(!a||!a.length)return"unknown";var o=a.length,s=P.length,l=P.map((e,t)=>t+1);for(let e=0,t=0,r,n;e<o;++e)for(n=i?a[e][i]:a[e],r=0;r<s;++r)if(l[r]&&C(n)&&!P[r](n)&&(l[r]=0,++t===P.length))return"string";return N[l.reduce((e,t)=>0===e?t:e,0)-1]}function h(r,e){return e.reduce((e,t)=>(e[t]=i(r,t),e),{})}var f={},g={},m=34,_=10,y=13;function s(e){return new Function("d","return {"+e.map(function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'}).join(",")+"}")}function j(r,n){var a=s(r);return function(e,t){return n(a(e),t,r)}}function c(e){var r=Object.create(null),n=[];return e.forEach(function(e){for(var t in e)t in r||n.push(r[t]=t)}),n}function u(e,t){var e=e+"",r=e.length;return r<t?new Array(t-r+1).join(0)+e:e}function H(e){return e<0?"-"+u(-e,6):9999<e?"+"+u(e,6):u(e,4)}function G(e){var t=e.getUTCHours(),r=e.getUTCMinutes(),n=e.getUTCSeconds(),a=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":H(e.getUTCFullYear())+"-"+u(e.getUTCMonth()+1,2)+"-"+u(e.getUTCDate(),2)+(a?"T"+u(t,2)+":"+u(r,2)+":"+u(n,2)+"."+u(a,3)+"Z":n?"T"+u(t,2)+":"+u(r,2)+":"+u(n,2)+"Z":r||t?"T"+u(t,2)+":"+u(r,2)+"Z":"")}function V(n){var t=new RegExp('["'+n+"\n\r]"),d=n.charCodeAt(0);function i(n,e){var t,r=[],a=n.length,i=0,o=0,s=a<=0,l=!1;function c(){if(s)return g;if(l)return l=!1,f;var e,t,r=i;if(n.charCodeAt(r)===m){for(;i++<a&&n.charCodeAt(i)!==m||n.charCodeAt(++i)===m;);return(e=i)>=a?s=!0:(t=n.charCodeAt(i++))===_?l=!0:t===y&&(l=!0,n.charCodeAt(i)===_)&&++i,n.slice(r+1,e-1).replace(/""/g,'"')}for(;i<a;){if((t=n.charCodeAt(e=i++))===_)l=!0;else if(t===y)l=!0,n.charCodeAt(i)===_&&++i;else if(t!==d)continue;return n.slice(r,e)}return s=!0,n.slice(r,a)}for(n.charCodeAt(a-1)===_&&--a,n.charCodeAt(a-1)===y&&--a;(t=c())!==g;){for(var u=[];t!==f&&t!==g;)u.push(t),t=c();e&&null==(u=e(u,o++))||r.push(u)}return r}function r(e,r){return e.map(function(t){return r.map(function(e){return o(t[e])}).join(n)})}function a(e){return e.map(o).join(n)}function o(e){return null==e?"":e instanceof Date?G(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,r){var n,a;return(e=i(e,function(e,t){if(n)return n(e,t-1);a=e,n=r?j(e,r):s(e)})).columns=a||[],e},parseRows:i,format:function(e,t){return[(t=null==t?c(e):t).map(o).join(n)].concat(r(e,t)).join("\n")},formatBody:function(e,t){return r(e,t=null==t?c(e):t).join("\n")},formatRows:function(e){return e.map(a).join("\n")},formatRow:a,formatValue:o}}function r(n){function e(e,t){var r={delimiter:n};return d(e,t?l.extend(t,r):r)}return e.responseType="text",e}function d(e,t){return t.header&&(e=t.header.map(l.stringValue).join(t.delimiter)+"\n"+e),V(t.delimiter).parse(e+"")}function W(e){return"function"==typeof Buffer&&l.isFunction(Buffer.isBuffer)&&Buffer.isBuffer(e)}function T(e,t){var r=t&&t.property?l.field(t.property):l.identity;return l.isObject(e)&&!W(e)?q(r(e),t):r(JSON.parse(e))}function q(e,t){return!l.isArray(e)&&l.isIterable(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}d.responseType="text";const D={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function b(e,t){let r,n,a,i;return e=T(e,t),t&&t.feature?(r=o.feature,a=t.feature):t&&t.mesh?(r=o.mesh,a=t.mesh,i=D[t.filter]):l.error("Missing TopoJSON feature or mesh parameter."),(n=(n=e.objects[a])?r(e,n,i):l.error("Invalid TopoJSON object: "+a))&&n.features||[n]}b.responseType=T.responseType="json";const x={dsv:d,csv:r(","),tsv:r("\t"),json:T,topojson:b};function v(e,t){return 1<arguments.length?(x[e]=t,this):l.hasOwnProperty(x,e)?x[e]:null}function $(e){e=v(e);return e&&e.responseType||"text"}function z(e,t,r,n){var a=v((t=t||{}).type||"json");return a||l.error("Unknown data format type: "+t.type),e=a(e,t),t.parse&&K(e,t.parse,r,n),l.hasOwnProperty(e,"columns")&&delete e.columns,e}function K(s,l,c,u){if(s.length){var d=p.timeFormatDefaultLocale();c=c||d.timeParse,u=u||d.utcParse;let e=s.columns||Object.keys(s[0]),t,r,n,a,i,o;"auto"===l&&(l=h(s,e));var f=(e=Object.keys(l)).map(e=>{var t=l[e];let r,n;if(t&&(t.startsWith("date:")||t.startsWith("utc:")))return r=t.split(/:(.+)?/,2),("'"===(n=r[1])[0]&&"'"===n[n.length-1]||'"'===n[0]&&'"'===n[n.length-1])&&(n=n.slice(1,-1)),("utc"===r[0]?u:c)(n);if(M[t])return M[t];throw Error("Illegal format pattern: "+e+":"+t)});for(n=0,i=s.length,o=e.length;n<i;++n)for(t=s[n],a=0;a<o;++a)r=e[a],t[r]=f[a](t[r])}}var Y=t("undefined"!=typeof fetch&&fetch,null);e.format=x,e.formats=v,e.inferType=i,e.inferTypes=h,e.loader=Y,e.read=z,e.responseType=$,e.typeParsers=M}}return Yc.exports}function su(){if(!tu){tu=1;var e=Kc.exports;{var y=jo(),i=ou(),r=iu();function u(e){const r=e||y.identity,n=[],a={};return n.add=e=>{var t=r(e);return a[t]||(a[t]=1,n.push(e)),n},n.remove=e=>{var t=r(e);return a[t]&&(a[t]=0)<=(t=n.indexOf(e))&&n.splice(t,1),n},n}async function d(t,e){try{await e(t)}catch(e){t.error(e)}}const P=Symbol("vega_id");let t=1;function o(e){return!(!e||!T(e))}function T(e){return e[P]}function s(e,t){return e[P]=t,e}function b(e){e=e===Object(e)?e:{data:e};return T(e)?e:s(e,t++)}function B(e){return l(e,b({}))}function l(e,t){for(const r in e)t[r]=e[r];return t}function j(e,t){return s(t,T(e))}function H(r,n){return r?n?(e,t)=>r(e,t)||T(n(e))-T(n(t)):(e,t)=>r(e,t)||T(e)-T(t):null}function c(e){return e&&e.constructor===v}function v(){const d=[],f=[],p=[],h=[],g=[];let m=null,_=!1;return{constructor:v,insert(e){var t=y.array(e),r=t.length;for(let e=0;e<r;++e)d.push(t[e]);return this},remove(e){var t=y.isFunction(e)?h:f,r=y.array(e),n=r.length;for(let e=0;e<n;++e)t.push(r[e]);return this},modify(e,t,r){t={field:t,value:y.constant(r)};return(y.isFunction(e)?(t.filter=e,g):(t.tuple=e,p)).push(t),this},encode(e,t){return y.isFunction(e)?g.push({filter:e,field:t}):p.push({tuple:e,field:t}),this},clean(e){return m=e,this},reflow(){return _=!0,this},pulse(n,e){const t={},a={};let r,i,o,s,l,c;for(r=0,i=e.length;r<i;++r)t[T(e[r])]=1;for(r=0,i=f.length;r<i;++r)l=f[r],t[T(l)]=-1;for(r=0,i=h.length;r<i;++r)s=h[r],e.forEach(e=>{s(e)&&(t[T(e)]=-1)});for(r=0,i=d.length;r<i;++r)l=d[r],c=T(l),t[c]?t[c]=1:n.add.push(b(d[r]));for(r=0,i=e.length;r<i;++r)l=e[r],t[T(l)]<0&&n.rem.push(l);function u(e,t,r){r?e[t]=r(e):n.encode=t,_||(a[T(e)]=e)}for(r=0,i=p.length;r<i;++r)o=p[r],l=o.tuple,s=o.field,0<(c=t[T(l)])&&(u(l,s,o.value),n.modifies(s));for(r=0,i=g.length;r<i;++r)o=g[r],s=o.filter,e.forEach(e=>{s(e)&&0<t[T(e)]&&u(e,o.field,o.value)}),n.modifies(o.field);if(_)n.mod=f.length||h.length?e.filter(e=>0<t[T(e)]):e.slice();else for(c in a)n.mod.push(a[c]);return(m||null==m&&(f.length||h.length))&&n.clean(!0),n}}}const N="_:mod:_";function f(){Object.defineProperty(this,N,{writable:!0,value:{}})}f.prototype={set(e,t,r,n){var a=this[e],i=this[N];return null!=t&&0<=t?a[t]===r&&!n||(a[t]=r,i[t+":"+e]=-1,i[e]=-1):a===r&&!n||(this[e]=r,i[e]=y.isArray(r)?1+r.length:-1),this},modified(t,e){var r=this[N];if(!arguments.length){for(const n in r)if(r[n])return!0;return!1}if(y.isArray(t)){for(let e=0;e<t.length;++e)if(r[t[e]])return!0;return!1}return null!=e&&0<=e?e+1<r[t]||!!r[e+":"+t]:!!r[t]},clear(){return this[N]={},this}};let a=0;const D=new f;function p(e,t,r,n){this.id=++a,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),r&&this.parameters(r,n)}function h(r){return function(e){var t=this.flags;return 0===arguments.length?!!(t&r):(this.flags=e?t|r:t&~r,this)}}function G(e,t,r,n){let a=1,i;return i=e instanceof p?e:e&&e.prototype instanceof p?new e:y.isFunction(e)?new p(null,e):(a=0,new p(e,t)),this.rank(i),a&&(n=r,r=t),r&&this.connect(i,i.parameters(r,n)),this.touch(i),i}function V(t,r){var n=t.rank,a=r.length;for(let e=0;e<a;++e)if(n<r[e].rank)return void this.rerank(t)}p.prototype={targets(){return this._targets||(this._targets=u(y.id))},set(e){return this.value!==e?(this.value=e,1):0},skip:h(1),modified:h(2),parameters(e,n,t){n=!1!==n;const a=this._argval=this._argval||new f,i=this._argops=this._argops||[],o=[];let r,s,l,c;var u=(e,t,r)=>{r instanceof p?(r!==this&&(n&&r.targets().add(this),o.push(r)),i.push({op:r,name:e,index:t})):a.set(e,t,r)};for(r in e)if(s=e[r],"pulse"===r)y.array(s).forEach(e=>{e instanceof p?e!==this&&(e.targets().add(this),o.push(e)):y.error("Pulse parameters must be operator instances.")}),this.source=s;else if(y.isArray(s))for(a.set(r,-1,Array(l=s.length)),c=0;c<l;++c)u(r,c,s[c]);else u(r,-1,s);return this.marshall().clear(),t&&(i.initonly=!0),o},marshall(e){var t=this._argval||D,r=this._argops;let n,a,i,o;if(r){var s=r.length;for(a=0;a<s;++a)n=r[a],o=(i=n.op).modified()&&i.stamp===e,t.set(n.name,n.index,i.value,o);if(r.initonly){for(a=0;a<s;++a)(n=r[a]).op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){var e=this._argops;let t,r,n,a;if(e)for(t=0,r=e.length;t<r;++t)n=e[t],(a=n.op)._targets&&a._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){var t=this._update;if(t){var r=this.marshall(e.stamp),t=t.call(this,r,e);if(r.clear(),t!==this.value)this.value=t;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return t=this.skip()?(this.skip(!1),0):this.evaluate(e),this.pulse=t||e}};let n=0;function g(e,t,r){this.id=++n,this.value=null,r&&(this.receive=r),e&&(this._filter=e),t&&(this._apply=t)}function m(e,t,r){return new g(e,t,r)}function W(e,t,r,n){function a(e){e.dataflow=i;try{o.receive(e)}catch(e){i.error(e)}finally{i.run()}}const i=this,o=m(r,n);let s;var l=(s="string"==typeof e&&"undefined"!=typeof document?document.querySelectorAll(e):y.array(e)).length;for(let e=0;e<l;++e)s[e].addEventListener(t,a);return o}function q(e,t){var r=this.locale();return i.read(e,t,r.timeParse,r.utcParse)}function $(e,t,r){return t=this.parse(t,r),this.pulse(e,this.changeset().insert(t))}async function z(t,e){let r=0,n;try{n=await this.loader().load(t,{context:"dataflow",response:i.responseType(e&&e.type)});try{n=this.parse(n,e)}catch(e){r=-2,this.warn("Data ingestion failed",t,e)}}catch(e){r=-1,this.warn("Loading failed",t,e)}return{data:n,status:r}}async function K(e,t,r){var n=this._pending||Y(this),t=(n.requests+=1,await this.request(t,r));return this.pulse(e,this.changeset().remove(y.truthy).insert(t.data||[])),n.done(),t}function Y(e){let t;const r=new Promise(e=>t=e);return r.requests=0,r.done=()=>{0==--r.requests&&(e._pending=null,t(e))},e._pending=r}g.prototype={_filter:y.truthy,_apply:y.identity,targets(){return this._targets||(this._targets=u(y.id))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){var t=this.value=this._apply(e),r=this._targets,n=r?r.length:0;for(let e=0;e<n;++e)r[e].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){e=m(e);return this.targets().add(e),e},apply(e){e=m(null,e);return this.targets().add(e),e},merge(){var r=m();this.targets().add(r);for(let e=0,t=arguments.length;e<t;++e)arguments[e].targets().add(r);return r},throttle(t){let r=-1;return this.filter(()=>{var e=Date.now();return e-r>t?(r=e,1):0})},debounce(e){const r=m();return this.targets().add(m(null,null,y.debounce(e,e=>{var t=e.dataflow;r.receive(e),t&&t.run&&t.run()}))),r},between(e,t){let r=!1;return e.targets().add(m(null,null,()=>r=!0)),t.targets().add(m(null,null,()=>r=!1)),this.filter(()=>r)},detach(){this._filter=y.truthy,this._targets=null}};const x={skip:!0};function J(e,t,r,n,a){return(e instanceof p?Q:Z)(this,e,t,r,n,a),this}function Z(r,e,n,t,a,i){const o=y.extend({},i,x);let s,l;y.isFunction(n)||(n=y.constant(n)),s=void 0===t?e=>r.touch(n(e)):y.isFunction(t)?(l=new p(null,t,a,!1),e=>{l.evaluate(e);var e=n(e),t=l.value;c(t)?r.pulse(e,t,i):r.update(e,t,o)}):e=>r.update(n(e),t,o),e.apply(s)}function Q(e,t,r,n,a,i){void 0===n?t.targets().add(r):(i=i||{},(n=new p(null,X(r,n),a,!1)).modified(i.force),n.rank=t.rank,t.targets().add(n),r&&(n.skip(!0),n.value=r.value,n.targets().add(r),e.connect(r,[n])))}function X(r,n){return n=y.isFunction(n)?n:y.constant(n),r?function(e,t){e=n(e,t);return r.skip()||(r.skip(e!==this.value).value=e),e}:n}function ee(e){e.rank=++this._rank}function te(e){var t=[e];let r,n,a;for(;t.length;)if(this.rank(r=t.pop()),n=r._targets)for(a=n.length;0<=--a;)t.push(r=n[a]),r===e&&y.error("Cycle detected in dataflow graph.")}const L={};function _(e,t,r){this.dataflow=e,this.stamp=null==t?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=r||null}function E(e,t){const r=[];return y.visitArray(e,t,e=>r.push(e)),r}function S(e,t){const r={};return e.visit(t,e=>{r[T(e)]=1}),e=>r[T(e)]?null:e}function A(r,n){return r?(e,t)=>r(e,t)&&n(e,t):n}function O(e,t,r,n){let a=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=n||null;for(const o of this.pulses=r)if(o.stamp===t){if(o.fields){var i=this.fields||(this.fields={});for(const s in o.fields)i[s]=1}o.changed(this.ADD)&&(a|=this.ADD),o.changed(this.REM)&&(a|=this.REM),o.changed(this.MOD)&&(a|=this.MOD)}this.changes=a}async function re(a,i,o){const s=this,l=[];if(s._pulse)return C(s);if(s._pending&&await s._pending,i&&await d(s,i),s._touched.length){i=++s._clock;s._pulse=new _(s,i,a),s._touched.forEach(e=>s._enqueue(e,!0)),s._touched=u(y.id);let e=0,t,r,n;try{for(;0<s._heap.size();)(t=s._heap.pop()).rank!==t.qrank?s._enqueue(t,!0):((r=t.run(s._getPulse(t,a))).then?r=await r:r.async&&(l.push(r.async),r=L),r!==L&&t._targets&&t._targets.forEach(e=>s._enqueue(e)),++e)}catch(e){s._heap.clear(),n=e}if(s._input={},s._pulse=null,s.debug(`Pulse ${i}: ${e} operators`),n&&(s._postrun=[],s.error(n)),s._postrun.length){var c=s._postrun.sort((e,t)=>t.priority-e.priority);s._postrun=[];for(let e=0;e<c.length;++e)await d(s,c[e].callback)}o&&await d(s,o),l.length&&Promise.all(l).then(e=>s.runAsync(null,()=>{e.forEach(e=>{try{e(s)}catch(e){s.error(e)}})}))}else s.debug("Dataflow invoked, but nothing to do.");return s}async function ne(e,t,r){for(;this._running;)await this._running;var n=()=>this._running=null;return(this._running=this.evaluate(e,t,r)).then(n,n),this._running}function ae(e,t,r){return this._pulse?C(this):(this.evaluate(e,t,r),this)}function ie(e,t,r){if(this._pulse||t)this._postrun.push({priority:r||0,callback:e});else try{e(this)}catch(e){this.error(e)}}function C(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function oe(e,t){var r=e.stamp<this._clock;r&&(e.stamp=this._clock),(r||t)&&(e.qrank=e.rank,this._heap.push(e))}function se(e,t){var r=e.source,n=this._clock;return r&&y.isArray(r)?new O(this,n,r.map(e=>e.pulse),t):this._input[e.id]||le(this._pulse,r&&r.pulse)}function le(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==L&&(e.source=t.source),e)}_.prototype={StopPropagation:L,ADD:1,REM:2,MOD:4,ADD_REM:3,ADD_MOD:5,ALL:7,REFLOW:8,SOURCE:16,NO_SOURCE:32,NO_FIELDS:64,fork(e){return new _(this.dataflow).init(this,e)},clone(){var e=this.fork(7);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(23)},addAll(){var e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||((e=new _(this.dataflow).init(this)).add=e.source,e.rem=[]),e},init(e,t){var r=this;return r.stamp=e.stamp,r.encode=e.encode,!e.fields||64&t||(r.fields=e.fields),1&t?(r.addF=e.addF,r.add=e.add):(r.addF=null,r.add=[]),2&t?(r.remF=e.remF,r.rem=e.rem):(r.remF=null,r.rem=[]),4&t?(r.modF=e.modF,r.mod=e.mod):(r.modF=null,r.mod=[]),32&t?(r.srcF=null,r.source=null):(r.srcF=e.srcF,r.source=e.source,e.cleans&&(r.cleans=e.cleans)),r},runAfter(e){this.dataflow.runAfter(e)},changed(e){e=e||7;return 1&e&&this.add.length||2&e&&this.rem.length||4&e&&this.mod.length},reflow(e){var t;return e?this.fork(7).reflow():(e=this.add.length,(t=this.source&&this.source.length)&&t!==e&&(this.mod=this.source,e)&&this.filter(4,S(this,1)),this)},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return y.isArray(e)?e.forEach(e=>t[e]=!0):t[e]=!0,this},modified(e,t){const r=this.fields;return!(!t&&!this.mod.length||!r)&&(arguments.length?y.isArray(e)?e.some(e=>r[e]):r[e]:!!r)},filter(e,t){return 1&e&&(this.addF=A(this.addF,t)),2&e&&(this.remF=A(this.remF,t)),4&e&&(this.modF=A(this.modF,t)),16&e&&(this.srcF=A(this.srcF,t)),this},materialize(e){var t=this;return 1&(e=e||7)&&t.addF&&(t.add=E(t.add,t.addF),t.addF=null),2&e&&t.remF&&(t.rem=E(t.rem,t.remF),t.remF=null),4&e&&t.modF&&(t.mod=E(t.mod,t.modF),t.modF=null),16&e&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){var r,n=this;return 16&e?y.visitArray(n.source,n.srcF,t):(1&e&&y.visitArray(n.add,n.addF,t),2&e&&y.visitArray(n.rem,n.remF,t),4&e&&y.visitArray(n.mod,n.modF,t),r=n.source,8&e&&r&&(e=n.add.length+n.mod.length)!==r.length&&(e?y.visitArray(r,S(n,5),t):y.visitArray(r,n.srcF,t))),n}},y.inherits(O,_,{fork(e){const t=new _(this.dataflow).init(this,e&this.NO_FIELDS);return void 0!==e&&(e&t.ADD&&this.visit(t.ADD,e=>t.add.push(e)),e&t.REM&&this.visit(t.REM,e=>t.rem.push(e)),e&t.MOD)&&this.visit(t.MOD,e=>t.mod.push(e)),t},changed(e){return this.changes&e},modified(e){const t=this.fields;return t&&this.changes&this.MOD?y.isArray(e)?e.some(e=>t[e]):t[e]:0},filter(){y.error("MultiPulse does not support filtering.")},materialize(){y.error("MultiPulse does not support materialization.")},visit(e,t){var r=this.pulses,n=r.length;let a=0;if(e&this.SOURCE)for(;a<n;++a)r[a].visit(e,t);else for(;a<n;++a)r[a].stamp===this.stamp&&r[a].visit(e,t);return this}});const F={skip:!1,force:!1};function ce(e,t){t=t||F;return this._pulse?this._enqueue(e):this._touched.add(e),t.skip&&e.skip(!0),this}function ue(e,t,r){r=r||F;return(e.set(t)||r.force)&&this.touch(e,r),this}function de(e,t,r){this.touch(e,r||F);var r=new _(this,this._clock+(this._pulse?0:1)),n=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,n),this}function fe(r){let n=[];return{clear:()=>n=[],size:()=>n.length,peek:()=>n[0],push:e=>(n.push(e),k(n,0,n.length-1,r)),pop:()=>{var e=n.pop();let t;return n.length?(t=n[0],n[0]=e,pe(n,0,r)):t=e,t}}}function k(e,t,r,n){for(var a,i,o=e[r];t<r&&n(o,a=e[i=r-1>>1])<0;)e[r]=a,r=i;return e[r]=o}function pe(e,t,r){var n=t,a=e.length,i=e[t];let o=1+(t<<1),s;for(;o<a;)(s=o+1)<a&&0<=r(e[o],e[s])&&(o=s),e[t]=e[o],o=1+((t=o)<<1);e[t]=i,k(e,n,t,r)}function w(){this.logger(y.logger()),this.logLevel(y.Error),this._clock=0,this._rank=0,this._locale=r.defaultLocale();try{this._loader=i.loader()}catch(e){}this._touched=u(y.id),this._input={},this._pulse=null,this._heap=fe((e,t)=>e.qrank-t.qrank),this._postrun=[]}function R(e){return function(){return this._log[e].apply(this,arguments)}}function I(e,t){p.call(this,e,null,t)}w.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:R("error"),warn:R("warn"),info:R("info"),debug:R("debug"),logLevel:R("level"),cleanThreshold:1e4,add:G,connect:V,rank:ee,rerank:te,pulse:de,touch:ce,update:ue,changeset:v,ingest:$,parse:q,preload:K,request:z,events:W,on:J,evaluate:re,run:ae,runAsync:ne,runAfter:ie,_enqueue:oe,_getPulse:se},y.inherits(I,p,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),(t=t||e).then?t=t.then(e=>this.pulse=e):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){var t=this.marshall(e.stamp),e=this.transform(t,e);return t.clear(),e},transform(){}});const U={};function he(e){e=M(e);return e&&e.Definition||null}function M(e){return e=e&&e.toLowerCase(),y.hasOwnProperty(U,e)?U[e]:null}e.Dataflow=w,e.EventStream=g,e.MultiPulse=O,e.Operator=p,e.Parameters=f,e.Pulse=_,e.Transform=I,e.UniqueList=u,e.asyncCallback=d,e.changeset=v,e.definition=he,e.derive=B,e.ingest=b,e.isChangeSet=c,e.isTuple=o,e.rederive=l,e.replace=j,e.stableCompare=H,e.transform=M,e.transforms=U,e.tupleid=T}}return Kc.exports}var lu,cu,uu={exports:{}},du={exports:{}};function fu(){if(!lu){lu=1;var t=du.exports;{var d=t;function*f(t,r){if(null==r)for(var e of t)null!=e&&""!==e&&(e=+e)>=e&&(yield e);else{let e=-1;for(var n of t)null!=(n=r(n,++e,t))&&""!==n&&(n=+n)>=n&&(yield n)}}function p(e,t){return null==e||null==t?NaN:e<t?-1:t<e?1:t<=e?0:NaN}function U(e){return null===e?NaN:+e}function*B(t,r){if(void 0===r)for(var e of t)null!=e&&(e=+e)>=e&&(yield e);else{let e=-1;for(var n of t)null!=(n=r(n,++e,t))&&(n=+n)>=n&&(yield n)}}function j(t,r){let n=0,a,i=0,o=0;if(void 0===r)for(var e of t)null!=e&&(e=+e)>=e&&(a=e-i,i+=a/++n,o+=a*(e-i));else{let e=-1;for(var s of t)null!=(s=r(s,++e,t))&&(s=+s)>=s&&(a=s-i,i+=a/++n,o+=a*(s-i))}if(1<n)return o/(n-1)}function H(e,t){e=j(e,t);return e&&Math.sqrt(e)}function G(n=p){if(n===p)return e;if("function"!=typeof n)throw new TypeError("compare is not a function");return(e,t)=>{var r=n(e,t);return r||0===r?r:(0===n(t,t))-(0===n(e,e))}}function e(e,t){return(null==e||!(e<=e))-(null==t||!(t<=t))||(e<t?-1:t<e?1:0)}function a(t,r){let n;if(void 0===r)for(const e of t)null!=e&&(n<e||void 0===n&&e>=e)&&(n=e);else{let e=-1;for(var a of t)null!=(a=r(a,++e,t))&&(n<a||void 0===n&&a>=a)&&(n=a)}return n}function i(t,r){let n;if(void 0===r)for(const e of t)null!=e&&(n>e||void 0===n&&e>=e)&&(n=e);else{let e=-1;for(var a of t)null!=(a=r(a,++e,t))&&(n>a||void 0===n&&a>=a)&&(n=a)}return n}function h(r,n,a=0,i=1/0,o){if(n=Math.floor(n),a=Math.floor(Math.max(0,a)),i=Math.floor(Math.min(r.length-1,i)),a<=n&&n<=i)for(o=void 0===o?e:G(o);a<i;){600<i-a&&(s=i-a+1,l=n-a+1,u=Math.log(s),c=.5*Math.exp(2*u/3),u=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1),h(r,n,Math.max(a,Math.floor(n-l*c/s+u)),Math.min(i,Math.floor(n+(s-l)*c/s+u)),o));var s,l,c,u,d=r[n];let e=a,t=i;for(g(r,a,n),0<o(r[i],d)&&g(r,a,i);e<t;){for(g(r,e,t),++e,--t;o(r[e],d)<0;)++e;for(;0<o(r[t],d);)--t}0===o(r[a],d)?g(r,a,t):g(r,++t,i),t<=n&&(a=t+1),n<=t&&(i=t-1)}return r}function g(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function m(e,t,r){var n;if((r=(e=Float64Array.from(B(e,r))).length)&&!isNaN(t=+t))return t<=0||r<2?i(e):1<=t?a(e):(r=(r-1)*t,(n=a(h(e,t=Math.floor(r)).subarray(0,t+1)))+(i(e.subarray(t+1))-n)*(r-t))}function V(e,t,r=U){var n,a;if((n=e.length)&&!isNaN(t=+t))return t<=0||n<2?+r(e[0],0,e):1<=t?+r(e[n-1],n-1,e):(n=(n-1)*t,(a=+r(e[t=Math.floor(n)],t,e))+(+r(e[t+1],t+1,e)-a)*(n-t))}function W(e,t){return m(e,.5,t)}function r(e,t,r){const n=Float64Array.from(f(e,r));return n.sort(p),t.map(e=>V(n,e))}function s(e,t){return r(e,[.25,.5,.75],t)}function l(e,t){var r=e.length,n=H(e,t),e=s(e,t),t=(e[2]-e[0])/1.34;return 1.06*(Math.min(n,t)||n||Math.abs(e[0])||1)*Math.pow(r,-.2)}function q(e){var t=e.maxbins||20,r=e.base||10,n=Math.log(r),a=e.divide||[5,2];let i=e.extent[0],o=e.extent[1],s,l,c,u,d,f;var p=e.span||o-i||Math.abs(i)||1;if(e.step)s=e.step;else if(e.steps){for(u=p/t,d=0,f=e.steps.length;d<f&&e.steps[d]<u;++d);s=e.steps[Math.max(0,d-1)]}else{for(l=Math.ceil(Math.log(t)/n),c=e.minstep||0,s=Math.max(c,Math.pow(r,Math.round(Math.log(p)/n)-l));Math.ceil(p/s)>t;)s*=r;for(d=0,f=a.length;d<f;++d)(u=s/a[d])>=c&&p/u<=t&&(s=u)}n=0<=(u=Math.log(s))?0:1+~~(-u/n),n=Math.pow(r,-n-1);return!e.nice&&void 0!==e.nice||(u=Math.floor(i/s+n)*s,i=i<u?u-s:u,o=Math.ceil(o/s)*s),{start:i,stop:o===i?i+s:o,step:s}}function $(e){d.random=e}function z(e,t,r,n){if(!e.length)return[void 0,void 0];var a=Float64Array.from(f(e,n)),i=a.length,o=t;let s,l,c,u;for(c=0,u=Array(o);c<o;++c){for(s=0,l=0;l<i;++l)s+=a[~~(d.random()*i)];u[c]=s/i}return u.sort(p),[m(u,r/2),m(u,1-r/2)]}function K(e,t,r,n){n=n||(e=>e);var a=e.length,i=new Float64Array(a);let o=0,s=1,l=n(e[0]),c=l,u=l+t,d;for(;s<a;++s){if((d=n(e[s]))>=u){for(c=(l+c)/2;o<s;++o)i[o]=c;u=d+t,l=d}c=d}for(c=(l+c)/2;o<s;++o)i[o]=c;return r?Y(i,t+t/4):i}function Y(e,t){var r=e.length;let n=0,a=1,i,o;for(;e[n]===e[a];)++a;for(;a<r;){for(i=a+1;e[a]===e[i];)++i;if(e[a]-e[a-1]<t){for(o=a+(n+i-a-a>>1);o<a;)e[o++]=e[a];for(;o>a;)e[o--]=e[n]}n=a,a=i}return e}function J(e){return function(){return(e=(1103515245*e+12345)%2147483647)/2147483647}}function Z(e,t){null==t&&(t=e,e=0);let r,n,a;const i={min(e){return arguments.length?(r=e||0,a=n-r,i):r},max(e){return arguments.length?(n=e||0,a=n-r,i):n},sample(){return r+Math.floor(a*d.random())},pdf(e){return e===Math.floor(e)&&e>=r&&e<n?1/a:0},cdf(e){e=Math.floor(e);return e<r?0:e>=n?1:(e-r+1)/a},icdf(e){return 0<=e&&e<=1?r-1+Math.floor(e*a):NaN}};return i.min(e).max(t)}d.random=Math.random;const n=Math.sqrt(2*Math.PI),x=Math.SQRT2;let o=NaN;function c(e,t){e=e||0,t=null==t?1:t;let r=0,n=0,a,i;if(o==o)r=o,o=NaN;else{for(;r=2*d.random()-1,n=2*d.random()-1,0===(a=r*r+n*n)||1<a;);i=Math.sqrt(-2*Math.log(a)/a),r*=i,o=n*i}return e+r*t}function u(e,t,r){e=(e-(t||0))/(r=null==r?1:r);return Math.exp(-.5*e*e)/(r*n)}function _(e,t,r){e=(e-(t=t||0))/(r=null==r?1:r),t=Math.abs(e);let n;if(37<t)n=0;else{r=Math.exp(-t*t/2);let e;t<7.07106781186547?(e=(e=(e=(e=(e=(e=.0352624965998911*t+.700383064443688)*t+6.37396220353165)*t+33.912866078383)*t+112.079291497871)*t+221.213596169931)*t+220.206867912376,n=r*e,e=(e=(e=(e=(e=(e=(e=.0883883476483184*t+1.75566716318264)*t+16.064177579207)*t+86.7807322029461)*t+296.564248779674)*t+637.333633378831)*t+793.826512519948)*t+440.413735824752,n/=e):(e=t+1/(e=t+2/(e=t+3/(e=t+4/(e=t+.65)))),n=r/e/2.506628274631)}return 0<e?1-n:n}function y(e,t,r){return e<0||1<e?NaN:(t||0)+(null==r?1:r)*x*Q(2*e-1)}function Q(e){let t=-Math.log((1-e)*(1+e)),r;return(r=t<6.25?(t-=3.125,1.6536545626831027+(r=.24015818242558962+(r=(r=(r=.00018673420803405714+(r=(r=(r=4.2347877827932404e-7+(r=(r=(r=1.0512122733215323e-9+(r=(r=(r=26335093153082323e-28+(r=(r=(r=6637638134358324e-30+(r=20972767875968562e-33+(r=(r=11157877678025181e-33+(r=128584807152564e-32+(r=(r=-364441206401782e-35)*t-16850591381820166e-35)*t)*t)*t-1333171662854621e-31)*t)*t)*t-4054566272975207e-29)*t-8151934197605472e-29)*t)*t-12975133253453532e-27)*t-5415412054294628e-26)*t)*t-4.112633980346984e-9)*t-2.9070369957882005e-8)*t)*t-13654692000834679e-22)*t-13882523362786469e-21)*t)*t-.000740702534166267)*t-.006033670871430149)*t)*t):t<16?(t=Math.sqrt(t)-3.25,3.0838856104922208+(r=1.0052589676941592+(r=.005370914553590064+(r=(r=.002491442096107851+(r=(r=.0009532893797373805+(r=(r=24031110387097894e-21+(r=6828485145957318e-20+(r=(r=12475304481671779e-21+(r=29234449089955446e-22+(r=(r=15027403968909828e-22+(r=1.8239629214389228e-8+(r=(r=9.075656193888539e-8+(r=2.2137376921775787e-9)*t)*t-2.7517406297064545e-7)*t)*t)*t-4013867526981546e-21)*t)*t)*t-47318229009055734e-21)*t)*t)*t-.0003550375203628475)*t)*t-.0016882755560235047)*t)*t-.003751208507569241)*t)*t)*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,4.849906401408584+(r=1.0103004648645344+(r=(r=(r=7599527703001776e-20+(r=(r=4526062597223154e-21+(r=(r=2.2900482228026655e-7+(r=(r=2.914795345090108e-8+(r=(r=7.61570120807834e-9+(r=(r=1.5076572693500548e-9+(r=(r=-27109920616438573e-27)*t-2.555641816996525e-10)*t)*t-3.789465440126737e-9)*t)*t-1.496002662714924e-8)*t)*t-6.771199775845234e-8)*t)*t-9.9298272942317e-7)*t)*t-1968177810553167e-20)*t)*t-.00021503011930044477)*t-.00013871931833623122)*t)*t):1/0)*e}function T(e,t){let r,n;const a={mean(e){return arguments.length?(r=e||0,a):r},stdev(e){return arguments.length?(n=null==e?1:e,a):n},sample:()=>c(r,n),pdf:e=>u(e,r,n),cdf:e=>_(e,r,n),icdf:e=>y(e,r,n)};return a.mean(e).stdev(t)}function X(n,a){const i=T();let o=0;const t={data(e){return arguments.length?(n=e,o=e?e.length:0,t.bandwidth(a)):n},bandwidth(e){return arguments.length?(!(a=e)&&n&&(a=l(n)),t):a},sample(){return n[~~(d.random()*o)]+a*i.sample()},pdf(e){let t=0,r=0;for(;r<o;++r)t+=i.pdf((e-n[r])/a);return t/a/o},cdf(e){let t=0,r=0;for(;r<o;++r)t+=i.cdf((e-n[r])/a);return t/o},icdf(){throw Error("KDE icdf not supported.")}};return t.data(n)}function b(e,t){return e=e||0,t=null==t?1:t,Math.exp(e+c()*t)}function v(e,t,r){if(e<=0)return 0;t=t||0,r=null==r?1:r;t=(Math.log(e)-t)/r;return Math.exp(-.5*t*t)/(r*n*e)}function E(e,t,r){return _(Math.log(e),t,r)}function S(e,t,r){return Math.exp(y(e,t,r))}function ee(e,t){let r,n;const a={mean(e){return arguments.length?(r=e||0,a):r},stdev(e){return arguments.length?(n=null==e?1:e,a):n},sample:()=>b(r,n),pdf:e=>v(e,r,n),cdf:e=>E(e,r,n),icdf:e=>S(e,r,n)};return a.mean(e).stdev(t)}function te(a,t){let i=0,o;const r={weights(e){return arguments.length?(o=function(e){var t=[];let r=0,n;for(n=0;n<i;++n)r+=t[n]=null==e[n]?1:+e[n];for(n=0;n<i;++n)t[n]/=r;return t}(t=e||[]),r):t},distributions(e){return arguments.length?(a=e?(i=e.length,e):(i=0,[]),r.weights(t)):a},sample(){var e=d.random();let t=a[i-1],r=o[0],n=0;for(;n<i-1;r+=o[++n])if(e<r){t=a[n];break}return t.sample()},pdf(e){let t=0,r=0;for(;r<i;++r)t+=o[r]*a[r].pdf(e);return t},cdf(e){let t=0,r=0;for(;r<i;++r)t+=o[r]*a[r].cdf(e);return t},icdf(){throw Error("Mixture icdf not supported.")}};return r.distributions(a).weights(t)}function A(e,t){return null==t&&(t=null==e?1:e,e=0),e+(t-e)*d.random()}function O(e,t,r){return null==r&&(r=null==t?1:t,t=0),t<=e&&e<=r?1/(r-t):0}function C(e,t,r){return null==r&&(r=null==t?1:t,t=0),e<t?0:r<e?1:(e-t)/(r-t)}function k(e,t,r){return null==r&&(r=null==t?1:t,t=0),0<=e&&e<=1?t+e*(r-t):NaN}function re(e,t){let r,n;const a={min(e){return arguments.length?(r=e||0,a):r},max(e){return arguments.length?(n=null==e?1:e,a):n},sample:()=>A(r,n),pdf:e=>O(e,r,n),cdf:e=>C(e,r,n),icdf:e=>k(e,r,n)};return null==t&&(t=null==e?1:e,e=0),a.min(e).max(t)}function w(e,t,r){let n=0,a=0;for(const o of e){var i=r(o);null==t(o)||null==i||isNaN(i)||(n+=(i-n)/++a)}return{coef:[n],predict:()=>n,rSquared:0}}function R(e,t,r,n){n-=e*e,r=Math.abs(n)<1e-24?0:(r-e*t)/n;return[t-r*e,r]}function I(e,r,n,t){e=e.filter(e=>{var t=r(e),e=n(e);return null!=t&&(t=+t)>=t&&null!=e&&(e=+e)>=e}),t&&e.sort((e,t)=>r(e)-r(t));var a=e.length,i=new Float64Array(a),o=new Float64Array(a);let s=0,l=0,c=0,u,d,f;for(f of e)i[s]=u=+r(f),o[s]=d=+n(f),++s,l+=(u-l)/s,c+=(d-c)/s;for(s=0;s<a;++s)i[s]-=l,o[s]-=c;return[i,o,l,c]}function M(e,t,r,n){let a=-1,i,o;for(const s of e)i=t(s),o=r(s),null!=i&&(i=+i)>=i&&null!=o&&(o=+o)>=o&&n(i,o,++a)}function P(e,t,r,n,a){let i=0,o=0;return M(e,t,r,(e,t)=>{e=t-a(e),t-=n;i+=e*e,o+=t*t}),1-i/o}function N(e,t,r){let n=0,a=0,i=0,o=0,s=0;M(e,t,r,(e,t)=>{++s,n+=(e-n)/s,a+=(t-a)/s,i+=(e*t-i)/s,o+=(e*e-o)/s});const l=R(n,a,i,o),c=e=>l[0]+l[1]*e;return{coef:l,predict:c,rSquared:P(e,t,r,a,c)}}function ne(e,t,r){let n=0,a=0,i=0,o=0,s=0;M(e,t,r,(e,t)=>{++s,e=Math.log(e),n+=(e-n)/s,a+=(t-a)/s,i+=(e*t-i)/s,o+=(e*e-o)/s});const l=R(n,a,i,o),c=e=>l[0]+l[1]*Math.log(e);return{coef:l,predict:c,rSquared:P(e,t,r,a,c)}}function ae(e,t,r){const[n,,a,i]=I(e,t,r);let o=0,s=0,l=0,c=0,u=0,d,f,p;M(e,t,r,(e,t)=>{d=n[u++],f=Math.log(t),p=d*t,o+=(t*f-o)/u,s+=(p-s)/u,l+=(p*f-l)/u,c+=(d*p-c)/u});const[h,g]=R(s/i,o/i,l/i,c/i),m=e=>Math.exp(h+g*(e-a));return{coef:[Math.exp(h-g*a),g],predict:m,rSquared:P(e,t,r,i,m)}}function ie(e,t,r){let n=0,a=0,i=0,o=0,s=0,l=0;M(e,t,r,(e,t)=>{var e=Math.log(e),r=Math.log(t);++l,n+=(e-n)/l,a+=(r-a)/l,i+=(e*r-i)/l,o+=(e*e-o)/l,s+=(t-s)/l});const c=R(n,a,i,o),u=e=>c[0]*Math.pow(e,c[1]);return c[0]=Math.exp(c[0]),{coef:c,predict:u,rSquared:P(e,t,r,s,u)}}function D(e,t,r){const[n,a,i,o]=I(e,t,r),s=n.length;let l=0,c=0,u=0,d=0,f=0,p,h,g,m;for(p=0;p<s;)h=n[p],g=a[p++],m=h*h,l+=(m-l)/p,c+=(m*h-c)/p,u+=(m*m-u)/p,d+=(h*g-d)/p,f+=(m*g-f)/p;const _=u-l*l,y=l*_-c*c,T=(f*l-d*c)/y,b=(d*_-f*c)/y,v=-T*l,E=e=>(e-=i,T*e*e+b*e+v+o);return{coef:[v-b*i+T*i*i+o,b-2*T*i,T],predict:E,rSquared:P(e,t,r,o,E)}}function oe(e,t,r,n){if(0===n)return w(e,t,r);if(1===n)return N(e,t,r);if(2===n)return D(e,t,r);const[a,i,o,s]=I(e,t,r),l=a.length,c=[],u=[],d=n+1;let f,p,h,g,m;for(f=0;f<d;++f){for(h=0,g=0;h<l;++h)g+=Math.pow(a[h],f)*i[h];for(c.push(g),m=new Float64Array(d),p=0;p<d;++p){for(h=0,g=0;h<l;++h)g+=Math.pow(a[h],f+p);m[p]=g}u.push(m)}u.push(c);const _=le(u),y=e=>{e-=o;let t=s+_[0]+_[1]*e+_[2]*e*e;for(f=3;f<d;++f)t+=_[f]*Math.pow(e,f);return t};return{coef:se(d,_,-o,s),predict:y,rSquared:P(e,t,r,s,y)}}function se(e,t,r,n){var a=Array(e);let i,o,s,l;for(i=0;i<e;++i)a[i]=0;for(i=e-1;0<=i;--i)for(s=t[i],l=1,a[i]+=s,o=1;o<=i;++o)l*=(i+1-o)/o,a[i-o]+=s*Math.pow(r,o)*l;return a[0]+=n,a}function le(e){var t=e.length-1,r=[];let n,a,i,o,s;for(n=0;n<t;++n){for(o=n,a=n+1;a<t;++a)Math.abs(e[n][a])>Math.abs(e[n][o])&&(o=a);for(i=n;i<1+t;++i)s=e[i][n],e[i][n]=e[i][o],e[i][o]=s;for(a=n+1;a<t;++a)for(i=t;i>=n;i--)e[i][a]-=e[i][n]*e[n][a]/e[n][n]}for(a=t-1;0<=a;--a){for(s=0,i=a+1;i<t;++i)s+=e[i][a]*r[i];r[a]=(e[t][a]-s)/e[a][a]}return r}const L=2,F=1e-12;function ce(e,t,r,n){var[o,s,e,t]=I(e,t,r,!0),a=o.length,i=Math.max(2,~~(n*a)),l=new Float64Array(a),c=new Float64Array(a),u=new Float64Array(a).fill(1);for(let e=-1;++e<=L;){var d=[0,i-1];for(let e=0;e<a;++e){var f=o[e],p=d[0],h=d[1],g=f-o[p]>o[h]-f?p:h;let t=0,r=0,n=0,a=0,i=0;var m=1/Math.abs(o[g]-f||1);for(let e=p;e<=h;++e){var _=o[e],y=s[e],T=ue(Math.abs(f-_)*m)*u[e],b=_*T;t+=T,r+=b,n+=y*T,a+=y*b,i+=_*b}var[g,p]=R(r/t,n/t,a/t,i/t);l[e]=g+p*f,c[e]=Math.abs(s[e]-l[e]),de(o,e+1,d)}if(e===L)break;var v=W(c);if(Math.abs(v)<F)break;for(let e=0,t,r;e<a;++e)t=c[e]/(6*v),u[e]=1<=t?F:(r=1-t*t)*r}return fe(o,l,e,t)}function ue(e){return(e=1-e*e*e)*e*e}function de(e,t,r){var n=e[t];let a=r[0],i=r[1]+1;if(!(i>=e.length))for(;t>a&&e[i]-n<=n-e[a];)r[0]=++a,r[1]=i,++i}function fe(e,t,r,n){var a=e.length,i=[];let o=0,s=0,l=[],c;for(;o<a;++o)c=e[o]+r,l[0]===c?l[1]+=(t[o]-l[1])/++s:(s=0,l[1]+=n,l=[c,t[o]],i.push(l));return l[1]+=n,i}const me=.5*Math.PI/180;function pe(t,r,n,a){n=n||25,a=Math.max(n,a||200);var i=e=>[e,t(e)],o=r[0],r=r[1],s=r-o,l=s/a,c=[i(o)],u=[];if(n===a){for(let e=1;e<a;++e)c.push(i(o+e/n*s));c.push(i(r))}else{u.push(i(r));for(let e=n;0<--e;)u.push(i(o+e/n*s));let e=c[0],t=u[u.length-1];for(var d=1/s,f=he(e[1],u);t;){var p=i((e[0]+t[0])/2);p[0]-e[0]>=l&&ge(e,p,t,d,f)>me?u.push(p):(e=t,c.push(t),u.pop()),t=u[u.length-1]}}return c}function he(e,t){let r=e,n=e;var a=t.length;for(let e=0;e<a;++e){var i=t[e][1];i<r&&(r=i),i>n&&(n=i)}return 1/(n-r)}function ge(e,t,r,n,a){r=Math.atan2(a*(r[1]-e[1]),n*(r[0]-e[0])),a=Math.atan2(a*(t[1]-e[1]),n*(t[0]-e[0]));return Math.abs(r-a)}d.bandwidthNRD=l,d.bin=q,d.bootstrapCI=z,d.cumulativeLogNormal=E,d.cumulativeNormal=_,d.cumulativeUniform=C,d.densityLogNormal=v,d.densityNormal=u,d.densityUniform=O,d.dotbin=K,d.quantileLogNormal=S,d.quantileNormal=y,d.quantileUniform=k,d.quantiles=r,d.quartiles=s,d.randomInteger=Z,d.randomKDE=X,d.randomLCG=J,d.randomLogNormal=ee,d.randomMixture=te,d.randomNormal=T,d.randomUniform=re,d.regressionConstant=w,d.regressionExp=ae,d.regressionLinear=N,d.regressionLoess=ce,d.regressionLog=ne,d.regressionPoly=oe,d.regressionPow=ie,d.regressionQuad=D,d.sampleCurve=pe,d.sampleLogNormal=b,d.sampleNormal=c,d.sampleUniform=A,d.setRandom=$}}return du.exports}function pu(){if(!cu){cu=1;{var e=uu.exports;var O=jo();var C=su();var _=fu();var h=au();function k(e){return e&&e.length?1===e.length?e[0]:(a=e,e=>{var t=a.length;let r=1,n=String(a[0](e));for(;r<t;++r)n+="|"+a[r](e);return n}):function(){return""};var a}function L(e,t,r){return r||e+(t?"_"+t:"")}var t=()=>{};const we={init:t,add:t,rem:t,idx:0},N={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.valid?e.sum:void 0,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>1<e.valid?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>1<e.valid?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>1<e.valid?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>1<e.valid?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>1<e.valid?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||void 0===e.min)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||void 0===e.max)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,r)=>{t<e.min&&(e.argmin=r)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,r)=>{t>e.max&&(e.argmax=r)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3},exponential:{init:(e,t)=>{e.exp=0,e.exp_r=t},value:e=>e.valid?e.exp*(1-e.exp_r)/(1-e.exp_r**e.valid):void 0,add:(e,t)=>e.exp=e.exp_r*e.exp+t,rem:(e,t)=>e.exp=(e.exp-t/e.exp_r**(e.valid-1))/e.exp_r},exponentialb:{value:e=>e.valid?e.exp*(1-e.exp_r):void 0,req:["exponential"],idx:1}};t=Object.keys(N).filter(e=>"__count__"!==e);function F(e,t,r){return N[e](r,t)}function U(e,t){return e.idx-t.idx}function B(){this.valid=0,this.missing=0,this._ops.forEach(e=>null==e.aggregate_param?e.init(this):e.init(this,e.aggregate_param))}function j(t,r){null==t||""===t?++this.missing:t==t&&(++this.valid,this._ops.forEach(e=>e.add(this,t,r)))}function H(t,r){null==t||""===t?--this.missing:t==t&&(--this.valid,this._ops.forEach(e=>e.rem(this,t,r)))}function G(t){return this._out.forEach(e=>t[e.out]=e.value(this)),t}function V(e,t){const r=t||O.identity,n=function(e){const t={},r=(e.forEach(e=>t[e.name]=e),e=>{e.req&&e.req.forEach(e=>{t[e]||r(t[e]=N[e]())})});return e.forEach(r),Object.values(t).sort(U)}(e),a=e.slice().sort(U);function i(e){this._ops=n,this._out=a,this.cell=e,this.init()}return i.prototype.init=B,i.prototype.add=j,i.prototype.rem=H,i.prototype.set=G,i.prototype.get=r,i.fields=e.map(e=>e.out),i}function y(e){this._key=e?O.field(e):C.tupleid,this.reset()}[...t,"__count__"].forEach(e=>{var r,n;N[e]=(r=e,n=N[e],(e,t)=>O.extend({name:r,aggregate_param:t,out:e||r},we,n))});var r=y.prototype;function n(e){C.Transform.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}r.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},r.add=function(e){this._add.push(e)},r.rem=function(e){this._rem.push(e)},r.values=function(){if(this._get=null,0===this._rem.length)return this._add;var e=this._add,t=this._rem,r=this._key,n=e.length,a=t.length,i=Array(n-a),o={};let s,l,c;for(s=0;s<a;++s)o[r(t[s])]=1;for(s=0,l=0;s<n;++s)o[r(c=e[s])]?o[r(c)]=0:i[l++]=c;return this._rem=[],this._add=i},r.distinct=function(e){var t=this.values(),r={};let n=t.length,a=0,i;for(;0<=--n;)i=e(t[n])+"",O.hasOwnProperty(r,i)||(r[i]=1,++a);return a},r.extent=function(e){var t,r;return this._get===e&&this._ext||(t=this.values(),r=O.extentIndex(t,e),this._ext=[t[r[0]],t[r[1]]],this._get=e),this._ext},r.argmin=function(e){return this.extent(e)[0]||{}},r.argmax=function(e){return this.extent(e)[1]||{}},r.min=function(e){var t=this.extent(e)[0];return null!=t?e(t):void 0},r.max=function(e){var t=this.extent(e)[1];return null!=t?e(t):void 0},r.quartile=function(e){return this._get===e&&this._q||(this._q=_.quartiles(this.values(),e),this._get=e),this._q},r.q1=function(e){return this.quartile(e)[0]},r.q2=function(e){return this.quartile(e)[1]},r.q3=function(e){return this.quartile(e)[2]},r.ci=function(e){return this._get===e&&this._ci||(this._ci=_.bootstrapCI(this.values(),1e3,.05,e),this._get=e),this._ci},r.ci0=function(e){return this.ci(e)[0]},r.ci1=function(e){return this.ci(e)[1]},n.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:t},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},O.inherits(n,C.Transform,{transform(e,t){const r=this,n=t.fork(t.NO_SOURCE|t.NO_FIELDS),a=e.modified();return r.stamp=n.stamp,r.value&&(a||t.modified(r._inputs,!0))?(r._prev=r.value,r.value=a?r.init(e):Object.create(null),t.visit(t.SOURCE,e=>r.add(e))):(r.value=r.value||r.init(e),t.visit(t.REM,e=>r.rem(e)),t.visit(t.ADD,e=>r.add(e))),n.modifies(r._outputs),r._drop=!1!==e.drop,e.cross&&1<r._dims.length&&(r._drop=!1,r.cross()),t.clean()&&r._drop&&n.clean(!0).runAfter(()=>this.clean()),r.changes(n)},cross(){const l=this,c=l.value,u=l._dnames,d=u.map(()=>({})),f=u.length;function e(e){let t,r,n,a;for(t in e)for(n=e[t].tuple,r=0;r<f;++r)d[r][a=n[u[r]]]=a}e(l._prev),e(c),function e(t,r,n){var a=u[n],i=d[n++];for(const s in i){var o=t?t+"|"+s:s;r[a]=i[s],n<f?e(o,r,n):c[o]||l.cell(o,r)}}("",{},0)},init(e){const i=this._inputs=[],r=this._outputs=[],o={};function n(e){var t=O.array(O.accessorFields(e)),r=t.length;let n=0,a;for(;n<r;++n)o[a=t[n]]||(o[a]=1,i.push(a))}this._dims=O.array(e.groupby),this._dnames=this._dims.map(e=>{var t=O.accessorName(e);return n(e),r.push(t),t}),this.cellkey=e.key||k(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];var t=e.fields||[null],a=e.ops||["count"],s=e.aggregate_params||[null],l=e.as||[],c=t.length,u={};let d,f,p,h,g,m,_;for(c!==a.length&&O.error("Unmatched number of fields and aggregate ops."),_=0;_<c;++_)d=t[_],f=a[_],p=s[_]||null,null==d&&"count"!==f&&O.error("Null aggregate field specified."),m=L(f,g=O.accessorName(d),l[_]),r.push(m),"count"===f?this._counts.push(m):((h=u[g])||(n(d),(h=u[g]=[]).field=d,this._measures.push(h)),"count"!==f&&(this._countOnly=!1),h.push(F(f,p,m)));return this._measures=this._measures.map(e=>V(e,e.field)),Object.create(null)},cellkey:k(),cell(e,t){let r=this.value[e];return r?0===r.num&&this._drop&&r.stamp<this.stamp?(r.stamp=this.stamp,this._adds[this._alen++]=r):r.stamp<this.stamp&&(r.stamp=this.stamp,this._mods[this._mlen++]=r):(r=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=r),r},newcell(e,t){var r={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){var n=this._measures,a=n.length;r.agg=Array(a);for(let e=0;e<a;++e)r.agg[e]=new n[e](r)}return r.store&&(r.data=new y),r},newtuple(t,e){var r=this._dnames,n=this._dims,a=n.length,i={};for(let e=0;e<a;++e)i[r[e]]=n[e](t);return e?C.replace(e.tuple,i):C.ingest(i)},clean(){var e=this.value;for(const t in e)0===e[t].num&&delete e[t]},add(r){var e=this.cellkey(r),e=this.cell(e,r);if(e.num+=1,!this._countOnly){e.store&&e.data.add(r);var n=e.agg;for(let e=0,t=n.length;e<t;++e)n[e].add(n[e].get(r),r)}},rem(r){var e=this.cellkey(r),e=this.cell(e,r);if(--e.num,!this._countOnly){e.store&&e.data.rem(r);var n=e.agg;for(let e=0,t=n.length;e<t;++e)n[e].rem(n[e].get(r),r)}},celltuple(r){var n=r.tuple,a=this._counts;r.store&&r.data.values();for(let e=0,t=a.length;e<t;++e)n[a[e]]=r.num;if(!this._countOnly){var i=r.agg;for(let e=0,t=i.length;e<t;++e)i[e].set(n)}return n},changes(e){var t=this._adds,r=this._mods,n=this._prev,a=this._drop,i=e.add,o=e.rem,s=e.mod;let l,c,u,d;if(n)for(c in n)l=n[c],a&&!l.num||o.push(l.tuple);for(u=0,d=this._alen;u<d;++u)i.push(this.celltuple(t[u])),t[u]=null;for(u=0,d=this._mlen;u<d;++u)(0===(l=r[u]).num&&a?o:s).push(this.celltuple(l)),r[u]=null;return this._alen=this._mlen=0,this._prev=null,e}});function a(e){C.Transform.call(this,null,e)}function W(e,t,r){const n=e;let a=t||[],i=r||[],o={},s=0;return{add:e=>i.push(e),remove:e=>o[n(e)]=++s,size:()=>a.length,data:(e,t)=>(s&&(a=a.filter(e=>!o[n(e)]),o={},s=0),t&&e&&a.sort(e),i.length&&(a=e?O.merge(e,a,i.sort(e)):a.concat(i),i=[]),a)}}function i(e){C.Transform.call(this,[],e)}function q(e){C.Operator.call(this,null,$,e)}function $(e){return this.value&&!e.modified()?this.value:O.compare(e.fields,e.orders)}function o(e){C.Transform.call(this,null,e)}function s(e){C.Transform.call(this,null,e)}a.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},O.inherits(a,C.Transform,{transform(e,t){const r=!1!==e.interval,n=this._bins(e),a=n.start,i=n.step,o=e.as||["bin0","bin1"],s=o[0],l=o[1];let c;return c=e.modified()?(t=t.reflow(!0)).SOURCE:t.modified(O.accessorFields(e.field))?t.ADD_MOD:t.ADD,t.visit(c,r?e=>{var t=n(e);e[s]=t,e[l]=null==t?null:a+i*(1+(t-a)/i)}:e=>e[s]=n(e)),t.modifies(r?o:s)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,r=_.bin(e),n=r.step;let a=r.start,i=a+Math.ceil((r.stop-a)/n)*n,o,s;null!=(o=e.anchor)&&(s=o-(a+n*Math.floor((o-a)/n)),a+=s,i+=s);function l(e){return null==(e=O.toNumber(t(e)))?null:e<a?-1/0:e>i?1/0:(e=Math.max(a,Math.min(e,i-n)),a+n*Math.floor(1e-14+(e-a)/n))}return l.start=a,l.stop=r.stop,l.step=n,this.value=O.accessor(l,O.accessorFields(t),e.name||"bin_"+O.accessorName(t))}}),i.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},O.inherits(i,C.Transform,{transform(e,t){var r=t.fork(t.ALL),n=W(C.tupleid,this.value,r.materialize(r.ADD).add),a=e.sort,e=t.changed()||a&&(e.modified("sort")||t.modified(a.fields));return r.visit(r.REM,n.remove),this.modified(e),this.value=r.source=n.data(C.stableCompare(a),e),t.source&&t.source.root&&(this.value.root=t.source.root),r}}),O.inherits(q,C.Operator),o.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]},O.inherits(o,C.Transform,{transform(o,e){var t=i=>e=>{for(var t,r=function(e,t,r){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase()}return e.match(r)}(c(e),o.case,s)||[],n=0,a=r.length;n<a;++n)l.test(t=r[n])||i(t)};const r=this._parameterCheck(o,e),n=this._counts,s=this._match,l=this._stop,c=o.field,a=o.as||["text","count"],i=t(e=>n[e]=1+(n[e]||0)),u=t(e=>--n[e]);return r?e.visit(e.SOURCE,i):(e.visit(e.ADD,i),e.visit(e.REM,u)),this._finish(e,a)},_parameterCheck(e,t){let r=!1;return!e.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),r=!0),!e.modified("pattern")&&this._match||(this._match=new RegExp(e.pattern||"[\\w']+","g"),r=!0),(r=e.modified("field")||t.modified(e.field.fields)?!0:r)&&(this._counts={}),r},_finish(e,t){var r=this._counts,n=this._tuples||(this._tuples={}),a=t[0],i=t[1],o=e.fork(e.NO_SOURCE|e.NO_FIELDS);let s,l,c;for(s in r)l=n[s],c=r[s]||0,!l&&c?(n[s]=l=C.ingest({}),l[a]=s,l[i]=c,o.add.push(l)):0===c?(l&&o.rem.push(l),r[s]=null,n[s]=null):l[i]!==c&&(l[i]=c,o.mod.push(l));return o.modifies(t)}}),s.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},O.inherits(s,C.Transform,{transform(e,t){var r=t.fork(t.NO_SOURCE),n=e.as||["a","b"],a=n[0],i=n[1],o=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let s=this.value;return o?(s&&(r.rem=s),s=t.materialize(t.SOURCE).source,r.add=this.value=function(e,t,r,n){for(var a,i,o=[],s={},l=e.length,c=0;c<l;++c)for(s[t]=i=e[c],a=0;a<l;++a)s[r]=e[a],n(s)&&(o.push(C.ingest(s)),(s={})[t]=i);return o}(s,a,i,e.filter||O.truthy)):r.mod=s,r.source=this.value,r.modifies(n)}});const Re={kde:_.randomKDE,mixture:_.randomMixture,normal:_.randomNormal,lognormal:_.randomLogNormal,uniform:_.randomUniform},Ie="distributions",Me="function",Pe="field";function l(e){C.Transform.call(this,null,e)}r=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}];function z(e,r){return e?e.map((e,t)=>r[t]||O.accessorName(e)):null}function T(e,t,r){var n=[],a=e=>e(l);let i,o,s,l,c,u;if(null==t)n.push(e.map(r));else for(i={},o=0,s=e.length;o<s;++o)l=e[o],c=t.map(a),(u=i[c])||(i[c]=u=[],u.dims=c,n.push(u)),u.push(r(l));return n}l.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:r.concat({key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:r},{name:"weights",type:"number",array:!0}]})},{name:"as",type:"string",array:!0,default:["value","density"]}]},O.inherits(l,C.Transform,{transform(e,t){var r,n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var t=function t(e,r){var n=e[Me],a=(O.hasOwnProperty(Re,n)||O.error("Unknown distribution function: "+n),Re[n]());for(const i in e)i===Pe?a.data((e.from||r()).map(e[i])):i===Ie?a[i](e[i].map(e=>t(e,r))):typeof a[i]===Me&&a[i](e[i]);return a}(e.distribution,(r=t,()=>r.materialize(r.SOURCE).source)),a=e.steps||e.minsteps||25,i=e.steps||e.maxsteps||200,o=e.method||"pdf";"pdf"!==o&&"cdf"!==o&&O.error("Invalid density method: "+o),e.extent||t.data||O.error("Missing density extent parameter."),o=t[o];const s=e.as||["value","density"],l=e.extent||O.extent(t.data()),c=_.sampleCurve(o,l,a,i).map(e=>{var t={};return t[s[0]]=e[0],t[s[1]]=e[1],C.ingest(t)});this.value&&(n.rem=this.value),this.value=n.add=n.source=c}return n}});function c(e){C.Transform.call(this,null,e)}c.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]};function K(e){C.Operator.call(this,null,Y,e),this.modified(!0)}function Y(t){const r=t.expr;return this.value&&!t.modified("expr")?this.value:O.accessor(e=>r(e,t),O.accessorFields(r),O.accessorName(r))}function u(e){C.Transform.call(this,[void 0,void 0],e)}function d(e,t){C.Operator.call(this,e),this.parent=t,this.count=0}function f(e){C.Transform.call(this,{},e),this._keys=O.fastmap();const n=this._targets=[];n.active=0,n.forEach=r=>{for(let e=0,t=n.active;e<t;++e)r(n[e],e,n)}}function J(e){C.Operator.call(this,null,Z,e)}function Z(e){return this.value&&!e.modified()?this.value:O.isArray(e.name)?O.array(e.name).map(e=>O.field(e)):O.field(e.name,e.as)}function p(e){C.Transform.call(this,O.fastmap(),e)}function g(e){C.Transform.call(this,[],e)}function m(e){C.Transform.call(this,[],e)}function b(e){C.Transform.call(this,null,e)}function Q(e){C.Transform.call(this,[],e)}function v(e,t){return null==e||null==t?NaN:e<t?-1:t<e?1:t<=e?0:NaN}function X(r){let i,o,a;function s(e,t,r=0,n=e.length){if(r<n){if(0!==i(t,t))return n;do{var a=r+n>>>1;o(e[a],t)<0?r=1+a:n=a}while(r<n)}return r}return a=2!==r.length?(i=v,o=(e,t)=>v(r(e),t),(e,t)=>r(e)-t):(i=r===v||r===function(e,t){return null==e||null==t?NaN:t<e?-1:e<t?1:e<=t?0:NaN}?r:ee,o=r),{left:s,center:function(e,t,r=0,n=e.length){return n=s(e,t,r,n-1),r<n&&a(e[n-1],t)>-a(e[n],t)?n-1:n},right:function(e,t,r=0,n=e.length){if(r<n){if(0!==i(t,t))return n;do{var a=r+n>>>1;o(e[a],t)<=0?r=1+a:n=a}while(r<n)}return r}}}function ee(){return 0}function te(e,t){return(null==e||!(e<=e))-(null==t||!(t<=t))||(e<t?-1:t<e?1:0)}function E(t,r){let n;if(void 0===r)for(const e of t)null!=e&&(n<e||void 0===n&&e>=e)&&(n=e);else{let e=-1;for(var a of t)null!=(a=r(a,++e,t))&&(n<a||void 0===n&&a>=a)&&(n=a)}return n}function S(t,r){let n;if(void 0===r)for(const e of t)null!=e&&(n>e||void 0===n&&e>=e)&&(n=e);else{let e=-1;for(var a of t)null!=(a=r(a,++e,t))&&(n>a||void 0===n&&a>=a)&&(n=a)}return n}function re(r,n,a=0,i=1/0,o){if(n=Math.floor(n),a=Math.floor(Math.max(0,a)),i=Math.floor(Math.min(r.length-1,i)),a<=n&&n<=i)for(o=void 0===o?te:function(n=v){if(n===v)return te;if("function"!=typeof n)throw new TypeError("compare is not a function");return(e,t)=>{var r=n(e,t);return r||0===r?r:(0===n(t,t))-(0===n(e,e))}}(o);a<i;){600<i-a&&(s=i-a+1,l=n-a+1,u=Math.log(s),c=.5*Math.exp(2*u/3),u=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1),re(r,n,Math.max(a,Math.floor(n-l*c/s+u)),Math.min(i,Math.floor(n+(s-l)*c/s+u)),o));var s,l,c,u,d=r[n];let e=a,t=i;for(A(r,a,n),0<o(r[i],d)&&A(r,a,i);e<t;){for(A(r,e,t),++e,--t;o(r[e],d)<0;)++e;for(;0<o(r[t],d);)--t}0===o(r[a],d)?A(r,a,t):A(r,++t,i),t<=n&&(a=t+1),n<=t&&(i=t-1)}return r}function A(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function ne(e,t,r){var n;if((r=(e=Float64Array.from(function*(t,r){if(void 0===r)for(var e of t)null!=e&&(e=+e)>=e&&(yield e);else{let e=-1;for(var n of t)null!=(n=r(n,++e,t))&&(n=+n)>=n&&(yield n)}}(e,r))).length)&&!isNaN(t=+t))return t<=0||r<2?S(e):1<=t?E(e):(r=(r-1)*t,(n=E(re(e,t=Math.floor(r)).subarray(0,t+1)))+(S(e.subarray(t+1))-n)*(r-t))}function ae(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=0|Math.max(0,Math.ceil((t-e)/r)),i=new Array(a);++n<a;)i[n]=e+n*r;return i}O.inherits(c,C.Transform,{transform(e,t){if(this.value&&!e.modified()&&!t.changed())return t;const r=t.materialize(t.SOURCE).source,n=T(t.source,e.groupby,O.identity),a=e.smooth||!1,i=e.field,o=e.step||(u=i,O.span(O.extent(r,u))/30),s=C.stableCompare((e,t)=>i(e)-i(t)),l=e.as||"bin",c=n.length;var u;let d=1/0,f=-1/0,p=0,h;for(;p<c;++p){var g=n[p].sort(s);h=-1;for(const m of _.dotbin(g,o,a,i))m<d&&(d=m),m>f&&(f=m),g[++h][l]=m}return this.value={start:d,stop:f,step:o},t.reflow(!0).modifies(l)}}),O.inherits(K,C.Operator),u.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},O.inherits(u,C.Transform,{transform(e,t){const r=this.value,n=e.field,a=t.changed()||t.modified(n.fields)||e.modified("field");let i=r[0],o=r[1];if(!a&&null!=i||(i=1/0,o=-1/0),t.visit(a?t.SOURCE:t.ADD,e=>{e=O.toNumber(n(e));null!=e&&(e<i&&(i=e),e>o)&&(o=e)}),!Number.isFinite(i)||!Number.isFinite(o)){let e=O.accessorName(n);e=e&&` for field "${e}"`,t.dataflow.warn(`Infinite extent${e}: [${i}, ${o}]`),i=o=void 0}this.value=[i,o]}}),O.inherits(d,C.Operator,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){--this.count,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}}),O.inherits(f,C.Transform,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,r,n){var a=this.value;let i=O.hasOwnProperty(a,e)&&a[e],o,s;return i?i.value.stamp<r.stamp&&(i.init(r),this.activate(i)):(s=n||(s=this._group[e])&&s.tuple,o=r.dataflow,i=new d(r.fork(r.NO_SOURCE),this),o.add(i).connect(t(o,e,s)),a[e]=i,this.activate(i)),i},clean(){var e,t,r=this.value;let n=0;for(const a in r)0===r[a].count&&((e=r[a].detachSubflow)&&e(),delete r[a],++n);n&&(t=this._targets.filter(e=>e&&0<e.count),this.initTargets(t))},initTargets(e){var t=this._targets,r=t.length,n=e?e.length:0;let a=0;for(;a<n;++a)t[a]=e[a];for(;a<r&&null!=t[a];++a)t[a]=null;t.active=n},transform(e,t){const r=t.dataflow,a=e.key,n=e.subflow,i=this._keys,o=e.modified("key"),s=e=>this.subflow(e,n,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,e=>{var t=C.tupleid(e),r=i.get(t);void 0!==r&&(i.delete(t),s(r).rem(e))}),t.visit(t.ADD,e=>{var t=a(e);i.set(C.tupleid(e),t),s(t).add(e)}),o||t.modified(a.fields)?t.visit(t.MOD,e=>{var t=C.tupleid(e),r=i.get(t),n=a(e);r===n?s(n).mod(e):(i.set(t,n),s(r).rem(e),s(n).add(e))}):t.changed(t.MOD)&&t.visit(t.MOD,e=>{s(i.get(C.tupleid(e))).mod(e)}),o&&t.visit(t.REFLOW,e=>{var t=C.tupleid(e),r=i.get(t),n=a(e);r!==n&&(i.set(t,n),s(r).rem(e),s(n).add(e))}),t.clean()?r.runAfter(()=>{this.clean(),i.clean()}):i.empty>r.cleanThreshold&&r.runAfter(i.clean),t}}),O.inherits(J,C.Operator),p.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},O.inherits(p,C.Transform,{transform(a,e){const t=e.dataflow,i=this.value,r=e.fork(),o=r.add,s=r.rem,l=r.mod,c=a.expr;let u=!0;function n(e){var t=C.tupleid(e),r=c(e,a),n=i.get(t);r&&n?(i.delete(t),o.push(e)):r||n?u&&r&&!n&&l.push(e):(i.set(t,1),s.push(e))}return e.visit(e.REM,e=>{var t=C.tupleid(e);i.has(t)?i.delete(t):s.push(e)}),e.visit(e.ADD,e=>{c(e,a)?o.push(e):i.set(C.tupleid(e),1)}),e.visit(e.MOD,n),a.modified()&&(u=!1,e.visit(e.REFLOW,n)),i.empty>t.cleanThreshold&&t.runAfter(i.clean),r}}),g.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},O.inherits(g,C.Transform,{transform(e,t){const s=t.fork(t.NO_SOURCE),l=e.fields,c=z(l,e.as||[]),u=e.index||null,d=c.length;return s.rem=this.value,t.visit(t.SOURCE,t=>{var e=l.map(e=>e(t)),r=e.reduce((e,t)=>Math.max(e,t.length),0);let n=0,a,i,o;for(;n<r;++n){for(i=C.derive(t),a=0;a<d;++a)i[c[a]]=null==(o=e[a][n])?null:o;u&&(i[u]=n),s.add.push(i)}}),this.value=s.source=s.add,u&&s.modifies(u),s.modifies(c)}}),m.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},O.inherits(m,C.Transform,{transform(e,t){const n=t.fork(t.NO_SOURCE),a=e.fields,i=a.map(O.accessorName),r=e.as||["key","value"],o=r[0],s=r[1],l=a.length;return n.rem=this.value,t.visit(t.SOURCE,r=>{for(let e=0,t;e<l;++e)(t=C.derive(r))[o]=i[e],t[s]=a[e](r),n.add.push(t)}),this.value=n.source=n.add,n.modifies(r)}}),b.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},O.inherits(b,C.Transform,{transform(t,e){const r=t.expr,n=t.as,a=t.modified(),i=t.initonly?e.ADD:a?e.SOURCE:e.modified(r.fields)||e.modified(n)?e.ADD_MOD:e.ADD;return a&&(e=e.materialize().reflow(!0)),t.initonly||e.modifies(n),e.visit(i,e=>e[n]=r(e,t))}}),O.inherits(Q,C.Transform,{transform(e,t){var t=t.fork(t.ALL),r=e.generator;let n=this.value,a=e.size-n.length,i,o,s;if(0<a){for(i=[];0<=--a;)i.push(s=C.ingest(r(e))),n.push(s);t.add=t.add.length?t.materialize(t.ADD).add.concat(i):i}else o=n.slice(0,-a),t.rem=t.rem.length?t.materialize(t.REM).rem.concat(o):o,n=n.slice(-a);return t.source=this.value=n,t}});const D={value:"value",median:function(e,t){return ne(e,.5,t)},mean:function(t,r){let n=0,a=0;if(void 0===r)for(var e of t)null!=e&&(e=+e)>=e&&(++n,a+=e);else{let e=-1;for(var i of t)null!=(i=r(i,++e,t))&&(i=+i)>=i&&(++n,a+=i)}if(n)return a/n},min:S,max:E},Ne=[];function w(e){C.Transform.call(this,[],e)}function R(e){n.call(this,e)}function I(e){C.Transform.call(this,null,e)}function ie(e){C.Operator.call(this,null,oe,e)}function oe(e){return this.value&&!e.modified()?this.value:O.key(e.fields,e.flat)}function se(e){C.Transform.call(this,[],e),this._pending=null}function M(e,t,r){r.forEach(C.ingest);t=t.fork(t.NO_FIELDS&t.NO_SOURCE);return t.rem=e.value,e.value=t.source=t.add=r,e._pending=null,t.rem.length&&t.clean(!0),t}function P(e){C.Transform.call(this,{},e)}function le(e){C.Operator.call(this,null,ce,e)}function ce(e){if(this.value&&!e.modified())return this.value;var t=e.extents,r=t.length;let n=1/0,a=-1/0,i,o;for(i=0;i<r;++i)(o=t[i])[0]<n&&(n=o[0]),o[1]>a&&(a=o[1]);return[n,a]}function ue(e){C.Operator.call(this,null,de,e)}function de(e){return this.value&&!e.modified()?this.value:e.values.reduce((e,t)=>e.concat(t),[])}function fe(e){C.Transform.call(this,null,e)}function pe(e){n.call(this,e)}function he(e){f.call(this,e)}function ge(e){C.Transform.call(this,null,e)}function me(e){C.Transform.call(this,null,e)}function _e(e){C.Transform.call(this,null,e)}w.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},O.inherits(w,C.Transform,{transform(e,t){for(var r,n,a,i,o,s,l,c,u=t.fork(t.ALL),d=function(e){var t,r=e.method||D.value;if(null!=D[r])return r===D.value?(t=void 0!==e.value?e.value:0,()=>t):D[r];O.error("Unrecognized imputation method: "+r)}(e),f=function(e){const t=e.field;return e=>e?t(e):NaN}(e),p=O.accessorName(e.field),h=O.accessorName(e.key),g=(e.groupby||[]).map(O.accessorName),m=function(e,t,r,n){var a,i,o,s,l,c,u,d=e=>e(u),f=[],p=n?n.slice():[],h={},g={};for(p.forEach((e,t)=>h[e]=t+1),s=0,c=e.length;s<c;++s)u=e[s],l=r(u),l=h[l]||(h[l]=p.push(l)),i=(a=t?t.map(d):Ne)+"",(o=g[i])||(o=g[i]=[],f.push(o),o.values=a),o[l-1]=u;return f.domain=p,f}(t.source,e.groupby,e.key,e.keyvals),_=[],t=this.value,y=m.domain.length,T=0,b=m.length;T<b;++T)for(a=(r=m[T]).values,n=NaN,s=0;s<y;++s)if(null==r[s]){for(i=m.domain[s],c={_impute:!0},o=0,l=a.length;o<l;++o)c[g[o]]=a[o];c[h]=i,c[p]=Number.isNaN(n)?n=d(r,f):n,_.push(C.ingest(c))}return _.length&&(u.add=u.materialize(u.ADD).add.concat(_)),t.length&&(u.rem=u.materialize(u.REM).rem.concat(t)),this.value=_,u}}),R.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:t},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},O.inherits(R,n,{transform(e,t){const r=this,n=e.modified();let a;return r.value&&(n||t.modified(r._inputs,!0))?(a=r.value=n?r.init(e):{},t.visit(t.SOURCE,e=>r.add(e))):(a=r.value=r.value||this.init(e),t.visit(t.REM,e=>r.rem(e)),t.visit(t.ADD,e=>r.add(e))),r.changes(),t.visit(t.SOURCE,e=>{O.extend(e,a[r.cellkey(e)].tuple)}),t.reflow(n).modifies(this._outputs)},changes(){var e=this._adds,t=this._mods;let r,n;for(r=0,n=this._alen;r<n;++r)this.celltuple(e[r]),e[r]=null;for(r=0,n=this._mlen;r<n;++r)this.celltuple(t[r]),t[r]=null;this._alen=this._mlen=0}}),I.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},O.inherits(I,C.Transform,{transform(s,e){var t=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||s.modified()){const r=e.materialize(e.SOURCE).source,n=T(r,s.groupby,s.field),l=(s.groupby||[]).map(O.accessorName),c=s.bandwidth,u=s.cumulative?"cdf":"pdf",d=s.as||["value","density"],f=[];let a=s.extent,i=s.steps||s.minsteps||25,o=s.steps||s.maxsteps||200;"pdf"!=u&&"cdf"!=u&&O.error("Invalid density method: "+u),"shared"===s.resolve&&(a=a||O.extent(r,s.field),i=o=s.steps||o),n.forEach(r=>{const e=_.randomKDE(r,c)[u],n=s.counts?r.length:1,t=a||O.extent(r);_.sampleCurve(e,t,i,o).forEach(e=>{var t={};for(let e=0;e<l.length;++e)t[l[e]]=r.dims[e];t[d[0]]=e[0],t[d[1]]=e[1]*n,f.push(C.ingest(t))})}),this.value&&(t.rem=this.value),this.value=t.add=t.source=f}return t}}),O.inherits(ie,C.Operator),O.inherits(se,C.Transform,{transform(e,t){var r,n=t.dataflow;return this._pending?M(this,t,this._pending):(r=e).modified("async")&&!(r.modified("values")||r.modified("url")||r.modified("format"))?t.StopPropagation:e.values?M(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(e=>(this._pending=O.array(e.data),e=>e.touch(this)))}:n.request(e.url,e.format).then(e=>M(this,t,O.array(e.data)))}}),P.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},O.inherits(P,C.Transform,{transform(e,t){const i=e.fields,o=e.index,s=e.values,l=null==e.default?null:e.default,r=e.modified(),c=i.length;let n=r?t.SOURCE:t.ADD,a=t,u=e.as,d,f,p;return d=s?(f=s.length,1<c&&!u&&O.error('Multi-field lookup requires explicit "as" parameter.'),u&&u.length!==c*f&&O.error('The "as" parameter has too few output field names.'),u=u||s.map(O.accessorName),function(e){for(var t,r,n=0,a=0;n<c;++n)if(null==(r=o.get(i[n](e))))for(t=0;t<f;++t,++a)e[u[a]]=l;else for(t=0;t<f;++t,++a)e[u[a]]=s[t](r)}):(u||O.error("Missing output field names."),function(e){for(var t,r=0;r<c;++r)t=o.get(i[r](e)),e[u[r]]=null==t?l:t}),r?a=t.reflow(!0):(p=i.some(e=>t.modified(e.fields)),n|=p?t.MOD:0),t.visit(n,d),a.modifies(u)}}),O.inherits(le,C.Operator),O.inherits(ue,C.Operator),O.inherits(fe,C.Transform,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),pe.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:t,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},O.inherits(pe,n,{_transform:n.prototype.transform,transform(e,t){return this._transform(function(e,t){const a=e.field,i=e.value,r=("count"===e.op?"__count__":e.op)||"sum",o=O.accessorFields(a).concat(O.accessorFields(i)),n=function(t,e,r){const n={},a=[];return r.visit(r.SOURCE,e=>{e=t(e);n[e]||(n[e]=1,a.push(e))}),a.sort(O.ascending),e?a.slice(0,e):a}(a,e.limit||0,t);t.changed()&&e.set("__pivot__",null,null,!0);return{key:e.key,groupby:e.groupby,ops:n.map(()=>r),fields:n.map(e=>{return t=e,r=a,n=i,e=o,O.accessor(e=>r(e)===t?n(e):NaN,e,t+"");var t,r,n}),as:n.map(e=>e+""),modified:e.modified.bind(e)}}(e,t),t)}}),O.inherits(he,f,{transform(e,t){const r=e.subflow,n=e.field,a=e=>this.subflow(C.tupleid(e),r,t,e);return(e.modified("field")||n&&t.modified(O.accessorFields(n)))&&O.error("PreFacet does not support field modification."),this.initTargets(),n?(t.visit(t.MOD,e=>{const t=a(e);n(e).forEach(e=>t.mod(e))}),t.visit(t.ADD,e=>{const t=a(e);n(e).forEach(e=>t.add(C.ingest(e)))}),t.visit(t.REM,e=>{const t=a(e);n(e).forEach(e=>t.rem(e))})):(t.visit(t.MOD,e=>a(e).mod(e)),t.visit(t.ADD,e=>a(e).add(e)),t.visit(t.REM,e=>a(e).rem(e))),t.clean()&&t.runAfter(()=>this.clean()),t}}),ge.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},O.inherits(ge,C.Transform,{transform(e,t){const r=t.fork(t.NO_SOURCE),o=e.fields,s=z(e.fields,e.as||[]),n=o?(e,t)=>{var r=e,n=t,a=o,i=s;for(let e=0,t=a.length;e<t;++e)n[i[e]]=a[e](r);return n}:C.rederive;let a;return a=this.value||(t=t.addAll(),this.value={}),t.visit(t.REM,e=>{e=C.tupleid(e);r.rem.push(a[e]),a[e]=null}),t.visit(t.ADD,e=>{var t=n(e,C.ingest({}));a[C.tupleid(e)]=t,r.add.push(t)}),t.visit(t.MOD,e=>{r.mod.push(n(e,a[C.tupleid(e)]))}),r}}),O.inherits(me,C.Transform,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}}),_e.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};function ye(e){C.Transform.call(this,null,e)}function Te(e){C.Transform.call(this,[],e),this.count=0}function be(e){C.Transform.call(this,null,e)}function ve(e){C.Transform.call(this,null,e),this.modified(!0)}function Ee(e){C.Transform.call(this,null,e)}O.inherits(_e,C.Transform,{transform(e,t){const r=t.fork(t.NO_SOURCE|t.NO_FIELDS),a=e.as||["prob","value"];if(!this.value||e.modified()||t.changed()){const n=t.materialize(t.SOURCE).source,i=T(n,e.groupby,e.field),o=(e.groupby||[]).map(O.accessorName),s=[],l=e.step||.01,c=e.probs||ae(l/2,1-1e-14,l),u=c.length;i.forEach(t=>{var r=_.quantiles(t,c);for(let e=0;e<u;++e){var n={};for(let e=0;e<o.length;++e)n[o[e]]=t.dims[e];n[a[0]]=c[e],n[a[1]]=r[e],s.push(C.ingest(n))}}),this.value&&(r.rem=this.value),this.value=r.add=r.source=s}else r.source=this.value;return r}}),O.inherits(ye,C.Transform,{transform(e,t){let n,a;return a=this.value||(n=t=t.addAll(),this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,e=>{e=C.tupleid(e);n.rem.push(a[e]),a[e]=null}),t.visit(t.ADD,e=>{var t=C.derive(e);a[C.tupleid(e)]=t,n.add.push(t)}),t.visit(t.MOD,e=>{var t=a[C.tupleid(e)];for(const r in e)t[r]=e[r],n.modifies(r);n.mod.push(t)})),n}}),Te.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},O.inherits(Te,C.Transform,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.modified("size"),a=e.size,i=this.value.reduce((e,t)=>(e[C.tupleid(t)]=1,e),{});let o=this.value,s=this.count,l=0;function c(e){var t,r;o.length<a?o.push(e):(r=~~((s+1)*_.random()))<o.length&&r>=l&&(t=o[r],i[C.tupleid(t)]&&n.rem.push(t),o[r]=e),++s}if(t.rem.length&&(t.visit(t.REM,e=>{var t=C.tupleid(e);i[t]&&(i[t]=-1,n.rem.push(e)),--s}),o=o.filter(e=>-1!==i[C.tupleid(e)])),(t.rem.length||r)&&o.length<a&&t.source&&(l=s=o.length,t.visit(t.SOURCE,e=>{i[C.tupleid(e)]||c(e)}),l=-1),r&&o.length>a){var u=o.length-a;for(let e=0;e<u;++e)i[C.tupleid(o[e])]=-1,n.rem.push(o[e]);o=o.slice(u)}return t.mod.length&&t.visit(t.MOD,e=>{i[C.tupleid(e)]&&n.mod.push(e)}),t.add.length&&t.visit(t.ADD,c),(t.add.length||l<0)&&(n.add=o.filter(e=>!i[C.tupleid(e)])),this.count=s,this.value=n.source=o,n}}),be.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},O.inherits(be,C.Transform,{transform(e,t){if(!this.value||e.modified()){const r=t.materialize().fork(t.MOD),n=e.as||"data";return r.rem=this.value?t.rem.concat(this.value):t.rem,this.value=ae(e.start,e.stop,e.step||1).map(e=>{var t={};return t[n]=e,C.ingest(t)}),r.add=t.add.concat(this.value),r}}}),O.inherits(ve,C.Transform,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});const De=["unit0","unit1"];function Se(e){C.Transform.call(this,O.fastmap(),e)}function Ae(e){C.Transform.call(this,null,e)}Ee.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:h.TIME_UNITS,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:De}]},O.inherits(Ee,C.Transform,{transform(e,t){const a=e.field,i=!1!==e.interval,r="utc"===e.timezone,o=this._floor(e,t),s=(r?h.utcInterval:h.timeInterval)(o.unit).offset,n=e.as||De,l=n[0],c=n[1],u=o.step;let d=o.start||1/0,f=o.stop||-1/0,p=t.ADD;return(e.modified()||t.changed(t.REM)||t.modified(O.accessorFields(a)))&&(t=t.reflow(!0),p=t.SOURCE,d=1/0,f=-1/0),t.visit(p,e=>{var t=a(e);let r,n;null==t?(e[l]=null,i&&(e[c]=null)):(e[l]=r=n=o(t),i&&(e[c]=n=s(r,u)),r<d&&(d=r),n>f&&(f=n))}),o.start=d,o.stop=f,t.modifies(i?n:l)},_floor(e,t){var r="utc"===e.timezone,{units:t,step:e}=e.units?{units:e.units,step:e.step||1}:h.timeBin({extent:e.extent||O.extent(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),t=h.timeUnits(t),n=this.value||{},r=(r?h.utcFloor:h.timeFloor)(t,e);return r.unit=O.peek(t),r.units=t,r.step=e,r.start=n.start,r.stop=n.stop,this.value=r}}),O.inherits(Se,C.Transform,{transform(e,t){const r=t.dataflow,n=e.field,a=this.value,i=e=>a.set(n(e),e);let o=!0;return e.modified("field")||t.modified(n.fields)?(a.clear(),t.visit(t.SOURCE,i)):t.changed()?(t.visit(t.REM,e=>a.delete(n(e))),t.visit(t.ADD,i)):o=!1,this.modified(o),a.empty>r.cleanThreshold&&r.runAfter(a.clean),t.fork()}}),O.inherits(Ae,C.Transform,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(C.stableCompare(e.sort)):t.source).map(e.field))}});const x={row_number:function(){return{next:e=>e.index+1}},rank:function(){let n;return{init:()=>n=1,next:e=>{var t=e.index,r=e.data;return t&&e.compare(r[t-1],r[t])?n=t+1:n}}},dense_rank:function(){let n;return{init:()=>n=1,next:e=>{var t=e.index,r=e.data;return t&&e.compare(r[t-1],r[t])?++n:n}}},percent_rank:function(){const e=x.rank(),t=e.next;return{init:e.init,next:e=>(t(e)-1)/(e.data.length-1)}},cume_dist:function(){let a;return{init:()=>a=0,next:e=>{var t=e.data,r=e.compare;let n=e.index;if(a<n){for(;n+1<t.length&&!r(t[n],t[n+1]);)++n;a=n}return(1+a)/t.length}}},ntile:function(e,t){0<(t=+t)||O.error("ntile num must be greater than zero.");const r=x.cume_dist(),n=r.next;return{init:r.init,next:e=>Math.ceil(t*n(e))}},lag:function(r,n){return n=+n||1,{next:e=>{var t=e.index-n;return 0<=t?r(e.data[t]):null}}},lead:function(r,n){return n=+n||1,{next:e=>{var t=e.index+n,e=e.data;return t<e.length?r(e[t]):null}}},first_value:function(t){return{next:e=>t(e.data[e.i0])}},last_value:function(t){return{next:e=>t(e.data[e.i1-1])}},nth_value:function(r,n){return 0<(n=+n)||O.error("nth_value nth must be greater than zero."),{next:e=>{var t=e.i0+(n-1);return t<e.i1?r(e.data[t]):null}}},prev_value:function(t){let r;return{init:()=>r=null,next:e=>{e=t(e.data[e.index]);return null!=e?r=e:r}}},next_value:function(r){let n,a;return{init:()=>(n=null,a=-1),next:e=>{var t=e.data;return e.index<=a?n:n=(a=function(e,t,r){for(var n=t.length;r<n;++r)if(null!=e(t[r]))return r;return-1}(r,t,e.index))<0?(a=t.length,null):r(t[a])}}}};r=Object.keys(x);function Oe(e){const t=O.array(e.ops),o=O.array(e.fields),s=O.array(e.params),l=O.array(e.aggregate_params),c=O.array(e.as),u=this.outputs=[],d=this.windows=[],r={},f={},p=[],h=[];let g=!0;function m(e){O.array(O.accessorFields(e)).forEach(e=>r[e]=1)}m(e.sort),t.forEach((t,r)=>{var n=o[r],e=s[r],a=l[r]||null,i=O.accessorName(n),r=L(t,i,c[r]);if(m(n),u.push(r),O.hasOwnProperty(x,t))d.push(function(e,t,r,n){const a=x[e](t,r);return{init:a.init||O.zero,update:function(e,t){t[n]=a.next(e)}}}(t,n,e,r));else if(null==n&&"count"!==t&&O.error("Null aggregate field specified."),"count"===t)p.push(r);else{g=!1;let e=f[i];e||((e=f[i]=[]).field=n,h.push(e)),e.push(F(t,a,r))}}),(p.length||h.length)&&(this.cell=function(e,n,a){e=e.map(e=>V(e,e.field));const i={num:0,agg:null,store:!1,count:n};if(!a)for(var r=e.length,o=i.agg=Array(r),t=0;t<r;++t)o[t]=new e[t](i);{var s;i.store&&(s=i.data=new y)}return i.add=function(t){if(i.num+=1,!a){s&&s.add(t);for(let e=0;e<r;++e)o[e].add(o[e].get(t),t)}},i.rem=function(t){if(--i.num,!a){s&&s.rem(t);for(let e=0;e<r;++e)o[e].rem(o[e].get(t),t)}},i.set=function(e){let t,r;for(s&&s.values(),t=0,r=n.length;t<r;++t)e[n[t]]=i.num;if(!a)for(t=0,r=o.length;t<r;++t)o[t].set(e)},i.init=function(){i.num=0,s&&s.reset();for(let e=0;e<r;++e)o[e].init()},i}(h,p,g)),this.inputs=Object.keys(r)}var Ce=Oe.prototype;function ke(e){C.Transform.call(this,{},e),this._mlen=0,this._mods=[]}Ce.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()},Ce.update=function(e,t){var r=this.cell,n=this.windows,a=e.data,i=n&&n.length;let o;if(r){for(o=e.p0;o<e.i0;++o)r.rem(a[o]);for(o=e.p1;o<e.i1;++o)r.add(a[o]);r.set(t)}for(o=0;o<i;++o)n[o].update(e,t)},ke.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:r.concat(t)},{name:"params",type:"number",null:!0,array:!0},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},O.inherits(ke,C.Transform,{transform(r,e){this.stamp=e.stamp;const t=r.modified(),n=C.stableCompare(r.sort),a=k(r.groupby),i=e=>this.group(a(e));let o=this.state;o&&!t||(o=this.state=new Oe(r)),t||e.modified(o.inputs)?(this.value={},e.visit(e.SOURCE,e=>i(e).add(e))):(e.visit(e.REM,e=>i(e).remove(e)),e.visit(e.ADD,e=>i(e).add(e)));for(let e=0,t=this._mlen;e<t;++e){_=m=g=h=p=f=d=u=c=l=s=void 0;var s=this._mods[e],l=o,c=n,u=r,d=u.sort,f=d&&!u.ignorePeers,p=u.frame||[null,0],h=s.data(c),g=h.length,m=f?X(d):null,_={i0:0,i1:0,p0:0,p1:0,index:0,data:h,compare:d||O.constant(-1)};l.init();for(let e=0;e<g;++e){{y=void 0;T=void 0;b=void 0;v=void 0;var y=_;var T=p;var b=e;var v=g;y.p0=y.i0,y.p1=y.i1,y.i0=null==T[0]?0:Math.max(0,b-Math.abs(T[0])),y.i1=null==T[1]?v:Math.min(v,b+Math.abs(T[1])+1),y.index=b}if(f){v=void 0;T=void 0;y=void 0;b=void 0;E=void 0;S=void 0;A=void 0;v=_;T=m;var y=v.i0,b=v.i1-1,E=v.compare,S=v.data,A=S.length-1;0<y&&!E(S[y],S[y-1])&&(v.i0=T.left(S,S[y]));b<A&&!E(S[b],S[1+b])&&(v.i1=T.right(S,S[b]))}l.update(_,h[e])}}return this._mlen=0,this._mods=[],e.reflow(t).modifies(o.outputs)},group(e){let t=this.value[e];return t||((t=this.value[e]=W(C.tupleid)).stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}}),e.aggregate=n,e.bin=a,e.collect=i,e.compare=q,e.countpattern=o,e.cross=s,e.density=l,e.dotbin=c,e.expression=K,e.extent=u,e.facet=f,e.field=J,e.filter=p,e.flatten=g,e.fold=m,e.formula=b,e.generate=Q,e.impute=w,e.joinaggregate=R,e.kde=I,e.key=ie,e.load=se,e.lookup=P,e.multiextent=le,e.multivalues=ue,e.params=fe,e.pivot=pe,e.prefacet=he,e.project=ge,e.proxy=me,e.quantile=_e,e.relay=ye,e.sample=Te,e.sequence=be,e.sieve=ve,e.subflow=d,e.timeunit=Ee,e.tupleindex=Se,e.values=Ae,e.window=ke}}return uu.exports}var hu,gu={exports:{}},mu={exports:{}},_u={exports:{}};function yu(){var e,t;return hu||(hu=1,t=()=>"undefined"!=typeof Image?Image:null,(e=_u.exports).canvas=r,e.domCanvas=r,e.image=t),_u.exports;function r(e,t){if("undefined"!=typeof document&&document.createElement){var r=document.createElement("canvas");if(r&&r.getContext)return r.width=e,r.height=t,r}return null}}var Tu,bu,vu,Eu={exports:{}};function Su(){if(!Tu){Tu=1;{var e=Eu.exports;var l=jo();var L=au();function F(e,t,r){t=e-t+2*r;return e?0<t?t:1:0}var U="linear";const S="log";var B="sqrt",j="symlog";const A="time",O="utc";var t="sequential",H="diverging";const pa="quantile";var G="quantize";const ha="threshold";var V="bin-ordinal";const C="continuous",ga="discrete",ma="discretizing",k="interpolating",_a="temporal";function W(e,t){return null==e||null==t?NaN:e<t?-1:t<e?1:t<=e?0:NaN}function q(r){let i,o,a;function s(e,t,r=0,n=e.length){if(r<n){if(0!==i(t,t))return n;do{var a=r+n>>>1;o(e[a],t)<0?r=1+a:n=a}while(r<n)}return r}return a=2!==r.length?(i=W,o=(e,t)=>W(r(e),t),(e,t)=>r(e)-t):(i=r===W||r===function(e,t){return null==e||null==t?NaN:t<e?-1:e<t?1:e<=t?0:NaN}?r:$,o=r),{left:s,center:function(e,t,r=0,n=e.length){return n=s(e,t,r,n-1),r<n&&a(e[n-1],t)>-a(e[n],t)?n-1:n},right:function(e,t,r=0,n=e.length){if(r<n){if(0!==i(t,t))return n;do{var a=r+n>>>1;o(e[a],t)<=0?r=1+a:n=a}while(r<n)}return r}}}function $(){return 0}function z(e){return null===e?NaN:+e}const w=q(W).right;q(z).center;class ya extends Map{constructor(e,t=function(e){return null!==e&&"object"==typeof e?e.valueOf():e}){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[t,r]of e)this.set(t,r)}get(e){return super.get(K(this,e))}has(e){return super.has(K(this,e))}set(e,t){return super.set(function({_intern:e,_key:t},r){t=t(r);return e.has(t)?e.get(t):(e.set(t,r),r)}(this,e),t)}delete(e){return super.delete(function({_intern:e,_key:t},r){t=t(r);e.has(t)&&(r=e.get(t),e.delete(t));return r}(this,e))}}function K({_intern:e,_key:t},r){t=t(r);return e.has(t)?e.get(t):r}const Ta=Math.sqrt(50),ba=Math.sqrt(10),va=Math.sqrt(2);function Y(e,t,r){var n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),n=n/Math.pow(10,a),n=n>=Ta?10:n>=ba?5:n>=va?2:1;let i,o,s;return a<0?(s=Math.pow(10,-a)/n,i=Math.round(e*s),o=Math.round(t*s),i/s<e&&++i,o/s>t&&--o,s=-s):(s=Math.pow(10,a)*n,i=Math.round(e/s),o=Math.round(t/s),i*s<e&&++i,o*s>t&&--o),o<i&&.5<=r&&r<2?Y(e,t,2*r):[i,o,s]}function J(e,t,r){if(!(0<(r=+r)))return[];if((e=+e)===(t=+t))return[e];var n=t<e,[a,i,o]=n?Y(t,e,r):Y(e,t,r);if(!(a<=i))return[];var s=i-a+1,l=new Array(s);if(n)if(o<0)for(let e=0;e<s;++e)l[e]=(i-e)/-o;else for(let e=0;e<s;++e)l[e]=(i-e)*o;else if(o<0)for(let e=0;e<s;++e)l[e]=(a+e)/-o;else for(let e=0;e<s;++e)l[e]=(a+e)*o;return l}function Z(e,t,r){return Y(e=+e,t=+t,r=+r)[2]}function Q(e,t,r){r=+r;var n=(t=+t)<(e=+e),e=n?Z(t,e,r):Z(e,t,r);return(n?-1:1)*(e<0?1/-e:e)}function c(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function r(e,t){switch(arguments.length){case 0:break;case 1:"function"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"==typeof t?this.interpolator(t):this.range(t)}return this}const Ea=Symbol("implicit");function X(){var r=new ya,n=[],a=[],i=Ea;function o(e){let t=r.get(e);if(void 0===t){if(i!==Ea)return i;r.set(e,t=n.push(e)-1)}return a[t%a.length]}return o.domain=function(e){if(!arguments.length)return n.slice();n=[],r=new ya;for(const t of e)r.has(t)||r.set(t,n.push(t)-1);return o},o.range=function(e){return arguments.length?(a=Array.from(e),o):a.slice()},o.unknown=function(e){return arguments.length?(i=e,o):i},o.copy=function(){return X(n,a).unknown(i)},c.apply(o,arguments),o}function ee(e,t,r){(e.prototype=t.prototype=r).constructor=e}function te(e,t){var r,n=Object.create(e.prototype);for(r in t)n[r]=t[r];return n}function u(){}var n="\\s*([+-]?\\d+)\\s*",a="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",i="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",re=/^#([0-9a-f]{3,8})$/,ne=new RegExp(`^rgb\\(${n},${n},${n}\\)$`),ae=new RegExp(`^rgb\\(${i},${i},${i}\\)$`),ie=new RegExp(`^rgba\\(${n},${n},${n},${a}\\)$`),oe=new RegExp(`^rgba\\(${i},${i},${i},${a}\\)$`),se=new RegExp(`^hsl\\(${a},${i},${i}\\)$`),le=new RegExp(`^hsla\\(${a},${i},${i},${a}\\)$`),ce={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function ue(){return this.rgb().formatHex()}function de(){return this.rgb().formatRgb()}function fe(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=re.exec(e))?(r=t[1].length,t=parseInt(t[1],16),6===r?pe(t):3===r?new d(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===r?he(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===r?he(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=ne.exec(e))?new d(t[1],t[2],t[3],1):(t=ae.exec(e))?new d(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=ie.exec(e))?he(t[1],t[2],t[3],t[4]):(t=oe.exec(e))?he(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=se.exec(e))?ve(t[1],t[2]/100,t[3]/100,1):(t=le.exec(e))?ve(t[1],t[2]/100,t[3]/100,t[4]):ce.hasOwnProperty(e)?pe(ce[e]):"transparent"===e?new d(NaN,NaN,NaN,0):null}function pe(e){return new d(e>>16&255,e>>8&255,255&e,1)}function he(e,t,r,n){return new d(e=n<=0?t=r=NaN:e,t,r,n)}function ge(e){return(e=e instanceof u?e:fe(e))?new d((e=e.rgb()).r,e.g,e.b,e.opacity):new d}function me(e,t,r,n){return 1===arguments.length?ge(e):new d(e,t,r,null==n?1:n)}function d(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}function _e(){return"#"+be(this.r)+be(this.g)+be(this.b)}function ye(){var e=Te(this.opacity);return(1===e?"rgb(":"rgba(")+o(this.r)+`, ${o(this.g)}, `+o(this.b)+(1===e?")":`, ${e})`)}function Te(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function o(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function be(e){return((e=o(e))<16?"0":"")+e.toString(16)}function ve(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||1<=r?e=t=NaN:t<=0&&(e=NaN),new f(e,t,r,n)}function Ee(e){var t,r,n,a,i,o,s,l;return e instanceof f?new f(e.h,e.s,e.l,e.opacity):(e=e instanceof u?e:fe(e))?e instanceof f?e:(t=(e=e.rgb()).r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),o=NaN,l=((i=Math.max(t,r,n))+a)/2,(s=i-a)?(o=t===i?(r-n)/s+6*(r<n):r===i?(n-t)/s+2:(t-r)/s+4,s/=l<.5?i+a:2-i-a,o*=60):s=0<l&&l<1?0:o,new f(o,s,l,e.opacity)):new f}function Se(e,t,r,n){return 1===arguments.length?Ee(e):new f(e,t,r,null==n?1:n)}function f(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}function Ae(e){return(e=(e||0)%360)<0?e+360:e}function Oe(e){return Math.max(0,Math.min(1,e||0))}function Ce(e,t,r){return 255*(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)}ee(u,fe,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:ue,formatHex:ue,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Ee(this).formatHsl()},formatRgb:de,toString:de}),ee(d,me,te(u,{brighter(e){return e=null==e?1/.7:Math.pow(1/.7,e),new d(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new d(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new d(o(this.r),o(this.g),o(this.b),Te(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:_e,formatHex:_e,formatHex8:function(){return"#"+be(this.r)+be(this.g)+be(this.b)+be(255*(isNaN(this.opacity)?1:this.opacity))},formatRgb:ye,toString:ye})),ee(f,Se,te(u,{brighter(e){return e=null==e?1/.7:Math.pow(1/.7,e),new f(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new f(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,t=r+(r<.5?r:1-r)*t,r=2*r-t;return new d(Ce(240<=e?e-240:120+e,r,t),Ce(e,r,t),Ce(e<120?240+e:e-120,r,t),this.opacity)},clamp(){return new f(Ae(this.h),Oe(this.s),Oe(this.l),Te(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){var e=Te(this.opacity);return(1===e?"hsl(":"hsla(")+Ae(this.h)+`, ${100*Oe(this.s)}%, ${100*Oe(this.l)}%`+(1===e?")":`, ${e})`)}}));const Sa=Math.PI/180,Aa=180/Math.PI,Oa=.96422,Ca=1,ka=.82521,wa=4/29,Ra=6/29,Ia=3*Ra*Ra,Ma=Ra*Ra*Ra;function ke(e){var t,r,n,a,i,o;return e instanceof s?new s(e.l,e.a,e.b,e.opacity):e instanceof p?De(e):(a=Re((.2225045*(t=Pe((e=e instanceof d?e:ge(e)).r))+.7168786*(r=Pe(e.g))+.0606169*(n=Pe(e.b)))/Ca),t===r&&r===n?i=o=a:(i=Re((.4360747*t+.3850649*r+.1430804*n)/Oa),o=Re((.0139322*t+.0971045*r+.7141733*n)/ka)),new s(116*a-16,500*(i-a),200*(a-o),e.opacity))}function we(e,t,r,n){return 1===arguments.length?ke(e):new s(e,t,r,null==n?1:n)}function s(e,t,r,n){this.l=+e,this.a=+t,this.b=+r,this.opacity=+n}function Re(e){return e>Ma?Math.pow(e,1/3):e/Ia+wa}function Ie(e){return e>Ra?e*e*e:Ia*(e-wa)}function Me(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Pe(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Ne(e,t,r,n){return 1===arguments.length?(a=e)instanceof p?new p(a.h,a.c,a.l,a.opacity):0===(a=a instanceof s?a:ke(a)).a&&0===a.b?new p(NaN,0<a.l&&a.l<100?0:NaN,a.l,a.opacity):new p((i=Math.atan2(a.b,a.a)*Aa)<0?360+i:i,Math.sqrt(a.a*a.a+a.b*a.b),a.l,a.opacity):new p(e,t,r,null==n?1:n);var a,i}function p(e,t,r,n){this.h=+e,this.c=+t,this.l=+r,this.opacity=+n}function De(e){var t;return isNaN(e.h)?new s(e.l,0,0,e.opacity):(t=e.h*Sa,new s(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity))}ee(s,we,te(u,{brighter(e){return new s(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker(e){return new s(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,r=isNaN(this.b)?e:e-this.b/200;return new d(Me(3.1338561*(t=Oa*Ie(t))-1.6168667*(e=Ca*Ie(e))-.4906146*(r=ka*Ie(r))),Me(-.9787684*t+1.9161415*e+.033454*r),Me(.0719453*t-.2289914*e+1.4052427*r),this.opacity)}})),ee(p,Ne,te(u,{brighter(e){return new p(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker(e){return new p(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb(){return De(this).rgb()}}));var xe=-.29227,Le=-.90649,Fe=1.97294,Ue=Fe*Le,Be=1.78277*Fe,je=1.78277*xe- -.14861*Le;function He(e,t,r,n){return 1===arguments.length?(a=e)instanceof Ge?new Ge(a.h,a.s,a.l,a.opacity):(i=(a=a instanceof d?a:ge(a)).r/255,o=a.g/255,l=a.b/255,l=(Fe*(o-(i=(je*l+Ue*i-Be*o)/(je+Ue-Be)))-xe*(o=l-i))/Le,new Ge((l=(s=Math.sqrt(l*l+o*o)/(Fe*i*(1-i)))?Math.atan2(l,o)*Aa-120:NaN)<0?l+360:l,s,i,a.opacity)):new Ge(e,t,r,null==n?1:n);var a,i,o,s,l}function Ge(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}function Ve(e,t,r,n,a){var i=e*e,o=i*e;return((1-3*e+3*i-o)*t+(4-6*i+3*o)*r+(1+3*e+3*i-3*o)*n+o*a)/6}function We(o){var s=o.length-1;return function(e){var t=e<=0?e=0:1<=e?s-(e=1):Math.floor(e*s),r=o[t],n=o[t+1],a=0<t?o[t-1]:2*r-n,i=t<s-1?o[t+2]:2*n-r;return Ve((e-t/s)*s,a,r,n,i)}}function qe(o){var s=o.length;return function(e){var t=Math.floor(((e%=1)<0?++e:e)*s),r=o[(t+s-1)%s],n=o[t%s],a=o[(t+1)%s],i=o[(t+2)%s];return Ve((e-t/s)*s,r,n,a,i)}}ee(Ge,He,te(u,{brighter(e){return e=null==e?1/.7:Math.pow(1/.7,e),new Ge(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new Ge(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*Sa,t=+this.l,r=isNaN(this.s)?0:this.s*t*(1-t),n=Math.cos(e),e=Math.sin(e);return new d(255*(t+r*(-.14861*n+1.78277*e)),255*(t+r*(xe*n+Le*e)),255*(t+Fe*n*r),this.opacity)}}));var $e=e=>()=>e;function ze(t,r){return function(e){return t+e*r}}function Ke(e,t){var r=t-e;return r?ze(e,180<r||r<-180?r-360*Math.round(r/360):r):$e(isNaN(e)?t:e)}function Ye(i){return 1==(i=+i)?h:function(e,t){return t-e?(r=e,n=t,a=i,r=Math.pow(r,a),n=Math.pow(n,a)-r,a=1/a,function(e){return Math.pow(r+e*n,a)}):$e(isNaN(e)?t:e);var r,n,a}}function h(e,t){var r=t-e;return r?ze(e,r):$e(isNaN(e)?t:e)}var Je=function e(t){var o=Ye(t);function r(t,e){var r=o((t=me(t)).r,(e=me(e)).r),n=o(t.g,e.g),a=o(t.b,e.b),i=h(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=n(e),t.b=a(e),t.opacity=i(e),t+""}}return r.gamma=e,r}(1);function Ze(s){return function(e){for(var t,r=e.length,n=new Array(r),a=new Array(r),i=new Array(r),o=0;o<r;++o)t=me(e[o]),n[o]=t.r||0,a[o]=t.g||0,i[o]=t.b||0;return n=s(n),a=s(a),i=s(i),t.opacity=1,function(e){return t.r=n(e),t.g=a(e),t.b=i(e),t+""}}}n=Ze(We),i=Ze(qe);function Qe(t,r){r=r||[];var n,a=t?Math.min(r.length,t.length):0,i=r.slice();return function(e){for(n=0;n<a;++n)i[n]=t[n]*(1-e)+r[n]*e;return i}}function Xe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function et(e,t){for(var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),o=0;o<n;++o)a[o]=ot(e[o],t[o]);for(;o<r;++o)i[o]=t[o];return function(e){for(o=0;o<n;++o)i[o]=a[o](e);return i}}function tt(t,r){var n=new Date;return t=+t,r=+r,function(e){return n.setTime(t*(1-e)+r*e),n}}function _(t,r){return t=+t,r=+r,function(e){return t*(1-e)+r*e}}function rt(e,t){var r,n={},a={};for(r in null!==e&&"object"==typeof e||(e={}),t=null!==t&&"object"==typeof t?t:{})r in e?n[r]=ot(e[r],t[r]):a[r]=t[r];return function(e){for(r in n)a[r]=n[r](e);return a}}var nt=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,at=new RegExp(nt.source,"g");function it(e,n){var t,r,a,i,o,s=nt.lastIndex=at.lastIndex=0,l=-1,c=[],u=[];for(e+="",n+="";(t=nt.exec(e))&&(r=at.exec(n));)(a=r.index)>s&&(a=n.slice(s,a),c[l]?c[l]+=a:c[++l]=a),(t=t[0])===(r=r[0])?c[l]?c[l]+=r:c[++l]=r:(c[++l]=null,u.push({i:l,x:_(t,r)})),s=at.lastIndex;return s<n.length&&(a=n.slice(s),c[l]?c[l]+=a:c[++l]=a),c.length<2?u[0]?(o=u[0].x,function(e){return o(e)+""}):(i=n,function(){return i}):(n=u.length,function(e){for(var t,r=0;r<n;++r)c[(t=u[r]).i]=t.x(e);return c.join("")})}function ot(e,t){var r=typeof t;return null==t||"boolean"==r?$e(t):("number"==r?_:"string"==r?(r=fe(t))?(t=r,Je):it:t instanceof fe?Je:t instanceof Date?tt:Xe(t)?Qe:Array.isArray(t)?et:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?rt:_)(e,t)}function st(t,r){return t=+t,r=+r,function(e){return Math.round(t*(1-e)+r*e)}}var lt,ct=180/Math.PI,ut={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function dt(e,t,r,n,a,i){var o,s,l;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(l=e*r+t*n)&&(r-=e*l,n-=t*l),(s=Math.sqrt(r*r+n*n))&&(r/=s,n/=s,l/=s),e*n<t*r&&(e=-e,t=-t,l=-l,o=-o),{translateX:a,translateY:i,rotate:Math.atan2(t,e)*ct,skewX:Math.atan(l)*ct,scaleX:o,scaleY:s}}function ft(f,p,h,g){function m(e){return e.length?e.pop()+" ":""}return function(e,t){var r,n,a,i,o,s,l,c,u=[],d=[];return e=f(e),t=f(t),a=e.translateX,i=e.translateY,l=t.translateX,s=t.translateY,o=u,n=d,a!==l||i!==s?(r=o.push("translate(",null,p,null,h),n.push({i:r-4,x:_(a,l)},{i:r-2,x:_(i,s)})):(l||s)&&o.push("translate("+l+p+s+h),n=e.rotate,a=t.rotate,r=u,i=d,n!==a?(180<n-a?a+=360:180<a-n&&(n+=360),i.push({i:r.push(m(r)+"rotate(",null,g)-2,x:_(n,a)})):a&&r.push(m(r)+"rotate("+a+g),o=e.skewX,l=t.skewX,s=u,i=d,o!==l?i.push({i:s.push(m(s)+"skewX(",null,g)-2,x:_(o,l)}):l&&s.push(m(s)+"skewX("+l+g),n=e.scaleX,a=e.scaleY,i=t.scaleX,o=t.scaleY,s=u,l=d,n!==i||a!==o?(c=s.push(m(s)+"scale(",null,",",null,")"),l.push({i:c-4,x:_(n,i)},{i:c-2,x:_(a,o)})):1===i&&1===o||s.push(m(s)+"scale("+i+","+o+")"),e=t=null,function(e){for(var t,r=-1,n=d.length;++r<n;)u[(t=d[r]).i]=t.x(e);return u.join("")}}}var a=ft(function(e){return(e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"")).isIdentity?ut:dt(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),pt=ft(function(e){return null!=e&&((lt=lt||document.createElementNS("http://www.w3.org/2000/svg","g")).setAttribute("transform",e),e=lt.transform.baseVal.consolidate())?dt((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):ut},", ",")",")");function ht(e){return((e=Math.exp(e))+1/e)/2}var gt=function r(d,f,p){function e(e,t){var n,a,i,o=e[0],s=e[1],l=e[2],e=t[0],r=t[1],t=t[2],c=e-o,u=r-s,e=c*c+u*u;return(t=e<1e-12?(i=Math.log(t/l)/d,function(e){return[o+e*c,s+e*u,l*Math.exp(d*e*i)]}):(n=Math.sqrt(e),r=(t*t-l*l+p*e)/(2*l*f*n),e=(t*t-l*l-p*e)/(2*t*f*n),a=Math.log(Math.sqrt(r*r+1)-r),i=(Math.log(Math.sqrt(e*e+1)-e)-a)/d,function(e){var e=e*i,t=ht(a),r=l/(f*n)*(t*(r=d*e+a,((r=Math.exp(2*r))-1)/(r+1))-(r=a,((r=Math.exp(a))-1/r)/2));return[o+r*c,s+r*u,l*t/ht(d*e+a)]})).duration=1e3*i*d/Math.SQRT2,t}return e.rho=function(e){var e=Math.max(.001,+e),t=e*e;return r(e,t,t*t)},e}(Math.SQRT2,2,4);function mt(o){return function(t,e){var r=o((t=Se(t)).h,(e=Se(e)).h),n=h(t.s,e.s),a=h(t.l,e.l),i=h(t.opacity,e.opacity);return function(e){return t.h=r(e),t.s=n(e),t.l=a(e),t.opacity=i(e),t+""}}}var _t=mt(Ke),yt=mt(h);function Tt(o){return function(t,e){var r=o((t=Ne(t)).h,(e=Ne(e)).h),n=h(t.c,e.c),a=h(t.l,e.l),i=h(t.opacity,e.opacity);return function(e){return t.h=r(e),t.c=n(e),t.l=a(e),t.opacity=i(e),t+""}}}var bt=Tt(Ke),vt=Tt(h);function Et(s){return function e(o){function t(t,e){var r=s((t=He(t)).h,(e=He(e)).h),n=h(t.s,e.s),a=h(t.l,e.l),i=h(t.opacity,e.opacity);return function(e){return t.h=r(e),t.s=n(e),t.l=a(Math.pow(e,o)),t.opacity=i(e),t+""}}return o=+o,t.gamma=e,t}(1)}var St=Et(Ke),At=Et(h);function Ot(e,t){void 0===t&&(t=e,e=ot);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(e){var t=Math.max(0,Math.min(n-1,Math.floor(e*=n)));return i[t](e-t)}}var Ct=Object.freeze({__proto__:null,interpolate:ot,interpolateArray:function(e,t){return(Xe(t)?Qe:et)(e,t)},interpolateBasis:We,interpolateBasisClosed:qe,interpolateCubehelix:St,interpolateCubehelixLong:At,interpolateDate:tt,interpolateDiscrete:function(t){var r=t.length;return function(e){return t[Math.max(0,Math.min(r-1,Math.floor(e*r)))]}},interpolateHcl:bt,interpolateHclLong:vt,interpolateHsl:_t,interpolateHslLong:yt,interpolateHue:function(e,t){var r=Ke(+e,+t);return function(e){e=r(e);return e-360*Math.floor(e/360)}},interpolateLab:function(t,e){var r=h((t=we(t)).l,(e=we(e)).l),n=h(t.a,e.a),a=h(t.b,e.b),i=h(t.opacity,e.opacity);return function(e){return t.l=r(e),t.a=n(e),t.b=a(e),t.opacity=i(e),t+""}},interpolateNumber:_,interpolateNumberArray:Qe,interpolateObject:rt,interpolateRgb:Je,interpolateRgbBasis:n,interpolateRgbBasisClosed:i,interpolateRound:st,interpolateString:it,interpolateTransformCss:a,interpolateTransformSvg:pt,interpolateZoom:gt,piecewise:Ot,quantize:function(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e(n/(t-1));return r}});function kt(e){return+e}var wt=[0,1];function g(e){return e}function Rt(t,r){return(r-=t=+t)?function(e){return(e-t)/r}:(e=isNaN(r)?NaN:.5,function(){return e});var e}function It(e,t,r){var n=e[0],e=e[1],a=t[0],t=t[1],a=e<n?(n=Rt(e,n),r(t,a)):(n=Rt(n,e),r(a,t));return function(e){return a(n(e))}}function Mt(r,e,t){var n=Math.min(r.length,e.length)-1,a=new Array(n),i=new Array(n),o=-1;for(r[n]<r[0]&&(r=r.slice().reverse(),e=e.slice().reverse());++o<n;)a[o]=Rt(r[o],r[o+1]),i[o]=t(e[o],e[o+1]);return function(e){var t=w(r,e,1,n)-1;return i[t](a[t](e))}}function Pt(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Nt(){var r,n,t,a,i,o,s=wt,l=wt,c=ot,u=g;function d(){var t,r,e,n=Math.min(s.length,l.length);return u!==g&&(t=s[0],(r=s[n-1])<t&&(e=t,t=r,r=e),u=function(e){return Math.max(t,Math.min(r,e))}),a=2<n?Mt:It,i=o=null,f}function f(e){return null==e||isNaN(e=+e)?t:(i=i||a(s.map(r),l,c))(r(u(e)))}return f.invert=function(e){return u(n((o=o||a(l,s.map(r),_))(e)))},f.domain=function(e){return arguments.length?(s=Array.from(e,kt),d()):s.slice()},f.range=function(e){return arguments.length?(l=Array.from(e),d()):l.slice()},f.rangeRound=function(e){return l=Array.from(e),c=st,d()},f.clamp=function(e){return arguments.length?(u=!!e||g,d()):u!==g},f.interpolate=function(e){return arguments.length?(c=e,d()):c},f.unknown=function(e){return arguments.length?(t=e,f):t},function(e,t){return r=e,n=t,d()}}function Dt(){return Nt()(g,g)}function xt(e,t){var r;return(t=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0?null:[1<(r=e.slice(0,t)).length?r[0]+r.slice(2):r,+e.slice(t+1)]}function Lt(e){return(e=xt(Math.abs(e)))?e[1]:NaN}var Ft,Ut=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Bt(e){var t;if(t=Ut.exec(e))return new jt({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]});throw new Error("invalid format: "+e)}function jt(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function Ht(e,t){var r,t=xt(e,t);return t?(r=t[0],(t=t[1])<0?"0."+new Array(-t).join("0")+r:r.length>t+1?r.slice(0,t+1)+"."+r.slice(t+1):r+new Array(t-r.length+2).join("0")):e+""}Bt.prototype=jt.prototype,jt.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Gt={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return 1e21<=Math.abs(e=Math.round(e))?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Ht(100*e,t),r:Ht,s:function(e,t){var r,n,a=xt(e,t);return a?(r=a[0],(a=(a=a[1])-(Ft=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1)===(n=r.length)?r:n<a?r+new Array(a-n+1).join("0"):0<a?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+xt(e,Math.max(0,t+a-1))[0]):e+""},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Vt(e){return e}var Wt,qt,$t=Array.prototype.map,zt=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Kt(e){var t,s,l,E=void 0===e.grouping||void 0===e.thousands?Vt:(s=$t.call(e.grouping,Number),l=e.thousands+"",function(e,t){for(var r=e.length,n=[],a=0,i=s[0],o=0;0<r&&0<i&&(t<o+i+1&&(i=Math.max(1,t-o)),n.push(e.substring(r-=i,r+i)),!((o+=i+1)>t));)i=s[a=(a+1)%s.length];return n.reverse().join(l)}),n=void 0===e.currency?"":e.currency[0]+"",a=void 0===e.currency?"":e.currency[1]+"",S=void 0===e.decimal?".":e.decimal+"",A=void 0===e.numerals?Vt:(t=$t.call(e.numerals,String),function(e){return e.replace(/[0-9]/g,function(e){return t[+e]})}),i=void 0===e.percent?"%":e.percent+"",O=void 0===e.minus?"−":e.minus+"",C=void 0===e.nan?"NaN":e.nan+"";function o(e){var c=(e=Bt(e)).fill,u=e.align,d=e.sign,t=e.symbol,f=e.zero,p=e.width,h=e.comma,g=e.precision,m=e.trim,_=e.type,y=("n"===_?(h=!0,_="g"):Gt[_]||(void 0===g&&(g=12),m=!0,_="g"),(f||"0"===c&&"="===u)&&(f=!0,c="0",u="="),"$"===t?n:"#"===t&&/[boxX]/.test(_)?"0"+_.toLowerCase():""),T="$"===t?a:/[%p]/.test(_)?i:"",b=Gt[_],v=/[defgprs%]/.test(_);function r(e){var t,r,n,a=y,i=T;if("c"===_)i=b(e)+i,e="";else{var o=(e=+e)<0||1/e<0;if(e=isNaN(e)?C:b(Math.abs(e),g),m&&(e=function(e){e:for(var t,r=e.length,n=1,a=-1;n<r;++n)switch(e[n]){case".":a=t=n;break;case"0":0===a&&(a=n),t=n;break;default:if(!+e[n])break e;0<a&&(a=0)}return 0<a?e.slice(0,a)+e.slice(t+1):e}(e)),a=((o=o&&0==+e&&"+"!==d?!1:o)?"("===d?d:O:"-"===d||"("===d?"":d)+a,i=("s"===_?zt[8+Ft/3]:"")+i+(o&&"("===d?")":""),v)for(t=-1,r=e.length;++t<r;)if((n=e.charCodeAt(t))<48||57<n){i=(46===n?S+e.slice(t+1):e.slice(t))+i,e=e.slice(0,t);break}}h&&!f&&(e=E(e,1/0));var s=a.length+e.length+i.length,l=s<p?new Array(p-s+1).join(c):"";switch(h&&f&&(e=E(l+e,l.length?p-i.length:1/0),l=""),u){case"<":e=a+e+i+l;break;case"=":e=a+l+e+i;break;case"^":e=l.slice(0,s=l.length>>1)+a+e+i+l.slice(s);break;default:e=l+a+e+i}return A(e)}return g=void 0===g?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),r.toString=function(){return e+""},r}return{format:o,formatPrefix:function(e,t){var r=o(((e=Bt(e)).type="f",e)),e=3*Math.max(-8,Math.min(8,Math.floor(Lt(t)/3))),n=Math.pow(10,-e),a=zt[8+e/3];return function(e){return r(n*e)+a}}}}function Yt(e,t,r,n){var a,i,o=Q(e,t,r);switch((n=Bt(null==n?",f":n)).type){case"s":var s=Math.max(Math.abs(e),Math.abs(t));return null!=n.precision||isNaN((i=o,i=Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Lt(s)/3)))-Lt(Math.abs(i)))))||(n.precision=i),qt(n,s);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN((s=o,a=Math.max(Math.abs(e),Math.abs(t)),s=Math.abs(s),a=Math.abs(a)-s,i=Math.max(0,Lt(a)-Lt(s))+1))||(n.precision=i-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(i=Math.max(0,-Lt(Math.abs(o))))||(n.precision=i-2*("%"===n.type))}return Wt(n)}function Jt(c){var u=c.domain;return c.ticks=function(e){var t=u();return J(t[0],t[t.length-1],null==e?10:e)},c.tickFormat=function(e,t){var r=u();return Yt(r[0],r[r.length-1],null==e?10:e,t)},c.nice=function(e){null==e&&(e=10);var t,r,n=u(),a=0,i=n.length-1,o=n[a],s=n[i],l=10;for(s<o&&(r=o,o=s,s=r,r=a,a=i,i=r);0<l--;){if((r=Z(o,s,e))===t)return n[a]=o,n[i]=s,u(n);if(0<r)o=Math.floor(o/r)*r,s=Math.ceil(s/r)*r;else{if(!(r<0))break;o=Math.ceil(o*r)/r,s=Math.floor(s*r)/r}t=r}return c},c}function Zt(e,t){var r,n=0,a=(e=e.slice()).length-1,i=e[n],o=e[a];return o<i&&(r=n,n=a,a=r,r=i,i=o,o=r),e[n]=t.floor(i),e[a]=t.ceil(o),e}function Qt(e){return Math.log(e)}function Xt(e){return Math.exp(e)}function er(e){return-Math.log(-e)}function tr(e){return-Math.exp(-e)}function rr(e){return isFinite(e)?+("1e"+e):e<0?0:e}function nr(r){return(e,t)=>-r(-e,t)}function ar(e){const a=e(Qt,Xt),c=a.domain;let u=10,d,f;function t(){var t,r;return d=(r=u)===Math.E?Math.log:10===r&&Math.log10||2===r&&Math.log2||(r=Math.log(r),e=>Math.log(e)/r),f=10===(t=u)?rr:t===Math.E?Math.exp:e=>Math.pow(t,e),c()[0]<0?(d=nr(d),f=nr(f),e(er,tr)):e(Qt,Xt),a}return a.base=function(e){return arguments.length?(u=+e,t()):u},a.domain=function(e){return(arguments.length?(c(e),t):c)()},a.ticks=e=>{var t=c();let r=t[0],n=t[t.length-1];t=n<r;t&&([r,n]=[n,r]);let a=d(r),i=d(n),o,s;e=null==e?10:+e;let l=[];if(!(u%1)&&i-a<e){if(a=Math.floor(a),i=Math.ceil(i),0<r){for(;a<=i;++a)for(o=1;o<u;++o)if(!((s=a<0?o/f(-a):o*f(a))<r)){if(s>n)break;l.push(s)}}else for(;a<=i;++a)for(o=u-1;1<=o;--o)if(!((s=0<a?o/f(-a):o*f(a))<r)){if(s>n)break;l.push(s)}2*l.length<e&&(l=J(r,n,e))}else l=J(a,i,Math.min(i-a,e)).map(f);return t?l.reverse():l},a.tickFormat=(e,r)=>{if(null==e&&(e=10),"function"!=typeof(r=null==r?10===u?"s":",":r)&&(u%1||null!=(r=Bt(r)).precision||(r.trim=!0),r=Wt(r)),e===1/0)return r;const n=Math.max(1,u*e/a.ticks().length);return e=>{let t=e/f(Math.round(d(e)));return t*u<u-.5&&(t*=u),t<=n?r(e):""}},a.nice=()=>c(Zt(c(),{floor:e=>f(Math.floor(d(e))),ceil:e=>f(Math.ceil(d(e)))})),a}function ir(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function or(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function sr(t){var r=1,e=t(ir(r),or(r));return e.constant=function(e){return arguments.length?t(ir(r=+e),or(r)):r},Jt(e)}function lr(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function cr(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function ur(e){return e<0?-e*e:e*e}function dr(t){var e=t(g,g),r=1;return e.exponent=function(e){return arguments.length?1===(r=+e)?t(g,g):.5===r?t(cr,ur):t(lr(r),lr(1/r)):r},Jt(e)}function fr(){var e=dr(Nt());return e.copy=function(){return Pt(e,fr()).exponent(e.exponent())},c.apply(e,arguments),e}St=Kt({thousands:",",grouping:[3],currency:["$",""]}),Wt=St.format,qt=St.formatPrefix;const Pa=new Date,Na=new Date;function m(i,o,r,n){function s(e){return i(e=0===arguments.length?new Date:new Date(+e)),e}return s.floor=e=>(i(e=new Date(+e)),e),s.ceil=e=>(i(e=new Date(e-1)),o(e,1),i(e),e),s.round=e=>{var t=s(e),r=s.ceil(e);return e-t<r-e?t:r},s.offset=(e,t)=>(o(e=new Date(+e),null==t?1:Math.floor(t)),e),s.range=(e,t,r)=>{var n,a=[];if(e=s.ceil(e),r=null==r?1:Math.floor(r),e<t&&0<r)for(;a.push(n=new Date(+e)),o(e,r),i(e),n<e&&e<t;);return a},s.filter=r=>m(e=>{if(e<=e)for(;i(e),!r(e);)e.setTime(e-1)},(e,t)=>{if(e<=e)if(t<0)for(;++t<=0;)for(;o(e,-1),!r(e););else for(;0<=--t;)for(;o(e,1),!r(e););}),r&&(s.count=(e,t)=>(Pa.setTime(+e),Na.setTime(+t),i(Pa),i(Na),Math.floor(r(Pa,Na))),s.every=t=>(t=Math.floor(t),isFinite(t)&&0<t?1<t?s.filter(n?e=>n(e)%t==0:e=>s.count(0,e)%t==0):s:null)),s}const Da=m(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e),R=(Da.every=r=>(r=Math.floor(r),isFinite(r)&&0<r?1<r?m(e=>{e.setTime(Math.floor(e/r)*r)},(e,t)=>{e.setTime(+e+t*r)},(e,t)=>(t-e)/r):Da:null),Da.range,1e3),I=60*R,M=60*I,P=24*M,xa=7*P,La=30*P,Fa=365*P,N=m(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*R)},(e,t)=>(t-e)/R,e=>e.getUTCSeconds()),Ua=(N.range,m(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*R)},(e,t)=>{e.setTime(+e+t*I)},(e,t)=>(t-e)/I,e=>e.getMinutes())),Ba=(Ua.range,m(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*I)},(e,t)=>(t-e)/I,e=>e.getUTCMinutes())),ja=(Ba.range,m(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*R-e.getMinutes()*I)},(e,t)=>{e.setTime(+e+t*M)},(e,t)=>(t-e)/M,e=>e.getHours())),Ha=(ja.range,m(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*M)},(e,t)=>(t-e)/M,e=>e.getUTCHours())),Ga=(Ha.range,m(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*I)/P,e=>e.getDate()-1)),Va=(Ga.range,m(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/P,e=>e.getUTCDate()-1));Va.range;At=m(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/P,e=>Math.floor(e/P));function pr(t){return m(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,t)=>{e.setDate(e.getDate()+7*t)},(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*I)/xa)}At.range;const Wa=pr(0),qa=pr(1);bt=pr(2),vt=pr(3);const $a=pr(4);_t=pr(5),yt=pr(6);function hr(t){return m(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)},(e,t)=>(t-e)/xa)}Wa.range,qa.range,bt.range,vt.range,$a.range,_t.range,yt.range;const za=hr(0),Ka=hr(1);n=hr(2),i=hr(3);const Ya=hr(4);a=hr(5),pt=hr(6);za.range,Ka.range,n.range,i.range,Ya.range,a.range,pt.range;const Ja=m(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear()),e=>e.getMonth()),Za=(Ja.range,m(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear()),e=>e.getUTCMonth())),D=(Za.range,m(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear())),x=(D.every=r=>isFinite(r=Math.floor(r))&&0<r?m(e=>{e.setFullYear(Math.floor(e.getFullYear()/r)*r),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t*r)}):null,D.range,m(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear()));function gr(i,e,t,r,n,a){const o=[[N,1,R],[N,5,5*R],[N,15,15*R],[N,30,30*R],[a,1,I],[a,5,5*I],[a,15,15*I],[a,30,30*I],[n,1,M],[n,3,3*M],[n,6,6*M],[n,12,12*M],[r,1,P],[r,2,2*P],[t,1,xa],[e,1,La],[e,3,3*La],[i,1,Fa]];function s(e,t,r){var n=Math.abs(t-e)/r,a=q(([,,e])=>e).right(o,n);return a===o.length?i.every(Q(e/Fa,t/Fa,r)):0===a?Da.every(Math.max(Q(e,t,r),1)):([e,t]=o[n/o[a-1][2]<o[a][2]/n?a-1:a],e.every(t))}return[function(e,t,r){var n=t<e;n&&([e,t]=[t,e]);r=(r=r&&"function"==typeof r.range?r:s(e,t,r))?r.range(e,+t+1):[];return n?r.reverse():r},s]}x.every=r=>isFinite(r=Math.floor(r))&&0<r?m(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/r)*r),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t*r)}):null,x.range;const[Qa,Xa]=gr(x,Za,za,At,Ha,Ba),[ei,ti]=gr(D,Ja,Wa,Ga,ja,Ua);function mr(e){var t;return 0<=e.y&&e.y<100?((t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L)).setFullYear(e.y),t):new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function _r(e){var t;return 0<=e.y&&e.y<100?((t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L))).setUTCFullYear(e.y),t):new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function yr(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function Tr(e){var n=e.dateTime,a=e.date,i=e.time,t=e.periods,r=e.days,o=e.shortDays,s=e.months,l=e.shortMonths,c=Cr(t),u=kr(t),d=Cr(r),f=kr(r),p=Cr(o),h=kr(o),g=Cr(s),m=kr(s),_=Cr(l),y=kr(l),T={a:function(e){return o[e.getDay()]},A:function(e){return r[e.getDay()]},b:function(e){return l[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:Kr,e:Kr,f:Xr,g:dn,G:pn,H:Yr,I:Jr,j:Zr,L:Qr,m:en,M:tn,p:function(e){return t[+(12<=e.getHours())]},q:function(e){return 1+~~(e.getMonth()/3)},Q:Ln,s:Fn,S:rn,u:nn,U:an,V:sn,w:ln,W:cn,x:null,X:null,y:un,Y:fn,Z:hn,"%":xn},b={a:function(e){return o[e.getUTCDay()]},A:function(e){return r[e.getUTCDay()]},b:function(e){return l[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:gn,e:gn,f:bn,g:Mn,G:Nn,H:mn,I:_n,j:yn,L:Tn,m:vn,M:En,p:function(e){return t[+(12<=e.getUTCHours())]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:Ln,s:Fn,S:Sn,u:An,U:On,V:kn,w:wn,W:Rn,x:null,X:null,y:In,Y:Pn,Z:Dn,"%":xn},v={a:function(e,t,r){t=p.exec(t.slice(r));return t?(e.w=h.get(t[0].toLowerCase()),r+t[0].length):-1},A:function(e,t,r){t=d.exec(t.slice(r));return t?(e.w=f.get(t[0].toLowerCase()),r+t[0].length):-1},b:function(e,t,r){t=_.exec(t.slice(r));return t?(e.m=y.get(t[0].toLowerCase()),r+t[0].length):-1},B:function(e,t,r){t=g.exec(t.slice(r));return t?(e.m=m.get(t[0].toLowerCase()),r+t[0].length):-1},c:function(e,t,r){return A(e,n,t,r)},d:Ur,e:Ur,f:Wr,g:Dr,G:Nr,H:jr,I:jr,j:Br,L:Vr,m:Fr,M:Hr,p:function(e,t,r){t=c.exec(t.slice(r));return t?(e.p=u.get(t[0].toLowerCase()),r+t[0].length):-1},q:Lr,Q:$r,s:zr,S:Gr,u:Rr,U:Ir,V:Mr,w:wr,W:Pr,x:function(e,t,r){return A(e,a,t,r)},X:function(e,t,r){return A(e,i,t,r)},y:Dr,Y:Nr,Z:xr,"%":qr};function E(l,c){return function(e){var t,r,n,a=[],i=-1,o=0,s=l.length;for(e instanceof Date||(e=new Date(+e));++i<s;)37===l.charCodeAt(i)&&(a.push(l.slice(o,i)),null!=(r=Er[t=l.charAt(++i)])?t=l.charAt(++i):r="e"===t?" ":"0",(n=c[t])&&(t=n(e,r)),a.push(t),o=i+1);return a.push(l.slice(o,i)),a.join("")}}function S(a,i){return function(e){var t,r,n=yr(1900,void 0,1);if(A(n,a,e+="",0)!=e.length)return null;if("Q"in n)return new Date(n.Q);if("s"in n)return new Date(1e3*n.s+("L"in n?n.L:0));if(!i||"Z"in n||(n.Z=0),"p"in n&&(n.H=n.H%12+12*n.p),void 0===n.m&&(n.m="q"in n?n.q:0),"V"in n){if(n.V<1||53<n.V)return null;"w"in n||(n.w=1),"Z"in n?(t=4<(r=(t=_r(yr(n.y,0,1))).getUTCDay())||0===r?Ka.ceil(t):Ka(t),t=Va.offset(t,7*(n.V-1)),n.y=t.getUTCFullYear(),n.m=t.getUTCMonth(),n.d=t.getUTCDate()+(n.w+6)%7):(t=4<(r=(t=mr(yr(n.y,0,1))).getDay())||0===r?qa.ceil(t):qa(t),t=Ga.offset(t,7*(n.V-1)),n.y=t.getFullYear(),n.m=t.getMonth(),n.d=t.getDate()+(n.w+6)%7)}else("W"in n||"U"in n)&&("w"in n||(n.w="u"in n?n.u%7:"W"in n?1:0),r="Z"in n?_r(yr(n.y,0,1)).getUTCDay():mr(yr(n.y,0,1)).getDay(),n.m=0,n.d="W"in n?(n.w+6)%7+7*n.W-(r+5)%7:n.w+7*n.U-(r+6)%7);return("Z"in n?(n.H+=n.Z/100|0,n.M+=n.Z%100,_r):mr)(n)}}function A(e,t,r,n){for(var a,i,o=0,s=t.length,l=r.length;o<s;){if(l<=n)return-1;if(37===(a=t.charCodeAt(o++))){if(a=t.charAt(o++),!(i=v[a in Er?t.charAt(o++):a])||(n=i(e,r,n))<0)return-1}else if(a!=r.charCodeAt(n++))return-1}return n}return T.x=E(a,T),T.X=E(i,T),T.c=E(n,T),b.x=E(a,b),b.X=E(i,b),b.c=E(n,b),{format:function(e){var t=E(e+="",T);return t.toString=function(){return e},t},parse:function(e){var t=S(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=E(e+="",b);return t.toString=function(){return e},t},utcParse:function(e){var t=S(e+="",!0);return t.toString=function(){return e},t}}}var br,vr,Er={"-":"",_:" ",0:"0"},y=/^\s*\d+/,Sr=/^%/,Ar=/[\\^$*+?|[\]().{}]/g;function T(e,t,r){var n=e<0?"-":"",e=(n?-e:e)+"",a=e.length;return n+(a<r?new Array(r-a+1).join(t)+e:e)}function Or(e){return e.replace(Ar,"\\$&")}function Cr(e){return new RegExp("^(?:"+e.map(Or).join("|")+")","i")}function kr(e){return new Map(e.map((e,t)=>[e.toLowerCase(),t]))}function wr(e,t,r){t=y.exec(t.slice(r,r+1));return t?(e.w=+t[0],r+t[0].length):-1}function Rr(e,t,r){t=y.exec(t.slice(r,r+1));return t?(e.u=+t[0],r+t[0].length):-1}function Ir(e,t,r){t=y.exec(t.slice(r,r+2));return t?(e.U=+t[0],r+t[0].length):-1}function Mr(e,t,r){t=y.exec(t.slice(r,r+2));return t?(e.V=+t[0],r+t[0].length):-1}function Pr(e,t,r){t=y.exec(t.slice(r,r+2));return t?(e.W=+t[0],r+t[0].length):-1}function Nr(e,t,r){t=y.exec(t.slice(r,r+4));return t?(e.y=+t[0],r+t[0].length):-1}function Dr(e,t,r){t=y.exec(t.slice(r,r+2));return t?(e.y=+t[0]+(68<+t[0]?1900:2e3),r+t[0].length):-1}function xr(e,t,r){t=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return t?(e.Z=t[1]?0:-(t[2]+(t[3]||"00")),r+t[0].length):-1}function Lr(e,t,r){t=y.exec(t.slice(r,r+1));return t?(e.q=3*t[0]-3,r+t[0].length):-1}function Fr(e,t,r){t=y.exec(t.slice(r,r+2));return t?(e.m=t[0]-1,r+t[0].length):-1}function Ur(e,t,r){t=y.exec(t.slice(r,r+2));return t?(e.d=+t[0],r+t[0].length):-1}function Br(e,t,r){t=y.exec(t.slice(r,r+3));return t?(e.m=0,e.d=+t[0],r+t[0].length):-1}function jr(e,t,r){t=y.exec(t.slice(r,r+2));return t?(e.H=+t[0],r+t[0].length):-1}function Hr(e,t,r){t=y.exec(t.slice(r,r+2));return t?(e.M=+t[0],r+t[0].length):-1}function Gr(e,t,r){t=y.exec(t.slice(r,r+2));return t?(e.S=+t[0],r+t[0].length):-1}function Vr(e,t,r){t=y.exec(t.slice(r,r+3));return t?(e.L=+t[0],r+t[0].length):-1}function Wr(e,t,r){t=y.exec(t.slice(r,r+6));return t?(e.L=Math.floor(t[0]/1e3),r+t[0].length):-1}function qr(e,t,r){t=Sr.exec(t.slice(r,r+1));return t?r+t[0].length:-1}function $r(e,t,r){t=y.exec(t.slice(r));return t?(e.Q=+t[0],r+t[0].length):-1}function zr(e,t,r){t=y.exec(t.slice(r));return t?(e.s=+t[0],r+t[0].length):-1}function Kr(e,t){return T(e.getDate(),t,2)}function Yr(e,t){return T(e.getHours(),t,2)}function Jr(e,t){return T(e.getHours()%12||12,t,2)}function Zr(e,t){return T(1+Ga.count(D(e),e),t,3)}function Qr(e,t){return T(e.getMilliseconds(),t,3)}function Xr(e,t){return Qr(e,t)+"000"}function en(e,t){return T(e.getMonth()+1,t,2)}function tn(e,t){return T(e.getMinutes(),t,2)}function rn(e,t){return T(e.getSeconds(),t,2)}function nn(e){e=e.getDay();return 0===e?7:e}function an(e,t){return T(Wa.count(D(e)-1,e),t,2)}function on(e){var t=e.getDay();return 4<=t||0===t?$a(e):$a.ceil(e)}function sn(e,t){return e=on(e),T($a.count(D(e),e)+(4===D(e).getDay()),t,2)}function ln(e){return e.getDay()}function cn(e,t){return T(qa.count(D(e)-1,e),t,2)}function un(e,t){return T(e.getFullYear()%100,t,2)}function dn(e,t){return T((e=on(e)).getFullYear()%100,t,2)}function fn(e,t){return T(e.getFullYear()%1e4,t,4)}function pn(e,t){var r=e.getDay();return T((e=4<=r||0===r?$a(e):$a.ceil(e)).getFullYear()%1e4,t,4)}function hn(e){e=e.getTimezoneOffset();return(0<e?"-":(e*=-1,"+"))+T(e/60|0,"0",2)+T(e%60,"0",2)}function gn(e,t){return T(e.getUTCDate(),t,2)}function mn(e,t){return T(e.getUTCHours(),t,2)}function _n(e,t){return T(e.getUTCHours()%12||12,t,2)}function yn(e,t){return T(1+Va.count(x(e),e),t,3)}function Tn(e,t){return T(e.getUTCMilliseconds(),t,3)}function bn(e,t){return Tn(e,t)+"000"}function vn(e,t){return T(e.getUTCMonth()+1,t,2)}function En(e,t){return T(e.getUTCMinutes(),t,2)}function Sn(e,t){return T(e.getUTCSeconds(),t,2)}function An(e){e=e.getUTCDay();return 0===e?7:e}function On(e,t){return T(za.count(x(e)-1,e),t,2)}function Cn(e){var t=e.getUTCDay();return 4<=t||0===t?Ya(e):Ya.ceil(e)}function kn(e,t){return e=Cn(e),T(Ya.count(x(e),e)+(4===x(e).getUTCDay()),t,2)}function wn(e){return e.getUTCDay()}function Rn(e,t){return T(Ka.count(x(e)-1,e),t,2)}function In(e,t){return T(e.getUTCFullYear()%100,t,2)}function Mn(e,t){return T((e=Cn(e)).getUTCFullYear()%100,t,2)}function Pn(e,t){return T(e.getUTCFullYear()%1e4,t,4)}function Nn(e,t){var r=e.getUTCDay();return T((e=4<=r||0===r?Ya(e):Ya.ceil(e)).getUTCFullYear()%1e4,t,4)}function Dn(){return"+0000"}function xn(){return"%"}function Ln(e){return+e}function Fn(e){return Math.floor(+e/1e3)}function Un(e){return new Date(e)}function Bn(e){return e instanceof Date?+e:+new Date(+e)}function jn(r,n,t,a,i,o,s,l,c,u){var d=Dt(),f=d.invert,p=d.domain,h=u(".%L"),g=u(":%S"),m=u("%I:%M"),_=u("%I %p"),y=u("%a %d"),T=u("%b %d"),b=u("%B"),v=u("%Y");function E(e){return(c(e)<e?h:l(e)<e?g:s(e)<e?m:o(e)<e?_:a(e)<e?i(e)<e?y:T:t(e)<e?b:v)(e)}return d.invert=function(e){return new Date(f(e))},d.domain=function(e){return arguments.length?p(Array.from(e,Bn)):p().map(Un)},d.ticks=function(e){var t=p();return r(t[0],t[t.length-1],null==e?10:e)},d.tickFormat=function(e,t){return null==t?E:u(t)},d.nice=function(e){var t=p();return(e=e&&"function"==typeof e.range?e:n(t[0],t[t.length-1],null==e?10:e))?p(Zt(t,e)):d},d.copy=function(){return Pt(d,jn(r,n,t,a,i,o,s,l,c,u))},d}function Hn(){var t,r,n,a,i,o=0,s=1,l=g,c=!1;function u(e){return null==e||isNaN(e=+e)?i:l(0===n?.5:(e=(a(e)-t)*n,c?Math.max(0,Math.min(1,e)):e))}function e(r){return function(e){var t;return arguments.length?([e,t]=e,l=r(e,t),u):[l(0),l(1)]}}return u.domain=function(e){return arguments.length?([o,s]=e,t=a(o=+o),r=a(s=+s),n=t===r?0:1/(r-t),u):[o,s]},u.clamp=function(e){return arguments.length?(c=!!e,u):c},u.interpolator=function(e){return arguments.length?(l=e,u):l},u.range=e(ot),u.rangeRound=e(st),u.unknown=function(e){return arguments.length?(i=e,u):i},function(e){return t=(a=e)(o),r=e(s),n=t===r?0:1/(r-t),u}}function b(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Gn(){var e=Jt(Hn()(g));return e.copy=function(){return b(e,Gn())},r.apply(e,arguments)}function Vn(){var e=dr(Hn());return e.copy=function(){return b(e,Vn()).exponent(e.exponent())},r.apply(e,arguments)}function Wn(){var t,r,n,a,i,o,s,l=0,c=.5,u=1,d=1,f=g,p=!1;function h(e){return isNaN(e=+e)?s:(e=.5+((e=+o(e))-r)*(d*e<d*r?a:i),f(p?Math.max(0,Math.min(1,e)):e))}function e(n){return function(e){var t,r;return arguments.length?([e,t,r]=e,f=Ot(n,[e,t,r]),h):[f(0),f(.5),f(1)]}}return h.domain=function(e){return arguments.length?([l,c,u]=e,t=o(l=+l),r=o(c=+c),n=o(u=+u),a=t===r?0:.5/(r-t),i=r===n?0:.5/(n-r),d=r<t?-1:1,h):[l,c,u]},h.clamp=function(e){return arguments.length?(p=!!e,h):p},h.interpolator=function(e){return arguments.length?(f=e,h):f},h.range=e(ot),h.rangeRound=e(st),h.unknown=function(e){return arguments.length?(s=e,h):s},function(e){return t=(o=e)(l),r=e(c),n=e(u),a=t===r?0:.5/(r-t),i=r===n?0:.5/(n-r),d=r<t?-1:1,h}}function qn(){var e=dr(Wn());return e.copy=function(){return b(e,qn()).exponent(e.exponent())},r.apply(e,arguments)}function $n(){const t=X().unknown(void 0),c=t.domain,u=t.range;let d=[0,1],i,f,o=!1,s=0,l=0,p=.5;function r(){var e=c().length,t=d[1]<d[0],r=d[1-t],n=F(e,s,l);let a=d[+t];i=(r-a)/(n||1),o&&(i=Math.floor(i)),a+=(r-a-i*(e-s))*p,f=i*(1-s),o&&(a=Math.round(a),f=Math.round(f));n=function(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=0|Math.max(0,Math.ceil((t-e)/r)),i=new Array(a);++n<a;)i[n]=e+n*r;return i}(e).map(e=>a+i*e);return u(t?n.reverse():n)}return delete t.unknown,t.domain=function(e){return(arguments.length?(c(e),r):c)()},t.range=function(e){return arguments.length?(d=[+e[0],+e[1]],r()):d.slice()},t.rangeRound=function(e){return d=[+e[0],+e[1]],o=!0,r()},t.bandwidth=function(){return f},t.step=function(){return i},t.round=function(e){return arguments.length?(o=!!e,r()):o},t.padding=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),s=l,r()):s},t.paddingInner=function(e){return arguments.length?(s=Math.max(0,Math.min(1,e)),r()):s},t.paddingOuter=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),r()):l},t.align=function(e){return arguments.length?(p=Math.max(0,Math.min(1,e)),r()):p},t.invertRange=function(i){if(null!=i[0]&&null!=i[1]){var o=d[1]<d[0],s=o?u().reverse():u(),l=s.length-1;let e=+i[0],t=+i[1],r,n,a;if(e==e&&t==t&&(t<e&&(a=e,e=t,t=a),!(t<s[0]||e>d[1-o])))return r=Math.max(0,w(s,e)-1),n=e===t?r:w(s,t)-1,e-s[r]>f+1e-10&&++r,o&&(a=r,r=l-n,n=l-a),r>n?void 0:c().slice(r,n+1)}},t.invert=function(e){e=t.invertRange([e,e]);return e&&e[0]},t.copy=function(){return $n().domain(c()).range(d).round(o).paddingInner(s).paddingOuter(l).align(p)},r()}gt=Tr({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),br=gt.format,gt.parse,vr=gt.utcFormat,gt.utcParse;var zn=Array.prototype.map;const ri=Array.prototype.slice;const ni=new Map,ai=Symbol("vega_scale");function Kn(e){return e[ai]=!0,e}function Yn(t,r,e){function n(){var c,a,e=r();return e.invertRange||(e.invertRange=e.invert?(a=e,function(e){let t=e[0],r=e[1],n;return r<t&&(n=t,t=r,r=n),[a.invert(t),a.invert(r)]}):e.invertExtent?(c=e,function(e){var t=c.range();let r=e[0],n=e[1],a=-1,i,o,s,l;for(n<r&&(o=r,r=n,n=o),s=0,l=t.length;s<l;++s)t[s]>=r&&t[s]<=n&&(a<0&&(a=s),i=s);if(!(a<0))return r=c.invertExtent(t[a]),n=c.invertExtent(t[i]),[void 0===r[0]?r[1]:r[0],void 0===n[1]?n[0]:n[1]]}):void 0),e.type=t,Kn(e)}return n.metadata=l.toSet(l.array(e)),n}function v(e,t,r){return 1<arguments.length?(ni.set(e,Yn(e,t,r)),this):Jn(e)?ni.get(e):void 0}function Jn(e){return ni.has(e)}function Zn(e,t){e=ni.get(e);return e&&e.metadata[t]}function Qn(e){return Zn(e,ga)}function Xn(e){return Zn(e,ma)}function ea(e){return Zn(e,S)}function ta(e){return Zn(e,_a)}v("identity",function e(t){var r;function n(e){return null==e||isNaN(e=+e)?r:e}return(n.invert=n).domain=n.range=function(e){return arguments.length?(t=Array.from(e,kt),n):t.slice()},n.unknown=function(e){return arguments.length?(r=e,n):r},n.copy=function(){return e(t).unknown(r)},t=arguments.length?Array.from(t,kt):[0,1],Jt(n)}),v(U,function e(){var t=Dt();return t.copy=function(){return Pt(t,e())},c.apply(t,arguments),Jt(t)},C),v(S,function e(){const t=ar(Nt()).domain([1,10]);return t.copy=()=>Pt(t,e()).base(t.base()),c.apply(t,arguments),t},[C,S]),v("pow",fr,C),v(B,function(){return fr.apply(null,arguments).exponent(.5)},C),v(j,function e(){var t=sr(Nt());return t.copy=function(){return Pt(t,e()).constant(t.constant())},c.apply(t,arguments)},C),v(A,function(){return c.apply(jn(ei,ti,D,Ja,Wa,Ga,ja,Ua,N,br).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},[C,_a]),v(O,function(){return c.apply(jn(Qa,Xa,x,Za,za,Va,Ha,Ba,N,vr).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)},[C,_a]),v(t,Gn,[C,k]),v(t+"-linear",Gn,[C,k]),v(t+"-"+S,function e(){var t=ar(Hn()).domain([1,10]);return t.copy=function(){return b(t,e()).base(t.base())},r.apply(t,arguments)},[C,k,S]),v(t+"-pow",Vn,[C,k]),v(t+"-sqrt",function(){return Vn.apply(null,arguments).exponent(.5)},[C,k]),v(t+"-symlog",function e(){var t=sr(Hn());return t.copy=function(){return b(t,e()).constant(t.constant())},r.apply(t,arguments)},[C,k]),v(H+"-linear",function e(){var t=Jt(Wn()(g));return t.copy=function(){return b(t,e())},r.apply(t,arguments)},[C,k]),v(H+"-"+S,function e(){var t=ar(Wn()).domain([.1,1,10]);return t.copy=function(){return b(t,e()).base(t.base())},r.apply(t,arguments)},[C,k,S]),v(H+"-pow",qn,[C,k]),v(H+"-sqrt",function(){return qn.apply(null,arguments).exponent(.5)},[C,k]),v(H+"-symlog",function e(){var t=sr(Wn());return t.copy=function(){return b(t,e()).constant(t.constant())},r.apply(t,arguments)},[C,k]),v(pa,function e(){var t,r=[],n=[],a=[];function i(){var e=0,t=Math.max(1,n.length);for(a=new Array(t-1);++e<t;)a[e-1]=function(e,t,r=z){var n,a;if((n=e.length)&&!isNaN(t=+t))return t<=0||n<2?+r(e[0],0,e):1<=t?+r(e[n-1],n-1,e):(n=(n-1)*t,(a=+r(e[t=Math.floor(n)],t,e))+(+r(e[t+1],t+1,e)-a)*(n-t))}(r,e/t);return o}function o(e){return null==e||isNaN(e=+e)?t:n[w(a,e)]}return o.invertExtent=function(e){return(e=n.indexOf(e))<0?[NaN,NaN]:[0<e?a[e-1]:r[0],e<a.length?a[e]:r[r.length-1]]},o.domain=function(e){if(!arguments.length)return r.slice();r=[];for(var t of e)null==t||isNaN(t=+t)||r.push(t);return r.sort(W),i()},o.range=function(e){return arguments.length?(n=Array.from(e),i()):n.slice()},o.unknown=function(e){return arguments.length?(t=e,o):t},o.quantiles=function(){return a.slice()},o.copy=function(){return e().domain(r).range(n).unknown(t)},c.apply(o,arguments)},[ma,pa]),v(G,function e(){var t,r=0,n=1,a=1,i=[.5],o=[0,1];function s(e){return null!=e&&e<=e?o[w(i,e,0,a)]:t}function l(){var e=-1;for(i=new Array(a);++e<a;)i[e]=((e+1)*n-(e-a)*r)/(a+1);return s}return s.domain=function(e){return arguments.length?([r,n]=e,r=+r,n=+n,l()):[r,n]},s.range=function(e){return arguments.length?(a=(o=Array.from(e)).length-1,l()):o.slice()},s.invertExtent=function(e){return(e=o.indexOf(e))<0?[NaN,NaN]:e<1?[r,i[0]]:a<=e?[i[a-1],n]:[i[e-1],i[e]]},s.unknown=function(e){return arguments.length&&(t=e),s},s.thresholds=function(){return i.slice()},s.copy=function(){return e().domain([r,n]).range(o).unknown(t)},c.apply(Jt(s),arguments)},ma),v(ha,function e(){var t,r=[.5],n=[0,1],a=1;function i(e){return null!=e&&e<=e?n[w(r,e,0,a)]:t}return i.domain=function(e){return arguments.length?(r=Array.from(e),a=Math.min(r.length,n.length-1),i):r.slice()},i.range=function(e){return arguments.length?(n=Array.from(e),a=Math.min(r.length,n.length-1),i):n.slice()},i.invertExtent=function(e){return e=n.indexOf(e),[r[e-1],r[e]]},i.unknown=function(e){return arguments.length?(t=e,i):t},i.copy=function(){return e().domain(r).range(n).unknown(t)},c.apply(i,arguments)},ma),v(V,function e(){let r=[],t=[];function n(e){return null==e||e!=e?void 0:t[(w(r,e)-1)%t.length]}return n.domain=function(e){return arguments.length?(r=zn.call(e,l.toNumber),n):r.slice()},n.range=function(e){return arguments.length?(t=ri.call(e),n):t.slice()},n.tickFormat=function(e,t){return Yt(r[0],l.peek(r),null==e?10:e,t)},n.copy=function(){return e().domain(n.domain()).range(n.range())},n},[ga,ma]),v("ordinal",X,ga),v("band",$n,ga),v("point",function(){return function e(t){const r=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,t.copy=function(){return e(r())},t}($n().paddingInner(1))},ga);const ii=["clamp","base","constant","exponent"];function ra(e,t,r){return Ot(na(t||"rgb",r),e)}function na(e,t){e=Ct["interpolate"+e.toLowerCase().split("-").map(e=>e[0].toUpperCase()+e.slice(1)).join("")];return null!=t&&e&&e.gamma?e.gamma(t):e}function E(e){for(var t=e.length/6|0,r=new Array(t),n=0;n<t;)r[n]="#"+e.slice(6*n,6*++n);return r}St=E("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),bt=E("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),vt=E("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),_t=E("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),yt=E("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),n=E("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),i=E("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),a=E("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),pt=E("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),At=E("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f");function aa(t){if(l.isArray(t))return t;var r=t.length/6|0,n=new Array(r);for(let e=0;e<r;)n[e]="#"+t.slice(6*e,6*++e);return n}function ia(e,t){for(const r in e)oa(r,t(e[r]))}const oi={};function oa(e,t){return e=e&&e.toLowerCase(),1<arguments.length?(oi[e]=t,this):oi[e]}ia({accent:bt,category10:St,category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",dark2:vt,observable10:_t,paired:yt,pastel1:n,pastel2:i,set1:a,set2:pt,set3:At,tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5"},aa),ia({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},e=>ra(aa(e)));const si="symbol",li="discrete";const ci=e=>l.isArray(e)?e.map(e=>String(e)):String(e),ui=(e,t)=>e[1]-t[1],di=(e,t)=>t[1]-e[1];function sa(t,e,r){let n=t.range(),a=n[0],i=l.peek(n),o=ui;if(a>i&&(n=i,i=a,a=n,o=di),a=Math.floor(a),i=Math.ceil(i),e=e.map(e=>[e,t(e)]).filter(e=>a<=e[1]&&e[1]<=i).sort(o).map(e=>e[0]),0<r&&1<e.length){for(var s=[e[0],l.peek(e)];e.length>r&&3<=e.length;)e=e.filter((e,t)=>!(t%2));e.length<3&&(e=s)}return e}function la(e,t){return e.bins?sa(e,e.bins,t):e.ticks?e.ticks(t):e.domain()}function ca(e,t,r,n,a,i){var o=t.type;let s=ci;if(o===A||a===A)s=e.timeFormat(n);else if(o===O||a===O)s=e.utcFormat(n);else if(ea(o)){const l=e.formatFloat(n);if(i||t.bins)s=l;else{const c=ua(t,r,!1);s=e=>c(e)?l(e):""}}else t.tickFormat?(a=t.domain(),s=e.formatSpan(a[0],a[a.length-1],r,n)):n&&(s=e.format(n));return s}function ua(e,t,r){const n=la(e,t),a=e.base(),i=Math.log(a),o=Math.max(1,a*t/n.length);e=e=>{let t=e/Math.pow(a,Math.round(Math.log(e)/i));return t*a<a-.5&&(t*=a),t<=o};return r?n.filter(e):e}const fi={[pa]:"quantiles",quantize:"thresholds",[ha]:"domain"},pi={[pa]:"quantiles",quantize:"domain"};function da(e,t){return e.bins?(r=e.bins,(n=r.slice(0,-1)).max=l.peek(r),n):e.type===S?ua(e,t,!0):fi[e.type]?(r=e[fi[e.type]](),(r=[-1/0].concat(r)).max=1/0,r):la(e,t);var r,n}const hi=e=>fi[e.type]||e.bins;function fa(e,t,r,n,a,i,o){e=pi[t.type]&&i!==A&&i!==O?function(e,t,r){var n=t[pi[t.type]](),a=n.length;let i=1<a?n[1]-n[0]:n[0],o;for(o=1;o<a;++o)i=Math.min(i,n[o]-n[o-1]);return e.formatSpan(0,i,30,r)}(e,t,a):ca(e,t,r,a,i,o);return(n===si&&hi(t)?gi:n===li?_i:yi)(e)}const gi=n=>(e,t,r)=>{t=mi(r[t+1],mi(r.max,1/0)),r=Ti(e,n),e=Ti(t,n);return r&&e?r+" – "+e:e?"< "+e:"≥ "+r},mi=(e,t)=>null!=e?e:t,_i=r=>(e,t)=>t?r(e):null,yi=t=>e=>t(e),Ti=(e,t)=>Number.isFinite(e)?t(e):null;e.Band="band",e.BinOrdinal=V,e.DiscreteLegend=li,e.Diverging=H,e.GradientLegend="gradient",e.Identity="identity",e.Linear=U,e.Log=S,e.Ordinal="ordinal",e.Point="point",e.Pow="pow",e.Quantile=pa,e.Quantize=G,e.Sequential=t,e.Sqrt=B,e.SymbolLegend=si,e.Symlog=j,e.Threshold=ha,e.Time=A,e.UTC=O,e.bandSpace=F,e.domainCaption=function(e,t,r){r=r||{};var n,a,i=Math.max(3,r.maxlen||7),o=(e=e,n=t,a=r.format,r=r.formatType,o=r||n.type,(a=l.isString(a)&&ta(o)?a.replace(/%a/g,"%A").replace(/%b/g,"%B"):a)||o!==A?a||o!==O?fa(e,n,5,null,a,r,!0):e.utcFormat("%A, %d %B %Y, %X UTC"):e.timeFormat("%A, %d %B %Y, %X"));return Xn(t.type)?(a=(n=da(t).slice(1).map(o)).length)+` boundar${1===a?"y":"ies"}: `+n.join(", "):Qn(t.type)?(e=(r=t.domain()).length)+` value${1===e?"":"s"}: `+(i<e?r.slice(0,i-2).map(o).join(", ")+", ending with "+r.slice(-1).map(o):r.map(o).join(", ")):`values from ${o((a=t.domain())[0])} to `+o(l.peek(a))},e.interpolate=na,e.interpolateColors=ra,e.interpolateRange=function(t,e){const r=e[0],n=l.peek(e)-r;return function(e){return t(r+e*n)}},e.isContinuous=function(e){return Zn(e,C)},e.isDiscrete=Qn,e.isDiscretizing=Xn,e.isInterpolating=function(e){return Zn(e,k)},e.isLogarithmic=ea,e.isQuantile=function(e){return Zn(e,pa)},e.isRegisteredScale=function(e){return e&&!0===e[ai]},e.isTemporal=ta,e.isValidScaleType=Jn,e.labelFormat=fa,e.labelFraction=function(e){var t=e.domain(),r=t.length-1;let n=+t[0],a=+l.peek(t),i=a-n;return e.type===ha&&(t=r?i/r:.1,n-=t,a+=t,i=a-n),e=>(e-n)/i},e.labelValues=da,e.quantizeInterpolator=function(t,r){var n=new Array(r),a=r+1;for(let e=0;e<r;)n[e]=t(++e/a);return n},e.registerScale=Kn,e.scale=v,e.scaleCopy=function(e){var t=e.type;return(e=e.copy()).type=t,e},e.scaleFraction=function(t,e,r){var n=r-e;let a,i,o;return n&&Number.isFinite(n)?(a=(i=t.type).indexOf("-"),i=a<0?i:i.slice(a+1),o=v(i)().domain([e,r]).range([0,1]),ii.forEach(e=>t[e]?o[e](t[e]()):0),o):l.constant(.5)},e.scaleImplicit=Ea,e.scheme=oa,e.tickCount=function(e,t,r){let n;return l.isNumber(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),null!=r)&&(t=Math.min(t,Math.floor(l.span(e.domain())/r||1)+1)),l.isObject(t)&&(n=t.step,t=t.interval),t=l.isString(t)&&(t=e.type===A?L.timeInterval(t):e.type==O?L.utcInterval(t):l.error("Only time and utc scales accept interval strings."),n)?t.every(n):t},e.tickFormat=ca,e.tickValues=la,e.validTicks=sa}}return Eu.exports}function Au(){if(!bu){bu=1;var e=mu.exports;{var p=jo(),z=yu(),K=ou(),Y=Su();let o=0;function J(){o=0}const Da="p_";function Z(e){return e&&e.gradient}function Q(e,t,r){var n=e.gradient;let a=e.id,i="radial"===n?Da:"";return a||(a=e.id="gradient_"+o++,"radial"===n?(e.x1=h(e.x1,.5),e.y1=h(e.y1,.5),e.r1=h(e.r1,0),e.x2=h(e.x2,.5),e.y2=h(e.y2,.5),e.r2=h(e.r2,.5),i=Da):(e.x1=h(e.x1,0),e.y1=h(e.y1,0),e.x2=h(e.x2,1),e.y2=h(e.y2,0))),t[a]=e,"url("+(r||"")+"#"+i+a+")"}function h(e,t){return null!=e?e:t}function X(e,t){var r,n=[];return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(e,t){return n.push({offset:e,color:t}),r}}}function T(e){return function(){return e}}const xa=Math.abs,F=Math.atan2,U=Math.cos,La=Math.max,Fa=Math.min,B=Math.sin,j=Math.sqrt,H=1e-12,Ua=Math.PI,Ba=Ua/2,ja=2*Ua;function ee(e){return 1<e?0:e<-1?Ua:Math.acos(e)}function te(e){return 1<=e?Ba:e<=-1?-Ba:Math.asin(e)}const Ha=Math.PI,Ga=2*Ha,Va=Ga-1e-6;function re(r){this._+=r[0];for(let e=1,t=r.length;e<t;++e)this._+=arguments[e]+r[e]}function ne(e){var t=Math.floor(e);if(!(0<=t))throw new Error("invalid digits: "+e);if(15<t)return re;const n=10**t;return function(r){this._+=r[0];for(let e=1,t=r.length;e<t;++e)this._+=Math.round(arguments[e]*n)/n+r[e]}}class Wa{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?re:ne(e)}moveTo(e,t){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,t){this._append`L${this._x1=+e},${this._y1=+t}`}quadraticCurveTo(e,t,r,n){this._append`Q${+e},${+t},${this._x1=+r},${this._y1=+n}`}bezierCurveTo(e,t,r,n,a,i){this._append`C${+e},${+t},${+r},${+n},${this._x1=+a},${this._y1=+i}`}arcTo(e,t,r,n,a){if(e=+e,t=+t,r=+r,n=+n,(a=+a)<0)throw new Error("negative radius: "+a);var i,o,s=this._x1,l=this._y1,c=r-e,u=n-t,d=s-e,f=l-t,p=d*d+f*f;null===this._x1?this._append`M${this._x1=e},${this._y1=t}`:1e-6<p&&(1e-6<Math.abs(f*c-u*d)&&a?(o=c*c+u*u,n=(r=r-s)*r+(s=n-l)*s,l=Math.sqrt(o),i=Math.sqrt(p),p=(o=a*Math.tan((Ha-Math.acos((o+p-n)/(2*l*i)))/2))/i,n=o/l,1e-6<Math.abs(p-1)&&this._append`L${e+p*d},${t+p*f}`,this._append`A${a},${a},0,0,${+(d*s<f*r)},${this._x1=e+n*c},${this._y1=t+n*u}`):this._append`L${this._x1=e},${this._y1=t}`)}arc(e,t,r,n,a,i){if(e=+e,t=+t,i=!!i,(r=+r)<0)throw new Error("negative radius: "+r);let o=r*Math.cos(n),s=r*Math.sin(n),l=e+o,c=t+s,u=1^i,d=i?n-a:a-n;null===this._x1?this._append`M${l},${c}`:(1e-6<Math.abs(this._x1-l)||1e-6<Math.abs(this._y1-c))&&this._append`L${l},${c}`,r&&((d=d<0?d%Ga+Ga:d)>Va?this._append`A${r},${r},0,1,${u},${e-o},${t-s}A${r},${r},0,1,${u},${this._x1=l},${this._y1=c}`:1e-6<d&&this._append`A${r},${r},0,${+(d>=Ha)},${u},${this._x1=e+r*Math.cos(a)},${this._y1=t+r*Math.sin(a)}`)}rect(e,t,r,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${r=+r}v${+n}h${-r}Z`}toString(){return this._}}function ae(){return new Wa}function ie(r){let n=3;return r.digits=function(e){if(!arguments.length)return n;if(null==e)n=null;else{var t=Math.floor(e);if(!(0<=t))throw new RangeError("invalid digits: "+e);n=t}return r},()=>new Wa(n)}function oe(e){return e.innerRadius}function se(e){return e.outerRadius}function le(e){return e.startAngle}function ce(e){return e.endAngle}function ue(e){return e&&e.padAngle}function de(e,t,r,n,a,i,o,s){var r=r-e,n=n-t,o=o-a,s=s-i,l=s*r-o*n;if(!(l*l<H))return[e+(l=(o*(t-i)-s*(e-a))/l)*r,t+l*n]}function fe(e,t,r,n,a,i,o){var s=e-r,l=t-n,o=(o?i:-i)/j(s*s+l*l),l=o*l,o=-o*s,s=e+l,e=t+o,t=r+l,r=n+o,n=(s+t)/2,c=(e+r)/2,u=t-s,d=r-e,f=u*u+d*d,i=a-i,s=s*r-t*e,r=(d<0?-1:1)*j(La(0,i*i*f-s*s)),t=(s*d-u*r)/f,e=(-s*u-d*r)/f,p=(s*d+u*r)/f,s=(-s*u+d*r)/f,u=t-n,d=e-c,r=p-n,f=s-c;return r*r+f*f<u*u+d*d&&(t=p,e=s),{cx:t,cy:e,x01:-l,y01:-o,x11:t*(a/i-1),y11:e*(a/i-1)}}function pe(){var w=oe,R=se,I=T(0),M=null,P=le,N=ce,D=ue,x=null,L=ie(t);function t(){var e,t,r,n,a,i,o,s,l,c,u,d,f,p,h,g,m,_,y,T,b,v,E=+w.apply(this,arguments),S=+R.apply(this,arguments),A=P.apply(this,arguments)-Ba,O=N.apply(this,arguments)-Ba,C=xa(O-A),k=A<O;if(x=x||(e=L()),S<E&&(t=S,S=E,E=t),S>H?C>ja-H?(x.moveTo(S*U(A),S*B(A)),x.arc(0,0,S,A,O,!k),E>H&&(x.moveTo(E*U(O),E*B(O)),x.arc(0,0,E,O,A,k))):(n=t=A,a=r=O,o=i=C,f=(u=D.apply(this,arguments)/2)>H&&(M?+M.apply(this,arguments):j(E*E+S*S)),v=b=s=Fa(xa(S-E)/2,+I.apply(this,arguments)),f>H&&(d=te(f/E*B(u)),f=te(f/S*B(u)),(i-=2*d)>H?(n+=d*=k?1:-1,a-=d):(i=0,n=a=(A+O)/2),(o-=2*f)>H?(t+=f*=k?1:-1,r-=f):(o=0,t=r=(A+O)/2)),u=S*U(t),d=S*B(t),f=E*U(a),A=E*B(a),s>H&&(p=S*U(r),h=S*B(r),g=E*U(n),m=E*B(n),C<Ua)&&((O=de(u,d,g,m,p,h,f,A))?(C=u-O[0],T=d-O[1],_=p-O[0],y=h-O[1],C=1/B(ee((C*_+T*y)/(j(C*C+T*T)*j(_*_+y*y)))/2),T=j(O[0]*O[0]+O[1]*O[1]),b=Fa(s,(E-T)/(C-1)),v=Fa(s,(S-T)/(1+C))):b=v=0),o>H?v>H?(l=fe(g,m,u,d,S,v,k),c=fe(p,h,f,A,S,v,k),x.moveTo(l.cx+l.x01,l.cy+l.y01),v<s?x.arc(l.cx,l.cy,v,F(l.y01,l.x01),F(c.y01,c.x01),!k):(x.arc(l.cx,l.cy,v,F(l.y01,l.x01),F(l.y11,l.x11),!k),x.arc(0,0,S,F(l.cy+l.y11,l.cx+l.x11),F(c.cy+c.y11,c.cx+c.x11),!k),x.arc(c.cx,c.cy,v,F(c.y11,c.x11),F(c.y01,c.x01),!k))):(x.moveTo(u,d),x.arc(0,0,S,t,r,!k)):x.moveTo(u,d),E>H&&i>H?b>H?(l=fe(f,A,p,h,E,-b,k),c=fe(u,d,g,m,E,-b,k),x.lineTo(l.cx+l.x01,l.cy+l.y01),b<s?x.arc(l.cx,l.cy,b,F(l.y01,l.x01),F(c.y01,c.x01),!k):(x.arc(l.cx,l.cy,b,F(l.y01,l.x01),F(l.y11,l.x11),!k),x.arc(0,0,E,F(l.cy+l.y11,l.cx+l.x11),F(c.cy+c.y11,c.cx+c.x11),k),x.arc(c.cx,c.cy,b,F(c.y11,c.x11),F(c.y01,c.x01),!k))):x.arc(0,0,E,a,n,k):x.lineTo(f,A)):x.moveTo(0,0),x.closePath(),e)return x=null,e+""||null}return t.centroid=function(){var e=(+w.apply(this,arguments)+ +R.apply(this,arguments))/2,t=(+P.apply(this,arguments)+ +N.apply(this,arguments))/2-Ua/2;return[U(t)*e,B(t)*e]},t.innerRadius=function(e){return arguments.length?(w="function"==typeof e?e:T(+e),t):w},t.outerRadius=function(e){return arguments.length?(R="function"==typeof e?e:T(+e),t):R},t.cornerRadius=function(e){return arguments.length?(I="function"==typeof e?e:T(+e),t):I},t.padRadius=function(e){return arguments.length?(M=null==e?null:"function"==typeof e?e:T(+e),t):M},t.startAngle=function(e){return arguments.length?(P="function"==typeof e?e:T(+e),t):P},t.endAngle=function(e){return arguments.length?(N="function"==typeof e?e:T(+e),t):N},t.padAngle=function(e){return arguments.length?(D="function"==typeof e?e:T(+e),t):D},t.context=function(e){return arguments.length?(x=null==e?null:e,t):x},t}function he(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function ge(e){this._context=e}function me(e){return new ge(e)}function _e(e){return e[0]}function ye(e){return e[1]}function Te(o,s){var l=T(!0),c=null,u=me,d=null,f=ie(t);function t(e){var t,r,n,a=(e=he(e)).length,i=!1;for(null==c&&(d=u(n=f())),t=0;t<=a;++t)!(t<a&&l(r=e[t],t,e))===i&&((i=!i)?d.lineStart():d.lineEnd()),i&&d.point(+o(r,t,e),+s(r,t,e));if(n)return d=null,n+""||null}return o="function"==typeof o?o:void 0===o?_e:T(o),s="function"==typeof s?s:void 0===s?ye:T(s),t.x=function(e){return arguments.length?(o="function"==typeof e?e:T(+e),t):o},t.y=function(e){return arguments.length?(s="function"==typeof e?e:T(+e),t):s},t.defined=function(e){return arguments.length?(l="function"==typeof e?e:T(!!e),t):l},t.curve=function(e){return arguments.length?(u=e,null!=c&&(d=u(c)),t):u},t.context=function(e){return arguments.length?(null==e?c=d=null:d=u(c=e),t):c},t}function be(u,d,f){var p=null,h=T(!0),g=null,m=me,_=null,y=ie(t);function t(e){var t,r,n,a,i,o=(e=he(e)).length,s=!1,l=new Array(o),c=new Array(o);for(null==g&&(_=m(i=y())),t=0;t<=o;++t){if(!(t<o&&h(a=e[t],t,e))===s)if(s=!s)r=t,_.areaStart(),_.lineStart();else{for(_.lineEnd(),_.lineStart(),n=t-1;r<=n;--n)_.point(l[n],c[n]);_.lineEnd(),_.areaEnd()}s&&(l[t]=+u(a,t,e),c[t]=+d(a,t,e),_.point(p?+p(a,t,e):l[t],f?+f(a,t,e):c[t]))}if(i)return _=null,i+""||null}function e(){return Te().defined(h).curve(m).context(g)}return u="function"==typeof u?u:void 0===u?_e:T(+u),d="function"==typeof d?d:T(void 0===d?0:+d),f="function"==typeof f?f:void 0===f?ye:T(+f),t.x=function(e){return arguments.length?(u="function"==typeof e?e:T(+e),p=null,t):u},t.x0=function(e){return arguments.length?(u="function"==typeof e?e:T(+e),t):u},t.x1=function(e){return arguments.length?(p=null==e?null:"function"==typeof e?e:T(+e),t):p},t.y=function(e){return arguments.length?(d="function"==typeof e?e:T(+e),f=null,t):d},t.y0=function(e){return arguments.length?(d="function"==typeof e?e:T(+e),t):d},t.y1=function(e){return arguments.length?(f=null==e?null:"function"==typeof e?e:T(+e),t):f},t.lineX0=t.lineY0=function(){return e().x(u).y(d)},t.lineY1=function(){return e().x(u).y(f)},t.lineX1=function(){return e().x(p).y(d)},t.defined=function(e){return arguments.length?(h="function"==typeof e?e:T(!!e),t):h},t.curve=function(e){return arguments.length?(m=e,null!=g&&(_=m(g)),t):m},t.context=function(e){return arguments.length?(null==e?g=_=null:_=m(g=e),t):g},t}ae.prototype=Wa.prototype,ge.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};var ve={draw(e,t){t=j(t/Ua);e.moveTo(t,0),e.arc(0,0,t,0,ja)}};function Ee(t,r){let n=null,a=ie(i);function i(){let e;if(n=n||(e=a()),t.apply(this,arguments).draw(n,+r.apply(this,arguments)),e)return n=null,e+""||null}return t="function"==typeof t?t:T(t||ve),r="function"==typeof r?r:T(void 0===r?64:+r),i.type=function(e){return arguments.length?(t="function"==typeof e?e:T(e),i):t},i.size=function(e){return arguments.length?(r="function"==typeof e?e:T(+e),i):r},i.context=function(e){return arguments.length?(n=null==e?null:e,i):n},i}function t(){}function Se(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function Ae(e){this._context=e}function Oe(e){return new Ae(e)}function Ce(e){this._context=e}function ke(e){return new Ce(e)}function we(e){this._context=e}function Re(e){return new we(e)}function Ie(e,t){this._basis=new Ae(e),this._beta=t}Ae.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Se(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Se(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},Ce.prototype={areaStart:t,areaEnd:t,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Se(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},we.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:Se(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},Ie.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,r=e.length-1;if(0<r)for(var n,a=e[0],i=t[0],o=e[r]-a,s=t[r]-i,l=-1;++l<=r;)this._basis.point(this._beta*e[l]+(1-this._beta)*(a+(n=l/r)*o),this._beta*t[l]+(1-this._beta)*(i+n*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var Me=function t(r){function e(e){return 1===r?new Ae(e):new Ie(e,r)}return e.beta=function(e){return t(+e)},e}(.85);function Pe(e,t,r){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-r),e._x2,e._y2)}function Ne(e,t){this._context=e,this._k=(1-t)/6}Ne.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Pe(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:Pe(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var De=function t(r){function e(e){return new Ne(e,r)}return e.tension=function(e){return t(+e)},e}(0);function xe(e,t){this._context=e,this._k=(1-t)/6}xe.prototype={areaStart:t,areaEnd:t,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Pe(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Le=function t(r){function e(e){return new xe(e,r)}return e.tension=function(e){return t(+e)},e}(0);function Fe(e,t){this._context=e,this._k=(1-t)/6}Fe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Pe(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Ue=function t(r){function e(e){return new Fe(e,r)}return e.tension=function(e){return t(+e)},e}(0);function Be(e,t,r){var n,a,i=e._x1,o=e._y1,s=e._x2,l=e._y2;e._l01_a>H&&(n=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,a=3*e._l01_a*(e._l01_a+e._l12_a),i=(i*n-e._x0*e._l12_2a+e._x2*e._l01_2a)/a,o=(o*n-e._y0*e._l12_2a+e._y2*e._l01_2a)/a),e._l23_a>H&&(n=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,a=3*e._l23_a*(e._l23_a+e._l12_a),s=(s*n+e._x1*e._l23_2a-t*e._l12_2a)/a,l=(l*n+e._y1*e._l23_2a-r*e._l12_2a)/a),e._context.bezierCurveTo(i,o,s,l,e._x2,e._y2)}function je(e,t){this._context=e,this._alpha=t}je.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r,n;switch(e=+e,t=+t,this._point&&(r=this._x2-e,n=this._y2-t,this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+n*n,this._alpha))),this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Be(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var He=function t(r){function e(e){return r?new je(e,r):new Ne(e,0)}return e.alpha=function(e){return t(+e)},e}(.5);function Ge(e,t){this._context=e,this._alpha=t}Ge.prototype={areaStart:t,areaEnd:t,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){var r,n;switch(e=+e,t=+t,this._point&&(r=this._x2-e,n=this._y2-t,this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+n*n,this._alpha))),this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Be(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Ve=function t(r){function e(e){return r?new Ge(e,r):new xe(e,0)}return e.alpha=function(e){return t(+e)},e}(.5);function We(e,t){this._context=e,this._alpha=t}We.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r,n;switch(e=+e,t=+t,this._point&&(r=this._x2-e,n=this._y2-t,this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+n*n,this._alpha))),this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Be(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var qe=function t(r){function e(e){return r?new We(e,r):new Fe(e,0)}return e.alpha=function(e){return t(+e)},e}(.5);function $e(e){this._context=e}function ze(e){return new $e(e)}function Ke(e){return e<0?-1:1}function Ye(e,t,r){var n=e._x1-e._x0,t=t-e._x1,a=(e._y1-e._y0)/(n||t<0&&-0),r=(r-e._y1)/(t||n<0&&-0),e=(a*t+r*n)/(n+t);return(Ke(a)+Ke(r))*Math.min(Math.abs(a),Math.abs(r),.5*Math.abs(e))||0}function Je(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Ze(e,t,r){var n=e._x0,a=e._y0,i=e._x1,o=e._y1,s=(i-n)/3;e._context.bezierCurveTo(n+s,a+s*t,i-s,o-s*r,i,o)}function Qe(e){this._context=e}function Xe(e){this._context=new et(e)}function et(e){this._context=e}function tt(e){return new Qe(e)}function rt(e){return new Xe(e)}function nt(e){this._context=e}function at(e){var t,r,n=e.length-1,a=new Array(n),i=new Array(n),o=new Array(n);for(i[a[0]=0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)a[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(a[n-1]=2,i[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=a[t]/i[t-1],i[t]-=r,o[t]-=r*o[t-1];for(a[n-1]=o[n-1]/i[n-1],t=n-2;0<=t;--t)a[t]=(o[t]-a[t+1])/i[t];for(i[n-1]=(e[n]+a[n-1])/2,t=0;t<n-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function it(e){return new nt(e)}function ot(e,t){this._context=e,this._t=t}function st(e){return new ot(e,.5)}function lt(e){return new ot(e,0)}function ct(e){return new ot(e,1)}$e.prototype={areaStart:t,areaEnd:t,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},Qe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Ze(this,this._t0,Je(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Ze(this,Je(this,r=Ye(this,e,t)),r);break;default:Ze(this,this._t0,r=Ye(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}},(Xe.prototype=Object.create(Qe.prototype)).point=function(e,t){Qe.prototype.point.call(this,t,e)},et.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}},nt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===r)this._context.lineTo(e[1],t[1]);else for(var n=at(e),a=at(t),i=0,o=1;o<r;++i,++o)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[o],t[o]);(this._line||0!==this._line&&1===r)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},ot.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),0<=this._line&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:var r;this._t<=0?(this._context.lineTo(this._x,t),this._context.lineTo(e,t)):(r=this._x*(1-this._t)+e*this._t,this._context.lineTo(r,this._y),this._context.lineTo(r,t))}this._x=e,this._y=t}};const qa={basis:{curve:Oe},"basis-closed":{curve:ke},"basis-open":{curve:Re},bundle:{curve:Me,tension:"beta",value:.85},cardinal:{curve:De,tension:"tension",value:0},"cardinal-open":{curve:Ue,tension:"tension",value:0},"cardinal-closed":{curve:Le,tension:"tension",value:0},"catmull-rom":{curve:He,tension:"alpha",value:.5},"catmull-rom-closed":{curve:Ve,tension:"alpha",value:.5},"catmull-rom-open":{curve:qe,tension:"alpha",value:.5},linear:{curve:me},"linear-closed":{curve:ze},monotone:{horizontal:rt,vertical:tt},natural:{curve:it},step:{curve:st},"step-after":{curve:ct},"step-before":{curve:lt}};function ut(e,t,r){var e=p.hasOwnProperty(qa,e)&&qa[e],n=null;return n=e&&(n=e.curve||e[t||"vertical"],e.tension)&&null!=r?n[e.tension](r):n}const $a={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},za=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,Ka=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,Ya=/^((\s+,?\s*)|(,\s*))/,Ja=/^[01]/;function dt(e){const o=[];return(e.match(za)||[]).forEach(e=>{let t=e[0];var r=t.toLowerCase(),n=$a[r],a=ft(r,n,e.slice(1).trim()),i=a.length;if(i<n||i&&i%n!=0)throw Error("Invalid SVG path, incorrect parameter count");if(o.push([t,...a.slice(0,n)]),i!==n){"m"===r&&(t="M"===t?"L":"l");for(let e=n;e<i;e+=n)o.push([t,...a.slice(e,e+n)])}}),o}function ft(r,n,a){var i=[];for(let t=0;n&&t<a.length;)for(let e=0;e<n;++e){var o="a"!==r||3!==e&&4!==e?Ka:Ja,o=a.slice(t).match(o);if(null===o)throw Error("Invalid SVG path, incorrect parameter type");t+=o[0].length,i.push(+o[0]);o=a.slice(t).match(Ya);null!==o&&(t+=o[0].length)}return i}const M=Math.PI/180,Za=1e-14,P=Math.PI/2,N=2*Math.PI,Qa=Math.sqrt(3)/2;var pt={},ht={},gt=[].join;function mt(e,t,r,n,a,i,o,s,l){var c=gt.call(arguments);if(pt[c])return pt[c];var o=o*M,u=Math.sin(o),d=Math.cos(o),o=d*(s-e)*.5+u*(l-t)*.5,f=d*(l-t)*.5-u*(s-e)*.5,o=o*o/((r=Math.abs(r))*r)+f*f/((n=Math.abs(n))*n),f=(1<o&&(r*=o=Math.sqrt(o),n*=o),d/r),o=u/r,p=-u/n,h=d/n,g=f*s+o*l,s=p*s+h*l,l=f*e+o*t,f=p*e+h*t;let m=1/((l-g)*(l-g)+(f-s)*(f-s))-.25,_=(m<0&&(m=0),Math.sqrt(m));var y=.5*(g+l)-(_=i==a?-_:_)*(f-s),T=.5*(s+f)+_*(l-g),b=Math.atan2(s-T,g-y);let v=Math.atan2(f-T,l-y)-b;v<0&&1===i?v+=N:0<v&&0===i&&(v-=N);var E=Math.ceil(Math.abs(v/(P+.001))),S=[];for(let e=0;e<E;++e){var A=b+e*v/E,O=b+(e+1)*v/E;S[e]=[y,T,A,O,r,n,u,d]}return pt[c]=S}function _t(e){var t,r,n,a,i,o,s,l,c,u,d,f=gt.call(e);return ht[f]||(t=e[0],r=e[1],c=e[2],d=e[3],o=e[4],u=e[5],i=e[6],n=(e=e[7])*o,a=-i*u,i=i*o,o=e*u,e=Math.cos(c),u=Math.sin(c),s=Math.cos(d),l=Math.sin(d),d=.5*(d-c),c=8/3*(c=Math.sin(.5*d))*c/Math.sin(d),ht[f]=[n*(d=t+e-c*u)+a*(f=r+u+c*e),i*d+o*f,n*(e=(u=t+s)+c*l)+a*(f=(d=r+l)-c*s),i*e+o*f,n*u+a*d,i*u+o*d])}const D=["l",0,0,0,0,0,0,0];function yt(e,t,r){var n=D[0]=e[0];if("a"===n||"A"===n)D[1]=t*e[1],D[2]=r*e[2],D[3]=e[3],D[4]=e[4],D[5]=e[5],D[6]=t*e[6],D[7]=r*e[7];else if("h"===n||"H"===n)D[1]=t*e[1];else if("v"===n||"V"===n)D[1]=r*e[1];else for(var a=1,i=e.length;a<i;++a)D[a]=(a%2==1?t:r)*e[a];return D}function Tt(e,t,r,n,a,i){var o,s,l,c,u,d=null,f=0,p=0,h=0,g=0,m=0,_=0;null==r&&(r=0),null==n&&(n=0),null==a&&(a=1),null==i&&(i=a),e.beginPath&&e.beginPath();for(var y=0,T=t.length;y<T;++y){switch(o=t[y],(o=1===a&&1===i?o:yt(o,a,i))[0]){case"l":f+=o[1],p+=o[2],e.lineTo(f+r,p+n);break;case"L":f=o[1],p=o[2],e.lineTo(f+r,p+n);break;case"h":f+=o[1],e.lineTo(f+r,p+n);break;case"H":f=o[1],e.lineTo(f+r,p+n);break;case"v":p+=o[1],e.lineTo(f+r,p+n);break;case"V":p=o[1],e.lineTo(f+r,p+n);break;case"m":m=f+=o[1],_=p+=o[2],e.moveTo(f+r,p+n);break;case"M":m=f=o[1],_=p=o[2],e.moveTo(f+r,p+n);break;case"c":s=f+o[5],l=p+o[6],h=f+o[3],g=p+o[4],e.bezierCurveTo(f+o[1]+r,p+o[2]+n,h+r,g+n,s+r,l+n),f=s,p=l;break;case"C":f=o[5],p=o[6],h=o[3],g=o[4],e.bezierCurveTo(o[1]+r,o[2]+n,h+r,g+n,f+r,p+n);break;case"s":s=f+o[3],l=p+o[4],e.bezierCurveTo((h=2*f-h)+r,(g=2*p-g)+n,f+o[1]+r,p+o[2]+n,s+r,l+n),h=f+o[1],g=p+o[2],f=s,p=l;break;case"S":s=o[3],l=o[4],e.bezierCurveTo((h=2*f-h)+r,(g=2*p-g)+n,o[1]+r,o[2]+n,s+r,l+n),f=s,p=l,h=o[1],g=o[2];break;case"q":s=f+o[3],l=p+o[4],h=f+o[1],g=p+o[2],e.quadraticCurveTo(h+r,g+n,s+r,l+n),f=s,p=l;break;case"Q":s=o[3],l=o[4],e.quadraticCurveTo(o[1]+r,o[2]+n,s+r,l+n),f=s,p=l,h=o[1],g=o[2];break;case"t":s=f+o[1],l=p+o[2],null===d[0].match(/[QqTt]/)?(h=f,g=p):"t"===d[0]?(h=2*f-c,g=2*p-u):"q"===d[0]&&(h=2*f-h,g=2*p-g),c=h,u=g,e.quadraticCurveTo(h+r,g+n,s+r,l+n),p=l,h=(f=s)+o[1],g=p+o[2];break;case"T":s=o[1],l=o[2],e.quadraticCurveTo((h=2*f-h)+r,(g=2*p-g)+n,s+r,l+n),f=s,p=l;break;case"a":bt(e,f+r,p+n,[o[1],o[2],o[3],o[4],o[5],o[6]+f+r,o[7]+p+n]),f+=o[6],p+=o[7];break;case"A":bt(e,f+r,p+n,[o[1],o[2],o[3],o[4],o[5],o[6]+r,o[7]+n]),f=o[6],p=o[7];break;case"z":case"Z":f=m,p=_,e.closePath()}d=o}}function bt(t,e,r,n){var a=mt(n[5],n[6],n[0],n[1],n[3],n[4],n[2],e,r);for(let e=0;e<a.length;++e){var i=_t(a[e]);t.bezierCurveTo(i[0],i[1],i[2],i[3],i[4],i[5])}}const Xa=.5773502691896257,ei={circle:{draw:function(e,t){t=Math.sqrt(t)/2;e.moveTo(t,0),e.arc(0,0,t,0,N)}},cross:{draw:function(e,t){var t=Math.sqrt(t)/2,r=t/2.5;e.moveTo(-t,-r),e.lineTo(-t,r),e.lineTo(-r,r),e.lineTo(-r,t),e.lineTo(r,t),e.lineTo(r,r),e.lineTo(t,r),e.lineTo(t,-r),e.lineTo(r,-r),e.lineTo(r,-t),e.lineTo(-r,-t),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){t=Math.sqrt(t)/2;e.moveTo(-t,0),e.lineTo(0,-t),e.lineTo(t,0),e.lineTo(0,t),e.closePath()}},square:{draw:function(e,t){var t=Math.sqrt(t),r=-t/2;e.rect(r,r,t,t)}},arrow:{draw:function(e,t){var t=Math.sqrt(t)/2,r=t/7,n=t/2.5,a=t/8;e.moveTo(-r,t),e.lineTo(r,t),e.lineTo(r,-a),e.lineTo(n,-a),e.lineTo(0,-t),e.lineTo(-n,-a),e.lineTo(-r,-a),e.closePath()}},wedge:{draw:function(e,t){var t=Math.sqrt(t)/2,r=Qa*t,n=r-t*Xa,t=t/4;e.moveTo(0,-r-n),e.lineTo(-t,r-n),e.lineTo(t,r-n),e.closePath()}},triangle:{draw:function(e,t){var t=Math.sqrt(t)/2,r=Qa*t,n=r-t*Xa;e.moveTo(0,-r-n),e.lineTo(-t,r-n),e.lineTo(t,r-n),e.closePath()}},"triangle-up":{draw:function(e,t){var t=Math.sqrt(t)/2,r=Qa*t;e.moveTo(0,-r),e.lineTo(-t,r),e.lineTo(t,r),e.closePath()}},"triangle-down":{draw:function(e,t){var t=Math.sqrt(t)/2,r=Qa*t;e.moveTo(0,r),e.lineTo(-t,-r),e.lineTo(t,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var t=Math.sqrt(t)/2,r=Qa*t;e.moveTo(r,0),e.lineTo(-r,-t),e.lineTo(-r,t),e.closePath()}},"triangle-left":{draw:function(e,t){var t=Math.sqrt(t)/2,r=Qa*t;e.moveTo(-r,0),e.lineTo(r,-t),e.lineTo(r,t),e.closePath()}},stroke:{draw:function(e,t){t=Math.sqrt(t)/2;e.moveTo(-t,0),e.lineTo(t,0)}}};function vt(e){return p.hasOwnProperty(ei,e)?ei[e]:St(e)}var Et={};function St(e){if(!p.hasOwnProperty(Et,e)){const r=dt(e);Et[e]={draw:function(e,t){Tt(e,r,0,0,Math.sqrt(t)/2)}}}return Et[e]}const x=.448084975506;function At(e){return e.x}function Ot(e){return e.y}function Ct(e){return e.width}function kt(e){return e.height}function b(e){return"function"==typeof e?e:()=>+e}function wt(e,t,r){return Math.max(t,Math.min(e,r))}function Rt(){var u=At,d=Ot,f=Ct,p=kt,h=b(0),g=h,m=h,_=h,y=null;function a(e,t,r){var n,t=null!=t?t:+u.call(this,e),r=null!=r?r:+d.call(this,e),a=+f.call(this,e),i=+p.call(this,e),o=Math.min(a,i)/2,s=wt(+h.call(this,e),0,o),l=wt(+g.call(this,e),0,o),c=wt(+m.call(this,e),0,o),e=wt(+_.call(this,e),0,o);if(y=y||(n=ae()),s<=0&&l<=0&&c<=0&&e<=0?y.rect(t,r,a,i):(o=t+a,a=r+i,y.moveTo(t+s,r),y.lineTo(o-l,r),y.bezierCurveTo(o-x*l,r,o,r+x*l,o,r+l),y.lineTo(o,a-e),y.bezierCurveTo(o,a-x*e,o-x*e,a,o-e,a),y.lineTo(t+c,a),y.bezierCurveTo(t+x*c,a,t,a-x*c,t,a-c),y.lineTo(t,r+s),y.bezierCurveTo(t,r+x*s,t+x*s,r,t+s,r),y.closePath()),n)return y=null,n+""||null}return a.x=function(e){return arguments.length?(u=b(e),a):u},a.y=function(e){return arguments.length?(d=b(e),a):d},a.width=function(e){return arguments.length?(f=b(e),a):f},a.height=function(e){return arguments.length?(p=b(e),a):p},a.cornerRadius=function(e,t,r,n){return arguments.length?(h=b(e),g=null!=t?b(t):h,_=null!=r?b(r):h,m=null!=n?b(n):g,a):h},a.context=function(e){return arguments.length?(y=null==e?null:e,a):y},a}function It(){var h,g,m,_,y,T,b,v,E=null;function t(e){var t,r,n,a,i,o,s,l,c,u,d,f=e.length,p=!1;for(null==E&&(E=n=ae()),t=0;t<=f;++t)!(t<f&&_(r=e[t],t,e))===p&&(p=!p)&&(y=0),p&&(a=+h(r,t,e),i=+g(r,t,e),o=+m(r,t,e),d=u=c=l=s=void 0,o/=2,y?(l=a-T,(s=b-i)||l?(c=(s/=u=Math.hypot(s,l))*v,u=(l/=u)*v,d=Math.atan2(l,s),E.moveTo(T-c,b-u),E.lineTo(a-s*o,i-l*o),E.arc(a,i,o,d-Math.PI,d),E.lineTo(T+c,b+u),E.arc(T,b,v,d,d+Math.PI)):E.arc(a,i,o,0,N),E.closePath()):y=1,T=a,b=i,v=o);if(n)return E=null,n+""||null}return t.x=function(e){return arguments.length?(h=e,t):h},t.y=function(e){return arguments.length?(g=e,t):g},t.size=function(e){return arguments.length?(m=e,t):m},t.defined=function(e){return arguments.length?(_=e,t):_},t.context=function(e){return arguments.length?(E=null==e?null:e,t):E},t}function Mt(e,t){return null!=e?e:t}const ti=e=>e.x||0,ri=e=>e.y||0,ni=e=>e.width||0,ai=e=>e.height||0,ii=e=>(e.x||0)+(e.width||0),oi=e=>(e.y||0)+(e.height||0),si=e=>e.startAngle||0,li=e=>e.endAngle||0,ci=e=>e.padAngle||0,ui=e=>e.innerRadius||0,di=e=>e.outerRadius||0,fi=e=>e.cornerRadius||0,pi=e=>Mt(e.cornerRadiusTopLeft,e.cornerRadius)||0,hi=e=>Mt(e.cornerRadiusTopRight,e.cornerRadius)||0,gi=e=>Mt(e.cornerRadiusBottomRight,e.cornerRadius)||0,mi=e=>Mt(e.cornerRadiusBottomLeft,e.cornerRadius)||0,_i=e=>Mt(e.size,64),yi=e=>e.size||1,Ti=e=>!(!1===e.defined),bi=e=>vt(e.shape||"circle"),vi=pe().startAngle(si).endAngle(li).padAngle(ci).innerRadius(ui).outerRadius(di).cornerRadius(fi),Ei=be().x(ti).y1(ri).y0(oi).defined(Ti),Si=be().y(ri).x1(ti).x0(ii).defined(Ti),Ai=Te().x(ti).y(ri).defined(Ti),Oi=Rt().x(ti).y(ri).width(ni).height(ai).cornerRadius(pi,hi,gi,mi),Ci=Ee().type(bi).size(_i),ki=It().x(ti).y(ri).defined(Ti).size(yi);function Pt(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function Nt(e,t){return vi.context(e)(t)}function Dt(e,t){var r=t[0],n=r.interpolate||"linear";return("horizontal"===r.orient?Si:Ei).curve(ut(n,r.orient,r.tension)).context(e)(t)}function xt(e,t){var r=t[0],n=r.interpolate||"linear";return Ai.curve(ut(n,r.orient,r.tension)).context(e)(t)}function Lt(e,t,r,n){return Oi.context(e)(t,r,n)}function Ft(e,t){return(t.mark.shape||t.shape).context(e)(t)}function Ut(e,t){return Ci.context(e)(t)}function Bt(e,t){return ki.context(e)(t)}var jt=1;function Ht(){jt=1}function Gt(e,t,r){var n=t.clip,e=e._defs,t=t.clip_id||(t.clip_id="clip"+jt++),e=e.clipping[t]||(e.clipping[t]={id:t});return p.isFunction(n)?e.path=n(null):Pt(r)?e.path=Lt(null,r,0,0):(e.width=r.width||0,e.height=r.height||0),"url(#"+t+")"}function g(e){this.clear(),e&&this.union(e)}function Vt(e){this.mark=e,this.bounds=this.bounds||new g}function Wt(e){Vt.call(this,e),this.items=this.items||[]}g.prototype={clone(){return new g(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,r,n){return r<e?(this.x2=e,this.x1=r):(this.x1=e,this.x2=r),n<t?(this.y2=t,this.y1=n):(this.y1=t,this.y2=n),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,r){e=this.rotatedPoints(e,t,r);return this.clear().add(e[0],e[1]).add(e[2],e[3]).add(e[4],e[5]).add(e[6],e[7])},rotatedPoints(e,t,r){var{x1:n,y1:a,x2:i,y2:o}=this,s=Math.cos(e),e=Math.sin(e),l=t-t*s+r*e,t=r-t*e-r*s;return[s*n-e*a+l,e*n+s*a+t,s*n-e*o+l,e*n+s*o+t,s*i-e*a+l,e*i+s*a+t,s*i-e*o+l,e*i+s*o+t]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},p.inherits(Wt,Vt);class wi{constructor(e){this._pending=0,this._loader=e||K.loader()}pending(){return this._pending}sanitizeURL(e){const t=this;return qt(t),t._loader.sanitize(e,{context:"href"}).then(e=>($t(t),e)).catch(()=>($t(t),null))}loadImage(e){const n=this,a=z.image();return qt(n),n._loader.sanitize(e,{context:"image"}).then(e=>{var t,r=e.href;if(r&&a)return t=new a,null!=(e=p.hasOwnProperty(e,"crossOrigin")?e.crossOrigin:"anonymous")&&(t.crossOrigin=e),t.onload=()=>$t(n),t.onerror=()=>$t(n),t.src=r,t;throw{url:r}}).catch(e=>($t(n),{complete:!1,width:0,height:0,src:e&&e.url||""}))}ready(){const n=this;return new Promise(r=>{!function e(t){n.pending()?setTimeout(()=>{e(!0)},10):r(t)}(!1)})}}function qt(e){e._pending+=1}function $t(e){--e._pending}function zt(e,t,r){var n;return t.stroke&&0!==t.opacity&&0!==t.strokeOpacity&&(n=null!=t.strokeWidth?+t.strokeWidth:1,e.expand(n+(r?Kt(t,n):0))),e}function Kt(e,t){return e.strokeJoin&&"miter"!==e.strokeJoin?0:t}const Ri=N-1e-8;let r,c,u,d,n,a,i,s;const L=(e,t)=>r.add(e,t),Ii=(e,t)=>L(c=e,u=t),Mi=e=>L(e,r.y1),Pi=e=>L(r.x1,e),G=(e,t)=>n*e+i*t,V=(e,t)=>a*e+s*t,Ni=(e,t)=>L(G(e,t),V(e,t)),Di=(e,t)=>Ii(G(e,t),V(e,t));function Yt(e,t){return r=e,t?(d=t*M,n=s=Math.cos(d),a=Math.sin(d),i=-a):(n=s=1,d=a=i=0),xi}const xi={beginPath(){},closePath(){},moveTo:Di,lineTo:Di,rect(e,t,r,n){(d?(Ni(e+r,t),Ni(e+r,t+n),Ni(e,t+n),Di):(L(e+r,t+n),Ii))(e,t)},quadraticCurveTo(e,t,r,n){var a=G(e,t),e=V(e,t),t=G(r,n),r=V(r,n);Jt(c,a,t,Mi),Jt(u,e,r,Pi),Ii(t,r)},bezierCurveTo(e,t,r,n,a,i){var o=G(e,t),e=V(e,t),t=G(r,n),r=V(r,n),n=G(a,i),a=V(a,i);Zt(c,o,t,n,Mi),Zt(u,e,r,a,Pi),Ii(n,a)},arc(r,n,a,i,o,s){if(i+=d,o+=d,c=a*Math.cos(o)+r,u=a*Math.sin(o)+n,Math.abs(o-i)>Ri)L(r-a,n-a),L(r+a,n+a);else{var l=e=>L(a*Math.cos(e)+r,a*Math.sin(e)+n);let e,t;if(l(i),l(o),o!==i)if((i%=N)<0&&(i+=N),(o%=N)<0&&(o+=N),o<i&&(s=!s,e=i,i=o,o=e),s)for(o-=N,e=i-i%P,t=0;t<4&&e>o;++t,e-=P)l(e);else for(e=i-i%P+P,t=0;t<4&&e<o;++t,e+=P)l(e)}}};function Jt(e,t,r,n){r=(e-t)/(e+r-2*t);0<r&&r<1&&n(e+(t-e)*r)}function Zt(e,t,r,n,a){var i=n-e+3*t-3*r,o=e+r-2*t,s=e-t;let l=0,c=0,u;Math.abs(i)>Za?0<=(u=o*o+s*i)&&(u=Math.sqrt(u),l=(-o+u)/i,c=(-o-u)/i):l=.5*s/o,0<l&&l<1&&a(Qt(l,e,t,r,n)),0<c&&c<1&&a(Qt(c,e,t,r,n))}function Qt(e,t,r,n,a){var i=1-e,o=i*i,s=e*e;return o*i*t+3*o*e*r+3*i*s*n+s*e*a}var m=(m=z.canvas(1,1))?m.getContext("2d"):null;const Li=new g;function Xt(i){return function(e,t){if(!m)return!0;i(m,e),Li.clear().union(e.bounds).intersect(t).round();var{x1:r,y1:e,x2:n,y2:a}=Li;for(let t=e;t<=a;++t)for(let e=r;e<=n;++e)if(m.isPointInPath(e,t))return!0;return!1}}function er(e,t){return t.contains(e.x||0,e.y||0)}function tr(e,t){var r=e.x||0,n=e.y||0,a=e.width||0,e=e.height||0;return t.intersects(Li.set(r,n,r+a,n+e))}function rr(e,t){var r=e.x||0,n=e.y||0;return nr(t,r,n,null!=e.x2?e.x2:r,null!=e.y2?e.y2:n)}function nr(e,t,r,n,a){var{x1:i,y1:o,x2:s,y2:l}=e,c=n-t,u=a-r;let d=0,f=1,p,h,g,m;for(m=0;m<4;++m){if(0===m&&(p=-c,h=-(i-t)),1===m&&(p=c,h=s-t),2===m&&(p=-u,h=-(o-r)),3===m&&(p=u,h=l-r),Math.abs(p)<1e-10&&h<0)return!1;if(g=h/p,p<0){if(g>f)return!1;g>d&&(d=g)}else if(0<p){if(g<d)return!1;g<f&&(f=g)}}return!0}function ar(e,t){e.globalCompositeOperation=t.blend||"source-over"}function _(e,t){return null==e?t:e}function ir(t,r){var n=r.length;for(let e=0;e<n;++e)t.addColorStop(r[e].offset,r[e].color);return t}function or(e,t,r){var n=r.width(),a=r.height();let i;if("radial"===t.gradient)i=e.createRadialGradient(r.x1+_(t.x1,.5)*n,r.y1+_(t.y1,.5)*a,Math.max(n,a)*_(t.r1,0),r.x1+_(t.x2,.5)*n,r.y1+_(t.y2,.5)*a,Math.max(n,a)*_(t.r2,.5));else{var o,s,l=_(t.x1,0),c=_(t.y1,0),u=_(t.x2,1),d=_(t.y2,0);if(l!==u&&c!==d&&n!==a)return(s=(o=z.canvas(Math.ceil(n),Math.ceil(a))).getContext("2d")).scale(n,a),s.fillStyle=ir(s.createLinearGradient(l,c,u,d),t.stops),s.fillRect(0,0,n,a),e.createPattern(o,"no-repeat");i=e.createLinearGradient(r.x1+l*n,r.y1+c*a,r.x1+u*n,r.y1+d*a)}return ir(i,t.stops)}function sr(e,t,r){return Z(r)?or(e,r,t.bounds):r}function lr(e,t,r){return 0<(r*=null==t.fillOpacity?1:t.fillOpacity)&&(e.globalAlpha=r,e.fillStyle=sr(e,t,t.fill),1)}var cr=[];function ur(e,t,r){var n=null!=(n=t.strokeWidth)?n:1;return!(n<=0)&&0<(r*=null==t.strokeOpacity?1:t.strokeOpacity)&&(e.globalAlpha=r,e.strokeStyle=sr(e,t,t.stroke),e.lineWidth=n,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||cr),e.lineDashOffset=t.strokeDashOffset||0),1)}function dr(e,t){return e.zindex-t.zindex||e.index-t.index}function fr(e){if(!e.zdirty)return e.zitems;for(var t,r=e.items,n=[],a=0,i=r.length;a<i;++a)(t=r[a]).index=a,t.zindex&&n.push(t);return e.zdirty=!1,e.zitems=n.sort(dr)}function y(e,t){var r,n,a=e.items;if(a&&a.length){e=fr(e);if(e&&e.length){for(r=0,n=a.length;r<n;++r)a[r].zindex||t(a[r]);a=e}for(r=0,n=a.length;r<n;++r)t(a[r])}}function pr(e,t){var r,n=e.items;if(n&&n.length){for(var a=fr(e),i=(n=a&&a.length?a:n).length;0<=--i;)if(r=t(n[i]))return r;if(n===a)for(i=(n=e.items).length;0<=--i;)if(!n[i].zindex&&(r=t(n[i])))return r}return null}function hr(n){return function(t,e,r){y(e,e=>{r&&!r.intersects(e.bounds)||mr(n,t,e,e)})}}function gr(n){return function(e,t,r){!t.items.length||r&&!r.intersects(t.bounds)||mr(n,e,t.items[0],t.items)}}function mr(e,t,r,n){var a=null==r.opacity?1:r.opacity;0===a||e(t,n)||(ar(t,r),r.fill&&lr(t,r,a)&&t.fill(),r.stroke&&ur(t,r,a)&&t.stroke())}function _r(s){return s=s||p.truthy,function(r,e,n,a,i,o){return n*=r.pixelRatio,a*=r.pixelRatio,pr(e,e=>{var t=e.bounds;return(!t||t.contains(i,o))&&t&&s(r,e,n,a,i,o)?e:void 0})}}function yr(l,c){return function(e,t,r,n){var a,i=Array.isArray(t)?t[0]:t,o=null==c?i.fill:c,s=i.stroke&&e.isPointInStroke;return s&&(a=i.strokeWidth,i=i.strokeCap,e.lineWidth=null!=a?a:1,e.lineCap=null!=i?i:"butt"),!l(e,t)&&(o&&e.isPointInPath(r,n)||s&&e.isPointInStroke(r,n))}}function Tr(e){return _r(yr(e))}function br(e,t){return"translate("+e+","+t+")"}function vr(e){return"rotate("+e+")"}function Er(e,t){return"scale("+e+","+t+")"}function Sr(e){return br(e.x||0,e.y||0)}function Ar(e){return br(e.x||0,e.y||0)+(e.angle?" "+vr(e.angle):"")}function Or(e){return br(e.x||0,e.y||0)+(e.angle?" "+vr(e.angle):"")+(e.scaleX||e.scaleY?" "+Er(e.scaleX||1,e.scaleY||1):"")}function Cr(e,i,t){function r(e,t){var r=t.x||0,n=t.y||0,a=t.angle||0;e.translate(r,n),a&&e.rotate(a*=M),e.beginPath(),i(e,t),a&&e.rotate(-a),e.translate(-r,-n)}return{type:e,tag:"path",nested:!1,attr:function(e,t){e("transform",Ar(t)),e("d",i(null,t))},bound:function(e,t){return i(Yt(e,t.angle),t),zt(e,t).translate(t.x||0,t.y||0)},draw:hr(r),pick:Tr(r),isect:t||Xt(r)}}function kr(e,t){for(var r,n,a="horizontal"===e[0].orient?t[1]:t[0],i="horizontal"===e[0].orient?"y":"x",o=e.length,s=1/0;0<=--o;)!1!==e[o].defined&&(n=Math.abs(e[o][i]-a))<s&&(s=n,r=e[o]);return r}function wr(e,t){for(var r,n=Math.pow(e[0].strokeWidth||1,2),a=e.length;0<=--a;)if(!1!==e[a].defined&&(r=e[a].x-t[0])*r+(r=e[a].y-t[1])*r<n)return e[a];return null}function Rr(e,t){for(var r,n,a=e.length;0<=--a;)if(!1!==e[a].defined&&(r=e[a].x-t[0])*r+(n=e[a].y-t[1])*n<(r=e[a].size||1)*r)return e[a];return null}function Ir(e,r,t){function n(e,t){e.beginPath(),r(e,t)}const s=yr(n);return{type:e,tag:"path",nested:!0,attr:function(e,t){(t=t.mark.items).length&&e("d",r(null,t))},bound:function(e,t){return 0===(t=t.items).length?e:(r(Yt(e),t),zt(e,t[0]))},draw:gr(n),pick:function(e,t,r,n,a,i){var o=t.items,t=t.bounds;return o&&o.length&&(!t||t.contains(a,i))&&(r*=e.pixelRatio,n*=e.pixelRatio,s(e,o,r,n))?o[0]:null},isect:er,tip:t}}function Mr(e,t){var r=t.clip;e.save(),p.isFunction(r)?(e.beginPath(),r(e),e.clip()):Pr(e,t.group)}function Pr(e,t){e.beginPath(),Pt(t)?Lt(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function Nr(e){var t=_(e.strokeWidth,1);return null!=e.strokeOffset?e.strokeOffset:e.stroke&&.5<t&&t<1.5?.5-Math.abs(t-1):0}function Dr(e,t){e("transform",Sr(t))}function xr(e,t){var r=Nr(t);e("d",Lt(null,t,r,r))}function Lr(e,t){e("class","background"),e("aria-hidden",!0),xr(e,t)}function Fr(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?xr(e,t):e("d","")}function Ur(e,t,r){e("clip-path",t.clip?Gt(r,t,t):null)}function Br(t,e){if(!e.clip&&e.items){var r=e.items,n=r.length;for(let e=0;e<n;++e)t.union(r[e].bounds)}return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),zt(t,e),t.translate(e.x||0,e.y||0)}function jr(e,t,r,n){var a=Nr(t);e.beginPath(),Lt(e,t,(r||0)+a,(n||0)+a)}Me=Cr("arc",Nt),De=Ir("area",Dt,kr);const Fi=yr(jr),Ui=yr(jr,!1),Bi=yr(jr,!0);function Hr(i,e,o,s){y(e,e=>{var t=e.x||0,r=e.y||0,n=e.strokeForeground,a=null==e.opacity?1:e.opacity;(e.stroke||e.fill)&&a&&(jr(i,e,t,r),ar(i,e),e.fill&&lr(i,e,a)&&i.fill(),e.stroke)&&!n&&ur(i,e,a)&&i.stroke(),i.save(),i.translate(t,r),e.clip&&Pr(i,e),o&&o.translate(-t,-r),y(e,e=>{"group"!==e.marktype&&null!=s&&!s.includes(e.marktype)||this.draw(i,e,o,s)}),o&&o.translate(t,r),i.restore(),n&&e.stroke&&a&&(jr(i,e,t,r),ar(i,e),ur(i,e,a))&&i.stroke()})}function Gr(s,l,c,u,d,f){if(l.bounds&&!l.bounds.contains(d,f)||!l.items)return null;const p=c*s.pixelRatio,h=u*s.pixelRatio;return pr(l,e=>{let t,r,n;var a=e.bounds;if(!a||a.contains(d,f)){r=e.x||0,n=e.y||0;var a=r+(e.width||0),i=n+(e.height||0),o=e.clip;if(!o||!(d<r||a<d||f<n||i<f))return s.save(),s.translate(r,n),r=d-r,n=f-n,o&&Pt(e)&&!Bi(s,e,p,h)?(s.restore(),null):(a=e.strokeForeground,(i=!1!==l.interactive)&&a&&e.stroke&&Ui(s,e,p,h)?(s.restore(),e):(!(t=pr(e,e=>Vr(e,r,n)?this.pick(e,c,u,r,n):null))&&i&&(e.fill||!a&&e.stroke)&&Fi(s,e,p,h)&&(t=e),s.restore(),t||null))}})}function Vr(e,t,r){return(!1!==e.interactive||"group"===e.marktype)&&e.bounds&&e.bounds.contains(t,r)}var Ue={type:"group",tag:"g",nested:!1,attr:Dr,bound:Br,draw:Hr,pick:Gr,isect:tr,content:Ur,background:Lr,foreground:Fr},Wr={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function qr(t,e){var r=t.image;return(!r||t.url&&t.url!==r.url)&&(r={complete:!1,width:0,height:0},e.loadImage(t.url).then(e=>{t.image=e,t.image.url=t.url})),r}function $r(e,t){return null!=e.width?e.width:t&&t.width?!1!==e.aspect&&e.height?e.height*t.width/t.height:t.width:0}function zr(e,t){return null!=e.height?e.height:t&&t.height?!1!==e.aspect&&e.width?e.width*t.height/t.width:t.height:0}function Kr(e,t){return"center"===e?t/2:"right"===e?t:0}function Yr(e,t){return"middle"===e?t/2:"bottom"===e?t:0}function Jr(e,t,r){var r=qr(t,r),n=$r(t,r),a=zr(t,r),i=(t.x||0)-Kr(t.align,n),o=(t.y||0)-Yr(t.baseline,a);e("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",Wr["xmlns:xlink"],"xlink:href"),e("transform",br(i,o)),e("width",n),e("height",a),e("preserveAspectRatio",!1===t.aspect?"none":"xMidYMid")}function Zr(e,t){var r=t.image,n=$r(t,r),r=zr(t,r),a=(t.x||0)-Kr(t.align,n),t=(t.y||0)-Yr(t.baseline,r);return e.set(a,t,a+n,t+r)}function Qr(u,e,t){y(e,l=>{if(!t||t.intersects(l.bounds)){var c=qr(l,this);let o=$r(l,c),s=zr(l,c);if(0!==o&&0!==s){let e=(l.x||0)-Kr(l.align,o),t=(l.y||0)-Yr(l.baseline,s),r,n,a,i;!1!==l.aspect&&(n=c.width/c.height,a=l.width/l.height,n==n)&&a==a&&n!=a&&(a<n?(i=o/n,t+=(s-i)/2,s=i):(i=s*n,e+=(o-i)/2,o=i)),(c.complete||c.toDataURL)&&(ar(u,l),u.globalAlpha=null!=(r=l.opacity)?r:1,u.imageSmoothingEnabled=!1!==l.smooth,u.drawImage(c,e,t,o,s))}}})}function Xr(e,t){var r=t.scaleX||1,n=t.scaleY||1;1===r&&1===n||e("vector-effect","non-scaling-stroke"),e("transform",Or(t)),e("d",t.path)}function en(e,t){var r=t.path;if(null==r)return!0;var n=t.x||0,a=t.y||0,i=t.scaleX||1,o=t.scaleY||1,s=(t.angle||0)*M,l=t.pathCache;l&&l.path===r||((t.pathCache=l=dt(r)).path=r),s&&e.rotate&&e.translate?(e.translate(n,a),e.rotate(s),Tt(e,l,0,0,i,o),e.rotate(-s),e.translate(-n,-a)):Tt(e,l,n,a,i,o)}function tn(e,t){return en(Yt(e,t.angle),t)?e.set(0,0,0,0):zt(e,t,!0)}function rn(e,t){e("d",Lt(null,t))}function nn(e,t){var r;return zt(e.set(e=t.x||0,r=t.y||0,e+t.width||0,r+t.height||0),t)}function an(e,t){e.beginPath(),Lt(e,t)}function on(e,t){e("transform",Sr(t)),e("x2",null!=t.x2?t.x2-(t.x||0):0),e("y2",null!=t.y2?t.y2-(t.y||0):0)}function sn(e,t){var r;return zt(e.set(e=t.x||0,r=t.y||0,null!=t.x2?t.x2:e,null!=t.y2?t.y2:r),t)}function ln(e,t,r){var n,a;return!(!t.stroke||!ur(e,t,r)||(r=t.x||0,n=t.y||0,a=null!=t.x2?t.x2:r,t=null!=t.y2?t.y2:n,e.beginPath(),e.moveTo(r,n),e.lineTo(a,t),0))}function cn(r,e,n){y(e,e=>{var t;n&&!n.intersects(e.bounds)||(t=null==e.opacity?1:e.opacity)&&ln(r,e,t)&&(ar(r,e),r.stroke())})}function un(e,t,r,n){return!!e.isPointInStroke&&ln(e,t,1)&&e.isPointInStroke(r,n)}Le={type:"image",tag:"image",nested:!1,attr:Jr,bound:Zr,draw:Qr,pick:_r(),isect:p.truthy,get:qr,xOffset:Kr,yOffset:Yr},He=Ir("line",xt,wr),Ve={type:"path",tag:"path",nested:!1,attr:Xr,bound:tn,draw:hr(en),pick:Tr(en),isect:Xt(en)};var dn={type:"rule",tag:"line",nested:!(qe={type:"rect",tag:"path",nested:!1,attr:rn,bound:nn,draw:hr(an),pick:Tr(an),isect:tr}),attr:on,bound:sn,draw:cn,pick:_r(un),isect:rr},fn=Cr("shape",Ft),pn=Cr("symbol",Ut,er);const ji=p.lruCache();var v={height:E,measureWidth:_n,estimateWidth:gn,width:gn,canvas:hn};function hn(e){v.width=e&&m?_n:gn}function gn(e,t){return mn(A(e,t),E(e))}function mn(e,t){return~~(.8*e.length*t)}function _n(e,t){return E(e)<=0||!(t=A(e,t))?0:yn(t,On(e))}function yn(e,t){var r=`(${t}) `+e;let n=ji.get(r);return void 0===n&&(m.font=t,n=m.measureText(e).width,ji.set(r,n)),n}function E(e){return null!=e.fontSize?+e.fontSize||0:11}function S(e){return null!=e.lineHeight?e.lineHeight:E(e)+2}function Tn(e){return!p.isArray(e)||1<e.length?e:e[0]}function bn(e){return Tn(e.lineBreak&&e.text&&!p.isArray(e.text)?e.text.split(e.lineBreak):e.text)}function vn(e){var t=bn(e);return(p.isArray(t)?t.length-1:0)*S(e)}function A(e,t){t=null==t?"":(t+"").trim();return 0<e.limit&&t.length?Sn(e,t):t}function En(t){if(v.width===_n){const r=On(t);return e=>yn(e,r)}if(v.width!==gn)return e=>v.width(t,e);{const n=E(t);return e=>mn(e,n)}}function Sn(e,t){var r=+e.limit,n=En(e);if(n(t)<r)return t;var a,i=e.ellipsis||"…",e="rtl"===e.dir,o=0,s=t.length;if(r-=n(i),e){for(;o<s;)n(t.slice(a=o+s>>>1))>r?o=a+1:s=a;return i+t.slice(o)}for(;o<s;)n(t.slice(0,a=1+(o+s>>>1)))<r?o=a:s=a-1;return t.slice(0,o)+i}function An(e,t){e=e.font;return(t&&e?String(e).replace(/"/g,"'"):e)||"sans-serif"}function On(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+E(e)+"px "+An(e,t)}function Cn(e){var t=e.baseline,r=E(e);return Math.round("top"===t?.79*r:"middle"===t?.3*r:"bottom"===t?-.21*r:"line-top"===t?.29*r+.5*S(e):"line-bottom"===t?.29*r-.5*S(e):0)}hn(!0);const Hi={left:"start",center:"middle",right:"end"},Gi=new g;function kn(e){var t=e.x||0,r=e.y||0,n=e.radius||0;return n&&(e=(e.theta||0)-P,t+=n*Math.cos(e),r+=n*Math.sin(e)),Gi.x1=t,Gi.y1=r,Gi}function wn(e,t){var r,n=t.dx||0,a=(t.dy||0)+Cn(t),i=kn(t),o=i.x1,i=i.y1,s=t.angle||0;e("text-anchor",Hi[t.align]||"start"),s?(r=br(o,i)+" "+vr(s),(n||a)&&(r+=" "+br(n,a))):r=br(o+n,i+a),e("transform",r)}function Rn(e,r,t){var n=v.height(r),a=r.align,i=kn(r),o=i.x1,i=i.y1,s=r.dx||0,l=(r.dy||0)+Cn(r)-Math.round(.8*n),c=bn(r),c=p.isArray(c)?(n+=S(r)*(c.length-1),c.reduce((e,t)=>Math.max(e,v.width(r,t)),0)):v.width(r,c);if("center"===a?s-=c/2:"right"===a&&(s-=c),e.set(s+=o,l+=i,s+c,l+n),r.angle&&!t)e.rotate(r.angle*M,o,i);else if(2===t)return e.rotatedPoints(r.angle*M,o,i);return e}function In(c,e,u){y(e,e=>{var t,r,n,a,i,o,s,l=null==e.opacity?1:e.opacity;if(!(u&&!u.intersects(e.bounds)||0===l||e.fontSize<=0||null==e.text||0===e.text.length)){if(c.font=On(e),c.textAlign=e.align||"left",r=(t=kn(e)).x1,n=t.y1,e.angle&&(c.save(),c.translate(r,n),c.rotate(e.angle*M),r=n=0),r+=e.dx||0,n+=(e.dy||0)+Cn(e),o=bn(e),ar(c,e),p.isArray(o))for(i=S(e),a=0;a<o.length;++a)s=A(e,o[a]),e.fill&&lr(c,e,l)&&c.fillText(s,r,n),e.stroke&&ur(c,e,l)&&c.strokeText(s,r,n),n+=i;else s=A(e,o),e.fill&&lr(c,e,l)&&c.fillText(s,r,n),e.stroke&&ur(c,e,l)&&c.strokeText(s,r,n);e.angle&&c.restore()}})}function Mn(e,t,r,n,a,i){var o,s,l,c;return!(t.fontSize<=0)&&(!t.angle||(o=(s=kn(t)).x1,s=s.y1,l=Rn(Gi,t,1),t=-t.angle*M,c=Math.cos(t),t=Math.sin(t),l.contains(c*a-t*i+(o-c*o+t*s),t*a+c*i+(s-t*o-c*s))))}function Pn(e,t){e=Rn(Gi,e,2);return nr(t,e[0],e[1],e[2],e[3])||nr(t,e[0],e[1],e[4],e[5])||nr(t,e[4],e[5],e[6],e[7])||nr(t,e[2],e[3],e[6],e[7])}var O={arc:Me,area:De,group:Ue,image:Le,line:He,path:Ve,rect:qe,rule:dn,shape:fn,symbol:pn,text:{type:"text",tag:"text",nested:!1,attr:wn,bound:Rn,draw:In,pick:_r(Mn),isect:Pn},trail:Ir("trail",Bt,Rr)};function Nn(e,t,r){var n=O[e.mark.marktype];return(t||n.bound)((e=n.nested?e.mark:e).bounds||(e.bounds=new g),e,r)}var Dn={mark:null};function xn(e,t,r){var n,a,i=O[e.marktype],o=i.bound,s=e.items,l=s&&s.length;if(i.nested)return i=Nn(l?s[0]:(Dn.mark=e,Dn),o,r),t=t&&t.union(i)||i;if(t=t||e.bounds&&e.bounds.clear()||new g,l)for(n=0,a=s.length;n<a;++n)t.union(Nn(s[n],o,r));return e.bounds=t}const Vi=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function Ln(e,t){return JSON.stringify(e,Vi,t)}function Fn(e){return Un("string"==typeof e?JSON.parse(e):e)}function Un(e){var t,r,n,a=e.marktype,i=e.items;if(i)for(r=0,n=i.length;r<n;++r)i[r][t=a?"mark":"group"]=e,i[r].zindex&&(i[r][t].zdirty=!0),"group"===(a||t)&&Un(i[r]);return a&&xn(e),e}class Wi{constructor(e){arguments.length?this.root=Fn(e):(this.root=Bn({marktype:"group",name:"root",role:"frame"}),this.root.items=[new Wt(this.root)])}toJSON(e){return Ln(this.root,e||0)}mark(e,t,r){e=Bn(e,t=t||this.root.items[0]);return(t.items[r]=e).zindex&&(e.group.zdirty=!0),e}}function Bn(e,t){t={bounds:new g,clip:!!e.clip,group:t,interactive:!1!==e.interactive,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return null!=e.aria&&(t.aria=e.aria),e.description&&(t.description=e.description),t}function C(e,t,r){return(e=!e&&"undefined"!=typeof document&&document.createElement?document:e)?r?e.createElementNS(r,t):e.createElement(t):null}function jn(e,t){t=t.toLowerCase();for(var r=e.childNodes,n=0,a=r.length;n<a;++n)if(r[n].tagName.toLowerCase()===t)return r[n]}function k(e,t,r,n){var a,t=e.childNodes[t];return t&&t.tagName.toLowerCase()===r.toLowerCase()||(a=t||null,t=C(e.ownerDocument,r,n),e.insertBefore(t,a)),t}function w(e,t){for(var r=e.childNodes,n=r.length;t<n;)e.removeChild(r[--n]);return e}function Hn(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function Gn(e,t){var r=t.getBoundingClientRect();return[e.clientX-r.left-(t.clientLeft||0),e.clientY-r.top-(t.clientTop||0)]}function Vn(e,t,r,n){var a,i,o=e&&e.mark;if(o&&(a=O[o.marktype]).tip){for((i=Gn(t,r))[0]-=n[0],i[1]-=n[1];e=e.mark.group;)i[0]-=e.x||0,i[1]-=e.y||0;e=a.tip(o.items,i)}return e}class qi{constructor(e,t){this._active=null,this._handlers={},this._loader=e||K.loader(),this._tooltip=t||Wn}initialize(e,t,r){return this._el=e,this._obj=r||null,this.origin(t)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()}scene(e){return arguments.length?(this._scene=e,this):this._scene}on(){}off(){}_handlerIndex(t,r,n){for(let e=t?t.length:0;0<=--e;)if(t[e].type===r&&(!n||t[e].handler===n))return e;return-1}handlers(e){var t=this._handlers,r=[];if(e)r.push(...t[this.eventName(e)]);else for(const n in t)r.push(...t[n]);return r}eventName(e){var t=e.indexOf(".");return t<0?e:e.slice(0,t)}handleHref(a,e,t){this._loader.sanitize(t,{context:"href"}).then(e=>{var t=new MouseEvent(a.type,a),r=C(null,"a");for(const n in e)r.setAttribute(n,e[n]);r.dispatchEvent(t)}).catch(()=>{})}handleTooltip(e,t,r){t&&null!=t.tooltip&&(t=Vn(t,e,this.canvas(),this._origin),r=r&&t&&t.tooltip||null,this._tooltip.call(this._obj,this,e,t,r))}getItemBoundingClientRect(r){var n=this.canvas();if(n){var n=n.getBoundingClientRect(),a=this._origin,i=r.bounds,o=i.width(),s=i.height();let e=i.x1+a[0]+n.left,t=i.y1+a[1]+n.top;for(;r.mark&&(r=r.mark.group);)e+=r.x||0,t+=r.y||0;return{x:e,y:t,width:o,height:s,left:e,top:t,right:e+o,bottom:t+s}}}}function Wn(e,t,r,n){e.element().setAttribute("title",n||"")}class $i{constructor(e){this._el=null,this._bgcolor=null,this._loader=new wi(e)}initialize(e,t,r,n,a){return this._el=e,this.resize(t,r,n,a)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}background(e){return 0===arguments.length?this._bgcolor:(this._bgcolor=e,this)}resize(e,t,r,n){return this._width=e,this._height=t,this._origin=r||[0,0],this._scale=n||1,this}dirty(){}render(e,t){const r=this;return r._call=function(){r._render(e,t)},r._call(),r._call=null,r}_render(){}renderAsync(e,t){const r=this.render(e,t);return this._ready?this._ready.then(()=>r):Promise.resolve(r)}_load(e,t){var r=this,e=r._loader[e](t);if(!r._ready){const n=r._call;r._ready=r._loader.ready().then(e=>{e&&n(),r._ready=null})}return e}sanitizeURL(e){return this._load("sanitizeURL",e)}loadImage(e){return this._load("loadImage",e)}}const zi="dragleave",Ki="pointerdown",Yi="pointermove",Ji="pointerout",Zi="pointerover",Qi="mousedown",Xi="mouseout",eo="click",to="mousewheel",ro="touchstart",no="touchmove",ao="touchend",io=["keydown","keypress","keyup","dragenter",zi,"dragover",Ki,"pointerup",Yi,Ji,Zi,Qi,"mouseup","mousemove",Xi,"mouseover",eo,"dblclick","wheel",to,ro,no,ao],oo=Yi,so=Xi;eo;class lo extends qi{constructor(e,t){super(e,t),this._down=null,this._touch=null,this._first=!0,this._events={},this.events=io,this.pointermove=Kn([Yi,"mousemove"],[Zi,"mouseover"],[Ji,Xi]),this.dragover=Kn(["dragover"],["dragenter"],[zi]),this.pointerout=Yn([Ji,Xi]),this.dragleave=Yn([zi])}initialize(e,t,r){return this._canvas=e&&jn(e,"canvas"),[eo,Qi,Ki,Yi,Ji,zi].forEach(e=>qn(this,e)),super.initialize(e,t,r)}canvas(){return this._canvas}context(){return this._canvas.getContext("2d")}DOMMouseScroll(e){this.fire(to,e)}pointerdown(e){this._down=this._active,this.fire(Ki,e)}mousedown(e){this._down=this._active,this.fire(Qi,e)}click(e){this._down===this._active&&(this.fire(eo,e),this._down=null)}touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(ro,e,!0)}touchmove(e){this.fire(no,e,!0)}touchend(e){this.fire(ao,e,!0),this._touch=null}fire(e,r,t){var n=t?this._touch:this._active,a=this._handlers[e];if("click"===(r.vegaType=e)&&n&&n.href?this.handleHref(r,n,n.href):e!==oo&&e!==so||this.handleTooltip(r,n,e!==so),a)for(let e=0,t=a.length;e<t;++e)a[e].handler.call(this._obj,r,n)}on(e,t){var r=this.eventName(e),n=this._handlers;return this._handlerIndex(n[r],e,t)<0&&(qn(this,e),(n[r]||(n[r]=[])).push({type:e,handler:t})),this}off(e,t){var r=this.eventName(e),r=this._handlers[r],e=this._handlerIndex(r,e,t);return 0<=e&&r.splice(e,1),this}pickEvent(e){var e=Gn(e,this._canvas),t=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-t[0],e[1]-t[1])}pick(e,t,r,n,a){var i=this.context();return O[e.marktype].pick.call(this,i,e,t,r,n,a)}}const co=e=>e===ro||e===no||e===ao?[ro,no,ao]:[e];function qn(t,e){co(e).forEach(e=>$n(t,e))}function $n(t,r){var e=t.canvas();e&&!t._events[r]&&(t._events[r]=1,e.addEventListener(r,t[r]?e=>t[r](e):e=>t.fire(r,e)))}function zn(t,e,r){e.forEach(e=>t.fire(e,r))}function Kn(n,a,i){return function(e){var t=this._active,r=this.pickEvent(e);r!==t&&(t&&t.exit||zn(this,i,e),this._active=r,zn(this,a,e)),zn(this,n,e)}}function Yn(t){return function(e){zn(this,t,e),this._active=null}}function Jn(){return"undefined"!=typeof window&&window.devicePixelRatio||1}function Zn(e,t,r,n,a,i){var o="undefined"!=typeof HTMLElement&&e instanceof HTMLElement&&null!=e.parentNode,s=e.getContext("2d"),a=o?Jn():a;e.width=t*a,e.height=r*a;for(const l in i)s[l]=i[l];o&&1!==a&&(e.style.width=t+"px",e.style.height=r+"px"),s.pixelRatio=a,s.setTransform(a,0,0,a,a*n[0],a*n[1])}class uo extends $i{constructor(e){super(e),this._options={},this._redraw=!1,this._dirty=new g,this._tempb=new g}initialize(e,t,r,n,a,i){return this._options=i||{},this._canvas=this._options.externalContext?null:z.canvas(1,1,this._options.type),e&&this._canvas&&(w(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),super.initialize(e,t,r,n,a)}resize(e,t,r,n){return super.resize(e,t,r,n),this._canvas?Zn(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context):((e=this._options.externalContext)||p.error("CanvasRenderer is missing a valid canvas or context"),e.scale(this._scale,this._scale),e.translate(this._origin[0],this._origin[1])),this._redraw=!0,this}canvas(){return this._canvas}context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)}dirty(e){var t=this._tempb.clear().union(e.bounds);let r=e.mark.group;for(;r;)t.translate(r.x||0,r.y||0),r=r.mark.group;this._dirty.union(t)}_render(e,t){var r=this.context(),n=this._origin,a=this._width,i=this._height,o=this._dirty,s=fo(n,a,i),s=(r.save(),this._redraw||o.empty()?(this._redraw=!1,s.expand(1)):Qn(r,s.intersect(o),n));return this.clear(-n[0],-n[1],a,i),this.draw(r,e,s,t),r.restore(),o.clear(),this}draw(e,t,r,n){var a;("group"===t.marktype||null==n||n.includes(t.marktype))&&(a=O[t.marktype],t.clip&&Mr(e,t),a.draw.call(this,e,t,r,n),t.clip)&&e.restore()}clear(e,t,r,n){var a=this._options,i=this.context();"pdf"===a.type||a.externalContext||i.clearRect(e,t,r,n),null!=this._bgcolor&&(i.fillStyle=this._bgcolor,i.fillRect(e,t,r,n))}}const fo=(e,t,r)=>(new g).set(0,0,t,r).translate(-e[0],-e[1]);function Qn(e,t,r){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-r[0]%1,-r[1]%1),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}class po extends qi{constructor(e,t){super(e,t);const r=this;r._hrefHandler=ho(r,(e,t)=>{t&&t.href&&r.handleHref(e,t,t.href)}),r._tooltipHandler=ho(r,(e,t)=>{r.handleTooltip(e,t,e.type!==so)})}initialize(e,t,r){let n=this._svg;return n&&(n.removeEventListener("click",this._hrefHandler),n.removeEventListener(oo,this._tooltipHandler),n.removeEventListener(so,this._tooltipHandler)),this._svg=n=e&&jn(e,"svg"),n&&(n.addEventListener("click",this._hrefHandler),n.addEventListener(oo,this._tooltipHandler),n.addEventListener(so,this._tooltipHandler)),super.initialize(e,t,r)}canvas(){return this._svg}on(e,t){var r=this.eventName(e),n=this._handlers;return this._handlerIndex(n[r],e,t)<0&&(e={type:e,handler:t,listener:ho(this,t)},(n[r]||(n[r]=[])).push(e),this._svg)&&this._svg.addEventListener(r,e.listener),this}off(e,t){var r=this.eventName(e),n=this._handlers[r],e=this._handlerIndex(n,e,t);return 0<=e&&(this._svg&&this._svg.removeEventListener(r,n[e].listener),n.splice(e,1)),this}}const ho=(r,n)=>e=>{var t=e.target.__data__,t=Array.isArray(t)?t[0]:t;e.vegaType=e.type,n.call(r._obj,e,t)},go="aria-hidden",mo="aria-label",_o="role",yo="aria-roledescription",To="graphics-object",bo="graphics-symbol",vo=(e,t,r)=>({[_o]:e,[yo]:t,[mo]:r||void 0}),Eo=p.toSet(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),So={axis:{desc:"axis",caption:aa},legend:{desc:"legend",caption:ia},"title-text":{desc:"title",caption:e=>`Title text '${na(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${na(e)}'`}},Ao={ariaRole:_o,ariaRoleDescription:yo,description:mo};function Xn(e,t){var r=!1===t.aria;if(e(go,r||void 0),r||null==t.description)for(const n in Ao)e(Ao[n],void 0);else{r=t.mark.marktype;e(mo,t.description),e(_o,t.ariaRole||("group"===r?To:bo)),e(yo,t.ariaRoleDescription||r+" mark")}}function ea(e){return!1===e.aria?{[go]:!0}:Eo[e.role]?null:So[e.role]?ra(e,So[e.role]):ta(e)}function ta(e){var t=e.marktype,r="group"===t||"text"===t||e.items.some(e=>null!=e.description&&!1!==e.aria);return vo(r?To:bo,t+" mark container",e.description)}function ra(e,t){try{var r=e.items[0],n=t.caption||(()=>"");return vo(t.role||bo,t.desc,r.description||n(r))}catch(e){return null}}function na(e){return p.array(e.text).join(" ")}function aa(e){var t=e.datum,r=e.orient,n=t.title?oa(e):null,a=e.context,t=a.scales[t.scale].value,a=a.dataflow.locale(),i=t.type;return("left"===r||"right"===r?"Y":"X")+"-axis"+(n?` titled '${n}'`:"")+` for a ${Y.isDiscrete(i)?"discrete":i} scale`+" with "+Y.domainCaption(a,t,e)}function ia(e){var t=e.datum,r=t.title?oa(e):null,n=`${t.type||""} legend`.trim(),t=t.scales,a=Object.keys(t),i=e.context,t=i.scales[t[a[0]]].value,i=i.dataflow.locale();return la(n)+(r?` titled '${r}'`:"")+" for "+sa(a)+" with "+Y.domainCaption(i,t,e)}function oa(e){try{return p.array(p.peek(e.items).items[0].text).join(" ")}catch(e){return null}}function sa(e){return(e=e.map(e=>e+("fill"===e||"stroke"===e?" color":""))).length<2?e[0]:e.slice(0,-1).join(", ")+" and "+p.peek(e)}function la(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const Oo=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Co=e=>Oo(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function ca(){let i="",o="",s="";const l=[],c=()=>o=s="",u=(e,t)=>(null!=t&&(o+=` ${e}="${Co(t)}"`),d),d={open(e,...t){var r;r=e,o&&(i+=o+">"+s,c()),l.push(r),o="<"+e;for(const n of t)for(const a in n)u(a,n[a]);return d},close(){var e=l.pop();return o?i+=o+(s?`>${s}</${e}>`:"/>"):i+=`</${e}>`,c(),d},attr:u,text:e=>(s+=Oo(e),d),toString:()=>i};return d}const ko=e=>ua(ca(),e)+"";function ua(t,e){if(t.open(e.tagName),e.hasAttributes()){var r=e.attributes,n=r.length;for(let e=0;e<n;++e)t.attr(r[e].name,r[e].value)}if(e.hasChildNodes())for(const a of e.childNodes)3===a.nodeType?t.text(a.nodeValue):ua(t,a);return t.close()}const wo={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},Ro={blend:"mix-blend-mode"},Io={fill:"none","stroke-miterlimit":10},Mo="http://www.w3.org/2000/xmlns/",W=Wr.xmlns;class Po extends $i{constructor(e){super(e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}initialize(e,t,r,n,a){return this._defs={},this._clearDefs(),e&&(this._svg=k(e,0,"svg",W),this._svg.setAttributeNS(Mo,"xmlns",W),this._svg.setAttributeNS(Mo,"xmlns:xlink",Wr["xmlns:xlink"]),this._svg.setAttribute("version",Wr.version),this._svg.setAttribute("class","marks"),w(e,1),this._root=k(this._svg,0,"g",W),R(this._root,Io),w(this._svg,1)),this.background(this._bgcolor),super.initialize(e,t,r,n,a)}background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),super.background(...arguments)}resize(e,t,r,n){return super.resize(e,t,r,n),this._svg&&(R(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} `+this._height}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this}canvas(){return this._svg}svg(){var e=this._svg,t=this._bgcolor;if(!e)return null;let r;t&&(e.removeAttribute("style"),R(r=k(e,0,"rect",W),{width:this._width,height:this._height,fill:t}));var n=ko(e);return t&&(e.removeChild(r),this._svg.style.setProperty("background-color",t)),n}_render(e,t){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e,void 0,t),w(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this}dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))}isDirty(e){return this._dirtyAll||!e._svg||!e._svg.ownerSVGElement||e.dirty===this._dirtyID}_dirtyCheck(){this._dirtyAll=!0;var e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let r,n,a,i,o,s,l;for(o=0,s=e.length;o<s;++o)r=e[o],(n=r.mark).marktype!==a&&(a=n.marktype,i=O[a]),n.zdirty&&n.dirty!==t&&(this._dirtyAll=!1,da(r,t),n.items.forEach(e=>{e.dirty=t})),n.zdirty||(r.exit?(i.nested&&n.items.length?(l=n.items[0])._svg&&this._update(i,l._svg,l):r._svg&&(l=r._svg.parentNode)&&l.removeChild(r._svg),r._svg=null):(r=i.nested?n.items[0]:r)._update!==t&&(r._svg&&r._svg.ownerSVGElement?this._update(i,r._svg,r):(this._dirtyAll=!1,da(r,t)),r._update=t));return!this._dirtyAll}mark(e,t,r,n){if(!this.isDirty(t))return t._svg;const a=this._svg,i=t.marktype,o=O[i],s=!1===t.interactive?"none":null,l="g"===o.tag,c=ga(t,e,r,"g",a);if("group"!==i&&null!=n&&!n.includes(i))return w(c,0),t._svg;c.setAttribute("class",Hn(t));var u=ea(t);for(const p in u)I(c,p,u[p]);l||I(c,"pointer-events",s),I(c,"clip-path",t.clip?Gt(this,t,t.group):null);let d=null,f=0;e=e=>{var t=this.isDirty(e),r=ga(e,c,d,o.tag,a);t&&(this._update(o,r,e),l)&&ha(this,r,e,n),d=r,++f};return o.nested?t.items.length&&e(t.items[0]):y(t,e),w(c,f),c}_update(e,t,r){l=t,f=t.__values__,Xn(_a,r),e.attr(_a,r,this);var n=No[e.type];n&&n.call(this,e,t,r),l&&this.style(l,r)}style(t,r){if(null!=r){for(const a in wo){let e="font"===a?An(r):r[a];var n;e!==f[a]&&(n=wo[a],null==e?t.removeAttribute(n):(Z(e)&&(e=Q(e,this._defs.gradient,ba())),t.setAttribute(n,e+"")),f[a]=e)}for(const e in Ro)ya(t,Ro[e],r[e])}}defs(){var e=this._svg,t=this._defs;let r=t.el,n=0;for(const a in t.gradient)r||(t.el=r=k(e,1,"defs",W)),n=fa(r,t.gradient[a],n);for(const i in t.clipping)r||(t.el=r=k(e,1,"defs",W)),n=pa(r,t.clipping[i],n);r&&(0===n?(e.removeChild(r),t.el=null):w(r,n))}_clearDefs(){var e=this._defs;e.gradient={},e.clipping={}}}function da(e,t){for(;e&&e.dirty!==t;e=e.mark.group){if(e.dirty=t,!e.mark||e.mark.dirty===t)return;e.mark.dirty=t}}function fa(e,t,r){let n,a,i;var o;for("radial"===t.gradient?(R(o=k(e,r++,"pattern",W),{id:Da+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),R(o=k(o,0,"rect",W),{width:1,height:1,fill:`url(${ba()}#${t.id})`}),R(e=k(e,r++,"radialGradient",W),{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})):R(e=k(e,r++,"linearGradient",W),{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2}),n=0,a=t.stops.length;n<a;++n)(i=k(e,n,"stop",W)).setAttribute("offset",t.stops[n].offset),i.setAttribute("stop-color",t.stops[n].color);return w(e,n),r}function pa(e,t,r){let n;return(e=k(e,r,"clipPath",W)).setAttribute("id",t.id),t.path?(n=k(e,0,"path",W)).setAttribute("d",t.path):R(n=k(e,0,"rect",W),{x:0,y:0,width:t.width,height:t.height}),w(e,1),r+1}function ha(t,r,e,n){r=r.lastChild.previousSibling;let a,i=0;y(e,e=>{a=t.mark(r,e,a,n),++i}),w(r,1+i)}function ga(e,t,r,n,a){let i=e._svg,o;return i||(o=t.ownerDocument,i=C(o,n,W),e._svg=i,e.mark&&(i.__data__=e,i.__values__={fill:"default"},"g"===n)&&(n=C(o,"path",W),i.appendChild(n),n.__data__=e,n=C(o,"g",W),i.appendChild(n),n.__data__=e,n=C(o,"path",W),i.appendChild(n),n.__data__=e,n.__values__={fill:"default"})),i.ownerSVGElement===a&&!ma(i,r)||t.insertBefore(i,r?r.nextSibling:t.firstChild),i}function ma(e,t){return e.parentNode&&1<e.parentNode.childNodes.length&&e.previousSibling!=t}let l=null,f=null;const No={group(e,t,r){var n=l=t.childNodes[2],t=(f=n.__values__,e.foreground(_a,r,this),f=t.__values__,l=t.childNodes[1],e.content(_a,r,this),l=t.childNodes[0]),e=(e.background(_a,r,this),!1===r.mark.interactive?"none":null);e!==f.events&&(I(n,"pointer-events",e),I(t,"pointer-events",e),f.events=e),r.strokeForeground&&r.stroke?(e=r.fill,I(n,"display",null),this.style(t,r),I(t,"stroke",null),e&&(r.fill=null),f=n.__values__,this.style(n,r),e&&(r.fill=e),l=null):I(n,"display","none")},image(e,t,r){!1===r.smooth?(ya(t,"image-rendering","optimizeSpeed"),ya(t,"image-rendering","pixelated")):ya(t,"image-rendering",null)},text(e,n,a){var t=bn(a);let r,i,o,s;p.isArray(t)?(r=(i=t.map(e=>A(a,e))).join("\n"))!==f.text&&(w(n,0),o=n.ownerDocument,s=S(a),i.forEach((e,t)=>{var r=C(o,"tspan",W);r.__data__=a,r.textContent=e,t&&(r.setAttribute("x",0),r.setAttribute("dy",s)),n.appendChild(r)}),f.text=r):(i=A(a,t))!==f.text&&(n.textContent=i,f.text=i),I(n,"font-family",An(a)),I(n,"font-size",E(a)+"px"),I(n,"font-style",a.fontStyle),I(n,"font-variant",a.fontVariant),I(n,"font-weight",a.fontWeight)}};function _a(e,t,r){t!==f[e]&&(r?Ta(l,e,t,r):I(l,e,t),f[e]=t)}function ya(e,t,r){r!==f[t]&&(null==r?e.style.removeProperty(t):e.style.setProperty(t,r+""),f[t]=r)}function R(e,t){for(const r in t)I(e,r,t[r])}function I(e,t,r){null!=r?e.setAttribute(t,r):e.removeAttribute(t)}function Ta(e,t,r,n){null!=r?e.setAttributeNS(n,t,r):e.removeAttributeNS(n,t)}function ba(){var e;return"undefined"==typeof window?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}class Do extends $i{constructor(e){super(e),this._text=null,this._defs={gradient:{},clipping:{}}}svg(){return this._text}_render(e){var t=ca(),r=(t.open("svg",p.extend({},Wr,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} `+this._height})),this._bgcolor);return r&&"transparent"!==r&&"none"!==r&&t.open("rect",{width:this._width,height:this._height,fill:r}).close(),t.open("g",Io,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this}mark(s,l){const c=O[l.marktype],u=c.tag,d=[Xn,c.attr];s.open("g",{class:Hn(l),"clip-path":l.clip?Gt(this,l,l.group):null},ea(l),{"pointer-events":"g"!==u&&!1===l.interactive?"none":null});var e=t=>{var e,r,n,a=this.href(t);if(a&&s.open("a",a),s.open(u,this.attr(l,t,d,"g"!==u?u:null)),"text"===u){var i=bn(t);if(p.isArray(i)){var o={x:0,dy:S(t)};for(let e=0;e<i.length;++e)s.open("tspan",e?o:null).text(A(t,i[e])).close()}else s.text(A(t,i))}else"g"===u&&(e=t.strokeForeground,r=t.fill,n=t.stroke,e&&n&&(t.stroke=null),s.open("path",this.attr(l,t,c.background,"bgrect")).close(),s.open("g",this.attr(l,t,c.content)),y(t,e=>this.mark(s,e)),s.close(),e&&n?(r&&(t.fill=null),t.stroke=n,s.open("path",this.attr(l,t,c.foreground,"bgrect")).close(),r&&(t.fill=r)):s.open("path",this.attr(l,t,c.foreground,"bgfore")).close());s.close(),a&&s.close()};return c.nested?l.items&&l.items.length&&e(l.items[0]):y(l,e),s.close()}href(e){const t=e.href;if(t){if(e=this._hrefs&&this._hrefs[t])return e;this.sanitizeURL(t).then(e=>{e["xlink:href"]=e.href,e.href=null,(this._hrefs||(this._hrefs={}))[t]=e})}return null}attr(e,t,r,n){const a={},i=(e,t,r,n)=>{a[n||e]=t};return Array.isArray(r)?r.forEach(e=>e(i,t,this)):r(i,t,this),n&&va(a,t,e,n,this._defs),a}defs(t){var e=this._defs.gradient,r=this._defs.clipping,n=Object.keys(e).length+Object.keys(r).length;if(0!==n){t.open("defs");for(const s in e){var a=e[s],i=a.stops;"radial"===a.gradient?(t.open("pattern",{id:Da+s,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+s+")"}).close(),t.close(),t.open("radialGradient",{id:s,fx:a.x1,fy:a.y1,fr:a.r1,cx:a.x2,cy:a.y2,r:a.r2})):t.open("linearGradient",{id:s,x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2});for(let e=0;e<i.length;++e)t.open("stop",{offset:i[e].offset,"stop-color":i[e].color}).close();t.close()}for(const l in r){var o=r[l];t.open("clipPath",{id:l}),(o.path?t.open("path",{d:o.path}):t.open("rect",{x:0,y:0,width:o.width,height:o.height})).close(),t.close()}t.close()}}}function va(t,r,e,n,a){let i;if(null!=r&&("bgrect"===n&&!1===e.interactive&&(t["pointer-events"]="none"),"bgfore"!==n||(!1===e.interactive&&(t["pointer-events"]="none"),t.display="none",null===r.fill))){"image"===n&&!1===r.smooth&&(i=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),"text"===n&&(t["font-family"]=An(r),t["font-size"]=E(r)+"px",t["font-style"]=r.fontStyle,t["font-variant"]=r.fontVariant,t["font-weight"]=r.fontWeight);for(const l in wo){let e=r[l];var o=wo[l];("transparent"!==e||"fill"!==o&&"stroke"!==o)&&null!=e&&(Z(e)&&(e=Q(e,a.gradient,"")),t[o]=e)}for(const c in Ro){var s=r[c];null!=s&&(i=i||[]).push(Ro[c]+`: ${s};`)}i&&(t.style=i.join(" "))}}const q={svgMarkTypes:["text"],svgOnTop:!0,debug:!1};function Ea(e){q.svgMarkTypes=e.svgMarkTypes??["text"],q.svgOnTop=e.svgOnTop??!0,q.debug=e.debug??!1}class xo extends $i{constructor(e){super(e),this._svgRenderer=new Po(e),this._canvasRenderer=new uo(e)}initialize(e,t,r,n,a){this._root_el=k(e,0,"div");var i=k(this._root_el,0,"div"),o=k(this._root_el,1,"div");return this._root_el.style.position="relative",q.debug||(i.style.height="100%",o.style.position="absolute",o.style.top="0",o.style.left="0",o.style.height="100%",o.style.width="100%"),this._svgEl=q.svgOnTop?o:i,this._canvasEl=q.svgOnTop?i:o,this._svgEl.style.pointerEvents="none",this._canvasRenderer.initialize(this._canvasEl,t,r,n,a),this._svgRenderer.initialize(this._svgEl,t,r,n,a),super.initialize(e,t,r,n,a)}dirty(e){return(q.svgMarkTypes.includes(e.mark.marktype)?this._svgRenderer:this._canvasRenderer).dirty(e),this}_render(e,t){t=(t??["arc","area","image","line","path","rect","rule","shape","symbol","text","trail"]).filter(e=>!q.svgMarkTypes.includes(e));this._svgRenderer.render(e,q.svgMarkTypes),this._canvasRenderer.render(e,t)}resize(e,t,r,n){return super.resize(e,t,r,n),this._svgRenderer.resize(e,t,r,n),this._canvasRenderer.resize(e,t,r,n),this}background(e){return(q.svgOnTop?this._canvasRenderer:this._svgRenderer).background(e),this}}class Lo extends lo{constructor(e,t){super(e,t)}initialize(e,t,r){e=k(k(e,0,"div"),q.svgOnTop?0:1,"div");return super.initialize(e,t,r)}}const Fo={Canvas:"canvas",PNG:"png",SVG:"svg",Hybrid:"hybrid",None:"none"},$={};function Sa(e,t){return e=String(e||"").toLowerCase(),1<arguments.length?($[e]=t,this):$[e]}function Aa(e,t,r){var n=[],t=(new g).union(t),a=e.marktype;return a?Oa(e,t,r,n):"group"===a?ka(e,t,r,n):p.error("Intersect scene must be mark node or group item.")}function Oa(t,r,n,a){if(Ca(t,r,n)){var i=t.items,t=t.marktype,o=i.length;let e=0;if("group"===t)for(;e<o;++e)ka(i[e],r,n,a);else for(var s=O[t].isect;e<o;++e){var l=i[e];wa(l,r,s)&&a.push(l)}}return a}function Ca(e,t,r){return e.bounds&&t.intersects(e.bounds)&&("group"===e.marktype||!1!==e.interactive&&(!r||r(e)))}function ka(e,t,r,n){r&&r(e.mark)&&wa(e,t,O.group.isect)&&n.push(e);var a=e.items,i=a&&a.length;if(i){var o=e.x||0,e=e.y||0;t.translate(-o,-e);for(let e=0;e<i;++e)Oa(a[e],t,r,n);t.translate(o,e)}return n}function wa(e,t,r){var n=e.bounds;return t.encloses(n)||t.intersects(n)&&r(e,t)}$.canvas=$.png={renderer:uo,headless:uo,handler:lo},$.svg={renderer:Po,headless:Do,handler:po},$.hybrid={renderer:xo,headless:xo,handler:Lo},$.none={};const Uo=new g;function Ra(e){var t=e.clip;if(p.isFunction(t))t(Yt(Uo.clear()));else{if(!t)return;Uo.set(0,0,e.group.width,e.group.height)}e.bounds.intersect(Uo)}const Bo=1e-9;function Ia(e,t,r){return e===t||("path"===r?Ma(e,t):e instanceof Date&&t instanceof Date?+e==+t:p.isNumber(e)&&p.isNumber(t)?Math.abs(e-t)<=Bo:e&&t&&(p.isObject(e)||p.isObject(t))?Pa(e,t):e==t)}function Ma(e,t){return Ia(dt(e),dt(t))}function Pa(e,t){var r,n,a=Object.keys(e),i=Object.keys(t);if(a.length!==i.length)return!1;for(a.sort(),i.sort(),n=a.length-1;0<=n;n--)if(a[n]!=i[n])return!1;for(n=a.length-1;0<=n;n--)if(!Ia(e[r=a[n]],t[r],r))return!1;return typeof e==typeof t}function Na(){Ht(),J()}e.Bounds=g,e.CanvasHandler=lo,e.CanvasRenderer=uo,e.Gradient=X,e.GroupItem=Wt,e.Handler=qi,e.HybridHandler=Lo,e.HybridRenderer=xo,e.Item=Vt,e.Marks=O,e.RenderType=Fo,e.Renderer=$i,e.ResourceLoader=wi,e.SVGHandler=po,e.SVGRenderer=Po,e.SVGStringRenderer=Do,e.Scenegraph=Wi,e.boundClip=Ra,e.boundContext=Yt,e.boundItem=Nn,e.boundMark=xn,e.boundStroke=zt,e.domChild=k,e.domClear=w,e.domCreate=C,e.domFind=jn,e.font=On,e.fontFamily=An,e.fontSize=E,e.intersect=Aa,e.intersectBoxLine=nr,e.intersectPath=Xt,e.intersectPoint=er,e.intersectRule=rr,e.lineHeight=S,e.markup=ca,e.multiLineOffset=vn,e.path=ae,e.pathCurves=ut,e.pathEqual=Ma,e.pathParse=dt,e.pathRectangle=Rt,e.pathRender=Tt,e.pathSymbols=vt,e.pathTrail=It,e.point=Gn,e.renderModule=Sa,e.resetSVGClipId=Ht,e.resetSVGDefIds=Na,e.sceneEqual=Ia,e.sceneFromJSON=Fn,e.scenePickVisit=pr,e.sceneToJSON=Ln,e.sceneVisit=y,e.sceneZOrder=fr,e.serializeXML=ko,e.setHybridRendererOptions=Ea,e.textMetrics=v}}return mu.exports}function Ou(){if(!vu){vu=1;var e=gu.exports;{var t=su(),b=Au(),l=jo();const S="top",A="left",O="right",C="bottom",fe="top-left",pe="top-right",he="bottom-left",ge="bottom-right",T="start",D="middle",x="end",me="x",_e="y",k="group",y="axis",w="title",ye="frame",Te="scope",R="legend",I="row-header",M="row-footer",P="row-title",L="column-header",F="column-footer",U="column-title",be="padding",ve="symbol",Ee="fit",Se="fit-x",Ae="fit-y",Oe="pad",B="none",j="all",H="each",G="flush",V="column",W="row";function n(e){t.Transform.call(this,null,e)}function c(e,t,r){return t(e.bounds.clear(),e,r)}l.inherits(n,t.Transform,{transform(e,t){const r=t.dataflow,n=e.mark,a=n.marktype,i=b.Marks[a],o=i.bound;let s=n.bounds,l;if(i.nested)n.items.length&&r.dirty(n.items[0]),s=c(n,o),n.items.forEach(e=>{e.bounds.clear().union(s)});else if(a===k||e.modified())switch(t.visit(t.MOD,e=>r.dirty(e)),s.clear(),n.items.forEach(e=>s.union(c(e,o))),n.role){case y:case R:case w:t.reflow()}else l=t.changed(t.REM),t.visit(t.ADD,e=>{s.union(c(e,o))}),t.visit(t.MOD,e=>{l=l||s.alignsWith(e.bounds),r.dirty(e),s.union(c(e,o))}),l&&(s.clear(),n.items.forEach(e=>s.union(e.bounds)));return b.boundClip(n),t.modifies("bounds")}});const Ce=":vega_identifier:";function r(e){t.Transform.call(this,0,e)}function i(e){return e._signals[Ce]||(e._signals[Ce]=e.add(0))}function a(e){t.Transform.call(this,null,e)}function o(e){var t=e.groups,e=e.parent;return t&&1===t.size?t.get(Object.keys(t.object)[0]):t&&e?t.lookup(e):null}function s(e){t.Transform.call(this,null,e)}r.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},l.inherits(r,t.Transform,{transform(e,t){const r=i(t.dataflow),n=e.as;let a=r.value;return t.visit(t.ADD,e=>e[n]=e[n]||++a),r.set(this.value=a),t}}),l.inherits(a,t.Transform,{transform(e,t){let r=this.value;r||((r=t.dataflow.scenegraph().mark(e.markdef,o(e),e.index)).group.context=e.context,e.context.group||(e.context.group=r.group),r.source=this.source,r.clip=e.clip,r.interactive=e.interactive,this.value=r);const n=r.marktype===k?b.GroupItem:b.Item;return t.visit(t.ADD,e=>n.call(e,r)),(e.modified("clip")||e.modified("interactive"))&&(r.clip=e.clip,r.interactive=!!e.interactive,r.zdirty=!0,t.reflow()),r.items=t.source,t}});const ke={parity:e=>e.filter((e,t)=>t%2?e.opacity=0:1),greedy:(e,r)=>{let n;return e.filter((e,t)=>t&&we(n.bounds,e.bounds,r)?e.opacity=0:(n=e,1))}},we=(e,t,r)=>r>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),Re=(e,t)=>{for(var r,n=1,a=e.length,i=e[0].bounds;n<a;i=r,++n)if(we(i,r=e[n].bounds,t))return!0},Ie=e=>{e=e.bounds;return 1<e.width()&&1<e.height()},Me=(e,t,r)=>{var e=e.range(),n=new b.Bounds;return t===S||t===C?n.set(e[0],-1/0,e[1],1/0):n.set(-1/0,e[0],1/0,e[1]),n.expand(r||1),e=>n.encloses(e.bounds)},Pe=e=>(e.forEach(e=>e.opacity=1),e),Ne=(e,t)=>e.reflow(t.modified()).modifies("opacity");function u(e){t.Transform.call(this,null,e)}l.inherits(s,t.Transform,{transform(e,t){var r=ke[e.method]||ke.parity,n=e.separation||0;let a=t.materialize(t.SOURCE).source,i,o;if(a&&a.length){if(!e.method)return e.modified("method")&&(Pe(a),t=Ne(t,e)),t;if((a=a.filter(Ie)).length){if(e.sort&&(a=a.slice().sort(e.sort)),i=Pe(a),t=Ne(t,e),3<=i.length&&Re(i,n)){for(;3<=(i=r(i,n)).length&&Re(i,n););i.length<3&&!l.peek(a).opacity&&(1<i.length&&(l.peek(i).opacity=0),l.peek(a).opacity=1)}e.boundScale&&0<=e.boundTolerance&&(o=Me(e.boundScale,e.boundOrient,+e.boundTolerance),a.forEach(e=>{o(e)||(e.opacity=0)}));const s=i[0].mark.bounds.clear();return a.forEach(e=>{e.opacity&&s.union(e.bounds)}),t}}}}),l.inherits(u,t.Transform,{transform(e,t){const r=t.dataflow;t.visit(t.ALL,e=>r.dirty(e)),t.fields&&t.fields.zindex&&(t=t.source&&t.source[0])&&(t.mark.zdirty=!0)}});const q=new b.Bounds;function v(e,t,r){return e[t]===r?0:(e[t]=r,1)}function $(e){e=e.items[0].orient;return e===A||e===O}function z(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function K(e,t,r,n){var a,i=t.items[0],t=i.datum,o=null!=i.translate?i.translate:.5,s=i.orient,l=z(t),c=i.range,u=i.offset,d=i.position,f=i.minExtent,p=i.maxExtent,h=t.title&&i.items[l[2]].items[0],g=i.titlePadding,m=i.bounds,_=h&&b.multiLineOffset(h),y=0,T=0;switch(q.clear().union(m),m.clear(),-1<(t=l[0])&&m.union(i.items[t].bounds),-1<(t=l[1])&&m.union(i.items[t].bounds),s){case S:y=d||0,T=-u,a=Math.max(f,Math.min(p,-m.y1)),m.add(0,-a).add(c,0),h&&E(e,h,a,g,_,0,-1,m);break;case A:y=-u,T=d||0,a=Math.max(f,Math.min(p,-m.x1)),m.add(-a,0).add(0,c),h&&E(e,h,a,g,_,1,-1,m);break;case O:y=r+u,T=d||0,a=Math.max(f,Math.min(p,m.x2)),m.add(0,0).add(a,c),h&&E(e,h,a,g,_,1,1,m);break;case C:y=d||0,T=n+u,a=Math.max(f,Math.min(p,m.y2)),m.add(0,0).add(c,a),h&&E(e,h,a,g,0,0,1,m);break;default:y=i.x,T=i.y}return b.boundStroke(m.translate(y,T),i),v(i,"x",y+o)|v(i,"y",T+o)&&(i.bounds=q,e.dirty(i),i.bounds=m,e.dirty(i)),i.mark.bounds.clear().union(m)}function E(r,n,a,i,o,s,l,e){var c=n.bounds;if(n.auto){l=l*(a+o+i);let e=0,t=0;r.dirty(n),s?e=(n.x||0)-(n.x=l):t=(n.y||0)-(n.y=l),n.mark.bounds.clear().union(c.translate(-e,-t)),r.dirty(n)}e.union(c)}const De=(e,t)=>Math.floor(Math.min(e,t)),xe=(e,t)=>Math.ceil(Math.max(e,t));function Y(e){for(var t,r,n=e.items,a=n.length,i=0,o={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};i<a;++i)if(r=(t=n[i]).items,t.marktype===k)switch(t.role){case y:case R:case w:break;case I:o.rowheaders.push(...r);break;case M:o.rowfooters.push(...r);break;case L:o.colheaders.push(...r);break;case F:o.colfooters.push(...r);break;case P:o.rowtitle=r[0];break;case U:o.coltitle=r[0];break;default:o.marks.push(...r)}return o}function J(e){return(new b.Bounds).set(0,0,e.width||0,e.height||0)}function Z(e){var t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function N(e,t,r){t=l.isObject(e)?e[t]:e;return null!=t?t:void 0!==r?r:0}function Q(e){return e<0?Math.ceil(-e):0}function X(e,t,r){for(var n,a,i,o,s,l,c,u,d,f,p=!r.nodirty,h=r.bounds===G?J:Z,g=q.set(0,0,0,0),m=N(r.align,V),_=N(r.align,W),y=N(r.padding,V),T=N(r.padding,W),b=r.columns||t.length,v=b<=0?1:Math.ceil(t.length/b),E=t.length,S=Array(E),A=Array(b),O=0,C=Array(E),k=Array(v),w=0,R=Array(E),I=Array(E),M=Array(E),P=0;P<b;++P)A[P]=0;for(P=0;P<v;++P)k[P]=0;for(P=0;P<E;++P)s=t[P],o=M[P]=h(s),s.x=s.x||0,R[P]=0,s.y=s.y||0,I[P]=0,a=P%b,i=~~(P/b),O=Math.max(O,l=Math.ceil(o.x2)),w=Math.max(w,c=Math.ceil(o.y2)),A[a]=Math.max(A[a],l),k[i]=Math.max(k[i],c),S[P]=y+Q(o.x1),C[P]=T+Q(o.y1),p&&e.dirty(t[P]);for(P=0;P<E;++P)P%b==0&&(S[P]=0),P<b&&(C[P]=0);if(m===H)for(a=1;a<b;++a){for(f=0,P=a;P<E;P+=b)f<S[P]&&(f=S[P]);for(P=a;P<E;P+=b)S[P]=f+A[a-1]}else if(m===j){for(P=f=0;P<E;++P)P%b&&f<S[P]&&(f=S[P]);for(P=0;P<E;++P)P%b&&(S[P]=f+O)}else for(m=!1,a=1;a<b;++a)for(P=a;P<E;P+=b)S[P]+=A[a-1];if(_===H)for(i=1;i<v;++i){for(f=0,n=(P=i*b)+b;P<n;++P)f<C[P]&&(f=C[P]);for(P=i*b;P<n;++P)C[P]=f+k[i-1]}else if(_===j){for(f=0,P=b;P<E;++P)f<C[P]&&(f=C[P]);for(P=b;P<E;++P)C[P]=f+w}else for(_=!1,i=1;i<v;++i)for(n=(P=i*b)+b;P<n;++P)C[P]+=k[i-1];for(P=u=0;P<E;++P)u=S[P]+(P%b?u:0),R[P]+=u-t[P].x;for(a=0;a<b;++a)for(d=0,P=a;P<E;P+=b)d+=C[P],I[P]+=d-t[P].y;if(m&&N(r.center,V)&&1<v)for(P=0;P<E;++P)0<(u=(o=m===j?O:A[P%b])-M[P].x2-t[P].x-R[P])&&(R[P]+=u/2);if(_&&N(r.center,W)&&1!==b)for(P=0;P<E;++P)0<(d=(o=_===j?w:k[~~(P/b)])-M[P].y2-t[P].y-I[P])&&(I[P]+=d/2);for(P=0;P<E;++P)g.union(M[P].translate(R[P],I[P]));switch(u=N(r.anchor,me),d=N(r.anchor,_e),N(r.anchor,V)){case x:u-=g.width();break;case D:u-=g.width()/2}switch(N(r.anchor,W)){case x:d-=g.height();break;case D:d-=g.height()/2}for(u=Math.round(u),d=Math.round(d),g.clear(),P=0;P<E;++P)t[P].mark.bounds.clear();for(P=0;P<E;++P)(s=t[P]).x+=R[P]+=u,s.y+=I[P]+=d,g.union(s.mark.bounds.union(s.bounds.translate(R[P],I[P]))),p&&e.dirty(s);return g}function p(e,t,r){var n,a,i,o,s,l,c,t=Y(t),u=t.marks,d=r.bounds===G?ee:te,f=r.offset,p=r.columns||u.length,h=p<=0?1:Math.ceil(u.length/p),g=h*p,m=X(e,u,r);m.empty()&&m.set(0,0,0,0),t.rowheaders&&(l=N(r.headerBand,W,null),n=_(e,t.rowheaders,u,0,h,-N(f,"rowHeader"),De,0,d,"x1",0,p,1,l)),t.colheaders&&(l=N(r.headerBand,V,null),a=_(e,t.colheaders,u,0,p,-N(f,"columnHeader"),De,1,d,"y1",0,1,p,l)),t.rowfooters&&(l=N(r.footerBand,W,null),i=_(e,t.rowfooters,u,0,h,N(f,"rowFooter"),xe,0,d,"x2",p-1,p,1,l)),t.colfooters&&(l=N(r.footerBand,V,null),o=_(e,t.colfooters,u,0,p,N(f,"columnFooter"),xe,1,d,"y2",g-p,1,p,l)),t.rowtitle&&(s=N(r.titleAnchor,W),c=N(f,"rowTitle"),c=s===x?i+c:n-c,l=N(r.titleBand,W,.5),re(e,t.rowtitle,c,0,m,l)),t.coltitle&&(s=N(r.titleAnchor,V),c=N(f,"columnTitle"),c=s===x?o+c:a-c,l=N(r.titleBand,V,.5),re(e,t.coltitle,c,1,m,l))}function ee(e,t){return"x1"===t?e.x||0:"y1"===t?e.y||0:"x2"===t?(e.x||0)+(e.width||0):"y2"===t?(e.y||0)+(e.height||0):void 0}function te(e,t){return e.bounds[t]}function _(e,t,r,n,a,i,o,s,l,c,u,d,f,p){var h,g,m,_,y,T,b,v,E,S=r.length,A=0,O=0;if(!S)return A;for(h=u;h<S;h+=d)r[h]&&(A=o(A,l(r[h],c)));if(!t.length)return A;for(t.length>a&&(e.warn("Grid headers exceed limit: "+a),t=t.slice(0,a)),A+=i,g=0,_=t.length;g<_;++g)e.dirty(t[g]),t[g].mark.bounds.clear();for(h=u,g=0,_=t.length;g<_;++g,h+=d){for(y=(T=t[g]).mark.bounds,m=h;0<=m&&null==(b=r[m]);m-=f);E=s?(v=null==p?b.x:Math.round(b.bounds.x1+p*b.bounds.width()),A):(v=A,null==p?b.y:Math.round(b.bounds.y1+p*b.bounds.height())),y.union(T.bounds.translate(v-(T.x||0),E-(T.y||0))),T.x=v,T.y=E,e.dirty(T),O=o(O,y[c])}return O}function re(e,t,r,n,a,i){var o;t&&(e.dirty(t),o=r=r,n?r=Math.round(a.x1+i*a.width()):o=Math.round(a.y1+i*a.height()),t.bounds.translate(r-(t.x||0),o-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=r,t.y=o,e.dirty(t))}function h(r,e){const n=r[e]||{};return(e,t)=>null!=n[e]?n[e]:null!=r[e]?r[e]:t}function g(e,t){let r=-1/0;return e.forEach(e=>{null!=e.offset&&(r=Math.max(r,e.offset))}),r>-1/0?r:t}function ne(e,t,r,n,a,i,o){var r=h(r,t),s=g(e,r("offset",0)),l=r("anchor",T),c=l===x?1:l===D?.5:0,u={align:H,bounds:r("bounds",G),columns:"vertical"===r("direction")?1:e.length,padding:r("margin",8),center:r("center"),nodirty:!0};switch(t){case A:u.anchor={x:Math.floor(n.x1)-s,column:x,y:c*(o||n.height()+2*n.y1),row:l};break;case O:u.anchor={x:Math.ceil(n.x2)+s,y:c*(o||n.height()+2*n.y1),row:l};break;case S:u.anchor={y:Math.floor(a.y1)-s,row:x,x:c*(i||a.width()+2*a.x1),column:l};break;case C:u.anchor={y:Math.ceil(a.y2)+s,x:c*(i||a.width()+2*a.x1),column:l};break;case fe:u.anchor={x:s,y:s};break;case pe:u.anchor={x:i-s,y:s,column:x};break;case he:u.anchor={x:s,y:o-s,row:x};break;case ge:u.anchor={x:i-s,y:o-s,column:x,row:x}}return u}function ae(e,t){var r,t=t.items[0],n=t.datum,a=t.orient,i=t.bounds,o=t.x,s=t.y;return t._bounds?t._bounds.clear().union(i):t._bounds=i.clone(),i.clear(),ie(e,t,t.items[0].items[0]),i=m(t,i),e=2*t.padding,r=2*t.padding,i.empty()||(e=Math.ceil(i.width()+e),r=Math.ceil(i.height()+r)),n.type===ve&&oe(t.items[0].items[0].items[0].items),a!==B&&(t.x=o=0,t.y=s=0),t.width=e,t.height=r,b.boundStroke(i.set(o,s,o+e,s+r),t),t.mark.bounds.clear().union(i),t}function m(e,t){return e.items.forEach(e=>t.union(e.bounds)),t.x1=e.padding,t.y1=e.padding,t}function ie(e,t,r){var n=t.padding,a=n-r.x,i=n-r.y;if(t.datum.title){var o=t.items[1].items[0],s=o.anchor,l=t.titlePadding||0,c=n-o.x,u=n-o.y;switch(o.orient){case A:a+=Math.ceil(o.bounds.width())+l;break;case O:case C:break;default:i+=o.bounds.height()+l}switch((a||i)&&f(e,r,a,i),o.orient){case A:u+=d(t,r,o,s,1,1);break;case O:c+=d(t,r,o,x,0,0)+l,u+=d(t,r,o,s,1,1);break;case C:c+=d(t,r,o,s,0,0),u+=d(t,r,o,x,-1,0,1)+l;break;default:c+=d(t,r,o,s,0,0)}(c||u)&&f(e,o,c,u),(c=Math.round(o.bounds.x1-n))<0&&(f(e,r,-c,0),f(e,o,-c,0))}else(a||i)&&f(e,r,a,i)}function d(e,t,r,n,a,i,o){var s="symbol"!==e.datum.type,l=r.datum.vgrad,s=(!s||!i&&l||o?t:t.items[0]).bounds[a?"y2":"x2"]-e.padding,o=l&&i?s:0,t=l&&i?0:s,e=a<=0?0:b.multiLineOffset(r);return Math.round(n===T?o:n===x?t-e:.5*(s-e))}function f(e,t,r,n){t.x+=r,t.y+=n,t.bounds.translate(r,n),t.mark.bounds.translate(r,n),e.dirty(t)}function oe(e){const t=e.reduce((e,t)=>(e[t.column]=Math.max(t.bounds.x2-t.x,e[t.column]||0),e),{});e.forEach(e=>{e.width=t[e.column],e.height=e.bounds.y2-e.y})}function se(e,t,r,n,a){var i,o=t.items[0],s=o.frame,l=o.orient,c=o.anchor,u=o.offset,d=o.padding,f=o.items[0].items[0],p=o.items[1]&&o.items[1].items[0],r=l===A||l===O?n:r,h=0,g=0,m=0,_=0,y=0;if(s!==k?r=l===A?(h=a.y2,a.y1):l===O?(h=a.y1,a.y2):(h=a.x1,a.x2):l===A&&(h=n,r=0),i=c===T?h:c===x?r:(h+r)/2,p&&p.text){switch(l){case S:case C:y=f.bounds.height()+d;break;case A:_=f.bounds.width()+d;break;case O:_=-f.bounds.width()-d}q.clear().union(p.bounds),q.translate(_-(p.x||0),y-(p.y||0)),v(p,"x",_)|v(p,"y",y)&&(e.dirty(p),p.bounds.clear().union(q),p.mark.bounds.clear().union(q),e.dirty(p)),q.clear().union(p.bounds)}else q.clear();switch(q.union(f.bounds),l){case S:g=i,m=a.y1-q.height()-u;break;case A:g=a.x1-q.width()-u,m=i;break;case O:g=a.x2+q.width()+u,m=i;break;case C:g=i,m=a.y2+u;break;default:g=o.x,m=o.y}return v(o,"x",g)|v(o,"y",m)&&(q.translate(g,m),e.dirty(o),o.bounds.clear().union(q),t.bounds.clear().union(q),e.dirty(o)),o.bounds}function le(e){t.Transform.call(this,null,e)}function ce(e){return e&&"legend-entry"!==e.mark.role}function ue(r,e,n){for(var t,a,i,o=e.items,s=Math.max(0,e.width||0),l=Math.max(0,e.height||0),c=(new b.Bounds).set(0,0,s,l),u=c.clone(),d=c.clone(),f=[],p=0,h=o.length;p<h;++p)switch((a=o[p]).role){case y:($(a)?u:d).union(K(r,a,s,l));break;case w:t=a;break;case R:f.push(ae(r,a));break;case ye:case Te:case I:case M:case P:case L:case F:case U:u.union(a.bounds),d.union(a.bounds);break;default:c.union(a.bounds)}if(f.length){const m={};f.forEach(e=>{(i=e.orient||O)!==B&&(m[i]||(m[i]=[])).push(e)});for(const i in m){var g=m[i];X(r,g,ne(g,i,n.legends,u,d,s,l))}f.forEach(e=>{var t=e.bounds;if(t.equals(e._bounds)||(e.bounds=e._bounds,r.dirty(e),e.bounds=t,r.dirty(e)),!n.autosize||n.autosize.type!==Ee&&n.autosize.type!==Se&&n.autosize.type!==Ae)c.union(t);else switch(e.orient){case A:case O:c.add(t.x1,0).add(t.x2,0);break;case S:case C:c.add(0,t.y1).add(0,t.y2)}})}c.union(u).union(d),t&&c.union(se(r,t,s,l,c)),e.clip&&c.set(0,0,e.width||0,e.height||0),de(r,e,c,n)}function de(o,s,l,c){var c=c.autosize||{},u=c.type;if(!(o._autosize<1)&&u){let e=o._width,t=o._height,r=Math.max(0,s.width||0),n=Math.max(0,Math.ceil(-l.x1)),a=Math.max(0,s.height||0),i=Math.max(0,Math.ceil(-l.y1));var d,s=Math.max(0,Math.ceil(l.x2-r)),l=Math.max(0,Math.ceil(l.y2-a));c.contains===be&&(d=o.padding(),e-=d.left+d.right,t-=d.top+d.bottom),u===B?(n=0,i=0,r=e,a=t):u===Ee?(r=Math.max(0,e-n-s),a=Math.max(0,t-i-l)):u===Se?(r=Math.max(0,e-n-s),t=a+i+l):u===Ae?(e=r+n+s,a=Math.max(0,t-i-l)):u===Oe&&(e=r+n+s,t=a+i+l),o._resizeView(e,t,r,a,[n,i],c.resize)}}l.inherits(le,t.Transform,{transform(t,e){const r=e.dataflow;return t.mark.items.forEach(e=>{t.layout&&p(r,e,t.layout),ue(r,e,t)}),ce(t.mark.group)?e.reflow():e}}),e.bound=n,e.identifier=r,e.mark=a,e.overlap=s,e.render=u,e.viewlayout=le}}return gu.exports}var Cu,ku={exports:{}};function wu(){if(!Cu){Cu=1;var e=ku.exports;{var m=su(),_=Su(),y=jo();function t(e){m.Transform.call(this,null,e)}function r(e){m.Transform.call(this,null,e)}function L(){return m.ingest({})}function F(t){const r=y.fastmap().test(e=>e.exit);return r.lookup=e=>r.get(t(e)),r}function n(e){m.Transform.call(this,null,e)}function U(e){m.Transform.call(this,[],e)}y.inherits(t,m.Transform,{transform(e,t){var r,n,a,i,o,s;return this.value&&!e.modified()?t.StopPropagation:(r=t.dataflow.locale(),t=t.fork(t.NO_SOURCE|t.NO_FIELDS),n=this.value,a=e.scale,i=null==e.count?e.values?e.values.length:10:e.count,i=_.tickCount(a,i,e.minstep),o=e.format||_.tickFormat(r,a,i,e.formatSpecifier,e.formatType,!!e.values),s=e.values?_.validTicks(a,e.values,i):_.tickValues(a,i),n&&(t.rem=n),n=s.map((e,t)=>m.ingest({index:t/(s.length-1||1),value:e,label:o(e)})),e.extra&&n.length&&n.push(m.ingest({index:-1,extra:{value:n[0].value},label:""})),t.source=n,t.add=n,this.value=n,t)}}),y.inherits(r,m.Transform,{transform(e,t){var r=t.dataflow,n=t.fork(t.NO_SOURCE|t.NO_FIELDS),a=e.item||L,i=e.key||m.tupleid,o=this.value;return y.isArray(n.encode)&&(n.encode=null),o&&(e.modified("key")||t.modified(i))&&y.error("DataJoin does not support modified key function or fields."),o||(t=t.addAll(),this.value=o=F(i)),t.visit(t.ADD,e=>{var t=i(e);let r=o.get(t);(r?r.exit?(o.empty--,n.add):n.mod:(r=a(e),o.set(t,r),n.add)).push(r),r.datum=e,r.exit=!1}),t.visit(t.MOD,e=>{var t=i(e),t=o.get(t);t&&(t.datum=e,n.mod.push(t))}),t.visit(t.REM,e=>{var t=i(e),t=o.get(t);e!==t.datum||t.exit||(n.rem.push(t),t.exit=!0,++o.empty)}),t.changed(t.ADD_MOD)&&n.modifies("datum"),(t.clean()||e.clean&&o.empty>r.cleanThreshold)&&r.runAfter(o.clean),n}}),y.inherits(n,m.Transform,{transform(r,e){var n=e.fork(e.ADD_REM),a=r.mod||!1,t=r.encoders,i=e.encode;if(y.isArray(i)){if(!n.changed()&&!i.every(e=>t[e]))return e.StopPropagation;i=i[0],n.encode=null}var o="enter"===i,s=t.update||y.falsy,l=t.enter||y.falsy,c=t.exit||y.falsy,u=(i&&!o?t[i]:s)||y.falsy;return e.changed(e.ADD)&&(e.visit(e.ADD,e=>{l(e,r),s(e,r)}),n.modifies(l.output),n.modifies(s.output),u!==y.falsy)&&u!==s&&(e.visit(e.ADD,e=>{u(e,r)}),n.modifies(u.output)),e.changed(e.REM)&&c!==y.falsy&&(e.visit(e.REM,e=>{c(e,r)}),n.modifies(c.output)),(o||u!==y.falsy)&&(i=e.MOD|(r.modified()?e.REFLOW:0),o?(e.visit(i,e=>{var t=l(e,r)||a;(u(e,r)||t)&&n.mod.push(e)}),n.mod.length&&n.modifies(l.output)):e.visit(i,e=>{(u(e,r)||a)&&n.mod.push(e)}),n.mod.length)&&n.modifies(u.output),n.changed()?n:e.StopPropagation}}),y.inherits(U,m.Transform,{transform(r,e){var t,n,a,i,o,s,l,c,u,d,f,p,h,g;return null==this.value||r.modified()?(d=e.dataflow.locale(),t=e.fork(e.NO_SOURCE|e.NO_FIELDS),n=this.value,a=r.type||_.SymbolLegend,i=r.scale,o=+r.limit,s=_.tickCount(i,null==r.count?5:r.count,r.minstep),l=!!r.values||a===_.SymbolLegend,c=r.format||_.labelFormat(d,i,s,a,r.formatSpecifier,r.formatType,l),u=r.values||_.labelValues(i,s),n&&(t.rem=n),a===_.SymbolLegend?(o&&u.length>o?(e.dataflow.warn("Symbol legend count exceeds limit, filtering items."),n=u.slice(0,o-1),g=!0):n=u,y.isFunction(p=r.size)?(r.values||0!==i(n[0])||(n=n.slice(1)),h=n.reduce((e,t)=>Math.max(e,p(t,r)),0)):p=y.constant(h=p||8),n=n.map((e,t)=>m.ingest({index:t,label:c(e,t,n),value:e,offset:h,size:p(e,r)})),g&&(g=u[n.length],n.push(m.ingest({index:n.length,label:`…${u.length-n.length} entries`,value:g,offset:h,size:p(g,r)})))):n=a===_.GradientLegend?(d=i.domain(),f=_.scaleFraction(i,d[0],y.peek(d)),(u=u.length<3&&!r.values&&d[0]!==y.peek(d)?[d[0],y.peek(d)]:u).map((e,t)=>m.ingest({index:t,label:c(e,t,u),value:e,perc:f(e)}))):(p=u.length-1,f=_.labelFraction(i),u.map((e,t)=>m.ingest({index:t,label:c(e,t,u),value:e,perc:t?f(e):0,perc2:t===p?1:f(u[t+1])}))),t.source=n,t.add=n,this.value=n,t):e.StopPropagation}});const Ge=e=>e.source.x,Ve=e=>e.source.y,We=e=>e.target.x,qe=e=>e.target.y;function a(e){m.Transform.call(this,{},e)}a.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},y.inherits(a,m.Transform,{transform(e,t){var r=e.sourceX||Ge,n=e.sourceY||Ve,a=e.targetX||We,i=e.targetY||qe,o=e.as||"path",s=e.orient||"vertical",l=e.shape||"line",c=D.get(l+"-"+s)||D.get(l);return c||y.error("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,e=>{e[o]=c(r(e),n(e),a(e),i(e))}),t.reflow(e.modified()).modifies(o)}});const M=(e,t,r,n)=>"M"+e+","+t+"L"+r+","+n,$e=(e,t,r,n)=>M(t*Math.cos(e),t*Math.sin(e),n*Math.cos(r),n*Math.sin(r)),P=(e,t,r,n)=>{var a=r-e,i=n-t,o=Math.hypot(a,i)/2;return"M"+e+","+t+"A"+o+","+o+" "+180*Math.atan2(i,a)/Math.PI+" 0 1 "+r+","+n},ze=(e,t,r,n)=>P(t*Math.cos(e),t*Math.sin(e),n*Math.cos(r),n*Math.sin(r)),N=(e,t,r,n)=>{var a=r-e,i=n-t,o=.2*(a+i),i=.2*(i-a);return"M"+e+","+t+"C"+(e+o)+","+(t+i)+" "+(r+i)+","+(n-o)+" "+r+","+n},Ke=(e,t,r,n)=>N(t*Math.cos(e),t*Math.sin(e),n*Math.cos(r),n*Math.sin(r)),Ye=(e,t,r,n)=>"M"+e+","+t+"V"+n+"H"+r,Je=(e,t,r,n)=>"M"+e+","+t+"H"+r+"V"+n,Ze=(e,t,r,n)=>{var a=Math.cos(e),i=Math.sin(e),o=Math.cos(r),s=Math.sin(r);return"M"+t*a+","+t*i+"A"+t+","+t+" 0 0,"+((Math.abs(r-e)>Math.PI?r<=e:e<r)?1:0)+" "+t*o+","+t*s+"L"+n*o+","+n*s},Qe=(e,t,r,n)=>{var a=(e+r)/2;return"M"+e+","+t+"C"+a+","+t+" "+a+","+n+" "+r+","+n},Xe=(e,t,r,n)=>{var a=(t+n)/2;return"M"+e+","+t+"C"+e+","+a+" "+r+","+a+" "+r+","+n},et=(e,t,r,n)=>{var a=Math.cos(e),e=Math.sin(e),i=Math.cos(r),r=Math.sin(r),o=(t+n)/2;return"M"+t*a+","+t*e+"C"+o*a+","+o*e+" "+o*i+","+o*r+" "+n*i+","+n*r},D=y.fastmap({line:M,"line-radial":$e,arc:P,"arc-radial":ze,curve:N,"curve-radial":Ke,"orthogonal-horizontal":Ye,"orthogonal-vertical":Je,"orthogonal-radial":Ze,"diagonal-horizontal":Qe,"diagonal-vertical":Xe,"diagonal-radial":et});function B(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=0|Math.max(0,Math.ceil((t-e)/r)),i=new Array(a);++n<a;)i[n]=e+n*r;return i}function j(e){let t=0;for(var r of e)(r=+r)&&(t+=r);return t}function i(e){m.Transform.call(this,null,e)}function o(e,t,r){(e.prototype=t.prototype=r).constructor=e}function H(e,t){var r,n=Object.create(e.prototype);for(r in t)n[r]=t[r];return n}function c(){}i.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},y.inherits(i,m.Transform,{transform(e,t){var r,n,a,i=e.as||["startAngle","endAngle"],o=i[0],s=i[1],l=e.field||y.one,c=e.startAngle||0,u=null!=e.endAngle?e.endAngle:2*Math.PI,d=t.source,f=d.map(l),p=f.length,h=c,g=(u-c)/j(f),m=B(p);for(e.sort&&m.sort((e,t)=>f[e]-f[t]),r=0;r<p;++r)a=f[m[r]],(n=d[m[r]])[o]=h,n[s]=h+=a*g;return this.value=f,t.reflow(e.modified()).modifies(i)}});var s="\\s*([+-]?\\d+)\\s*",l="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",u="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",G=/^#([0-9a-f]{3,8})$/,V=new RegExp(`^rgb\\(${s},${s},${s}\\)$`),W=new RegExp(`^rgb\\(${u},${u},${u}\\)$`),q=new RegExp(`^rgba\\(${s},${s},${s},${l}\\)$`),$=new RegExp(`^rgba\\(${u},${u},${u},${l}\\)$`),z=new RegExp(`^hsl\\(${l},${u},${u}\\)$`),K=new RegExp(`^hsla\\(${l},${u},${u},${l}\\)$`),Y={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function J(){return this.rgb().formatHex()}function Z(){return this.rgb().formatHex8()}function Q(){return oe(this).formatHsl()}function X(){return this.rgb().formatRgb()}function d(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=G.exec(e))?(r=t[1].length,t=parseInt(t[1],16),6===r?ee(t):3===r?new h(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===r?f(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===r?f(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=V.exec(e))?new h(t[1],t[2],t[3],1):(t=W.exec(e))?new h(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=q.exec(e))?f(t[1],t[2],t[3],t[4]):(t=$.exec(e))?f(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=z.exec(e))?ie(t[1],t[2]/100,t[3]/100,1):(t=K.exec(e))?ie(t[1],t[2]/100,t[3]/100,t[4]):Y.hasOwnProperty(e)?ee(Y[e]):"transparent"===e?new h(NaN,NaN,NaN,0):null}function ee(e){return new h(e>>16&255,e>>8&255,255&e,1)}function f(e,t,r,n){return new h(e=n<=0?t=r=NaN:e,t,r,n)}function te(e){return(e=e instanceof c?e:d(e))?new h((e=e.rgb()).r,e.g,e.b,e.opacity):new h}function p(e,t,r,n){return 1===arguments.length?te(e):new h(e,t,r,null==n?1:n)}function h(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}function re(){return"#"+b(this.r)+b(this.g)+b(this.b)}function ne(){return"#"+b(this.r)+b(this.g)+b(this.b)+b(255*(isNaN(this.opacity)?1:this.opacity))}function ae(){var e=g(this.opacity);return(1===e?"rgb(":"rgba(")+T(this.r)+`, ${T(this.g)}, `+T(this.b)+(1===e?")":`, ${e})`)}function g(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function T(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function b(e){return((e=T(e))<16?"0":"")+e.toString(16)}function ie(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||1<=r?e=t=NaN:t<=0&&(e=NaN),new v(e,t,r,n)}function oe(e){var t,r,n,a,i,o,s,l;return e instanceof v?new v(e.h,e.s,e.l,e.opacity):(e=e instanceof c?e:d(e))?e instanceof v?e:(t=(e=e.rgb()).r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),o=NaN,l=((i=Math.max(t,r,n))+a)/2,(s=i-a)?(o=t===i?(r-n)/s+6*(r<n):r===i?(n-t)/s+2:(t-r)/s+4,s/=l<.5?i+a:2-i-a,o*=60):s=0<l&&l<1?0:o,new v(o,s,l,e.opacity)):new v}function se(e,t,r,n){return 1===arguments.length?oe(e):new v(e,t,r,null==n?1:n)}function v(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}function le(e){return(e=(e||0)%360)<0?e+360:e}function E(e){return Math.max(0,Math.min(1,e||0))}function S(e,t,r){return 255*(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)}o(c,d,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:J,formatHex:J,formatHex8:Z,formatHsl:Q,formatRgb:X,toString:X}),o(h,p,H(c,{brighter(e){return e=null==e?1/.7:Math.pow(1/.7,e),new h(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new h(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new h(T(this.r),T(this.g),T(this.b),g(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:re,formatHex:re,formatHex8:ne,formatRgb:ae,toString:ae})),o(v,se,H(c,{brighter(e){return e=null==e?1/.7:Math.pow(1/.7,e),new v(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new v(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,t=r+(r<.5?r:1-r)*t,r=2*r-t;return new h(S(240<=e?e-240:120+e,r,t),S(e,r,t),S(e<120?240+e:e-120,r,t),this.opacity)},clamp(){return new v(le(this.h),E(this.s),E(this.l),g(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){var e=g(this.opacity);return(1===e?"hsl(":"hsla(")+le(this.h)+`, ${100*E(this.s)}%, ${100*E(this.l)}%`+(1===e?")":`, ${e})`)}}));var A=e=>()=>e;function ce(t,r){return function(e){return t+e*r}}function ue(t,r,n){return t=Math.pow(t,n),r=Math.pow(r,n)-t,n=1/n,function(e){return Math.pow(t+e*r,n)}}function de(r){return 1==(r=+r)?fe:function(e,t){return t-e?ue(e,t,r):A(isNaN(e)?t:e)}}function fe(e,t){var r=t-e;return r?ce(e,r):A(isNaN(e)?t:e)}var pe=function e(t){var o=de(t);function r(t,e){var r=o((t=p(t)).r,(e=p(e)).r),n=o(t.g,e.g),a=o(t.b,e.b),i=fe(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=n(e),t.b=a(e),t.opacity=i(e),t+""}}return r.gamma=e,r}(1);function he(t,r){r=r||[];var n,a=t?Math.min(r.length,t.length):0,i=r.slice();return function(e){for(n=0;n<a;++n)i[n]=t[n]*(1-e)+r[n]*e;return i}}function ge(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function me(e,t){for(var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),o=0;o<n;++o)a[o]=w(e[o],t[o]);for(;o<r;++o)i[o]=t[o];return function(e){for(o=0;o<n;++o)i[o]=a[o](e);return i}}function _e(t,r){var n=new Date;return t=+t,r=+r,function(e){return n.setTime(t*(1-e)+r*e),n}}function O(t,r){return t=+t,r=+r,function(e){return t*(1-e)+r*e}}function ye(e,t){var r,n={},a={};for(r in null!==e&&"object"==typeof e||(e={}),t=null!==t&&"object"==typeof t?t:{})r in e?n[r]=w(e[r],t[r]):a[r]=t[r];return function(e){for(r in n)a[r]=n[r](e);return a}}var C=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,k=new RegExp(C.source,"g");function Te(e){return function(){return e}}function be(t){return function(e){return t(e)+""}}function ve(e,n){var t,r,a,i=C.lastIndex=k.lastIndex=0,o=-1,s=[],l=[];for(e+="",n+="";(t=C.exec(e))&&(r=k.exec(n));)(a=r.index)>i&&(a=n.slice(i,a),s[o]?s[o]+=a:s[++o]=a),(t=t[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,l.push({i:o,x:O(t,r)})),i=k.lastIndex;return i<n.length&&(a=n.slice(i),s[o]?s[o]+=a:s[++o]=a),s.length<2?l[0]?be(l[0].x):Te(n):(n=l.length,function(e){for(var t,r=0;r<n;++r)s[(t=l[r]).i]=t.x(e);return s.join("")})}function w(e,t){var r=typeof t;return null==t||"boolean"==r?A(t):("number"==r?O:"string"==r?(r=d(t))?(t=r,pe):ve:t instanceof d?pe:t instanceof Date?_e:ge(t)?he:Array.isArray(t)?me:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?ye:O)(e,t)}function Ee(t,r){return t=+t,r=+r,function(e){return Math.round(t*(1-e)+r*e)}}const tt=5;function Se(e){var t=e.type;return!e.bins&&(t===_.Linear||t===_.Pow||t===_.Sqrt)}function Ae(e){return _.isContinuous(e)&&e!==_.Sequential}const rt=y.toSet(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function Oe(e){m.Transform.call(this,null,e),this.modified(!0)}function Ce(e){var t=e.type,r="";return t===_.Sequential?_.Sequential+"-"+_.Linear:((r=ke(e)?2===(e=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(null!=e.domainMid):0)?_.Sequential+"-":3===e?_.Diverging+"-":"":r)+t||_.Linear).toLowerCase()}function ke(e){var t=e.type;return _.isContinuous(t)&&t!==_.Time&&t!==_.UTC&&(e.scheme||e.range&&e.range.length&&e.range.every(y.isString))}function we(e,t,r){var n,a,i,o,s=Re(e,t.domainRaw,r);return-1<s?s:(s=t.domain,n=e.type,a=t.zero||void 0===t.zero&&Se(e),s?(!a&&null==t.domainMin&&null==t.domainMax&&null==t.domainMid||(o=(s=s.slice()).length-1||1,a&&(0<s[0]&&(s[0]=0),s[o]<0)&&(s[o]=0),null!=t.domainMin&&(s[0]=t.domainMin),null!=t.domainMax&&(s[o]=t.domainMax),null==t.domainMid)||((i=(a=t.domainMid)>s[o]?o+1:a<s[0]?0:o)!==o&&r.warn("Scale domainMid exceeds domain min or max.",a),s.splice(i,0,a)),Ae(n)&&t.padding&&s[0]!==y.peek(s)&&(s=Ie(n,s,t.range,t.padding,t.exponent,t.constant)),e.domain(Me(n,s,r)),n===_.Ordinal&&e.unknown(t.domainImplicit?_.scaleImplicit:void 0),t.nice&&e.nice&&e.nice(!0!==t.nice&&_.tickCount(e,t.nice)||null),s.length):0)}function Re(e,t,r){return t?(e.domain(Me(e.type,t,r)),t.length):-1}function Ie(e,t,r,n,a,i){r=Math.abs(y.peek(r)-r[0]),r/=r-2*n,n=e===_.Log?y.zoomLog(t,null,r):e===_.Sqrt?y.zoomPow(t,null,r,.5):e===_.Pow?y.zoomPow(t,null,r,a||1):e===_.Symlog?y.zoomSymlog(t,null,r,i||1):y.zoomLinear(t,null,r);return(t=t.slice())[0]=n[0],t[t.length-1]=n[1],t}function Me(e,t,r){return _.isLogarithmic(e)&&Math.abs(t.reduce((e,t)=>e+(t<0?-1:0<t?1:0),0))!==t.length&&r.warn("Log scale domain includes zero: "+y.stringValue(t)),t}function Pe(r,e,t){let n=e.bins;if(n&&!y.isArray(n)){var a=r.domain(),i=a[0],a=y.peek(a),o=n.step;let e=null==n.start?i:n.start,t=null==n.stop?a:n.stop;o||y.error("Scale bins parameter missing step property."),e<i&&(e=o*Math.ceil(i/o)),t>a&&(t=o*Math.floor(a/o)),n=B(e,t+o/2,o)}return n?r.bins=n:r.bins&&delete r.bins,r.type===_.BinOrdinal&&(n?e.domain||e.domainRaw||(r.domain(n),t=n.length):r.bins=r.domain()),t}function Ne(e,t,r){var n=e.type,a=t.round||!1,i=t.range;if(null!=t.rangeStep)i=De(n,t,r);else if(t.scheme&&(i=xe(n,t,r),y.isFunction(i))){if(e.interpolator)return e.interpolator(i);y.error(`Scale type ${n} does not support interpolating color schemes.`)}if(i&&_.isInterpolating(n))return e.interpolator(_.interpolateColors(R(i,t.reverse),t.interpolate,t.interpolateGamma));i&&t.interpolate&&e.interpolate?e.interpolate(_.interpolate(t.interpolate,t.interpolateGamma)):y.isFunction(e.round)?e.round(a):y.isFunction(e.rangeRound)&&e.interpolate(a?Ee:w),i&&e.range(R(i,t.reverse))}function De(e,t,r){e!==_.Band&&e!==_.Point&&y.error("Only band and point scales support rangeStep.");var n=(null!=t.paddingOuter?t.paddingOuter:t.padding)||0,e=e===_.Point?1:(null!=t.paddingInner?t.paddingInner:t.padding)||0;return[0,t.rangeStep*_.bandSpace(r,e,n)]}function xe(e,t,r){var n,a,i=t.schemeExtent;return y.isArray(t.scheme)?a=_.interpolateColors(t.scheme,t.interpolate,t.interpolateGamma):(n=t.scheme.toLowerCase(),(a=_.scheme(n))||y.error("Unrecognized scheme name: "+t.scheme)),r=e===_.Threshold?r+1:e===_.BinOrdinal?r-1:e===_.Quantile||e===_.Quantize?+t.schemeCount||tt:r,_.isInterpolating(e)?Le(a,i,t.reverse):y.isFunction(a)?_.quantizeInterpolator(Le(a,i),r):e===_.Ordinal?a:a.slice(0,r)}function Le(e,t,r){return y.isFunction(e)&&(t||r)?_.interpolateRange(e,R(t||[0,1],r)):e}function R(e,t){return t?e.slice().reverse():e}function Fe(e){m.Transform.call(this,null,e)}y.inherits(Oe,m.Transform,{transform(e,t){var r=t.dataflow,n=this.value,a=Ce(e);for(a in n&&a===n.type||(this.value=n=_.scale(a)()),e)if(!rt[a]){if("padding"===a&&Ae(n.type))continue;y.isFunction(n[a])?n[a](e[a]):r.warn("Unsupported scale property: "+a)}return Ne(n,e,Pe(n,e,we(n,e,r))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),y.inherits(Fe,m.Transform,{transform(e,t){var r=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return r&&t.source.sort(m.stableCompare(e.sort)),this.modified(r),t}});const x=["y0","y1"];function I(e){m.Transform.call(this,null,e)}function Ue(e,t,r,n,a){for(var i,o=(t-e.sum)/2,s=e.length,l=0;l<s;++l)(i=e[l])[n]=o,i[a]=o+=Math.abs(r(i))}function Be(e,t,r,n,a){for(var i,o=1/e.sum,s=0,l=e.length,c=0,u=0;c<l;++c)(i=e[c])[n]=s,i[a]=s=o*(u+=Math.abs(r(i)))}function je(e,t,r,n,a){for(var i,o,s=0,l=0,c=e.length,u=0;u<c;++u)(i=+r(o=e[u]))<0?(o[n]=l,o[a]=l+=i):(o[n]=s,o[a]=s+=i)}function He(e,t,r,n){var a,i,o,s,l,c,u,d,f,p=[],h=e=>e(l);if(null==t)p.push(e.slice());else for(a={},i=0,o=e.length;i<o;++i)l=e[i],(u=a[c=t.map(h)])||(a[c]=u=[],p.push(u)),u.push(l);for(f=c=0,s=p.length;c<s;++c){for(d=i=0,o=(u=p[c]).length;i<o;++i)d+=Math.abs(n(u[i]));f<(u.sum=d)&&(f=d),r&&u.sort(r)}return p.max=f,p}I.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:"zero",values:["zero","center","normalize"]},{name:"as",type:"string",array:!0,length:2,default:x}]},y.inherits(I,m.Transform,{transform(e,t){for(var r=e.as||x,n=r[0],a=r[1],i=m.stableCompare(e.sort),o=e.field||y.one,s="center"===e.offset?Ue:"normalize"===e.offset?Be:je,l=He(t.source,e.groupby,i,o),c=0,u=l.length,d=l.max;c<u;++c)s(l[c],d,o,n,a);return t.reflow(e.modified()).modifies(r)}}),e.axisticks=t,e.datajoin=r,e.encode=n,e.legendentries=U,e.linkpath=a,e.pie=i,e.scale=Oe,e.sortitems=Fe,e.stack=I}}return ku.exports}var Ru,Iu,Mu={exports:{}},Pu={exports:{}};function Nu(){if(!Ru){Ru=1;var O=Pu.exports;{var C=Su();class H{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){var r=this._partials;let n=0;for(let e=0;e<this._n&&e<32;e++){var a=r[e],i=t+a,a=Math.abs(t)<Math.abs(a)?t-(i-a):a-(i-t);a&&(r[n++]=a),t=i}return r[n]=t,this._n=n+1,this}valueOf(){var e=this._partials;let t=this._n,r,n,a,i=0;if(0<t){for(i=e[--t];0<t&&(r=i,n=e[--t],i=r+n,!(a=n-(i-r))););0<t&&(a<0&&e[t-1]<0||0<a&&0<e[t-1])&&(n=2*a,r=i+n,n==r-i)&&(i=r)}return i}}function*G(e){for(const t of e)yield*t}function V(e){return Array.from(G(e))}var I=1e-6,W=1e-12,k=Math.PI,w=k/2,q=k/4,R=2*k,M=180/k,P=k/180,N=Math.abs,s=Math.atan,D=Math.atan2,x=Math.cos,$=Math.exp,z=Math.log,K=Math.pow,L=Math.sin,l=Math.sign||function(e){return 0<e?1:e<0?-1:0},F=Math.sqrt,Y=Math.tan;function J(e){return 1<e?0:e<-1?k:Math.acos(e)}function U(e){return 1<e?w:e<-1?-w:Math.asin(e)}function e(){}function Z(e,t){e&&X.hasOwnProperty(e.type)&&X[e.type](e,t)}var Q={Feature:function(e,t){Z(e.geometry,t)},FeatureCollection:function(e,t){for(var r=e.features,n=-1,a=r.length;++n<a;)Z(r[n].geometry,t)}},X={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var r=e.coordinates,n=-1,a=r.length;++n<a;)e=r[n],t.point(e[0],e[1],e[2])},LineString:function(e,t){ee(e.coordinates,t,0)},MultiLineString:function(e,t){for(var r=e.coordinates,n=-1,a=r.length;++n<a;)ee(r[n],t,0)},Polygon:function(e,t){te(e.coordinates,t)},MultiPolygon:function(e,t){for(var r=e.coordinates,n=-1,a=r.length;++n<a;)te(r[n],t)},GeometryCollection:function(e,t){for(var r=e.geometries,n=-1,a=r.length;++n<a;)Z(r[n],t)}};function ee(e,t,r){var n,a=-1,i=e.length-r;for(t.lineStart();++a<i;)n=e[a],t.point(n[0],n[1],n[2]);t.lineEnd()}function te(e,t){var r=-1,n=e.length;for(t.polygonStart();++r<n;)ee(e[r],t,1);t.polygonEnd()}function c(e,t){e&&Q.hasOwnProperty(e.type)?Q[e.type](e,t):Z(e,t)}function re(e){return[D(e[1],e[0]),U(e[2])]}function B(e){var t=e[0],e=e[1],r=x(e);return[r*x(t),r*L(t),L(e)]}function ne(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function ae(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function ie(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function oe(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function se(e){var t=F(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function le(r,n){function e(e,t){return e=r(e,t),n(e[0],e[1])}return r.invert&&n.invert&&(e.invert=function(e,t){return(e=n.invert(e,t))&&r.invert(e[0],e[1])}),e}function ce(e,t){return N(e)>k&&(e-=Math.round(e/R)*R),[e,t]}function ue(e,t,r){return(e%=R)?t||r?le(fe(e),pe(t,r)):fe(e):t||r?pe(t,r):ce}function de(r){return function(e,t){return N(e+=r)>k&&(e-=Math.round(e/R)*R),[e,t]}}function fe(e){var t=de(e);return t.invert=de(-e),t}function pe(e,t){var a=x(e),i=L(e),o=x(t),s=L(t);function r(e,t){var r=x(t),n=x(e)*r,e=L(e)*r,r=L(t),t=r*a+n*i;return[D(e*o-t*s,n*a-r*i),U(t*o+e*s)]}return r.invert=function(e,t){var r=x(t),n=x(e)*r,e=L(e)*r,r=L(t),t=r*o-e*s;return[D(e*o+r*s,n*a+t*i),U(t*a-n*i)]},r}function he(t){function e(e){return(e=t(e[0]*P,e[1]*P))[0]*=M,e[1]*=M,e}return t=ue(t[0]*P,t[1]*P,2<t.length?t[2]*P:0),e.invert=function(e){return(e=t.invert(e[0]*P,e[1]*P))[0]*=M,e[1]*=M,e},e}function ge(e,t,r,n,a,i){if(r){var o=x(t),s=L(t),l=n*r;null==a?(a=t+n*R,i=t-l/2):(a=me(o,a),i=me(o,i),(0<n?a<i:i<a)&&(a+=n*R));for(var c,u=a;0<n?i<u:u<i;u-=l)c=re([o,-s*x(u),-s*L(u)]),e.point(c[0],c[1])}}function me(e,t){(t=B(t))[0]-=e,se(t);e=J(-t[1]);return((-t[2]<0?-e:e)+R-I)%R}function _e(){var n,t=[];return{point:function(e,t,r){n.push([e,t,r])},lineStart:function(){t.push(n=[])},lineEnd:e,rejoin:function(){1<t.length&&t.push(t.pop().concat(t.shift()))},result:function(){var e=t;return t=[],n=null,e}}}function ye(e,t){return N(e[0]-t[0])<I&&N(e[1]-t[1])<I}function Te(e,t,r,n){this.x=e,this.z=t,this.o=r,this.e=n,this.v=!1,this.n=this.p=null}function be(e,t,r,n,i){var o,a,s=[],l=[];if(e.forEach(function(e){if(!((t=e.length-1)<=0)){var t,r,n=e[0],a=e[t];if(ye(n,a)){if(!n[2]&&!a[2]){for(i.lineStart(),o=0;o<t;++o)i.point((n=e[o])[0],n[1]);return void i.lineEnd()}a[0]+=2*I}s.push(r=new Te(n,e,null,!0)),l.push(r.o=new Te(n,null,r,!1)),s.push(r=new Te(a,e,null,!1)),l.push(r.o=new Te(a,null,r,!0))}}),s.length){for(l.sort(t),ve(s),ve(l),o=0,a=l.length;o<a;++o)l[o].e=r=!r;for(var c,u,d=s[0];;){for(var f=d,p=!0;f.v;)if((f=f.n)===d)return;c=f.z,i.lineStart();do{if(f.v=f.o.v=!0,f.e){if(p)for(o=0,a=c.length;o<a;++o)i.point((u=c[o])[0],u[1]);else n(f.x,f.n.x,1,i);f=f.n}else{if(p)for(c=f.p.z,o=c.length-1;0<=o;--o)i.point((u=c[o])[0],u[1]);else n(f.x,f.p.x,-1,i);f=f.p}}while(c=(f=f.o).z,p=!p,!f.v);i.lineEnd()}}}function ve(e){if(t=e.length){for(var t,r,n=0,a=e[0];++n<t;)a.n=r=e[n],r.p=a,a=r;a.n=r=e[0],r.p=a}}function Ee(e){return N(e[0])<=k?e[0]:l(e[0])*((N(e[0])+k)%R-k)}function Se(e,t){var r=Ee(t),n=t[1],t=L(n),a=[L(r),-x(r),0],i=0,o=0,s=new H;1===t?n=w+I:-1===t&&(n=-w-I);for(var l=0,c=e.length;l<c;++l)if(d=(u=e[l]).length)for(var u,d,f=u[d-1],p=Ee(f),h=f[1]/2+q,g=L(h),m=x(h),_=0;_<d;++_,p=T,g=v,m=b,f=y){var y=u[_],T=Ee(y),b=y[1]/2+q,v=L(b),b=x(b),E=T-p,S=0<=E?1:-1,A=S*E,O=k<A,C=g*v;s.add(D(C*S*L(A),m*b+C*x(A))),i+=O?E+S*R:E,O^r<=p^r<=T&&(se(C=ae(B(f),B(y))),se(A=ae(a,C)),(S=(O^0<=E?-1:1)*U(A[2]))<n||n===S&&(C[0]||C[1]))&&(o+=O^0<=E?1:-1)}return(i<-I||i<I&&s<-W)^1&o}function Ae(m,_,y,T){return function(s){var l,c,u,r=_(s),d=_e(),f=_(d),p=!1,t={point:n,lineStart:a,lineEnd:i,polygonStart:function(){t.point=h,t.lineStart=o,t.lineEnd=g,c=[],l=[]},polygonEnd:function(){t.point=n,t.lineStart=a,t.lineEnd=i,c=V(c);var e=Se(l,T);c.length?(p||(s.polygonStart(),p=!0),be(c,Ce,e,y,s)):e&&(p||(s.polygonStart(),p=!0),s.lineStart(),y(null,null,1,s),s.lineEnd()),p&&(s.polygonEnd(),p=!1),c=l=null},sphere:function(){s.polygonStart(),s.lineStart(),y(null,null,1,s),s.lineEnd(),s.polygonEnd()}};function n(e,t){m(e,t)&&s.point(e,t)}function e(e,t){r.point(e,t)}function a(){t.point=e,r.lineStart()}function i(){t.point=n,r.lineEnd()}function h(e,t){u.push([e,t]),f.point(e,t)}function o(){f.lineStart(),u=[]}function g(){h(u[0][0],u[0][1]),f.lineEnd();var e,t,r,n,a=f.clean(),i=d.result(),o=i.length;if(u.pop(),l.push(u),u=null,o)if(1&a){if(0<(t=(r=i[0]).length-1)){for(p||(s.polygonStart(),p=!0),s.lineStart(),e=0;e<t;++e)s.point((n=r[e])[0],n[1]);s.lineEnd()}}else 1<o&&2&a&&i.push(i.pop().concat(i.shift())),c.push(i.filter(Oe))}return t}}function Oe(e){return 1<e.length}function Ce(e,t){return((e=e.x)[0]<0?e[1]-w-I:w-e[1])-((t=t.x)[0]<0?t[1]-w-I:w-t[1])}ce.invert=ce;var ke=Ae(function(){return 1},we,Ie,[-k,-w]);function we(a){var i,o=NaN,s=NaN,l=NaN;return{lineStart:function(){a.lineStart(),i=1},point:function(e,t){var r=0<e?k:-k,n=N(e-o);N(n-k)<I?(a.point(o,s=0<(s+t)/2?w:-w),a.point(l,s),a.lineEnd(),a.lineStart(),a.point(r,s),a.point(e,s),i=0):l!==r&&k<=n&&(N(o-l)<I&&(o-=l*I),N(e-r)<I&&(e-=r*I),s=Re(o,s,e,t),a.point(l,s),a.lineEnd(),a.lineStart(),a.point(r,s),i=0),a.point(o=e,s=t),l=r},lineEnd:function(){a.lineEnd(),o=s=NaN},clean:function(){return 2-i}}}function Re(e,t,r,n){var a,i=L(e-r);return N(i)>I?s((L(t)*(a=x(n))*L(r)-L(n)*(r=x(t))*L(e))/(r*a*i)):(t+n)/2}function Ie(e,t,r,n){var a;null==e?(n.point(-k,a=r*w),n.point(0,a),n.point(k,a),n.point(k,0),n.point(k,-a),n.point(0,-a),n.point(-k,-a),n.point(-k,0),n.point(-k,a)):N(e[0]-t[0])>I?(e=e[0]<t[0]?k:-k,n.point(-e,a=r*e/2),n.point(0,a),n.point(e,a)):n.point(t[0],t[1])}function Me(a){var g=x(a),i=6*P,d=0<g,f=N(g)>I;function p(e,t){return x(e)*x(t)>g}function h(e,t,r){var n,a,i,o,s,l,c,u=[1,0,0],d=ae(B(e),B(t)),f=ne(d,d),p=d[0],h=f-p*p;return h?(n=ae(u,d),ie(u=oe(u,g*f/h),oe(d,-g*p/h)),(h=(d=ne(u,f=n))*d-(p=ne(f,f))*(ne(u,u)-1))<0?void 0:(ie(h=oe(f,(-d-(n=F(h)))/p),u),h=re(h),r?(a=e[0],i=t[0],o=e[1],t=t[1],i<a&&(c=a,a=i,i=c),!(l=N((s=i-a)-k)<I)&&t<o&&(c=o,o=t,t=c),(l||s<I?l?0<o+t^h[1]<(N(h[0]-a)<I?o:t):o<=h[1]&&h[1]<=t:k<s^(a<=h[0]&&h[0]<=i))?(ie(c=oe(f,(-d+n)/p),u),[h,re(c)]):void 0):h)):!r&&e}function m(e,t){var r=d?a:k-a,n=0;return e<-r?n|=1:r<e&&(n|=2),t<-r?n|=4:r<t&&(n|=8),n}return Ae(p,function(i){var o,s,l,c,u;return{lineStart:function(){c=l=!1,u=1},point:function(e,t){var r,n=[e,t],a=p(e,t),e=d?a?0:m(e,t):a?m(e+(e<0?k:-k),t):0;!o&&(c=l=a)&&i.lineStart(),a===l||(r=h(o,n))&&!ye(o,r)&&!ye(n,r)||(n[2]=1),a!==l?(u=0,a?(i.lineStart(),r=h(n,o),i.point(r[0],r[1])):(r=h(o,n),i.point(r[0],r[1],2),i.lineEnd()),o=r):f&&o&&d^a&&(e&s||!(t=h(n,o,!0))||(u=0,d?(i.lineStart(),i.point(t[0][0],t[0][1]),i.point(t[1][0],t[1][1]),i.lineEnd()):(i.point(t[1][0],t[1][1]),i.lineEnd(),i.lineStart(),i.point(t[0][0],t[0][1],3)))),!a||o&&ye(o,n)||i.point(n[0],n[1]),o=n,l=a,s=e},lineEnd:function(){l&&i.lineEnd(),o=null},clean:function(){return u|(c&&l)<<1}}},function(e,t,r,n){ge(n,a,i,r,e,t)},d?[0,-a]:[-k,a-k])}function Pe(e,t,r,n,a,i){var o=e[0],s=e[1],l=0,c=1,u=t[0]-o,d=t[1]-s,r=r-o;if(u||!(0<r)){if(r/=u,u<0){if(r<l)return;r<c&&(c=r)}else if(0<u){if(c<r)return;l<r&&(l=r)}if(r=a-o,u||!(r<0)){if(r/=u,u<0){if(c<r)return;l<r&&(l=r)}else if(0<u){if(r<l)return;r<c&&(c=r)}if(r=n-s,d||!(0<r)){if(r/=d,d<0){if(r<l)return;r<c&&(c=r)}else if(0<d){if(c<r)return;l<r&&(l=r)}if(r=i-s,d||!(r<0)){if(r/=d,d<0){if(c<r)return;l<r&&(l=r)}else if(0<d){if(r<l)return;r<c&&(c=r)}return 0<l&&(e[0]=o+l*u,e[1]=s+l*d),c<1&&(t[0]=o+c*u,t[1]=s+c*d),1}}}}}var A=1e9,Ne=-A;function De(_,y,T,b){function v(e,t){return _<=e&&e<=T&&y<=t&&t<=b}function E(e,t,r,n){var a=0,i=0;if(null==e||(a=o(e,r))!==(i=o(t,r))||s(e,t)<0^0<r)for(;n.point(0===a||3===a?_:T,1<a?b:y),(a=(a+r+4)%4)!==i;);else n.point(t[0],t[1])}function o(e,t){return N(e[0]-_)<I?0<t?0:3:N(e[0]-T)<I?0<t?2:1:N(e[1]-y)<I?0<t?1:0:0<t?3:2}function S(e,t){return s(e.x,t.x)}function s(e,t){var r=o(e,1),n=o(t,1);return r!==n?r-n:0===r?t[1]-e[1]:1===r?e[0]-t[0]:2===r?e[1]-t[1]:t[0]-e[0]}return function(n){var a,d,i,o,s,l,c,u,f,p,h,g=n,e=_e(),t={point:r,lineStart:function(){t.point=m,d&&d.push(i=[]);p=!0,f=!1,c=u=NaN},lineEnd:function(){a&&(m(o,s),l&&f&&e.rejoin(),a.push(e.result()));t.point=r,f&&g.lineEnd()},polygonStart:function(){g=e,a=[],d=[],h=!0},polygonEnd:function(){var e=function(){for(var e=0,t=0,r=d.length;t<r;++t)for(var n,a,i=d[t],o=1,s=i.length,l=i[0],c=l[0],u=l[1];o<s;++o)n=c,a=u,l=i[o],c=l[0],u=l[1],a<=b?b<u&&(u-a)*(_-n)<(c-n)*(b-a)&&++e:u<=b&&(c-n)*(b-a)<(u-a)*(_-n)&&--e;return e}(),t=h&&e,r=(a=V(a)).length;(t||r)&&(n.polygonStart(),t&&(n.lineStart(),E(null,null,1,n),n.lineEnd()),r&&be(a,S,e,E,n),n.polygonEnd());g=n,a=d=i=null}};function r(e,t){v(e,t)&&g.point(e,t)}function m(e,t){var r,n,a=v(e,t);d&&i.push([e,t]),p?(o=e,s=t,p=!1,(l=a)&&(g.lineStart(),g.point(e,t))):a&&f?g.point(e,t):Pe(r=[c=Math.max(Ne,Math.min(A,c)),u=Math.max(Ne,Math.min(A,u))],n=[e=Math.max(Ne,Math.min(A,e)),t=Math.max(Ne,Math.min(A,t))],_,y,T,b)?(f||(g.lineStart(),g.point(r[0],r[1])),g.point(n[0],n[1]),a||g.lineEnd(),h=!1):a&&(g.lineStart(),g.point(e,t),h=!1),c=e,u=t,f=a}return t}}var xe,Le,Fe,Ue,j=e=>e,Be=new H,je=new H,u={point:e,lineStart:e,lineEnd:e,polygonStart:function(){u.lineStart=He,u.lineEnd=We},polygonEnd:function(){u.lineStart=u.lineEnd=u.point=e,Be.add(N(je)),je=new H},result:function(){var e=Be/2;return Be=new H,e}};function He(){u.point=Ge}function Ge(e,t){u.point=Ve,xe=Fe=e,Le=Ue=t}function Ve(e,t){je.add(Ue*e-Fe*t),Fe=e,Ue=t}function We(){Ve(xe,Le)}var n=1/0,qe=n,d=-n,$e=d,ze={point:Ke,lineStart:e,lineEnd:e,polygonStart:e,polygonEnd:e,result:function(){var e=[[n,qe],[d,$e]];return d=$e=-(qe=n=1/0),e}};function Ke(e,t){e<n&&(n=e),d<e&&(d=e),t<qe&&(qe=t),$e<t&&($e=t)}var Ye,Je,f,p,Ze=0,Qe=0,h=0,Xe=0,et=0,g=0,tt=0,rt=0,m=0,_={point:y,lineStart:nt,lineEnd:ot,polygonStart:function(){_.lineStart=st,_.lineEnd=lt},polygonEnd:function(){_.point=y,_.lineStart=nt,_.lineEnd=ot},result:function(){var e=m?[tt/m,rt/m]:g?[Xe/g,et/g]:h?[Ze/h,Qe/h]:[NaN,NaN];return Ze=Qe=h=Xe=et=g=tt=rt=m=0,e}};function y(e,t){Ze+=e,Qe+=t,++h}function nt(){_.point=at}function at(e,t){_.point=it,y(f=e,p=t)}function it(e,t){var r=e-f,n=t-p,r=F(r*r+n*n);Xe+=r*(f+e)/2,et+=r*(p+t)/2,g+=r,y(f=e,p=t)}function ot(){_.point=y}function st(){_.point=ct}function lt(){ut(Ye,Je)}function ct(e,t){_.point=ut,y(Ye=f=e,Je=p=t)}function ut(e,t){var r=e-f,n=t-p,r=F(r*r+n*n);Xe+=r*(f+e)/2,et+=r*(p+t)/2,g+=r,tt+=(r=p*e-f*t)*(f+e),rt+=r*(p+t),m+=3*r,y(f=e,p=t)}function dt(e){this._context=e}dt.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._context.moveTo(e,t),this._point=1;break;case 1:this._context.lineTo(e,t);break;default:this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,R)}},result:e};var ft,pt,ht,T,b,gt=new H,v={point:e,lineStart:function(){v.point=mt},lineEnd:function(){ft&&_t(pt,ht),v.point=e},polygonStart:function(){ft=!0},polygonEnd:function(){ft=null},result:function(){var e=+gt;return gt=new H,e}};function mt(e,t){v.point=_t,pt=T=e,ht=b=t}function _t(e,t){T-=e,b-=t,gt.add(F(T*T+b*b)),T=e,b=t}let r,a,i,o;class Br{constructor(e){this._append=null==e?yt:Tt(e),this._radius=4.5,this._=""}pointRadius(e){return this._radius=+e,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){0===this._line&&(this._+="Z"),this._point=NaN}point(e,t){switch(this._point){case 0:this._append`M${e},${t}`,this._point=1;break;case 1:this._append`L${e},${t}`;break;default:var r,n;this._append`M${e},${t}`,this._radius===i&&this._append===a||(r=this._radius,n=this._,this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,i=r,a=this._append,o=this._,this._=n),this._+=o}}result(){var e=this._;return this._="",e.length?e:null}}function yt(e){let t=1;this._+=e[0];for(var r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function Tt(e){var t=Math.floor(e);if(!(0<=t))throw new RangeError("invalid digits: "+e);if(15<t)return yt;if(t!==r){const n=10**t;r=t,a=function(e){let t=1;this._+=e[0];for(var r=e.length;t<r;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}return a}function bt(t,r){let n=3,a=4.5,i,o;function s(e){return e&&("function"==typeof a&&o.pointRadius(+a.apply(this,arguments)),c(e,i(o))),o.result()}return s.area=function(e){return c(e,i(u)),u.result()},s.measure=function(e){return c(e,i(v)),v.result()},s.bounds=function(e){return c(e,i(ze)),ze.result()},s.centroid=function(e){return c(e,i(_)),_.result()},s.projection=function(e){return arguments.length?(i=null==e?(t=null,j):(t=e).stream,s):t},s.context=function(e){return arguments.length?(o=null==e?(r=null,new Br(n)):new dt(r=e),"function"!=typeof a&&o.pointRadius(a),s):r},s.pointRadius=function(e){return arguments.length?(a="function"==typeof e?e:(o.pointRadius(+e),+e),s):a},s.digits=function(e){if(!arguments.length)return n;if(null==e)n=null;else{var t=Math.floor(e);if(!(0<=t))throw new RangeError("invalid digits: "+e);n=t}return null===r&&(o=new Br(n)),s},s.projection(t).digits(n).context(r)}function vt(n){return function(e){var t,r=new Et;for(t in n)r[t]=n[t];return r.stream=e,r}}function Et(){}function St(e,t,r){var n=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=n&&e.clipExtent(null),c(r,e.stream(ze)),t(ze.result()),null!=n&&e.clipExtent(n),e}function At(a,i,e){return St(a,function(e){var t=i[1][0]-i[0][0],r=i[1][1]-i[0][1],n=Math.min(t/(e[1][0]-e[0][0]),r/(e[1][1]-e[0][1])),t=+i[0][0]+(t-n*(e[1][0]+e[0][0]))/2,r=+i[0][1]+(r-n*(e[1][1]+e[0][1]))/2;a.scale(150*n).translate([t,r])},e)}function Ot(e,t,r){return At(e,[[0,0],t],r)}function Ct(n,a,e){return St(n,function(e){var t=+a,r=t/(e[1][0]-e[0][0]),t=(t-r*(e[1][0]+e[0][0]))/2,e=-r*e[0][1];n.scale(150*r).translate([t,e])},e)}function kt(a,i,e){return St(a,function(e){var t=+i,r=t/(e[1][1]-e[0][1]),n=-r*e[0][0],t=(t-r*(e[1][1]+e[0][1]))/2;a.scale(150*r).translate([n,t])},e)}Et.prototype={constructor:Et,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var wt=16,Rt=x(30*P);function It(e,t){return+t?Pt(e,t):Mt(e)}function Mt(r){return vt({point:function(e,t){e=r(e,t),this.stream.point(e[0],e[1])}})}function Pt(k,w){function R(e,t,r,n,a,i,o,s,l,c,u,d,f,p){var h,g,m,_,y,T,b,v,E,S,A=o-e,O=s-t,C=A*A+O*O;4*w<C&&f--&&(m=i+d,b=U(m/=_=F((h=n+c)*h+(g=a+u)*g+m*m)),y=N(N(m)-1)<I||N(r-l)<I?(r+l)/2:D(g,h),T=(b=k(y,b))[0],b=b[1],w<(S=O*(v=T-e)-A*(E=b-t))*S/C||.3<N((A*v+O*E)/C-.5)||n*c+a*u+i*d<Rt)&&(R(e,t,r,n,a,i,T,b,y,h/=_,g/=_,m,f,p),p.point(T,b),R(T,b,y,h,g,m,o,s,l,c,u,d,f,p))}return function(n){var r,a,i,o,s,l,c,u,d,f,p,h,g={point:e,lineStart:t,lineEnd:_,polygonStart:function(){n.polygonStart(),g.lineStart=y},polygonEnd:function(){n.polygonEnd(),g.lineStart=t}};function e(e,t){e=k(e,t),n.point(e[0],e[1])}function t(){u=NaN,g.point=m,n.lineStart()}function m(e,t){var r=B([e,t]),t=k(e,t);R(u,d,c,f,p,h,u=t[0],d=t[1],c=e,f=r[0],p=r[1],h=r[2],wt,n),n.point(u,d)}function _(){g.point=e,n.lineEnd()}function y(){t(),g.point=T,g.lineEnd=b}function T(e,t){m(r=e,t),a=u,i=d,o=f,s=p,l=h,g.point=m}function b(){R(u,d,c,f,p,h,a,i,r,o,s,l,wt,n),g.lineEnd=_,_()}return g}}var Nt=vt({point:function(e,t){this.stream.point(e*P,t*P)}});function Dt(r){return vt({point:function(e,t){e=r(e,t);return this.stream.point(e[0],e[1])}})}function xt(r,n,a,i,o){function e(e,t){return[n+r*(e*=i),a-r*(t*=o)]}return e.invert=function(e,t){return[(e-n)/r*i,(a-t)/r*o]},e}function Lt(e,r,n,a,i,t){var o,s,l,c,u,d,f;return t?(o=x(t),t=L(t),s=o*e,l=t*e,c=o/e,u=t/e,d=(t*n-o*r)/e,f=(t*r+o*n)/e,p.invert=function(e,t){return[a*(c*e-u*t+d),i*(f-u*e-c*t)]},p):xt(e,r,n,a,i);function p(e,t){return[s*(e*=a)-l*(t*=i)+r,n-l*e-s*t]}}function E(e){return Ft(function(){return e})()}function Ft(e){var t,r,n,a,i,o,s,l,c,u,d=150,f=480,p=250,h=0,g=0,m=0,_=0,y=0,T=0,b=1,v=1,E=null,S=ke,A=null,O=j,C=.5;function k(e){return l(e[0]*P,e[1]*P)}function w(e){return(e=l.invert(e[0],e[1]))&&[e[0]*M,e[1]*M]}function R(){var e=Lt(d,0,0,b,v,T).apply(null,t(h,g)),e=Lt(d,f-e[0],p-e[1],b,v,T);return r=ue(m,_,y),s=le(t,e),l=le(r,s),o=It(s,C),I()}function I(){return c=u=null,k}return k.stream=function(e){return c&&u===e?c:c=Nt(Dt(r)(S(o(O(u=e)))))},k.preclip=function(e){return arguments.length?(S=e,E=void 0,I()):S},k.postclip=function(e){return arguments.length?(O=e,A=n=a=i=null,I()):O},k.clipAngle=function(e){return arguments.length?(S=+e?Me(E=e*P):(E=null,ke),I()):E*M},k.clipExtent=function(e){return arguments.length?(O=null==e?(A=n=a=i=null,j):De(A=+e[0][0],n=+e[0][1],a=+e[1][0],i=+e[1][1]),I()):null==A?null:[[A,n],[a,i]]},k.scale=function(e){return arguments.length?(d=+e,R()):d},k.translate=function(e){return arguments.length?(f=+e[0],p=+e[1],R()):[f,p]},k.center=function(e){return arguments.length?(h=e[0]%360*P,g=e[1]%360*P,R()):[h*M,g*M]},k.rotate=function(e){return arguments.length?(m=e[0]%360*P,_=e[1]%360*P,y=2<e.length?e[2]%360*P:0,R()):[m*M,_*M,y*M]},k.angle=function(e){return arguments.length?(T=e%360*P,R()):T*M},k.reflectX=function(e){return arguments.length?(b=e?-1:1,R()):b<0},k.reflectY=function(e){return arguments.length?(v=e?-1:1,R()):v<0},k.precision=function(e){return arguments.length?(o=It(s,C=e*e),I()):F(C)},k.fitExtent=function(e,t){return At(k,e,t)},k.fitSize=function(e,t){return Ot(k,e,t)},k.fitWidth=function(e,t){return Ct(k,e,t)},k.fitHeight=function(e,t){return kt(k,e,t)},function(){return t=e.apply(this,arguments),k.invert=t.invert&&w,R()}}function Ut(e){var t=0,r=k/3,n=Ft(e),e=n(t,r);return e.parallels=function(e){return arguments.length?n(t=e[0]*P,r=e[1]*P):[t*M,r*M]},e}function Bt(e){var r=x(e);function t(e,t){return[e*r,L(t)/r]}return t.invert=function(e,t){return[e/r,U(t*r)]},t}function jt(e,t){var n,a,r=L(e),i=(r+L(t))/2;return N(i)<I?Bt(e):(a=F(n=1+r*(2*i-r))/i,o.invert=function(e,t){var t=a-t,r=D(e,N(t))*l(t);return t*i<0&&(r-=k*l(e)*l(t)),[r/i,U((n-(e*e+t*t)*i*i)/(2*i))]},o);function o(e,t){t=F(n-2*i*L(t))/i;return[t*L(e*=i),a-t*x(e)]}}function Ht(){return Ut(jt).scale(155.424).center([0,33.6442])}function Gt(){return Ht().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Vt(n){var a=n.length;return{point:function(e,t){for(var r=-1;++r<a;)n[r].point(e,t)},sphere:function(){for(var e=-1;++e<a;)n[e].sphere()},lineStart:function(){for(var e=-1;++e<a;)n[e].lineStart()},lineEnd:function(){for(var e=-1;++e<a;)n[e].lineEnd()},polygonStart:function(){for(var e=-1;++e<a;)n[e].polygonStart()},polygonEnd:function(){for(var e=-1;++e<a;)n[e].polygonEnd()}}}function Wt(){var t,r,a,i,o,n,s=Gt(),l=Ht().rotate([154,0]).center([-2,58.5]).parallels([55,65]),c=Ht().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(e,t){n=[e,t]}};function d(e){var t=e[0],e=e[1];return n=null,a.point(t,e),n||(i.point(t,e),n)||(o.point(t,e),n)}function f(){return t=r=null,d}return d.invert=function(e){var t=s.scale(),r=s.translate(),n=(e[0]-r[0])/t,r=(e[1]-r[1])/t;return(.12<=r&&r<.234&&-.425<=n&&n<-.214?l:.166<=r&&r<.234&&-.214<=n&&n<-.115?c:s).invert(e)},d.stream=function(e){return t&&r===e?t:t=Vt([s.stream(r=e),l.stream(e),c.stream(e)])},d.precision=function(e){return arguments.length?(s.precision(e),l.precision(e),c.precision(e),f()):s.precision()},d.scale=function(e){return arguments.length?(s.scale(e),l.scale(.35*e),c.scale(e),d.translate(s.translate())):s.scale()},d.translate=function(e){var t,r,n;return arguments.length?(t=s.scale(),r=+e[0],n=+e[1],a=s.translate(e).clipExtent([[r-.455*t,n-.238*t],[r+.455*t,n+.238*t]]).stream(u),i=l.translate([r-.307*t,n+.201*t]).clipExtent([[r-.425*t+I,n+.12*t+I],[r-.214*t-I,n+.234*t-I]]).stream(u),o=c.translate([r-.205*t,n+.212*t]).clipExtent([[r-.214*t+I,n+.166*t+I],[r-.115*t-I,n+.234*t-I]]).stream(u),f()):s.translate()},d.fitExtent=function(e,t){return At(d,e,t)},d.fitSize=function(e,t){return Ot(d,e,t)},d.fitWidth=function(e,t){return Ct(d,e,t)},d.fitHeight=function(e,t){return kt(d,e,t)},d.scale(1070)}function qt(a){return function(e,t){var r=x(e),n=x(t),r=a(r*n);return r===1/0?[2,0]:[r*n*L(e),r*L(t)]}}function t(i){return function(e,t){var r=F(e*e+t*t),n=i(r),a=L(n),n=x(n);return[D(e*a,r*n),U(r&&t*a/r)]}}var $t=qt(function(e){return F(2/(1+e))});function zt(){return E($t).scale(124.75).clipAngle(179.999)}$t.invert=t(function(e){return 2*U(e/2)});var Kt=qt(function(e){return(e=J(e))&&e/L(e)});function Yt(){return E(Kt).scale(79.4188).clipAngle(179.999)}function Jt(e,t){return[e,z(Y((w+t)/2))]}function Zt(){return Qt(Jt).scale(961/R)}function Qt(r){var n,a,i,o=E(r),t=o.center,s=o.scale,l=o.translate,c=o.clipExtent,u=null;function d(){var e=k*s(),t=o(he(o.rotate()).invert([0,0]));return c(null==u?[[t[0]-e,t[1]-e],[t[0]+e,t[1]+e]]:r===Jt?[[Math.max(t[0]-e,u),n],[Math.min(t[0]+e,a),i]]:[[u,Math.max(t[1]-e,n)],[a,Math.min(t[1]+e,i)]])}return o.scale=function(e){return(arguments.length?(s(e),d):s)()},o.translate=function(e){return(arguments.length?(l(e),d):l)()},o.center=function(e){return(arguments.length?(t(e),d):t)()},o.clipExtent=function(e){return arguments.length?(null==e?u=n=a=i=null:(u=+e[0][0],n=+e[0][1],a=+e[1][0],i=+e[1][1]),d()):null==u?null:[[u,n],[a,i]]},d()}function Xt(e){return Y((w+e)/2)}function er(e,t){var r=x(e),a=e===t?L(e):z(r/x(t))/z(Xt(t)/Xt(e)),i=r*K(Xt(e),a)/a;return a?(n.invert=function(e,t){var t=i-t,r=l(a)*F(e*e+t*t),n=D(e,N(t))*l(t);return t*a<0&&(n-=k*l(e)*l(t)),[n/a,2*s(K(i/r,1/a))-w]},n):Jt;function n(e,t){0<i?t<-w+I&&(t=-w+I):w-I<t&&(t=w-I);t=i/K(Xt(t),a);return[t*L(a*e),i-t*x(a*e)]}}function tr(){return Ut(er).scale(109.5).parallels([30,30])}function rr(e,t){return[e,t]}function nr(){return E(rr).scale(152.63)}function ar(e,t){var r=x(e),n=e===t?L(e):(r-x(t))/(t-e),a=r/n+e;return N(n)<I?rr:(i.invert=function(e,t){var t=a-t,r=D(e,N(t))*l(t);return t*n<0&&(r-=k*l(e)*l(t)),[r/n,a-l(n)*F(e*e+t*t)]},i);function i(e,t){t=a-t,e*=n;return[t*L(e),a-t*x(e)]}}function ir(){return Ut(ar).scale(131.154).center([0,13.9389])}Kt.invert=t(function(e){return e}),Jt.invert=function(e,t){return[e,2*s($(t))-w]},rr.invert=rr;var S=1.340264,or=-.081106,sr=893e-6,lr=.003796,cr=F(3)/2;function ur(e,t){var t=U(cr*L(t)),r=t*t,n=r*r*r;return[e*x(t)/(cr*(S+3*or*r+n*(7*sr+9*lr*r))),t*(S+or*r+n*(sr+lr*r))]}function dr(){return E(ur).scale(177.158)}function fr(e,t){var r=x(t),n=x(e)*r;return[r*L(e)/n,L(t)/n]}function pr(){return E(fr).scale(144.049).clipAngle(60)}function hr(){var n,a,t,r,i,o,s,l=1,c=0,u=0,d=1,f=1,p=0,h=null,g=1,m=1,_=vt({point:function(e,t){e=b([e,t]);this.stream.point(e[0],e[1])}}),y=j;function T(){return g=l*d,m=l*f,o=s=null,b}function b(e){var t,r=e[0]*g,e=e[1]*m;return p&&(t=e*n-r*a,r=r*n+e*a,e=t),[r+c,e+u]}return b.invert=function(e){var t,r=e[0]-c,e=e[1]-u;return p&&(t=e*n+r*a,r=r*n-e*a,e=t),[r/g,e/m]},b.stream=function(e){return o&&s===e?o:o=_(y(s=e))},b.postclip=function(e){return arguments.length?(y=e,h=t=r=i=null,T()):y},b.clipExtent=function(e){return arguments.length?(y=null==e?(h=t=r=i=null,j):De(h=+e[0][0],t=+e[0][1],r=+e[1][0],i=+e[1][1]),T()):null==h?null:[[h,t],[r,i]]},b.scale=function(e){return arguments.length?(l=+e,T()):l},b.translate=function(e){return arguments.length?(c=+e[0],u=+e[1],T()):[c,u]},b.angle=function(e){return arguments.length?(a=L(p=e%360*P),n=x(p),T()):p*M},b.reflectX=function(e){return arguments.length?(d=e?-1:1,T()):d<0},b.reflectY=function(e){return arguments.length?(f=e?-1:1,T()):f<0},b.fitExtent=function(e,t){return At(b,e,t)},b.fitSize=function(e,t){return Ot(b,e,t)},b.fitWidth=function(e,t){return Ct(b,e,t)},b.fitHeight=function(e,t){return kt(b,e,t)},b}function gr(e,t){var r=t*t,n=r*r;return[e*(.8707-.131979*r+n*(n*(.003971*r-.001529*n)-.013791)),t*(1.007226+r*(.015085+n*(.028874*r-.044475-.005916*n)))]}function mr(){return E(gr).scale(175.295)}function _r(e,t){return[x(t)*L(e),L(t)]}function yr(){return E(_r).scale(249.5).clipAngle(90+I)}function Tr(e,t){var r=x(t),n=1+x(e)*r;return[r*L(e)/n,L(t)/n]}function br(){return E(Tr).scale(250).clipAngle(142)}function vr(e,t){return[z(Y((w+t)/2)),-e]}function Er(){var e=Qt(vr),t=e.center,r=e.rotate;return e.center=function(e){return arguments.length?t([-e[1],e[0]]):[(e=t())[1],-e[0]]},e.rotate=function(e){return arguments.length?r([e[0],e[1],2<e.length?e[2]+90:90]):[(e=r())[0],e[1],e[2]-90]},r([0,0,90]).scale(159.155)}ur.invert=function(e,t){for(var r,n=t,a=n*n,i=a*a*a,o=0;o<12&&(i=(a=(n-=r=(n*(S+or*a+i*(sr+lr*a))-t)/(S+3*or*a+i*(7*sr+9*lr*a)))*n)*a*a,!(N(r)<W));++o);return[cr*e*(S+3*or*a+i*(7*sr+9*lr*a))/x(n),U(L(n)/cr)]},fr.invert=t(s),gr.invert=function(e,t){var r=t,n=25;do{var a=r*r,i=a*a}while(r-=i=(r*(1.007226+a*(.015085+i*(.028874*a-.044475-.005916*i)))-t)/(1.007226+a*(.045255+i*(.259866*a-.311325-.005916*11*i))),N(i)>I&&0<--n);return[e/(.8707+(a=r*r)*(a*(a*a*a*(.003971-.001529*a)-.013791)-.131979)),r]},_r.invert=t(U),Tr.invert=t(function(e){return 2*s(e)}),vr.invert=function(e,t){return[-t,2*s($(e))-w]};var Sr=Math.abs,Ar=Math.cos,Or=Math.sin,Cr=1e-6,kr=Math.PI,wr=kr/2,Rr=Mr(2);function Ir(e){return 1<e?wr:e<-1?-wr:Math.asin(e)}function Mr(e){return 0<e?Math.sqrt(e):0}function Pr(e,t){for(var r,n=e*Or(t),a=30;t-=r=(t+Or(t)-n)/(1+Ar(t)),Sr(r)>Cr&&0<--a;);return t/2}function Nr(r,n,a){function e(e,t){return[r*e*Ar(t=Pr(a,t)),n*Or(t)]}return e.invert=function(e,t){return t=Ir(t/n),[e/(r*Ar(t)),Ir((2*t+Or(2*t))/a)]},e}var Dr=Nr(Rr/wr,Rr,kr);function xr(){return E(Dr).scale(169.529)}const jr=bt(),Hr=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function Lr(t,n){return function e(){const r=n();return r.type=t,r.path=bt().projection(r),r.copy=r.copy||function(){const t=e();return Hr.forEach(e=>{r[e]&&t[e](r[e]())}),t.path.pointRadius(r.path.pointRadius()),t},C.registerScale(r)}}function Fr(e,t){if(e&&"string"==typeof e)return e=e.toLowerCase(),1<arguments.length?(Gr[e]=Lr(e,t),this):Gr[e]||null;throw new Error("Projection type must be a name string.")}function Ur(e){return e&&e.path||jr}const Gr={albers:Gt,albersusa:Wt,azimuthalequalarea:zt,azimuthalequidistant:Yt,conicconformal:tr,conicequalarea:Ht,conicequidistant:ir,equalEarth:dr,equirectangular:nr,gnomonic:pr,identity:hr,mercator:Zt,mollweide:xr,naturalEarth1:mr,orthographic:yr,stereographic:br,transversemercator:Er};for(const Vr in Gr)Fr(Vr,Gr[Vr]);O.getProjectionPath=Ur,O.projection=Fr,O.projectionProperties=Hr}}return Pu.exports}function Du(){if(!Iu){Iu=1;var e=Mu.exports;{var c=su(),b=jo(),L=fu(),s=Nu(),F=yu();const We=Math.sqrt(50),qe=Math.sqrt(10),$e=Math.sqrt(2);function U(e,t,r){var n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),n=n/Math.pow(10,a),n=n>=We?10:n>=qe?5:n>=$e?2:1;let i,o,s;return a<0?(s=Math.pow(10,-a)/n,i=Math.round(e*s),o=Math.round(t*s),i/s<e&&++i,o/s>t&&--o,s=-s):(s=Math.pow(10,a)*n,i=Math.round(e/s),o=Math.round(t/s),i*s<e&&++i,o*s>t&&--o),o<i&&.5<=r&&r<2?U(e,t,2*r):[i,o,s]}function B(e,t,r){return U(e=+e,t=+t,r=+r)[2]}function j(e,t,r){r=+r;var n=(t=+t)<(e=+e),e=n?B(t,e,r):B(e,t,r);return(n?-1:1)*(e<0?1/-e:e)}function u(e){let t;for(const r of e)null!=r&&(t<r||void 0===t&&r>=r)&&(t=r);return t}function T(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=0|Math.max(0,Math.ceil((t-e)/r)),i=new Array(a);++n<a;)i[n]=e+n*r;return i}function H(e){let t=0;for(var r of e)(r=+r)&&(t+=r);return t}function G(){}const N=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function V(){var m=1,_=1,y=t;function r(t,e){return e.map(e=>n(t,e))}function n(t,r){var o,s,e,n,a,i,l=[],c=[],u=t,d=r,f=e=>{y(e,t,r),0<W(e)?l.push([e]):c.push(e)},p=[],h=[];for(o=s=-1,n=u[0]>=d,N[n<<1].forEach(g);++o<m-1;)e=n,n=u[o+1]>=d,N[e|n<<1].forEach(g);for(N[n<<0].forEach(g);++s<_-1;){for(o=-1,n=u[s*m+m]>=d,a=u[s*m]>=d,N[n<<1|a<<2].forEach(g);++o<m-1;)e=n,n=u[s*m+m+o+1]>=d,i=a,a=u[s*m+o+1]>=d,N[e|n<<1|a<<2|i<<3].forEach(g);N[n|a<<3].forEach(g)}for(o=-1,a=u[s*m]>=d,N[a<<2].forEach(g);++o<m-1;)i=a,a=u[s*m+o+1]>=d,N[a<<2|i<<3].forEach(g);function g(e){var t,r,n=[e[0][0]+o,e[0][1]+s],e=[e[1][0]+o,e[1][1]+s],a=T(n),i=T(e);(t=h[a])?(r=p[i])?(delete h[t.end],delete p[r.start],t===r?(t.ring.push(e),f(t.ring)):p[t.start]=h[r.end]={start:t.start,end:r.end,ring:t.ring.concat(r.ring)}):(delete h[t.end],t.ring.push(e),h[t.end=i]=t):(t=p[i])?(r=h[a])?(delete p[t.start],delete h[r.end],t===r?(t.ring.push(e),f(t.ring)):p[r.start]=h[t.end]={start:r.start,end:t.end,ring:r.ring.concat(t.ring)}):(delete p[t.start],t.ring.unshift(n),p[t.start=a]=t):p[a]=h[i]={start:a,end:i,ring:[n,e]}}return N[a<<3].forEach(g),c.forEach(e=>{for(var t,r=0,n=l.length;r<n;++r)if(-1!==q((t=l[r])[0],e))return void t.push(e)}),{type:"MultiPolygon",value:r,coordinates:l}}function T(e){return 2*e[0]+e[1]*(m+1)*4}function t(e,s,l){e.forEach(e=>{var t,r=e[0],n=e[1],a=0|r,i=0|n,o=s[i*m+a];0<r&&r<m&&a===r&&(t=s[i*m+a-1],e[0]=r+(l-t)/(o-t)-.5),0<n&&n<_&&i===n&&(t=s[(i-1)*m+a],e[1]=n+(l-t)/(o-t)-.5)})}return r.contour=n,r.size=function(e){var t;return arguments.length?(t=Math.floor(e[0]),e=Math.floor(e[1]),0<=t&&0<=e||b.error("invalid size"),m=t,_=e,r):[m,_]},r.smooth=function(e){return arguments.length?(y=e?t:G,r):y===t},r}function W(e){for(var t=0,r=e.length,n=e[r-1][1]*e[0][0]-e[r-1][0]*e[0][1];++t<r;)n+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return n}function q(e,t){for(var r,n=-1,a=t.length;++n<a;)if(r=$(e,t[n]))return r;return 0}function $(e,t){for(var r=t[0],n=t[1],a=-1,i=0,o=e.length,s=o-1;i<o;s=i++){var l=e[i],c=l[0],u=l[1],d=e[s],f=d[0],p=d[1];if(z(l,d,t))return 0;n<u!=n<p&&r<(f-c)*(n-u)/(p-u)+c&&(a=-a)}return a}function z(e,t,r){return K(e,t,r)&&Y(e[e=+(e[0]===t[0])],r[e],t[e])}function K(e,t,r){return(t[0]-e[0])*(r[1]-e[1])==(r[0]-e[0])*(t[1]-e[1])}function Y(e,t,r){return e<=t&&t<=r||r<=t&&t<=e}function J(n,a,i){return function(e){var e=b.extent(e),t=i?Math.min(e[0],0):e[0],e=e[1],r=e-t,r=a?j(t,e,n):r/(n+1);return T(t+r,e,r)}}function t(e){c.Transform.call(this,null,e)}function Z(e,t,r){var n=J(r.levels||10,r.nice,!1!==r.zero);return"shared"!==r.resolve?n:n(e.map(e=>u(t(e).values)))}function Q(e,t,r,n){let a=n.scale||t.scale,i=n.translate||t.translate;var o,s;b.isFunction(a)&&(a=a(r,n)),b.isFunction(i)&&(i=i(r,n)),(1!==a&&null!=a||i)&&(r=(b.isNumber(a)?a:a[0])||1,n=(b.isNumber(a)?a:a[1])||1,o=i&&i[0]||0,s=i&&i[1]||0,e.forEach(X(t,r,n,o,s)))}function X(e,t,r,n,a){const i=e.x1||0,o=e.y1||0,s=t*r<0;function l(e){e.forEach(c)}function c(e){s&&e.reverse(),e.forEach(u)}function u(e){e[0]=(e[0]-i)*t+n,e[1]=(e[1]-o)*r+a}return function(e){return e.coordinates.forEach(l),e}}function ee(e,t,r){e=0<=e?e:L.bandwidthNRD(t,r);return Math.round((Math.sqrt(4*e*e+1)-1)/2)}function n(e){return b.isFunction(e)?e:b.constant(+e)}function te(){var f=e=>e[0],p=e=>e[1],h=b.one,g=[-1,-1],m=960,_=500,y=2;function r(e,t){const r=ee(g[0],e,f)>>y,n=ee(g[1],e,p)>>y,a=r?2+r:0,i=n?2+n:0,o=2*a+(m>>y),s=2*i+(_>>y),l=new Float32Array(o*s),c=new Float32Array(o*s);let u=l;e.forEach(e=>{var t=a+(+f(e)>>y),r=i+(+p(e)>>y);0<=t&&t<o&&0<=r&&r<s&&(l[t+r*o]+=+h(e))}),0<r&&0<n?(v(o,s,l,c,r),E(o,s,c,l,n),v(o,s,l,c,r),E(o,s,c,l,n),v(o,s,l,c,r),E(o,s,c,l,n)):0<r?(v(o,s,l,c,r),v(o,s,c,l,r),v(o,s,l,c,r),u=c):0<n&&(E(o,s,l,c,n),E(o,s,c,l,n),E(o,s,l,c,n),u=c);var d=t?Math.pow(2,-2*y):1/H(u);for(let e=0,t=o*s;e<t;++e)u[e]*=d;return{values:u,scale:1<<y,width:o,height:s,x1:a,y1:i,x2:a+(m>>y),y2:i+(_>>y)}}return r.x=function(e){return arguments.length?(f=n(e),r):f},r.y=function(e){return arguments.length?(p=n(e),r):p},r.weight=function(e){return arguments.length?(h=n(e),r):h},r.size=function(e){var t;return arguments.length?(t=+e[0],e=+e[1],0<=t&&0<=e||b.error("invalid size"),m=t,_=e,r):[m,_]},r.cellSize=function(e){return arguments.length?(1<=(e=+e)||b.error("invalid cell size"),y=Math.floor(Math.log(e)/Math.LN2),r):1<<y},r.bandwidth=function(e){return arguments.length?(2!==(e=1===(e=b.array(e)).length?[+e[0],+e[0]]:e).length&&b.error("invalid bandwidth"),g=e,r):g},r}function v(n,e,a,i,o){var s=1+(o<<1);for(let r=0;r<e;++r)for(let e=0,t=0;e<n+o;++e)e<n&&(t+=a[e+r*n]),e>=o&&(e>=s&&(t-=a[e-s+r*n]),i[e-o+r*n]=t/Math.min(e+1,n-1+s-e,s))}function E(n,a,i,o,s){var l=1+(s<<1);for(let r=0;r<n;++r)for(let e=0,t=0;e<a+s;++e)e<a&&(t+=i[r+e*n]),e>=s&&(e>=l&&(t-=i[r+(e-l)*n]),o[r+(e-s)*n]=t/Math.min(e+1,a-1+l-e,l))}function r(e){c.Transform.call(this,null,e)}t.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},b.inherits(t,c.Transform,{transform(n,e){var t,r,a,i,o,s,l;return!this.value||e.changed()||n.modified()?(t=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=e.materialize(e.SOURCE).source,a=n.field||b.identity,i=V().smooth(!1!==n.smooth),o=n.thresholds||Z(r,a,n),s=null===n.as?null:n.as||"contour",l=[],r.forEach(t=>{var e=a(t),r=i.size([e.width,e.height])(e.values,b.isArray(o)?o:o(e.values));Q(r,e,t,n),r.forEach(e=>{l.push(c.rederive(t,c.ingest(null!=s?{[s]:e}:e)))})}),this.value&&(t.rem=this.value),this.value=t.source=t.add=l,t):e.StopPropagation}}),r.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const ze=["x","y","weight","size","cellSize","bandwidth"];function re(t,r){return ze.forEach(e=>null!=r[e]?t[e](r[e]):0),t}function ne(e,t){var r,n,a,i,o,s,l=[],c=e=>e(i);if(null==t)l.push(e);else for(r={},n=0,a=e.length;n<a;++n)i=e[n],(s=r[o=t.map(c)])||(r[o]=s=[],s.dims=o,l.push(s)),s.push(i);return l}function a(e){c.Transform.call(this,null,e)}b.inherits(r,c.Transform,{transform(t,e){var r,n,a,i,o,s;return!this.value||e.changed()||t.modified()?(r=e.fork(e.NO_SOURCE|e.NO_FIELDS),n=ne(e.materialize(e.SOURCE).source,t.groupby),a=(t.groupby||[]).map(b.accessorName),i=re(te(),t),o=t.as||"grid",s=[],s=n.map(e=>c.ingest(function(t,r){for(let e=0;e<a.length;++e)t[a[e]]=r[e];return t}({[o]:i(e,t.counts)},e.dims))),this.value&&(r.rem=this.value),this.value=r.source=r.add=s,r):e.StopPropagation}}),a.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},b.inherits(a,c.Transform,{transform(e,t){var r,n,a,i,o,s;return!this.value||t.changed()||e.modified()?(r=t.fork(t.NO_SOURCE|t.NO_FIELDS),n=V().smooth(!1!==e.smooth),a=e.values,i=e.thresholds||J(e.count||10,e.nice,!!a),o=e.size,a||(a=t.materialize(t.SOURCE).source,s=X(e=re(te(),e)(a,!0),e.scale||1,e.scale||1,0,0),o=[e.width,e.height],a=e.values),i=b.isArray(i)?i:i(a),a=n.size(o)(a,i),s&&a.forEach(s),this.value&&(r.rem=this.value),this.value=r.source=r.add=(a||[]).map(c.ingest),r):t.StopPropagation}});const D="Feature",x="FeatureCollection";function i(e){c.Transform.call(this,null,e)}function o(e){c.Transform.call(this,null,e)}function ae(e,t){var r=e.pointRadius();return e.context(null),null!=t&&e.pointRadius(t),r}function l(e){c.Transform.call(this,null,e)}function d(e){c.Transform.call(this,null,e)}function ie(r,n,a){const t=null==a?e=>r(n(e)):e=>{var t=r.pointRadius(),e=r.pointRadius(a)(n(e));return r.pointRadius(t),e};return t.context=e=>(r.context(e),t),t}i.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},b.inherits(i,c.Transform,{transform(e,t){var r=this._features,n=this._points,a=e.fields,i=a&&a[0],o=a&&a[1],s=e.geojson||!a&&b.identity,a=t.ADD,e=e.modified()||t.changed(t.REM)||t.modified(b.accessorFields(s))||i&&t.modified(b.accessorFields(i))||o&&t.modified(b.accessorFields(o));this.value&&!e||(a=t.SOURCE,this._features=r=[],this._points=n=[]),s&&t.visit(a,e=>r.push(s(e))),i&&o&&(t.visit(a,e=>{var t=i(e),e=o(e);null!=t&&null!=e&&(t=+t)===t&&(e=+e)===e&&n.push([t,e])}),r=r.concat({type:D,geometry:{type:"MultiPoint",coordinates:n}})),this.value={type:x,features:r}}}),o.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},b.inherits(o,c.Transform,{transform(e,t){var r=t.fork(t.ALL),n=this.value,a=e.field||b.identity,i=e.as||"path",o=r.SOURCE,t=(!n||e.modified()?(this.value=n=s.getProjectionPath(e.projection),r.materialize().reflow()):o=a===b.identity||t.modified(a.fields)?r.ADD_MOD:r.ADD,ae(n,e.pointRadius));return r.visit(o,e=>e[i]=n(a(e))),n.pointRadius(t),r.modifies(i)}}),l.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},b.inherits(l,c.Transform,{transform(e,t){var r=e.projection,n=e.fields[0],a=e.fields[1],i=e.as||["x","y"],o=i[0],s=i[1];function l(e){var t=r([n(e),a(e)]);t?(e[o]=t[0],e[s]=t[1]):(e[o]=void 0,e[s]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(e=t.modified(n.fields)||t.modified(a.fields),t.visit(e?t.ADD_MOD:t.ADD,l)),t.modifies(i)}}),d.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},b.inherits(d,c.Transform,{transform(e,t){var t=t.fork(t.ALL),r=this.value,n=e.as||"shape",a=t.ADD;return r&&!e.modified()||(this.value=r=ie(s.getProjectionPath(e.projection),e.field||b.field("datum"),e.pointRadius),t.materialize().reflow(),a=t.SOURCE),t.visit(a,e=>e[n]=r),t.modifies(n)}});var S=1e-6,oe=Math.abs,A=Math.ceil;function se(e,t,r){var n=T(e,t-S,r).concat(t);return function(t){return n.map(function(e){return[t,e]})}}function le(e,t,r){var n=T(e,t-S,r).concat(t);return function(t){return n.map(function(e){return[e,t]})}}function ce(){var t,r,n,a,i,o,s,l,c,u,d,f,p=10,h=p,g=90,m=360,_=2.5;function y(){return{type:"MultiLineString",coordinates:e()}}function e(){return T(A(a/g)*g,n,g).map(d).concat(T(A(l/m)*m,s,m).map(f)).concat(T(A(r/p)*p,t,p).filter(function(e){return oe(e%g)>S}).map(c)).concat(T(A(o/h)*h,i,h).filter(function(e){return oe(e%m)>S}).map(u))}return y.lines=function(){return e().map(function(e){return{type:"LineString",coordinates:e}})},y.outline=function(){return{type:"Polygon",coordinates:[d(a).concat(f(s).slice(1),d(n).reverse().slice(1),f(l).reverse().slice(1))]}},y.extent=function(e){return arguments.length?y.extentMajor(e).extentMinor(e):y.extentMinor()},y.extentMajor=function(e){return arguments.length?(a=+e[0][0],n=+e[1][0],l=+e[0][1],s=+e[1][1],n<a&&(e=a,a=n,n=e),s<l&&(e=l,l=s,s=e),y.precision(_)):[[a,l],[n,s]]},y.extentMinor=function(e){return arguments.length?(r=+e[0][0],t=+e[1][0],o=+e[0][1],i=+e[1][1],t<r&&(e=r,r=t,t=e),i<o&&(e=o,o=i,i=e),y.precision(_)):[[r,o],[t,i]]},y.step=function(e){return arguments.length?y.stepMajor(e).stepMinor(e):y.stepMinor()},y.stepMajor=function(e){return arguments.length?(g=+e[0],m=+e[1],y):[g,m]},y.stepMinor=function(e){return arguments.length?(p=+e[0],h=+e[1],y):[p,h]},y.precision=function(e){return arguments.length?(_=+e,c=se(o,i,90),u=le(r,t,_),d=se(l,s,90),f=le(a,n,_),y):_},y.extentMajor([[-180,-90+S],[180,90-S]]).extentMinor([[-180,-80-S],[180,80+S]])}function f(e){c.Transform.call(this,[],e),this.generator=ce()}function p(e,t,r){(e.prototype=t.prototype=r).constructor=e}function ue(e,t){var r,n=Object.create(e.prototype);for(r in t)n[r]=t[r];return n}function h(){}f.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},b.inherits(f,c.Transform,{transform(e,t){var r,n=this.value,a=this.generator;if(!n.length||e.modified())for(const i in e)b.isFunction(a[i])&&a[i](e[i]);return r=a(),n.length?t.mod.push(c.replace(n[0],r)):t.add.push(c.ingest(r)),n[0]=r,t}});var g="\\s*([+-]?\\d+)\\s*",m="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",_="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",de=/^#([0-9a-f]{3,8})$/,fe=new RegExp(`^rgb\\(${g},${g},${g}\\)$`),pe=new RegExp(`^rgb\\(${_},${_},${_}\\)$`),he=new RegExp(`^rgba\\(${g},${g},${g},${m}\\)$`),ge=new RegExp(`^rgba\\(${_},${_},${_},${m}\\)$`),me=new RegExp(`^hsl\\(${m},${_},${_}\\)$`),_e=new RegExp(`^hsla\\(${m},${_},${_},${m}\\)$`),ye={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Te(){return this.rgb().formatHex()}function be(){return this.rgb().formatHex8()}function ve(){return Re(this).formatHsl()}function Ee(){return this.rgb().formatRgb()}function y(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=de.exec(e))?(r=t[1].length,t=parseInt(t[1],16),6===r?Se(t):3===r?new k(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===r?O(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===r?O(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=fe.exec(e))?new k(t[1],t[2],t[3],1):(t=pe.exec(e))?new k(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=he.exec(e))?O(t[1],t[2],t[3],t[4]):(t=ge.exec(e))?O(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=me.exec(e))?we(t[1],t[2]/100,t[3]/100,1):(t=_e.exec(e))?we(t[1],t[2]/100,t[3]/100,t[4]):ye.hasOwnProperty(e)?Se(ye[e]):"transparent"===e?new k(NaN,NaN,NaN,0):null}function Se(e){return new k(e>>16&255,e>>8&255,255&e,1)}function O(e,t,r,n){return new k(e=n<=0?t=r=NaN:e,t,r,n)}function Ae(e){return(e=e instanceof h?e:y(e))?new k((e=e.rgb()).r,e.g,e.b,e.opacity):new k}function C(e,t,r,n){return 1===arguments.length?Ae(e):new k(e,t,r,null==n?1:n)}function k(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}function Oe(){return"#"+I(this.r)+I(this.g)+I(this.b)}function Ce(){return"#"+I(this.r)+I(this.g)+I(this.b)+I(255*(isNaN(this.opacity)?1:this.opacity))}function ke(){var e=w(this.opacity);return(1===e?"rgb(":"rgba(")+R(this.r)+`, ${R(this.g)}, `+R(this.b)+(1===e?")":`, ${e})`)}function w(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function R(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function I(e){return((e=R(e))<16?"0":"")+e.toString(16)}function we(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||1<=r?e=t=NaN:t<=0&&(e=NaN),new M(e,t,r,n)}function Re(e){var t,r,n,a,i,o,s,l;return e instanceof M?new M(e.h,e.s,e.l,e.opacity):(e=e instanceof h?e:y(e))?e instanceof M?e:(t=(e=e.rgb()).r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),o=NaN,l=((i=Math.max(t,r,n))+a)/2,(s=i-a)?(o=t===i?(r-n)/s+6*(r<n):r===i?(n-t)/s+2:(t-r)/s+4,s/=l<.5?i+a:2-i-a,o*=60):s=0<l&&l<1?0:o,new M(o,s,l,e.opacity)):new M}function Ie(e,t,r,n){return 1===arguments.length?Re(e):new M(e,t,r,null==n?1:n)}function M(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}function Me(e){return(e=(e||0)%360)<0?e+360:e}function P(e){return Math.max(0,Math.min(1,e||0))}function Pe(e,t,r){return 255*(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)}function Ne(e){c.Transform.call(this,null,e)}function De(t,r){let e;return b.isFunction(t)?(e=e=>C(t(e,r))).dep=Le(t):e=b.constant(C(t||"#888")),e}function xe(t,r){let e;return b.isFunction(t)?(e=e=>t(e,r)).dep=Le(t):t?e=b.constant(t):(e=e=>e.$value/e.$max||0).dep=!0,e}function Le(e){return!!b.isFunction(e)&&((e=b.toSet(b.accessorFields(e))).$x||e.$y||e.$value||e.$max)}function Fe(e,a,i,o){const s=e.width,t=e.height,l=e.x1||0,c=e.y1||0,u=e.x2||s,d=e.y2||t,r=e.values,f=r?e=>r[e]:b.zero,n=F.canvas(u-l,d-c),p=n.getContext("2d"),h=p.getImageData(0,0,u-l,d-c),g=h.data;for(let r=c,n=0;r<d;++r){a.$y=r-c;for(let e=l,t=r*s;e<u;++e,n+=4){a.$x=e-l,a.$value=f(e+t);var m=i(a);g[n+0]=m.r,g[n+1]=m.g,g[n+2]=m.b,g[n+3]=~~(255*o(a))}}return p.putImageData(h,0,0),n}function Ue(e){c.Transform.call(this,null,e),this.modified(!0)}function Be(e,t){var r=Ge(t.fit);t.extent?e.fitExtent(t.extent,r):t.size&&e.fitSize(t.size,r)}function je(e){var t=s.projection((e||"mercator").toLowerCase());return t||b.error("Unrecognized projection type: "+e),t()}function He(e,t,r){b.isFunction(e[t])&&e[t](r)}function Ge(e){return 1===(e=b.array(e)).length?e[0]:{type:x,features:e.reduce((e,t)=>e.concat(Ve(t)),[])}}function Ve(e){return e.type===x?e.features:b.array(e).filter(e=>null!=e).map(e=>e.type===D?e:{type:D,geometry:e})}p(h,y,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Te,formatHex:Te,formatHex8:be,formatHsl:ve,formatRgb:Ee,toString:Ee}),p(k,C,ue(h,{brighter(e){return e=null==e?1/.7:Math.pow(1/.7,e),new k(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new k(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new k(R(this.r),R(this.g),R(this.b),w(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Oe,formatHex:Oe,formatHex8:Ce,formatRgb:ke,toString:ke})),p(M,Ie,ue(h,{brighter(e){return e=null==e?1/.7:Math.pow(1/.7,e),new M(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new M(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,t=r+(r<.5?r:1-r)*t,r=2*r-t;return new k(Pe(240<=e?e-240:120+e,r,t),Pe(e,r,t),Pe(e<120?240+e:e-120,r,t),this.opacity)},clamp(){return new M(Me(this.h),P(this.s),P(this.l),w(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){var e=w(this.opacity);return(1===e?"hsl(":"hsla(")+Me(this.h)+`, ${100*P(this.s)}%, ${100*P(this.l)}%`+(1===e?")":`, ${e})`)}})),Ne.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},b.inherits(Ne,c.Transform,{transform(e,t){var r,n,a,i,o,s,l;return t.changed()||e.modified()?(r=t.materialize(t.SOURCE).source,n="shared"===e.resolve,a=e.field||b.identity,i=xe(e.opacity,e),o=De(e.color,e),s=e.as||"image",l={$x:0,$y:0,$value:0,$max:n?u(r.map(e=>u(a(e).values))):0},r.forEach(e=>{var t=a(e),r=b.extend({},e,l);n||(r.$max=u(t.values||[])),e[s]=Fe(t,r,o.dep?o:b.constant(o(r)),i.dep?i:b.constant(i(r)))}),t.reflow(!0).modifies(s)):t.StopPropagation}}),b.inherits(Ue,c.Transform,{transform(t,e){let r=this.value;return!r||t.modified("type")?(this.value=r=je(t.type),s.projectionProperties.forEach(e=>{null!=t[e]&&He(r,e,t[e])})):s.projectionProperties.forEach(e=>{t.modified(e)&&He(r,e,t[e])}),null!=t.pointRadius&&r.path.pointRadius(t.pointRadius),t.fit&&Be(r,t),e.fork(e.NO_SOURCE|e.NO_FIELDS)}}),e.contour=a,e.geojson=i,e.geopath=o,e.geopoint=l,e.geoshape=d,e.graticule=f,e.heatmap=Ne,e.isocontour=t,e.kde2d=r,e.projection=Ue}}return Mu.exports}var xu,Lu={exports:{}};function Fu(){if(!xu){xu=1;var L=Lu.exports;{var t=su(),c=jo();function F(i,o){var s,l=1;function t(){for(var e,t=s.length,r=0,n=0,a=0;a<t;++a)r+=(e=s[a]).x,n+=e.y;for(r=(r/t-i)*l,n=(n/t-o)*l,a=0;a<t;++a)(e=s[a]).x-=r,e.y-=n}return null==i&&(i=0),null==o&&(o=0),t.initialize=function(e){s=e},t.x=function(e){return arguments.length?(i=+e,t):i},t.y=function(e){return arguments.length?(o=+e,t):o},t.strength=function(e){return arguments.length?(l=+e,t):l},t}function U(e){var t=+this._x.call(null,e),r=+this._y.call(null,e);return d(this.cover(t,r),t,r,e)}function d(e,t,r,n){if(!isNaN(t)&&!isNaN(r)){var a,i,o,s,l,c,u,d,f,p=e._root,h={data:n},g=e._x0,m=e._y0,_=e._x1,y=e._y1;if(p){for(;p.length;)if((c=t>=(i=(g+_)/2))?g=i:_=i,(u=r>=(o=(m+y)/2))?m=o:y=o,!(p=(a=p)[d=u<<1|c]))return a[d]=h,e;if(s=+e._x.call(null,p.data),l=+e._y.call(null,p.data),t===s&&r===l)h.next=p,a?a[d]=h:e._root=h;else{for(;a=a?a[d]=new Array(4):e._root=new Array(4),(c=t>=(i=(g+_)/2))?g=i:_=i,(u=r>=(o=(m+y)/2))?m=o:y=o,(d=u<<1|c)==(f=(o<=l)<<1|i<=s););a[f]=p,a[d]=h}}else e._root=h}return e}function B(e){for(var t,r,n=e.length,a=new Array(n),i=new Array(n),o=1/0,s=1/0,l=-1/0,c=-1/0,u=0;u<n;++u)isNaN(t=+this._x.call(null,r=e[u]))||isNaN(r=+this._y.call(null,r))||((a[u]=t)<o&&(o=t),l<t&&(l=t),(i[u]=r)<s&&(s=r),c<r&&(c=r));if(!(l<o||c<s))for(this.cover(o,s).cover(l,c),u=0;u<n;++u)d(this,a[u],i[u],e[u]);return this}function j(e,t){if(!isNaN(e=+e)&&!isNaN(t=+t)){var r=this._x0,n=this._y0,a=this._x1,i=this._y1;if(isNaN(r))a=(r=Math.floor(e))+1,i=(n=Math.floor(t))+1;else{for(var o,s,l=a-r||1,c=this._root;e<r||a<=e||t<n||i<=t;)switch(s=(t<n)<<1|e<r,(o=new Array(4))[s]=c,c=o,l*=2,s){case 0:a=r+l,i=n+l;break;case 1:r=a-l,i=n+l;break;case 2:a=r+l,n=i-l;break;case 3:r=a-l,n=i-l}this._root&&this._root.length&&(this._root=c)}this._x0=r,this._y0=n,this._x1=a,this._y1=i}return this}function H(){var t=[];return this.visit(function(e){if(!e.length)for(;t.push(e.data),e=e.next;);}),t}function G(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function _(e,t,r,n,a){this.node=e,this.x0=t,this.y0=r,this.x1=n,this.y1=a}function V(e,t,r){var n,a,i,o,s,l,c,u,d=this._x0,f=this._y0,p=this._x1,h=this._y1,g=[],m=this._root;for(m&&g.push(new _(m,d,f,p,h)),null==r?r=1/0:(d=e-r,f=t-r,p=e+r,h=t+r,r*=r);n=g.pop();)!(m=n.node)||(s=n.x0)>p||(l=n.y0)>h||(o=n.x1)<d||(a=n.y1)<f||(m.length?(g.push(new _(m[3],i=(s+o)/2,c=(l+a)/2,o,a),new _(m[2],s,c,i,a),new _(m[1],i,l,o,c),new _(m[0],s,l,i,c)),(a=(c<=t)<<1|i<=e)&&(n=g[g.length-1],g[g.length-1]=g[g.length-1-a],g[g.length-1-a]=n)):(l=(o=e-+this._x.call(null,m.data))*o+(s=t-+this._y.call(null,m.data))*s)<r&&(d=e-(c=Math.sqrt(r=l)),f=t-c,p=e+c,h=t+c,u=m.data));return u}function W(e){if(!isNaN(i=+this._x.call(null,e))&&!isNaN(o=+this._y.call(null,e))){var t,r,n,a,i,o,s,l,c,u,d,f=this._root,p=this._x0,h=this._y0,g=this._x1,m=this._y1;if(f){if(f.length)for(;;){if((l=i>=(s=(p+g)/2))?p=s:g=s,(c=o>=(s=(h+m)/2))?h=s:m=s,!(f=(t=f)[u=c<<1|l]))return this;if(!f.length)break;(t[u+1&3]||t[u+2&3]||t[u+3&3])&&(r=t,d=u)}for(;f.data!==e;)if(!(f=(n=f).next))return this;(a=f.next)&&delete f.next,n?a?n.next=a:delete n.next:t?(a?t[u]=a:delete t[u],(f=t[0]||t[1]||t[2]||t[3])&&f===(t[3]||t[2]||t[1]||t[0])&&!f.length&&(r?r[d]=f:this._root=f)):this._root=a}}return this}function q(e){for(var t=0,r=e.length;t<r;++t)this.remove(e[t]);return this}function $(){return this._root}function z(){var t=0;return this.visit(function(e){if(!e.length)for(;++t,e=e.next;);}),t}function K(e){var t,r,n,a,i,o,s,l=[],c=this._root;for(c&&l.push(new _(c,this._x0,this._y0,this._x1,this._y1));i=l.pop();)!e(c=i.node,r=i.x0,n=i.y0,a=i.x1,i=i.y1)&&c.length&&(o=(r+a)/2,s=(n+i)/2,(t=c[3])&&l.push(new _(t,o,s,a,i)),(t=c[2])&&l.push(new _(t,r,s,o,i)),(t=c[1])&&l.push(new _(t,o,n,a,s)),t=c[0])&&l.push(new _(t,r,n,o,s));return this}function Y(e){var t,r=[],n=[];for(this._root&&r.push(new _(this._root,this._x0,this._y0,this._x1,this._y1));t=r.pop();){var a,i,o,s,l,c,u,d=t.node;d.length&&(i=t.x0,o=t.y0,c=(i+(s=t.x1))/2,u=(o+(l=t.y1))/2,(a=d[0])&&r.push(new _(a,i,o,c,u)),(a=d[1])&&r.push(new _(a,c,o,s,u)),(a=d[2])&&r.push(new _(a,i,u,c,l)),a=d[3])&&r.push(new _(a,c,u,s,l)),n.push(t)}for(;t=n.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this}function J(e){return e[0]}function Z(e){return arguments.length?(this._x=e,this):this._x}function Q(e){return e[1]}function X(e){return arguments.length?(this._y=e,this):this._y}function m(e,t,r){t=new i(null==t?J:t,null==r?Q:r,NaN,NaN,NaN,NaN);return null==e?t:t.addAll(e)}function i(e,t,r,n,a,i){this._x=e,this._y=t,this._x0=r,this._y0=n,this._x1=a,this._y1=i,this._root=void 0}function o(e){for(var t={data:e.data},r=t;e=e.next;)r=r.next={data:e.data};return t}var e=m.prototype=i.prototype;function y(e){return function(){return e}}function T(e){return 1e-6*(e()-.5)}function ee(e){return e.x+e.vx}function te(e){return e.y+e.vy}function re(n){var i,o,f,p=1,h=1;function t(){for(var e,t,s,l,c,u,d,r=i.length,n=0;n<h;++n)for(t=m(i,ee,te).visitAfter(g),e=0;e<r;++e)s=i[e],u=o[s.index],d=u*u,l=s.x+s.vx,c=s.y+s.vy,t.visit(a);function a(e,t,r,n,a){var i=e.data,e=e.r,o=u+e;if(!i)return l+o<t||n<l-o||c+o<r||a<c-o;i.index>s.index&&(r=(t=l-i.x-i.vx)*t+(n=c-i.y-i.vy)*n)<o*o&&(0===t&&(r+=(t=T(f))*t),0===n&&(r+=(n=T(f))*n),r=(o-(r=Math.sqrt(r)))/r*p,s.vx+=(t*=r)*(o=(e*=e)/(d+e)),s.vy+=(n*=r)*o,i.vx-=t*(o=1-o),i.vy-=n*o)}}function g(e){if(e.data)return e.r=o[e.data.index];for(var t=e.r=0;t<4;++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r)}function r(){if(i){var e,t,r=i.length;for(o=new Array(r),e=0;e<r;++e)t=i[e],o[t.index]=+n(t,e,i)}}return"function"!=typeof n&&(n=y(null==n?1:+n)),t.initialize=function(e,t){i=e,f=t,r()},t.iterations=function(e){return arguments.length?(h=+e,t):h},t.strength=function(e){return arguments.length?(p=+e,t):p},t.radius=function(e){return arguments.length?(n="function"==typeof e?e:y(+e),r(),t):n},t}function ne(e){return e.index}function b(e,t){e=e.get(t);if(e)return e;throw new Error("node not found: "+t)}function ae(c){var u,d,i,o,f,p,s=ne,r=function(e){return 1/Math.min(o[e.source.index],o[e.target.index])},n=y(30),h=1;function t(e){for(var t=0,r=c.length;t<h;++t)for(var n,a,i,o,s,l=0;l<r;++l)n=(a=c[l]).source,i=(a=a.target).x+a.vx-n.x-n.vx||T(p),o=a.y+a.vy-n.y-n.vy||T(p),i*=s=((s=Math.sqrt(i*i+o*o))-d[l])/s*e*u[l],o*=s,a.vx-=i*(s=f[l]),a.vy-=o*s,n.vx+=i*(s=1-s),n.vy+=o*s}function a(){if(i){var e,t=i.length,r=c.length,n=new Map(i.map((e,t)=>[s(e,t,i),e])),a=0;for(o=new Array(t);a<r;++a)(e=c[a]).index=a,"object"!=typeof e.source&&(e.source=b(n,e.source)),"object"!=typeof e.target&&(e.target=b(n,e.target)),o[e.source.index]=(o[e.source.index]||0)+1,o[e.target.index]=(o[e.target.index]||0)+1;for(a=0,f=new Array(r);a<r;++a)e=c[a],f[a]=o[e.source.index]/(o[e.source.index]+o[e.target.index]);u=new Array(r),l(),d=new Array(r),g()}}function l(){if(i)for(var e=0,t=c.length;e<t;++e)u[e]=+r(c[e],e,c)}function g(){if(i)for(var e=0,t=c.length;e<t;++e)d[e]=+n(c[e],e,c)}return null==c&&(c=[]),t.initialize=function(e,t){i=e,p=t,a()},t.links=function(e){return arguments.length?(c=e,a(),t):c},t.id=function(e){return arguments.length?(s=e,t):s},t.iterations=function(e){return arguments.length?(h=+e,t):h},t.strength=function(e){return arguments.length?(r="function"==typeof e?e:y(+e),l(),t):r},t.distance=function(e){return arguments.length?(n="function"==typeof e?e:y(+e),g(),t):n},t}e.copy=function(){var e,t,r=new i(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root;if(n)if(n.length)for(e=[{source:n,target:r._root=new Array(4)}];n=e.pop();)for(var a=0;a<4;++a)(t=n.source[a])&&(t.length?e.push({source:t,target:n.target[a]=new Array(4)}):n.target[a]=o(t));else r._root=o(n);return r},e.add=U,e.addAll=B,e.cover=j,e.data=H,e.extent=G,e.find=V,e.remove=W,e.removeAll=q,e.root=$,e.size=z,e.visit=K,e.visitAfter=Y,e.x=Z,e.y=X;var ie={value:()=>{}};function g(){for(var e,t=0,r=arguments.length,n={};t<r;++t){if(!(e=arguments[t]+"")||e in n||/[\s.]/.test(e))throw new Error("illegal type: "+e);n[e]=[]}return new a(n)}function a(e){this._=e}function oe(e,n){return e.trim().split(/^|\s+/).map(function(e){var t="",r=e.indexOf(".");if(0<=r&&(t=e.slice(r+1),e=e.slice(0,r)),e&&!n.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:t}})}function se(e,t){for(var r,n=0,a=e.length;n<a;++n)if((r=e[n]).name===t)return r.value}function s(e,t,r){for(var n=0,a=e.length;n<a;++n)if(e[n].name===t){e[n]=ie,e=e.slice(0,n).concat(e.slice(n+1));break}return null!=r&&e.push({name:t,value:r}),e}a.prototype=g.prototype={constructor:a,on:function(e,t){var r,n=this._,a=oe(e+"",n),i=-1,o=a.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++i<o;)if(r=(e=a[i]).type)n[r]=s(n[r],e.name,t);else if(null==t)for(r in n)n[r]=s(n[r],e.name,null);return this}for(;++i<o;)if(r=(r=(e=a[i]).type)&&se(n[r],e.name))return r},copy:function(){var e,t={},r=this._;for(e in r)t[e]=r[e].slice();return new a(t)},call:function(e,t){if(0<(r=arguments.length-2))for(var r,n,a=new Array(r),i=0;i<r;++i)a[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=0,r=(n=this._[e]).length;i<r;++i)n[i].value.apply(t,a)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],a=0,i=n.length;a<i;++a)n[a].value.apply(t,r)}};var l,u,r=0,n=0,f=0,p=1e3,h=0,v=0,E=0,S="object"==typeof performance&&performance.now?performance:Date,A="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function O(){return v||(A(le),v=S.now()+E)}function le(){v=0}function C(){this._call=this._time=this._next=null}function k(e,t,r){var n=new C;return n.restart(e,t,r),n}function ce(){O(),++r;for(var e,t=l;t;)0<=(e=v-t._time)&&t._call.call(void 0,e),t=t._next;--r}function w(){v=(h=S.now())+E,r=n=0;try{ce()}finally{r=0,de(),v=0}}function ue(){var e=S.now(),t=e-h;p<t&&(E-=t,h=e)}function de(){for(var e,t,r=l,n=1/0;r;)r=r._call?(n>r._time&&(n=r._time),(e=r)._next):(t=r._next,r._next=null,e?e._next=t:l=t);u=e,R(n)}function R(e){r||(n=n&&clearTimeout(n),24<e-v?(e<1/0&&(n=setTimeout(w,e-S.now()-E)),f=f&&clearInterval(f)):(f||(h=S.now(),f=setInterval(ue,p)),r=1,A(w)))}C.prototype=k.prototype={constructor:C,restart:function(e,t,r){if("function"!=typeof e)throw new TypeError("callback is not a function");r=(null==r?O():+r)+(null==t?0:+t),this._next||u===this||(u?u._next=this:l=this,u=this),this._call=e,this._time=r,R()},stop:function(){this._call&&(this._call=null,this._time=1/0,R())}};function fe(){let e=1;return()=>(e=(1664525*e+1013904223)%4294967296)/4294967296}function pe(e){return e.x}function he(e){return e.y}var ge=10,me=Math.PI*(3-Math.sqrt(5));function _e(l){var i,o=1,t=.001,s=1-Math.pow(t,1/300),c=0,u=.6,d=new Map,e=k(a),r=g("tick","end"),n=fe();function a(){f(),r.call("tick",i),o<t&&(e.stop(),r.call("end",i))}function f(e){var t,r,n=l.length;void 0===e&&(e=1);for(var a=0;a<e;++a)for(o+=(c-o)*s,d.forEach(function(e){e(o)}),t=0;t<n;++t)null==(r=l[t]).fx?r.x+=r.vx*=u:(r.x=r.fx,r.vx=0),null==r.fy?r.y+=r.vy*=u:(r.y=r.fy,r.vy=0);return i}function p(){for(var e,t,r,n=0,a=l.length;n<a;++n)(r=l[n]).index=n,null!=r.fx&&(r.x=r.fx),null!=r.fy&&(r.y=r.fy),(isNaN(r.x)||isNaN(r.y))&&(e=ge*Math.sqrt(.5+n),t=n*me,r.x=e*Math.cos(t),r.y=e*Math.sin(t)),(isNaN(r.vx)||isNaN(r.vy))&&(r.vx=r.vy=0)}function h(e){return e.initialize&&e.initialize(l,n),e}return null==l&&(l=[]),p(),i={tick:f,restart:function(){return e.restart(a),i},stop:function(){return e.stop(),i},nodes:function(e){return arguments.length?(l=e,p(),d.forEach(h),i):l},alpha:function(e){return arguments.length?(o=+e,i):o},alphaMin:function(e){return arguments.length?(t=+e,i):t},alphaDecay:function(e){return arguments.length?(s=+e,i):+s},alphaTarget:function(e){return arguments.length?(c=+e,i):c},velocityDecay:function(e){return arguments.length?(u=1-e,i):1-u},randomSource:function(e){return arguments.length?(n=e,d.forEach(h),i):n},force:function(e,t){return 1<arguments.length?(null==t?d.delete(e):d.set(e,h(t)),i):d.get(e)},find:function(e,t,r){var n,a,i,o=0,s=l.length;for(null==r?r=1/0:r*=r,o=0;o<s;++o)(n=(n=e-(a=l[o]).x)*n+(n=t-a.y)*n)<r&&(i=a,r=n);return i},on:function(e,t){return 1<arguments.length?(r.on(e,t),i):r.on(e)}}}function ye(){var a,l,c,u,d,n=y(-30),f=1,p=1/0,h=.81;function t(e){var t,r=a.length,n=m(a,pe,he).visitAfter(i);for(u=e,t=0;t<r;++t)l=a[t],n.visit(o)}function r(){if(a){var e,t,r=a.length;for(d=new Array(r),e=0;e<r;++e)t=a[e],d[t.index]=+n(t,e,a)}}function i(e){var t,r,n,a,i,o=0,s=0;if(e.length){for(n=a=i=0;i<4;++i)(t=e[i])&&(r=Math.abs(t.value))&&(o+=t.value,s+=r,n+=r*t.x,a+=r*t.y);e.x=n/s,e.y=a/s}else for((t=e).x=t.data.x,t.y=t.data.y;o+=d[t.data.index],t=t.next;);e.value=o}function o(e,t,r,n){if(!e.value)return!0;var a=e.x-l.x,i=e.y-l.y,o=n-t,s=a*a+i*i;if(o*o/h<s)return s<p&&(0===a&&(s+=(a=T(c))*a),0===i&&(s+=(i=T(c))*i),s<f&&(s=Math.sqrt(f*s)),l.vx+=a*e.value*u/s,l.vy+=i*e.value*u/s),!0;if(!(e.length||p<=s))for((e.data!==l||e.next)&&(0===a&&(s+=(a=T(c))*a),0===i&&(s+=(i=T(c))*i),s<f)&&(s=Math.sqrt(f*s));e.data!==l&&(o=d[e.data.index]*u/s,l.vx+=a*o,l.vy+=i*o),e=e.next;);}return t.initialize=function(e,t){a=e,c=t,r()},t.strength=function(e){return arguments.length?(n="function"==typeof e?e:y(+e),r(),t):n},t.distanceMin=function(e){return arguments.length?(f=e*e,t):Math.sqrt(f)},t.distanceMax=function(e){return arguments.length?(p=e*e,t):Math.sqrt(p)},t.theta=function(e){return arguments.length?(h=e*e,t):Math.sqrt(h)},t}function Te(r){var a,i,o,n=y(.1);function t(e){for(var t,r=0,n=a.length;r<n;++r)(t=a[r]).vx+=(o[r]-t.x)*i[r]*e}function s(){if(a){var e,t=a.length;for(i=new Array(t),o=new Array(t),e=0;e<t;++e)i[e]=isNaN(o[e]=+r(a[e],e,a))?0:+n(a[e],e,a)}}return"function"!=typeof r&&(r=y(null==r?0:+r)),t.initialize=function(e){a=e,s()},t.strength=function(e){return arguments.length?(n="function"==typeof e?e:y(+e),s(),t):n},t.x=function(e){return arguments.length?(r="function"==typeof e?e:y(+e),s(),t):r},t}function be(r){var a,i,o,n=y(.1);function t(e){for(var t,r=0,n=a.length;r<n;++r)(t=a[r]).vy+=(o[r]-t.y)*i[r]*e}function s(){if(a){var e,t=a.length;for(i=new Array(t),o=new Array(t),e=0;e<t;++e)i[e]=isNaN(o[e]=+r(a[e],e,a))?0:+n(a[e],e,a)}}return"function"!=typeof r&&(r=y(null==r?0:+r)),t.initialize=function(e){a=e,s()},t.strength=function(e){return arguments.length?(n="function"==typeof e?e:y(+e),s(),t):n},t.y=function(e){return arguments.length?(r="function"==typeof e?e:y(+e),s(),t):r},t}const P={center:F,collide:re,nbody:ye,link:ae,x:Te,y:be},N="forces",D=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],Ce=["static","iterations"],x=["x","y","vx","vy"];function I(e){t.Transform.call(this,null,e)}function ve(e,t){return()=>e.touch(t).run()}function Ee(e,t){const r=_e(e),n=r.stop,a=r.restart;let i=!1;return r.stopped=()=>i,r.restart=()=>(i=!1,a()),r.stop=()=>(i=!0,n()),M(r,t,!0).on("end",()=>i=!0)}function M(e,t,r,n){for(var a,i,o=c.array(t.forces),s=0,l=D.length;s<l;++s)(a=D[s])!==N&&t.modified(a)&&e[a](t[a]);for(s=0,l=o.length;s<l;++s)i=N+s,(a=r||t.modified(N,s)?Ae(o[s]):n&&Se(o[s],n)?e.force(i):null)&&e.force(i,a);for(l=e.numForces||0;s<l;++s)e.force(N+s,null);return e.numForces=o.length,e}function Se(e,t){var r,n;for(r in e)if(c.isFunction(n=e[r])&&t.modified(c.accessorFields(n)))return 1}function Ae(e){var t,r;for(r in c.hasOwnProperty(P,e.force)||c.error("Unrecognized force: "+e.force),t=P[e.force](),e)c.isFunction(t[r])&&Oe(t[r],e[r],e);return t}function Oe(e,t,r){e(c.isFunction(t)?e=>t(e,r):t)}I.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30,expr:!0},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:x}]},c.inherits(I,t.Transform,{transform(e,t){var r=this.value,n=t.changed(t.ADD_REM),a=e.modified(D),i=e.iterations||300;if(r?(n&&(t.modifies("index"),r.nodes(t.source)),(a||t.changed(t.MOD))&&M(r,e,0,t)):(this.value=r=Ee(t.source,e),r.on("tick",ve(t.dataflow,this)),e.static||(n=!0,r.tick()),t.modifies("index")),a||n||e.modified(Ce)||t.changed()&&e.restart)if(r.alpha(Math.max(r.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(r.alphaMin(),1/i)),e.static)for(r.stop();0<=--i;)r.tick();else if(r.stopped()&&r.restart(),!n)return t.StopPropagation;return this.finish(e,t)},finish(e,t){var a=t.dataflow;for(let e=this._argops,t=0,r=e.length,n;t<r;++t)if((n=e[t]).name===N&&"link"===n.op._argval.force)for(var i,o=n.op._argops,s=0,l=o.length;s<l;++s)if("links"===o[s].name&&(i=o[s].op.source)){a.pulse(i,a.changeset().reflow());break}return t.reflow(e.modified()).modifies(x)}}),L.force=I}}return Lu.exports}var Uu,Bu={exports:{}};function ju(){if(!Uu){Uu=1;var e=Bu.exports;{var o=su(),s=jo();function l(e,r,n){const a={};return e.each(e=>{var t=e.data;n(t)&&(a[r(t)]=e)}),e.lookup=a,e}function L(e,t){return e.parent===t.parent?1:2}function F(e){return e.reduce(U,0)/e.length}function U(e,t){return e+t.x}function B(e){return 1+e.reduce(j,0)}function j(e,t){return Math.max(e,t.y)}function H(e){for(var t;t=e.children;)e=t[0];return e}function G(e){for(var t;t=e.children;)e=t[t.length-1];return e}function V(){var s=L,l=1,c=1,u=!1;function t(t){var r,n=0,e=(t.eachAfter(function(e){var t=e.children;t?(e.x=F(t),e.y=B(t)):(e.x=r?n+=s(e,r):0,e.y=0,r=e)}),H(t)),a=G(t),i=e.x-s(e,a)/2,o=a.x+s(a,e)/2;return t.eachAfter(u?function(e){e.x=(e.x-t.x)*l,e.y=(t.y-e.y)*c}:function(e){e.x=(e.x-i)/(o-i)*l,e.y=(1-(t.y?e.y/t.y:1))*c})}return t.separation=function(e){return arguments.length?(s=e,t):s},t.size=function(e){return arguments.length?(u=!1,l=+e[0],c=+e[1],t):u?null:[l,c]},t.nodeSize=function(e){return arguments.length?(u=!0,l=+e[0],c=+e[1],t):u?[l,c]:null},t}function W(e){var t=0,r=e.children,n=r&&r.length;if(n)for(;0<=--n;)t+=r[n].value;else t=1;e.value=t}function q(){return this.eachAfter(W)}function $(e,t){let r=-1;for(const n of this)e.call(t,n,++r,this);return this}function z(e,t){for(var r,n,a,i=[this],o=-1;r=i.pop();)if(e.call(t,r,++o,this),n=r.children)for(a=n.length-1;0<=a;--a)i.push(n[a]);return this}function K(e,t){for(var r,n,a,i=this,o=[i],s=[],l=-1;i=o.pop();)if(s.push(i),r=i.children)for(n=0,a=r.length;n<a;++n)o.push(r[n]);for(;i=s.pop();)e.call(t,i,++l,this);return this}function Y(e,t){let r=-1;for(const n of this)if(e.call(t,n,++r,this))return n}function J(a){return this.eachAfter(function(e){for(var t=+a(e.data)||0,r=e.children,n=r&&r.length;0<=--n;)t+=r[n].value;e.value=t})}function Z(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function Q(e){for(var t=this,r=X(t,e),n=[t];t!==r;)t=t.parent,n.push(t);for(var a=n.length;e!==r;)n.splice(a,0,e),e=e.parent;return n}function X(e,t){if(e===t)return e;var r=e.ancestors(),n=t.ancestors(),a=null;for(e=r.pop(),t=n.pop();e===t;)a=e,e=r.pop(),t=n.pop();return a}function ee(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function te(){return Array.from(this)}function re(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function ne(){var t=this,r=[];return t.each(function(e){e!==t&&r.push({source:e.parent,target:e})}),r}function*ae(){var e,t,r,n,a,i=[this];do{for(t=i.reverse(),i=[];e=t.pop();)if(yield e,r=e.children)for(n=0,a=r.length;n<a;++n)i.push(r[n])}while(i.length)}function c(e,t){e instanceof Map?(e=[void 0,e],void 0===t&&(t=se)):void 0===t&&(t=oe);for(var r,n,a,i,o,e=new T(e),s=[e];r=s.pop();)if((a=t(r.data))&&(o=(a=Array.from(a)).length))for(r.children=a,i=o-1;0<=i;--i)s.push(n=a[i]=new T(a[i])),n.parent=r,n.depth=r.depth+1;return e.eachBefore(ce)}function ie(){return c(this).eachBefore(le)}function oe(e){return e.children}function se(e){return Array.isArray(e)?e[1]:null}function le(e){void 0!==e.data.value&&(e.value=e.data.value),e.data=e.data.data}function ce(e){for(var t=0;e.height=t,(e=e.parent)&&e.height<++t;);}function T(e){this.data=e,this.depth=this.height=0,this.parent=null}function u(e){return null==e?null:ue(e)}function ue(e){if("function"!=typeof e)throw new Error;return e}function p(){return 0}function h(e){return function(){return e}}T.prototype=c.prototype={constructor:T,count:q,each:$,eachAfter:K,eachBefore:z,find:Y,sum:J,sort:Z,path:Q,ancestors:ee,descendants:te,leaves:re,links:ne,copy:ie,[Symbol.iterator]:ae};const Ze=1664525,Qe=1013904223,M=4294967296;function de(){let e=1;return()=>(e=(Ze*e+Qe)%M)/M}function fe(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function pe(e,t){let r=e.length,n,a;for(;r;)a=t()*r--|0,n=e[r],e[r]=e[a],e[a]=n;return e}function he(e,t){for(var r,n,a=0,i=(e=pe(Array.from(e),t)).length,o=[];a<i;)r=e[a],n&&me(n,r)?++a:(n=_e(o=ge(o,r)),a=0);return n}function ge(e,t){var r,n;if(i(t,e))return[t];for(r=0;r<e.length;++r)if(a(t,e[r])&&i(d(e[r],t),e))return[e[r],t];for(r=0;r<e.length-1;++r)for(n=r+1;n<e.length;++n)if(a(d(e[r],e[n]),t)&&a(d(e[r],t),e[n])&&a(d(e[n],t),e[r])&&i(Te(e[r],e[n],t),e))return[e[r],e[n],t];throw new Error}function a(e,t){var r=e.r-t.r,n=t.x-e.x,t=t.y-e.y;return r<0||r*r<n*n+t*t}function me(e,t){var r=e.r-t.r+1e-9*Math.max(e.r,t.r,1),n=t.x-e.x,t=t.y-e.y;return 0<r&&n*n+t*t<r*r}function i(e,t){for(var r=0;r<t.length;++r)if(!me(e,t[r]))return;return 1}function _e(e){switch(e.length){case 1:return ye(e[0]);case 2:return d(e[0],e[1]);case 3:return Te(e[0],e[1],e[2])}}function ye(e){return{x:e.x,y:e.y,r:e.r}}function d(e,t){var r=e.x,n=e.y,e=e.r,a=t.x,i=t.y,t=t.r,o=a-r,s=i-n,l=t-e,c=Math.sqrt(o*o+s*s);return{x:(r+a+o/c*l)/2,y:(n+i+s/c*l)/2,r:(c+e+t)/2}}function Te(e,t,r){var n=e.x,a=e.y,e=e.r,i=t.x,o=t.y,t=t.r,s=r.x,l=r.y,r=r.r,c=n-i,u=n-s,d=a-o,f=a-l,p=t-e,h=r-e,g=n*n+a*a-e*e,i=g-i*i-o*o+t*t,o=g-s*s-l*l+r*r,t=u*d-c*f,g=(d*o-f*i)/(2*t)-n,s=(f*p-d*h)/t,l=(u*i-c*o)/(2*t)-a,r=(c*h-u*p)/t,f=s*s+r*r-1,d=2*(e+g*s+l*r),i=g*g+l*l-e*e,o=-(1e-6<Math.abs(f)?(d+Math.sqrt(d*d-4*f*i))/(2*f):i/d);return{x:n+g+s*o,y:a+l+r*o,r:o}}function be(e,t,r){var n,a,i,o,s=e.x-t.x,l=e.y-t.y,c=s*s+l*l;c?(a=t.r+r.r,o=e.r+r.r,(o*=o)<(a*=a)?(n=(c+o-a)/(2*c),i=Math.sqrt(Math.max(0,o/c-n*n)),r.x=e.x-n*s-i*l,r.y=e.y-n*l+i*s):(n=(c+a-o)/(2*c),i=Math.sqrt(Math.max(0,a/c-n*n)),r.x=t.x+n*s-i*l,r.y=t.y+n*l+i*s)):(r.x=t.x+r.r,r.y=t.y)}function ve(e,t){var r=e.r+t.r-1e-6,n=t.x-e.x,t=t.y-e.y;return 0<r&&n*n+t*t<r*r}function Ee(e){var t=e._,e=e.next._,r=t.r+e.r,n=(t.x*e.r+e.x*t.r)/r,e=(t.y*e.r+e.y*t.r)/r;return n*n+e*e}function g(e){this._=e,this.next=null,this.previous=null}function Se(e,t){if(!(a=(e=fe(e)).length))return 0;var r,n,a,i,o,s,l,c,u,d,f=e[0];if(f.x=0,f.y=0,!(1<a))return f.r;if(r=e[1],f.x=-r.r,r.x=f.r,r.y=0,!(2<a))return f.r+r.r;be(r,f,n=e[2]),f=new g(f),r=new g(r),n=new g(n),((f.next=n.previous=r).next=f.previous=n).next=r.previous=f;e:for(s=3;s<a;++s){be(f._,r._,n=e[s]),n=new g(n),l=r.next,c=f.previous,u=r._.r,d=f._.r;do{if(u<=d){if(ve(l._,n._)){r=l,(f.next=r).previous=f,--s;continue e}u+=l._.r,l=l.next}else{if(ve(c._,n._)){((f=c).next=r).previous=f,--s;continue e}d+=c._.r,c=c.previous}}while(l!==c.next);for(n.previous=f,n.next=r,f.next=r.previous=r=n,i=Ee(f);(n=n.next)!==r;)(o=Ee(n))<i&&(f=n,i=o);r=f.next}for(f=[r._],n=r;(n=n.next)!==r;)f.push(n._);for(n=he(f,t),s=0;s<a;++s)(f=e[s]).x-=n.x,f.y-=n.y;return n.r}function Ae(e){return Math.sqrt(e.value)}function Oe(){var r=null,n=1,a=1,i=p;function t(e){var t=de();return e.x=n/2,e.y=a/2,r?e.eachBefore(Ce(r)).eachAfter(f(i,.5,t)).eachBefore(ke(1)):e.eachBefore(Ce(Ae)).eachAfter(f(p,1,t)).eachAfter(f(i,e.r/Math.min(n,a),t)).eachBefore(ke(Math.min(n,a)/(2*e.r))),e}return t.radius=function(e){return arguments.length?(r=u(e),t):r},t.size=function(e){return arguments.length?(n=+e[0],a=+e[1],t):[n,a]},t.padding=function(e){return arguments.length?(i="function"==typeof e?e:h(+e),t):i},t}function Ce(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function f(o,s,l){return function(e){if(t=e.children){var t,r,n,a=t.length,i=o(e)*s||0;if(i)for(r=0;r<a;++r)t[r].r+=i;if(n=Se(t,l),i)for(r=0;r<a;++r)t[r].r-=i;e.r=n+i}}}function ke(r){return function(e){var t=e.parent;e.r*=r,t&&(e.x=t.x+r*e.x,e.y=t.y+r*e.y)}}function we(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function S(e,t,r,n,a){for(var i,o=e.children,s=-1,l=o.length,c=e.value&&(n-t)/e.value;++s<l;)(i=o[s]).y0=r,i.y1=a,i.x0=t,i.x1=t+=i.value*c}function Re(){var r=1,n=1,s=0,a=!1;function t(e){var i,o,t=e.height+1;return e.x0=e.y0=s,e.x1=r,e.y1=n/t,e.eachBefore((i=n,o=t,function(e){e.children&&S(e,e.x0,i*(e.depth+1)/o,e.x1,i*(e.depth+2)/o);var t=e.x0,r=e.y0,n=e.x1-s,a=e.y1-s;n<t&&(t=n=(t+n)/2),a<r&&(r=a=(r+a)/2),e.x0=t,e.y0=r,e.x1=n,e.y1=a})),a&&e.eachBefore(we),e}return t.round=function(e){return arguments.length?(a=!!e,t):a},t.size=function(e){return arguments.length?(r=+e[0],n=+e[1],t):[r,n]},t.padding=function(e){return arguments.length?(s=+e,t):s},t}var Ie={depth:-1},Me={},b={};function Pe(e){return e.id}function Ne(e){return e.parentId}function De(){var m,_=Pe,y=Ne;function t(r){var t,e,n,a,i,o,s,l,c=Array.from(r),u=_,d=y,f=new Map;if(null!=m){const h=c.map((e,t)=>xe(m(e,t,r))),g=h.map(Le);var p=new Set(h).add("");for(const n of g)p.has(n)||(p.add(n),h.push(n),g.push(Le(n)),c.push(b));u=(e,t)=>h[t],d=(e,t)=>g[t]}for(n=0,t=c.length;n<t;++n)e=c[n],o=c[n]=new T(e),null!=(s=u(e,n,r))&&(s+="")&&(l=o.id=s,f.set(l,f.has(l)?Me:o)),null!=(s=d(e,n,r))&&(s+="")&&(o.parent=s);for(n=0;n<t;++n)if(s=(o=c[n]).parent){if(!(i=f.get(s)))throw new Error("missing: "+s);if(i===Me)throw new Error("ambiguous: "+s);i.children?i.children.push(o):i.children=[o],o.parent=i}else{if(a)throw new Error("multiple roots");a=o}if(!a)throw new Error("no root");if(null!=m){for(;a.data===b&&1===a.children.length;)a=a.children[0],--t;for(let e=c.length-1;0<=e&&(o=c[e]).data===b;--e)o.data=null}if(a.parent=Ie,a.eachBefore(function(e){e.depth=e.parent.depth+1,--t}).eachBefore(ce),a.parent=null,0<t)throw new Error("cycle");return a}return t.id=function(e){return arguments.length?(_=u(e),t):_},t.parentId=function(e){return arguments.length?(y=u(e),t):y},t.path=function(e){return arguments.length?(m=u(e),t):m},t}function xe(e){var t=(e=""+e).length;return"/"===(e=r(e,t-1)&&!r(e,t-2)?e.slice(0,-1):e)[0]?e:"/"+e}function Le(e){let t=e.length;if(t<2)return"";for(;1<--t&&!r(e,t););return e.slice(0,t)}function r(t,r){if("/"===t[r]){let e=0;for(;0<r&&"\\"===t[--r];)++e;if(0==(1&e))return 1}}function Fe(e,t){return e.parent===t.parent?1:2}function m(e){var t=e.children;return t?t[0]:e.t}function _(e){var t=e.children;return t?t[t.length-1]:e.t}function Ue(e,t,r){var n=r/(t.i-e.i);t.c-=n,t.s+=r,e.c+=n,t.z+=r,t.m+=r}function Be(e){for(var t,r=0,n=0,a=e.children,i=a.length;0<=--i;)(t=a[i]).z+=r,t.m+=r,r+=t.s+(n+=t.c)}function je(e,t,r){return e.a.parent===t.parent?e.a:r}function y(e,t){this._=e,this.parent=null,this.children=null,this.A=null,(this.a=this).z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}function He(e){for(var t,r,n,a,i,e=new y(e,0),o=[e];t=o.pop();)if(n=t._.children)for(t.children=new Array(i=n.length),a=i-1;0<=a;--a)o.push(r=t.children[a]=new y(n[a],a)),r.parent=t;return(e.parent=new y(null,0)).children=[e],e}function Ge(){var f=Fe,l=1,c=1,u=null;function t(e){var t,r,n,a,i,o,s=He(e);return s.eachAfter(d),s.parent.m=-s.z,s.eachBefore(p),u?e.eachBefore(h):((n=r=t=e).eachBefore(function(e){e.x<t.x&&(t=e),e.x>r.x&&(r=e),e.depth>n.depth&&(n=e)}),s=t===r?1:f(t,r)/2,a=s-t.x,i=l/(r.x+s+a),o=c/(n.depth||1),e.eachBefore(function(e){e.x=(e.x+a)*i,e.y=e.depth*o})),e}function d(e){var t=e.children,r=e.parent.children,n=e.i?r[e.i-1]:null;t?(Be(e),t=(t[0].z+t[t.length-1].z)/2,n?(e.z=n.z+f(e._,n._),e.m=e.z-t):e.z=t):n&&(e.z=n.z+f(e._,n._)),e.parent.A=function(e,t,r){if(t){for(var n,a=e,i=e,o=t,s=a.parent.children[0],l=a.m,c=i.m,u=o.m,d=s.m;o=_(o),a=m(a),o&&a;)s=m(s),(i=_(i)).a=e,0<(n=o.z+u-a.z-l+f(o._,a._))&&(Ue(je(o,e,r),e,n),l+=n,c+=n),u+=o.m,l+=a.m,d+=s.m,c+=i.m;o&&!_(i)&&(i.t=o,i.m+=u-c),a&&!m(s)&&(s.t=a,s.m+=l-d,r=e)}return r}(e,n,e.parent.A||r[0])}function p(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function h(e){e.x*=l,e.y=e.depth*c}return t.separation=function(e){return arguments.length?(f=e,t):f},t.size=function(e){return arguments.length?(u=!1,l=+e[0],c=+e[1],t):u?null:[l,c]},t.nodeSize=function(e){return arguments.length?(u=!0,l=+e[0],c=+e[1],t):u?[l,c]:null},t}function A(e,t,r,n,a){for(var i,o=e.children,s=-1,l=o.length,c=e.value&&(a-r)/e.value;++s<l;)(i=o[s]).x0=t,i.x1=n,i.y0=r,i.y1=r+=i.value*c}y.prototype=Object.create(T.prototype);var t=(1+Math.sqrt(5))/2;function Ve(e,t,r,n,a,i){for(var o,s,l,c,u,d,f,p,h,g,m,_=[],y=t.children,T=0,b=0,v=y.length,E=t.value;T<v;){for(l=a-r,c=i-n;!(u=y[b++].value)&&b<v;);for(m=(d=f=u)*u*(g=Math.max(c/l,l/c)/(E*e)),h=Math.max(f/m,m/d);b<v;++b){if(u+=s=y[b].value,s<d&&(d=s),f<s&&(f=s),m=u*u*g,h<(p=Math.max(f/m,m/d))){u-=s;break}h=p}_.push(o={value:u,dice:l<c,children:y.slice(T,b)}),o.dice?S(o,r,n,a,E?n+=c*u/E:i):A(o,r,n,E?r+=l*u/E:a,i),E-=u,T=b}return _}var We=function t(i){function e(e,t,r,n,a){Ve(i,e,t,r,n,a)}return e.ratio=function(e){return t(1<(e=+e)?e:1)},e}(t);function qe(){var o=We,t=!1,r=1,n=1,s=[0],l=p,c=p,u=p,d=p,f=p;function a(e){return e.x0=e.y0=0,e.x1=r,e.y1=n,e.eachBefore(i),s=[0],t&&e.eachBefore(we),e}function i(e){var t=s[e.depth],r=e.x0+t,n=e.y0+t,a=e.x1-t,i=e.y1-t;a<r&&(r=a=(r+a)/2),i<n&&(n=i=(n+i)/2),e.x0=r,e.y0=n,e.x1=a,e.y1=i,e.children&&(t=s[e.depth+1]=l(e)/2,r+=f(e)-t,n+=c(e)-t,(a-=u(e)-t)<r&&(r=a=(r+a)/2),(i-=d(e)-t)<n&&(n=i=(n+i)/2),o(e,r,n,a,i))}return a.round=function(e){return arguments.length?(t=!!e,a):t},a.size=function(e){return arguments.length?(r=+e[0],n=+e[1],a):[r,n]},a.tile=function(e){return arguments.length?(o=ue(e),a):o},a.padding=function(e){return arguments.length?a.paddingInner(e).paddingOuter(e):a.paddingInner()},a.paddingInner=function(e){return arguments.length?(l="function"==typeof e?e:h(+e),a):l},a.paddingOuter=function(e){return arguments.length?a.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):a.paddingTop()},a.paddingTop=function(e){return arguments.length?(c="function"==typeof e?e:h(+e),a):c},a.paddingRight=function(e){return arguments.length?(u="function"==typeof e?e:h(+e),a):u},a.paddingBottom=function(e){return arguments.length?(d="function"==typeof e?e:h(+e),a):d},a.paddingLeft=function(e){return arguments.length?(f="function"==typeof e?e:h(+e),a):f},a}function $e(e,t,r,n,a){var i,o,g=e.children,s=g.length,m=new Array(s+1);for(m[0]=o=i=0;i<s;++i)m[i+1]=o+=g[i].value;!function e(t,r,n,a,i,o,s){if(r-1<=t)return(l=g[t]).x0=a,l.y0=i,l.x1=o,void(l.y1=s);var l=m[t],c=n/2+l,u=t+1,d=r-1;for(;u<d;){var f=u+d>>>1;m[f]<c?u=1+f:d=f}c-m[u-1]<m[u]-c&&t+1<u&&--u;var l=m[u]-l,p=n-l;{var h;s-i<o-a?(e(t,u,l,a,i,h=n?(a*p+o*l)/n:o,s),e(u,r,p,h,i,o,s)):(e(t,u,l,a,i,o,h=n?(i*p+s*l)/n:s),e(u,r,p,a,h,o,s))}}(0,s,e.value,t,r,n,a)}function ze(e,t,r,n,a){(1&e.depth?A:S)(e,t,r,n,a)}function n(e){o.Transform.call(this,null,e)}t=function t(p){function e(e,t,r,n,a){if((i=e._squarify)&&i.ratio===p)for(var i,o,s,l,c,u=-1,d=i.length,f=e.value;++u<d;){for(s=(o=i[u]).children,l=o.value=0,c=s.length;l<c;++l)o.value+=s[l].value;o.dice?S(o,t,r,n,f?r+=(a-r)*o.value/f:a):A(o,t,r,f?t+=(n-t)*o.value/f:n,a),f-=o.value}else e._squarify=i=Ve(p,e,t,r,n,a),i.ratio=p}return e.ratio=function(e){return t(1<(e=+e)?e:1)},e}(t),n.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const Xe=e=>e.values;function Ke(){const d=[],t={entries:e=>function e(t,r){if(++r>d.length)return t;const n=[];for(const a in t)n.push({key:a,values:e(t[a],r)});return n}(function e(t,r){if(r>=d.length)return t;const n=t.length,a=d[r++],i={},o={};let s=-1,l,c,u;for(;++s<n;)l=a(c=t[s])+"",(u=i[l])?u.push(c):i[l]=[c];for(l in i)o[l]=e(i[l],r);return o}(e,0),0),key:e=>(d.push(e),t)};return t}function v(e){o.Transform.call(this,null,e)}s.inherits(n,o.Transform,{transform(e,t){t.source||s.error("Nest transform requires an upstream data source.");var r=e.generate,n=e.modified(),a=t.clone(),i=this.value;return i&&!n&&!t.changed()||(i&&i.each(e=>{e.children&&o.isTuple(e.data)&&a.rem.push(e.data)}),this.value=i=c({values:s.array(e.keys).reduce((e,t)=>(e.key(t),e),Ke()).entries(a.source)},Xe),r&&i.each(e=>{e.children&&(e=o.ingest(e.data),a.add.push(e),a.source.push(e))}),l(i,o.tupleid,o.tupleid)),a.source.root=i,a}});const et=(e,t)=>e.parent===t.parent?1:2;function Ye(n,a,i){for(let e,t=0,r=a.length;t<r;++t)(e=a[t])in i&&n[e](i[e])}function Je(t,r,n){var a=t.data,i=r.length-1;for(let e=0;e<i;++e)a[n[e]]=t[r[e]];a[n[i]]=t.children?t.children.length:0}s.inherits(v,o.Transform,{transform(e,t){t.source&&t.source.root||s.error(this.constructor.name+" transform requires a backing tree data source.");const r=this.layout(e.method),n=this.fields,a=t.source.root,i=e.as||n;e.field?a.sum(e.field):a.count(),e.sort&&a.sort(o.stableCompare(e.sort,e=>e.data)),Ye(r,this.params,e),r.separation&&r.separation(!1!==e.separation?et:s.one);try{this.value=r(a)}catch(e){s.error(e)}return a.each(e=>Je(e,n,i)),t.reflow(e.modified()).modifies(i).modifies("leaf")}});var E=["x","y","r","depth","children"];function O(e){v.call(this,e)}O.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:E.length,default:E}]},s.inherits(O,v,{layout:Oe,params:["radius","size","padding"],fields:E});E=["x0","y0","x1","y1","depth","children"];function C(e){v.call(this,e)}function k(e){o.Transform.call(this,null,e)}C.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:E.length,default:E}]},s.inherits(C,v,{layout:Re,params:["size","round","padding"],fields:E}),k.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},s.inherits(k,o.Transform,{transform(e,t){t.source||s.error("Stratify transform requires an upstream data source.");let r=this.value;var n=e.modified(),a=t.fork(t.ALL).materialize(t.SOURCE),n=!r||n||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return a.source=a.source.slice(),n&&(r=a.source.length?l(De().id(e.key).parentId(e.parentKey)(a.source),e.key,s.truthy):l(De()([{}]),e.key,e.key)),a.source.root=this.value=r,a}});const P={tidy:Ge,cluster:V},N=["x","y","depth","children"];function w(e){v.call(this,e)}function R(e){o.Transform.call(this,[],e)}w.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:N.length,default:N}]},s.inherits(w,v,{layout(e){e=e||"tidy";if(s.hasOwnProperty(P,e))return P[e]();s.error("Unrecognized Tree layout method: "+e)},params:["size","nodeSize"],fields:N}),R.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},s.inherits(R,o.Transform,{transform(e,t){const r=this.value,n=t.source&&t.source.root,a=t.fork(t.NO_SOURCE),i={};return n||s.error("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(a.rem=r,t.visit(t.SOURCE,e=>i[o.tupleid(e)]=1),n.each(e=>{var t=e.data,e=e.parent&&e.parent.data;e&&i[o.tupleid(t)]&&i[o.tupleid(e)]&&a.add.push(o.ingest({source:e,target:t}))}),this.value=a.add):t.changed(t.MOD)&&(t.visit(t.MOD,e=>i[o.tupleid(e)]=1),r.forEach(e=>{(i[o.tupleid(e.source)]||i[o.tupleid(e.target)])&&a.mod.push(e)})),a}});const D={binary:$e,dice:S,slice:A,slicedice:ze,squarify:We,resquarify:t},x=["x0","y0","x1","y1","depth","children"];function I(e){v.call(this,e)}I.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:x.length,default:x}]},s.inherits(I,v,{layout(){const r=qe();return r.ratio=e=>{var t=r.tile();t.ratio&&r.tile(t.ratio(e))},r.method=e=>{s.hasOwnProperty(D,e)?r.tile(D[e]):s.error("Unrecognized Treemap layout method: "+e)},r},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:x}),e.nest=n,e.pack=O,e.partition=C,e.stratify=k,e.tree=w,e.treelinks=R,e.treemap=I}}return Bu.exports}var Hu,Gu={exports:{}};function Vu(){if(!Hu){Hu=1;var e=Gu.exports;{var D=Au(),A=yu(),t=su(),i=jo();const B=4278190080;function O(t,e){const r=t.bitmap();return(e||[]).forEach(e=>r.set(t(e.boundary[0]),t(e.boundary[3]))),[r,void 0]}function C(e,t,r,n,a){const i=e.width,o=e.height,s=n||a,l=A.canvas(i,o).getContext("2d"),c=A.canvas(i,o).getContext("2d"),u=s&&A.canvas(i,o).getContext("2d");r.forEach(e=>w(l,e,!1)),w(c,t,!1),s&&w(u,t,!0);var d=k(l,i,o),f=k(c,i,o),p=s&&k(u,i,o),h=e.bitmap(),g=s&&e.bitmap();let m,_,y,T,b,v,E,S;for(_=0;_<o;++_)for(m=0;m<i;++m)v=d[b=_*i+m]&B,S=f[b]&B,E=s&&p[b]&B,(v||E||S)&&(y=e(m),T=e(_),a||!v&&!S||h.set(y,T),s)&&(v||E)&&g.set(y,T);return[h,g]}function k(e,t,r){return new Uint32Array(e.getImageData(0,0,t,r).data.buffer)}function w(t,e,r){var n;e.length&&("group"===(n=e[0].mark.marktype)?e.forEach(e=>{e.items.forEach(e=>w(t,e.items,r))}):D.Marks[n].draw(t,{items:r?e.map(a):e}))}function a(e){e=t.rederive(e,{});return e.stroke&&0!==e.strokeOpacity||e.fill&&0!==e.fillOpacity?{...e,strokeOpacity:1,stroke:"#000",fillOpacity:0}:e}const p=new Uint32Array(33),h=new Uint32Array(33);h[0]=0,p[0]=~h[0];for(let e=1;e<=32;++e)h[e]=h[e-1]<<1|1,p[e]=~h[e];function s(c,a){const u=new Uint32Array(~~((c*a+32)/32));function d(e,t){u[e]|=t}function f(e,t){u[e]&=t}return{array:u,get:(e,t)=>{t=t*c+e;return u[t>>>5]&1<<(31&t)},set:(e,t)=>{t=t*c+e;d(t>>>5,1<<(31&t))},clear:(e,t)=>{t=t*c+e;f(t>>>5,~(1<<(31&t)))},getRange:(e,t,r,n)=>{let a=n,i,o,s,l;for(;a>=t;--a)if((s=(i=a*c+e)>>>5)==(l=(o=a*c+r)>>>5)){if(u[s]&p[31&i]&h[1+(31&o)])return!0}else{if(u[s]&p[31&i])return!0;if(u[l]&h[1+(31&o)])return!0;for(let e=1+s;e<l;++e)if(u[e])return!0}return!1},setRange:(e,t,r,n)=>{let a,i,o,s,l;for(;t<=n;++t)if((o=(a=t*c+e)>>>5)==(s=(i=t*c+r)>>>5))d(o,p[31&a]&h[1+(31&i)]);else for(d(o,p[31&a]),d(s,h[1+(31&i)]),l=1+o;l<s;++l)d(l,4294967295)},clearRange:(e,t,r,n)=>{let a,i,o,s,l;for(;t<=n;++t)if((o=(a=t*c+e)>>>5)==(s=(i=t*c+r)>>>5))f(o,h[31&a]|p[1+(31&i)]);else for(f(o,h[31&a]),f(s,p[1+(31&i)]),l=1+o;l<s;++l)f(l,0)},outOfBounds:(e,t,r,n)=>e<0||t<0||a<=n||c<=r}}function R(e,t,r){const n=Math.max(1,Math.sqrt(e*t/1e6)),a=~~((e+2*r+n)/n),i=~~((t+2*r+n)/n),o=e=>~~((e+r)/n);return o.invert=e=>e*n-r,o.bitmap=()=>s(a,i),o.ratio=n,o.padding=r,o.width=e,o.height=t,o}function r(e,t,r,p){const h=e.width,g=e.height;return function(t){var r=t.datum.datum.items[p].items,n=r.length,e=t.datum.fontSize,a=D.textMetrics.width(t.datum,t.datum.text);let i=0,o,s,l,c,u,d,f;for(let e=0;e<n;++e)o=r[e].x,l=r[e].y,s=void 0===r[e].x2?o:r[e].x2,c=void 0===r[e].y2?l:r[e].y2,u=(o+s)/2,d=(l+c)/2,(f=Math.abs(s-o+c-l))>=i&&(i=f,t.x=u,t.y=d);return u=a/2,d=e/2,o=t.x-u,s=t.x+u,l=t.y-d,c=t.y+d,t.align="center",o<0&&s<=h?t.align="left":0<=o&&h<s&&(t.align="right"),t.baseline="middle",l<0&&c<=g?t.baseline="top":0<=l&&g<c&&(t.baseline="bottom"),!0}}function x(e,t,r,n,a,i){let o=r/2;return e-o<0||e+o>a||t-(o=n/2)<0||t+o>i}function L(e,t,r,n,a,i,o,s){a=a*i/(2*n),n=e(t-a),t=e(t+a),a=e(r-(i/=2)),e=e(r+i);return o.outOfBounds(n,a,t,e)||o.getRange(n,a,t,e)||s&&s.getRange(n,a,t,e)}function n(k,e,w,R){const I=k.width,M=k.height,P=e[0],u=e[1];function N(e,t,r,n,a){var i=k.invert(e),o=k.invert(t);let s=r,l=M,c;if(!x(i,o,n,a,I,M)&&!L(k,i,o,a,n,s,P,u)&&!L(k,i,o,a,n,a,P,null)){for(;1<=l-s;)c=(s+l)/2,L(k,i,o,a,n,c,P,u)?l=c:s=c;if(s>r)return[i,o,s,!0]}}return function(t){var r=t.datum.datum.items[R].items,n=r.length,a=t.datum.fontSize,i=D.textMetrics.width(t.datum,t.datum.text);let o=w?a:0,s=!1,l=!1,c=0,u,d,f,p,h,g,m,_,y,T,b,v,E,S,A,O,C;for(let e=0;e<n;++e){for(u=r[e].x,f=r[e].y,d=void 0===r[e].x2?u:r[e].x2,p=void 0===r[e].y2?f:r[e].y2,u>d&&(C=u,u=d,d=C),f>p&&(C=f,f=p,p=C),T=~~(((y=k(u))+(b=k(d)))/2),E=~~(((v=k(f))+(S=k(p)))/2),m=T;m>=y;--m)for(_=E;_>=v;--_)(O=N(m,_,o,i,a))&&([t.x,t.y,o,s]=O);for(m=T;m<=b;++m)for(_=E;_<=S;++_)(O=N(m,_,o,i,a))&&([t.x,t.y,o,s]=O);s||w||(A=Math.abs(d-u+p-f),h=(u+d)/2,g=(f+p)/2,A>=c&&!x(h,g,i,a,I,M)&&!L(k,h,g,a,i,a,P,null)&&(c=A,t.x=h,t.y=g,l=!0))}return!(!s&&!l||(h=i/2,g=a/2,P.setRange(k(t.x-h),k(t.y-g),k(t.x+h),k(t.y+g)),t.align="center",t.baseline="middle",0))}}const j=[-1,-1,1,1],H=[-1,1,-1,1];function o(S,e,A,O){const C=S.width,k=S.height,w=e[0],R=e[1],I=S.bitmap();return function(t){var r=t.datum.datum.items[O].items,n=r.length,a=t.datum.fontSize,i=D.textMetrics.width(t.datum,t.datum.text),o=[];let s=A?a:0,l=!1,c=!1,u=0,d,f,p,h,g,m,_,y,T,b,v,E;for(let e=0;e<n;++e){for(d=r[e].x,p=r[e].y,f=void 0===r[e].x2?d:r[e].x2,h=void 0===r[e].y2?p:r[e].y2,o.push([S((d+f)/2),S((p+h)/2)]);o.length;)if([_,y]=o.pop(),!(w.get(_,y)||R.get(_,y)||I.get(_,y))){I.set(_,y);for(let e=0;e<4;++e)g=_+j[e],m=y+H[e],I.outOfBounds(g,m,g,m)||o.push([g,m]);if(g=S.invert(_),m=S.invert(y),T=s,b=k,!x(g,m,i,a,C,k)&&!L(S,g,m,a,i,T,w,R)&&!L(S,g,m,a,i,a,w,null)){for(;1<=b-T;)v=(T+b)/2,L(S,g,m,a,i,v,w,R)?b=v:T=v;T>s&&(t.x=g,t.y=m,s=T,l=!0)}}l||A||(E=Math.abs(f-d+h-p),g=(d+f)/2,m=(p+h)/2,E>=u&&!x(g,m,i,a,C,k)&&!L(S,g,m,a,i,a,w,null)&&(u=E,t.x=g,t.y=m,c=!0))}return!(!l&&!c||(g=i/2,m=a/2,w.setRange(S(t.x-g),S(t.y-m),S(t.x+g),S(t.y+m)),t.align="center",t.baseline="middle",0))}}const G=["right","center","left"],V=["bottom","middle","top"];function I(b,e,v,E){const t=b.width,r=b.height,S=e[0],A=e[1],O=E.length;return function(_){var y=_.boundary,T=_.datum.fontSize;if(!(y[2]<0||y[5]<0||y[0]>t||y[3]>r)){let t=_.textWidth??0,r,n,a,i,o,s,l,c,u,d,f,p,h,g,m;for(let e=0;e<O;++e){if(r=(3&v[e])-1,n=(v[e]>>>2&3)-1,a=0==r&&0==n||E[e]<0,i=r&&n?Math.SQRT1_2:1,o=E[e]<0?-1:1,s=y[1+r]+E[e]*r*i,c=(f=y[4+n]+o*T*n/2+E[e]*n*i)-T/2,u=f+T/2,p=b(s),g=b(c),m=b(u),!t){if(!M(p,p,g,m,S,A,0,0,0,0,0,a))continue;t=D.textMetrics.width(_.datum,_.datum.text)}if(s=(d=s+o*t*r/2)-t/2,l=d+t/2,M(p=b(s),h=b(l),g,m,S,A,0,0,0,0,0,a))return _.x=r?r*o<0?l:s:d,_.y=n?n*o<0?u:c:f,_.align=G[r*o+1],_.baseline=V[n*o+1],S.setRange(p,g,h,m),!0}}return!1}}function M(e,t,r,n,a,i,o,s,l,c,u,d){return!a.outOfBounds(e,r,t,n)&&!(d&&i||a).getRange(e,r,t,n)}const u={"top-left":0,top:1,"top-right":2,left:4,middle:5,right:6,"bottom-left":8,bottom:9,"bottom-right":10},W={naive:r,"reduced-search":n,floodfill:o};function l(e,t,r,n,a,i,o,s,l,c,u){if(!e.length)return e;const d=Math.max(n.length,a.length),f=P(n,d),p=N(a,d),h=F(e[0].datum),g="group"===h&&e[0].datum.items[l].marktype,m="area"===g,_=U(h,g,s,l),y=null===c||c===1/0,T=m&&"naive"===u;let b=-1,v=-1;a=e.map(e=>{var t=y?D.textMetrics.width(e,e.text):void 0;return b=Math.max(b,t),v=Math.max(v,e.fontSize),{datum:e,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:_(e),textWidth:t}}),c=null===c||c===1/0?Math.max(b,v)+Math.max(...n):c,s=R(t[0],t[1],c);let E;if(!T){r&&a.sort((e,t)=>r(e.datum,t.datum));let t=!1;for(let e=0;e<p.length&&!t;++e)t=5===p[e]||f[e]<0;n=(h&&o||m)&&e.map(e=>e.datum);E=i.length||n?C(s,n||[],i,t,m):O(s,o&&a)}const S=m?W[u](s,E,o,l):I(s,E,p,f);return a.forEach(e=>e.opacity=+S(e)),a}function P(t,r){var n=new Float64Array(r),a=t.length;for(let e=0;e<a;++e)n[e]=t[e]||0;for(let e=a;e<r;++e)n[e]=n[a-1];return n}function N(t,r){var n=new Int8Array(r),a=t.length;for(let e=0;e<a;++e)n[e]|=u[t[e]];for(let e=a;e<r;++e)n[e]=n[a-1];return n}function F(e){return e&&e.mark&&e.mark.marktype}function U(e,t,r,n){const a=e=>[e.x,e.x,e.x,e.y,e.y,e.y];return e?"line"===e||"area"===e?e=>a(e.datum):"line"===t?e=>{e=e.datum.items[n].items;return a(e.length?e["start"===r?0:e.length-1]:{x:NaN,y:NaN})}:e=>{e=e.datum.bounds;return[e.x1,(e.x1+e.x2)/2,e.x2,e.y1,(e.y1+e.y2)/2,e.y2]}:a}const d=["x","y","opacity","align","baseline"],f=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function c(e){t.Transform.call(this,null,e)}c.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:f},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:d.length,default:d}]},i.inherits(c,t.Transform,{transform(e,t){var r,n=e.modified();if(n||t.changed(t.ADD_REM)||(r=e[r="sort"],i.isFunction(r)&&t.modified(r.fields))){e.size&&2===e.size.length||i.error("Size parameter should be specified as a [width, height] array.");const a=e.as||d;return l(t.materialize(t.SOURCE).source||[],e.size,e.sort,i.array(null==e.offset?1:e.offset),i.array(e.anchor||f),e.avoidMarks||[],!1!==e.avoidBaseMark,e.lineAnchor||"end",e.markIndex||0,void 0===e.padding?0:e.padding,e.method||"naive").forEach(e=>{var t=e.datum;t[a[0]]=e.x,t[a[1]]=e.y,t[a[2]]=e.opacity,t[a[3]]=e.align,t[a[4]]=e.baseline}),t.reflow(n).modifies(a)}}}),e.label=c}}return Gu.exports}var Wu,qu={exports:{}};function $u(){if(!Wu){Wu=1;var e=qu.exports;{var h=fu(),g=su(),m=jo();function _(e,t){function r(e){return e(o)}var n,a,i,o,s,l,c=[];if(null==t)c.push(e);else for(n={},a=0,i=e.length;a<i;++a)o=e[a],(l=n[s=t.map(r)])||(n[s]=l=[],l.dims=s,c.push(l)),l.push(o);return c}function t(e){g.Transform.call(this,null,e)}t.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},m.inherits(t,g.Transform,{transform(e,t){var r=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const n=t.materialize(t.SOURCE).source,a=_(n,e.groupby),i=(e.groupby||[]).map(m.accessorName),o=i.length,s=e.as||[m.accessorName(e.x),m.accessorName(e.y)],l=[];a.forEach(r=>{h.regressionLoess(r,e.x,e.y,e.bandwidth||.3).forEach(e=>{var t={};for(let e=0;e<o;++e)t[i[e]]=r.dims[e];t[s[0]]=e[0],t[s[1]]=e[1],l.push(g.ingest(t))})}),this.value&&(r.rem=this.value),this.value=r.add=r.source=l}return r}});const n={constant:h.regressionConstant,linear:h.regressionLinear,log:h.regressionLog,exp:h.regressionExp,pow:h.regressionPow,quad:h.regressionQuad,poly:h.regressionPoly},y=(e,t)=>"poly"===e?t:"quad"===e?2:1;function r(e){g.Transform.call(this,null,e)}r.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(n)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},m.inherits(r,g.Transform,{transform(i,o){var e=o.fork(o.NO_SOURCE|o.NO_FIELDS);if(!this.value||o.changed()||i.modified()){const t=o.materialize(o.SOURCE).source,r=_(t,i.groupby),s=(i.groupby||[]).map(m.accessorName),l=i.method||"linear",c=null==i.order?3:i.order,u=y(l,c),d=i.as||[m.accessorName(i.x),m.accessorName(i.y)],f=n[l],p=[];let a=i.extent;m.hasOwnProperty(n,l)||m.error("Invalid regression method: "+l),null!=a&&"log"===l&&a[0]<=0&&(o.dataflow.warn("Ignoring extent with values <= 0 for log regression."),a=null),r.forEach(r=>{if(r.length<=u)o.dataflow.warn("Skipping regression with more parameters than data points.");else{const t=f(r,i.x,i.y,c);if(i.params)p.push(g.ingest({keys:r.dims,coef:t.coef,rSquared:t.rSquared}));else{const e=a||m.extent(r,i.x),n=e=>{var t={};for(let e=0;e<s.length;++e)t[s[e]]=r.dims[e];t[d[0]]=e[0],t[d[1]]=e[1],p.push(g.ingest(t))};"linear"===l||"constant"===l?e.forEach(e=>n([e,t.predict(e)])):h.sampleCurve(t.predict,e,25,200).forEach(n)}}}),this.value&&(e.rem=this.value),this.value=e.add=e.source=p}return e}}),e.loess=t,e.regression=r}}return qu.exports}var zu,Ku={exports:{}};function Yu(){if(!zu){zu=1;var e=Ku.exports;{var r=su(),n=jo();const s=11102230246251565e-32,R=134217729,I=(3+8*s)*s;function k(e,t,r,n,a){let i,o,s,l,c=t[0],u=n[0],d=0,f=0,p=(u>c==u>-c?(i=c,c=t[++d]):(i=u,u=n[++f]),0);if(d<e&&f<r)for(u>c==u>-c?(o=c+i,s=i-(o-c),c=t[++d]):(o=u+i,s=i-(o-u),u=n[++f]),i=o,0!==s&&(a[p++]=s);d<e&&f<r;)u>c==u>-c?(o=i+c,l=o-i,s=i-(o-l)+(c-l),c=t[++d]):(o=i+u,l=o-i,s=i-(o-l)+(u-l),u=n[++f]),i=o,0!==s&&(a[p++]=s);for(;d<e;)o=i+c,l=o-i,s=i-(o-l)+(c-l),c=t[++d],i=o,0!==s&&(a[p++]=s);for(;f<r;)o=i+u,l=o-i,s=i-(o-l)+(u-l),u=n[++f],i=o,0!==s&&(a[p++]=s);return 0===i&&0!==p||(a[p++]=i),p}function w(t,r){let n=r[0];for(let e=1;e<t;e++)n+=r[e];return n}function a(e){return new Float64Array(e)}const d=(3+16*s)*s,M=(2+12*s)*s,P=(9+64*s)*s*s,N=a(4),D=a(8),x=a(12),L=a(16),G=a(4);function c(e,t,r,n,a,i,o){var s,l,c,u,d,f,p,h,g=e-a,m=r-a,_=t-i,y=n-i,T=g*y,b=R*g,v=b-(b-g),E=g-v,S=_*m,A=(f=E*(l=y-(s=(b=R*y)-(b-y)))-(T-v*s-E*s-v*l))-(c=f-(p=(E=_-(v=(b=R*_)-(b-_)))*(l=m-(s=(b=R*m)-(b-m)))-(S-v*s-E*s-v*l))),O=(N[0]=f-(c+A)+(A-p),A=(d=T-((u=T+c)-(A=u-T))+(c-A))-(c=d-S),N[1]=d-(c+A)+(A-S),A=(h=u+c)-u,N[2]=u-(h-A)+(c-A),N[3]=h,w(4,N)),C=M*o;if(C<=O||C<=-O)return O;if(e=e-(g+(A=e-g))+(A-a),r=r-(m+(A=r-m))+(A-a),a=t-(_+(A=t-_))+(A-i),t=n-(y+(A=n-y))+(A-i),0==e&&0==a&&0==r&&0==t)return O;if((C=P*o+I*Math.abs(O))<=(O+=g*t+y*e-(_*r+m*a))||C<=-O)return O;T=e*y,S=a*m,A=(f=(E=e-(v=(b=R*e)-(b-e)))*(l=y-(s=(b=R*y)-(b-y)))-(T-v*s-E*s-v*l))-(c=f-(p=(E=a-(v=(b=R*a)-(b-a)))*(l=m-(s=(b=R*m)-(b-m)))-(S-v*s-E*s-v*l))),G[0]=f-(c+A)+(A-p),A=(d=T-((u=T+c)-(A=u-T))+(c-A))-(c=d-S),G[1]=d-(c+A)+(A-S),A=(h=u+c)-u,G[2]=u-(h-A)+(c-A),G[3]=h;n=k(4,N,4,G,D),T=g*t,S=_*r,A=(f=(E=g-(v=(b=R*g)-(b-g)))*(l=t-(s=(b=R*t)-(b-t)))-(T-v*s-E*s-v*l))-(c=f-(p=(E=_-(v=(b=R*_)-(b-_)))*(l=r-(s=(b=R*r)-(b-r)))-(S-v*s-E*s-v*l))),G[0]=f-(c+A)+(A-p),A=(d=T-((u=T+c)-(A=u-T))+(c-A))-(c=d-S),G[1]=d-(c+A)+(A-S),A=(h=u+c)-u,G[2]=u-(h-A)+(c-A),G[3]=h,i=k(n,D,4,G,x),T=e*t,S=a*r,A=(f=(E=e-(v=(b=R*e)-(b-e)))*(l=t-(s=(b=R*t)-(b-t)))-(T-v*s-E*s-v*l))-(c=f-(p=(E=a-(v=(b=R*a)-(b-a)))*(l=r-(s=(b=R*r)-(b-r)))-(S-v*s-E*s-v*l))),G[0]=f-(c+A)+(A-p),A=(d=T-((u=T+c)-(A=u-T))+(c-A))-(c=d-S),G[1]=d-(c+A)+(A-S),A=(h=u+c)-u,G[2]=u-(h-A)+(c-A),G[3]=h,o=k(i,x,4,G,L);return L[o-1]}function F(e,t,r,n,a,i){var o=(t-i)*(r-a),s=(e-a)*(n-i),l=o-s;return 0==o||0==s||0<o!=0<s||(o=Math.abs(o+s),Math.abs(l)>=d*o)?l:-c(e,t,r,n,a,i,o)}const V=Math.pow(2,-52),h=new Uint32Array(512);class f{static from(t,r=b,n=v){var a=t.length,i=new Float64Array(2*a);for(let e=0;e<a;e++){var o=t[e];i[2*e]=r(o),i[2*e+1]=n(o)}return new f(i)}constructor(e){var t=e.length>>1;if(0<t&&"number"!=typeof e[0])throw new Error("Expected coords to contain numbers.");this.coords=e;e=Math.max(2*t-5,0);this._triangles=new Uint32Array(3*e),this._halfedges=new Int32Array(3*e),this._hashSize=Math.ceil(Math.sqrt(t)),this._hullPrev=new Uint32Array(t),this._hullNext=new Uint32Array(t),this._hullTri=new Uint32Array(t),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(t),this._dists=new Float64Array(t),this.update()}update(){var{coords:o,_hullPrev:s,_hullNext:l,_hullTri:c,_hullHash:u}=this,n=o.length>>1;let t=1/0,r=1/0,a=-1/0,i=-1/0;for(let e=0;e<n;e++){var d=o[2*e],f=o[2*e+1];d<t&&(t=d),f<r&&(r=f),d>a&&(a=d),f>i&&(i=f),this._ids[e]=e}var p=(t+a)/2,L=(r+i)/2;let h=1/0,g,m,_;for(let e=0;e<n;e++){var y=U(p,L,o[2*e],o[2*e+1]);y<h&&(g=e,h=y)}var T,b,v=o[2*g],E=o[2*g+1];h=1/0;for(let e=0;e<n;e++)e!==g&&((T=U(v,E,o[2*e],o[2*e+1]))<h&&0<T)&&(m=e,h=T);let S=o[2*m],A=o[2*m+1],O=1/0;for(let e=0;e<n;e++)e!==g&&e!==m&&(b=B(v,E,S,A,o[2*e],o[2*e+1]))<O&&(_=e,O=b);let e=o[2*_],C=o[2*_+1];if(O===1/0){for(let e=0;e<n;e++)this._dists[e]=o[2*e]-o[0]||o[2*e+1]-o[1];H(this._ids,this._dists,0,n-1);var k=new Uint32Array(n);let r=0;for(let e=0,t=-1/0;e<n;e++){var w=this._ids[e];this._dists[w]>t&&(k[r++]=w,t=this._dists[w])}this.hull=k.subarray(0,r),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}else{F(v,E,S,A,e,C)<0&&(R=m,I=S,M=A,m=_,S=e,A=C,_=R,e=I,C=M);var R,I,M,P=j(v,E,S,A,e,C);this._cx=P.x,this._cy=P.y;for(let e=0;e<n;e++)this._dists[e]=U(o[2*e],o[2*e+1],P.x,P.y);H(this._ids,this._dists,0,n-1);let i=3;l[this._hullStart=g]=s[_]=m,l[m]=s[g]=_,c[l[_]=s[m]=g]=0,c[m]=1,c[_]=2,u.fill(-1),u[this._hashKey(v,E)]=g,u[this._hashKey(S,A)]=m,u[this._hashKey(e,C)]=_,this.trianglesLen=0,this._addTriangle(g,m,_,-1,-1,-1);for(let e=0,t,r;e<this._ids.length;e++){var N=this._ids[e],D=o[2*N],x=o[2*N+1];if(!(0<e&&Math.abs(D-t)<=V&&Math.abs(x-r)<=V)&&(t=D,r=x,N!==g&&N!==m&&N!==_)){let r=0;for(let e=0,t=this._hashKey(D,x);e<this._hashSize&&(-1===(r=u[(t+e)%this._hashSize])||r===l[r]);e++);let n=r=s[r],a;for(;a=l[n],0<=F(D,x,o[2*n],o[2*n+1],o[2*a],o[2*a+1]);)if((n=a)===r){n=-1;break}if(-1!==n){let e=this._addTriangle(n,N,l[n],-1,-1,c[n]),t=(c[N]=this._legalize(e+2),c[n]=e,i++,l[n]);for(;a=l[t],F(D,x,o[2*t],o[2*t+1],o[2*a],o[2*a+1])<0;)e=this._addTriangle(t,N,a,c[N],-1,c[t]),c[N]=this._legalize(e+2),l[t]=t,i--,t=a;if(n===r)for(;F(D,x,o[2*(a=s[n])],o[2*a+1],o[2*n],o[2*n+1])<0;)e=this._addTriangle(a,N,n,-1,c[n],c[a]),this._legalize(e+2),c[a]=e,l[n]=n,i--,n=a;l[this._hullStart=s[N]=n]=s[t]=N,l[N]=t,u[this._hashKey(D,x)]=N,u[this._hashKey(o[2*n],o[2*n+1])]=n}}}this.hull=new Uint32Array(i);for(let e=0,t=this._hullStart;e<i;e++)t=l[this.hull[e]=t];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}}_hashKey(e,t){return Math.floor(i(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}_legalize(t){var{_triangles:e,_halfedges:r,coords:n}=this;let a=0,i=0;for(;;){var o=r[t],s=t-t%3;if(i=s+(t+2)%3,-1===o){if(0===a)break;t=h[--a]}else{var l=o-o%3,c=l+(o+2)%3,u=e[i],d=e[t],s=e[s+(t+1)%3],f=e[c];if(p(n[2*u],n[2*u+1],n[2*d],n[2*d+1],n[2*s],n[2*s+1],n[2*f],n[2*f+1])){e[t]=f,e[o]=u;d=r[c];if(-1===d){let e=this._hullStart;do{if(this._hullTri[e]===c){this._hullTri[e]=t;break}}while((e=this._hullPrev[e])!==this._hullStart)}this._link(t,d),this._link(o,r[i]),this._link(i,c);s=l+(o+1)%3;a<h.length&&(h[a++]=s)}else{if(0===a)break;t=h[--a]}}}return i}_link(e,t){-1!==(this._halfedges[e]=t)&&(this._halfedges[t]=e)}_addTriangle(e,t,r,n,a,i){var o=this.trianglesLen;return this._triangles[o]=e,this._triangles[o+1]=t,this._triangles[o+2]=r,this._link(o,n),this._link(o+1,a),this._link(o+2,i),this.trianglesLen+=3,o}}function i(e,t){e/=Math.abs(e)+Math.abs(t);return(0<t?3-e:1+e)/4}function U(e,t,r,n){e-=r,r=t-n;return e*e+r*r}function p(e,t,r,n,a,i,o,s){e-=o,t-=s,r-=o,n-=s,a-=o,o=i-s,i=r*r+n*n,s=a*a+o*o;return e*(n*s-i*o)-t*(r*s-i*a)+(e*e+t*t)*(r*o-n*a)<0}function B(e,t,r,n,a,i){var r=r-e,n=n-t,a=a-e,e=i-t,i=r*r+n*n,t=a*a+e*e,o=.5/(r*e-n*a),e=(e*i-n*t)*o,n=(r*t-a*i)*o;return e*e+n*n}function j(e,t,r,n,a,i){var r=r-e,n=n-t,a=a-e,i=i-t,o=r*r+n*n,s=a*a+i*i,l=.5/(r*i-n*a);return{x:e+(i*o-n*s)*l,y:t+(r*s-a*o)*l}}function H(r,n,a,i){if(i-a<=20)for(let t=a+1;t<=i;t++){var o=r[t],s=n[o];let e=t-1;for(;e>=a&&n[r[e]]>s;)r[e+1]=r[e--];r[e+1]=o}else{let e=a+1,t=i;u(r,a+i>>1,e),n[r[a]]>n[r[i]]&&u(r,a,i),n[r[e]]>n[r[i]]&&u(r,e,i),n[r[a]]>n[r[e]]&&u(r,a,e);for(var l=r[e],c=n[l];;){for(;n[r[++e]]<c;);for(;n[r[--t]]>c;);if(t<e)break;u(r,e,t)}r[a+1]=r[t],r[t]=l,i-e+1>=t-a?(H(r,n,e,i),H(r,n,a,t-1)):(H(r,n,a,t-1),H(r,n,e,i))}}function u(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function b(e){return e[0]}function v(e){return e[1]}class m{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,t){this._+=`M${this._x0=this._x1=+e},`+(this._y0=this._y1=+t)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,t){this._+=`L${this._x1=+e},`+(this._y1=+t)}arc(e,t,r){var n=(e=+e)+(r=+r),a=t=+t;if(r<0)throw new Error("negative radius");null===this._x1?this._+=`M${n},`+a:(1e-6<Math.abs(this._x1-n)||1e-6<Math.abs(this._y1-a))&&(this._+="L"+n+","+a),r&&(this._+=`A${r},${r},0,1,1,${e-r},${t}A${r},${r},0,1,1,${this._x1=n},`+(this._y1=a))}rect(e,t,r,n){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${+r}v${+n}h${-r}Z`}value(){return this._||null}}class l{constructor(){this._=[]}moveTo(e,t){this._.push([e,t])}closePath(){this._.push(this._[0].slice())}lineTo(e,t){this._.push([e,t])}value(){return this._.length?this._:null}}let t=class{constructor(e,[t,r,n,a]=[0,0,960,500]){if(!((n=+n)>=(t=+t)&&(a=+a)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(2*e.points.length),this.vectors=new Float64Array(2*e.points.length),this.xmax=n,this.xmin=t,this.ymax=a,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){var{delaunay:{points:i,hull:o,triangles:s},vectors:t}=this;let l,c;var u=this.circumcenters=this._circumcenters.subarray(0,s.length/3*2);for(let e=0,t=0,r=s.length,n,a;e<r;e+=3,t+=2){var d=2*s[e],f=2*s[e+1],p=2*s[e+2];const b=i[d],E=i[1+d];var d=i[f],f=i[1+f],h=i[p],p=i[1+p],d=d-b,f=f-E,g=h-b,m=p-E,_=2*(d*m-f*g);if(Math.abs(_)<1e-9){if(void 0===l){l=c=0;for(const S of o)l+=i[2*S],c+=i[2*S+1];l/=o.length,c/=o.length}var y=1e9*Math.sign((l-b)*m-(c-E)*g);n=(b+h)/2-y*m,a=(E+p)/2+y*g}else{h=1/_,p=d*d+f*f,y=g*g+m*m;n=b+(m*p-f*y)*h,a=E+(d*y-g*p)*h}u[t]=n,u[t+1]=a}var r=o[o.length-1];let n,a=4*r,T,b=i[2*r],v,E=i[2*r+1];t.fill(0);for(let e=0;e<o.length;++e)r=o[e],n=a,T=b,v=E,a=4*r,b=i[2*r],E=i[2*r+1],t[n+2]=t[a]=v-E,t[n+3]=t[a+1]=b-T}render(r){var e=null==r?r=new m:void 0,{delaunay:{halfedges:n,inedges:t,hull:a},circumcenters:i,vectors:o}=this;if(a.length<=1)return null;for(let e=0,t=n.length;e<t;++e){var s,l,c,u=n[e];u<e||(l=2*Math.floor(e/3),u=2*Math.floor(u/3),s=i[l],l=i[1+l],c=i[u],u=i[1+u],this._renderSegment(s,l,c,u,r))}let d,f=a[a.length-1];for(let e=0;e<a.length;++e){d=f,f=a[e];var p=2*Math.floor(t[f]/3),h=i[p],p=i[1+p],g=4*d,g=this._project(h,p,o[2+g],o[3+g]);g&&this._renderSegment(h,p,g[0],g[1],r)}return e&&e.value()}renderBounds(e){var t=null==e?e=new m:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}renderCell(e,r){var n=null==r?r=new m:void 0,a=this._clip(e);if(null!==a&&a.length){r.moveTo(a[0],a[1]);let t=a.length;for(;a[0]===a[t-2]&&a[1]===a[t-1]&&1<t;)t-=2;for(let e=2;e<t;e+=2)a[e]===a[e-2]&&a[e+1]===a[e-1]||r.lineTo(a[e],a[e+1]);return r.closePath(),n&&n.value()}}*cellPolygons(){var{points:r}=this["delaunay"];for(let e=0,t=r.length/2;e<t;++e){var n=this.cellPolygon(e);n&&(n.index=e,yield n)}}cellPolygon(e){var t=new l;return this.renderCell(e,t),t.value()}_renderSegment(e,t,r,n,a){var i=this._regioncode(e,t),o=this._regioncode(r,n);0===i&&0===o?(a.moveTo(e,t),a.lineTo(r,n)):(e=this._clipSegment(e,t,r,n,i,o))&&(a.moveTo(e[0],e[1]),a.lineTo(e[2],e[3]))}contains(e,t,r){return(t=+t)==t&&(r=+r)==r&&this.delaunay._step(e,t,r)===e}*neighbors(e){var a=this._clip(e);if(a)for(const o of this.delaunay.neighbors(e)){var i=this._clip(o);if(i)e:for(let r=0,n=a.length;r<n;r+=2)for(let e=0,t=i.length;e<t;e+=2)if(a[r]===i[e]&&a[r+1]===i[e+1]&&a[(r+2)%n]===i[(e+t-2)%t]&&a[(r+3)%n]===i[(e+t-1)%t]){yield o;break e}}}_cell(e){var{circumcenters:t,delaunay:{inedges:r,halfedges:n,triangles:a}}=this,i=r[e];if(-1===i)return null;var o=[];let s=i;do{var l=Math.floor(s/3);if(o.push(t[2*l],t[2*l+1]),a[s=s%3==2?s-2:s+1]!==e)break}while((s=n[s])!==i&&-1!==s);return o}_clip(e){var t,r,n;return 0===e&&1===this.delaunay.hull.length?[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin]:null===(t=this._cell(e))?null:(r=this["vectors"],this._simplify(r[n=4*e]||r[1+n]?this._clipInfinite(e,t,r[n],r[1+n],r[2+n],r[3+n]):this._clipFinite(e,t)))}_clipFinite(i,t){var r=t.length;let o=null,s,l,c=t[r-2],u=t[r-1],d,f=this._regioncode(c,u),p,h=0;for(let e=0;e<r;e+=2)if(s=c,l=u,c=t[e],u=t[e+1],d=f,f=this._regioncode(c,u),0===d&&0===f)p=h,h=0,o?o.push(c,u):o=[c,u];else{let e,t,r,n,a;if(0===d){if(null===(e=this._clipSegment(s,l,c,u,d,f)))continue;[t,r,n,a]=e}else{if(null===(e=this._clipSegment(c,u,s,l,f,d)))continue;[n,a,t,r]=e,p=h,h=this._edgecode(t,r),p&&h&&this._edge(i,p,h,o,o.length),o?o.push(t,r):o=[t,r]}p=h,h=this._edgecode(n,a),p&&h&&this._edge(i,p,h,o,o.length),o?o.push(n,a):o=[n,a]}if(o)p=h,h=this._edgecode(o[0],o[1]),p&&h&&this._edge(i,p,h,o,o.length);else if(this.contains(i,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return o}_clipSegment(n,a,i,o,s,l){var c=s<l;for(c&&([n,a,i,o,s,l]=[i,o,n,a,l,s]);;){if(0===s&&0===l)return c?[i,o,n,a]:[n,a,i,o];if(s&l)return null;let e,t,r=s||l;8&r?(e=n+(i-n)*(this.ymax-a)/(o-a),t=this.ymax):4&r?(e=n+(i-n)*(this.ymin-a)/(o-a),t=this.ymin):e=2&r?(t=a+(o-a)*(this.xmax-n)/(i-n),this.xmax):(t=a+(o-a)*(this.xmin-n)/(i-n),this.xmin),s?(n=e,a=t,s=this._regioncode(n,a)):(i=e,o=t,l=this._regioncode(i,o))}}_clipInfinite(a,e,t,r,n,i){let o=Array.from(e),s;if((s=this._project(o[0],o[1],t,r))&&o.unshift(s[0],s[1]),(s=this._project(o[o.length-2],o[o.length-1],n,i))&&o.push(s[0],s[1]),o=this._clipFinite(a,o))for(let e=0,t=o.length,r,n=this._edgecode(o[t-2],o[t-1]);e<t;e+=2)r=n,n=this._edgecode(o[e],o[e+1]),r&&n&&(e=this._edge(a,r,n,o,e),t=o.length);else this.contains(a,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(o=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return o}_edge(r,n,e,a,i){for(;n!==e;){let e,t;switch(n){case 5:n=4;continue;case 4:n=6,e=this.xmax,t=this.ymin;break;case 6:n=2;continue;case 2:n=10,e=this.xmax,t=this.ymax;break;case 10:n=8;continue;case 8:n=9,e=this.xmin,t=this.ymax;break;case 9:n=1;continue;case 1:n=5,e=this.xmin,t=this.ymin}a[i]===e&&a[i+1]===t||!this.contains(r,e,t)||(a.splice(i,0,e,t),i+=2)}return i}_project(e,t,r,n){let a=1/0,i,o,s;if(n<0){if(t<=this.ymin)return null;(i=(this.ymin-t)/n)<a&&(s=this.ymin,o=e+(a=i)*r)}else if(0<n){if(t>=this.ymax)return null;(i=(this.ymax-t)/n)<a&&(s=this.ymax,o=e+(a=i)*r)}if(0<r){if(e>=this.xmax)return null;(i=(this.xmax-e)/r)<a&&(o=this.xmax,s=t+(a=i)*n)}else if(r<0){if(e<=this.xmin)return null;(i=(this.xmin-e)/r)<a&&(o=this.xmin,s=t+(a=i)*n)}return[o,s]}_edgecode(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)}_regioncode(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)}_simplify(t){if(t&&4<t.length){for(let e=0;e<t.length;e+=2){var r=(e+2)%t.length,n=(e+4)%t.length;(t[e]===t[r]&&t[r]===t[n]||t[e+1]===t[1+r]&&t[1+r]===t[1+n])&&(t.splice(r,2),e-=2)}t.length||(t=null)}return t}};const g=2*Math.PI,_=Math.pow;function E(e){return e[0]}function S(e){return e[1]}function A(e){var{triangles:t,coords:r}=e;for(let e=0;e<t.length;e+=3){var n=2*t[e],a=2*t[e+1],i=2*t[e+2];if(1e-10<(r[i]-r[n])*(r[1+a]-r[1+n])-(r[a]-r[n])*(r[1+i]-r[1+n]))return}return 1}function O(e,t,r){return[e+Math.sin(e+t)*r,t+Math.cos(e-t)*r]}class y{static from(e,t=E,r=S,n){return new y("length"in e?C(e,t,r,n):Float64Array.from(W(e,t,r,n)))}constructor(e){this._delaunator=new f(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,r=this.points;if(e.hull&&2<e.hull.length&&A(e)){this.collinear=Int32Array.from({length:r.length/2},(e,t)=>t).sort((e,t)=>r[2*e]-r[2*t]||r[2*e+1]-r[2*t+1]);var t=this.collinear[0],n=this.collinear[this.collinear.length-1],t=[r[2*t],r[2*t+1],r[2*n],r[2*n+1]],a=1e-8*Math.hypot(t[3]-t[1],t[2]-t[0]);for(let e=0,t=r.length/2;e<t;++e){var i=O(r[2*e],r[2*e+1],a);r[2*e]=i[0],r[2*e+1]=i[1]}this._delaunator=new f(r)}else delete this.collinear;var o=this.halfedges=this._delaunator.halfedges,s=this.hull=this._delaunator.hull,l=this.triangles=this._delaunator.triangles,c=this.inedges.fill(-1),u=this._hullIndex.fill(-1);for(let e=0,t=o.length;e<t;++e){var d=l[e%3==2?e-2:e+1];-1!==o[e]&&-1!==c[d]||(c[d]=e)}for(let e=0,t=s.length;e<t;++e)u[s[e]]=e;s.length<=2&&0<s.length&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=s[0],c[s[0]]=1,2===s.length)&&(c[s[1]]=0,this.triangles[1]=s[1],this.triangles[2]=s[1])}voronoi(e){return new t(this,e)}*neighbors(r){var e,{inedges:t,hull:n,_hullIndex:a,halfedges:i,triangles:o,collinear:s}=this;if(s)0<(e=s.indexOf(r))&&(yield s[e-1]),e<s.length-1&&(yield s[e+1]);else{var l,c=t[r];if(-1!==c){let e=c,t;do{if(yield t=o[e],o[e=e%3==2?e-2:e+1]!==r)return;if(-1===(e=i[e]))return void((l=n[(a[r]+1)%n.length])!==t&&(yield l))}while(e!==c)}}}find(e,t,r=0){if((e=+e)!=e||(t=+t)!=t)return-1;var n=r;let a;for(;0<=(a=this._step(r,e,t))&&a!==r&&a!==n;)r=a;return a}_step(e,t,r){var{inedges:n,hull:a,_hullIndex:i,halfedges:o,triangles:s,points:l}=this;if(-1===n[e]||!l.length)return(e+1)%(l.length>>1);let c=e,u=_(t-l[2*e],2)+_(r-l[2*e+1],2);var d=n[e];let f=d;do{var p=s[f],h=_(t-l[2*p],2)+_(r-l[2*p+1],2);if(h<u&&(u=h,c=p),s[f=f%3==2?f-2:f+1]!==e)break;if(-1===(f=o[f])){if((f=a[(i[e]+1)%a.length])!==p&&_(t-l[2*f],2)+_(r-l[2*f+1],2)<u)return f;break}}while(f!==d);return c}render(r){var e=null==r?r=new m:void 0,{points:n,halfedges:a,triangles:i}=this;for(let e=0,t=a.length;e<t;++e){var o,s=a[e];s<e||(o=2*i[e],s=2*i[s],r.moveTo(n[o],n[1+o]),r.lineTo(n[s],n[1+s]))}return this.renderHull(r),e&&e.value()}renderPoints(r,n){void 0!==n||r&&"function"==typeof r.moveTo||(n=r,r=null),n=null==n?2:+n;var e=null==r?r=new m:void 0,a=this["points"];for(let e=0,t=a.length;e<t;e+=2){var i=a[e],o=a[e+1];r.moveTo(i+n,o),r.arc(i,o,n,0,g)}return e&&e.value()}renderHull(t){var e=null==t?t=new m:void 0,{hull:r,points:n}=this;const a=2*r[0],i=r.length;t.moveTo(n[a],n[a+1]);for(let e=1;e<i;++e){const a=2*r[e];t.lineTo(n[a],n[1+a])}return t.closePath(),e&&e.value()}hullPolygon(){var e=new l;return this.renderHull(e),e.value()}renderTriangle(e,t){var r=null==t?t=new m:void 0,{points:n,triangles:a}=this,i=2*a[e*=3],o=2*a[e+1],a=2*a[e+2];return t.moveTo(n[i],n[1+i]),t.lineTo(n[o],n[1+o]),t.lineTo(n[a],n[1+a]),t.closePath(),r&&r.value()}*trianglePolygons(){var r=this["triangles"];for(let e=0,t=r.length/3;e<t;++e)yield this.trianglePolygon(e)}trianglePolygon(e){var t=new l;return this.renderTriangle(e,t),t.value()}}function C(t,r,n,a){var i=t.length,o=new Float64Array(2*i);for(let e=0;e<i;++e){var s=t[e];o[2*e]=r.call(a,s,e,t),o[2*e+1]=n.call(a,s,e,t)}return o}function*W(e,t,r,n){let a=0;for(const i of e)yield t.call(n,i,a,e),yield r.call(n,i,a,e),++a}function o(e){r.Transform.call(this,null,e)}o.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const T=[-1e5,-1e5,1e5,1e5];function q(e){var t=e[0][0],r=e[0][1];let n=e.length-1;for(;e[n][0]===t&&e[n][1]===r;--n);return"M"+e.slice(0,n+1).join("L")+"Z"}function $(e){return 2===e.length&&e[0][0]===e[1][0]&&e[0][1]===e[1][1]}n.inherits(o,r.Transform,{transform(e,t){var r=e.as||"path",n=t.source;if(!n||!n.length)return t;let a=e.size;a=a?[0,0,a[0],a[1]]:(a=e.extent)?[a[0][0],a[0][1],a[1][0],a[1][1]]:T;var i=this.value=y.from(n,e.x,e.y).voronoi(a);for(let e=0,t=n.length;e<t;++e){var o=i.cellPolygon(e);n[e][r]=o&&!$(o)?q(o):null}return t.reflow(e.modified()).modifies(r)}}),e.voronoi=o}}return Ku.exports}var Ju,Zu={exports:{}};function Qu(){if(!Ju){Ju=1;var e=Zu.exports;{var y=yu(),t=su(),g=jo(),m=Su(),_=fu(),A=Math.PI/180,O=64,C=2048;function r(){var u,d,f,p,h,g,m,E=[256,256],S=n,_=[],A=Math.random,t={};return t.layout=function(){(e=y.canvas()).width=e.height=1,t=Math.sqrt(e.getContext("2d").getImageData(0,0,1,1).data.length>>2),e.width=(O<<5)/t,e.height=C/t,(e=e.getContext("2d")).fillStyle=e.strokeStyle="red",e.textAlign="center";for(var e,t,r={context:e,ratio:t},n=v((E[0]>>5)*E[1]),a=null,i=_.length,o=-1,s=[],l=_.map(e=>({text:u(e),font:d(e),style:p(e),weight:h(e),rotate:g(e),size:~~(f(e)+1e-14),padding:m(e),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:e})).sort((e,t)=>t.size-e.size);++o<i;){var c=l[o];c.x=E[0]*(A()+.5)>>1,c.y=E[1]*(A()+.5)>>1,T(r,c,l,o),c.hasText&&function(e,t,r){var n,a,i=t.x,o=t.y,s=Math.hypot(E[0],E[1]),l=S(E),c=A()<.5?1:-1,u=-c;for(;(g=l(u+=c))&&(n=~~g[0],a=~~g[1],!(Math.min(Math.abs(n),Math.abs(a))>=s));)if(t.x=i+n,t.y=o+a,!(t.x+t.x0<0||t.y+t.y0<0||t.x+t.x1>E[0]||t.y+t.y1>E[1])&&(!r||!k(t,e,E[0]))&&(!r||w(t,r))){for(var d,f=t.sprite,p=t.width>>5,h=E[0]>>5,g=t.x-(p<<4),m=127&g,_=32-m,y=t.y1-t.y0,T=(t.y+t.y0)*h+(g>>5),b=0;b<y;b++){for(var v=d=0;v<=p;v++)e[T+v]|=d<<_|(v<p?(d=f[b*p+v])>>>m:0);T+=h}return t.sprite=null,1}return}(n,c,a)&&(s.push(c),a?b(a,c):a=[{x:c.x+c.x0,y:c.y+c.y0},{x:c.x+c.x1,y:c.y+c.y1}],c.x-=E[0]>>1,c.y-=E[1]>>1)}return s},t.words=function(e){return arguments.length?(_=e,t):_},t.size=function(e){return arguments.length?(E=[+e[0],+e[1]],t):E},t.font=function(e){return arguments.length?(d=i(e),t):d},t.fontStyle=function(e){return arguments.length?(p=i(e),t):p},t.fontWeight=function(e){return arguments.length?(h=i(e),t):h},t.rotate=function(e){return arguments.length?(g=i(e),t):g},t.text=function(e){return arguments.length?(u=i(e),t):u},t.spiral=function(e){return arguments.length?(S=o[e]||e,t):S},t.fontSize=function(e){return arguments.length?(f=i(e),t):f},t.padding=function(e){return arguments.length?(m=i(e),t):m},t.random=function(e){return arguments.length?(A=e,t):A},t}function T(e,t,r,n){if(!t.sprite){var a,i,o,s,l,c,u,d,f=e.context,p=e.ratio,h=(f.clearRect(0,0,(O<<5)/p,C/p),0),g=0,m=0,_=r.length;for(--n;++n<_;){if(t=r[n],f.save(),f.font=t.style+" "+t.weight+" "+~~((t.size+1)/p)+"px "+t.font,u=f.measureText(t.text+"m").width*p,d=t.size<<1,t.rotate?(c=Math.sin(t.rotate*A),o=u*(l=Math.cos(t.rotate*A)),s=u*c,l=d*l,c=d*c,u=Math.max(Math.abs(o+c),Math.abs(o-c))+31>>5<<5,d=~~Math.max(Math.abs(s+l),Math.abs(s-l))):u=u+31>>5<<5,m<d&&(m=d),O<<5<=h+u&&(g+=m,m=h=0),C<=g+d)break;f.translate((h+(u>>1))/p,(g+(d>>1))/p),t.rotate&&f.rotate(t.rotate*A),f.fillText(t.text,0,0),t.padding&&(f.lineWidth=2*t.padding,f.strokeText(t.text,0,0)),f.restore(),t.width=u,t.height=d,t.xoff=h,t.yoff=g,t.x1=u>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,h+=u}for(var y=f.getImageData(0,0,(O<<5)/p,C/p).data,T=[];0<=--n;)if((t=r[n]).hasText){for(a=(u=t.width)>>5,d=t.y1-t.y0,i=0;i<d*a;i++)T[i]=0;if(null==(h=t.xoff))return;for(var g=t.yoff,b=0,v=-1,E=0;E<d;E++){for(i=0;i<u;i++){var S=y[(g+E)*(O<<5)+(h+i)<<2]?1<<31-i%32:0;T[a*E+(i>>5)]|=S,b|=S}b?v=E:(t.y0++,d--,E--,g++)}t.y1=t.y0+v,t.sprite=T.slice(0,(t.y1-t.y0)*a)}}}function k(e,t,r){for(var n=e.sprite,a=e.width>>5,i=e.x-(a<<4),o=127&i,s=32-o,l=e.y1-e.y0,c=(e.y+e.y0)*(r>>=5)+(i>>5),u=0;u<l;u++){for(var d=0,f=0;f<=a;f++)if((d<<s|(f<a?(d=n[u*a+f])>>>o:0))&t[c+f])return 1;c+=r}}function b(e,t){var r=e[0],e=e[1];t.x+t.x0<r.x&&(r.x=t.x+t.x0),t.y+t.y0<r.y&&(r.y=t.y+t.y0),t.x+t.x1>e.x&&(e.x=t.x+t.x1),t.y+t.y1>e.y&&(e.y=t.y+t.y1)}function w(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function n(e){var t=e[0]/e[1];return function(e){return[t*(e*=.1)*Math.cos(e),e*Math.sin(e)]}}function a(e){var r=4*e[0]/e[1],n=0,a=0;return function(e){var t=e<0?-1:1;switch(Math.sqrt(1+4*t*e)-t&3){case 0:n+=r;break;case 1:a+=4;break;case 2:n-=r;break;default:a-=4}return[n,a]}}function v(e){for(var t=[],r=-1;++r<e;)t[r]=0;return t}function i(e){return"function"==typeof e?e:function(){return e}}var o={archimedean:n,rectangular:a};const E=["x","y","font","fontSize","fontStyle","fontWeight","angle"],S=["text","font","rotate","fontSize","fontStyle","fontWeight"];function s(e){t.Transform.call(this,r(),e)}s.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:E}]},g.inherits(s,t.Transform,{transform(r,n){!r.size||r.size[0]&&r.size[1]||g.error("Wordcloud size dimensions must be non-zero.");var a=r.modified();if(a||n.changed(n.ADD_REM)||S.some(function(e){return e=r[e],g.isFunction(e)&&n.modified(e.fields)})){const u=n.materialize(n.SOURCE).source,d=this.value,f=r.as||E;let e=r.fontSize||14,t;if(g.isFunction(e)?t=r.fontSizeRange:e=g.constant(e),t){const p=e,h=m.scale("sqrt")().domain(g.extent(u,p)).range(t);e=e=>h(p(e))}u.forEach(e=>{e[f[0]]=NaN,e[f[1]]=NaN,e[f[3]]=0});var i=d.words(u).text(r.text).size(r.size||[500,500]).padding(r.padding||1).spiral(r.spiral||"archimedean").rotate(r.rotate||0).font(r.font||"sans-serif").fontStyle(r.fontStyle||"normal").fontWeight(r.fontWeight||"normal").fontSize(e).random(_.random).layout(),o=d.size(),s=o[0]>>1,l=o[1]>>1,c=i.length;for(let e=0,t,r;e<c;++e)t=i[e],(r=t.datum)[f[0]]=t.x+s,r[f[1]]=t.y+l,r[f[2]]=t.font,r[f[3]]=t.size,r[f[4]]=t.style,r[f[5]]=t.weight,r[f[6]]=t.rotate;return n.reflow(a).modifies(f)}}}),e.wordcloud=s}}return Zu.exports}var Xu,ed={exports:{}};function td(){if(!Xu){Xu=1;var e=ed.exports;{var t=su(),r=jo();const _=e=>new Uint8Array(e),y=e=>new Uint16Array(e),T=e=>new Uint32Array(e);function n(){let r=8,l=[],e=T(0),c=i(0,r),u=i(0,r);return{data:()=>l,seen:()=>e=a(e,l.length),add(a){for(let e=0,t=l.length,r=a.length,n;e<r;++e)(n=a[e])._index=t++,l.push(n)},remove(e,t){var r=l.length,n=Array(r-e),a=l;let i,o,s;for(o=0;!t[o]&&o<r;++o)n[o]=l[o],a[o]=o;for(s=o;o<r;++o)i=l[o],t[o]?a[o]=-1:(a[o]=s,c[s]=c[o],u[s]=u[o],(n[s]=i)._index=s++),c[o]=0;return l=n,a},size:()=>l.length,curr:()=>c,prev:()=>u,reset:e=>u[e]=c[e],all:()=>r<257?255:r<65537?65535:4294967295,set(e,t){c[e]|=t},clear(e,t){c[e]&=~t},resize(e,t){(c.length<e||t>r)&&(r=Math.max(t,r),c=i(e,r,c),u=i(e,r))}}}function a(e,t,r){return e.length>=t?e:((r=r||new e.constructor(t)).set(e),r)}function i(e,t,r){t=(t<257?_:t<65537?y:T)(e);return r&&t.set(r),t}function A(e,t,r){const s=1<<t;return{one:s,zero:~s,range:r.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(e,t){var r=this.bisect(this.range,e.value),n=e.index,a=r[0],e=r[1],i=n.length;let o;for(o=0;o<a;++o)t[n[o]]|=s;for(o=e;o<i;++o)t[n[o]]|=s;return this}}}function l(e,t){return null==e||null==t?NaN:e<t?-1:t<e?1:t<=e?0:NaN}function c(e,t){return null==e||null==t?NaN:t<e?-1:e<t?1:e<=t?0:NaN}function o(r){let i,o,a;function s(e,t,r=0,n=e.length){if(r<n){if(0!==i(t,t))return n;do{var a=r+n>>>1;o(e[a],t)<0?r=1+a:n=a}while(r<n)}return r}return a=2!==r.length?(i=l,o=(e,t)=>l(r(e),t),(e,t)=>r(e)-t):(i=r===l||r===c?r:u,o=r),{left:s,center:function(e,t,r=0,n=e.length){return n=s(e,t,r,n-1),r<n&&a(e[n-1],t)>-a(e[n],t)?n-1:n},right:function(e,t,r=0,n=e.length){if(r<n){if(0!==i(t,t))return n;do{var a=r+n>>>1;o(e[a],t)<=0?r=1+a:n=a}while(r<n)}return r}}}function u(){return 0}function s(e){return null===e?NaN:+e}var d=o(l);const b=d.right,v=d.left;function f(t,e){return Array.from(e,e=>t[e])}function O(){let u=T(0),d=[],f=0;return{insert:function(e,t,r){if(!t.length)return[];var n=f,a=t.length,i=T(a);let o=Array(a),s,l,c;for(c=0;c<a;++c)o[c]=e(t[c]),i[c]=c;if(o=p(o,i),n)s=d,l=u,d=Array(n+a),u=T(n+a),h(r,s,l,n,o,i,a,d,u);else{if(0<r)for(c=0;c<a;++c)i[c]+=r;d=o,u=i}return f=n+a,{index:i,value:o}},remove:function(e,t){var r=f;let n,a,i;for(a=0;!t[u[a]]&&a<r;++a);for(i=a;a<r;++a)t[n=u[a]]||(u[i]=n,d[i]=d[a],++i);f=r-e},bisect:function(e,t){let r;return r=t?t.length:(t=d,f),[v(t,e[0],0,r),b(t,e[1],0,r)]},reindex:function(r){for(let e=0,t=f;e<t;++e)u[e]=r[u[e]]},index:()=>u,size:()=>f}}function p(r,e){return r.sort.call(e,(e,t)=>{e=r[e],t=r[t];return e<t?-1:t<e?1:0}),f(r,e)}function h(e,t,r,n,a,i,o,s,l){let c=0,u=0,d;for(d=0;c<n&&u<o;++d)t[c]<a[u]?(s[d]=t[c],l[d]=r[c++]):(s[d]=a[u],l[d]=i[u++]+e);for(;c<n;++c,++d)s[d]=t[c],l[d]=r[c];for(;u<o;++u,++d)s[d]=a[u],l[d]=i[u]+e}function g(e){t.Transform.call(this,n(),e),this._indices=null,this._dims=null}function m(e){t.Transform.call(this,null,e)}o(s).center,g.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},r.inherits(g,t.Transform,{transform(e,t){return this._dims?e.modified("fields")||e.fields.some(e=>t.modified(e.fields))?this.reinit(e,t):this.eval(e,t):this.init(e,t)},init(e,t){var r=e.fields,n=e.query,a=this._indices={},i=this._dims=[],o=n.length;let s=0,l,c;for(;s<o;++s)c=a[l=r[s].fname]||(a[l]=O()),i.push(A(c,s,n[s]));return this.eval(e,t)},reinit(e,t){var r=t.materialize().fork(),n=e.fields,a=e.query,i=this._indices,o=this._dims,s=this.value,l=s.curr(),c=s.prev(),u=s.all(),d=r.rem=r.add,f=r.mod,p=a.length,h={};let g,m,_,y,T,b,v,E,S;if(c.set(l),t.rem.length&&(T=this.remove(e,t,r)),t.add.length&&s.add(t.add),t.mod.length)for(b={},y=t.mod,v=0,E=y.length;v<E;++v)b[y[v]._index]=1;for(v=0;v<p;++v)S=n[v],o[v]&&!e.modified("fields",v)&&!t.modified(S.fields)||(_=S.fname,(g=h[_])||(i[_]=m=O(),h[_]=g=m.insert(S,t.source,0)),o[v]=A(m,v,a[v]).onAdd(g,l));for(v=0,E=s.data().length;v<E;++v){if(T[v])continue;c[v]!==l[v]?d.push(v):b[v]&&l[v]!==u&&f.push(v)}return s.mask=(1<<p)-1,r},eval(e,t){var r=t.materialize().fork(),n=this._dims.length;let a=0;return t.rem.length&&(this.remove(e,t,r),a|=(1<<n)-1),e.modified("query")&&!e.modified("fields")&&(a|=this.update(e,t,r)),t.add.length&&(this.insert(e,t,r),a|=(1<<n)-1),t.mod.length&&(this.modify(t,r),a|=(1<<n)-1),this.value.mask=a,r},insert(e,t,r){var n=t.add,t=this.value,a=this._dims,i=this._indices,o=e.fields,s={},l=r.add,c=t.size()+n.length,u=a.length;let d=t.size(),f,p,h;t.resize(c,u),t.add(n);var g=t.curr(),m=t.prev(),_=t.all();for(f=0;f<u;++f)h=s[p=o[f].fname]||(s[p]=i[p].insert(o[f],n,d)),a[f].onAdd(h,g);for(;d<c;++d)m[d]=_,g[d]!==_&&l.push(d)},modify(e,t){var r=t.mod,t=this.value,n=t.curr(),a=t.all(),i=e.mod;let o,s,l;for(o=0,s=i.length;o<s;++o)n[l=i[o]._index]!==a&&r.push(l)},remove(e,t,r){var n=this._indices,a=this.value,i=a.curr(),o=a.prev(),s=a.all(),l={},c=r.rem,u=t.rem;let d,f,p,h;for(d=0,f=u.length;d<f;++d)l[p=u[d]._index]=1,o[p]=h=i[p],h!==(i[p]=s)&&c.push(p);for(p in n)n[p].remove(f,l);return this.reindex(t,f,l),l},reindex(e,r,n){const a=this._indices,i=this.value;e.runAfter(()=>{var e=i.remove(r,n);for(const t in a)a[t].reindex(e)})},update(e,t,r){var n=this._dims,a=e.query,i=t.stamp,o=n.length;let s=0,l,c;for(r.filters=0,c=0;c<o;++c)e.modified("query",c)&&(l=c,++s);if(1===s)s=n[l].one,this.incrementOne(n[l],a[l],r.add,r.rem);else for(c=0,s=0;c<o;++c)e.modified("query",c)&&(s|=n[c].one,this.incrementAll(n[c],a[c],i,r.add),r.rem=r.add);return s},incrementAll(e,t,r,n){var a=this.value,i=a.seen(),o=a.curr(),s=a.prev(),l=e.index(),a=e.bisect(e.range),c=e.bisect(t),u=c[0],c=c[1],d=a[0],a=a[1],f=e.one;let p,h,g;if(u<d)for(p=u,h=Math.min(d,c);p<h;++p)i[g=l[p]]!==r&&(s[g]=o[g],i[g]=r,n.push(g)),o[g]^=f;else if(d<u)for(p=d,h=Math.min(u,a);p<h;++p)i[g=l[p]]!==r&&(s[g]=o[g],i[g]=r,n.push(g)),o[g]^=f;if(a<c)for(p=Math.max(u,a),h=c;p<h;++p)i[g=l[p]]!==r&&(s[g]=o[g],i[g]=r,n.push(g)),o[g]^=f;else if(c<a)for(p=Math.max(d,c),h=a;p<h;++p)i[g=l[p]]!==r&&(s[g]=o[g],i[g]=r,n.push(g)),o[g]^=f;e.range=t.slice()},incrementOne(e,t,r,n){var a=this.value.curr(),i=e.index(),o=e.bisect(e.range),s=e.bisect(t),l=s[0],s=s[1],c=o[0],o=o[1],u=e.one;let d,f,p;if(l<c)for(d=l,f=Math.min(c,s);d<f;++d)a[p=i[d]]^=u,r.push(p);else if(c<l)for(d=c,f=Math.min(l,o);d<f;++d)a[p=i[d]]^=u,n.push(p);if(o<s)for(d=Math.max(l,o),f=s;d<f;++d)a[p=i[d]]^=u,r.push(p);else if(s<o)for(d=Math.max(c,s),f=o;d<f;++d)a[p=i[d]]^=u,n.push(p);e.range=t.slice()}}),m.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},r.inherits(m,t.Transform,{transform(e,t){const r=~(e.ignore||0),n=e.filter,a=n.mask;if(0==(a&r))return t.StopPropagation;const i=t.fork(t.ALL),o=n.data(),s=n.curr(),l=n.prev(),c=e=>s[e]&r?null:o[e];return i.filter(i.MOD,c),a&a-1?(i.filter(i.ADD,e=>{var t=s[e]&r;return!t&&t^l[e]&r?o[e]:null}),i.filter(i.REM,e=>{var t=s[e]&r;return t&&!(t^(t^l[e]&r))?o[e]:null})):(i.filter(i.ADD,c),i.filter(i.REM,e=>(s[e]&r)===a?o[e]:null)),i.filter(i.SOURCE,e=>c(e._index))}}),e.crossfilter=g,e.resolvefilter=m}}return ed.exports}var rd,nd={exports:{}},ad={exports:{}},id={exports:{}};function od(){if(!rd){rd=1;var e=id.exports;{var h=jo();const D="RawCode",x="Literal",Pe="Property",Ne="Identifier",De="ArrayExpression",xe="BinaryExpression",Le="CallExpression",Fe="ConditionalExpression",Ue="LogicalExpression",Be="MemberExpression",je="ObjectExpression",He="UnaryExpression";function a(e){this.type=e}function L(e){switch(e.type){case De:return e.elements;case xe:case Ue:return[e.left,e.right];case Le:return[e.callee].concat(e.arguments);case Fe:return[e.test,e.consequent,e.alternate];case Be:return[e.object,e.property];case je:return e.properties;case Pe:return[e.key,e.value];case He:return[e.argument];case Ne:case x:case D:default:return[]}}a.prototype.visit=function(e){let t,r,n;if(e(this))return 1;for(t=L(this),r=0,n=t.length;r<n;++r)if(t[r].visit(e))return 1};var o,s,l,u,r=2,i=7,F="ConditionalExpression",U="Identifier",c="Unexpected token %0",n="Invalid regular expression",d="Invalid regular expression: missing /",B="Octal literals are not allowed in strict mode.",f="ILLEGAL",p="Disabled.",j=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),H=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function g(e,t){if(!e)throw new Error("ASSERT: "+t)}function m(e){return 48<=e&&e<=57}function _(e){return"0123456789abcdefABCDEF".includes(e)}function y(e){return"01234567".includes(e)}function G(e){return 32===e||9===e||11===e||12===e||160===e||5760<=e&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].includes(e)}function T(e){return 10===e||13===e||8232===e||8233===e}function b(e){return 36===e||95===e||65<=e&&e<=90||97<=e&&e<=122||92===e||128<=e&&j.test(String.fromCharCode(e))}function v(e){return 36===e||95===e||65<=e&&e<=90||97<=e&&e<=122||48<=e&&e<=57||92===e||128<=e&&H.test(String.fromCharCode(e))}const Ge={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function V(){for(;s<l;){var e=o.charCodeAt(s);if(!G(e)&&!T(e))break;++s}}function E(e){for(var t,r=0,n="u"===e?4:2,a=0;a<n;++a)s<l&&_(o[s])?(t=o[s++],r=16*r+"0123456789abcdef".indexOf(t.toLowerCase())):C({},c,f);return String.fromCharCode(r)}function W(){var e=o[s],t=0;for("}"===e&&C({},c,f);s<l&&_(e=o[s++]);)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(1114111<t||"}"!==e)&&C({},c,f),t<=65535?String.fromCharCode(t):String.fromCharCode(55296+(t-65536>>10),56320+(t-65536&1023))}function q(){var e=o.charCodeAt(s++),t=String.fromCharCode(e);for(92===e&&(117!==o.charCodeAt(s)&&C({},c,f),++s,(e=E("u"))&&"\\"!==e&&b(e.charCodeAt(0))||C({},c,f),t=e);s<l&&v(e=o.charCodeAt(s));)++s,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==o.charCodeAt(s)&&C({},c,f),++s,(e=E("u"))&&"\\"!==e&&v(e.charCodeAt(0))||C({},c,f),t+=e);return t}function $(){for(var e,t=s++;s<l;){if(92===(e=o.charCodeAt(s)))return s=t,q();if(!v(e))break;++s}return o.slice(t,s)}function z(){var e=s,t=(92===o.charCodeAt(s)?q:$)(),r=1===t.length?3:Ge.hasOwnProperty(t)?4:"null"===t?5:"true"===t||"false"===t?1:3;return{type:r,value:t,start:e,end:s}}function t(){var e,t,r=s,n=o.charCodeAt(s),a=o[s];switch(n){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++s,{type:i,value:String.fromCharCode(n),start:r,end:s};default:if(61===(e=o.charCodeAt(s+1)))switch(n){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return s+=2,{type:i,value:String.fromCharCode(n)+String.fromCharCode(e),start:r,end:s};case 33:case 61:return s+=2,61===o.charCodeAt(s)&&++s,{type:i,value:o.slice(r,s),start:r,end:s}}}return">>>="===(t=o.substr(s,4))?{type:i,value:t,start:r,end:s+=4}:">>>"===(t=t.substr(0,3))||"<<="===t||">>="===t?{type:i,value:t,start:r,end:s+=3}:a===(t=t.substr(0,2))[1]&&"+-<>&|".includes(a)||"=>"===t?{type:i,value:t,start:r,end:s+=2}:("//"===t&&C({},c,f),"<>=!+-*%&|^/".includes(a)?{type:i,value:a,start:r,end:++s}:void C({},c,f))}function K(e){let t="";for(;s<l&&_(o[s]);)t+=o[s++];return 0===t.length&&C({},c,f),b(o.charCodeAt(s))&&C({},c,f),{type:6,value:parseInt("0x"+t,16),start:e,end:s}}function Y(e){let t="0"+o[s++];for(;s<l&&y(o[s]);)t+=o[s++];return(b(o.charCodeAt(s))||m(o.charCodeAt(s)))&&C({},c,f),{type:6,value:parseInt(t,8),octal:!0,start:e,end:s}}function J(){var e,t,r=o[s];if(g(m(r.charCodeAt(0))||"."===r,"Numeric literal must start with a decimal digit or a decimal point"),t=s,e="","."!==r){if(e=o[s++],r=o[s],"0"===e){if("x"===r||"X"===r)return++s,K(t);if(y(r))return Y(t);r&&m(r.charCodeAt(0))&&C({},c,f)}for(;m(o.charCodeAt(s));)e+=o[s++];r=o[s]}if("."===r){for(e+=o[s++];m(o.charCodeAt(s));)e+=o[s++];r=o[s]}if("e"===r||"E"===r)if(e+=o[s++],"+"!==(r=o[s])&&"-"!==r||(e+=o[s++]),m(o.charCodeAt(s)))for(;m(o.charCodeAt(s));)e+=o[s++];else C({},c,f);return b(o.charCodeAt(s))&&C({},c,f),{type:6,value:parseFloat(e),start:t,end:s}}function Z(){var e,t,r,n="",a=!1,i=o[s];for(g("'"===i||'"'===i,"String literal must starts with a quote"),e=s,++s;s<l;){if((t=o[s++])===i){i="";break}if("\\"===t)if((t=o[s++])&&T(t.charCodeAt(0)))"\r"===t&&"\n"===o[s]&&++s;else switch(t){case"u":case"x":"{"===o[s]?(++s,n+=W()):n+=E(t);break;case"n":n+="\n";break;case"r":n+="\r";break;case"t":n+="\t";break;case"b":n+="\b";break;case"f":n+="\f";break;case"v":n+="\v";break;default:y(t)?(0!==(r="01234567".indexOf(t))&&(a=!0),s<l&&y(o[s])&&(a=!0,r=8*r+"01234567".indexOf(o[s++]),"0123".includes(t))&&s<l&&y(o[s])&&(r=8*r+"01234567".indexOf(o[s++])),n+=String.fromCharCode(r)):n+=t}else{if(T(t.charCodeAt(0)))break;n+=t}}return""!==i&&C({},c,f),{type:8,value:n,octal:a,start:e,end:s}}function Q(e,t){let r=e;t.includes("u")&&(r=r.replace(/\\u\{([0-9a-fA-F]+)\}/g,(e,t)=>{if(parseInt(t,16)<=1114111)return"x";C({},n)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(r)}catch(e){C({},n)}try{return new RegExp(e,t)}catch(e){return null}}function X(){var e,t,r,n=o[s];for(g("/"===n,"Regular expression literal must start with a slash"),e=o[s++],r=t=!1;s<l;)if(e+=n=o[s++],"\\"===n)T((n=o[s++]).charCodeAt(0))&&C({},d),e+=n;else if(T(n.charCodeAt(0)))C({},d);else if(t)"]"===n&&(t=!1);else{if("/"===n){r=!0;break}"["===n&&(t=!0)}return r||C({},d),{value:e.substr(1,e.length-2),literal:e}}function ee(){for(var e,t="",r="";s<l&&v((e=o[s]).charCodeAt(0));)++s,"\\"===e&&s<l?C({},c,f):(r+=e,t+=e);return 0<=r.search(/[^gimuy]/g)&&C({},n,r),{value:r,literal:t}}function te(){var e,t,r,n;return u=null,V(),e=s,t=X(),r=ee(),n=Q(t.value,r.value),{literal:t.literal+r.literal,value:n,regex:{pattern:t.value,flags:r.value},start:e,end:s}}function re(e){return 3===e.type||4===e.type||1===e.type||5===e.type}function ne(){var e;return V(),l<=s?{type:r,start:s,end:s}:(b(e=o.charCodeAt(s))?z:40===e||41===e||59===e?t:39===e||34===e?Z:46===e?m(o.charCodeAt(s+1))?J:t:m(e)?J:t)()}function S(){var e=u;return s=e.end,u=ne(),s=e.end,e}function ae(){var e=s;u=ne(),s=e}function ie(e){var t=new a("ArrayExpression");return t.elements=e,t}function oe(e,t,r){var n=new a("||"===e||"&&"===e?"LogicalExpression":"BinaryExpression");return n.operator=e,n.left=t,n.right=r,n}function se(e,t){var r=new a("CallExpression");return r.callee=e,r.arguments=t,r}function le(e,t,r){var n=new a(F);return n.test=e,n.consequent=t,n.alternate=r,n}function A(e){var t=new a(U);return t.name=e,t}function O(e){var t=new a("Literal");return t.value=e.value,t.raw=o.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function ce(e,t,r){var n=new a("MemberExpression");return n.computed="["===e,n.object=t,n.property=r,n.computed||(r.member=!0),n}function ue(e){var t=new a("ObjectExpression");return t.properties=e,t}function de(e,t,r){var n=new a("Property");return n.key=t,n.value=r,n.kind=e,n}function fe(e,t){var r=new a("UnaryExpression");return r.operator=e,r.argument=t,r.prefix=!0,r}function C(e,t){var r=Array.prototype.slice.call(arguments,2),t=t.replace(/%(\d)/g,(e,t)=>(g(t<r.length,"Message reference must be in range"),r[t])),n=new Error(t);throw n.index=s,n.description=t,n}function k(e){e.type===r&&C(e,"Unexpected end of input"),6===e.type&&C(e,"Unexpected number"),8===e.type&&C(e,"Unexpected string"),3===e.type&&C(e,"Unexpected identifier"),4===e.type&&C(e,"Unexpected reserved word"),C(e,c,e.value)}function w(e){var t=S();t.type===i&&t.value===e||k(t)}function R(e){return u.type===i&&u.value===e}function I(e){return 4===u.type&&u.value===e}function pe(){var e=[];for(s=u.start,w("[");!R("]");)R(",")?(S(),e.push(null)):(e.push(P()),R("]")||w(","));return S(),ie(e)}function he(){s=u.start;var e=S();return 8===e.type||6===e.type?(e.octal&&C(e,B),O(e)):A(e.value)}function ge(){var e,t;return s=u.start,3===(e=u).type||e.type!==r&&e.type!==i?(t=he(),w(":"),de("init",t,P())):void k(e)}function me(){var e,t,r=[],n={},a=String;for(s=u.start,w("{");!R("}");)t="$"+((e=ge()).key.type===U?e.key.name:a(e.key.value)),Object.prototype.hasOwnProperty.call(n,t)?C({},"Duplicate data property in object literal not allowed in strict mode"):n[t]=!0,r.push(e),R("}")||w(",");return w("}"),ue(r)}function _e(){w("(");var e=N();return w(")"),e}const Ve={if:1};function ye(){var e,t,r;if(R("("))return _e();if(R("["))return pe();if(R("{"))return me();if(e=u.type,s=u.start,3===e||Ve[u.value])r=A(S().value);else if(8===e||6===e)u.octal&&C(u,B),r=O(S());else{if(4===e)throw new Error(p);1===e?((t=S()).value="true"===t.value,r=O(t)):5===e?((t=S()).value=null,r=O(t)):R("/")||R("/=")?(r=O(te()),ae()):k(S())}return r}function Te(){var e=[];if(w("("),!R(")"))for(;s<l&&(e.push(P()),!R(")"));)w(",");return w(")"),e}function be(){s=u.start;var e=S();return re(e)||k(e),A(e.value)}function ve(){return w("."),be()}function Ee(){w("[");var e=N();return w("]"),e}function Se(){for(var e=ye();;)if(R("."))e=ce(".",e,ve());else if(R("("))e=se(e,Te());else{if(!R("["))break;e=ce("[",e,Ee())}return e}function Ae(){var e=Se();if(u.type===i&&(R("++")||R("--")))throw new Error(p);return e}function M(){var e,t;if(u.type!==i&&4!==u.type)t=Ae();else{if(R("++")||R("--"))throw new Error(p);if(R("+")||R("-")||R("~")||R("!"))e=S(),t=M(),t=fe(e.value,t);else{if(I("delete")||I("void")||I("typeof"))throw new Error(p);t=Ae()}}return t}function Oe(e){let t=0;if(e.type!==i&&4!==e.type)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11}return t}function Ce(){var e,t,r,n,a,i,o=u,s=M(),l=u,c=Oe(l);if(0===c)return s;for(l.prec=c,S(),e=[o,u],r=[s,l,M()];0<(c=Oe(u));){for(;2<r.length&&c<=r[r.length-2].prec;)n=r.pop(),a=r.pop().value,s=r.pop(),e.pop(),t=oe(a,s,n),r.push(t);(l=S()).prec=c,r.push(l),e.push(u),t=M(),r.push(t)}for(t=r[i=r.length-1],e.pop();1<i;)e.pop(),t=oe(r[i-1].value,r[i-2],t),i-=2;return t}function P(){var e,t=Ce();return R("?")&&(S(),e=P(),w(":"),t=le(t,e,P())),t}function N(){var e=P();if(R(","))throw new Error(p);return e}function ke(e){s=0,l=(o=e).length,u=null,ae();e=N();if(u.type!==r)throw new Error("Unexpect token after expression.");return e}var we={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function Re(l){function e(i,o,s){return t=>{{var r=i,n=o,a=s;let e=l(t[0]);return(e=n&&(e=n+"("+e+")",0===n.lastIndexOf("new ",0))?"("+e+")":e)+"."+r+(a<0?"":0===a?"()":"("+t.slice(1).map(l).join(",")+")")}}}var t="new Date",r="String";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(e){e.length<3&&h.error("Missing arguments to clamp function."),3<e.length&&h.error("Too many arguments to clamp function.");e=e.map(l);return"Math.max("+e[1]+", Math.min("+e[2]+","+e[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:t,date:e("getDate",t,0),day:e("getDay",t,0),year:e("getFullYear",t,0),month:e("getMonth",t,0),hours:e("getHours",t,0),minutes:e("getMinutes",t,0),seconds:e("getSeconds",t,0),milliseconds:e("getMilliseconds",t,0),time:e("getTime",t,0),timezoneoffset:e("getTimezoneOffset",t,0),utcdate:e("getUTCDate",t,0),utcday:e("getUTCDay",t,0),utcyear:e("getUTCFullYear",t,0),utcmonth:e("getUTCMonth",t,0),utchours:e("getUTCHours",t,0),utcminutes:e("getUTCMinutes",t,0),utcseconds:e("getUTCSeconds",t,0),utcmilliseconds:e("getUTCMilliseconds",t,0),length:e("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:e("toUpperCase",r,0),lower:e("toLowerCase",r,0),substring:e("substring",r),split:e("split",r),trim:e("trim",r,0),regexp:"RegExp",test:e("test","RegExp"),if:function(e){e.length<3&&h.error("Missing arguments to if function."),3<e.length&&h.error("Too many arguments to if function.");e=e.map(l);return"("+e[0]+"?"+e[1]+":"+e[2]+")"}}}function Ie(e){var t=e&&e.length-1;return t&&('"'===e[0]&&'"'===e[t]||"'"===e[0]&&"'"===e[t])?e.slice(1,-1):e}function Me(e){const t=(e=e||{}).allowed?h.toSet(e.allowed):{},r=e.forbidden?h.toSet(e.forbidden):{},n=e.constants||we,a=(e.functions||Re)(d),i=e.globalvar,o=e.fieldvar,s=h.isFunction(i)?i:e=>i+`["${e}"]`;let l={},c={},u=0;function d(e){var t;return h.isString(e)?e:(null==(t=f[e.type])&&h.error("Unsupported type: "+e.type),t(e))}const f={Literal:e=>e.raw,Identifier:e=>{e=e.name;return 0<u?e:h.hasOwnProperty(r,e)?h.error("Illegal identifier: "+e):h.hasOwnProperty(n,e)?n[e]:h.hasOwnProperty(t,e)?e:(l[e]=1,s(e))},MemberExpression:e=>{var t=!e.computed,r=d(e.object),e=(t&&(u+=1),d(e.property));return r===o&&(c[Ie(e)]=1),t&&--u,r+(t?"."+e:"["+e+"]")},CallExpression:e=>{"Identifier"!==e.callee.type&&h.error("Illegal callee type: "+e.callee.type);var t=e.callee.name,e=e.arguments,r=h.hasOwnProperty(a,t)&&a[t];return r||h.error("Unrecognized function: "+t),h.isFunction(r)?r(e):r+"("+e.map(d).join(",")+")"},ArrayExpression:e=>"["+e.elements.map(d).join(",")+"]",BinaryExpression:e=>"("+d(e.left)+" "+e.operator+" "+d(e.right)+")",UnaryExpression:e=>"("+e.operator+d(e.argument)+")",ConditionalExpression:e=>"("+d(e.test)+"?"+d(e.consequent)+":"+d(e.alternate)+")",LogicalExpression:e=>"("+d(e.left)+e.operator+d(e.right)+")",ObjectExpression:e=>"{"+e.properties.map(d).join(",")+"}",Property:e=>{u+=1;var t=d(e.key);return--u,t+":"+d(e.value)}};function p(e){e={code:d(e),globals:Object.keys(l),fields:Object.keys(c)};return l={},c={},e}return p.functions=a,p.constants=n,p}e.ASTNode=a,e.ArrayExpression=De,e.BinaryExpression=xe,e.CallExpression=Le,e.ConditionalExpression=Fe,e.Identifier=Ne,e.Literal=x,e.LogicalExpression=Ue,e.MemberExpression=Be,e.ObjectExpression=je,e.Property=Pe,e.RawCode=D,e.UnaryExpression=He,e.codegenExpression=Me,e.constants=we,e.functions=Re,e.parseExpression=ke}}return id.exports}var sd,ld,cd={exports:{}};function ud(){if(!sd){sd=1;var e=cd.exports;{var b=jo(),s=od();function n(e,t){return null==e||null==t?NaN:e<t?-1:t<e?1:t<=e?0:NaN}function t(e,t){return null==e||null==t?NaN:t<e?-1:e<t?1:e<=t?0:NaN}function r(r){let i,o,a;function s(e,t,r=0,n=e.length){if(r<n){if(0!==i(t,t))return n;do{var a=r+n>>>1;o(e[a],t)<0?r=1+a:n=a}while(r<n)}return r}return a=2!==r.length?(i=n,o=(e,t)=>n(r(e),t),(e,t)=>r(e)-t):(i=r===n||r===t?r:l,o=r),{left:s,center:function(e,t,r=0,n=e.length){return n=s(e,t,r,n-1),r<n&&a(e[n-1],t)>-a(e[n],t)?n-1:n},right:function(e,t,r=0,n=e.length){if(r<n){if(0!==i(t,t))return n;do{var a=r+n>>>1;o(e[a],t)<=0?r=1+a:n=a}while(r<n)}return r}}}function l(){return 0}class f extends Set{constructor(e,t=c){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const r of e)this.add(r)}has(e){return super.has(a(this,e))}add(e){return super.add(i(this,e))}delete(e){return super.delete(o(this,e))}}function a({_intern:e,_key:t},r){t=t(r);return e.has(t)?e.get(t):r}function i({_intern:e,_key:t},r){t=t(r);return e.has(t)?e.get(t):(e.set(t,r),r)}function o({_intern:e,_key:t},r){t=t(r);return e.has(t)&&(r=e.get(t),e.delete(t)),r}function c(e){return null!==e&&"object"==typeof e?e.valueOf():e}function u(e,...t){e=new f(e),t=t.map(L);e:for(const r of e)for(const n of t)if(!n.has(r)){e.delete(r);continue e}return e}function L(e){return e instanceof f?e:new f(e)}function F(...e){var t=new f;for(const r of e)for(const n of r)t.add(n);return t}const h=Symbol("vega_selection_getter");function d(e){return e.getter&&e.getter[h]||(e.getter=b.field(e.field),e.getter[h]=!0),e.getter}const g="intersect",E="union",S="vlMulti",A="vlPoint",O="or",C="and",k="_vgsid_",w=b.field(k),m="E",_="R",y="R-E",T="R-LE",R="R-RE",I="index:unit";function p(e,t){for(var r,n,a=t.fields,i=t.values,o=a.length,s=0;s<o;++s)if(r=d(n=a[s])(e),b.isDate(r)&&(r=b.toNumber(r)),b.isDate(i[s])&&(i[s]=b.toNumber(i[s])),b.isArray(i[s])&&b.isDate(i[s][0])&&(i[s]=i[s].map(b.toNumber)),n.type===m){if(b.isArray(i[s])?i[s].indexOf(r)<0:r!==i[s])return!1}else if(n.type===_){if(!b.inrange(r,i[s]))return!1}else if(n.type===R){if(!b.inrange(r,i[s],!0,!1))return!1}else if(n.type===y){if(!b.inrange(r,i[s],!1,!1))return!1}else if(n.type===T&&!b.inrange(r,i[s],!1,!0))return!1;return!0}function U(e,t,r){for(var n,a,i,o,s,e=this.context.data[e],l=e?e.values.value:[],c=e?e[I]&&e[I].value:void 0,u=r===g,d=l.length,f=0;f<d;++f)if(n=l[f],c&&u){if(-1!==(i=(a=a||{})[o=n.unit]||0)){if(s=p(t,n),a[o]=s?-1:++i,s&&1===c.size)return!0;if(!s&&i===c.get(o).count)return!1}}else if(u^(s=p(t,n)))return s;return d&&u}const M=r(w),P=M.left,N=M.right;function B(e,t,r){var e=this.context.data[e],n=e?e.values.value:[],e=e?e[I]&&e[I].value:void 0,r=r===g,t=w(t),a=P(n,t);if(a===n.length)return!1;if(w(n[a])!==t)return!1;if(e&&r){if(1===e.size)return!0;if(N(n,t)-a<e.size)return!1}return!0}function j(e,r){return e.map(t=>b.extend(r.fields?{values:r.fields.map(e=>d(e)(t.datum))}:{[k]:w(t.datum)},r))}function H(e,n,t,r){for(var a,i,o,s,l,c,u,d,f,p,e=this.context.data[e],h=e?e.values.value:[],g={},m={},_={},y=h.length,T=0;T<y;++T)if(o=(l=h[T]).unit,a=l.fields,i=l.values,a&&i){for(f=0,p=a.length;f<p;++f)s=a[f],u=(c=g[s.field]||(g[s.field]={}))[o]||(c[o]=[]),_[s.field]=d=s.type.charAt(0),d=v[d+"_union"],c[o]=d(u,b.array(i[f]));t&&(u=m[o]||(m[o]=[])).push(b.array(i).reduce((e,t,r)=>(e[a[r].field]=t,e),{}))}else s=k,l=w(l),(u=(c=g[s]||(g[s]={}))[o]||(c[o]=[])).push(l),t&&(u=m[o]||(m[o]=[])).push({[k]:l});return n=n||E,g[k]?g[k]=v[k+"_"+n](...Object.values(g[k])):Object.keys(g).forEach(r=>{g[r]=Object.keys(g[r]).map(e=>g[r][e]).reduce((e,t)=>void 0===e?t:v[_[r]+"_"+n](e,t))}),h=Object.keys(m),t&&h.length&&(e=r?A:S,g[e]=n===E?{[O]:h.reduce((e,t)=>(e.push(...m[t]),e),[])}:{[C]:h.map(e=>({[O]:m[e]}))}),g}var v={[k+"_union"]:F,[k+"_intersect"]:u,E_union:function(e,t){if(!e.length)return t;for(var r=0,n=t.length;r<n;++r)e.indexOf(t[r])<0&&e.push(t[r]);return e},E_intersect:function(e,t){return e.length?e.filter(e=>0<=t.indexOf(e)):t},R_union:function(e,t){var r=b.toNumber(t[0]),n=b.toNumber(t[1]);return n<r&&(r=t[1],n=t[0]),e.length?(e[0]>r&&(e[0]=r),e[1]<n&&(e[1]=n),e):[r,n]},R_intersect:function(e,t){var r=b.toNumber(t[0]),n=b.toNumber(t[1]);return n<r&&(r=t[1],n=t[0]),e.length?n<e[0]||e[1]<r?[]:(e[0]<r&&(e[0]=r),e[1]>n&&(e[1]=n),e):[r,n]}};const D=":",x="@";function G(e,t,r,n){t[0].type!==s.Literal&&b.error("First argument to selection functions must be a string literal.");var a=t[0].value,t=2<=t.length&&b.peek(t).value,i=x+"unit",o=D+a;t!==g||b.hasOwnProperty(n,i)||(n[i]=r.getData(a).indataRef(r,"unit")),b.hasOwnProperty(n,o)||(n[o]=r.getData(a).tuplesRef())}e.selectionIdTest=B,e.selectionResolve=H,e.selectionTest=U,e.selectionTuples=j,e.selectionVisitor=G}}return cd.exports}function dd(){if(!ld){ld=1;var e=ad.exports;{var p=jo(),o=od(),L=Su(),F=su(),U=Au(),t=ud(),r=fu(),n=au();function B(e){e=this.context.data[e];return e?e.values.value:[]}function j(e,t,r){e=this.context.data[e]["index:"+t],t=e?e.value.get(r):void 0;return t&&t.count}function H(e,t){var r=this.context.dataflow,e=this.context.data[e].input;return r.pulse(e,r.changeset().remove(p.truthy).insert(t)),1}function G(e,t,r){var n,a;return e&&(n=this.context.dataflow,a=e.mark.source,n.pulse(a,n.changeset().encode(e,t))),void 0!==r?r:e}const rn=n=>function(e,t){var r=this.context.dataflow.locale();return null===e?"null":r[n](t)(e)},nn=rn("format"),an=rn("timeFormat"),on=rn("utcFormat"),sn=rn("timeParse"),ln=rn("utcParse"),cn=new Date(2e3,0,1);function V(e,t,r){return Number.isInteger(e)&&Number.isInteger(t)?(cn.setYear(2e3),cn.setMonth(e),cn.setDate(t),an.call(this,cn,r)):""}function W(e){return V.call(this,e,1,"%B")}function q(e){return V.call(this,e,1,"%b")}function $(e){return V.call(this,0,2+e,"%A")}function z(e){return V.call(this,0,2+e,"%a")}const un=":",dn="@",fn="%",pn="$";function K(e,t,r,n){t[0].type!==o.Literal&&p.error("First argument to data functions must be a string literal.");var t=t[0].value,a=un+t;if(!p.hasOwnProperty(a,n))try{n[a]=r.getData(t).tuplesRef()}catch(e){}}function Y(e,t,r,n){t[0].type!==o.Literal&&p.error("First argument to indata must be a string literal."),t[1].type!==o.Literal&&p.error("Second argument to indata must be a string literal.");var a=t[0].value,t=t[1].value,i=dn+t;p.hasOwnProperty(i,n)||(n[i]=r.getData(a).indataRef(r,t))}function a(e,t,r,n){if(t[0].type===o.Literal)J(r,n,t[0].value);else for(e in r.scales)J(r,n,e)}function J(e,t,r){var n=fn+r;if(!p.hasOwnProperty(t,n))try{t[n]=e.scaleRef(r)}catch(e){}}function u(e,t){return p.isFunction(e)?e:p.isString(e)&&(t=t.scales[e])&&L.isRegisteredScale(t.value)?t.value:void 0}function Z(t,e,r){e.__bandwidth=e=>e&&e.bandwidth?e.bandwidth():0,r._bandwidth=a,r._range=a,r._scale=a;const n=e=>"_["+(e.type===o.Literal?p.stringValue(fn+e.value):p.stringValue(fn)+"+"+t(e))+"]";return{_bandwidth:e=>`this.__bandwidth(${n(e[0])})`,_range:e=>n(e[0])+".range()",_scale:e=>`${n(e[0])}(${t(e[1])})`}}class x{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){var r=this._partials;let n=0;for(let e=0;e<this._n&&e<32;e++){var a=r[e],i=t+a,a=Math.abs(t)<Math.abs(a)?t-(i-a):a-(i-t);a&&(r[n++]=a),t=i}return r[n]=t,this._n=n+1,this}valueOf(){var e=this._partials;let t=this._n,r,n,a,i=0;if(0<t){for(i=e[--t];0<t&&(r=i,n=e[--t],i=r+n,!(a=n-(i-r))););0<t&&(a<0&&e[t-1]<0||0<a&&0<e[t-1])&&(n=2*a,r=i+n,n==r-i)&&(i=r)}return i}}function Q(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=0|Math.max(0,Math.ceil((t-e)/r)),i=new Array(a);++n<a;)i[n]=e+n*r;return i}var X=1e-6,ee=1e-12,te=(C=Math.PI)/2,re=C/4,ne=2*C,ae=180/C,l=C/180,ie=Math.abs,oe=Math.atan2,c=Math.cos,se=Math.hypot,d=Math.sin,le=Math.sqrt;function ce(e){return 1<e?te:e<-1?-te:Math.asin(e)}function ue(){}function de(e,t){e&&pe.hasOwnProperty(e.type)&&pe[e.type](e,t)}var fe={Feature:function(e,t){de(e.geometry,t)},FeatureCollection:function(e,t){for(var r=e.features,n=-1,a=r.length;++n<a;)de(r[n].geometry,t)}},pe={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var r=e.coordinates,n=-1,a=r.length;++n<a;)e=r[n],t.point(e[0],e[1],e[2])},LineString:function(e,t){he(e.coordinates,t,0)},MultiLineString:function(e,t){for(var r=e.coordinates,n=-1,a=r.length;++n<a;)he(r[n],t,0)},Polygon:function(e,t){ge(e.coordinates,t)},MultiPolygon:function(e,t){for(var r=e.coordinates,n=-1,a=r.length;++n<a;)ge(r[n],t)},GeometryCollection:function(e,t){for(var r=e.geometries,n=-1,a=r.length;++n<a;)de(r[n],t)}};function he(e,t,r){var n,a=-1,i=e.length-r;for(t.lineStart();++a<i;)n=e[a],t.point(n[0],n[1],n[2]);t.lineEnd()}function ge(e,t){var r=-1,n=e.length;for(t.polygonStart();++r<n;)he(e[r],t,1);t.polygonEnd()}function me(e,t){e&&fe.hasOwnProperty(e.type)?fe[e.type](e,t):de(e,t)}var _e,ye,Te,be,ve,f,h,g,m,_,Ee,Se,Ae,Oe,y,T,Ce=new x,ke=new x,i={point:ue,lineStart:ue,lineEnd:ue,polygonStart:function(){Ce=new x,i.lineStart=we,i.lineEnd=Re},polygonEnd:function(){var e=+Ce;ke.add(e<0?ne+e:e),this.lineStart=this.lineEnd=this.point=ue},sphere:function(){ke.add(ne)}};function we(){i.point=Ie}function Re(){Me(_e,ye)}function Ie(e,t){i.point=Me,_e=e,ye=t,Te=e*=l,be=c(t=(t*=l)/2+re),ve=d(t)}function Me(e,t){var r=(e*=l)-Te,n=0<=r?1:-1,r=n*r,a=c(t=(t*=l)/2+re),t=d(t),i=ve*t,o=be*a+i*c(r),i=i*n*d(r);Ce.add(oe(i,o)),Te=e,be=a,ve=t}function Pe(e){return ke=new x,me(e,i),2*ke}function Ne(e){return[oe(e[1],e[0]),ce(e[2])]}function De(e){var t=e[0],e=e[1],r=c(e);return[r*c(t),r*d(t),d(e)]}function xe(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Le(e){var t=le(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var Fe,Ue,Be,je,He,Ge,Ve,We,qe,$e,ze,Ke,Ye,b,v,E,S={point:Je,lineStart:Qe,lineEnd:Xe,polygonStart:function(){S.point=et,S.lineStart=tt,S.lineEnd=rt,Oe=new x,i.polygonStart()},polygonEnd:function(){i.polygonEnd(),S.point=Je,S.lineStart=Qe,S.lineEnd=Xe,Ce<0?(f=-(g=180),h=-(m=90)):X<Oe?m=90:Oe<-X&&(h=-90),T[0]=f,T[1]=g},sphere:function(){f=-(g=180),h=-(m=90)}};function Je(e,t){y.push(T=[f=e,g=e]),t<h&&(h=t),m<t&&(m=t)}function Ze(e,t){var r,n,a,i,o,s=De([e*l,t*l]);Ae?(r=xe(Ae,s),Le(r=xe([r[1],-r[0],0],r)),r=Ne(r),o=e-_,a=r[0]*ae*(n=0<o?1:-1),(o=180<ie(o))^(n*_<a&&a<n*e)?(i=r[1]*ae,m<i&&(m=i)):o^(n*_<(a=(360+a)%360-180)&&a<n*e)?(i=-r[1]*ae)<h&&(h=i):(t<h&&(h=t),m<t&&(m=t)),o?e<_?A(f,e)>A(f,g)&&(g=e):A(e,g)>A(f,g)&&(f=e):f<=g?(e<f&&(f=e),g<e&&(g=e)):_<e?A(f,e)>A(f,g)&&(g=e):A(e,g)>A(f,g)&&(f=e)):y.push(T=[f=e,g=e]),t<h&&(h=t),m<t&&(m=t),Ae=s,_=e}function Qe(){S.point=Ze}function Xe(){T[0]=f,T[1]=g,S.point=Je,Ae=null}function et(e,t){var r;Ae?(r=e-_,Oe.add(180<ie(r)?r+(0<r?360:-360):r)):(Ee=e,Se=t),i.point(e,t),Ze(e,t)}function tt(){i.lineStart()}function rt(){et(Ee,Se),i.lineEnd(),ie(Oe)>X&&(f=-(g=180)),T[0]=f,T[1]=g,Ae=null}function A(e,t){return(t-=e)<0?t+360:t}function nt(e,t){return e[0]-t[0]}function at(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function it(e){var t,r,n,a,i,o,s;if(m=g=-(f=h=1/0),y=[],me(e,S),r=y.length){for(y.sort(nt),t=1,i=[n=y[0]];t<r;++t)at(n,(a=y[t])[0])||at(n,a[1])?(A(n[0],a[1])>A(n[0],n[1])&&(n[1]=a[1]),A(a[0],n[1])>A(n[0],n[1])&&(n[0]=a[0])):i.push(n=a);for(o=-1/0,t=0,n=i[r=i.length-1];t<=r;n=a,++t)(s=A(n[1],(a=i[t])[0]))>o&&(o=s,f=a[0],g=n[1])}return y=T=null,f===1/0||h===1/0?[[NaN,NaN],[NaN,NaN]]:[[f,h],[g,m]]}var s={sphere:ue,point:ot,lineStart:lt,lineEnd:dt,polygonStart:function(){s.lineStart=ft,s.lineEnd=pt},polygonEnd:function(){s.lineStart=lt,s.lineEnd=dt}};function ot(e,t){e*=l;var r=c(t*=l);st(r*c(e),r*d(e),d(t))}function st(e,t,r){Be+=(e-Be)/++Fe,je+=(t-je)/Fe,He+=(r-He)/Fe}function lt(){s.point=ct}function ct(e,t){e*=l;var r=c(t*=l);b=r*c(e),v=r*d(e),E=d(t),s.point=ut,st(b,v,E)}function ut(e,t){e*=l;var r=c(t*=l),n=r*c(e),r=r*d(e),e=d(t),t=oe(le((t=v*e-E*r)*t+(t=E*n-b*e)*t+(t=b*r-v*n)*t),b*n+v*r+E*e);Ue+=t,Ge+=t*(b+(b=n)),Ve+=t*(v+(v=r)),We+=t*(E+(E=e)),st(b,v,E)}function dt(){s.point=ot}function ft(){s.point=ht}function pt(){gt(Ke,Ye),s.point=ot}function ht(e,t){Ke=e,Ye=t,e*=l,t*=l,s.point=gt;var r=c(t);b=r*c(e),v=r*d(e),E=d(t),st(b,v,E)}function gt(e,t){e*=l;var r=c(t*=l),n=r*c(e),r=r*d(e),e=d(t),t=v*e-E*r,a=E*n-b*e,i=b*r-v*n,o=se(t,a,i),s=ce(o),o=o&&-s/o;qe.add(o*t),$e.add(o*a),ze.add(o*i),Ue+=s,Ge+=s*(b+(b=n)),Ve+=s*(v+(v=r)),We+=s*(E+(E=e)),st(b,v,E)}function mt(e){Fe=Ue=Be=je=He=Ge=Ve=We=0,qe=new x,$e=new x,ze=new x,me(e,s);var e=+qe,t=+$e,r=+ze,n=se(e,t,r);return n<ee&&(e=Ge,t=Ve,r=We,Ue<X&&(e=Be,t=je,r=He),(n=se(e,t,r))<ee)?[NaN,NaN]:[oe(t,e)*ae,ce(r/n)*ae]}function _t(n,a){return function(e,t,r){return e?(e=u(e,(r||this).context))&&e.path[n](t):a(t)}}var yt=_t("area",Pe),Tt=_t("bounds",it),bt=_t("centroid",mt);function vt(e,t){e=u(e,(t||this).context);return e&&e.scale()}function Et(e){var t=this.context.group;let r=!1;if(t)for(;e;){if(e===t){r=!0;break}e=e.mark.group}return r}function St(t,e,r){try{t[e].apply(t,["EXPRESSION"].concat([].slice.call(r)))}catch(e){t.warn(e)}return r[r.length-1]}function At(){return St(this.context.dataflow,"warn",arguments)}function Ot(){return St(this.context.dataflow,"info",arguments)}function Ct(){return St(this.context.dataflow,"debug",arguments)}function kt(e,t,r){(e.prototype=t.prototype=r).constructor=e}function wt(e,t){var r,n=Object.create(e.prototype);for(r in t)n[r]=t[r];return n}function O(){}var C="\\s*([+-]?\\d+)\\s*",Rt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",k="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",It=/^#([0-9a-f]{3,8})$/,Mt=new RegExp(`^rgb\\(${C},${C},${C}\\)$`),Pt=new RegExp(`^rgb\\(${k},${k},${k}\\)$`),Nt=new RegExp(`^rgba\\(${C},${C},${C},${Rt}\\)$`),Dt=new RegExp(`^rgba\\(${k},${k},${k},${Rt}\\)$`),xt=new RegExp(`^hsl\\(${Rt},${k},${k}\\)$`),Lt=new RegExp(`^hsla\\(${Rt},${k},${k},${Rt}\\)$`),Ft={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ut(){return this.rgb().formatHex()}function Bt(){return this.rgb().formatHex8()}function jt(){return Qt(this).formatHsl()}function Ht(){return this.rgb().formatRgb()}function Gt(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=It.exec(e))?(r=t[1].length,t=parseInt(t[1],16),6===r?Vt(t):3===r?new w(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===r?Wt(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===r?Wt(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Mt.exec(e))?new w(t[1],t[2],t[3],1):(t=Pt.exec(e))?new w(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Nt.exec(e))?Wt(t[1],t[2],t[3],t[4]):(t=Dt.exec(e))?Wt(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=xt.exec(e))?Zt(t[1],t[2]/100,t[3]/100,1):(t=Lt.exec(e))?Zt(t[1],t[2]/100,t[3]/100,t[4]):Ft.hasOwnProperty(e)?Vt(Ft[e]):"transparent"===e?new w(NaN,NaN,NaN,0):null}function Vt(e){return new w(e>>16&255,e>>8&255,255&e,1)}function Wt(e,t,r,n){return new w(e=n<=0?t=r=NaN:e,t,r,n)}function qt(e){return(e=e instanceof O?e:Gt(e))?new w((e=e.rgb()).r,e.g,e.b,e.opacity):new w}function $t(e,t,r,n){return 1===arguments.length?qt(e):new w(e,t,r,null==n?1:n)}function w(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}function zt(){return"#"+I(this.r)+I(this.g)+I(this.b)}function Kt(){return"#"+I(this.r)+I(this.g)+I(this.b)+I(255*(isNaN(this.opacity)?1:this.opacity))}function Yt(){var e=Jt(this.opacity);return(1===e?"rgb(":"rgba(")+R(this.r)+`, ${R(this.g)}, `+R(this.b)+(1===e?")":`, ${e})`)}function Jt(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function R(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function I(e){return((e=R(e))<16?"0":"")+e.toString(16)}function Zt(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||1<=r?e=t=NaN:t<=0&&(e=NaN),new M(e,t,r,n)}function Qt(e){var t,r,n,a,i,o,s,l;return e instanceof M?new M(e.h,e.s,e.l,e.opacity):(e=e instanceof O?e:Gt(e))?e instanceof M?e:(t=(e=e.rgb()).r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),o=NaN,l=((i=Math.max(t,r,n))+a)/2,(s=i-a)?(o=t===i?(r-n)/s+6*(r<n):r===i?(n-t)/s+2:(t-r)/s+4,s/=l<.5?i+a:2-i-a,o*=60):s=0<l&&l<1?0:o,new M(o,s,l,e.opacity)):new M}function Xt(e,t,r,n){return 1===arguments.length?Qt(e):new M(e,t,r,null==n?1:n)}function M(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}function er(e){return(e=(e||0)%360)<0?e+360:e}function tr(e){return Math.max(0,Math.min(1,e||0))}function rr(e,t,r){return 255*(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)}kt(O,Gt,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Ut,formatHex:Ut,formatHex8:Bt,formatHsl:jt,formatRgb:Ht,toString:Ht}),kt(w,$t,wt(O,{brighter(e){return e=null==e?1/.7:Math.pow(1/.7,e),new w(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new w(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new w(R(this.r),R(this.g),R(this.b),Jt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:zt,formatHex:zt,formatHex8:Kt,formatRgb:Yt,toString:Yt})),kt(M,Xt,wt(O,{brighter(e){return e=null==e?1/.7:Math.pow(1/.7,e),new M(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new M(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,t=r+(r<.5?r:1-r)*t,r=2*r-t;return new w(rr(240<=e?e-240:120+e,r,t),rr(e,r,t),rr(e<120?240+e:e-120,r,t),this.opacity)},clamp(){return new M(er(this.h),tr(this.s),tr(this.l),Jt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){var e=Jt(this.opacity);return(1===e?"hsl(":"hsla(")+er(this.h)+`, ${100*tr(this.s)}%, ${100*tr(this.l)}%`+(1===e?")":`, ${e})`)}}));const hn=Math.PI/180,gn=180/Math.PI,mn=.96422,_n=1,yn=.82521,Tn=4/29,bn=6/29,vn=3*bn*bn,En=bn*bn*bn;function nr(e){var t,r,n,a,i,o;return e instanceof P?new P(e.l,e.a,e.b,e.opacity):e instanceof N?dr(e):(a=ir((.2225045*(t=lr((e=e instanceof w?e:qt(e)).r))+.7168786*(r=lr(e.g))+.0606169*(n=lr(e.b)))/_n),t===r&&r===n?i=o=a:(i=ir((.4360747*t+.3850649*r+.1430804*n)/mn),o=ir((.0139322*t+.0971045*r+.7141733*n)/yn)),new P(116*a-16,500*(i-a),200*(a-o),e.opacity))}function ar(e,t,r,n){return 1===arguments.length?nr(e):new P(e,t,r,null==n?1:n)}function P(e,t,r,n){this.l=+e,this.a=+t,this.b=+r,this.opacity=+n}function ir(e){return e>En?Math.pow(e,1/3):e/vn+Tn}function or(e){return e>bn?e*e*e:vn*(e-Tn)}function sr(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function lr(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function cr(e){var t;return e instanceof N?new N(e.h,e.c,e.l,e.opacity):0===(e=e instanceof P?e:nr(e)).a&&0===e.b?new N(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity):new N((t=Math.atan2(e.b,e.a)*gn)<0?360+t:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function ur(e,t,r,n){return 1===arguments.length?cr(e):new N(e,t,r,null==n?1:n)}function N(e,t,r,n){this.h=+e,this.c=+t,this.l=+r,this.opacity=+n}function dr(e){var t;return isNaN(e.h)?new P(e.l,0,0,e.opacity):(t=e.h*hn,new P(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity))}function fr(e){e/=255;return e<=.03928?e/12.92:Math.pow((.055+e)/1.055,2.4)}function pr(e){e=$t(e);return.2126*fr(e.r)+.7152*fr(e.g)+.0722*fr(e.b)}function hr(e,t){e=pr(e),t=pr(t);return(Math.max(e,t)+.05)/(Math.min(e,t)+.05)}function gr(){var e=[].slice.call(arguments);return e.unshift({}),p.extend(...e)}function mr(e,t){return e===t||e!=e&&t!=t||(p.isArray(e)?p.isArray(t)&&e.length===t.length&&_r(e,t):p.isObject(e)&&p.isObject(t)&&yr(e,t))}function _r(r,n){for(let e=0,t=r.length;e<t;++e)if(!mr(r[e],n[e]))return!1;return!0}function yr(e,t){for(const r in e)if(!mr(e[r],t[r]))return!1;return!0}function Tr(t){return e=>yr(t,e)}function br(e,t,r,n,a,i){const o=this.context.dataflow,s=this.context.data[e],l=s.input,c=o.stamp();let u=s.changes,d,f;if(!1===o._trigger||!(l.value.length||t||n))return 0;if((!u||u.stamp<c)&&(s.changes=u=o.changeset(),u.stamp=c,o.runAfter(()=>{s.modified=!0,o.pulse(l,u).run()},!0,1)),r&&(d=!0===r?p.truthy:p.isArray(r)||F.isTuple(r)?r:Tr(r),u.remove(d)),t&&u.insert(t),n&&(d=Tr(n),l.value.some(d)?u.remove(d):u.insert(n)),a)for(f in i)u.modify(a,f,i[f]);return 1}function vr(e){var e=e.touches,t=e[0].clientX-e[1].clientX,e=e[0].clientY-e[1].clientY;return Math.hypot(t,e)}function Er(e){e=e.touches;return Math.atan2(e[0].clientY-e[1].clientY,e[0].clientX-e[1].clientX)}kt(P,ar,wt(O,{brighter(e){return new P(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker(e){return new P(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,r=isNaN(this.b)?e:e-this.b/200;return new w(sr(3.1338561*(t=mn*or(t))-1.6168667*(e=_n*or(e))-.4906146*(r=yn*or(r))),sr(-.9787684*t+1.9161415*e+.033454*r),sr(.0719453*t-.2289914*e+1.4052427*r),this.opacity)}})),kt(N,ur,wt(O,{brighter(e){return new N(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker(e){return new N(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb(){return dr(this).rgb()}}));const Sn={};function Sr(e,t){t=Sn[t]||(Sn[t]=p.field(t));return p.isArray(e)?e.map(t):t(e)}function Ar(e){return p.isArray(e)||ArrayBuffer.isView(e)?e:null}function Or(e){return Ar(e)||(p.isString(e)?e:null)}function Cr(e,...t){return Ar(e).join(...t)}function kr(e,...t){return Or(e).indexOf(...t)}function wr(e,...t){return Or(e).lastIndexOf(...t)}function Rr(e,...t){return Or(e).slice(...t)}function Ir(e,t,r){return p.isFunction(r)&&p.error("Function argument passed to replace."),String(e).replace(t,r)}function Mr(e){return Ar(e).slice().reverse()}function Pr(e,t,r){return L.bandSpace(e||0,t||0,r||0)}function Nr(e,t){e=u(e,(t||this).context);return e&&e.bandwidth?e.bandwidth():0}function Dr(e,t){e=u(e,(t||this).context);return e?e.copy():void 0}function xr(e,t){e=u(e,(t||this).context);return e?e.domain():[]}function Lr(e,t,r){e=u(e,(r||this).context);return e?(p.isArray(t)?e.invertRange||e.invert:e.invert||e.invertExtent)(t):void 0}function Fr(e,t){e=u(e,(t||this).context);return e&&e.range?e.range():[]}function Ur(e,t,r){e=u(e,(r||this).context);return e?e(t):void 0}function Br(t,e,r,n,a){t=u(t,(a||this).context);const i=U.Gradient(e,r);let o=t.domain(),s=o[0],l=p.peek(o),c=p.identity;return l-s?c=L.scaleFraction(t,s,l):t=(t.interpolator?L.scale("sequential")().interpolator(t.interpolator()):L.scale("linear")().interpolate(t.interpolate()).range(t.range())).domain([s=0,l=1]),t.ticks&&(o=t.ticks(+n||15),s!==o[0]&&o.unshift(s),l!==p.peek(o))&&o.push(l),o.forEach(e=>i.stop(c(e),t(e))),i}function jr(e,t,r){const n=u(e,(r||this).context);return function(e){return n?n.path.context(e)(t):""}}function Hr(t){let r=null;return function(e){return e?U.pathRender(e,r=r||U.pathParse(t)):t}}const An=e=>e.data;function Gr(e,t){t=B.call(t,e);return t.root&&t.root.lookup||{}}function Vr(e,t,r){e=Gr(e,this),t=e[t],e=e[r];return t&&e?t.path(e).map(An):void 0}function Wr(e,t){e=Gr(e,this)[t];return e?e.ancestors().map(An):void 0}const On=()=>"undefined"!=typeof window&&window||null;function qr(){var e=On();return e?e.screen:{}}function $r(){var e=On();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function zr(){var e=this.context.dataflow,e=e.container&&e.container();return e?[e.clientWidth,e.clientHeight]:[void 0,void 0]}function Kr(e,t,r){var n;return e?([e,n]=e,e=(new U.Bounds).set(e[0],e[1],n[0],n[1]),n=r||this.context.dataflow.scenegraph().root,U.intersect(n,e,Yr(t))):[]}function Yr(e){let t=null;if(e){const r=p.array(e.marktype),n=p.array(e.markname);t=t=>(!r.length||r.some(e=>t.marktype===e))&&(!n.length||n.some(e=>t.name===e))}return t}function Jr(e,t,r,n=5){var a=(e=p.array(e))[e.length-1];return void 0===a||Math.hypot(a[0]-t,a[1]-r)>n?[...e,[t,r]]:e}function Zr(a){return p.array(a).reduce((e,[t,r],n)=>e+(0==n?`M ${t},${r} `:n===a.length-1?" Z":`L ${t},${r} `),"")}function Qr(e,t,r){var n,a,{x:r,y:i,mark:o}=r,s=(new U.Bounds).set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for([n,a]of t)n<s.x1&&(s.x1=n),n>s.x2&&(s.x2=n),a<s.y1&&(s.y1=a),a>s.y2&&(s.y2=a);return s.translate(r,i),Kr([[s.x1,s.y1],[s.x2,s.y2]],e,o).filter(e=>Xr(e.x,e.y,t))}function Xr(r,n,a){let i=0;for(let e=0,t=a.length-1;e<a.length;t=e++){var[o,s]=a[t],[l,c]=a[e];n<c!=n<s&&r<(o-l)*(n-c)/(s-c)+l&&i++}return 1&i}const Cn={random(){return r.random()},cumulativeNormal:r.cumulativeNormal,cumulativeLogNormal:r.cumulativeLogNormal,cumulativeUniform:r.cumulativeUniform,densityNormal:r.densityNormal,densityLogNormal:r.densityLogNormal,densityUniform:r.densityUniform,quantileNormal:r.quantileNormal,quantileLogNormal:r.quantileLogNormal,quantileUniform:r.quantileUniform,sampleNormal:r.sampleNormal,sampleLogNormal:r.sampleLogNormal,sampleUniform:r.sampleUniform,isArray:p.isArray,isBoolean:p.isBoolean,isDate:p.isDate,isDefined(e){return void 0!==e},isNumber:p.isNumber,isObject:p.isObject,isRegExp:p.isRegExp,isString:p.isString,isTuple:F.isTuple,isValid(e){return null!=e&&e==e},toBoolean:p.toBoolean,toDate(e){return p.toDate(e)},toNumber:p.toNumber,toString:p.toString,indexof:kr,join:Cr,lastindexof:wr,replace:Ir,reverse:Mr,slice:Rr,flush:p.flush,lerp:p.lerp,merge:gr,pad:p.pad,peek:p.peek,pluck:Sr,span:p.span,inrange:p.inrange,truncate:p.truncate,rgb:$t,lab:ar,hcl:ur,hsl:Xt,luminance:pr,contrast:hr,sequence:Q,format:nn,utcFormat:on,utcParse:ln,utcOffset:n.utcOffset,utcSequence:n.utcSequence,timeFormat:an,timeParse:sn,timeOffset:n.timeOffset,timeSequence:n.timeSequence,timeUnitSpecifier:n.timeUnitSpecifier,monthFormat:W,monthAbbrevFormat:q,dayFormat:$,dayAbbrevFormat:z,quarter:p.quarter,utcquarter:p.utcquarter,week:n.week,utcweek:n.utcweek,dayofyear:n.dayofyear,utcdayofyear:n.utcdayofyear,warn:At,info:Ot,debug:Ct,extent(e){return p.extent(e)},inScope:Et,intersect:Kr,clampRange:p.clampRange,pinchDistance:vr,pinchAngle:Er,screen:qr,containerSize:zr,windowSize:$r,bandspace:Pr,setdata:H,pathShape:Hr,panLinear:p.panLinear,panLog:p.panLog,panPow:p.panPow,panSymlog:p.panSymlog,zoomLinear:p.zoomLinear,zoomLog:p.zoomLog,zoomPow:p.zoomPow,zoomSymlog:p.zoomSymlog,encode:G,modify:br,lassoAppend:Jr,lassoPath:Zr,intersectLasso:Qr},kn=["view","item","group","xy","x","y"],wn="event.vega.",Rn="this.",In={},Mn={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${p.stringValue(pn+e)}]`,functions:en,constants:o.constants,visitors:In},Pn=o.codegenExpression(Mn);function en(e){const t=o.functions(e);kn.forEach(e=>t[e]=wn+e);for(const r in Cn)t[r]=Rn+r;return p.extend(t,Z(e,Cn,In)),t}function D(e,t,r){return 1===arguments.length?Cn[e]:(Cn[e]=t,r&&(In[e]=r),Pn&&(Pn.functions[e]=Rn+e),this)}function tn(t,n){const a={};let e;try{t=p.isString(t)?t:p.stringValue(t)+"",e=o.parseExpression(t)}catch(e){p.error("Expression parse error: "+t)}e.visit(e=>{var t,r;e.type===o.CallExpression&&(t=e.callee.name,r=Mn.visitors[t])&&r(t,e.arguments,n,a)});t=Pn(e);return t.globals.forEach(e=>{var t=pn+e;!p.hasOwnProperty(a,t)&&n.getSignal(e)&&(a[t]=n.signalRef(e))}),{$expr:p.extend({code:t.code},n.options.ast?{ast:e}:null),$fields:t.fields,$params:a}}D("bandwidth",Nr,a),D("copy",Dr,a),D("domain",xr,a),D("range",Fr,a),D("invert",Lr,a),D("scale",Ur,a),D("gradient",Br,a),D("geoArea",yt,a),D("geoBounds",Tt,a),D("geoCentroid",bt,a),D("geoShape",jr,a),D("geoScale",vt,a),D("indata",j,Y),D("data",B,K),D("treePath",Vr,K),D("treeAncestors",Wr,K),D("vlSelectionTest",t.selectionTest,t.selectionVisitor),D("vlSelectionIdTest",t.selectionIdTest,t.selectionVisitor),D("vlSelectionResolve",t.selectionResolve,t.selectionVisitor),D("vlSelectionTuples",t.selectionTuples),e.DataPrefix=un,e.IndexPrefix=dn,e.ScalePrefix=fn,e.SignalPrefix=pn,e.bandspace=Pr,e.bandwidth=Nr,e.codeGenerator=Pn,e.codegenParams=Mn,e.containerSize=zr,e.contrast=hr,e.copy=Dr,e.data=B,e.dataVisitor=K,e.dayAbbrevFormat=z,e.dayFormat=$,e.debug=Ct,e.domain=xr,e.encode=G,e.expressionFunction=D,e.format=nn,e.functionContext=Cn,e.geoArea=yt,e.geoBounds=Tt,e.geoCentroid=bt,e.geoScale=vt,e.geoShape=jr,e.inScope=Et,e.indata=j,e.indataVisitor=Y,e.indexof=kr,e.info=Ot,e.invert=Lr,e.join=Cr,e.lastindexof=wr,e.luminance=pr,e.merge=gr,e.modify=br,e.monthAbbrevFormat=q,e.monthFormat=W,e.parseExpression=tn,e.pathShape=Hr,e.pinchAngle=Er,e.pinchDistance=vr,e.pluck=Sr,e.range=Fr,e.replace=Ir,e.reverse=Mr,e.scale=Ur,e.scaleGradient=Br,e.scaleVisitor=a,e.screen=qr,e.setdata=H,e.slice=Rr,e.timeFormat=an,e.timeParse=sn,e.treeAncestors=Wr,e.treePath=Vr,e.utcFormat=on,e.utcParse=ln,e.warn=At,e.windowSize=$r}}return ad.exports}var fd,pd,hd={exports:{}};function gd(){if(!fd){fd=1;var e=hd.exports;{var o=jo(),a=su();function t(e){const t=this,r=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),r.forEach(e=>t.parseOperator(e)),r.forEach(e=>t.parseOperatorParameters(e)),(e.streams||[]).forEach(e=>t.parseStream(e)),(e.updates||[]).forEach(e=>t.parseUpdate(e)),t.resolve()}const P=o.toSet(["rule"]),N=o.toSet(["group","image","rect"]);function s(e,t){let r="";return P[t]||(e.x2&&(e.x?(N[t]&&(r+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),r+="o.width=o.x2-o.x;"):r+="o.x=o.x2-(o.width||0);"),e.xc&&(r+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(N[t]&&(r+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),r+="o.height=o.y2-o.y;"):r+="o.y=o.y2-(o.height||0);"),e.yc&&(r+="o.y=o.yc-(o.height||0)/2;")),r}function r(e){return(e+"").toLowerCase()}function n(e){return"operator"===r(e)}function l(e){return"collect"===r(e)}function c(e,t,r){r.endsWith(";")||(r="return("+r+");");t=Function(...t.concat(r));return e&&e.functions?t.bind(e.functions):t}function u(e,t,r,n){return`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${r}
  : (u > v || v == null) && u != null ? ${n}
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${r}
  : v !== v && u === u ? ${n} : `}var i={operator:(e,t)=>c(e,["_"],t.code),parameter:(e,t)=>c(e,["datum","_"],t.code),event:(e,t)=>c(e,["event"],t.code),handler:(e,t)=>{return c(e,["_","event"],`var datum=event.item&&event.item.datum;return ${t.code};`)},encode:(e,t)=>{var{marktype:t,channels:r}=t;let n="var o=item,datum=o.datum,m=0,$;";for(const i in r){var a="o["+o.stringValue(i)+"]";n+=`$=${r[i].code};if(${a}!==$)${a}=$,m=1;`}return c(e,["item","_"],n=n+s(r,t)+"return m;")},codegen:{get(e){var e=`[${e.map(o.stringValue).join("][")}]`,t=Function("_",`return _${e};`);return t.path=e,t},comparator(e,i){let o;e=Function("a","b","var u, v; return "+e.map((e,t)=>{var r=i[t];let n,a;return a=e.path?(n="a"+e.path,"b"+e.path):((o=o||{})["f"+t]=e,n=`this.f${t}(a)`,`this.f${t}(b)`),u(n,a,-r,r)}).join("")+"0;");return o?e.bind(o):e}}};function d(e){n(e.type)||!e.type?this.operator(e,e.update?this.operatorExpression(e.update):null):this.transform(e,e.type)}function f(e){var t;e.params&&((t=this.get(e.id))||o.error("Invalid operator id: "+e.id),this.dataflow.connect(t,t.parameters(this.parseParameters(e.params),e.react,e.initonly)))}function p(e,t){t=t||{};const r=this;for(const a in e){var n=e[a];t[a]=o.isArray(n)?n.map(e=>h(e,r,t)):h(n,r,t)}return t}function h(n,a,i){if(n&&o.isObject(n))for(let e=0,t=g.length,r;e<t;++e)if(r=g[e],o.hasOwnProperty(n,r.key))return r.parse(n,a,i);return n}var g=[{key:"$ref",parse:m},{key:"$key",parse:y},{key:"$expr",parse:_},{key:"$field",parse:T},{key:"$encode",parse:v},{key:"$compare",parse:b},{key:"$context",parse:E},{key:"$subflow",parse:S},{key:"$tupleid",parse:A}];function m(e,t){return t.get(e.$ref)||o.error("Operator not defined: "+e.$ref)}function _(e,t,r){e.$params&&t.parseParameters(e.$params,r);r="e:"+e.$expr.code;return t.fn[r]||(t.fn[r]=o.accessor(t.parameterExpression(e.$expr),e.$fields))}function y(e,t){var r="k:"+e.$key+"_"+!!e.$flat;return t.fn[r]||(t.fn[r]=o.key(e.$key,e.$flat,t.expr.codegen))}function T(e,t){var r;return e.$field?(r="f:"+e.$field+"_"+e.$name,t.fn[r]||(t.fn[r]=o.field(e.$field,e.$name,t.expr.codegen))):null}function b(e,t){var r="c:"+e.$compare+"_"+e.$order,n=o.array(e.$compare).map(e=>e&&e.$tupleid?a.tupleid:e);return t.fn[r]||(t.fn[r]=o.compare(n,e.$order,t.expr.codegen))}function v(e,t){var r=e.$encode,n={};for(const i in r){var a=r[i];n[i]=o.accessor(t.encodeExpression(a.$expr),a.$fields),n[i].output=a.$output}return n}function E(e,t){return t}function S(e,o){const s=e.$subflow;return function(e,t,r){const n=o.fork().parse(s),a=n.get(s.operators[0].id),i=n.signals.parent;return i&&i.set(r),a.detachSubflow=()=>o.detach(n),a}}function A(){return a.tupleid}function O(e){var t,r=this,n=null!=e.filter?r.eventExpression(e.filter):void 0,a=null!=e.stream?r.get(e.stream):void 0;e.source?a=r.events(e.source,e.type,n):e.merge&&(a=(t=e.merge.map(e=>r.get(e)))[0].merge.apply(t[0],t.slice(1))),e.between&&(t=e.between.map(e=>r.get(e)),a=a.between(t[0],t[1])),e.filter&&(a=a.filter(n)),null!=e.throttle&&(a=a.throttle(+e.throttle)),null==(a=null!=e.debounce?a.debounce(+e.debounce):a)&&o.error("Invalid stream definition: "+JSON.stringify(e)),e.consume&&a.consume(!0),r.stream(e,a)}function C(e){var t,r=o.isObject(r=e.source)?r.$ref:r,r=this.get(r),n=e.update,a=void 0;r||o.error("Source not defined: "+e.source),t=e.target&&e.target.$expr?this.eventExpression(e.target.$expr):this.get(e.target),n&&n.$expr&&(n.$params&&(a=this.parseParameters(n.$params)),n=this.handlerExpression(n.$expr)),this.update(e,r,t,n,a)}const D={skip:!0};function k(r){var n,a,i=this,e={};return r.signals&&(n=e.signals={},Object.keys(i.signals).forEach(e=>{var t=i.signals[e];r.signals(e,t)&&(n[e]=t.value)})),r.data&&(a=e.data={},Object.keys(i.data).forEach(e=>{var t=i.data[e];r.data(e,t)&&(a[e]=t.input.value)})),i.subcontext&&!1!==r.recurse&&(e.subcontext=i.subcontext.map(e=>e.getState(r))),e}function w(e){var r=this,t=r.dataflow,n=e.data,a=e.signals;Object.keys(a||{}).forEach(e=>{t.update(r.signals[e],a[e],D)}),Object.keys(n||{}).forEach(e=>{t.pulse(r.data[e].input,t.changeset().remove(o.truthy).insert(n[e]))}),(e.subcontext||[]).forEach((e,t)=>{t=r.subcontext[t];t&&t.setState(e)})}function R(e,t,r,n){return new I(e,t,r,n)}function I(e,t,r,n){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=n||i,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},r&&(this.functions=Object.create(r),this.functions.context=this)}function M(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}I.prototype=M.prototype={fork(){var e=new M(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(t){this.subcontext=this.subcontext.filter(e=>e!==t);var e=Object.keys(t.nodes);for(const r of e)t.nodes[r]._targets=null;for(const n of e)t.nodes[n].detach();t.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(t,r){const n=this,a=n.dataflow,i=t.value;if(n.set(t.id,r),l(t.type)&&i&&(i.$ingest?a.ingest(r,i.$ingest,i.$format):i.$request?a.preload(r,i.$request,i.$format):a.pulse(r,a.changeset().insert(i))),t.root&&(n.root=r),t.parent){let e=n.get(t.parent.$ref);e?(a.connect(e,[r]),r.targets().add(e)):(n.unresolved=n.unresolved||[]).push(()=>{e=n.get(t.parent.$ref),a.connect(e,[r]),r.targets().add(e)})}if(t.signal&&(n.signals[t.signal]=r),t.scale&&(n.scales[t.scale]=r),t.data)for(const e in t.data){const i=n.data[e]||(n.data[e]={});t.data[e].forEach(e=>i[e]=r)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[r(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,r,n,a){this.dataflow.on(t,r,n,a,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:t,parseOperator:d,parseOperatorParameters:f,parseParameters:p,parseStream:O,parseUpdate:C,getState:k,setState:w},e.context=R}}return hd.exports}function md(){if(!pd){pd=1;var e=nd.exports;{var o=jo(),c=su(),l=Au(),F=dd(),U=gd(),B=iu();function j(e){var t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),r(t,e.description()))}function r(e,t){e&&(null==t?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function H(t){t.add(null,e=>(t._background=e.bg,t._resize=1,e.bg),{bg:t._signals.background})}const D="default";function G(n){const a=n._signals.cursor||(n._signals.cursor=n.add({user:D,item:null}));n.on(n.events("view","pointermove"),a,(e,t)=>{var r=a.value,n=r?o.isString(r)?r:r.user:D,t=t.item&&t.item.cursor||null;return r&&n===r.user&&t==r.item?r:{user:n,item:t}}),n.add(null,function(e){let t=e.cursor,r=this.value;return o.isString(t)||(r=t.item,t=t.user),i(n,(!t||t===D)&&r||t),r},{cursor:a})}function i(e,t){e=e.globalCursor()?"undefined"!=typeof document&&document.body:e.container();if(e)return null==t?e.style.removeProperty("cursor"):e.style.cursor=t}function n(e,t){e=e._runtime.data;return o.hasOwnProperty(e,t)||o.error("Unrecognized data set: "+t),e[t]}function V(e,t){return arguments.length<2?n(this,e).values.value:a.call(this,e,c.changeset().remove(o.truthy).insert(t))}function a(e,t){c.isChangeSet(t)||o.error("Second argument to changes must be a changeset.");e=n(this,e);return e.modified=!0,this.pulse(e.input,t)}function W(e,t){return a.call(this,e,c.changeset().insert(t))}function q(e,t){return a.call(this,e,c.changeset().remove(t))}function s(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function u(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function d(e){var t=e.padding(),e=e._origin;return[t.left+e[0],t.top+e[1]]}function $(t){var e=d(t),r=s(t),n=u(t);t._renderer.background(t.background()),t._renderer.resize(r,n,e),t._handler.origin(e),t._resizeListeners.forEach(e=>{try{e(r,n)}catch(e){t.error(e)}})}function z(e,t,r){var n,a,i=e._renderer,i=i&&i.canvas();return i&&(a=d(e),n=t.changedTouches?t.changedTouches[0]:t,(n=l.point(n,i))[0]-=a[0],n[1]-=a[1]),t.dataflow=e,t.item=r,t.vega=K(e,r,n),t}function K(e,n,r){const a=n?"group"===n.mark.marktype?n:n.mark.group:null;function i(e){var t,r=a;if(e)for(t=n;t;t=t.mark.group)if(t.mark.name===e){r=t;break}return r&&r.mark&&r.mark.interactive?r:{}}function t(e){if(!e)return r;o.isString(e)&&(e=i(e));for(var t=r.slice();e;)t[0]-=e.x||0,t[1]-=e.y||0,e=e.mark&&e.mark.group;return t}return{view:o.constant(e),item:o.constant(n||{}),group:i,xy:t,x:e=>t(e)[0],y:e=>t(e)[1]}}const x="view",Xe="timer",et="window",tt={trap:!1};function Y(e){var e=o.extend({defaults:{}},e),t=(t,e)=>{e.forEach(e=>{o.isArray(t[e])&&(t[e]=o.toSet(t[e]))})};return t(e.defaults,["prevent","allow"]),t(e,["view","window","selector"]),e}function f(e,t,r,n){e._eventListeners.push({type:r,sources:o.array(t),handler:n})}function J(e,t){var r=e._eventConfig.defaults,n=r.prevent,r=r.allow;return!1!==n&&!0!==r&&(!0===n||!1===r||(n?n[t]:r?!r[t]:e.preventDefault()))}function p(e,t,r){var n=e._eventConfig&&e._eventConfig[t];if(!1!==n&&(!o.isObject(n)||n[r]))return 1;e.warn(`Blocked ${t} ${r} event listener.`)}function Z(r,n,e){function t(e,t){i.runAsync(null,()=>{r===x&&J(i,n)&&e.preventDefault(),o.receive(z(i,e,t))})}var a,i=this,o=new c.EventStream(e);if(r===Xe)p(i,"timer",n)&&i.timer(t,n);else if(r===x)p(i,"view",n)&&i.addEventListener(n,t,tt);else if(r===et?p(i,"window",n)&&"undefined"!=typeof window&&(a=[window]):"undefined"!=typeof document&&p(i,"selector",n)&&(a=Array.from(document.querySelectorAll(r))),a){for(var s=0,l=a.length;s<l;++s)a[s].addEventListener(n,t);f(i,a,n,t)}else i.warn("Can not resolve event source: "+r);return o}function h(e){return e.item}function g(e){return e.item.mark.source}function Q(r){return function(e,t){return t.vega.view().changeset().encode(t.item,r)}}function X(e,t){return t=[t||"update",(e=[e||"hover"])[0]],this.on(this.events("view","pointerover",h),g,Q(e)),this.on(this.events("view","pointerout",h),g,Q(t)),this}function ee(){for(var e,t,r,n,a=this._tooltip,i=this._timers,o=this._handler.handlers(),s=this._eventListeners,l=i.length;0<=--l;)i[l].stop();for(l=s.length;0<=--l;)for(e=(t=s[l]).sources.length;0<=--e;)t.sources[e].removeEventListener(t.type,t.handler);for(a&&a.call(this,this._handler,null,null,null),l=o.length;0<=--l;)n=o[l].type,r=o[l].handler,this._handler.off(n,r);return this}function m(e,t,r){var n=document.createElement(e);for(const a in t)n.setAttribute(a,t[a]);return null!=r&&(n.textContent=r),n}const rt=Math.sqrt(50),nt=Math.sqrt(10),at=Math.sqrt(2);function te(e,t,r){var n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),n=n/Math.pow(10,a),n=n>=rt?10:n>=nt?5:n>=at?2:1;let i,o,s;return a<0?(s=Math.pow(10,-a)/n,i=Math.round(e*s),o=Math.round(t*s),i/s<e&&++i,o/s>t&&--o,s=-s):(s=Math.pow(10,a)*n,i=Math.round(e/s),o=Math.round(t/s),i*s<e&&++i,o*s>t&&--o),o<i&&.5<=r&&r<2?te(e,t,2*r):[i,o,s]}function re(e,t,r){return te(e=+e,t=+t,r=+r)[2]}function ne(e,t,r){r=+r;var n=(t=+t)<(e=+e),e=n?re(t,e,r):re(e,t,r);return(n?-1:1)*(e<0?1/-e:e)}const it="vega-bind",ot="vega-bind-name",st="vega-bind-radio";function ae(r,e,n){if(e){const a=n.param;let t=n.state;t||(t=n.state={elements:null,active:!1,set:null,update:e=>{e!=r.signal(a.signal)&&r.runAsync(null,()=>{t.source=!0,r.signal(a.signal,e)})}},a.debounce&&(t.update=o.debounce(a.debounce,t.update))),(null==a.input&&a.element?ie:se)(t,e,a,r),t.active||(r.on(r._signals[a.signal],null,()=>{t.source?t.source=!1:t.set(r.signal(a.signal))}),t.active=!0),t}}function ie(e,t,r,n){const a=r.event||"input";var i=()=>e.update(t.value);n.signal(r.signal,t.value),t.addEventListener(a,i),f(n,t,a,i),e.set=e=>{t.value=e,t.dispatchEvent(oe(a))}}function oe(e){return"undefined"!=typeof Event?new Event(e):{type:e}}function se(e,t,r,n){var n=n.signal(r.signal),a=m("div",{class:it}),i="radio"===r.input?a:a.appendChild(m("label"));i.appendChild(m("span",{class:ot},r.name||r.signal)),t.appendChild(a);let o=le;switch(r.input){case"checkbox":o=ce;break;case"select":o=ue;break;case"radio":o=de;break;case"range":o=fe}o(e,i,r,n)}function le(e,t,r,n){const a=m("input");for(const i in r)"signal"!==i&&"element"!==i&&a.setAttribute("input"===i?"type":i,r[i]);a.setAttribute("name",r.signal),a.value=n,t.appendChild(a),a.addEventListener("input",()=>e.update(a.value)),e.elements=[a],e.set=e=>a.value=e}function ce(e,t,r,n){r={type:"checkbox",name:r.signal};n&&(r.checked=!0);const a=m("input",r);t.appendChild(a),a.addEventListener("change",()=>e.update(a.checked)),e.elements=[a],e.set=e=>a.checked=!!e||null}function ue(e,t,n,a){const i=m("select",{name:n.signal}),o=n.labels||[];n.options.forEach((e,t)=>{var r={value:e};_(e,a)&&(r.selected=!0),i.appendChild(m("option",r,(o[t]||e)+""))}),t.appendChild(i),i.addEventListener("change",()=>{e.update(n.options[i.selectedIndex])}),e.elements=[i],e.set=r=>{for(let e=0,t=n.options.length;e<t;++e)if(_(n.options[e],r))return void(i.selectedIndex=e)}}function de(a,e,n,i){const o=m("span",{class:st}),s=n.labels||[];e.appendChild(o),a.elements=n.options.map((e,t)=>{var r={type:"radio",name:n.signal,value:e},r=(_(e,i)&&(r.checked=!0),m("input",r)),t=(r.addEventListener("change",()=>a.update(e)),m("label",{},(s[t]||e)+""));return t.prepend(r),o.appendChild(t),r}),a.set=t=>{var r=a.elements,n=r.length;for(let e=0;e<n;++e)_(r[e].value,t)&&(r[e].checked=!0)}}function fe(e,t,r,n){n=void 0!==n?n:(+r.max+ +r.min)/2;var a=null!=r.max?r.max:Math.max(100,+n)||100,i=r.min||Math.min(0,a,+n)||0,o=r.step||ne(i,a,100);const s=m("input",{type:"range",name:r.signal,min:i,max:a,step:o}),l=m("span",{},+(s.value=n));t.appendChild(s),t.appendChild(l);r=()=>{l.textContent=s.value,e.update(+s.value)};s.addEventListener("input",r),s.addEventListener("change",r),e.elements=[s],e.set=e=>{s.value=e,l.textContent=e}}function _(e,t){return e===t||e+""==t+""}function pe(e,t,r,n,a,i){return(t=t||new n(e.loader())).initialize(r,s(e),u(e),d(e),a,i).background(e.background())}function y(t,e){return e?function(){try{e.apply(this,arguments)}catch(e){t.error(e)}}:null}function he(e,t,r,n){const a=new n(e.loader(),y(e,e.tooltip())).scene(e.scenegraph().root).initialize(r,d(e),e);return t&&t.handlers().forEach(e=>{a.on(e.type,e.handler)}),a}function ge(e,t){const r=this,n=r._renderType,a=r._eventConfig.bind,i=l.renderModule(n);e=r._el=e?T(r,e,!0):null,j(r),i||r.error("Unrecognized renderer type: "+n);var o=i.handler||l.CanvasHandler,s=e?i.renderer:i.headless;return r._renderer=s?pe(r,r._renderer,e,s):null,r._handler=he(r,r._handler,e,o),r._redraw=!0,e&&"none"!==a&&(t=t?r._elBind=T(r,t,!0):e.appendChild(m("form",{class:"vega-bindings"})),r._bind.forEach(e=>{e.param.element&&"container"!==a&&(e.element=T(r,e.param.element,!!e.param.input))}),r._bind.forEach(e=>{ae(r,e.element||t,e)})),r}function T(t,r,e){if("string"==typeof r){if("undefined"==typeof document)return t.error("DOM document instance not found."),null;if(!(r=document.querySelector(r)))return t.error("Signal bind element not found: "+r),null}if(r&&e)try{r.textContent=""}catch(e){r=null,t.error(e)}return r}const L=e=>+e||0,lt=e=>({top:e,bottom:e,left:e,right:e});function me(e){return o.isObject(e)?{top:L(e.top),bottom:L(e.bottom),left:L(e.left),right:L(e.right)}:lt(L(e))}async function b(e,t,r,n){var a=l.renderModule(t),a=a&&a.headless;return a||o.error("Unrecognized renderer type: "+t),await e.runAsync(),pe(e,null,null,a,r,n).renderAsync(e._scenegraph.root)}async function _e(e,t){e!==l.RenderType.Canvas&&e!==l.RenderType.SVG&&e!==l.RenderType.PNG&&o.error("Unrecognized image type: "+e);t=await b(this,e,t);return e===l.RenderType.SVG?ye(t.svg(),"image/svg+xml"):t.canvas().toDataURL("image/png")}function ye(e,t){e=new Blob([e],{type:t});return window.URL.createObjectURL(e)}async function Te(e,t){return(await b(this,l.RenderType.Canvas,e,t)).canvas()}async function be(e){return(await b(this,l.RenderType.SVG,e)).svg()}function ve(e,t,r){return U.context(e,c.transforms,F.functionContext,r).parse(t)}function Ee(e){var t=this._runtime.scales;return o.hasOwnProperty(t,e)||o.error("Unrecognized scale or projection: "+e),t[e].value}var Se="width",Ae="height",v="padding",Oe={skip:!0};function Ce(e,t){var r=e.autosize(),e=e.padding();return t-(r&&r.contains===v?e.left+e.right:0)}function ke(e,t){var r=e.autosize(),e=e.padding();return t-(r&&r.contains===v?e.top+e.bottom:0)}function we(t){var e=t._signals,r=e[Se],n=e[Ae],e=e[v];function a(){t._autosize=t._resize=1}t._resizeWidth=t.add(null,e=>{t._width=e.size,t._viewWidth=Ce(t,e.size),a()},{size:r}),t._resizeHeight=t.add(null,e=>{t._height=e.size,t._viewHeight=ke(t,e.size),a()},{size:n});var i=t.add(null,a,{pad:e});t._resizeWidth.rank=r.rank+1,t._resizeHeight.rank=n.rank+1,i.rank=e.rank+1}function Re(r,n,a,i,o,s){this.runAfter(e=>{let t=0;e._autosize=0,e.width()!==a&&(t=1,e.signal(Se,a,Oe),e._resizeWidth.skip(!0)),e.height()!==i&&(t=1,e.signal(Ae,i,Oe),e._resizeHeight.skip(!0)),e._viewWidth!==r&&(e._resize=1,e._viewWidth=r),e._viewHeight!==n&&(e._resize=1,e._viewHeight=n),e._origin[0]===o[0]&&e._origin[1]===o[1]||(e._resize=1,e._origin=o),t&&e.run("enter"),s&&e.runAfter(e=>e.resize())},!1,1)}function Ie(e){return this._runtime.getState(e||{data:Me,signals:Pe,recurse:!0})}function Me(e,t){return t.modified&&o.isArray(t.input.value)&&!e.startsWith("_:vega:_")}function Pe(e,t){return!("parent"===e||t instanceof c.transforms.proxy)}function Ne(t){return this.runAsync(null,e=>{e._trigger=!1,e._runtime.setState(t)},e=>{e._trigger=!0}),this}var E,S,A=0,t=0,O=0,De=1e3,C=0,k=0,w=0,R="object"==typeof performance&&performance.now?performance:Date,xe="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function I(){return k||(xe(Le),k=R.now()+w)}function Le(){k=0}function M(){this._call=this._time=this._next=null}function Fe(){I(),++A;for(var e,t=E;t;)0<=(e=k-t._time)&&t._call.call(void 0,e),t=t._next;--A}function Ue(){k=(C=R.now())+w,A=t=0;try{Fe()}finally{A=0,je(),k=0}}function Be(){var e=R.now(),t=e-C;De<t&&(w-=t,C=e)}function je(){for(var e,t,r=E,n=1/0;r;)r=r._call?(n>r._time&&(n=r._time),(e=r)._next):(t=r._next,r._next=null,e?e._next=t:E=t);S=e,P(n)}function P(e){A||(t=t&&clearTimeout(t),24<e-k?(e<1/0&&(t=setTimeout(Ue,e-R.now()-w)),O=O&&clearInterval(O)):(O||(C=R.now(),O=setInterval(Be,De)),A=1,xe(Ue)))}function He(e,t,r){var i=new M,o=t;return null==t?i.restart(e,t,r):(i._restart=i.restart,i.restart=function(r,n,a){n=+n,a=null==a?I():+a,i._restart(function e(t){t+=o,i._restart(e,o+=n,a),r(t)},n,a)},i.restart(e,t,r)),i}function Ge(t,e){this._timers.push(He(function(e){t({timestamp:Date.now(),elapsed:e})},e))}function Ve(e,t,r,n){e=e.element();e&&e.setAttribute("title",We(n))}function We(e){return null==e?"":o.isArray(e)?$e(e):o.isObject(e)&&!o.isDate(e)?qe(e):e+""}function qe(r){return Object.keys(r).map(e=>{var t=r[e];return e+": "+(o.isArray(t)?$e:ze)(t)}).join("\n")}function $e(e){return"["+e.map(ze).join(", ")+"]"}function ze(e){return o.isArray(e)?"[…]":o.isObject(e)&&!o.isDate(e)?"{…}":e}function Ke(){if("canvas"===this.renderer()&&this._renderer._canvas){let t=null;const r=()=>{null!=t&&t();const e=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);e.addEventListener("change",r),t=()=>{e.removeEventListener("change",r)},this._renderer._canvas.getContext("2d").pixelRatio=window.devicePixelRatio||1,this._redraw=!0,this._resize=1,this.resize().runAsync()};r()}}function Ye(e,t){var r=this,n=(t=t||{},c.Dataflow.call(r),t.loader&&r.loader(t.loader),t.logger&&r.logger(t.logger),null!=t.logLevel&&r.logLevel(t.logLevel),(t.locale||e.locale)&&(n=o.extend({},e.locale,t.locale),r.locale(B.locale(n.number,n.time))),r._el=null,r._elBind=null,r._renderType=t.renderer||l.RenderType.Canvas,r._scenegraph=new l.Scenegraph,r._scenegraph.root),a=(r._renderer=null,r._tooltip=t.tooltip||Ve,r._redraw=!0,r._handler=(new l.CanvasHandler).scene(n),r._globalCursor=!1,r._preventDefault=!1,r._timers=[],r._eventListeners=[],r._resizeListeners=[],r._eventConfig=Y(e.eventConfig),r.globalCursor(r._eventConfig.globalCursor),ve(r,e,t.expr));r._runtime=a,r._signals=a.signals,r._bind=(e.bindings||[]).map(e=>({state:null,param:o.extend({},e)})),a.root&&a.root.set(n),n.source=a.data.root.input,r.pulse(a.data.root.input,r.changeset().insert(n.items)),r._width=r.width(),r._height=r.height(),r._viewWidth=Ce(r,r._width),r._viewHeight=ke(r,r._height),r._origin=[0,0],r._resize=0,r._autosize=1,we(r),H(r),G(r),r.description(e.description),t.hover&&r.hover(),t.container&&r.initialize(t.container,t.bind),t.watchPixelRatio&&r._watchPixelRatio()}function N(e,t){return o.hasOwnProperty(e._signals,t)?e._signals[t]:o.error("Unrecognized signal name: "+o.stringValue(t))}function Je(e,t){e=(e._targets||[]).filter(e=>e._update&&e._update.handler===t);return e.length?e[0]:null}function Ze(e,t,r,n){var a=Je(r,n);return a||((a=y(e,()=>n(t,r.value))).handler=n,e.on(r,null,a)),e}function Qe(e,t,r){r=Je(t,r);return r&&t._targets.remove(r),e}M.prototype={constructor:M,restart:function(e,t,r){if("function"!=typeof e)throw new TypeError("callback is not a function");r=(null==r?I():+r)+(null==t?0:+t),this._next||S===this||(S?S._next=this:E=this,S=this),this._call=e,this._time=r,P()},stop:function(){this._call&&(this._call=null,this._time=1/0,P())}},o.inherits(Ye,c.Dataflow,{async evaluate(e,t,r){if(await c.Dataflow.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,$(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(e){this.error(e)}return r&&c.asyncCallback(this,r),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){return arguments.length?((e=null!=e?e+"":null)!==this._desc&&r(this._el,this._desc=e),this):this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,r){e=N(this,e);return 1===arguments.length?e.value:this.update(e,t,r)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",me(e)):me(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(l.renderModule(e)||o.error("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(c.Dataflow.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(N(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:Re,addEventListener(e,t,r){let n=t;return r&&!1===r.trap||((n=y(this,t)).raw=t),this._handler.on(e,n),this},removeEventListener(e,t){for(var r,n,a=this._handler.handlers(e),i=a.length;0<=--i;)if(n=a[i].type,r=a[i].handler,e===n&&(t===r||t===r.raw)){this._handler.off(n,r);break}return this},addResizeListener(e){var t=this._resizeListeners;return t.includes(e)||t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,e=t.indexOf(e);return 0<=e&&t.splice(e,1),this},addSignalListener(e,t){return Ze(this,e,N(this,e),t)},removeSignalListener(e,t){return Qe(this,N(this,e),t)},addDataListener(e,t){return Ze(this,e,n(this,e).values,t)},removeDataListener(e,t){return Qe(this,n(this,e).values,t)},globalCursor(e){var t;return arguments.length?(this._globalCursor!==!!e&&(t=i(this,null),this._globalCursor=!!e,t)&&i(this,t),this):this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:Ge,events:Z,finalize:ee,hover:X,data:V,change:a,insert:W,remove:q,scale:Ee,initialize:ge,toImageURL:_e,toCanvas:Te,toSVG:be,getState:Ie,setState:Ne,_watchPixelRatio:Ke}),e.View=Ye}}return nd.exports}var _d,yd,Td,bd={exports:{}},vd={exports:{}};function Ed(){if(!_d){_d=1;var e=vd.exports;{const s="view",h="[",g="]",m="{",_="}",y=":",l=",",T="@",c=">",b=/[[\]{}]/,v={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let u,n;function t(e,t,r){return u=t||s,n=r||v,a(e.trim()).map(i)}function d(e){return n[e]}function f(e,t,r,n,a){var i=e.length;let o=0,s;for(;t<i;++t){if(s=e[t],!o&&s===r)return t;a&&0<=a.indexOf(s)?--o:n&&0<=n.indexOf(s)&&++o}return t}function a(e){var t=[],r=e.length;let n=0,a=0;for(;a<r;)a=f(e,a,l,h+m,g+_),t.push(e.substring(n,a).trim()),n=++a;if(0===t.length)throw"Empty event selector: "+e;return t}function i(e){return("["===e[0]?r:o)(e)}function r(e){var t=e.length;let r,n;if((r=f(e,1,g,h,g))===t)throw"Empty between selector: "+e;if(2!==(n=a(e.substring(1,r))).length)throw"Between selector must have two elements: "+e;if((e=e.slice(r+1).trim())[0]!==c)throw"Expected '>' after between selector: "+e;n=n.map(i);t=i(e.slice(1).trim());return t.between?{between:n,stream:t}:(t.between=n,t)}function o(t){var e={source:u},r=[];let n=[0,0],a=0,i=0,o=t.length,s=0,l,c;if(t[o-1]===_){if(!(0<=(s=t.lastIndexOf(m))))throw"Unmatched right brace: "+t;try{n=p(t.substring(s+1,o-1))}catch(e){throw"Invalid throttle specification: "+t}t=t.slice(0,s).trim(),o=t.length,s=0}if(!o)throw t;if(t[0]===T&&(a=++s),(l=f(t,s,y))<o&&(r.push(t.substring(i,l).trim()),i=s=++l),(s=f(t,s,h))===o)r.push(t.substring(i,o).trim());else if(r.push(t.substring(i,s).trim()),c=[],(i=++s)===o)throw"Unmatched left bracket: "+t;for(;s<o;){if((s=f(t,s,g))===o)throw"Unmatched left bracket: "+t;if(c.push(t.substring(i,s).trim()),s<o-1&&t[++s]!==h)throw"Expected left bracket: "+t;i=++s}if(!(o=r.length)||b.test(r[o-1]))throw"Invalid event selector: "+t;return 1<o?(e.type=r[1],a?e.markname=r[0].slice(1):d(r[0])?e.marktype=r[0]:e.source=r[0]):e.type=r[0],"!"===e.type.slice(-1)&&(e.consume=!0,e.type=e.type.slice(0,-1)),null!=c&&(e.filter=c),n[0]&&(e.throttle=n[0]),n[1]&&(e.debounce=n[1]),e}function p(t){var e=t.split(l);if(!t.length||2<e.length)throw t;return e.map(e=>{e=+e;if(e!=e)throw t;return e})}e.parseSelector=t}}return vd.exports}function Sd(){if(!yd){yd=1;var e=bd.exports;{var y=jo(),c=dd(),B=Ed(),i=Su(),j=su();function H(e){return y.isObject(e)?e:{type:e||"pad"}}const lr=e=>+e||0,cr=e=>({top:e,bottom:e,left:e,right:e});function G(e){return y.isObject(e)?e.signal?e:{top:lr(e.top),bottom:lr(e.bottom),left:lr(e.left),right:lr(e.right)}:cr(+e||0)}const k=e=>y.isObject(e)&&!y.isArray(e)?y.extend({},e):{value:e};function V(e,t,r,n){null!=r&&(y.isObject(r)&&!y.isArray(r)||y.isArray(r)&&r.length&&y.isObject(r[0])?e.update[t]=r:e[n||"enter"][t]={value:r})}function S(e,t,r){for(const n in t)V(e,n,t[n]);for(const a in r)V(e,a,r[a],"update")}function A(e,t,r){for(const n in t)r&&y.hasOwnProperty(r,n)||(e[n]=y.extend(e[n]||{},t[n]));return e}function u(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const ur="mark",dr="frame",fr="scope",pr="axis",hr="axis-domain",gr="axis-label",mr="axis-title",_r="legend",yr="legend-entry",Tr="legend-label",br="legend-symbol",vr="legend-title",Er="title",Sr="title-text",Ar="title-subtitle";function W(n,e,t,r,a){const i={},o={};let s,l,c;for(l in l="lineBreak","text"!==e||null==a[l]||u(l,n)||q(i,l,a[l]),"legend"!=t&&!String(t).startsWith("axis")||(t=null),c=t===dr?a.group:t===ur?y.extend({},a.mark,a[e]):null)u(l,n)||("fill"===l||"stroke"===l)&&(u("fill",n)||u("stroke",n))||q(i,l,c[l]);for(l in y.array(r).forEach(e=>{var t=a.style&&a.style[e];for(const r in t)u(r,n)||q(i,r,t[r])}),n=y.extend({},n),i)(c=i[l]).signal?(s=s||{})[l]=c:o[l]=c;return n.enter=y.extend(o,n.enter),s&&(n.update=y.extend(s,n.update)),n}function q(e,t,r){e[t]=r&&r.signal?{signal:r.signal}:{value:r}}const Or=e=>y.isString(e)?y.stringValue(e):e.signal?`(${e.signal})`:K(e);function $(e){if(null!=e.gradient)return n(e);let t=e.signal?`(${e.signal})`:e.color?r(e.color):null!=e.field?K(e.field):void 0!==e.value?y.stringValue(e.value):void 0;return void 0===(t=null!=e.scale?J(e,t):t)&&(t=null),null!=e.exponent&&(t=`pow(${t},${z(e.exponent)})`),null!=e.mult&&(t+="*"+z(e.mult)),null!=e.offset&&(t+="+"+z(e.offset)),t=e.round?`round(${t})`:t}const Cr=(e,t,r,n)=>`(${e}(${[t,r,n].map($).join(",")})+'')`;function r(e){return e.c?Cr("hcl",e.h,e.c,e.l):e.h||e.s?Cr("hsl",e.h,e.s,e.l):e.l||e.a?Cr("lab",e.l,e.a,e.b):e.r||e.g||e.b?Cr("rgb",e.r,e.g,e.b):null}function n(e){for(var t=[e.start,e.stop,e.count].map(e=>null==e?null:y.stringValue(e));t.length&&null==y.peek(t);)t.pop();return t.unshift(Or(e.gradient)),`gradient(${t.join(",")})`}function z(e){return y.isObject(e)?"("+$(e)+")":e}function K(e){return Y(y.isObject(e)?e:{datum:e})}function Y(e){let t,r,n;if(e.signal)t="datum",n=e.signal;else if(e.group||e.parent){for(r=Math.max(1,e.level||1),t="item";0<r--;)t+=".mark.group";e.parent?(n=e.parent,t+=".datum"):n=e.group}else e.datum?(t="datum",n=e.datum):y.error("Invalid field reference: "+y.stringValue(e));return e.signal||(n=y.isString(n)?y.splitAccessPath(n).map(y.stringValue).join("]["):Y(n)),t+"["+n+"]"}function J(e,t){var r=Or(e.scale);return null!=e.range?t=`lerp(_range(${r}), ${+e.range})`:(void 0!==t&&(t=`_scale(${r}, ${t})`),null==(t=e.band&&(t=(t?t+"+":"")+`_bandwidth(${r})`+(1==+e.band?"":"*"+z(e.band)),e.extra)?`(datum.extra ? _scale(${r}, datum.extra.value) : ${t})`:t)&&(t="0")),t}function Z(e){let r="";return e.forEach(e=>{var t=$(e);r+=e.test?`(${e.test})?${t}:`:t}),":"===y.peek(r)&&(r+="null"),r}function Q(e,t,r,n,a,i){var o={};(i=i||{}).encoders={$encode:o};for(const s in e=W(e,t,r,n,a.config))o[s]=X(e[s],t,i,a);return i}function X(e,t,r,n){var a={},i={};for(const o in e)null!=e[o]&&(a[o]=te(ee(e[o]),n,r,i));return{$expr:{marktype:t,channels:a},$fields:Object.keys(i),$output:Object.keys(e)}}function ee(e){return(y.isArray(e)?Z:$)(e)}function te(e,t,r,n){e=c.parseExpression(e,t);return e.$fields.forEach(e=>n[e]=1),y.extend(r,e.$params),e.$expr}const kr="outer",wr=["value","update","init","react","bind"];function re(e,t){y.error(e+' for "outer" push: '+y.stringValue(t))}function ne(t,e){var r,n=t.name;t.push===kr?(e.signals[n]||re("No prior signal definition",n),wr.forEach(e=>{void 0!==t[e]&&re("Invalid property ",e)})):(r=e.addSignal(n,t.value),!1===t.react&&(r.react=!1),t.bind&&e.addBinding(n,t.bind))}function ae(e,t,r,n){this.id=-1,this.type=e,this.value=t,this.params=r,n&&(this.parent=n)}function ie(e,t,r,n){return new ae(e,t,r,n)}function oe(e,t){return ie("operator",e,t)}function T(e){var t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function se(e,t){return t?{$field:e,$name:t}:{$field:e}}const Rr=se("key");function le(e,t){return{$compare:e,$order:t}}function ce(e,t){e={$key:e};return t&&(e.$flat=!0),e}const Ir="descending";function ue(e){return y.isObject(e)?(e.order===Ir?"-":"+")+de(e.op,e.field):""}function de(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const Mr="scope",Pr="view";function f(e){return e&&e.signal}function fe(e){return e&&e.expr}function pe(e){if(f(e))return 1;if(y.isObject(e))for(const t in e)if(pe(e[t]))return 1}function g(e,t){return null!=e?e:t}function b(e){return e&&e.signal||e}const Nr="timer";function o(e,t){return(e.merge?ge:e.stream?me:e.type?_e:y.error("Invalid stream specification: "+y.stringValue(e)))(e,t)}function he(e){return e!==Mr&&e||Pr}function ge(e,t){e=ye({merge:e.merge.map(e=>o(e,t))},e,t);return t.addStream(e).id}function me(e,t){e=ye({stream:o(e.stream,t)},e,t);return t.addStream(e).id}function _e(e,t){let r;e.type===Nr?(r=t.event(Nr,e.throttle),e={between:e.between,filter:e.filter}):r=t.event(he(e.source),e.type);e=ye({stream:r},e,t);return 1===Object.keys(e).length?r:t.addStream(e).id}function ye(e,t,r){let n=t.between;return n&&(2!==n.length&&y.error('Stream "between" parameter must have 2 entries: '+y.stringValue(t)),e.between=[o(n[0],r),o(n[1],r)]),n=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&n.push(Te(t.marktype,t.markname,t.markrole)),t.source===Mr&&n.push("inScope(event.item)"),n.length&&(e.filter=c.parseExpression("("+n.join(")&&(")+")",r).$expr),null!=(n=t.throttle)&&(e.throttle=+n),null!=(n=t.debounce)&&(e.debounce=+n),t.consume&&(e.consume=!0),e}function Te(e,t,r){var n="event.item";return n+(e&&"*"!==e?"&&"+n+".mark.marktype==='"+e+"'":"")+(r?"&&"+n+".mark.role==='"+r+"'":"")+(t?"&&"+n+".mark.name==='"+t+"'":"")}const Dr={code:"_.$value",ast:{type:"Identifier",value:"value"}};function be(e,t,r){const n=e.encode,a={target:r};let i=e.events,o=e.update,s=[];i||y.error("Signal update missing events specification."),y.isString(i)&&(i=B.parseSelector(i,t.isSubscope()?Mr:Pr)),i=y.array(i).filter(e=>e.signal||e.scale?(s.push(e),0):1),1<s.length&&(s=[Ee(s)]),i.length&&s.push(1<i.length?{merge:i}:i[0]),null!=n&&(o&&y.error("Signal encode and update are mutually exclusive."),o="encode(item(),"+y.stringValue(n)+")"),a.update=y.isString(o)?c.parseExpression(o,t):null!=o.expr?c.parseExpression(o.expr,t):null!=o.value?o.value:null!=o.signal?{$expr:Dr,$params:{$value:t.signalRef(o.signal)}}:y.error("Invalid signal update specification."),e.force&&(a.options={force:!0}),s.forEach(e=>t.addUpdate(y.extend(ve(e,t),a)))}function ve(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):o(e,t)}}function Ee(e){return{signal:"["+e.map(e=>e.scale?'scale("'+e.scale+'")':e.signal)+"]"}}function Se(e,t){const r=t.getSignal(e.name);let n=e.update;e.init&&(n?y.error("Signals can not include both init and update expressions."):(n=e.init,r.initonly=!0)),n&&(n=c.parseExpression(n,t),r.update=n.$expr,r.params=n.$params),e.on&&e.on.forEach(e=>be(e,t,r.id))}const t=n=>(e,t,r)=>ie(n,t,e||void 0,r),xr=t("aggregate"),Lr=t("axisticks"),Fr=t("bound"),E=t("collect"),Ur=t("compare"),Br=t("datajoin"),jr=t("encode"),Hr=t("expression"),Gr=t("facet"),Vr=t("field"),Wr=t("key"),qr=t("legendentries"),$r=t("load"),zr=t("mark"),Kr=t("multiextent"),Yr=t("multivalues"),Jr=t("overlap"),Zr=t("params"),Qr=t("prefacet"),Xr=t("projection"),en=t("proxy"),tn=t("relay"),rn=t("render"),nn=t("scale"),w=t("sieve"),an=t("sortitems"),on=t("viewlayout"),sn=t("values");let a=0;const ln={min:"min",max:"max",count:"sum"};function Ae(e,t){var r=e.type||"linear";i.isValidScaleType(r)||y.error("Unrecognized scale type: "+y.stringValue(r)),t.addScale(e.name,{type:r,domain:void 0})}function Oe(e,t){var r=t.getScale(e.name).params;let n;for(n in r.domain=we(e.domain,e,t),null!=e.range&&(r.range=je(e,t,r)),null!=e.interpolate&&Be(e.interpolate,r),null!=e.nice&&(r.nice=Ue(e.nice,t)),null!=e.bins&&(r.bins=Fe(e.bins,t)),e)y.hasOwnProperty(r,n)||"name"===n||(r[n]=s(e[n],t))}function s(e,t){return y.isObject(e)?e.signal?t.signalRef(e.signal):y.error("Unsupported object: "+y.stringValue(e)):e}function Ce(e,t){return e.signal?t.signalRef(e.signal):e.map(e=>s(e,t))}function ke(e){y.error("Can not find data set: "+y.stringValue(e))}function we(e,t,r){if(e)return e.signal?r.signalRef(e.signal):(y.isArray(e)?Re:e.fields?Me:Ie)(e,t,r);null==t.domainMin&&null==t.domainMax||y.error("No scale domain defined for domainMin/domainMax to override.")}function Re(e,t,r){return e.map(e=>s(e,r))}function Ie(e,t,r){var n=r.getData(e.data);return n||ke(e.data),i.isDiscrete(t.type)?n.valuesRef(r,e.field,De(e.sort,!1)):i.isQuantile(t.type)?n.domainRef(r,e.field):n.extentRef(r,e.field)}function Me(e,t,r){const n=e.data,a=e.fields.reduce((e,t)=>(t=y.isString(t)?{data:n,field:t}:y.isArray(t)||t.signal?Pe(t,r):t,e.push(t),e),[]);return(i.isDiscrete(t.type)?Ne:i.isQuantile(t.type)?xe:Le)(e,r,a)}function Pe(e,t){var r="_:vega:_"+a++,n=E({});return y.isArray(e)?n.value={$ingest:e}:e.signal&&(e="setdata("+y.stringValue(r)+","+e.signal+")",n.params.input=t.signalRef(e)),t.addDataPipeline(r,[n,w({})]),{data:r,field:"data"}}function Ne(e,r,t){const n=De(e.sort,!0);let a,i;e=t.map(e=>{var t=r.getData(e.data);return t||ke(e.data),t.countsRef(r,e.field,n)}),t={groupby:Rr,pulse:e},n&&(a=n.op||"count",i=n.field?de(a,n.field):"count",t.ops=[ln[a]],t.fields=[r.fieldRef(i)],t.as=[i]),a=r.add(xr(t)),e=r.add(E({pulse:T(a)}));return i=r.add(sn({field:Rr,sort:r.sortRef(n),pulse:T(e)})),T(i)}function De(e,t){return e&&(e.field||e.op?e.field||"count"===e.op?t&&e.field&&e.op&&!ln[e.op]&&y.error("Multiple domain scales can not be sorted using "+e.op):y.error("No field provided for sort aggregate op: "+e.op):y.isObject(e)?e.field="key":e={field:"key"}),e}function xe(e,r,t){t=t.map(e=>{var t=r.getData(e.data);return t||ke(e.data),t.domainRef(r,e.field)});return T(r.add(Yr({values:t})))}function Le(e,r,t){t=t.map(e=>{var t=r.getData(e.data);return t||ke(e.data),t.extentRef(r,e.field)});return T(r.add(Kr({extents:t})))}function Fe(e,t){return e.signal||y.isArray(e)?Ce(e,t):t.objectProperty(e)}function Ue(e,t){return e.signal?t.signalRef(e.signal):y.isObject(e)?{interval:s(e.interval),step:s(e.step)}:s(e)}function Be(e,t){t.interpolate=s(e.type||e),null!=e.gamma&&(t.interpolateGamma=s(e.gamma))}function je(e,t,r){var n=t.config.range;let a=e.range;if(a.signal)return t.signalRef(a.signal);if(y.isString(a)){if(n&&y.hasOwnProperty(n,a))return je(e=y.extend({},e,{range:n[a]}),t,r);"width"===a?a=[0,{signal:"width"}]:"height"===a?a=i.isDiscrete(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:y.error("Unrecognized scale range value: "+y.stringValue(a))}else{if(a.scheme)return r.scheme=(y.isArray(a.scheme)?Ce:s)(a.scheme,t),a.extent&&(r.schemeExtent=Ce(a.extent,t)),void(a.count&&(r.schemeCount=s(a.count,t)));if(a.step)return void(r.rangeStep=s(a.step,t));if(i.isDiscrete(e.type)&&!y.isArray(a))return we(a,e,t);y.isArray(a)||y.error("Unsupported range type: "+y.stringValue(a))}return a.map(e=>(y.isArray(e)?Ce:s)(e,t))}function He(e,t){var r=t.config.projection||{},n={};for(const a in e)"name"!==a&&(n[a]=Ge(e[a],a,t));for(const i in r)null==n[i]&&(n[i]=Ge(r[i],i,t));t.addProjection(e.name,n)}function Ge(e,t,r){return y.isArray(e)?e.map(e=>Ge(e,t,r)):y.isObject(e)?e.signal?r.signalRef(e.signal):"fit"===t?e:y.error("Unsupported parameter object: "+y.stringValue(e)):e}const h="top",l="left",m="right",_="bottom",cn="start",un="end",dn="perc",R="value",I="guide-label",fn="guide-title",pn="group-title",hn="group-subtitle",gn="symbol",mn="gradient",_n="discrete",yn=["size","shape","fill","stroke","strokeWidth","strokeDash","opacity"],M={name:1,style:1,interactive:1},P={value:0},N={value:1},Tn="group",D="text";function Ve(e){return e.type=Tn,e.interactive=e.interactive||!1,e}function O(r,n){const e=(e,t)=>g(r[e],g(n[e],t));return e.isVertical=e=>"vertical"===g(r.direction,n.direction||(e?n.symbolDirection:n.gradientDirection)),e.gradientLength=()=>g(r.gradientLength,n.gradientLength||n.gradientWidth),e.gradientThickness=()=>g(r.gradientThickness,n.gradientThickness||n.gradientHeight),e.entryColumns=()=>g(r.columns,g(n.columns,+e.isVertical(!0))),e}function We(e,t){t=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return t&&t.signal?t:t?t.value:null}function qe(e,t,r){t=t.config.style[r];return t&&t[e]}function $e(e,t,r){return`item.anchor === '${cn}' ? ${e} : item.anchor === '${un}' ? ${t} : `+r}const bn=$e(y.stringValue(l),y.stringValue(m),y.stringValue("center"));function ze(e){var t=e("tickBand");let r=e("tickOffset"),n,a;return t?t.signal?(n={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},a={signal:`(${t.signal}) === 'extent'`},y.isObject(r)||(r={signal:`(${t.signal}) === 'extent' ? 0 : `+r})):"extent"===t?(n=1,a=!0,r=0):(n=.5,a=!1):(n=e("bandPosition"),a=e("tickExtra")),{extra:a,band:n,offset:r}}function Ke(e,t){return t?e?y.isObject(e)?Object.assign({},e,{offset:Ke(e.offset,t)}):{value:e,offset:t}:t:e}function C(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=A(e.encode,t,M)):e.interactive=!1,e}function Ye(e,t,r,n){var e=O(e,r),r=e.isVertical(),a=e.gradientThickness(),i=e.gradientLength();let o,s,l,c,u;u=r?(s=[0,1],l=[0,0],c=a,i):(s=[0,0],l=[1,0],c=i,a);r={enter:o={opacity:P,x:P,y:P,width:k(c),height:k(u)},update:y.extend({},o,{opacity:N,fill:{gradient:t,start:s,stop:l}}),exit:{opacity:P}};return S(r,{stroke:e("gradientStrokeColor"),strokeWidth:e("gradientStrokeWidth")},{opacity:e("gradientOpacity")}),C({type:"rect",role:"legend-gradient",encode:r},n)}function Je(e,t,r,n,a){var e=O(e,r),r=e.isVertical(),i=e.gradientThickness(),o=e.gradientLength();let s,l,c,u,d="";r?(s="y",c="y2",l="x",u="width",d="1-"):(s="x",c="x2",l="y",u="height");r={opacity:P,fill:{scale:t,field:R}},r[s]={signal:d+"datum."+dn,mult:o},r[l]=P,r[c]={signal:d+"datum.perc2",mult:o},r[u]=k(i),t={enter:r,update:y.extend({},r,{opacity:N}),exit:{opacity:P}};return S(t,{stroke:e("gradientStrokeColor"),strokeWidth:e("gradientStrokeWidth")},{opacity:e("gradientOpacity")}),C({type:"rect",role:"legend-band",key:R,from:a,encode:t},n)}const vn=`datum.perc<=0?"${l}":datum.perc>=1?"${m}":"center"`,En=`datum.perc<=0?"${_}":datum.perc>=1?"${h}":"middle"`;function Ze(e,t,r,n){var a=O(e,t),i=a.isVertical(),o=k(a.gradientThickness()),s=a.gradientLength();let l=a("labelOverlap"),c,u,d,f,p="";var h={enter:c={opacity:P},update:u={opacity:N,text:{field:"label"}},exit:{opacity:P}};return S(h,{fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontStyle:a("labelFontStyle"),fontWeight:a("labelFontWeight"),limit:g(e.labelLimit,t.gradientLabelLimit)}),i?(c.align={value:"left"},c.baseline=u.baseline={signal:En},d="y",f="x",p="1-"):(c.align=u.align={signal:vn},c.baseline={value:"top"},d="x",f="y"),c[d]=u[d]={signal:p+"datum."+dn,mult:s},(c[f]=u[f]=o).offset=g(e.labelOffset,t.gradientLabelOffset)||0,l=l?{separation:a("labelSeparation"),method:l,order:"datum.index"}:void 0,C({type:D,role:Tr,style:I,key:R,from:n,encode:h,overlap:l},r)}function Qe(t,e,r,n,a){var i=O(t,e),o=r.entries,s=!(!o||!o.interactive),l=o?o.name:void 0,c=i("clipHeight"),u=i("symbolOffset"),d={data:"value"},f=`(${a}) ? datum.offset : datum.size`,p=c?k(c):{field:"size"},h="datum.index",g=`max(1, ${a})`;let m,_,y,T,b,v=(p.mult=.5,m={enter:_={opacity:P,x:{signal:f,mult:.5,offset:u},y:p},update:y={opacity:N,x:_.x,y:_.y},exit:{opacity:P}},null),E=null;t.fill||(v=e.symbolBaseFillColor,E=e.symbolBaseStrokeColor),S(m,{fill:i("symbolFillColor",v),shape:i("symbolType"),size:i("symbolSize"),stroke:i("symbolStrokeColor",E),strokeDash:i("symbolDash"),strokeDashOffset:i("symbolDashOffset"),strokeWidth:i("symbolStrokeWidth")},{opacity:i("symbolOpacity")}),yn.forEach(e=>{t[e]&&(y[e]=_[e]={scale:t[e],field:R})});e=C({type:"symbol",role:br,key:R,from:d,clip:!!c||void 0,encode:m},r.symbols),u=k(u),u.offset=i("labelOffset"),S(m={enter:_={opacity:P,x:{signal:f,offset:u},y:p},update:y={opacity:N,text:{field:"label"},x:_.x,y:_.y},exit:{opacity:P}},{align:i("labelAlign"),baseline:i("labelBaseline"),fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:i("labelLimit")}),f=C({type:D,role:Tr,style:I,key:R,from:d,encode:m},r.labels);return m={enter:{noBound:{value:!c},width:P,height:c?k(c):P,opacity:P},exit:{opacity:P},update:y={opacity:N,row:{signal:null},column:{signal:null}}},b=i.isVertical(!0)?(T=`ceil(item.mark.items.length / ${g})`,y.row.signal=h+"%"+T,y.column.signal=`floor(${h} / ${T})`,{field:["row",h]}):(y.row.signal=`floor(${h} / ${g})`,y.column.signal=h+" % "+g,{field:h}),y.column.signal=`(${a})?${y.column.signal}:`+h,n={facet:{data:n,name:"value",groupby:"index"}},Ve({role:fr,from:n,encode:A(m,o,M),marks:[e,f],name:l,interactive:s,sort:b})}function Xe(e,t){e=O(e,t);return{align:e("gridAlign"),columns:e.entryColumns(),center:{row:!0,column:!1},padding:{row:e("rowPadding"),column:e("columnPadding")}}}const Sn='item.orient === "left"',An='item.orient === "right"',On=`(${Sn} || ${An})`,Cn=$e('"top"','"bottom"','"middle"'),kn=$e('"right"','"left"','"center"'),wn=`datum.vgrad && ${An} ? (${kn}) : (${On} && !(datum.vgrad && ${Sn})) ? "left" : `+bn,Rn=On+` ? (datum.vgrad ? (${An} ? "bottom" : "top") : ${Cn}) : "top"`;function et(e,t,r,n){var t=O(e,t),a={enter:{opacity:P},update:{opacity:N,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:P}};return S(a,{orient:t("titleOrient"),_anchor:t("titleAnchor"),anchor:{signal:'item._anchor || ((item.orient === "left" || item.orient === "right") ? "middle" : "start")'},angle:{signal:'datum.vgrad && (item.orient === "left" || item.orient === "right") ? (item.orient === "left" ? -90 : 90) : 0'},align:{signal:wn},baseline:{signal:Rn},text:e.title,fill:t("titleColor"),fillOpacity:t("titleOpacity"),font:t("titleFont"),fontSize:t("titleFontSize"),fontStyle:t("titleFontStyle"),fontWeight:t("titleFontWeight"),limit:t("titleLimit"),lineHeight:t("titleLineHeight")},{align:t("titleAlign"),baseline:t("titleBaseline")}),C({type:D,role:vr,style:fn,from:n,encode:a},r)}function tt(e,t){let r;return y.isObject(e)&&(e.signal?r=e.signal:e.path?r="pathShape("+rt(e.path)+")":e.sphere&&(r="geoShape("+rt(e.sphere)+', {type: "Sphere"})')),r?t.signalRef(r):!!e}function rt(e){return y.isObject(e)&&e.signal?e.signal:y.stringValue(e)}function nt(e){var t=e.role||"";return t.startsWith("axis")||t.startsWith("legend")||t.startsWith("title")?t:e.type===Tn?fr:t||ur}function at(e){return{marktype:e.type,name:e.name||void 0,role:e.role||nt(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function it(e,t){return e&&e.signal?t.signalRef(e.signal):!1!==e}function ot(e,t){var r=j.definition(e.type),n=(r||y.error("Unrecognized transform type: "+y.stringValue(e.type)),ie(r.type.toLowerCase(),null,st(r,e,t)));return e.signal&&t.addSignal(e.signal,t.proxy(n)),n.metadata=r.metadata||{},n}function st(t,r,n){var a={},i=t.params.length;for(let e=0;e<i;++e){var o=t.params[e];a[o.name]=lt(o,r,n)}return a}function lt(t,e,r){var n=t.type,a=e[t.name];return"index"===n?ut(0,e,r):void 0!==a?"param"===n?dt(t,e,r):"projection"===n?r.projectionRef(e[t.name]):t.array&&!f(a)?a.map(e=>ct(t,e,r)):ct(t,a,r):void(t.required&&y.error("Missing required "+y.stringValue(e.type)+" parameter: "+y.stringValue(t.name)))}function ct(e,t,r){var n=e.type;return f(t)?Nn(n)?y.error("Expression references can not be signals."):Dn(n)?r.fieldRef(t):xn(n)?r.compareRef(t):r.signalRef(t.signal):(e=e.expr||Dn(n))&&In(t)?r.exprRef(t.expr,t.as):e&&Mn(t)?se(t.field,t.as):Nn(n)?c.parseExpression(t,r):Pn(n)?T(r.getData(t).values):Dn(n)?se(t):xn(n)?r.compareRef(t):t}function ut(e,t,r){return y.isString(t.from)||y.error('Lookup "from" parameter must be a string literal.'),r.getData(t.from).lookupRef(r,t.key)}function dt(t,e,r){e=e[t.name];return t.array?(y.isArray(e)||y.error("Expected an array of sub-parameters. Instead: "+y.stringValue(e)),e.map(e=>ft(t,e,r))):ft(t,e,r)}function ft(t,r,e){var n=t.params.length;let a;for(let e=0;e<n;++e){for(const o in(a=t.params[e]).key)if(a.key[o]!==r[o]){a=null;break}if(a)break}a||y.error("Unsupported parameter: "+y.stringValue(r));var i=y.extend(st(a,r,e),a.key);return T(e.add(Zr(i)))}const In=e=>e&&e.expr,Mn=e=>e&&e.field,Pn=e=>"data"===e,Nn=e=>"expr"===e,Dn=e=>"field"===e,xn=e=>"compare"===e;function pt(e,t,r){let n,a,i,o,s;return e?(n=e.facet)&&(t||y.error("Only group marks can be faceted."),null!=n.field?o=s=ht(n,r):(e.data?s=T(r.getData(e.data).aggregate):((i=ot(y.extend({type:"aggregate",groupby:y.array(n.groupby)},n.aggregate),r)).params.key=r.keyRef(n.groupby),i.params.pulse=ht(n,r),o=s=T(r.add(i))),a=r.keyRef(n.groupby,!0))):o=T(r.add(E(null,[{}]))),o=o||ht(e,r),{key:a,pulse:o,parent:s}}function ht(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:T(t.getData(e.data).output)}function v(e,t,r,n,a){this.scope=e,this.input=t,this.output=r,this.values=n,this.aggregate=a,this.index={}}function gt(e){return y.isString(e)?e:null}function mt(e,r,t){var n,a=de(t.op,t.field);if(r.ops){for(let e=0,t=r.as.length;e<t;++e)if(r.as[e]===a)return}else r.ops=["count"],r.fields=[null],r.as=["count"];t.op&&(r.ops.push((n=t.op.signal)?e.signalRef(n):t.op),r.fields.push(e.fieldRef(t.field)),r.as.push(a))}function _t(e,t,r,n,a,i,o){var s,r=t[r]||(t[r]={}),l=ue(i);let c=gt(a),u,d;return null!=c&&(e=t.scope,c+=l?"|"+l:"",u=r[c]),u||(s=i?{field:Rr,pulse:t.countsRef(e,a,i)}:{field:e.fieldRef(a),pulse:T(t.output)},l&&(s.sort=e.sortRef(i)),d=e.add(ie(n,void 0,s)),o&&(t.index[a]=d),u=T(d),null!=c&&(r[c]=u)),u}function yt(e,t,r){var n=e.from.facet,a=n.name,i=ht(n,t);let o;n.name||y.error("Facet must have a name: "+y.stringValue(n)),n.data||y.error("Facet must reference a data set: "+y.stringValue(n)),n.field?o=t.add(Qr({field:t.fieldRef(n.field),pulse:i})):n.groupby?o=t.add(Gr({key:t.keyRef(n.groupby),group:T(t.proxy(r.parent)),pulse:i})):y.error("Facet must specify groupby or field: "+y.stringValue(n));r=t.fork(),i=r.add(E()),n=r.add(w({pulse:T(i)}));r.addData(a,new v(r,i,i,n)),r.addSignal("parent",null),o.params.subflow={$subflow:r.parse(e).toRuntime()}}function Tt(e,t,r){r=t.add(Qr({pulse:r.pulse})),t=t.fork();t.add(w()),t.addSignal("parent",null),r.params.subflow={$subflow:t.parse(e).toRuntime()}}function bt(e,t,r){var n=e.remove,a=e.insert,i=e.toggle,o=e.modify,s=e.values,l=t.add(oe()),e="if("+e.trigger+',modify("'+r+'",'+[a,n,i,o,s].map(e=>null==e?"null":e).join(",")+"),0)",r=c.parseExpression(e,t);l.update=r.$expr,l.params=r.$params}function vt(e,r){var t=nt(e),n=e.type===Tn,a=e.from&&e.from.facet,i=e.overlap;let o=e.layout||t===fr||t===dr,s,l,c,u,d,f,p;var h=t===ur||o||a,g=pt(e.from,n,r),m=T(l=r.add(Br({key:g.key||(e.key?se(e.key):void 0),pulse:g.pulse,clean:!n}))),_=(l=c=r.add(E({pulse:m})),l=r.add(zr({markdef:at(e),interactive:it(e.interactive,r),clip:tt(e.clip,r),context:{$context:!0},groups:r.lookup(),parent:r.signals.parent?r.signalRef("parent"):null,index:r.markpath(),pulse:T(l)})),T(l)),t=((l=u=r.add(jr(Q(e.encode,e.type,t,e.style,r,{mod:!1,pulse:_})))).params.parent=r.encode(),e.transform&&e.transform.forEach(e=>{var e=ot(e,r),t=e.metadata;(t.generates||t.changes)&&y.error("Mark transforms should not generate new data."),t.nomod||(u.params.mod=!0),e.params.pulse=T(l),r.add(l=e)}),e.sort&&(l=r.add(an({sort:r.compareRef(e.sort),pulse:T(l)}))),T(l)),_=((a||o)&&(o=r.add(on({layout:r.objectProperty(e.layout),legends:r.legends,mark:_,pulse:t})),f=T(o)),r.add(Fr({mark:_,pulse:f||t}))),n=(p=T(_),n&&(h&&((s=r.operators).pop(),o)&&s.pop(),r.pushState(t,f||p,m),a?yt(e,r,g):h?Tt(e,r,g):r.parse(e),r.popState(),h)&&(o&&s.push(o),s.push(_)),i&&(p=Et(i,p,r)),r.add(rn({pulse:p}))),t=r.add(w({pulse:T(n)},void 0,r.parent()));null!=e.name&&(d=e.name,r.addData(d,new v(r,c,n,t)),e.on)&&e.on.forEach(e=>{(e.insert||e.remove||e.toggle)&&y.error("Marks only support modify triggers."),bt(e,r,d)})}function Et(e,t,r){var n=e.method,a=e.bound,i=e.separation,i={separation:f(i)?r.signalRef(i.signal):i,method:f(n)?r.signalRef(n.signal):n,pulse:t};return e.order&&(i.sort=r.compareRef({field:e.order})),a&&(n=a.tolerance,i.boundTolerance=f(n)?r.signalRef(n.signal):+n,i.boundScale=r.scaleRef(a.scale),i.boundOrient=a.orient),T(r.add(Jr(i)))}function St(t,e){const r=e.config.legend,n=t.encode||{},a=O(t,r),i=n.legend||{},o=i.name||void 0,s=i.interactive,l=i.style,c={};let u=0,d,f,p;yn.forEach(e=>t[e]?(c[e]=t[e],u=u||t[e]):0),u||y.error("Missing valid scale for legend.");var h=At(t,e.scaleType(u)),g={title:null!=t.title,scales:c,type:h,vgrad:"symbol"!==h&&a.isVertical()},m=T(e.add(E(null,[g]))),_=T(e.add(qr(f={type:h,scale:e.scaleRef(u),count:e.objectProperty(a("tickCount")),limit:e.property(a("symbolLimit")),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)})));return h===mn?(p=[Ye(t,u,r,n.gradient),Ze(t,r,n.labels,_)],f.count=f.count||e.signalRef(`max(2,2*floor((${b(a.gradientLength())})/100))`)):h===_n?p=[Je(t,u,r,n.gradient,_),Ze(t,r,n.labels,_)]:(d=Xe(t,r),p=[Qe(t,r,n,_,b(d.columns))],f.size=kt(t,e,p[0].marks)),p=[Ve({role:yr,from:m,encode:{enter:{x:{value:0},y:{value:0}}},marks:p,layout:d,interactive:s})],g.title&&p.push(et(t,r,n.title,m)),vt(Ve({role:_r,from:m,encode:A(Ct(a,t,r),i,M),marks:p,aria:a("aria"),description:a("description"),zindex:a("zindex"),name:o,interactive:s,style:l}),e)}function At(e,t){let r=e.type||gn;return(r=e.type||1!==Ot(e)||!e.fill&&!e.stroke?r:i.isContinuous(t)?mn:i.isDiscretizing(t)?_n:gn)!==mn?r:i.isDiscretizing(t)?_n:mn}function Ot(r){return yn.reduce((e,t)=>e+(r[t]?1:0),0)}function Ct(e,t,r){var n={enter:{},update:{}};return S(n,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:r.strokeWidth,strokeDash:r.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),n}function kt(e,t,r){var n=b(wt("size",e,r)),e=b(wt("strokeWidth",e,r)),r=b(Rt(r[1].encode,t,I));return c.parseExpression(`max(ceil(sqrt(${n})+${e}),${r})`,t)}function wt(e,t,r){return t[e]?`scale("${t[e]}",datum)`:We(e,r[0].encode)}function Rt(e,t,r){return We("fontSize",e)||qe("fontSize",t,r)}v.fromEntries=function(e,t){var r=t.length,n=t[r-1],a=t[r-2];let i=t[0],o=null,s=1;for(i&&"load"===i.type&&(i=t[1]),e.add(t[0]);s<r;++s)t[s].params.pulse=T(t[s-1]),e.add(t[s]),"aggregate"===t[s].type&&(o=t[s]);return new v(e,i,a,n,o)},v.prototype={countsRef(e,t,r){var n=this.counts||(this.counts={}),a=gt(t);let i,o,s;return null!=a&&(e=this.scope,i=n[a]),i?r&&r.field&&mt(e,i.agg.params,r):(s={groupby:e.fieldRef(t,"key"),pulse:T(this.output)},r&&r.field&&mt(e,s,r),o=e.add(xr(s)),i=e.add(E({pulse:T(o)})),i={agg:o,ref:T(i)},null!=a&&(n[a]=i)),i.ref},tuplesRef(){return T(this.values)},extentRef(e,t){return _t(e,this,"extent","extent",t,!1)},domainRef(e,t){return _t(e,this,"domain","values",t,!1)},valuesRef(e,t,r){return _t(e,this,"vals","values",t,r||!0)},lookupRef(e,t){return _t(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return _t(e,this,"indata","tupleindex",t,!0,!0)}};const Ln=`item.orient==="${l}"?-90:item.orient==="${m}"?90:0`;function It(e,t){var r=O(e=y.isString(e)?{text:e}:e,t.config.title),n=e.encode||{},a=n.group||{},i=a.name||void 0,o=a.interactive,s=a.style,l=[],c=T(t.add(E(null,[{}])));l.push(Nt(e,r,Mt(e),c)),e.subtitle&&l.push(Dt(e,r,n.subtitle,c)),vt(Ve({role:Er,from:c,encode:Pt(r,a),marks:l,aria:r("aria"),description:r("description"),zindex:r("zindex"),name:i,interactive:o,style:s}),t)}function Mt(e){var t=e.encode;return t&&t.title||y.extend({name:e.name,interactive:e.interactive,style:e.style},t)}function Pt(e,t){var r={enter:{},update:{}};return S(r,{orient:e("orient"),anchor:e("anchor"),align:{signal:bn},angle:{signal:Ln},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),A(r,t,M)}function Nt(e,t,r,n){var a={value:0},a={enter:{opacity:a},update:{opacity:{value:1}},exit:{opacity:a}};return S(a,{text:e.text,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),C({type:D,role:Sr,style:pn,from:n,encode:a},r)}function Dt(e,t,r,n){var a={value:0},a={enter:{opacity:a},update:{opacity:{value:1}},exit:{opacity:a}};return S(a,{text:e.subtitle,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),C({type:D,role:Ar,style:hn,from:n,encode:a},r)}function xt(t,r){const n=[];t.transform&&t.transform.forEach(e=>{n.push(ot(e,r))}),t.on&&t.on.forEach(e=>{bt(e,r,t.name)}),r.addDataPipeline(t.name,Lt(t,r,n))}function Lt(e,t,r){var n=[];let a=null,i=!1,o=!1,s,l,c,u,d;for(e.values?f(e.values)||pe(e.format)?(n.push(Ft(t,e)),n.push(a=p())):n.push(a=p({$ingest:e.values,$format:e.format})):e.url?pe(e.url)||pe(e.format)?(n.push(Ft(t,e)),n.push(a=p())):n.push(a=p({$request:e.url,$format:e.format})):e.source&&(a=s=y.array(e.source).map(e=>T(t.getData(e).output)),n.push(null)),l=0,c=r.length;l<c;++l)d=(u=r[l]).metadata,a||d.source||n.push(a=p()),n.push(u),d.generates&&(o=!0),d.modifies&&!o&&(i=!0),d.source?a=u:d.changes&&(a=null);return s&&(c=s.length-1,n[0]=tn({derive:i,pulse:c?s:s[0]}),i||c)&&n.splice(1,0,p()),a||n.push(p()),n.push(w({})),n}function p(e){e=E({},e);return e.metadata={source:!0},e}function Ft(e,t){return $r({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const Fn=e=>e===_||e===h,Un=(e,t,r)=>f(e)?Vn(e.signal,t,r):e===l||e===h?t:r,x=(e,t,r)=>f(e)?Hn(e.signal,t,r):Fn(e)?t:r,L=(e,t,r)=>f(e)?Gn(e.signal,t,r):Fn(e)?r:t,Bn=(e,t,r)=>f(e)?Wn(e.signal,t,r):e===h?{value:t}:{value:r},jn=(e,t,r)=>f(e)?qn(e.signal,t,r):e===m?{value:t}:{value:r},Hn=(e,t,r)=>$n(`${e} === '${h}' || ${e} === '${_}'`,t,r),Gn=(e,t,r)=>$n(`${e} !== '${h}' && ${e} !== '${_}'`,t,r),Vn=(e,t,r)=>Kn(`${e} === '${l}' || ${e} === '${h}'`,t,r),Wn=(e,t,r)=>Kn(`${e} === '${h}'`,t,r),qn=(e,t,r)=>Kn(`${e} === '${m}'`,t,r),$n=(e,t,r)=>(t=null!=t?k(t):t,r=null!=r?k(r):r,zn(t)&&zn(r)?{signal:e+` ? (${t=t?t.signal||y.stringValue(t.value):null}) : (${r=r?r.signal||y.stringValue(r.value):null})`}:[y.extend({test:e},t)].concat(r||[])),zn=e=>null==e||1===Object.keys(e).length,Kn=(e,t,r)=>({signal:`${e} ? (${F(t)}) : (${F(r)})`}),Yn=(e,t,r,n,a)=>({signal:(null!=n?`${e} === '${l}' ? (${F(n)}) : `:"")+(null!=r?`${e} === '${_}' ? (${F(r)}) : `:"")+(null!=a?`${e} === '${m}' ? (${F(a)}) : `:"")+(null!=t?`${e} === '${h}' ? (${F(t)}) : `:"")+"(null)"}),F=e=>f(e)?e.signal:null==e?null:y.stringValue(e),Jn=(e,t)=>0===t?0:f(e)?{signal:`(${e.signal}) * `+t}:{value:e*t},U=(e,t)=>{var r=e.signal;return r&&r.endsWith("(null)")?{signal:r.slice(0,-6)+t.signal}:e};function d(e,t,r,n){let a;if(t&&y.hasOwnProperty(t,e))return t[e];if(y.hasOwnProperty(r,e))return r[e];if(e.startsWith("title")){switch(e){case"titleColor":a="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":a=e[5].toLowerCase()+e.slice(6)}return n[fn][a]}if(e.startsWith("label")){switch(e){case"labelColor":a="fill";break;case"labelFont":case"labelFontSize":a=e[5].toLowerCase()+e.slice(6)}return n[I][a]}return null}function Ut(e){var t={};for(const r of e)if(r)for(const n in r)t[n]=1;return Object.keys(t)}function Bt(e,t){var r,n,a=t.config,i=a.style,o=a.axis,t="band"===t.scaleType(e.scale)&&a.axisBand,s=e.orient;if(f(s)){var e=Ut([a.axisX,a.axisY]),l=Ut([a.axisTop,a.axisBottom,a.axisLeft,a.axisRight]),c={};for(n of e)c[n]=x(s,d(n,a.axisX,o,i),d(n,a.axisY,o,i));r={};for(n of l)r[n]=Yn(s.signal,d(n,a.axisTop,o,i),d(n,a.axisBottom,o,i),d(n,a.axisLeft,o,i),d(n,a.axisRight,o,i))}else c=s===h||s===_?a.axisX:a.axisY,r=a["axis"+s[0].toUpperCase()+s.slice(1)];return c||r||t?y.extend({},o,c,r,t):o}function jt(e,t,r,n){var a,i,t=O(e,t),o=e.orient,s={enter:a={opacity:P},update:i={opacity:N},exit:{opacity:P}},t=(S(s,{stroke:t("domainColor"),strokeCap:t("domainCap"),strokeDash:t("domainDash"),strokeDashOffset:t("domainDashOffset"),strokeWidth:t("domainWidth"),strokeOpacity:t("domainOpacity")}),Ht(e,0)),e=Ht(e,1);return a.x=i.x=x(o,t,P),a.x2=i.x2=x(o,e),a.y=i.y=L(o,t,P),a.y2=i.y2=L(o,e),C({type:"rule",role:hr,from:n,encode:s},r)}function Ht(e,t){return{scale:e.scale,range:t}}function Gt(e,t,r,n,a){var i,o,s,t=O(e,t),l=e.orient,c=e.gridScale,u=Un(l,1,-1),d=Vt(e.offset,u),f={enter:i={opacity:P},update:s={opacity:N},exit:o={opacity:P}},e=(S(f,{stroke:t("gridColor"),strokeCap:t("gridCap"),strokeDash:t("gridDash"),strokeDashOffset:t("gridDashOffset"),strokeOpacity:t("gridOpacity"),strokeWidth:t("gridWidth")}),{scale:e.scale,field:R,band:a.band,extra:a.extra,offset:a.offset,round:t("tickRound")}),a=x(l,{signal:"height"},{signal:"width"}),t=c?{scale:c,range:0,mult:u,offset:d}:{value:0,offset:d},c=c?{scale:c,range:1,mult:u,offset:d}:y.extend(a,{mult:u,offset:d});return i.x=s.x=x(l,e,t),i.y=s.y=L(l,e,t),i.x2=s.x2=L(l,c),i.y2=s.y2=x(l,c),o.x=x(l,e),o.y=L(l,e),C({type:"rule",role:"axis-grid",key:R,from:n,encode:f},r)}function Vt(t,r){if(1!==r)if(y.isObject(t)){let e=t=y.extend({},t);for(;null!=e.mult;){if(!y.isObject(e.mult))return e.mult=f(r)?{signal:`(${e.mult}) * (${r.signal})`}:e.mult*r,t;e=e.mult=y.extend({},e.mult)}e.mult=r}else t=f(r)?{signal:`(${r.signal}) * (${t||0})`}:r*(t||0);return t}function Wt(e,t,r,n,a,i){var o,s,l,t=O(e,t),c=e.orient,u=Un(c,-1,1),d={enter:o={opacity:P},update:l={opacity:N},exit:s={opacity:P}},a=(S(d,{stroke:t("tickColor"),strokeCap:t("tickCap"),strokeDash:t("tickDash"),strokeDashOffset:t("tickDashOffset"),strokeOpacity:t("tickOpacity"),strokeWidth:t("tickWidth")}),k(a)),u=(a.mult=u,{scale:e.scale,field:R,band:i.band,extra:i.extra,offset:i.offset,round:t("tickRound")});return l.y=o.y=x(c,P,u),l.y2=o.y2=x(c,a),s.x=x(c,u),l.x=o.x=L(c,P,u),l.x2=o.x2=L(c,a),s.y=L(c,u),C({type:"rule",role:"axis-tick",key:R,from:n,encode:d},r)}function qt(e,t,r,n,a){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+r+","+n+","+a+")"}}function $t(e,t,r,n,a,i){var t=O(e,t),o=e.orient,e=e.scale,s=Un(o,-1,1),l=b(t("labelFlush")),c=b(t("labelFlushOffset")),u=t("labelAlign"),d=t("labelBaseline"),f=0===l||!!l,a=k(a),s=(a.mult=s,a.offset=k(t("labelPadding")||0),a.offset.mult=s,{scale:e,field:R,band:.5,offset:Ke(i.offset,t("labelOffset"))}),i=x(o,f?qt(e,l,'"left"','"right"','"center"'):{value:"center"},jn(o,"left","right")),p=x(o,Bn(o,"bottom","top"),f?qt(e,l,'"top"','"bottom"','"middle"'):{value:"middle"}),l=qt(e,l,`-(${c})`,c,0),f=f&&c,c={opacity:P,x:x(o,s,a),y:L(o,s,a)},a={enter:c,update:s={opacity:N,text:{field:"label"},x:c.x,y:c.y,align:i,baseline:p},exit:{opacity:P,x:c.x,y:c.y}},c=(S(a,{dx:!u&&f?x(o,l):null,dy:!d&&f?L(o,l):null}),S(a,{angle:t("labelAngle"),fill:t("labelColor"),fillOpacity:t("labelOpacity"),font:t("labelFont"),fontSize:t("labelFontSize"),fontWeight:t("labelFontWeight"),fontStyle:t("labelFontStyle"),limit:t("labelLimit"),lineHeight:t("labelLineHeight")},{align:u,baseline:d}),t("labelBound")),f=(f=t("labelOverlap"))||c?{separation:t("labelSeparation"),method:f,order:"datum.index",bound:c?{scale:e,orient:o,tolerance:c}:null}:void 0;return s.align!==i&&(s.align=U(s.align,i)),s.baseline!==p&&(s.baseline=U(s.baseline,p)),C({type:D,role:gr,style:I,key:R,from:n,encode:a,overlap:f},r)}function zt(e,t,r,n){var a,i,t=O(e,t),o=e.orient,s=Un(o,-1,1),l={enter:a={opacity:P,anchor:k(t("titleAnchor",null)),align:{signal:bn}},update:i=y.extend({},a,{opacity:N,text:k(e.title)}),exit:{opacity:P}},e={signal:`lerp(range("${e.scale}"), ${$e(0,1,.5)})`};return i.x=x(o,e),i.y=L(o,e),a.angle=x(o,P,Jn(s,90)),a.baseline=x(o,Bn(o,_,h),{value:_}),i.angle=a.angle,i.baseline=a.baseline,S(l,{fill:t("titleColor"),fillOpacity:t("titleOpacity"),font:t("titleFont"),fontSize:t("titleFontSize"),fontStyle:t("titleFontStyle"),fontWeight:t("titleFontWeight"),limit:t("titleLimit"),lineHeight:t("titleLineHeight")},{align:t("titleAlign"),angle:t("titleAngle"),baseline:t("titleBaseline")}),Kt(t,o,l,r),l.update.align=U(l.update.align,a.align),l.update.angle=U(l.update.angle,a.angle),l.update.baseline=U(l.update.baseline,a.baseline),C({type:D,role:mr,style:fn,from:n,encode:l},r)}function Kt(e,t,r,n){var a=(e,t)=>null!=e?(r.update[t]=U(k(e),r.update[t]),!1):!u(t,n),i=a(e("titleX"),"x"),a=a(e("titleY"),"y");r.enter.auto=a===i?k(a):x(t,k(a),k(i))}function Yt(e,t){var r=Bt(e,t),n=e.encode||{},a=n.axis||{},i=a.name||void 0,o=a.interactive,s=a.style,l=O(e,r),c=ze(l),u={scale:e.scale,ticks:!!l("ticks"),labels:!!l("labels"),grid:!!l("grid"),domain:!!l("domain"),title:null!=e.title},d=T(t.add(E({},[u]))),f=T(t.add(Lr({scale:t.scaleRef(e.scale),extra:t.property(c.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),p=[];let h;return u.grid&&p.push(Gt(e,r,n.grid,f,c)),u.ticks&&(h=l("tickSize"),p.push(Wt(e,r,n.ticks,f,h,c))),u.labels&&(h=u.ticks?h:0,p.push($t(e,r,n.labels,f,h,c))),u.domain&&p.push(jt(e,r,n.domain,d)),u.title&&p.push(zt(e,r,n.title,d)),vt(Ve({role:pr,from:d,encode:A(Jt(l,e),a,M),marks:p,aria:l("aria"),description:l("description"),zindex:l("zindex"),name:i,interactive:o,style:s}),t)}function Jt(e,t){var r={enter:{},update:{}};return S(r,{orient:e("orient"),offset:e("offset")||0,position:g(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),r}function Zt(e,t,r){var n=y.array(e.signals),a=y.array(e.scales);return r||n.forEach(e=>ne(e,t)),y.array(e.projections).forEach(e=>He(e,t)),a.forEach(e=>Ae(e,t)),y.array(e.data).forEach(e=>xt(e,t)),a.forEach(e=>Oe(e,t)),(r||n).forEach(e=>Se(e,t)),y.array(e.axes).forEach(e=>Yt(e,t)),y.array(e.marks).forEach(e=>vt(e,t)),y.array(e.legends).forEach(e=>St(e,t)),e.title&&It(e.title,t),t.parseLambdas(),t}const Zn=e=>A({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function Qt(e,t){var r=t.config,n=T(t.root=t.add(oe())),a=er(e,r),r=(a.forEach(e=>ne(e,t)),t.description=e.description||r.description,t.eventConfig=r.events,t.legends=t.objectProperty(r.legend&&r.legend.layout),t.locale=r.locale,t.add(E())),i=t.add(jr(Q(Zn(e.encode),Tn,dr,e.style,t,{pulse:T(r)}))),o=t.add(on({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:n,pulse:T(i)})),i=(t.operators.pop(),t.pushState(T(i),T(o),null),Zt(e,t,a),t.operators.push(o),t.add(Fr({mark:n,pulse:T(o)}))),i=t.add(rn({pulse:T(i)}));return i=t.add(w({pulse:T(i)})),t.addData("root",new v(t,r,r,i)),t}function Xt(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function er(t,r){const e=e=>g(t[e],r[e]),n=[Xt("background",e("background")),Xt("autosize",H(e("autosize"))),Xt("padding",G(e("padding"))),Xt("width",e("width")||0),Xt("height",e("height")||0)],a=n.reduce((e,t)=>(e[t.name]=t,e),{}),i={};return y.array(t.signals).forEach(e=>{y.hasOwnProperty(a,e.name)?e=y.extend(a[e.name],e):n.push(e),i[e.name]=e}),y.array(r.signals).forEach(e=>{y.hasOwnProperty(i,e.name)||y.hasOwnProperty(a,e.name)||n.push(e)}),n}function tr(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function rr(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}function nr(e){return(y.isArray(e)?ar:ir)(e)}function ar(t){var r=t.length;let n="[";for(let e=0;e<r;++e){var a=t[e];n+=(0<e?",":"")+(y.isObject(a)?a.signal||nr(a):y.stringValue(a))}return n+"]"}function ir(e){let t="{",r=0,n,a;for(n in e)a=e[n],t+=(1<++r?",":"")+y.stringValue(n)+":"+(y.isObject(a)?a.signal||nr(a):y.stringValue(a));return t+"}"}function or(){var e="sans-serif",t="#4c78a8",r="#000";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:t},area:{fill:t},image:null,line:{stroke:t,strokeWidth:2},path:{stroke:t},rect:{fill:t},rule:{stroke:r},shape:{stroke:t},symbol:{fill:t,size:64},text:{fill:r,font:e,fontSize:11},trail:{fill:t,size:2},style:{"guide-label":{fill:r,font:e,fontSize:10},"guide-title":{fill:r,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:r,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:r,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:"#ddd"},view:{fill:"transparent"}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:"#888",grid:!1,gridWidth:1,gridColor:"#ddd",labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:"#888",tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:"#ddd",gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:"#888",titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function sr(e,t,r){return y.isObject(e)||y.error("Input Vega specification must be an object."),Qt(e,new tr(t=y.mergeConfig(or(),t,e.config),r)).toRuntime()}tr.prototype=rr.prototype={parse(e){return Zt(e,this)},fork(){return new rr(this)},isSubscope(){return 0<this._subid},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(t){return this.operators.push(t),t.id=this.id(),t.refs&&(t.refs.forEach(e=>{e.$ref=t.id}),t.refs=null),t},proxy(e){e=e instanceof ae?T(e):e;return this.add(en({value:e}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;for(e in this.root&&(this.root.root=!0),this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function r(e,t,r){e&&((e=e.data||(e.data={}))[t]||(e[t]=[])).push(r)}for(e in this.data){r((t=this.data[e]).input,e,"input"),r(t.output,e,"output"),r(t.values,e,"values");for(const n in t.index)r(t.index[n],e,"index:"+n)}return this},pushState(e,t,r){this._encode.push(T(this.add(w({pulse:e})))),this._parent.push(t),this._lookup.push(r?T(this.proxy(r)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return y.peek(this._parent)},encode(){return y.peek(this._encode)},lookup(){return y.peek(this._lookup)},markpath(){var e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(y.isString(e))return se(e,t);e.signal||y.error("Unsupported field reference: "+y.stringValue(e));var r,e=e.signal;let n=this.field[e];return n||(r={name:this.signalRef(e)},t&&(r.as=t),this.field[e]=n=T(this.add(Vr(r)))),n},compareRef(e){let t=!1;var r=e=>f(e)?(t=!0,this.signalRef(e.signal)):fe(e)?(t=!0,this.exprRef(e.expr)):e,n=y.array(e.field).map(r),e=y.array(e.order).map(r);return t?T(this.add(Ur({fields:n,orders:e}))):le(n,e)},keyRef(e,t){let r=!1;const n=this.signals;return e=y.array(e).map(e=>f(e)?(r=!0,T(n[e.signal])):e),r?T(this.add(Wr({fields:e,flat:t}))):ce(e,t)},sortRef(e){var t,r;return e&&(t=de(e.op,e.field),(r=e.order||"ascending").signal?T(this.add(Ur({fields:t,orders:this.signalRef(r.signal)}))):le(t,r))},event(e,t){var r,n=e+":"+t;return this.events[n]||(r=this.id(),this.streams.push({id:r,source:e,type:t}),this.events[n]=r),this.events[n]},hasOwnSignal(e){return y.hasOwnProperty(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&y.error("Duplicate signal name: "+y.stringValue(e));t=t instanceof ae?t:this.add(oe(t));return this.signals[e]=t},getSignal(e){return this.signals[e]||y.error("Unrecognized signal name: "+y.stringValue(e)),this.signals[e]},signalRef(e){return this.signals[e]?T(this.signals[e]):(y.hasOwnProperty(this.lambdas,e)||(this.lambdas[e]=this.add(oe(null))),T(this.lambdas[e]))},parseLambdas(){var r=Object.keys(this.lambdas);for(let e=0,t=r.length;e<t;++e){var n=r[e],a=c.parseExpression(n,this),n=this.lambdas[n];n.params=a.$params,n.update=a.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return e&&y.isObject(e)?this.signalRef(e.signal||nr(e)):e},exprRef(e,t){e={expr:c.parseExpression(e,this)};return t&&(e.expr.$name=t),T(this.add(Hr(e)))},addBinding(e,t){this.bindings||y.error("Nested signals do not support binding: "+y.stringValue(e)),this.bindings.push(y.extend({signal:e},t))},addScaleProj(e,t){y.hasOwnProperty(this.scales,e)&&y.error("Duplicate scale or projection name: "+y.stringValue(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,nn(t))},addProjection(e,t){this.addScaleProj(e,Xr(t))},getScale(e){return this.scales[e]||y.error("Unrecognized scale name: "+y.stringValue(e)),this.scales[e]},scaleRef(e){return T(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return y.hasOwnProperty(this.data,e)&&y.error("Duplicate data set name: "+y.stringValue(e)),this.data[e]=t},getData(e){return this.data[e]||y.error("Undefined data set name: "+y.stringValue(e)),this.data[e]},addDataPipeline(e,t){return y.hasOwnProperty(this.data,e)&&y.error("Duplicate data set name: "+y.stringValue(e)),this.addData(e,v.fromEntries(this,t))}},e.AxisDomainRole=hr,e.AxisGridRole="axis-grid",e.AxisLabelRole=gr,e.AxisRole=pr,e.AxisTickRole="axis-tick",e.AxisTitleRole=mr,e.DataScope=v,e.FrameRole=dr,e.LegendEntryRole=yr,e.LegendLabelRole=Tr,e.LegendRole=_r,e.LegendSymbolRole=br,e.LegendTitleRole=vr,e.MarkRole=ur,e.Scope=tr,e.ScopeRole=fr,e.config=or,e.parse=sr,e.signal=ne,e.signalUpdates=Se,e.stream=o}}return bd.exports}function Ad(){function e(r){var n=Object.create(null);return r&&Object.keys(r).forEach(function(e){var t;"default"!==e&&(t=Object.getOwnPropertyDescriptor(r,e),Object.defineProperty(n,e,t.get?t:{enumerable:!0,get:function(){return r[e]}}))}),n.default=r,Object.freeze(n)}var t,r,n,a,i,o,s,l,c,u,d,f,p,h,g,m,_,y,T,b,v,E,S,A,O,C,k;return Td||(Td=1,t=qc,r=jo(),n=su(),a=pu(),i=Ou(),o=wu(),s=Du(),l=Fu(),c=ju(),u=Vu(),d=$u(),f=Yu(),p=Qu(),h=td(),g=fu(),m=au(),_=ou(),y=Au(),T=Su(),b=Nu(),v=md(),E=iu(),S=dd(),A=Sd(),O=gd(),C=od(),k=Ed(),a=e(a),i=e(i),o=e(o),s=e(s),l=e(l),c=e(c),r.extend(n.transforms,a,i,o,s,l,e(u),c,e(d),e(f),e(p),e(h)),Object.defineProperty(t,"Dataflow",{enumerable:!0,get:function(){return n.Dataflow}}),Object.defineProperty(t,"EventStream",{enumerable:!0,get:function(){return n.EventStream}}),Object.defineProperty(t,"MultiPulse",{enumerable:!0,get:function(){return n.MultiPulse}}),Object.defineProperty(t,"Operator",{enumerable:!0,get:function(){return n.Operator}}),Object.defineProperty(t,"Parameters",{enumerable:!0,get:function(){return n.Parameters}}),Object.defineProperty(t,"Pulse",{enumerable:!0,get:function(){return n.Pulse}}),Object.defineProperty(t,"Transform",{enumerable:!0,get:function(){return n.Transform}}),Object.defineProperty(t,"changeset",{enumerable:!0,get:function(){return n.changeset}}),Object.defineProperty(t,"definition",{enumerable:!0,get:function(){return n.definition}}),Object.defineProperty(t,"ingest",{enumerable:!0,get:function(){return n.ingest}}),Object.defineProperty(t,"isTuple",{enumerable:!0,get:function(){return n.isTuple}}),Object.defineProperty(t,"transform",{enumerable:!0,get:function(){return n.transform}}),Object.defineProperty(t,"transforms",{enumerable:!0,get:function(){return n.transforms}}),Object.defineProperty(t,"tupleid",{enumerable:!0,get:function(){return n.tupleid}}),Object.defineProperty(t,"interpolate",{enumerable:!0,get:function(){return T.interpolate}}),Object.defineProperty(t,"interpolateColors",{enumerable:!0,get:function(){return T.interpolateColors}}),Object.defineProperty(t,"interpolateRange",{enumerable:!0,get:function(){return T.interpolateRange}}),Object.defineProperty(t,"quantizeInterpolator",{enumerable:!0,get:function(){return T.quantizeInterpolator}}),Object.defineProperty(t,"scale",{enumerable:!0,get:function(){return T.scale}}),Object.defineProperty(t,"scheme",{enumerable:!0,get:function(){return T.scheme}}),Object.defineProperty(t,"projection",{enumerable:!0,get:function(){return b.projection}}),Object.defineProperty(t,"View",{enumerable:!0,get:function(){return v.View}}),Object.defineProperty(t,"defaultLocale",{enumerable:!0,get:function(){return E.defaultLocale}}),Object.defineProperty(t,"formatLocale",{enumerable:!0,get:function(){return E.numberFormatDefaultLocale}}),Object.defineProperty(t,"locale",{enumerable:!0,get:function(){return E.locale}}),Object.defineProperty(t,"resetDefaultLocale",{enumerable:!0,get:function(){return E.resetDefaultLocale}}),Object.defineProperty(t,"timeFormatLocale",{enumerable:!0,get:function(){return E.timeFormatDefaultLocale}}),Object.defineProperty(t,"expressionFunction",{enumerable:!0,get:function(){return S.expressionFunction}}),Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return A.parse}}),Object.defineProperty(t,"runtimeContext",{enumerable:!0,get:function(){return O.context}}),Object.defineProperty(t,"codegenExpression",{enumerable:!0,get:function(){return C.codegenExpression}}),Object.defineProperty(t,"parseExpression",{enumerable:!0,get:function(){return C.parseExpression}}),Object.defineProperty(t,"parseSelector",{enumerable:!0,get:function(){return k.parseSelector}}),t.version="5.30.0",Object.keys(r).forEach(function(e){"default"===e||Object.prototype.hasOwnProperty.call(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})}),Object.keys(g).forEach(function(e){"default"===e||Object.prototype.hasOwnProperty.call(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return g[e]}})}),Object.keys(m).forEach(function(e){"default"===e||Object.prototype.hasOwnProperty.call(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return m[e]}})}),Object.keys(_).forEach(function(e){"default"===e||Object.prototype.hasOwnProperty.call(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return _[e]}})}),Object.keys(y).forEach(function(e){"default"===e||Object.prototype.hasOwnProperty.call(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return y[e]}})})),qc}var Od,Cd={exports:{}};function kd(){return Od||(Od=1,function(e,te){var n,a,i,o,s,l,c,u,f,p,h,b,E,O,$,z,K,Y,J,Z,Q,X,ee,ie={name:"vega-lite",author:'Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',version:"5.19.0",collaborators:["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],homepage:"https://vega.github.io/vega-lite/",description:"Vega-Lite is a concise high-level language for interactive visualization.",keywords:["vega","chart","visualization"],main:"build/vega-lite.js",unpkg:"build/vega-lite.min.js",jsdelivr:"build/vega-lite.min.js",module:"build/src/index",types:"build/src/index.d.ts",bin:{vl2pdf:"./bin/vl2pdf",vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2vg:"./bin/vl2vg"},files:["bin","build","src","vega-lite*","tsconfig.json"],scripts:{changelog:"conventional-changelog -p angular -r 2",prebuild:"yarn clean:build",build:"yarn build:only","build:only":"tsc -p tsconfig.build.json && rollup -c","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"rollup -c site/rollup.config.mjs","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"yarn clean:build && del-cli 'site/data/*' 'examples/compiled/*.png' && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","clean:build":"del-cli 'build/*' !build/vega-lite-schema.json",data:"rsync -r node_modules/vega-datasets/data/* site/data","build-editor-preview":"scripts/build-editor-preview.sh",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"yarn site:only","site:only":"pushd site && bundle exec jekyll serve -I -l && popd",prettierbase:"prettier '**/*.{md,css,yml}'",format:"eslint . --fix && yarn prettierbase --write",lint:"eslint . && yarn prettierbase --check",test:"yarn jest test/ && yarn lint && yarn schema && yarn jest examples/ && yarn test:runtime","test:cover":"yarn jest --collectCoverage test/","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":"TZ=America/Los_Angeles npx jest test-runtime/ --config test-runtime/jest-config.json","test:runtime:generate":"yarn build:only && del-cli test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime",watch:"tsc -p tsconfig.build.json -w","watch:site":"yarn build:site -w","watch:test":"yarn jest --watch test/","watch:test:runtime":"TZ=America/Los_Angeles npx jest --watch test-runtime/ --config test-runtime/jest-config.json",release:"release-it"},repository:{type:"git",url:"https://github.com/vega/vega-lite.git"},license:"BSD-3-Clause",bugs:{url:"https://github.com/vega/vega-lite/issues"},devDependencies:{"@babel/core":"^7.24.7","@babel/preset-env":"^7.24.7","@babel/preset-typescript":"^7.24.7","@release-it/conventional-changelog":"^8.0.1","@rollup/plugin-alias":"^5.1.0","@rollup/plugin-babel":"^6.0.4","@rollup/plugin-commonjs":"^25.0.7","@rollup/plugin-json":"^6.1.0","@rollup/plugin-node-resolve":"^15.2.3","@rollup/plugin-terser":"^0.4.4","@types/d3":"^7.4.3","@types/jest":"^29.5.12","@types/pako":"^2.0.3","@typescript-eslint/eslint-plugin":"^7.13.0","@typescript-eslint/parser":"^7.13.0",ajv:"^8.16.0","ajv-formats":"^2.1.1",cheerio:"^1.0.0-rc.12","conventional-changelog-cli":"^4.1.0",d3:"^7.9.0","del-cli":"^5.1.0",eslint:"^8.57.0","eslint-config-prettier":"^9.1.0","eslint-plugin-jest":"^27.9.0","eslint-plugin-prettier":"^5.1.3","fast-json-stable-stringify":"~2.1.0","highlight.js":"^11.9.0",jest:"^29.7.0","jest-dev-server":"^10.0.0",mkdirp:"^3.0.1",pako:"^2.1.0",prettier:"^3.3.2",puppeteer:"^15.0.0","release-it":"17.2.1",rollup:"^4.18.0","rollup-plugin-bundle-size":"^1.0.3",serve:"^14.2.3",terser:"^5.31.1","ts-jest":"^29.1.4","ts-json-schema-generator":"^1.5.0",typescript:"~5.4.5","vega-cli":"^5.28.0","vega-datasets":"^2.8.1","vega-embed":"^6.25.0","vega-tooltip":"^0.34.0","yaml-front-matter":"^4.1.1"},dependencies:{"json-stringify-pretty-compact":"~3.0.0",tslib:"~2.6.3","vega-event-selector":"~3.0.1","vega-expression":"~5.1.0","vega-util":"~1.17.2",yargs:"~17.7.2"},peerDependencies:{vega:"^5.24.0"},engines:{node:">=18"},packageManager:"yarn@1.22.19"};function oe(e){return!!e.or}function se(e){return!!e.and}function le(e){return!!e.not}function ce(e,t){if(le(e))ce(e.not,t);else if(se(e))for(const r of e.and)ce(r,t);else if(oe(e))for(const n of e.or)ce(n,t);else t(e)}function ue(e,t){if(le(e))return{not:ue(e.not,t)};else if(se(e))return{and:e.and.map(e=>ue(e,t))};else if(oe(e))return{or:e.or.map(e=>ue(e,t))};else return t(e)}const g=structuredClone;function de(e){throw new Error(e)}function fe(e,t){const r={};for(const n of t)if(te.hasOwnProperty(e,n))r[n]=e[n];return r}function pe(e,t){const r={...e};for(const n of t)delete r[n];return r}function S(e){if(te.isNumber(e))return e;const t=te.isString(e)?e:m(e);if(t.length<250)return t;let r=0;for(let e=0;e<t.length;e++){const n=t.charCodeAt(e);r=(r<<5)-r+n;r=r&r}return r}function he(e){return e===false||e===null}function w(e,t){return e.includes(t)}function ge(e,t){let r=0;for(const[n,a]of e.entries())if(t(a,n,r++))return true;return false}function me(e,t){let r=0;for(const[n,a]of e.entries())if(!t(a,n,r++))return false;return true}function _e(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(const a of r)ye(e,a??{});return e}function ye(e,t){for(const r of A(t))te.writeConfig(e,r,t[r],true)}function Te(e,t){const r=[];const n={};let a;for(const i of e){a=t(i);if(a in n)continue;n[a]=1;r.push(i)}return r}function be(e,t){const r=A(e);const n=A(t);if(r.length!==n.length)return false;for(const a of r)if(e[a]!==t[a])return false;return true}function ve(e,t){if(e.size!==t.size)return false;for(const r of e)if(!t.has(r))return false;return true}function Ee(e,t){for(const r of e)if(t.has(r))return true;return false}function Se(e){const t=new Set;for(const r of e){const n=te.splitAccessPath(r);const a=n.map((e,t)=>t===0?e:`[${e}]`);const i=a.map((e,t)=>a.slice(0,t+1).join(""));for(const o of i)t.add(o)}return t}function Ae(e,t){if(e===undefined||t===undefined)return true;return Ee(Se(e),Se(t))}function re(e){return A(e).length===0}Set.prototype["toJSON"]=function(){return`Set(${[...this].map(e=>m(e)).join(",")})`};const A=Object.keys,C=Object.values,Oe=Object.entries;function Ce(e){return e===true||e===false}function k(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function ke(e,t){if(le(e))return`!(${ke(e.not,t)})`;else if(se(e))return`(${e.and.map(e=>ke(e,t)).join(") && (")})`;else if(oe(e))return`(${e.or.map(e=>ke(e,t)).join(") || (")})`;else return t(e)}function we(e,t){if(t.length===0)return true;const r=t.shift();if(r in e&&we(e[r],t))delete e[r];return re(e)}function Re(e){return e.charAt(0).toUpperCase()+e.substr(1)}function Ie(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"datum";const r=te.splitAccessPath(e);const n=[];for(let e=1;e<=r.length;e++){const a=`[${r.slice(0,e).map(te.stringValue).join("][")}]`;n.push(`${t}${a}`)}return n.join(" && ")}function Me(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"datum";return`${t}[${te.stringValue(te.splitAccessPath(e).join("."))}]`}function Pe(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function Ne(e){return`${te.splitAccessPath(e).map(Pe).join("\\.")}`}function De(e,t,r){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),r)}function xe(e){return`${te.splitAccessPath(e).join(".")}`}function Le(e){if(!e)return 0;return te.splitAccessPath(e).length}function R(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(const n of t)if(n!==undefined)return n;return undefined}let Fe=42;function Ue(e){const t=++Fe;return e?String(e)+t:t}function Be(){Fe=42}function je(e){return He(e)?e:`__${e}`}function He(e){return e.startsWith("__")}function Ge(e){if(e===undefined)return undefined;return(e%360+360)%360}function Ve(e){if(te.isNumber(e))return true;return!isNaN(e)&&!isNaN(parseFloat(e))}const We=Object.getPrototypeOf(structuredClone({}));function qe(r,n){if(r===n)return true;if(r&&n&&typeof r=="object"&&typeof n=="object"){if(r.constructor.name!==n.constructor.name)return false;let e;let t;if(Array.isArray(r)){e=r.length;if(e!=n.length)return false;for(t=e;t--!==0;)if(!qe(r[t],n[t]))return false;return true}if(r instanceof Map&&n instanceof Map){if(r.size!==n.size)return false;for(t of r.entries())if(!n.has(t[0]))return false;for(t of r.entries())if(!qe(t[1],n.get(t[0])))return false;return true}if(r instanceof Set&&n instanceof Set){if(r.size!==n.size)return false;for(t of r.entries())if(!n.has(t[0]))return false;return true}if(ArrayBuffer.isView(r)&&ArrayBuffer.isView(n)){e=r.length;if(e!=n.length)return false;for(t=e;t--!==0;)if(r[t]!==n[t])return false;return true}if(r.constructor===RegExp)return r.source===n.source&&r.flags===n.flags;if(r.valueOf!==Object.prototype.valueOf&&r.valueOf!==We.valueOf)return r.valueOf()===n.valueOf();if(r.toString!==Object.prototype.toString&&r.toString!==We.toString)return r.toString()===n.toString();const a=Object.keys(r);e=a.length;if(e!==Object.keys(n).length)return false;for(t=e;t--!==0;)if(!Object.prototype.hasOwnProperty.call(n,a[t]))return false;for(t=e;t--!==0;){const i=a[t];if(!qe(r[i],n[i]))return false}return true}return r!==r&&n!==n}function m(e){const l=[];return function e(t){if(t&&t.toJSON&&typeof t.toJSON==="function")t=t.toJSON();if(t===undefined)return undefined;if(typeof t=="number")return isFinite(t)?""+t:"null";if(typeof t!=="object")return JSON.stringify(t);let r,n;if(Array.isArray(t)){n="[";for(r=0;r<t.length;r++){if(r)n+=",";n+=e(t[r])||"null"}return n+"]"}if(t===null)return"null";if(l.includes(t))throw new TypeError("Converting circular structure to JSON");const a=l.push(t)-1;const i=Object.keys(t).sort();n="";for(r=0;r<i.length;r++){const o=i[r];const s=e(t[o]);if(!s)continue;if(n)n+=",";n+=JSON.stringify(o)+":"+s}l.splice(a,1);return`{${n}}`}(e)}const $e="row",ze="column",Ke="facet",I="x",M="y",Ye="x2",Je="y2",Ze="xOffset",Qe="yOffset",Xe="radius",et="radius2",tt="theta",rt="theta2",nt="latitude",at="longitude",it="latitude2",ot="longitude2",st="color",lt="fill",ct="stroke",ut="shape",dt="size",ft="angle",pt="opacity",ht="fillOpacity",gt="strokeOpacity",mt="strokeWidth",_t="strokeDash",yt="text",Tt="order",bt="detail",vt="key",Et="tooltip",St="href",At="url",Ot="description",Ct={x:1,y:1,x2:1,y2:1},kt={theta:1,theta2:1,radius:1,radius2:1};function wt(e){return e in kt}const Rt={longitude:1,longitude2:1,latitude:1,latitude2:1};function It(e){switch(e){case nt:return"y";case it:return"y2";case at:return"x";case ot:return"x2"}}function Mt(e){return e in Rt}const Pt=A(Rt),Nt={...Ct,...kt,...Rt,xOffset:1,yOffset:1,color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1};function Dt(e){return e===st||e===lt||e===ct}const xt={row:1,column:1,facet:1},Lt=A(xt),Ft={...Nt,...xt},Ut=A(Ft),{order:Bt,detail:jt,tooltip:Ht,...Gt}=Ft,{row:Vt,column:Wt,facet:qt,...$t}=Gt;function zt(e){return!!$t[e]}function Kt(e){return!!Ft[e]}const Yt=[Ye,Je,it,ot,rt,et];function Jt(e){const t=Zt(e);return t!==e}function Zt(e){switch(e){case Ye:return I;case Je:return M;case it:return nt;case ot:return at;case rt:return tt;case et:return Xe}return e}function Qt(e){if(wt(e))switch(e){case tt:return"startAngle";case rt:return"endAngle";case Xe:return"outerRadius";case et:return"innerRadius"}return e}function Xt(e){switch(e){case I:return Ye;case M:return Je;case nt:return it;case at:return ot;case tt:return rt;case Xe:return et}return undefined}function er(e){switch(e){case I:case Ye:return"width";case M:case Je:return"height"}return undefined}function tr(e){switch(e){case I:return"xOffset";case M:return"yOffset";case Ye:return"x2Offset";case Je:return"y2Offset";case tt:return"thetaOffset";case Xe:return"radiusOffset";case rt:return"theta2Offset";case et:return"radius2Offset"}return undefined}function rr(e){switch(e){case I:return"xOffset";case M:return"yOffset"}return undefined}function nr(e){switch(e){case"xOffset":return"x";case"yOffset":return"y"}}const ar=A(Nt),{x:ir,y:or,x2:sr,y2:lr,xOffset:cr,yOffset:ur,latitude:dr,longitude:fr,latitude2:pr,longitude2:hr,theta:gr,theta2:mr,radius:_r,radius2:yr,...Tr}=Nt,br=A(Tr),vr={x:1,y:1},Er=A(vr);function P(e){return e in vr}const Sr={theta:1,radius:1},Ar=A(Sr);function Or(e){return e==="width"?I:M}const Cr={xOffset:1,yOffset:1};function kr(e){return e in Cr}const{text:wr,tooltip:Rr,href:Ir,url:Mr,description:Pr,detail:Nr,key:Dr,order:xr,...Lr}=Tr,Fr=A(Lr);function Ur(e){return!!Tr[e]}function Br(e){switch(e){case st:case lt:case ct:case dt:case ut:case pt:case mt:case _t:return true;case ht:case gt:case ft:return false}}const jr={...vr,...Sr,...Cr,...Lr},Hr=A(jr);function Gr(e){return!!jr[e]}function Vr(e,t){return zr(e)[t]}const Wr={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:qr,...$r}=Wr;function zr(e){switch(e){case st:case lt:case ct:case Ot:case bt:case vt:case Et:case St:case Tt:case pt:case ht:case gt:case mt:case Ke:case $e:case ze:return Wr;case I:case M:case Ze:case Qe:case nt:case at:return $r;case Ye:case Je:case it:case ot:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case dt:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case _t:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case ut:return{point:"always",geoshape:"always"};case yt:return{text:"always"};case ft:return{point:"always",square:"always",text:"always"};case At:return{image:"always"};case tt:return{text:"always",arc:"always"};case Xe:return{text:"always",arc:"always"};case rt:case et:return{arc:"always"}}}function Kr(e){switch(e){case I:case M:case tt:case Xe:case Ze:case Qe:case dt:case ft:case mt:case pt:case ht:case gt:case Ye:case Je:case rt:case et:return undefined;case Ke:case $e:case ze:case ut:case _t:case yt:case Et:case St:case At:case Ot:return"discrete";case st:case lt:case ct:return"flexible";case nt:case at:case it:case ot:case bt:case vt:case Tt:return undefined}}const Yr={argmax:1,argmin:1,average:1,count:1,distinct:1,exponential:1,exponentialb:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},Jr={count:1,min:1,max:1};function Zr(e){return!!e&&!!e["argmin"]}function Qr(e){return!!e&&!!e["argmax"]}function Xr(e){return te.isString(e)&&!!Yr[e]}const en=new Set(["count","valid","missing","distinct"]);function tn(e){return te.isString(e)&&en.has(e)}function rn(e){return te.isString(e)&&w(["min","max"],e)}const nn=new Set(["count","sum","distinct","valid","missing"]),an=new Set(["mean","average","median","q1","q3","min","max"]);function on(t){if(te.isBoolean(t))t=Yl(t,undefined);return"bin"+A(t).map(e=>ln(t[e])?k(`_${e}_${Oe(t[e])}`):k(`_${e}_${t[e]}`)).join("")}function N(e){return e===true||sn(e)&&!e.binned}function D(e){return e==="binned"||sn(e)&&e.binned===true}function sn(e){return te.isObject(e)}function ln(e){return e?.["param"]}function cn(e){switch(e){case $e:case ze:case dt:case st:case lt:case ct:case mt:case pt:case ht:case gt:case ut:return 6;case _t:return 4;default:return 10}}function un(e){return!!e?.expr}function _(e){let{level:t}=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{level:0};const r=A(e||{});const n={};for(const a of r)n[a]=t===0?En(e[a]):_(e[a],{level:t-1});return n}function dn(e){const{anchor:t,frame:r,offset:n,orient:a,angle:i,limit:o,color:s,subtitleColor:l,subtitleFont:c,subtitleFontSize:u,subtitleFontStyle:d,subtitleFontWeight:f,subtitleLineHeight:p,subtitlePadding:h,...g}=e;const m={...g,...s?{fill:s}:{}};const _={...t?{anchor:t}:{},...r?{frame:r}:{},...n?{offset:n}:{},...a?{orient:a}:{},...i!==undefined?{angle:i}:{},...o!==undefined?{limit:o}:{}};const y={...l?{subtitleColor:l}:{},...c?{subtitleFont:c}:{},...u?{subtitleFontSize:u}:{},...d?{subtitleFontStyle:d}:{},...f?{subtitleFontWeight:f}:{},...p?{subtitleLineHeight:p}:{},...h?{subtitlePadding:h}:{}};const T=fe(e,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:m,subtitleMarkConfig:T,nonMarkTitleProperties:_,subtitle:y}}function fn(e){return te.isString(e)||te.isArray(e)&&te.isString(e[0])}function x(e){return!!e?.signal}function pn(e){return!!e["step"]}function hn(e){if(!te.isArray(e))return"fields"in e&&!("data"in e);return false}function gn(e){if(!te.isArray(e))return"fields"in e&&"data"in e;return false}function mn(e){if(!te.isArray(e))return"field"in e&&"data"in e;return false}const _n={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1},yn=A(_n),Tn={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},bn=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function vn(e){const t=te.isArray(e.condition)?e.condition.map(Sn):Sn(e.condition);return{...En(e),condition:t}}function En(e){if(un(e)){const{expr:t,...r}=e;return{signal:t,...r}}return e}function Sn(e){if(un(e)){const{expr:t,...r}=e;return{signal:t,...r}}return e}function L(e){if(un(e)){const{expr:t,...r}=e;return{signal:t,...r}}if(x(e))return e;return e!==undefined?{value:e}:undefined}function An(e){if(x(e))return e.signal;return te.stringValue(e)}function On(e){if(x(e))return e.signal;return te.stringValue(e.value)}function Cn(e){if(x(e))return e.signal;return e==null?null:te.stringValue(e)}function kn(e,t,r){for(const n of r){const a=Rn(n,t.markDef,t.config);if(a!==undefined)e[n]=L(a)}return e}function wn(e){return[].concat(e.type,e.style??[])}function ne(e,t,r){let n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};const{vgChannel:a,ignoreVgConfig:i}=n;if(a&&t[a]!==undefined)return t[a];else if(t[e]!==undefined)return t[e];else if(i&&(!a||a===e))return undefined;return Rn(e,t,r,n)}function Rn(e,t,r){let{vgChannel:n}=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};return R(n?In(e,t,r.style):undefined,In(e,t,r.style),n?r[t.type][n]:undefined,r[t.type][e],n?r.mark[n]:r.mark[e])}function In(e,t,r){return Mn(e,wn(t),r)}function Mn(e,t,r){t=te.array(t);let n;for(const a of t){const i=r[a];if(i&&i[e]!==undefined)n=i[e]}return n}function Pn(e,r){return te.array(e).reduce((e,t)=>{e.field.push(j(t,r));e.order.push(t.sort??"ascending");return e},{field:[],order:[]})}function Nn(e,t){const r=[...e];t.forEach(e=>{for(const t of r)if(qe(t,e))return;r.push(e)});return r}function Dn(e,t){if(qe(e,t)||!t)return e;else if(!e)return t;else return[...te.array(e),...te.array(t)].join(", ")}function xn(e,t){const r=e.value;const n=t.value;if(r==null||n===null)return{explicit:e.explicit,value:null};else if((fn(r)||x(r))&&(fn(n)||x(n)))return{explicit:e.explicit,value:Dn(r,n)};else if(fn(r)||x(r))return{explicit:e.explicit,value:r};else if(fn(n)||x(n))return{explicit:e.explicit,value:n};else if(!fn(r)&&!x(r)&&!fn(n)&&!x(n))return{explicit:e.explicit,value:Nn(r,n)};throw new Error("It should never reach here")}function Ln(e){return`Invalid specification ${m(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const Fn='Autosize "fit" only works for single views and layered views.';function Un(e){const t=e=="width"?"Width":"Height";return`${t} "container" only works for single views and layered views.`}function Bn(e){const t=e=="width"?"Width":"Height";const r=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${r}".`}function jn(e){return e?`Dropping "fit-${e}" because spec has discrete ${er(e)}.`:`Dropping "fit" because spec has discrete size.`}function Hn(e){return`Unknown field for ${e}. Cannot calculate view size.`}function Gn(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function Vn(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function Wn(e){return`The "nearest" transform is not supported for ${e} marks.`}function qn(e){return`Selection not supported for ${e} yet.`}function $n(e){return`Cannot find a selection named "${e}".`}const zn="Scale bindings are currently only supported for scales with unbinned, continuous domains.",Kn="Sequntial scales are deprecated. The available quantitative scale type values are linear, log, pow, sqrt, symlog, time and utc",Yn="Legend bindings are only supported for selections over an individual field or encoding channel.";function Jn(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}function Zn(e){return`Cannot define and lookup the "${e}" selection in the same view. `+`Try moving the lookup into a second, layered view?`}const Qn="The same selection must be used to override scale domains in a layered view.",Xn='Interval selections should be initialized using "x", "y", "longitude", or "latitude" keys.';function ea(e){return`Unknown repeated value "${e}".`}function ta(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const ra="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function na(e){return`Unrecognized parse "${e}".`}function aa(e,t,r){return`An ancestor parsed field "${e}" as ${r} but a child wants to parse the field as ${t}.`}const ia="Attempt to add the same child twice.";function oa(e){return`Ignoring an invalid transform: ${m(e)}.`}const sa='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function la(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function ca(e){const{parentProjection:t,projection:r}=e;return`Layer's shared projection ${m(t)} is overridden by a child projection ${m(r)}.`}const ua="Arc marks uses theta channel rather than angle, replacing angle with theta.";function da(e){return`${e}Offset dropped because ${e} is continuous`}function fa(e,t,r){return`Channel ${e} is a ${t}. Converted to {value: ${m(r)}}.`}function pa(e){return`Invalid field type "${e}".`}function ha(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function ga(e){return`Invalid aggregation operator "${e}".`}function ma(e,t){const{fill:r,stroke:n}=t;return`Dropping color ${e} as the plot also has ${r&&n?"fill and stroke":r?"fill":"stroke"}.`}function _a(e){return`Position range does not support relative band size for ${e}.`}function ya(e,t){return`Dropping ${m(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const Ta="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function ba(e,t,r){return`${e} dropped as it is incompatible with "${t}"${""}.`}function va(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function Ea(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function Sa(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function Aa(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function Oa(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function Ca(e){return`The ${e} for range marks cannot be an expression`}function ka(e,t){const r=e&&t?"x2 and y2":e?"x2":"y2";return`Line mark is for continuous lines and thus cannot be used with ${r}. We will use the rule mark (line segments) instead.`}function wa(e,t){return`Specified orient "${e}" overridden with "${t}".`}function Ra(e){return`Cannot use the scale property "${e}" with non-color channel.`}function Ia(e){return`Cannot use the relative band size with ${e} scale.`}function Ma(e){return`Using unaggregated domain with raw field has no effect (${m(e)}).`}function Pa(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function Na(e){return`Unaggregated domain is currently unsupported for log scale (${m(e)}).`}function Da(e){return`Cannot apply size to non-oriented mark "${e}".`}function xa(e,t,r){return`Channel "${e}" does not work with "${t}" scale. We are using "${r}" scale instead.`}function La(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function Fa(e,t,r){return`${r}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function Ua(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function Ba(e,t,r,n){return`Conflicting ${t.toString()} property "${e.toString()}" (${m(r)} and ${m(n)}). Using ${m(r)}.`}function ja(e,t,r,n){return`Conflicting ${t.toString()} property "${e.toString()}" (${m(r)} and ${m(n)}). Using the union of the two domains.`}function Ha(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function Ga(e){return`Dropping sort property ${m(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const Va="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",Wa="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",qa="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",$a="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function za(e){return`Cannot stack "${e}" if there is already "${e}2".`}function Ka(e){return`Stack is applied to a non-linear scale (${e}).`}function Ya(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function Ja(e,t){return`Invalid ${e}: ${m(t)}.`}function Za(e){return`Dropping day from datetime ${m(e)} as day cannot be combined with other units.`}function Qa(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function Xa(e,t,r){return`${e} is not usually used with ${t} for ${r}.`}function ei(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function ti(e){return`1D error band does not support ${e}.`}function ri(e){return`Channel ${e} is required for "binned" bin.`}function ni(e){return`Channel ${e} should not be used with "binned" bin.`}function ai(e){return`Domain for ${e} is required for threshold scale.`}const ii=te.logger(te.Warn);let oi=ii;function si(e){oi=e;return oi}function li(){oi=ii;return oi}function ae(){oi.warn(...arguments)}function ci(){oi.debug(...arguments)}function ui(e){if(e&&te.isObject(e))for(const t of Si)if(t in e)return true;return false}const di=["january","february","march","april","may","june","july","august","september","october","november","december"],fi=di.map(e=>e.substr(0,3)),pi=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],hi=pi.map(e=>e.substr(0,3));function gi(e){if(Ve(e))e=+e;if(te.isNumber(e)){if(e>4)ae(Ja("quarter",e));return e-1}else throw new Error(Ja("quarter",e))}function mi(e){if(Ve(e))e=+e;if(te.isNumber(e))return e-1;else{const t=e.toLowerCase();const r=di.indexOf(t);if(r!==-1)return r;const n=t.substr(0,3);const a=fi.indexOf(n);if(a!==-1)return a;throw new Error(Ja("month",e))}}function _i(e){if(Ve(e))e=+e;if(te.isNumber(e))return e%7;else{const t=e.toLowerCase();const r=pi.indexOf(t);if(r!==-1)return r;const n=t.substr(0,3);const a=hi.indexOf(n);if(a!==-1)return a;throw new Error(Ja("day",e))}}function yi(e,t){const r=[];if(t&&e.day!==undefined)if(A(e).length>1){ae(Za(e));e=g(e);delete e.day}if(e.year!==undefined)r.push(e.year);else r.push(2012);if(e.month!==undefined){const n=t?mi(e.month):e.month;r.push(n)}else if(e.quarter!==undefined){const a=t?gi(e.quarter):e.quarter;r.push(te.isNumber(a)?a*3:`${a}*3`)}else r.push(0);if(e.date!==undefined)r.push(e.date);else if(e.day!==undefined){const i=t?_i(e.day):e.day;r.push(te.isNumber(i)?i+1:`${i}+1`)}else r.push(1);for(const o of["hours","minutes","seconds","milliseconds"]){const s=e[o];r.push(typeof s==="undefined"?0:s)}return r}function Ti(e){const t=yi(e,true);const r=t.join(", ");if(e.utc)return`utc(${r})`;else return`datetime(${r})`}function bi(e){const t=yi(e,false);const r=t.join(", ");if(e.utc)return`utc(${r})`;else return`datetime(${r})`}function vi(e){const t=yi(e,true);if(e.utc)return+new Date(Date.UTC(...t));else return+new Date(...t)}const Ei={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},Si=A(Ei);function Ai(e){return!!Ei[e]}function Oi(e){if(te.isObject(e))return e.binned;return Ci(e)}function Ci(e){return e&&e.startsWith("binned")}function ki(e){return e.startsWith("utc")}function wi(e){return e.substring(3)}const Ri={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function Ii(t){return Si.filter(e=>Pi(t,e))}function Mi(e){const t=Ii(e);return t[t.length-1]}function Pi(e,t){const r=e.indexOf(t);if(r<0)return false;if(r>0&&t==="seconds"&&e.charAt(r-1)==="i")return false;if(e.length>r+3&&t==="day"&&e.charAt(r+3)==="o")return false;if(r>0&&t==="year"&&e.charAt(r-1)==="f")return false;return true}function Ni(e,t){let{end:r}=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{end:false};const n=Ie(t);const a=ki(e)?"utc":"";function i(e){if(e==="quarter")return`(${a}quarter(${n})-1)`;else return`${a}${e}(${n})`}let o;const s={};for(const l of Si)if(Pi(e,l)){s[l]=i(l);o=l}if(r)s[o]+="+1";return bi(s)}function Di(e){if(!e)return undefined;const t=Ii(e);return`timeUnitSpecifier(${m(t)}, ${m(Ri)})`}function xi(e,t,r){if(!e)return undefined;const n=Di(e);const a=r||ki(e);return`${a?"utc":"time"}Format(${t}, ${n})`}function F(e){if(!e)return undefined;let t;if(te.isString(e))if(Ci(e))t={unit:e.substring(6),binned:true};else t={unit:e};else if(te.isObject(e))t={...e,...e.unit?{unit:e.unit}:{}};if(ki(t.unit)){t.utc=true;t.unit=wi(t.unit)}return t}function Li(e){const{utc:t,...r}=F(e);if(r.unit)return(t?"utc":"")+A(r).map(e=>k(`${e==="unit"?"":`_${e}_`}${r[e]}`)).join("");else return(t?"utc":"")+"timeunit"+A(r).map(e=>k(`_${e}_${r[e]}`)).join("")}function Fi(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:e=>e;const r=F(e);const n=Mi(r.unit);if(n&&n!=="day"){const a={year:2001,month:1,date:1,hours:0,minutes:0,seconds:0,milliseconds:0};const{step:i,part:o}=ji(n,r.step);const s={...a,[o]:+a[o]+i};return`${t(Ti(s))} - ${t(Ti(a))}`}return undefined}const Ui={year:1,month:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1};function Bi(e){return!!Ui[e]}function ji(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;if(Bi(e))return{part:e,step:t};switch(e){case"day":case"dayofyear":return{part:"date",step:t};case"quarter":return{part:"month",step:t*3};case"week":return{part:"date",step:t*7}}}function Hi(e){return e?.["param"]}function Gi(e){return!!e?.field&&e.equal!==undefined}function Vi(e){return!!e?.field&&e.lt!==undefined}function Wi(e){return!!e?.field&&e.lte!==undefined}function qi(e){return!!e?.field&&e.gt!==undefined}function $i(e){return!!e?.field&&e.gte!==undefined}function zi(e){if(e?.field)if(te.isArray(e.range)&&e.range.length===2)return true;else if(x(e.range))return true;return false}function Ki(e){return!!e?.field&&(te.isArray(e.oneOf)||te.isArray(e.in))}function Yi(e){return!!e?.field&&e.valid!==undefined}function Ji(e){return Ki(e)||Gi(e)||zi(e)||Vi(e)||qi(e)||Wi(e)||$i(e)}function Zi(e,t){return ec(e,{timeUnit:t,wrapTime:true})}function Qi(e,t){return e.map(e=>Zi(e,t))}function Xi(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;const{field:r}=e;const n=F(e.timeUnit);const{unit:a,binned:i}=n||{};const o=j(e,{expr:"datum"});const s=a?`time(${!i?Ni(a,r):o})`:o;if(Gi(e))return`${s}===${Zi(e.equal,a)}`;else if(Vi(e)){const l=e.lt;return`${s}<${Zi(l,a)}`}else if(qi(e)){const c=e.gt;return`${s}>${Zi(c,a)}`}else if(Wi(e)){const u=e.lte;return`${s}<=${Zi(u,a)}`}else if($i(e)){const d=e.gte;return`${s}>=${Zi(d,a)}`}else if(Ki(e))return`indexof([${Qi(e.oneOf,a).join(",")}], ${s}) !== -1`;else if(Yi(e))return eo(s,e.valid);else if(zi(e)){const{range:f}=e;const p=x(f)?{signal:`${f.signal}[0]`}:f[0];const h=x(f)?{signal:`${f.signal}[1]`}:f[1];if(p!==null&&h!==null&&t)return"inrange("+s+", ["+Zi(p,a)+", "+Zi(h,a)+"])";const g=[];if(p!==null)g.push(`${s} >= ${Zi(p,a)}`);if(h!==null)g.push(`${s} <= ${Zi(h,a)}`);return g.length>0?g.join(" && "):"true"}throw new Error(`Invalid field predicate: ${m(e)}`)}function eo(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(t)return`isValid(${e}) && isFinite(+${e})`;else return`!isValid(${e}) || !isFinite(+${e})`}function to(e){if(Ji(e)&&e.timeUnit)return{...e,timeUnit:F(e.timeUnit)};return e}const ro={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};function no(e){return e==="quantitative"||e==="temporal"}function ao(e){return e==="ordinal"||e==="nominal"}const io=ro.quantitative,oo=ro.ordinal,so=ro.temporal,lo=ro.nominal,co=ro.geojson;function uo(e){if(e){e=e.toLowerCase();switch(e){case"q":case io:return"quantitative";case"t":case so:return"temporal";case"o":case oo:return"ordinal";case"n":case lo:return"nominal";case co:return"geojson"}}return undefined}const y={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},fo={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function po(e,t){const r=fo[e];const n=fo[t];return r===n||r==="ordinal-position"&&n==="time"||n==="ordinal-position"&&r==="time"}const ho={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function go(e){return ho[e]}const mo=new Set(["linear","log","pow","sqrt","symlog"]),_o=new Set([...mo,"time","utc"]);function yo(e){return mo.has(e)}const To=new Set(["quantile","quantize","threshold"]),bo=new Set([..._o,...To,"sequential","identity"]),vo=new Set(["ordinal","bin-ordinal","point","band"]);function U(e){return vo.has(e)}function Eo(e){return bo.has(e)}function So(e){return _o.has(e)}function Ao(e){return To.has(e)}const Oo={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:4,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4,zero:true};function Co(e){return!te.isString(e)&&!!e["name"]}function ko(e){return e?.["param"]}function wo(e){return e?.["unionWith"]}function Ro(e){return te.isObject(e)&&"field"in e}const Io={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,domainRaw:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},{type:Mo,domain:Po,range:No,rangeMax:Do,rangeMin:xo,scheme:Lo,...Fo}=Io,Uo=A(Fo);function Bo(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return true;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return So(e)||e==="band"||e==="point";case"padding":case"rangeMin":case"rangeMax":return So(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return e==="band";case"domainMax":case"domainMid":case"domainMin":case"domainRaw":case"clamp":return So(e);case"nice":return So(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return Eo(e)&&!w(["log","time","utc","threshold","quantile"],e)}}function jo(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":if(!Dt(e))return Ra(t);return undefined;case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"domainRaw":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return undefined}}function Ho(e,t){if(w([oo,lo],t))return e===undefined||U(e);else if(t===so)return w([y.TIME,y.UTC,undefined],e);else if(t===io)return yo(e)||Ao(e)||e===undefined;return true}function Go(e,t){let r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(!Gr(e))return false;switch(e){case I:case M:case Ze:case Qe:case tt:case Xe:if(So(t))return true;else if(t==="band")return true;else if(t==="point")return!r;return false;case dt:case mt:case pt:case ht:case gt:case ft:return So(t)||Ao(t)||w(["band","point","ordinal"],t);case st:case lt:case ct:return t!=="band";case _t:case ut:return t==="ordinal"||Ao(t)}}function Vo(e){return te.isObject(e)&&"value"in e}const t={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},Wo=t.arc,qo=t.area,$o=t.bar,zo=t.image,Ko=t.line,Yo=t.point,Jo=t.rect,Zo=t.rule,Qo=t.text,Xo=t.tick,es=t.trail,ts=t.circle,rs=t.square,ns=t.geoshape;function as(e){return["line","area","trail"].includes(e)}function is(e){return["rect","bar","image","arc"].includes(e)}const os=new Set(A(t));function ss(e){return e["type"]}const ls=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],cs=["fill","fillOpacity"],us=[...ls,...cs],ds={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1},fs=A(ds),ps={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize","minBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize","minBandSize"],line:["point"],tick:["bandSize","thickness"]},hs={color:"#4c78a8",invalid:"break-paths-show-path-domains",timeUnitBandSize:1},gs={mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1},ms=A(gs);function _s(e){return e&&e["band"]!=undefined}const ys={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},Ts=5,bs={binSpacing:1,continuousBandSize:Ts,minBandSize:.25,timeUnitBandPosition:.5},vs={binSpacing:0,continuousBandSize:Ts,minBandSize:.25,timeUnitBandPosition:.5},Es={thickness:1};function Ss(e){return ss(e)?e.type:e}function As(e,t){let{isPath:r}=t;if(e===undefined||e==="break-paths-show-path-domains")return r?"break-paths-show-domains":"filter";else if(e===null)return"show";return e}function Os(e){let{markDef:t,config:r,scaleChannel:n,scaleType:a,isCountAggregate:i}=e;if(!a||!Eo(a)||i)return"always-valid";const o=As(ne("invalid",t,r),{isPath:as(t.type)});const s=r.scale?.invalid?.[n];if(s!==undefined)return"show";return o}function Cs(e){return e==="break-paths-filter-domains"||e==="break-paths-show-domains"}function ks(e){let{scaleName:t,scale:r,mode:n}=e;const a=`domain('${t}')`;if(!r||!t)return undefined;const i=`${a}[0]`;const o=`peek(${a})`;const s=r.domainHasZero();if(s==="definitely")return{scale:t,value:0};else if(s==="maybe"){const l=n==="zeroOrMin"?i:o;return{signal:`scale('${t}', inrange(0, ${a}) ? 0 : ${l})`}}else return{signal:`scale('${t}', ${n==="zeroOrMin"?i:o})`}}function ws(e){let{scaleChannel:t,channelDef:r,scale:n,scaleName:a,markDef:i,config:o}=e;const s=n?.get("type");const l=Wl(r);const c=tn(l?.aggregate);const u=Os({scaleChannel:t,markDef:i,config:o,scaleType:s,isCountAggregate:c});if(l&&u==="show"){const d=o.scale.invalid?.[t]??"zero-or-min";return{test:eo(j(l,{expr:"datum"}),false),...Rs(d,n,a)}}return undefined}function Rs(e,t,r){if(Vo(e)){const{value:n}=e;return x(n)?{signal:n.signal}:{value:n}}return ks({scale:t,scaleName:r,mode:"zeroOrMin"})}function Is(e){const{channel:t,channelDef:r,markDef:n,scale:a,scaleName:i,config:o}=e;const s=Zt(t);const l=xs(e);const c=ws({scaleChannel:s,channelDef:r,scale:a,scaleName:i,markDef:n,config:o});return c!==undefined?[c,l]:l}function Ms(e){const{datum:t}=e;if(ui(t))return Ti(t);return`${m(t)}`}function Ps(e,t,r,n){const a={};if(t)a.scale=t;if(Tl(e)){const{datum:i}=e;if(ui(i))a.signal=Ti(i);else if(x(i))a.signal=i.signal;else if(un(i))a.signal=i.expr;else a.value=i}else a.field=j(e,r);if(n){const{offset:o,band:s}=n;if(o)a.offset=o;if(s)a.band=s}return a}function Ns(e){let{scaleName:t,fieldOrDatumDef:r,fieldOrDatumDef2:n,offset:a,startSuffix:i,endSuffix:o="end",bandPosition:s=.5}=e;const l=!x(s)&&0<s&&s<1?"datum":undefined;const c=j(r,{expr:l,suffix:i});const u=n!==undefined?j(n,{expr:l}):j(r,{suffix:o,expr:l});const d={};if(s===0||s===1){d.scale=t;const f=s===0?c:u;d.field=f}else{const p=x(s)?`(1-${s.signal}) * ${c} + ${s.signal} * ${u}`:`${1-s} * ${c} + ${s} * ${u}`;d.signal=`scale("${t}", ${p})`}if(a)d.offset=a;return d}function Ds(e){let{scaleName:t,fieldDef:r}=e;const n=j(r,{expr:"datum"});const a=j(r,{expr:"datum",suffix:"end"});return`abs(scale("${t}", ${a}) - scale("${t}", ${n}))`}function xs(e){let{channel:t,channelDef:r,channel2Def:n,markDef:a,config:i,scaleName:o,scale:s,stack:l,offset:c,defaultRef:u,bandPosition:d}=e;if(r)if(T(r)){const f=s?.get("type");if(v(r)){d??=ul({fieldDef:r,fieldDef2:n,markDef:a,config:i});const{bin:p,timeUnit:h,type:g}=r;if(N(p)||d&&h&&g===so){if(l?.impute)return Ps(r,o,{binSuffix:"mid"},{offset:c});if(d&&!U(f))return Ns({scaleName:o,fieldOrDatumDef:r,bandPosition:d,offset:c});return Ps(r,o,rc(r,t)?{binSuffix:"range"}:{},{offset:c})}else if(D(p))if(B(n))return Ns({scaleName:o,fieldOrDatumDef:r,fieldOrDatumDef2:n,bandPosition:d,offset:c});else{const m=t===I?Ye:Je;ae(ri(m))}}return Ps(r,o,U(f)?{binSuffix:"range"}:{},{offset:c,band:f==="band"?d??r.bandPosition??.5:undefined})}else if(Sl(r)){const _=r.value;const y=c?{offset:c}:{};return{...Ls(t,_),...y}}if(te.isFunction(u))u=u();if(u)return{...u,...c?{offset:c}:{}};return u}function Ls(e,t){if(w(["x","x2"],e)&&t==="width")return{field:{group:"width"}};else if(w(["y","y2"],e)&&t==="height")return{field:{group:"height"}};return L(t)}function Fs(e){return e&&e!=="number"&&e!=="time"}function Us(e,t,r){return`${e}(${t}${r?`, ${m(r)}`:""})`}const Bs=" – ";function js(e){let{fieldOrDatumDef:t,format:r,formatType:n,expr:a,normalizeStack:i,config:o}=e;if(Fs(n))return Gs({fieldOrDatumDef:t,format:r,formatType:n,expr:a,config:o});const s=Hs(t,a,i);const l=yl(t);if(r===undefined&&n===undefined&&o.customFormatTypes){if(l==="quantitative"){if(i&&o.normalizedNumberFormatType)return Gs({fieldOrDatumDef:t,format:o.normalizedNumberFormat,formatType:o.normalizedNumberFormatType,expr:a,config:o});if(o.numberFormatType)return Gs({fieldOrDatumDef:t,format:o.numberFormat,formatType:o.numberFormatType,expr:a,config:o})}if(l==="temporal"&&o.timeFormatType&&B(t)&&t.timeUnit===undefined)return Gs({fieldOrDatumDef:t,format:o.timeFormat,formatType:o.timeFormatType,expr:a,config:o})}if(Ql(t)){const c=Js({field:s,timeUnit:B(t)?F(t.timeUnit)?.unit:undefined,format:r,formatType:o.timeFormatType,rawTimeFormat:o.timeFormat,isUTCScale:Al(t)&&t.scale?.type===y.UTC});return c?{signal:c}:undefined}r=qs({type:l,specifiedFormat:r,config:o,normalizeStack:i});if(B(t)&&N(t.bin)){const u=j(t,{expr:a,binSuffix:"end"});return{signal:Ys(s,u,r,n,o)}}else if(r||yl(t)==="quantitative")return{signal:`${zs(s,r)}`};else return{signal:`isValid(${s}) ? ${s} : ""+${s}`}}function Hs(e,t,r){if(B(e))if(r)return`${j(e,{expr:t,suffix:"end"})}-${j(e,{expr:t,suffix:"start"})}`;else return j(e,{expr:t});else return Ms(e)}function Gs(e){let{fieldOrDatumDef:t,format:r,formatType:n,expr:a,normalizeStack:i,config:o,field:s}=e;s??=Hs(t,a,i);if(s!=="datum.value"&&B(t)&&N(t.bin)){const l=j(t,{expr:a,binSuffix:"end"});return{signal:Ys(s,l,r,n,o)}}return{signal:Us(n,s,r)}}function Vs(e,t,r,n,a,i){if(te.isString(n)&&Fs(n))return undefined;else if(r===undefined&&n===undefined&&a.customFormatTypes)if(yl(e)==="quantitative"){if(a.normalizedNumberFormatType&&Ol(e)&&e.stack==="normalize")return undefined;if(a.numberFormatType)return undefined}if(Ol(e)&&e.stack==="normalize"&&a.normalizedNumberFormat)return qs({type:"quantitative",config:a,normalizeStack:true});if(Ql(e)){const o=B(e)?F(e.timeUnit)?.unit:undefined;if(o===undefined&&a.customFormatTypes&&a.timeFormatType)return undefined;return $s({specifiedFormat:r,timeUnit:o,config:a,omitTimeFormatConfig:i})}return qs({type:t,specifiedFormat:r,config:a})}function Ws(e,t,r){if(e&&(x(e)||e==="number"||e==="time"))return e;if(Ql(t)&&r!=="time"&&r!=="utc")return B(t)&&F(t?.timeUnit)?.utc?"utc":"time";return undefined}function qs(e){let{type:t,specifiedFormat:r,config:n,normalizeStack:a}=e;if(te.isString(r))return r;if(t===io)return a?n.normalizedNumberFormat:n.numberFormat;return undefined}function $s(e){let{specifiedFormat:t,timeUnit:r,config:n,omitTimeFormatConfig:a}=e;if(t)return t;if(r)return{signal:Di(r)};return a?undefined:n.timeFormat}function zs(e,t){return`format(${e}, "${t||""}")`}function Ks(e,t,r,n){if(Fs(r))return Us(r,e,t);return zs(e,(te.isString(t)?t:undefined)??n.numberFormat)}function Ys(e,t,r,n,a){if(r===undefined&&n===undefined&&a.customFormatTypes&&a.numberFormatType)return Ys(e,t,a.numberFormat,a.numberFormatType,a);const i=Ks(e,r,n,a);const o=Ks(t,r,n,a);return`${eo(e,false)} ? "null" : ${i} + "${Bs}" + ${o}`}function Js(e){let{field:t,timeUnit:r,format:n,formatType:a,rawTimeFormat:i,isUTCScale:o}=e;if(!r||n){if(!r&&a)return`${a}(${t}, '${n}')`;n=te.isString(n)?n:i;return`${o?"utc":"time"}Format(${t}, '${n}')`}else return xi(r,t,o)}const Zs="min",Qs={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function Xs(e){return e in Qs}function el(e){return!!e?.["encoding"]}function tl(e){return e&&(e["op"]==="count"||!!e["field"])}function rl(e){return e&&te.isArray(e)}function nl(e){return"row"in e||"column"in e}function al(e){return!!e&&"header"in e}function il(e){return"facet"in e}function ol(e){return e["param"]}function sl(e){return e&&!te.isString(e)&&"repeat"in e}function ll(e){const{field:t,timeUnit:r,bin:n,aggregate:a}=e;return{...r?{timeUnit:r}:{},...n?{bin:n}:{},...a?{aggregate:a}:{},field:t}}function cl(e){return"sort"in e}function ul(e){let{fieldDef:t,fieldDef2:r,markDef:n,config:a}=e;if(T(t)&&t.bandPosition!==undefined)return t.bandPosition;if(B(t)){const{timeUnit:i,bin:o}=t;if(i&&!r)return Rn("timeUnitBandPosition",n,a);else if(N(o))return.5}return undefined}function dl(e){let{channel:t,fieldDef:r,fieldDef2:n,markDef:a,config:i,scaleType:o,useVlSizeChannel:s}=e;const l=er(t);const c=ne(s?"size":l,a,i,{vgChannel:l});if(c!==undefined)return c;if(B(r)){const{timeUnit:u,bin:d}=r;if(u&&!n)return{band:Rn("timeUnitBandSize",a,i)};else if(N(d)&&!U(o))return{band:1}}if(is(a.type)){if(o)if(U(o))return i[a.type]?.discreteBandSize||{band:1};else return i[a.type]?.continuousBandSize;return i[a.type]?.discreteBandSize}return undefined}function fl(e,t,r,n){if(N(e.bin)||e.timeUnit&&v(e)&&e.type==="temporal")return ul({fieldDef:e,fieldDef2:t,markDef:r,config:n})!==undefined;return false}function pl(e){return e&&!!e.sort&&!e["field"]}function hl(e){return e&&"condition"in e}function gl(e){const t=e?.["condition"];return!!t&&!te.isArray(t)&&B(t)}function ml(e){const t=e?.["condition"];return!!t&&!te.isArray(t)&&T(t)}function _l(e){const t=e?.["condition"];return!!t&&(te.isArray(t)||Sl(t))}function B(e){return e&&(!!e["field"]||e["aggregate"]==="count")}function yl(e){return e?.["type"]}function Tl(e){return e&&"datum"in e}function bl(e){return v(e)&&!Il(e)||El(e)}function vl(e){return v(e)&&e.type==="quantitative"&&!e.bin||El(e)}function El(e){return Tl(e)&&te.isNumber(e.datum)}function T(e){return B(e)||Tl(e)}function v(e){return e&&("field"in e||e["aggregate"]==="count")&&"type"in e}function Sl(e){return e&&"value"in e&&"value"in e}function Al(e){return e&&("scale"in e||"sort"in e)}function Ol(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function Cl(e){return e&&"legend"in e}function kl(e){return e&&("format"in e||"formatType"in e)}function wl(e){return pe(e,["legend","axis","header","scale"])}function Rl(e){return"op"in e}function j(t){let r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};let n=t.field;const e=r.prefix;let a=r.suffix;let i="";if(Pl(t))n=je("count");else{let e;if(!r.nofn)if(Rl(t))e=t.op;else{const{bin:o,aggregate:s,timeUnit:l}=t;if(N(o)){e=on(o);a=(r.binSuffix??"")+(r.suffix??"")}else if(s)if(Qr(s)){i=`["${n}"]`;n=`argmax_${s.argmax}`}else if(Zr(s)){i=`["${n}"]`;n=`argmin_${s.argmin}`}else e=String(s);else if(l&&!Oi(l)){e=Li(l);a=(!["range","mid"].includes(r.binSuffix)&&r.binSuffix||"")+(r.suffix??"")}}if(e)n=n?`${e}_${n}`:e}if(a)n=`${n}_${a}`;if(e)n=`${e}_${n}`;if(r.forAs)return xe(n);else if(r.expr)return Me(n,r.expr)+i;else return Ne(n)+i}function Il(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return true;case"quantitative":return B(e)&&!!e.bin;case"temporal":return false}throw new Error(pa(e.type))}function Ml(e){return Al(e)&&Ao(e.scale?.type)}function Pl(e){return e.aggregate==="count"}function Nl(e,t){const{field:r,bin:n,timeUnit:a,aggregate:i}=e;if(i==="count")return t.countTitle;else if(N(n))return`${r} (binned)`;else if(a&&!Oi(a)){const o=F(a)?.unit;if(o)return`${r} (${Ii(o).join("-")})`}else if(i)if(Qr(i))return`${r} for max ${i.argmax}`;else if(Zr(i))return`${r} for min ${i.argmin}`;else return`${Re(i)} of ${r}`;return r}function Dl(e){const{aggregate:t,bin:r,timeUnit:n,field:a}=e;if(Qr(t))return`${a} for argmax(${t.argmax})`;else if(Zr(t))return`${a} for argmin(${t.argmin})`;const i=n&&!Oi(n)?F(n):undefined;const o=t||i?.unit||i?.maxbins&&"timeunit"||N(r)&&"bin";if(o)return`${o.toUpperCase()}(${a})`;else return a}const xl=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return Dl(e);default:return Nl(e,t)}};let Ll=xl;function Fl(e){Ll=e}function Ul(){Fl(xl)}function Bl(e,t,r){let{allowDisabling:n,includeDefault:a=true}=r;const i=jl(e)?.title;if(!B(e))return i??e.title;const o=e;const s=a?Hl(o,t):undefined;if(n)return R(i,o.title,s);else return i??o.title??s}function jl(e){if(Ol(e)&&e.axis)return e.axis;else if(Cl(e)&&e.legend)return e.legend;else if(al(e)&&e.header)return e.header;return undefined}function Hl(e,t){return Ll(e,t)}function Gl(e){if(kl(e)){const{format:t,formatType:r}=e;return{format:t,formatType:r}}else{const n=jl(e)??{};const{format:a,formatType:i}=n;return{format:a,formatType:i}}}function Vl(e,t){switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(cl(e)&&te.isArray(e.sort))return"ordinal";const{aggregate:r,bin:n,timeUnit:a}=e;if(a)return"temporal";if(n||r&&!Qr(r)&&!Zr(r))return"quantitative";if(Al(e)&&e.scale?.type)switch(fo[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}function Wl(e){if(B(e))return e;else if(gl(e))return e.condition;return undefined}function H(e){if(T(e))return e;else if(ml(e))return e.condition;return undefined}function ql(e,t,r){let n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};if(te.isString(e)||te.isNumber(e)||te.isBoolean(e)){const a=te.isString(e)?"string":te.isNumber(e)?"number":"boolean";ae(fa(t,a,e));return{value:e}}if(T(e))return $l(e,t,r,n);else if(ml(e))return{...e,condition:$l(e.condition,t,r,n)};return e}function $l(e,t,r,n){if(kl(e)){const{format:a,formatType:i,...o}=e;if(Fs(i)&&!r.customFormatTypes){ae(la(t));return $l(o,t,r,n)}}else{const s=Ol(e)?"axis":Cl(e)?"legend":al(e)?"header":null;if(s&&e[s]){const{format:l,formatType:c,...u}=e[s];if(Fs(c)&&!r.customFormatTypes){ae(la(t));return $l({...e,[s]:u},t,r,n)}}}if(B(e))return Kl(e,t,n);return zl(e)}function zl(e){let t=e["type"];if(t)return e;const{datum:r}=e;t=te.isNumber(r)?"quantitative":te.isString(r)?"nominal":ui(r)?"temporal":undefined;return{...e,type:t}}function Kl(e,t){let{compositeMark:r=false}=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};const{aggregate:n,timeUnit:a,bin:i,field:o}=e;const s={...e};if(!r&&n&&!Xr(n)&&!Qr(n)&&!Zr(n)){ae(ga(n));delete s.aggregate}if(a)s.timeUnit=F(a);if(o)s.field=`${o}`;if(N(i))s.bin=Yl(i,t);if(D(i)&&!P(t))ae(ni(t));if(v(s)){const{type:l}=s;const c=uo(l);if(l!==c)s.type=c;if(l!=="quantitative")if(tn(n)){ae(ha(l,n));s.type="quantitative"}}else if(!Jt(t)){const u=Vl(s,t);s["type"]=u}if(v(s)){const{compatible:d,warning:f}=Zl(s,t)||{};if(d===false)ae(f)}if(cl(s)&&te.isString(s.sort)){const{sort:p}=s;if(Xs(p))return{...s,sort:{encoding:p}};const h=p.substr(1);if(p.charAt(0)==="-"&&Xs(h))return{...s,sort:{encoding:h,order:"descending"}}}if(al(s)){const{header:g}=s;if(g){const{orient:m,..._}=g;if(m)return{...s,header:{..._,labelOrient:g.labelOrient||m,titleOrient:g.titleOrient||m}}}}return s}function Yl(e,t){if(te.isBoolean(e))return{maxbins:cn(t)};else if(e==="binned")return{binned:true};else if(!e.maxbins&&!e.step)return{...e,maxbins:cn(t)};else return e}const Jl={compatible:true};function Zl(e,t){const r=e.type;if(r==="geojson"&&t!=="shape")return{compatible:false,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case $e:case ze:case Ke:if(!Il(e))return{compatible:false,warning:Ea(t)};return Jl;case I:case M:case Ze:case Qe:case st:case lt:case ct:case yt:case bt:case vt:case Et:case St:case At:case ft:case tt:case Xe:case Ot:return Jl;case at:case ot:case nt:case it:if(r!==io)return{compatible:false,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`};return Jl;case pt:case ht:case gt:case mt:case dt:case rt:case et:case Ye:case Je:if(r==="nominal"&&!e["sort"])return{compatible:false,warning:`Channel ${t} should not be used with an unsorted discrete field.`};return Jl;case ut:case _t:if(!Il(e)&&!Ml(e))return{compatible:false,warning:Sa(t)};return Jl;case Tt:if(e.type==="nominal"&&!("sort"in e))return{compatible:false,warning:`Channel order is inappropriate for nominal field, which has no inherent order.`};return Jl}}function Ql(e){const{formatType:t}=Gl(e);return t==="time"||!t&&Xl(e)}function Xl(e){return e&&(e["type"]==="temporal"||B(e)&&!!e.timeUnit)}function ec(e,t){let{timeUnit:r,type:n,wrapTime:a,undefinedIfExprNotRequired:i}=t;const o=r&&F(r)?.unit;let s=o||n==="temporal";let l;if(un(e))l=e.expr;else if(x(e))l=e.signal;else if(ui(e)){s=true;l=Ti(e)}else if(te.isString(e)||te.isNumber(e))if(s){l=`datetime(${m(e)})`;if(Ai(o))if(te.isNumber(e)&&e<1e4||te.isString(e)&&isNaN(Date.parse(e)))l=Ti({[o]:e})}if(l)return a&&s?`time(${l})`:l;return i?undefined:m(e)}function tc(n,e){const{type:a}=n;return e.map(e=>{const t=B(n)&&!Oi(n.timeUnit)?n.timeUnit:undefined;const r=ec(e,{timeUnit:t,type:a,undefinedIfExprNotRequired:true});if(r!==undefined)return{signal:r};return e})}function rc(e,t){if(!N(e.bin)){console.warn("Only call this method for binned field defs.");return false}return Gr(t)&&["ordinal","nominal"].includes(e.type)}const nc={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function ac(e){return e?.condition}const ic=["domain","grid","labels","ticks","title"],oc={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},sc={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},lc={...sc,style:1,labelExpr:1,encoding:1};function cc(e){return!!lc[e]}const uc={axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1},dc=A(uc);function fc(e){return"mark"in e}class pc{constructor(e,t){this.name=e;this.run=t}hasMatchingType(e){if(fc(e))return Ss(e.mark)===this.name;return false}}function hc(e,t){const r=e&&e[t];if(r)if(te.isArray(r))return ge(r,e=>!!e.field);else return B(r)||gl(r);return false}function gc(e,t){const r=e&&e[t];if(r)if(te.isArray(r))return ge(r,e=>!!e.field);else return B(r)||Tl(r)||ml(r);return false}function mc(e,t){if(P(t)){const r=e[t];if((B(r)||Tl(r))&&(ao(r.type)||B(r)&&r.timeUnit)){const n=rr(t);return gc(e,n)}}return false}function _c(n){return ge(Ut,e=>{if(hc(n,e)){const t=n[e];if(te.isArray(t))return ge(t,e=>!!e.aggregate);else{const r=Wl(t);return r&&!!r.aggregate}}return false})}function yc(t,h){const g=[];const m=[];const _=[];const y=[];const T={};Sc(t,(e,r)=>{if(B(e)){const{field:n,aggregate:a,bin:i,timeUnit:o,...s}=e;if(a||o||i){const l=jl(e);const c=l?.title;let t=j(e,{forAs:true});const u={...c?[]:{title:Bl(e,h,{allowDisabling:true})},...s,field:t};if(a){let e;if(Qr(a)){e="argmax";t=j({op:"argmax",field:a.argmax},{forAs:true});u.field=`${t}.${n}`}else if(Zr(a)){e="argmin";t=j({op:"argmin",field:a.argmin},{forAs:true});u.field=`${t}.${n}`}else if(a!=="boxplot"&&a!=="errorbar"&&a!=="errorband")e=a;if(e){const d={op:e,as:t};if(n)d.field=n;y.push(d)}}else{g.push(t);if(v(e)&&N(i)){m.push({bin:i,field:n,as:t});g.push(j(e,{binSuffix:"end"}));if(rc(e,r))g.push(j(e,{binSuffix:"range"}));if(P(r)){const f={field:`${t}_end`};T[`${r}2`]=f}u.bin="binned";if(!Jt(r))u["type"]=io}else if(o&&!Oi(o)){_.push({timeUnit:o,field:n,as:t});const p=v(e)&&e.type!==so&&"time";if(p)if(r===yt||r===Et)u["formatType"]=p;else if(Ur(r))u["legend"]={formatType:p,...u["legend"]};else if(P(r))u["axis"]={formatType:p,...u["axis"]}}}T[r]=u}else{g.push(n);T[r]=t[r]}}else T[r]=t[r]});return{bins:m,timeUnits:_,aggregate:y,groupby:g,encoding:T}}function Tc(e,t,r){const n=Vr(t,r);if(!n)return false;else if(n==="binned"){const a=e[t===Ye?I:M];if(B(a)&&B(e[t])&&D(a.bin))return true;else return false}return true}function bc(e,t,n,a){const i={};for(const r of A(e))if(!Kt(r))ae(va(r));for(let r of ar){if(!e[r])continue;const o=e[r];if(kr(r)){const s=nr(r);const l=i[s];if(B(l))if(no(l.type))if(B(o)&&!l.timeUnit){ae(da(s));continue}}if(r==="angle"&&t==="arc"&&!e.theta){ae(ua);r=tt}if(!Tc(e,r,t)){ae(ba(r,t));continue}if(r===dt&&t==="line"){const c=Wl(e[r]);if(c?.aggregate){ae(Ta);continue}}if(r===st&&(n?"fill"in e:"stroke"in e)){ae(ma("encoding",{fill:"fill"in e,stroke:"stroke"in e}));continue}if(r===bt||r===Tt&&!te.isArray(o)&&!Sl(o)||r===Et&&te.isArray(o)){if(o){if(r===Tt){const u=e[r];if(pl(u)){i[r]=u;continue}}i[r]=te.array(o).reduce((e,t)=>{if(!B(t))ae(ya(t,r));else e.push(Kl(t,r));return e},[])}}else{if(r===Et&&o===null)i[r]=null;else if(!B(o)&&!Tl(o)&&!Sl(o)&&!hl(o)&&!x(o)){ae(ya(o,r));continue}i[r]=ql(o,r,a)}}return i}function vc(e,t){const r={};for(const n of A(e)){const a=ql(e[n],n,t,{compositeMark:true});r[n]=a}return r}function Ec(e){const t=[];for(const r of A(e))if(hc(e,r)){const n=e[r];const a=te.array(n);for(const i of a)if(B(i))t.push(i);else if(gl(i))t.push(i.condition)}return t}function Sc(e,t,r){if(!e)return;for(const n of A(e)){const a=e[n];if(te.isArray(a))for(const i of a)t.call(r,i,n);else t.call(r,a,n)}}function Ac(n,a,e,i){if(!n)return e;return A(n).reduce((e,r)=>{const t=n[r];if(te.isArray(t))return t.reduce((e,t)=>{return a.call(i,e,t,r)},e);else return a.call(i,e,t,r)},e)}function Oc(i,o){return A(o).reduce((e,t)=>{switch(t){case I:case M:case St:case Ot:case At:case Ye:case Je:case Ze:case Qe:case tt:case rt:case Xe:case et:case nt:case at:case it:case ot:case yt:case ut:case ft:case Et:return e;case Tt:if(i==="line"||i==="trail")return e;case bt:case vt:{const r=o[t];if(te.isArray(r)||B(r))for(const n of te.array(r))if(!n.aggregate)e.push(j(n,{}));return e}case dt:if(i==="trail")return e;case st:case lt:case ct:case pt:case ht:case gt:case _t:case mt:{const a=Wl(o[t]);if(a&&!a.aggregate)e.push(j(a,{}));return e}}},[])}function Cc(e){const{tooltip:t,...r}=e;if(!t)return{filteredEncoding:r};let n;let a;if(te.isArray(t)){for(const i of t)if(i.aggregate){if(!n)n=[];n.push(i)}else{if(!a)a=[];a.push(i)}if(n)r.tooltip=n}else if(t["aggregate"])r.tooltip=t;else a=t;if(te.isArray(a)&&a.length===1)a=a[0];return{customTooltipWithoutAggregatedField:a,filteredEncoding:r}}function kc(e,a,t){let i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;if("tooltip"in t)return{tooltip:t.tooltip};const r=e.map(e=>{let{fieldPrefix:t,titlePrefix:r}=e;const n=i?` of ${wc(a)}`:"";return{field:t+a.field,type:a.type,title:x(r)?{signal:`${r}"${escape(n)}"`}:r+n}});const n=Ec(t).map(wl);return{tooltip:[...r,...Te(n,S)]}}function wc(e){const{title:t,field:r}=e;return R(t,r)}function Rc(s,l,c,u,d){const{scale:f,axis:p}=c;return e=>{let{partName:t,mark:r,positionPrefix:n,endPositionPrefix:a=undefined,extraEncoding:i={}}=e;const o=wc(c);return Ic(s,t,d,{mark:r,encoding:{[l]:{field:`${n}_${c.field}`,type:c.type,...o!==undefined?{title:o}:{},...f!==undefined?{scale:f}:{},...p!==undefined?{axis:p}:{}},...te.isString(a)?{[`${l}2`]:{field:`${a}_${c.field}`}}:{},...u,...i}})}}function Ic(e,t,r,n){const{clip:a,color:i,opacity:o}=e;const s=e.type;if(e[t]||e[t]===undefined&&r[t])return[{...n,mark:{...r[t],...a?{clip:a}:{},...i?{color:i}:{},...o?{opacity:o}:{},...ss(n.mark)?n.mark:{type:n.mark},style:`${s}-${String(t)}`,...te.isBoolean(e[t])?{}:e[t]}}];return[]}function Mc(e,t,r){const{encoding:n}=e;const a=t==="vertical"?"y":"x";const i=n[a];const o=n[`${a}2`];const s=n[`${a}Error`];const l=n[`${a}Error2`];return{continuousAxisChannelDef:Pc(i,r),continuousAxisChannelDef2:Pc(o,r),continuousAxisChannelDefError:Pc(s,r),continuousAxisChannelDefError2:Pc(l,r),continuousAxis:a}}function Pc(e,t){if(e?.aggregate){const{aggregate:r,...n}=e;if(r!==t)ae(ei(r,t));return n}else return e}function Nc(e,t){const{mark:r,encoding:n}=e;const{x:a,y:i}=n;if(ss(r)&&r.orient)return r.orient;if(bl(a)){if(bl(i)){const o=B(a)&&a.aggregate;const s=B(i)&&i.aggregate;if(!o&&s===t)return"vertical";else if(!s&&o===t)return"horizontal";else if(o===t&&s===t)throw new Error("Both x and y cannot have aggregate");else{if(Ql(i)&&!Ql(a))return"horizontal";return"vertical"}}return"horizontal"}else if(bl(i))return"vertical";else throw new Error(`Need a valid continuous axis for ${t}s`)}const Dc="boxplot",xc=["box","median","outliers","rule","ticks"],Lc=new pc(Dc,Uc);function Fc(e){if(te.isNumber(e))return"tukey";return e}function Uc(e,L){let{config:t}=L;e={...e,encoding:vc(e.encoding,t)};const{mark:r,encoding:F,params:U,projection:B,...n}=e;const a=ss(r)?r:{type:r};if(U)ae(qn("boxplot"));const i=a.extent??t.boxplot.extent;const o=ne("size",a,t);const s=a.invalid;const l=Fc(i);const{bins:j,timeUnits:H,transform:c,continuousAxisChannelDef:u,continuousAxis:d,groupby:f,aggregate:G,encodingWithoutContinuousAxis:p,ticksOrient:h,boxOrient:V,customTooltipWithoutAggregatedField:g}=jc(e,i,t);const m=xe(u.field);const{color:_,size:y,...T}=p;const b=e=>{return Rc(a,d,u,e,t.boxplot)};const v=b(T);const W=b(p);const q=(te.isObject(t.boxplot.box)?t.boxplot.box.color:t.mark.color)||"#4c78a8";const $=b({...T,...y?{size:y}:{},color:{condition:{test:`datum['lower_box_${u.field}'] >= datum['upper_box_${u.field}']`,..._||{value:q}}}});const E=kc([{fieldPrefix:l==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:l==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],u,p);const S={type:"tick",color:"black",opacity:1,orient:h,invalid:s,aria:false};const A=l==="min-max"?E:kc([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],u,p);const O=[...v({partName:"rule",mark:{type:"rule",invalid:s,aria:false},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:A}),...v({partName:"rule",mark:{type:"rule",invalid:s,aria:false},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:A}),...v({partName:"ticks",mark:S,positionPrefix:"lower_whisker",extraEncoding:A}),...v({partName:"ticks",mark:S,positionPrefix:"upper_whisker",extraEncoding:A})];const C=[...l!=="tukey"?O:[],...W({partName:"box",mark:{type:"bar",...o?{size:o}:{},orient:V,invalid:s,ariaRoleDescription:"box"},positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:E}),...$({partName:"median",mark:{type:"tick",invalid:s,...te.isObject(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{},...o?{size:o}:{},orient:h,aria:false},positionPrefix:"mid_box",extraEncoding:E})];if(l==="min-max")return{...n,transform:(n.transform??[]).concat(c),layer:C};const k=`datum["lower_box_${u.field}"]`;const w=`datum["upper_box_${u.field}"]`;const R=`(${w} - ${k})`;const I=`${k} - ${i} * ${R}`;const M=`${w} + ${i} * ${R}`;const P=`datum["${u.field}"]`;const z={joinaggregate:Bc(u.field),groupby:f};const N={transform:[{filter:`(${I} <= ${P}) && (${P} <= ${M})`},{aggregate:[{op:"min",field:u.field,as:`lower_whisker_${m}`},{op:"max",field:u.field,as:`upper_whisker_${m}`},{op:"min",field:`lower_box_${u.field}`,as:`lower_box_${m}`},{op:"max",field:`upper_box_${u.field}`,as:`upper_box_${m}`},...G],groupby:f}],layer:O};const{tooltip:K,...Y}=T;const{scale:D,axis:J}=u;const Z=wc(u);const Q=pe(J,["title"]);const X=Ic(a,"outliers",t.boxplot,{transform:[{filter:`(${P} < ${I}) || (${P} > ${M})`}],mark:"point",encoding:{[d]:{field:u.field,type:u.type,...Z!==undefined?{title:Z}:{},...D!==undefined?{scale:D}:{},...re(Q)?{}:{axis:Q}},...Y,..._?{color:_}:{},...g?{tooltip:g}:{}}})[0];let x;const ee=[...j,...H,z];if(X)x={transform:ee,layer:[X,N]};else{x=N;x.transform.unshift(...ee)}return{...n,layer:[x,{transform:c,layer:C}]}}function Bc(e){const t=xe(e);return[{op:"q1",field:e,as:`lower_box_${t}`},{op:"q3",field:e,as:`upper_box_${t}`}]}function jc(e,t,r){const n=Nc(e,Dc);const{continuousAxisChannelDef:a,continuousAxis:i}=Mc(e,n,Dc);const o=a.field;const s=xe(o);const l=Fc(t);const c=[...Bc(o),{op:"median",field:o,as:`mid_box_${s}`},{op:"min",field:o,as:(l==="min-max"?"lower_whisker_":"min_")+s},{op:"max",field:o,as:(l==="min-max"?"upper_whisker_":"max_")+s}];const u=l==="min-max"||l==="tukey"?[]:[{calculate:`datum["upper_box_${s}"] - datum["lower_box_${s}"]`,as:`iqr_${s}`},{calculate:`min(datum["upper_box_${s}"] + datum["iqr_${s}"] * ${t}, datum["max_${s}"])`,as:`upper_whisker_${s}`},{calculate:`max(datum["lower_box_${s}"] - datum["iqr_${s}"] * ${t}, datum["min_${s}"])`,as:`lower_whisker_${s}`}];const{[i]:d,...f}=e.encoding;const{customTooltipWithoutAggregatedField:p,filteredEncoding:h}=Cc(f);const{bins:g,timeUnits:m,aggregate:_,groupby:y,encoding:T}=yc(h,r);const b=n==="vertical"?"horizontal":"vertical";const v=n;const E=[...g,...m,{aggregate:[..._,...c],groupby:y},...u];return{bins:g,timeUnits:m,transform:E,groupby:y,aggregate:_,continuousAxisChannelDef:a,continuousAxis:i,encodingWithoutContinuousAxis:T,ticksOrient:b,boxOrient:v,customTooltipWithoutAggregatedField:p}}const Hc="errorbar",Gc=["ticks","rule"],Vc=new pc(Hc,Wc);function Wc(e,t){let{config:r}=t;e={...e,encoding:vc(e.encoding,r)};const{transform:n,continuousAxisChannelDef:a,continuousAxis:i,encodingWithoutContinuousAxis:o,ticksOrient:s,markDef:l,outerSpec:c,tooltipEncoding:u}=Yc(e,Hc,r);delete o["size"];const d=Rc(l,i,a,o,r.errorbar);const f=l.thickness;const p=l.size;const h={type:"tick",orient:s,aria:false,...f!==undefined?{thickness:f}:{},...p!==undefined?{size:p}:{}};const g=[...d({partName:"ticks",mark:h,positionPrefix:"lower",extraEncoding:u}),...d({partName:"ticks",mark:h,positionPrefix:"upper",extraEncoding:u}),...d({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar",...f!==undefined?{size:f}:{}},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u})];return{...c,transform:n,...g.length>1?{layer:g}:{...g[0]}}}function qc(e,t){const{encoding:r}=e;if($c(r))return{orient:Nc(e,t),inputType:"raw"};const n=zc(r);const a=Kc(r);const i=r.x;const o=r.y;if(n){if(a)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const s=r.x2;const l=r.y2;if(T(s)&&T(l))throw new Error(`${t} cannot have both x2 and y2`);else if(T(s))if(bl(i))return{orient:"horizontal",inputType:"aggregated-upper-lower"};else throw new Error(`Both x and x2 have to be quantitative in ${t}`);else if(T(l))if(bl(o))return{orient:"vertical",inputType:"aggregated-upper-lower"};else throw new Error(`Both y and y2 have to be quantitative in ${t}`);throw new Error("No ranged axis")}else{const c=r.xError;const u=r.xError2;const d=r.yError;const f=r.yError2;if(T(u)&&!T(c))throw new Error(`${t} cannot have xError2 without xError`);if(T(f)&&!T(d))throw new Error(`${t} cannot have yError2 without yError`);if(T(c)&&T(d))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);else if(T(c))if(bl(i))return{orient:"horizontal",inputType:"aggregated-error"};else throw new Error("All x, xError, and xError2 (if exist) have to be quantitative");else if(T(d))if(bl(o))return{orient:"vertical",inputType:"aggregated-error"};else throw new Error("All y, yError, and yError2 (if exist) have to be quantitative");throw new Error("No ranged axis")}}function $c(e){return(T(e.x)||T(e.y))&&!T(e.x2)&&!T(e.y2)&&!T(e.xError)&&!T(e.xError2)&&!T(e.yError)&&!T(e.yError2)}function zc(e){return T(e.x2)||T(e.y2)}function Kc(e){return T(e.xError)||T(e.xError2)||T(e.yError)||T(e.yError2)}function Yc(e,t,r){const{mark:n,encoding:a,params:i,projection:o,...s}=e;const l=ss(n)?n:{type:n};if(i)ae(qn(t));const{orient:c,inputType:u}=qc(e,t);const{continuousAxisChannelDef:d,continuousAxisChannelDef2:f,continuousAxisChannelDefError:p,continuousAxisChannelDefError2:h,continuousAxis:g}=Mc(e,c,t);const{errorBarSpecificAggregate:m,postAggregateCalculates:_,tooltipSummary:y,tooltipTitleWithFieldName:T}=Jc(l,d,f,p,h,u,t,r);const{[g]:b,[g==="x"?"x2":"y2"]:v,[g==="x"?"xError":"yError"]:E,[g==="x"?"xError2":"yError2"]:S,...A}=a;const{bins:O,timeUnits:C,aggregate:k,groupby:w,encoding:R}=yc(A,r);const I=[...k,...m];const M=u!=="raw"?[]:w;const P=kc(y,d,R,T);return{transform:[...s.transform??[],...O,...C,...I.length===0?[]:[{aggregate:I,groupby:M}],..._],groupby:M,continuousAxisChannelDef:d,continuousAxis:g,encodingWithoutContinuousAxis:R,ticksOrient:c==="vertical"?"horizontal":"vertical",markDef:l,outerSpec:s,tooltipEncoding:P}}function Jc(e,t,r,n,a,i,o,s){let l=[];let c=[];const u=t.field;let d;let f=false;if(i==="raw"){const p=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":s.errorbar.center;const h=e.extent?e.extent:p==="mean"?"stderr":"iqr";if(p==="median"!==(h==="iqr"))ae(Xa(p,h,o));if(h==="stderr"||h==="stdev"){l=[{op:h,field:u,as:`extent_${u}`},{op:p,field:u,as:`center_${u}`}];c=[{calculate:`datum["center_${u}"] + datum["extent_${u}"]`,as:`upper_${u}`},{calculate:`datum["center_${u}"] - datum["extent_${u}"]`,as:`lower_${u}`}];d=[{fieldPrefix:"center_",titlePrefix:Re(p)},{fieldPrefix:"upper_",titlePrefix:Zc(p,h,"+")},{fieldPrefix:"lower_",titlePrefix:Zc(p,h,"-")}];f=true}else{let e;let t;let r;if(h==="ci"){e="mean";t="ci0";r="ci1"}else{e="median";t="q1";r="q3"}l=[{op:t,field:u,as:`lower_${u}`},{op:r,field:u,as:`upper_${u}`},{op:e,field:u,as:`center_${u}`}];d=[{fieldPrefix:"upper_",titlePrefix:Bl({field:u,aggregate:r,type:"quantitative"},s,{allowDisabling:false})},{fieldPrefix:"lower_",titlePrefix:Bl({field:u,aggregate:t,type:"quantitative"},s,{allowDisabling:false})},{fieldPrefix:"center_",titlePrefix:Bl({field:u,aggregate:e,type:"quantitative"},s,{allowDisabling:false})}]}}else{if(e.center||e.extent)ae(Qa(e.center,e.extent));if(i==="aggregated-upper-lower"){d=[];c=[{calculate:`datum["${r.field}"]`,as:`upper_${u}`},{calculate:`datum["${u}"]`,as:`lower_${u}`}]}else if(i==="aggregated-error"){d=[{fieldPrefix:"",titlePrefix:u}];c=[{calculate:`datum["${u}"] + datum["${n.field}"]`,as:`upper_${u}`}];if(a)c.push({calculate:`datum["${u}"] + datum["${a.field}"]`,as:`lower_${u}`});else c.push({calculate:`datum["${u}"] - datum["${n.field}"]`,as:`lower_${u}`})}for(const g of c)d.push({fieldPrefix:g.as.substring(0,6),titlePrefix:De(De(g.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:c,errorBarSpecificAggregate:l,tooltipSummary:d,tooltipTitleWithFieldName:f}}function Zc(e,t,r){return`${Re(e)} ${r} ${t}`}const Qc="errorband",Xc=["band","borders"],eu=new pc(Qc,tu);function tu(e,t){let{config:r}=t;e={...e,encoding:vc(e.encoding,r)};const{transform:n,continuousAxisChannelDef:a,continuousAxis:i,encodingWithoutContinuousAxis:o,markDef:s,outerSpec:l,tooltipEncoding:c}=Yc(e,Qc,r);const u=s;const d=Rc(u,i,a,o,r.errorband);const f=e.encoding.x!==undefined&&e.encoding.y!==undefined;let p={type:f?"area":"rect"};let h={type:f?"line":"rule"};const g={...u.interpolate?{interpolate:u.interpolate}:{},...u.tension&&u.interpolate?{tension:u.tension}:{}};if(f){p={...p,...g,ariaRoleDescription:"errorband"};h={...h,...g,aria:false}}else if(u.interpolate)ae(ti("interpolate"));else if(u.tension)ae(ti("tension"));return{...l,transform:n,layer:[...d({partName:"band",mark:p,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:c}),...d({partName:"borders",mark:h,positionPrefix:"lower",extraEncoding:c}),...d({partName:"borders",mark:h,positionPrefix:"upper",extraEncoding:c})]}}const ru={};function nu(e,t,r){const n=new pc(e,t);ru[e]={normalizer:n,parts:r}}function au(){return A(ru)}nu(Dc,Uc,xc),nu(Hc,Wc,Gc),nu(Qc,tu,Xc);const iu=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],ou={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},su={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},lu=A(ou),cu=A(su),uu={header:1,headerRow:1,headerColumn:1,headerFacet:1},du=A(uu),fu=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],pu={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},hu={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},gu="_vgsid_",mu={point:{on:"click",fields:[gu],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[pointerdown, window:pointerup] > window:pointermove!",encodings:["x","y"],translate:"[pointerdown, window:pointerup] > window:pointermove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function _u(e){return e==="legend"||!!e?.legend}function yu(e){return _u(e)&&te.isObject(e)}function Tu(e){return!!e?.["select"]}function bu(e){const t=[];for(const r of e||[]){if(Tu(r))continue;const{expr:n,bind:a,...i}=r;if(a&&n){const o={...i,bind:a,init:n};t.push(o)}else{const s={...i,...n?{update:n}:{},...a?{bind:a}:{}};t.push(s)}}return t}function vu(e){return Su(e)||Au(e)||Eu(e)}function Eu(e){return"concat"in e}function Su(e){return"vconcat"in e}function Au(e){return"hconcat"in e}function Ou(e){let{step:t,offsetIsDiscrete:r}=e;if(r)return t.for??"offset";else return"position"}function Cu(e){return te.isObject(e)&&e["step"]!==undefined}function ku(e){return e["view"]||e["width"]||e["height"]}const wu=20,Ru={align:1,bounds:1,center:1,columns:1,spacing:1},Iu=A(Ru);function Mu(e,t,r){const n=r[t];const a={};const{spacing:i,columns:o}=n;if(i!==undefined)a.spacing=i;if(o!==undefined)if(il(e)&&!nl(e.facet)||Eu(e))a.columns=o;if(Su(e))a.columns=1;for(const s of Iu)if(e[s]!==undefined)if(s==="spacing"){const l=e[s];a[s]=te.isNumber(l)?l:{row:l.row??i,column:l.column??i}}else a[s]=e[s];return a}function Pu(e,t){return e[t]??e[t==="width"?"continuousWidth":"continuousHeight"]}function Nu(e,t){const r=Du(e,t);return Cu(r)?r.step:xu}function Du(e,t){const r=e[t]??e[t==="width"?"discreteWidth":"discreteHeight"];return R(r,{step:e.step})}const xu=20,Lu={continuousWidth:200,continuousHeight:200,step:xu},Fu={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:Lu,mark:hs,arc:{},area:{},bar:bs,circle:{},geoshape:{},image:{},line:{},point:{},rect:vs,rule:{color:"black"},square:{},text:{color:"black"},tick:Es,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:true,ticks:false},errorband:{band:{opacity:.3},borders:false},scale:Oo,projection:{},legend:pu,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:mu,style:{},title:{},facet:{spacing:wu},concat:{spacing:wu},normalizedNumberFormat:".0%"},Uu=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],Bu={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},ju={blue:Uu[0],orange:Uu[1],red:Uu[2],teal:Uu[3],green:Uu[4],yellow:Uu[5],purple:Uu[6],pink:Uu[7],brown:Uu[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function Hu(){let e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return{signals:[{name:"color",value:te.isObject(e)?{...ju,...e}:ju}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function Gu(e){return{signals:[{name:"fontSize",value:te.isObject(e)?{...Bu,...e}:Bu}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function Vu(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function Wu(e){const t=A(e||{});const r={};for(const n of t){const a=e[n];r[n]=ac(a)?vn(a):En(a)}return r}function qu(e){const t=A(e);const r={};for(const n of t)r[n]=Wu(e[n]);return r}const $u=[...ms,...dc,...du,"background","padding","legend","lineBreak","scale","style","title","view"];function zu(){let e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};const{color:t,font:r,fontSize:n,selection:a,...i}=e;const o=te.mergeConfig({},g(Fu),r?Vu(r):{},t?Hu(t):{},n?Gu(n):{},i||{});if(a)te.writeConfig(o,"selection",a,true);const s=pe(o,$u);for(const l of["background","lineBreak","padding"])if(o[l])s[l]=En(o[l]);for(const c of ms)if(o[c])s[c]=_(o[c]);for(const u of dc)if(o[u])s[u]=Wu(o[u]);for(const d of du)if(o[d])s[d]=_(o[d]);if(o.legend)s.legend=_(o.legend);if(o.scale){const{invalid:f,...p}=o.scale;const h=_(f,{level:1});s.scale={..._(p),...A(h).length>0?{invalid:h}:{}}}if(o.style)s.style=qu(o.style);if(o.title)s.title=_(o.title);if(o.view)s.view=_(o.view);return s}const Ku=new Set(["view",...os]),Yu=["color","fontSize","background","padding","facet","concat","numberFormat","numberFormatType","normalizedNumberFormat","normalizedNumberFormatType","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],Ju={view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"],...ps};function Zu(e){e=g(e);for(const t of Yu)delete e[t];if(e.axis)for(const r in e.axis)if(ac(e.axis[r]))delete e.axis[r];if(e.legend)for(const n of iu)delete e.legend[n];if(e.mark){for(const a of fs)delete e.mark[a];if(e.mark.tooltip&&te.isObject(e.mark.tooltip))delete e.mark.tooltip}if(e.params){e.signals=(e.signals||[]).concat(bu(e.params));delete e.params}for(const i of Ku){for(const s of fs)delete e[i][s];const o=Ju[i];if(o)for(const l of o)delete e[i][l];Xu(e,i)}for(const c of au())delete e[c];Qu(e);for(const u in e)if(te.isObject(e[u])&&re(e[u]))delete e[u];return re(e)?undefined:e}function Qu(e){const{titleMarkConfig:t,subtitleMarkConfig:r,subtitle:n}=dn(e.title);if(!re(t))e.style["group-title"]={...e.style["group-title"],...t};if(!re(r))e.style["group-subtitle"]={...e.style["group-subtitle"],...r};if(!re(n))e.title=n;else delete e.title}function Xu(e,t,r,n){const a=e[t];if(t==="view")r="cell";const i={...a,...e.style[r??t]};if(!re(i))e.style[r??t]=i;delete e[t]}function ed(e){return"layer"in e}function td(e){return"repeat"in e}function rd(e){return!te.isArray(e.repeat)&&e.repeat["layer"]}class nd{map(e,t){if(il(e))return this.mapFacet(e,t);else if(td(e))return this.mapRepeat(e,t);else if(Au(e))return this.mapHConcat(e,t);else if(Su(e))return this.mapVConcat(e,t);else if(Eu(e))return this.mapConcat(e,t);else return this.mapLayerOrUnit(e,t)}mapLayerOrUnit(e,t){if(ed(e))return this.mapLayer(e,t);else if(fc(e))return this.mapUnit(e,t);throw new Error(Ln(e))}mapLayer(e,t){return{...e,layer:e.layer.map(e=>this.mapLayerOrUnit(e,t))}}mapHConcat(e,t){return{...e,hconcat:e.hconcat.map(e=>this.map(e,t))}}mapVConcat(e,t){return{...e,vconcat:e.vconcat.map(e=>this.map(e,t))}}mapConcat(e,t){const{concat:r,...n}=e;return{...n,concat:r.map(e=>this.map(e,t))}}mapFacet(e,t){return{...e,spec:this.map(e.spec,t)}}mapRepeat(e,t){return{...e,spec:this.map(e.spec,t)}}}const ad={zero:1,center:1,normalize:1};function id(e){return e in ad}const od=new Set([Wo,$o,qo,Zo,Yo,ts,rs,Ko,Qo,Xo]),sd=new Set([$o,qo,Wo]);function ld(e){return B(e)&&yl(e)==="quantitative"&&!e.bin}function cd(e,t,r){let{orient:n,type:a}=r;const i=t==="x"?"y":"radius";const o=t==="x"&&["bar","area"].includes(a);const s=e[t];const l=e[i];if(B(s)&&B(l)){if(ld(s)&&ld(l)){if(s.stack)return t;else if(l.stack)return i;const c=B(s)&&!!s.aggregate;const u=B(l)&&!!l.aggregate;if(c!==u)return c?t:i;if(o)if(n==="vertical")return i;else if(n==="horizontal")return t}else if(ld(s))return t;else if(ld(l))return i}else if(ld(s)){if(o&&n==="vertical")return undefined;return t}else if(ld(l)){if(o&&n==="horizontal")return undefined;return i}return undefined}function ud(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function dd(e,o){const t=ss(e)?e:{type:e};const r=t.type;if(!od.has(r))return null;const n=cd(o,"x",t)||cd(o,"theta",t);if(!n)return null;const a=o[n];const i=B(a)?j(a,{}):undefined;const s=ud(n);const l=[];const c=new Set;if(o[s]){const g=o[s];const m=B(g)?j(g,{}):undefined;if(m&&m!==i){l.push(s);c.add(m)}}const u=s==="x"?"xOffset":"yOffset";const d=o[u];const f=B(d)?j(d,{}):undefined;if(f&&f!==i){l.push(u);c.add(f)}const p=br.reduce((e,t)=>{if(t!=="tooltip"&&hc(o,t)){const r=o[t];for(const n of te.array(r)){const a=Wl(n);if(a.aggregate)continue;const i=j(a,{});if(!i||!c.has(i))e.push({channel:t,fieldDef:a})}}return e},[]);let h;if(a.stack!==undefined)if(te.isBoolean(a.stack))h=a.stack?"zero":null;else h=a.stack;else if(sd.has(r))h="zero";if(!h||!id(h))return null;if(_c(o)&&p.length===0)return null;if(a?.scale?.type&&a?.scale?.type!==y.LINEAR)if(a?.stack)ae(Ka(a.scale.type));if(T(o[Xt(n)])){if(a.stack!==undefined)ae(za(n));return null}if(B(a)&&a.aggregate&&!nn.has(a.aggregate))ae(Ya(a.aggregate));return{groupbyChannels:l,groupbyFields:c,fieldChannel:n,impute:a.impute===null?false:as(r),stackBy:p,offset:h}}function fd(e,t,r){const n=_(e);const a=ne("orient",n,r);n.orient=md(n.type,t,a);if(a!==undefined&&a!==n.orient)ae(wa(n.orient,a));if(n.type==="bar"&&n.orient){const l=ne("cornerRadiusEnd",n,r);if(l!==undefined){const c=n.orient==="horizontal"&&t.x2||n.orient==="vertical"&&t.y2?["cornerRadius"]:ys[n.orient];for(const u of c)n[u]=l;if(n.cornerRadiusEnd!==undefined)delete n.cornerRadiusEnd}}const i=ne("opacity",n,r);const o=ne("fillOpacity",n,r);if(i===undefined&&o===undefined)n.opacity=hd(n.type,t);const s=ne("cursor",n,r);if(s===undefined)n.cursor=pd(n,t,r);return n}function pd(e,t,r){if(t.href||e.href||ne("href",e,r))return"pointer";return e.cursor}function hd(e,t){if(w([Yo,Xo,ts,rs],e))if(!_c(t))return.7;return undefined}function gd(e,t,r){let{graticule:n}=r;if(n)return false;const a=Rn("filled",e,t);const i=e.type;return R(a,i!==Yo&&i!==Ko&&i!==Zo)}function md(e,t,r){switch(e){case Yo:case ts:case rs:case Qo:case Jo:case zo:return undefined}const{x:n,y:a,x2:i,y2:o}=t;switch(e){case $o:if(B(n)&&(D(n.bin)||B(a)&&a.aggregate&&!n.aggregate))return"vertical";if(B(a)&&(D(a.bin)||B(n)&&n.aggregate&&!a.aggregate))return"horizontal";if(o||i){if(r)return r;if(!i){if(B(n)&&n.type===io&&!N(n.bin)||El(n))if(B(a)&&D(a.bin))return"horizontal";return"vertical"}if(!o){if(B(a)&&a.type===io&&!N(a.bin)||El(a))if(B(n)&&D(n.bin))return"vertical";return"horizontal"}}case Zo:if(i&&!(B(n)&&D(n.bin))&&o&&!(B(a)&&D(a.bin)))return undefined;case qo:if(o)if(B(a)&&D(a.bin))return"horizontal";else return"vertical";else if(i)if(B(n)&&D(n.bin))return"vertical";else return"horizontal";else if(e===Zo)if(n&&!a)return"vertical";else if(a&&!n)return"horizontal";case Ko:case Xo:{const s=vl(n);const l=vl(a);if(r)return r;else if(s&&!l)return e!=="tick"?"horizontal":"vertical";else if(!s&&l)return e!=="tick"?"vertical":"horizontal";else if(s&&l)return"vertical";else{const c=v(n)&&n.type===so;const u=v(a)&&a.type===so;if(c&&!u)return"vertical";else if(!c&&u)return"horizontal"}return undefined}}return"vertical"}function _d(e){const{point:t,line:r,...n}=e;return A(n).length>1?n:n.type}function yd(e){for(const t of["line","area","rule","trail"])if(e[t])e={...e,[t]:pe(e[t],["point","line"])};return e}function Td(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};let r=arguments.length>2?arguments[2]:undefined;if(e.point==="transparent")return{opacity:0};else if(e.point)return te.isObject(e.point)?e.point:{};else if(e.point!==undefined)return null;else{if(t.point||r.shape)return te.isObject(t.point)?t.point:{};return undefined}}function bd(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(e.line)return e.line===true?{}:e.line;else if(e.line!==undefined)return null;else{if(t.line)return t.line===true?{}:t.line;return undefined}}class vd{name="path-overlay";hasMatchingType(e,t){if(fc(e)){const{mark:r,encoding:n}=e;const a=ss(r)?r:{type:r};switch(a.type){case"line":case"rule":case"trail":return!!Td(a,t[a.type],n);case"area":return!!Td(a,t[a.type],n)||!!bd(a,t[a.type])}}return false}run(e,t,r){const{config:n}=t;const{params:a,projection:i,mark:o,name:s,encoding:l,...c}=e;const u=vc(l,n);const d=ss(o)?o:{type:o};const f=Td(d,n[d.type],u);const p=d.type==="area"&&bd(d,n[d.type]);const h=[{name:s,...a?{params:a}:{},mark:_d({...d.type==="area"&&d.opacity===undefined&&d.fillOpacity===undefined?{opacity:.7}:{},...d}),encoding:pe(u,["shape"])}];const g=dd(fd(d,u,n),u);let m=u;if(g){const{fieldChannel:_,offset:y}=g;m={...u,[_]:{...u[_],...y?{stack:y}:{}}}}m=pe(m,["y2","x2"]);if(p)h.push({...i?{projection:i}:{},mark:{type:"line",...fe(d,["clip","interpolate","tension","tooltip"]),...p},encoding:m});if(f)h.push({...i?{projection:i}:{},mark:{type:"point",opacity:1,filled:true,...fe(d,["clip","tooltip"]),...f},encoding:m});return r({...c,layer:h},{...t,config:yd(n)})}}function Ed(e,t){if(!t)return e;if(nl(e))return wd(e,t);return Od(e,t)}function Sd(e,t){if(!t)return e;return wd(e,t)}function Ad(e,t,r){const n=t[e];if(sl(n))if(n.repeat in r)return{...t,[e]:r[n.repeat]};else{ae(ea(n.repeat));return undefined}return t}function Od(e,t){e=Ad("field",e,t);if(e===undefined)return undefined;else if(e===null)return null;if(cl(e)&&tl(e.sort)){const r=Ad("field",e.sort,t);e={...e,...r?{sort:r}:{}}}return e}function Cd(e,t){if(B(e))return Od(e,t);else{const r=Ad("datum",e,t);if(r!==e&&!r.type)r.type="nominal";return r}}function kd(e,t){if(T(e)){const r=Cd(e,t);if(r)return r;else if(hl(e))return{condition:e.condition}}else{if(ml(e)){const n=Cd(e.condition,t);if(n)return{...e,condition:n};else{const{condition:a,...i}=e;return i}}return e}return undefined}function wd(e,t){const r={};for(const n in e)if(te.hasOwnProperty(e,n)){const a=e[n];if(te.isArray(a))r[n]=a.map(e=>kd(e,t)).filter(e=>e);else{const i=kd(a,t);if(i!==undefined)r[n]=i}}return r}class Rd{name="RuleForRangedLine";hasMatchingType(e){if(fc(e)){const{encoding:t,mark:r}=e;if(r==="line"||ss(r)&&r.type==="line")for(const n of Yt){const a=Zt(n);const i=t[a];if(t[n])if(B(i)&&!D(i.bin)||Tl(i))return true}}return false}run(e,t,r){const{encoding:n,mark:a}=e;ae(ka(!!n.x2,!!n.y2));return r({...e,mark:te.isObject(a)?{...a,type:"rule"}:"rule"},t)}}class Id extends nd{nonFacetUnitNormalizers=[Lc,Vc,eu,new vd,new Rd];map(e,t){if(fc(e)){const r=hc(e.encoding,$e);const n=hc(e.encoding,ze);const a=hc(e.encoding,Ke);if(r||n||a)return this.mapFacetedUnit(e,t)}return super.map(e,t)}mapUnit(e,t){const{parentEncoding:r,parentProjection:n}=t;const a=Sd(e.encoding,t.repeater);const i={...e,...e.name?{name:[t.repeaterPrefix,e.name].filter(e=>e).join("_")}:{},...a?{encoding:a}:{}};if(r||n)return this.mapUnitWithParentEncodingOrProjection(i,t);const o=this.mapLayerOrUnit.bind(this);for(const s of this.nonFacetUnitNormalizers)if(s.hasMatchingType(i,t.config))return s.run(i,t,o);return i}mapRepeat(e,t){if(rd(e))return this.mapLayerRepeat(e,t);else return this.mapNonLayerRepeat(e,t)}mapLayerRepeat(e,a){const{repeat:t,spec:i,...r}=e;const{row:n,column:o,layer:s}=t;const{repeater:l={},repeaterPrefix:c=""}=a;if(n||o)return this.mapRepeat({...e,repeat:{...n?{row:n}:{},...o?{column:o}:{}},spec:{repeat:{layer:s},spec:i}},a);else return{...r,layer:s.map(e=>{const t={...l,layer:e};const r=`${(i.name?`${i.name}_`:"")+c}child__layer_${k(e)}`;const n=this.mapLayerOrUnit(i,{...a,repeater:t,repeaterPrefix:r});n.name=r;return n})}}mapNonLayerRepeat(e,t){const{repeat:r,spec:n,data:a,...i}=e;if(!te.isArray(r)&&e.columns){e=pe(e,["columns"]);ae(ta("repeat"))}const o=[];const{repeater:s={},repeaterPrefix:l=""}=t;const c=!te.isArray(r)&&r.row||[s?s.row:null];const u=!te.isArray(r)&&r.column||[s?s.column:null];const d=te.isArray(r)&&r||[s?s.repeat:null];for(const p of d)for(const h of c)for(const g of u){const m={repeat:p,row:h,column:g,layer:s.layer};const _=(n.name?`${n.name}_`:"")+l+"child__"+(te.isArray(r)?`${k(p)}`:(r.row?`row_${k(h)}`:"")+(r.column?`column_${k(g)}`:""));const y=this.map(n,{...t,repeater:m,repeaterPrefix:_});y.name=_;o.push(pe(y,["data"]))}const f=te.isArray(r)?e.columns:r.column?r.column.length:1;return{data:n.data??a,align:"all",...i,columns:f,concat:o}}mapFacet(e,t){const{facet:r}=e;if(nl(r)&&e.columns){e=pe(e,["columns"]);ae(ta("facet"))}return super.mapFacet(e,t)}mapUnitWithParentEncodingOrProjection(e,t){const{encoding:r,projection:n}=e;const{parentEncoding:a,parentProjection:i,config:o}=t;const s=Pd({parentProjection:i,projection:n});const l=Md({parentEncoding:a,encoding:Sd(r,t.repeater)});return this.mapUnit({...e,...s?{projection:s}:{},...l?{encoding:l}:{}},{config:o})}mapFacetedUnit(e,t){const{row:r,column:n,facet:a,...i}=e.encoding;const{mark:o,width:s,projection:l,height:c,view:u,params:d,encoding:f,...p}=e;const{facetMapping:h,layout:g}=this.getFacetMappingAndLayout({row:r,column:n,facet:a},t);const m=Sd(i,t.repeater);return this.mapFacet({...p,...g,facet:h,spec:{...s?{width:s}:{},...c?{height:c}:{},...u?{view:u}:{},...l?{projection:l}:{},mark:o,encoding:m,...d?{params:d}:{}}},t)}getFacetMappingAndLayout(e,t){const{row:r,column:n,facet:a}=e;if(r||n){if(a)ae(Aa([...r?[$e]:[],...n?[ze]:[]]));const i={};const o={};for(const s of[$e,ze]){const l=e[s];if(l){const{align:c,center:u,spacing:d,columns:f,...p}=l;i[s]=p;for(const h of["align","center","spacing"])if(l[h]!==undefined){o[h]??={};o[h][s]=l[h]}}}return{facetMapping:i,layout:o}}else{const{align:g,center:m,spacing:_,columns:y,...T}=a;return{facetMapping:Ed(T,t.repeater),layout:{...g?{align:g}:{},...m?{center:m}:{},..._?{spacing:_}:{},...y?{columns:y}:{}}}}}mapLayer(e,t){let{parentEncoding:r,parentProjection:n,...a}=t;const{encoding:i,projection:o,...s}=e;const l={...a,parentEncoding:Md({parentEncoding:r,encoding:i,layer:true}),parentProjection:Pd({parentProjection:n,projection:o})};return super.mapLayer({...s,...e.name?{name:[l.repeaterPrefix,e.name].filter(e=>e).join("_")}:{}},l)}}function Md(e){let{parentEncoding:t,encoding:r={},layer:n}=e;let a={};if(t){const i=new Set([...A(t),...A(r)]);for(const o of i){const s=r[o];const l=t[o];if(T(s)){const c={...l,...s};a[o]=c}else if(ml(s))a[o]={...s,condition:{...l,...s.condition}};else if(s||s===null)a[o]=s;else if(n||Sl(l)||x(l)||T(l)||te.isArray(l))a[o]=l}}else a=r;return!a||re(a)?undefined:a}function Pd(e){const{parentProjection:t,projection:r}=e;if(t&&r)ae(ca({parentProjection:t,projection:r}));return r??t}function Nd(e){return"filter"in e}function Dd(e){return e?.["stop"]!==undefined}function xd(e){return"lookup"in e}function Ld(e){return"data"in e}function Fd(e){return"param"in e}function Ud(e){return"pivot"in e}function Bd(e){return"density"in e}function jd(e){return"quantile"in e}function Hd(e){return"regression"in e}function Gd(e){return"loess"in e}function Vd(e){return"sample"in e}function Wd(e){return"window"in e}function qd(e){return"joinaggregate"in e}function $d(e){return"flatten"in e}function zd(e){return"calculate"in e}function Kd(e){return"bin"in e}function Yd(e){return"impute"in e}function Jd(e){return"timeUnit"in e}function Zd(e){return"aggregate"in e}function Qd(e){return"stack"in e}function Xd(e){return"fold"in e}function ef(e){return"extent"in e&&!("density"in e)&&!("regression"in e)}function tf(e){return e.map(e=>{if(Nd(e))return{filter:ue(e.filter,to)};return e})}class rf extends nd{map(e,t){t.emptySelections??={};t.selectionPredicates??={};e=nf(e,t);return super.map(e,t)}mapLayerOrUnit(e,t){e=nf(e,t);if(e.encoding){const r={};for(const[n,a]of Oe(e.encoding))r[n]=af(a,t);e={...e,encoding:r}}return super.mapLayerOrUnit(e,t)}mapUnit(e,l){const{selection:t,...r}=e;if(t)return{...r,params:Oe(t).map(e=>{let[t,r]=e;const{init:n,bind:a,empty:i,...o}=r;if(o.type==="single"){o.type="point";o.toggle=false}else if(o.type==="multi")o.type="point";l.emptySelections[t]=i!=="none";for(const s of C(l.selectionPredicates[t]??{}))s.empty=i!=="none";return{name:t,value:n,select:o,bind:a}})};return e}}function nf(e,n){const{transform:t,...r}=e;if(t){const a=t.map(e=>{if(Nd(e))return{filter:sf(e,n)};else if(Kd(e)&&sn(e.bin))return{...e,bin:of(e.bin)};else if(xd(e)){const{selection:t,...r}=e.from;return t?{...e,from:{param:t,...r}}:e}return e});return{...r,transform:a}}return e}function af(e,i){const t=g(e);if(B(t)&&sn(t.bin))t.bin=of(t.bin);if(Al(t)&&t.scale?.domain?.selection){const{selection:r,...n}=t.scale.domain;t.scale.domain={...n,...r?{param:r}:{}}}if(hl(t))if(te.isArray(t.condition))t.condition=t.condition.map(e=>{const{selection:t,param:r,test:n,...a}=e;return r?e:{...a,test:sf(e,i)}});else{const{selection:a,param:o,test:s,...l}=af(t.condition,i);t.condition=o?t.condition:{...l,test:sf(t.condition,i)}}return t}function of(e){const t=e.extent;if(t?.selection){const{selection:r,...n}=t;return{...e,extent:{...n,param:r}}}return e}function sf(e,n){const t=e=>{return ue(e,e=>{const t=n.emptySelections[e]??true;const r={param:e,empty:t};n.selectionPredicates[e]??=[];n.selectionPredicates[e].push(r);return r})};return e.selection?t(e.selection):ue(e.test||e.filter,e=>e.selection?t(e.selection):e)}class lf extends nd{map(e,t){const r=t.selections??[];if(e.params&&!fc(e)){const n=[];for(const a of e.params)if(Tu(a))r.push(a);else n.push(a);e.params=n}t.selections=r;return super.map(e,t)}mapUnit(e,t){const r=t.selections;if(!r||!r.length)return e;const n=(t.path??[]).concat(e.name);const a=[];for(const i of r)if(!i.views||!i.views.length)a.push(i);else for(const o of i.views)if(te.isString(o)&&(o===e.name||n.includes(o))||te.isArray(o)&&o.map(e=>n.indexOf(e)).every((e,t,r)=>e!==-1&&(t===0||e>r[t-1])))a.push(i);if(a.length)e.params=a;return e}}for(const rT of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const nT=lf.prototype[rT];lf.prototype[rT]=function(e,t){return nT.call(this,e,cf(e,t))}}function cf(e,t){return e.name?{...t,path:(t.path??[]).concat(e.name)}:t}function uf(e,t){if(t===undefined)t=zu(e.config);const r=hf(e,t);const{width:n,height:a}=e;const i=mf(r,{width:n,height:a,autosize:e.autosize},t);return{...r,...i?{autosize:i}:{}}}const df=new Id,ff=new rf,pf=new lf;function hf(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const r={config:t};return pf.map(df.map(ff.map(e,r),r),r)}function gf(e){return te.isString(e)?{type:e}:e??{}}function mf(e,t,r){let{width:n,height:a}=t;const i=fc(e)||ed(e);const o={};if(!i){if(n=="container"){ae(Un("width"));n=undefined}if(a=="container"){ae(Un("height"));a=undefined}}else if(n=="container"&&a=="container"){o.type="fit";o.contains="padding"}else if(n=="container"){o.type="fit-x";o.contains="padding"}else if(a=="container"){o.type="fit-y";o.contains="padding"}const s={type:"pad",...o,...r?gf(r.autosize):{},...gf(e.autosize)};if(s.type==="fit"&&!i){ae(Fn);s.type="pad"}if(n=="container"&&!(s.type=="fit"||s.type=="fit-x"))ae(Bn("width"));if(a=="container"&&!(s.type=="fit"||s.type=="fit-y"))ae(Bn("height"));if(qe(s,{type:"pad"}))return undefined;return s}function _f(e){return e==="fit"||e==="fit-x"||e==="fit-y"}function yf(e){return e?`fit-${Or(e)}`:"fit"}const Tf=["background","padding"];function bf(e,t){const r={};for(const n of Tf)if(e&&e[n]!==undefined)r[n]=En(e[n]);if(t)r.params=e.params;return r}class vf{constructor(){let e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};this.explicit=e;this.implicit=t}clone(){return new vf(g(this.explicit),g(this.implicit))}combine(){return{...this.explicit,...this.implicit}}get(e){return R(this.explicit[e],this.implicit[e])}getWithExplicit(e){if(this.explicit[e]!==undefined)return{explicit:true,value:this.explicit[e]};else if(this.implicit[e]!==undefined)return{explicit:false,value:this.implicit[e]};return{explicit:false,value:undefined}}setWithExplicit(e,t){let{value:r,explicit:n}=t;if(r!==undefined)this.set(e,r,n)}set(e,t,r){delete this[r?"implicit":"explicit"][e];this[r?"explicit":"implicit"][e]=t;return this}copyKeyFromSplit(e,t){let{explicit:r,implicit:n}=t;if(r[e]!==undefined)this.set(e,r[e],true);else if(n[e]!==undefined)this.set(e,n[e],false)}copyKeyFromObject(e,t){if(t[e]!==undefined)this.set(e,t[e],true)}copyAll(e){for(const t of A(e.combine())){const r=e.getWithExplicit(t);this.setWithExplicit(t,r)}}}function Ef(e){return{explicit:true,value:e}}function Sf(e){return{explicit:false,value:e}}function Af(i){return(e,t,r,n)=>{const a=i(e.value,t.value);if(a>0)return e;else if(a<0)return t;return Of(e,t,r,n)}}function Of(e,t,r,n){if(e.explicit&&t.explicit)ae(Ba(r,n,e.value,t.value));return e}function Cf(e,t,r,n){let a=arguments.length>4&&arguments[4]!==undefined?arguments[4]:Of;if(e===undefined||e.value===undefined)return t;if(e.explicit&&!t.explicit)return e;else if(t.explicit&&!e.explicit)return t;else if(qe(e.value,t.value))return e;else return a(e,t,r,n)}class kf extends vf{constructor(){let e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};let r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;super(e,t);this.explicit=e;this.implicit=t;this.parseNothing=r}clone(){const e=super.clone();e.parseNothing=this.parseNothing;return e}}function wf(e){return"url"in e}function Rf(e){return"values"in e}function If(e){return"name"in e&&!wf(e)&&!Rf(e)&&!Mf(e)}function Mf(e){return e&&(Pf(e)||Nf(e)||Df(e))}function Pf(e){return"sequence"in e}function Nf(e){return"sphere"in e}function Df(e){return"graticule"in e}let G=function(e){e[e["Raw"]=0]="Raw";e[e["Main"]=1]="Main";e[e["Row"]=2]="Row";e[e["Column"]=3]="Column";e[e["Lookup"]=4]="Lookup";e[e["PreFilterInvalid"]=5]="PreFilterInvalid";e[e["PostFilterInvalid"]=6]="PostFilterInvalid";return e}({});function xf(e){let{invalid:t,isPath:r}=e;const n=As(t,{isPath:r});switch(n){case"filter":return{marks:"exclude-invalid-values",scales:"exclude-invalid-values"};case"break-paths-show-domains":return{marks:r?"include-invalid-values":"exclude-invalid-values",scales:"include-invalid-values"};case"break-paths-filter-domains":return{marks:r?"include-invalid-values":"exclude-invalid-values",scales:"exclude-invalid-values"};case"show":return{marks:"include-invalid-values",scales:"include-invalid-values"}}}function Lf(e){const{marks:t,scales:r}=xf(e);if(t===r)return G.Main;return r==="include-invalid-values"?G.PreFilterInvalid:G.PostFilterInvalid}function Ff(e){const{signals:t,hasLegend:r,index:n,...a}=e;a.field=Ne(a.field);return a}function Uf(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;let r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:te.identity;if(te.isArray(e)){const n=e.map(e=>Uf(e,t,r));return t?`[${n.join(", ")}]`:n}else if(ui(e))if(t)return r(Ti(e));else return r(vi(e));return t?r(m(e)):e}function Bf(t,r){for(const n of C(t.component.selection??{})){const a=n.name;let e=`${a}${hh}, ${n.resolve==="global"?"true":`{unit: ${Th(t)}}`}`;for(const i of _h){if(!i.defined(n))continue;if(i.signals)r=i.signals(t,n,r);if(i.modifyExpr)e=i.modifyExpr(t,n,e)}r.push({name:a+gh,on:[{events:{signal:n.name+hh},update:`modify(${te.stringValue(n.name+ph)}, ${e})`}]})}return $f(r)}function jf(e,t){if(e.component.selection&&A(e.component.selection).length){const r=te.stringValue(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:te.parseSelector("pointermove","scope"),update:`isTuple(facet) ? facet : group(${r}).datum`}]})}return $f(t)}function Hf(e,t){let r=false;for(const n of C(e.component.selection??{})){const a=n.name;const i=te.stringValue(a+ph);const o=t.filter(e=>e.name===a);if(o.length===0){const s=n.resolve==="global"?"union":n.resolve;const l=n.type==="point"?", true, true)":")";t.push({name:n.name,update:`${mh}(${i}, ${te.stringValue(s)}${l}`})}r=true;for(const c of _h)if(c.defined(n)&&c.topLevelSignals)t=c.topLevelSignals(e,n,t)}if(r){const u=t.filter(e=>e.name==="unit");if(u.length===0)t.unshift({name:"unit",value:{},on:[{events:"pointermove",update:"isTuple(group()) ? group() : unit"}]})}return $f(t)}function Gf(e,t){const r=[...t];const n=Th(e,{escape:false});for(const a of C(e.component.selection??{})){const i={name:a.name+ph};if(a.project.hasSelectionId)i.transform=[{type:"collect",sort:{field:gu}}];if(a.init){const s=a.project.items.map(Ff);i.values=a.project.hasSelectionId?a.init.map(e=>({unit:n,[gu]:Uf(e,false)[0]})):a.init.map(e=>({unit:n,fields:s,values:Uf(e,false)}))}const o=r.filter(e=>e.name===a.name+ph);if(!o.length)r.push(i)}return r}function Vf(e,t){for(const r of C(e.component.selection??{}))for(const n of _h)if(n.defined(r)&&n.marks)t=n.marks(e,r,t);return t}function Wf(e,t){for(const r of e.children)if(q(r))t=Vf(r,t);return t}function qf(e,t,r,n){const a=wh(e,t.param,t);return{signal:Eo(r.get("type"))&&te.isArray(n)&&n[0]>n[1]?`isValid(${a}) && reverse(${a})`:a}}function $f(e){return e.map(e=>{if(e.on&&!e.on.length)delete e.on;return e})}class r{_children=[];_parent=null;constructor(e,t){this.debugName=t;if(e)this.parent=e}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(e){this._parent=e;if(e)e.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(e,t){if(this._children.includes(e)){ae(ia);return}if(t!==undefined)this._children.splice(t,0,e);else this._children.push(e)}removeChild(e){const t=this._children.indexOf(e);this._children.splice(t,1);return t}remove(){let e=this._parent.removeChild(this);for(const t of this._children){t._parent=this._parent;this._parent.addChild(t,e++)}}insertAsParentOf(e){const t=e.parent;t.removeChild(this);this.parent=t;e.parent=this}swapWithParent(){const e=this._parent;const t=e.parent;for(const n of this._children)n.parent=e;this._children=[];e.removeChild(this);const r=e.parent.removeChild(e);this._parent=t;t.addChild(this,r);e.parent=this}}class zf extends r{clone(){const e=new this.constructor;e.debugName=`clone_${this.debugName}`;e._source=this._source;e._name=`clone_${this._name}`;e.type=this.type;e.refCounts=this.refCounts;e.refCounts[e._name]=0;return e}constructor(e,t,r,n){super(e,t);this.type=r;this.refCounts=n;this._source=this._name=t;if(this.refCounts&&!(this._name in this.refCounts))this.refCounts[this._name]=0}dependentFields(){return new Set}producedFields(){return new Set}hash(){if(this._hash===undefined)this._hash=`Output ${Ue()}`;return this._hash}getSource(){this.refCounts[this._name]++;return this._source}isRequired(){return!!this.refCounts[this._name]}setSource(e){this._source=e}}function Kf(e){return e.as!==undefined}function Yf(e){return`${e}_end`}class Jf extends r{clone(){return new Jf(null,g(this.timeUnits))}constructor(e,t){super(e);this.timeUnits=t}static makeFromEncoding(e,h){const t=h.reduceFieldDef((t,r,n)=>{const{field:a,timeUnit:i}=r;if(i){let e;if(Oi(i)){if(q(h)){const{mark:o,markDef:s,config:l}=h;const c=ul({fieldDef:r,markDef:s,config:l});if(is(o)||!!c)e={timeUnit:F(i),field:a}}}else e={as:j(r,{forAs:true}),field:a,timeUnit:i};if(q(h)){const{mark:u,markDef:d,config:f}=h;const p=ul({fieldDef:r,markDef:d,config:f});if(is(u)&&P(n)&&p!==.5)e.rectBandPosition=p}if(e)t[S(e)]=e}return t},{});if(re(t))return null;return new Jf(e,t)}static makeFromTransform(e,t){const{timeUnit:r,...n}={...t};const a=F(r);const i={...n,timeUnit:a};return new Jf(e,{[S(i)]:i})}merge(e){this.timeUnits={...this.timeUnits};for(const t in e.timeUnits)if(!this.timeUnits[t])this.timeUnits[t]=e.timeUnits[t];for(const r of e.children){e.removeChild(r);r.parent=this}e.remove()}removeFormulas(e){const t={};for(const[r,n]of Oe(this.timeUnits)){const a=Kf(n)?n.as:`${n.field}_end`;if(!e.has(a))t[r]=n}this.timeUnits=t}producedFields(){return new Set(C(this.timeUnits).map(e=>{return Kf(e)?e.as:Yf(e.field)}))}dependentFields(){return new Set(C(this.timeUnits).map(e=>e.field))}hash(){return`TimeUnit ${S(this.timeUnits)}`}assemble(){const e=[];for(const t of C(this.timeUnits)){const{rectBandPosition:r}=t;const n=F(t.timeUnit);if(Kf(t)){const{field:a,as:i}=t;const{unit:o,utc:s,...l}=n;const c=[i,`${i}_end`];e.push({field:Ne(a),type:"timeunit",...o?{units:Ii(o)}:{},...s?{timezone:"utc"}:{},...l,as:c});e.push(...ep(c,r,n))}else if(t){const{field:u}=t;const d=u.replaceAll("\\.",".");const f=Xf({timeUnit:n,field:d});const p=Yf(d);e.push({type:"formula",expr:f,as:p});e.push(...ep([d,p],r,n))}}return e}}const Zf="offsetted_rect_start",Qf="offsetted_rect_end";function Xf(e){let{timeUnit:t,field:r,reverse:n}=e;const{unit:a,utc:i}=t;const o=Mi(a);const{part:s,step:l}=ji(o,t.step);const c=i?"utcOffset":"timeOffset";const u=`${c}('${s}', datum['${r}'], ${n?-l:l})`;return u}function ep(e,t,r){let[n,a]=e;if(t!==undefined&&t!==.5){const i=`datum['${n}']`;const o=`datum['${a}']`;return[{type:"formula",expr:tp([Xf({timeUnit:r,field:n,reverse:true}),i],t+.5),as:`${n}_${Zf}`},{type:"formula",expr:tp([i,o],t+.5),as:`${n}_${Qf}`}]}return[]}function tp(e,t){let[r,n]=e;return`${1-t} * ${r} + ${t} * ${n}`}const rp="_tuple_fields";class np{constructor(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.items=t;this.hasChannel={};this.hasField={};this.hasSelectionId=false}}const ap={defined:()=>{return true},parse:(t,e,r)=>{const a=e.name;const n=e.project??=new np;const i={};const o={};const s=new Set;const l=(e,t)=>{const r=t==="visual"?e.channel:e.field;let n=k(`${a}_${r}`);for(let e=1;s.has(n);e++)n=k(`${a}_${r}_${e}`);s.add(n);return{[t]:n}};const c=e.type;const u=t.config.selection[c];const d=r.value!==undefined?te.array(r.value):null;let{fields:f,encodings:p}=te.isObject(r.select)?r.select:{};if(!f&&!p&&d)for(const h of d){if(!te.isObject(h))continue;for(const g of A(h))if(zt(g))(p||(p=[])).push(g);else if(c==="interval"){ae(Xn);p=u.encodings}else(f??=[]).push(g)}if(!f&&!p){p=u.encodings;if("fields"in u)f=u.fields}for(const m of p??[]){const _=t.fieldDef(m);if(_){let e=_.field;if(_.aggregate){ae(Vn(m,_.aggregate));continue}else if(!e){ae(Gn(m));continue}if(_.timeUnit&&!Oi(_.timeUnit)){e=t.vgField(m);const y={timeUnit:_.timeUnit,as:e,field:_.field};o[S(y)]=y}if(!i[e]){const T=c==="interval"&&Gr(m)&&Eo(t.getScaleComponent(m).get("type"))?"R":_.bin?"R-RE":"E";const b={field:e,channel:m,type:T,index:n.items.length};b.signals={...l(b,"data"),...l(b,"visual")};n.items.push(i[e]=b);n.hasField[e]=i[e];n.hasSelectionId=n.hasSelectionId||e===gu;if(Mt(m)){b.geoChannel=m;b.channel=It(m);n.hasChannel[b.channel]=i[e]}else n.hasChannel[m]=i[e]}}else ae(Gn(m))}for(const v of f??[]){if(n.hasField[v])continue;const E={type:"E",field:v,index:n.items.length};E.signals={...l(E,"data")};n.items.push(E);n.hasField[v]=E;n.hasSelectionId=n.hasSelectionId||v===gu}if(d)e.init=d.map(t=>{return n.items.map(e=>te.isObject(t)?t[e.geoChannel||e.channel]!==undefined?t[e.geoChannel||e.channel]:t[e.field]:t)});if(!re(o))n.timeUnit=new Jf(null,o)},signals:(e,t,r)=>{const n=t.name+rp;const a=r.filter(e=>e.name===n);return a.length>0||t.project.hasSelectionId?r:r.concat({name:n,value:t.project.items.map(Ff)})}},ip={defined:e=>{return e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales"},parse:(e,t)=>{const r=t.scales=[];for(const n of t.project.items){const a=n.channel;if(!Gr(a))continue;const i=e.getScaleComponent(a);const o=i?i.get("type"):undefined;if(o=="sequential")ae(Kn);if(!i||!Eo(o)){ae(zn);continue}i.set("selectionExtent",{param:t.name,field:n.field},true);r.push(n)}},topLevelSignals:(e,t,r)=>{const n=t.scales.filter(t=>r.filter(e=>e.name===t.signals.data).length===0);if(!e.parent||sp(e)||n.length===0)return r;const a=r.filter(e=>e.name===t.name)[0];let i=a.update;if(i.indexOf(mh)>=0)a.update=`{${n.map(e=>`${te.stringValue(Ne(e.field))}: ${e.signals.data}`).join(", ")}}`;else{for(const o of n){const s=`${te.stringValue(Ne(o.field))}: ${o.signals.data}`;if(!i.includes(s))i=`${i.substring(0,i.length-1)}, ${s}}`}a.update=i}return r.concat(n.map(e=>({name:e.signals.data})))},signals:(e,t,r)=>{if(e.parent&&!sp(e))for(const n of t.scales){const a=r.find(e=>e.name===n.signals.data);a.push="outer";delete a.value;delete a.update}return r}};function op(e,t){const r=te.stringValue(e.scaleName(t));return`domain(${r})`}function sp(e){return e.parent&&b_(e.parent)&&(!e.parent.parent??sp(e.parent.parent))}const lp="_brush",cp="_scale_trigger",up="geo_interval_init_tick",dp="_init",fp="_center",pp={defined:e=>e.type==="interval",parse:(e,t,r)=>{if(e.hasProjection){const n={...te.isObject(r.select)?r.select:{}};n.fields=[gu];if(!n.encodings)n.encodings=r.value?A(r.value):[at,nt];r.select={type:"interval",...n}}if(t.translate&&!ip.defined(t)){const a=`!event.item || event.item.mark.name !== ${te.stringValue(t.name+lp)}`;for(const i of t.events){if(!i.between){ae(`${i} is not an ordered event stream for interval selections.`);continue}const o=te.array(i.between[0].filter??=[]);if(o.indexOf(a)<0)o.push(a)}}},signals:(s,r,e)=>{const t=r.name;const n=t+hh;const a=C(r.project.hasChannel).filter(e=>e.channel===I||e.channel===M);const i=r.init?r.init[0]:null;e.push(...a.reduce((e,t)=>e.concat(hp(s,r,t,i&&i[t.index])),[]));if(!s.hasProjection){if(!ip.defined(r)){const c=t+cp;const u=a.map(e=>{const t=e.channel;const{data:r,visual:n}=e.signals;const a=te.stringValue(s.scaleName(t));const i=s.getScaleComponent(t).get("type");const o=Eo(i)?"+":"";return`(!isArray(${r}) || `+`(${o}invert(${a}, ${n})[0] === ${o}${r}[0] && `+`${o}invert(${a}, ${n})[1] === ${o}${r}[1]))`});if(u.length)e.push({name:c,value:{},on:[{events:a.map(e=>({scale:s.scaleName(e.channel)})),update:u.join(" && ")+` ? ${c} : {}`}]})}const o=a.map(e=>e.signals.data);const l=`unit: ${Th(s)}, fields: ${t+rp}, values`;return e.concat({name:n,...i?{init:`{${l}: ${Uf(i)}}`}:{},...o.length?{on:[{events:[{signal:o.join(" || ")}],update:`${o.join(" && ")} ? {${l}: [${o}]} : null`}]}:{}})}else{const d=te.stringValue(s.projectionName());const f=s.projectionName()+fp;const{x:p,y:h}=r.project.hasChannel;const g=p&&p.signals.visual;const m=h&&h.signals.visual;const _=p?i&&i[p.index]:`${f}[0]`;const y=h?i&&i[h.index]:`${f}[1]`;const T=e=>s.getSizeSignalRef(e).signal;const b=`[`+`[${g?g+"[0]":"0"}, ${m?m+"[0]":"0"}],`+`[${g?g+"[1]":T("width")}, `+`${m?m+"[1]":T("height")}]`+`]`;if(i){e.unshift({name:t+dp,init:`[scale(${d}, [${p?_[0]:_}, ${h?y[0]:y}]), `+`scale(${d}, [${p?_[1]:_}, ${h?y[1]:y}])]`});if(!p||!h){const O=e.find(e=>e.name===f);if(!O)e.unshift({name:f,update:`invert(${d}, [${T("width")}/2, ${T("height")}/2])`})}}const v=`intersect(${b}, {markname: ${te.stringValue(s.getName("marks"))}}, unit.mark)`;const E=`{unit: ${Th(s)}}`;const S=`vlSelectionTuples(${v}, ${E})`;const A=a.map(e=>e.signals.visual);return e.concat({name:n,on:[{events:[...A.length?[{signal:A.join(" || ")}]:[],...i?[{signal:up}]:[]],update:S}]})}},topLevelSignals:(e,t,r)=>{if(q(e)&&e.hasProjection&&t.init){const n=r.filter(e=>e.name===up);if(!n.length)r.unshift({name:up,value:null,on:[{events:"timer{1}",update:`${up} === null ? {} : ${up}`}]})}return r},marks:(e,t,r)=>{const n=t.name;const{x:a,y:i}=t.project.hasChannel;const o=a?.signals.visual;const s=i?.signals.visual;const l=`data(${te.stringValue(t.name+ph)})`;if(ip.defined(t)||!a&&!i)return r;const c={x:a!==undefined?{signal:`${o}[0]`}:{value:0},y:i!==undefined?{signal:`${s}[0]`}:{value:0},x2:a!==undefined?{signal:`${o}[1]`}:{field:{group:"width"}},y2:i!==undefined?{signal:`${s}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const m of A(c))c[m]=[{test:`${l}.length && ${l}[0].unit === ${Th(e)}`,...c[m]},{value:0}];const{fill:u,fillOpacity:d,cursor:f,...p}=t.mark;const h=A(p).reduce((e,t)=>{e[t]=[{test:[a!==undefined&&`${o}[0] !== ${o}[1]`,i!==undefined&&`${s}[0] !== ${s}[1]`].filter(e=>e).join(" && "),value:p[t]},{value:null}];return e},{});const g=f??(t.translate?"move":null);return[{name:`${n+lp}_bg`,type:"rect",clip:true,encode:{enter:{fill:{value:u},fillOpacity:{value:d}},update:c}},...r,{name:n+lp,type:"rect",clip:true,encode:{enter:{...g?{cursor:{value:g}}:{},fill:{value:"transparent"}},update:{...c,...h}}}]}};function hp(e,t,r,n){const a=!e.hasProjection;const i=r.channel;const o=r.signals.visual;const s=te.stringValue(a?e.scaleName(i):e.projectionName());const l=e=>`scale(${s}, ${e})`;const c=e.getSizeSignalRef(i===I?"width":"height").signal;const u=`${i}(unit)`;const d=t.events.reduce((e,t)=>{return[...e,{events:t.between[0],update:`[${u}, ${u}]`},{events:t,update:`[${o}[0], clamp(${u}, 0, ${c})]`}]},[]);if(a){const f=r.signals.data;const p=ip.defined(t);const h=e.getScaleComponent(i);const g=h?h.get("type"):undefined;const m=n?{init:Uf(n,true,l)}:{value:[]};d.push({events:{signal:t.name+cp},update:Eo(g)?`[${l(`${f}[0]`)}, ${l(`${f}[1]`)}]`:`[0, 0]`});return p?[{name:f,on:[]}]:[{name:o,...m,on:d},{name:f,...n?{init:Uf(n)}:{},on:[{events:{signal:o},update:`${o}[0] === ${o}[1] ? null : invert(${s}, ${o})`}]}]}else{const _=i===I?0:1;const y=t.name+dp;const T=n?{init:`[${y}[0][${_}], ${y}[1][${_}]]`}:{value:[]};return[{name:o,...T,on:d}]}}const gp={defined:e=>e.type==="point",signals:(r,e,t)=>{const n=e.name;const a=n+rp;const i=e.project;const o="(item().isVoronoi ? datum.datum : datum)";const s=C(r.component.selection??{}).reduce((e,t)=>{return t.type==="interval"?e.concat(t.name+lp):e},[]).map(e=>`indexof(item().mark.name, '${e}') < 0`).join(" && ");const l=`datum && item().mark.marktype !== 'group' && indexof(item().mark.role, 'legend') < 0${s?` && ${s}`:""}`;let c=`unit: ${Th(r)}, `;if(e.project.hasSelectionId)c+=`${gu}: ${o}[${te.stringValue(gu)}]`;else{const d=i.items.map(e=>{const t=r.fieldDef(e.channel);return t?.bin?`[${o}[${te.stringValue(r.vgField(e.channel,{}))}], `+`${o}[${te.stringValue(r.vgField(e.channel,{binSuffix:"end"}))}]]`:`${o}[${te.stringValue(e.field)}]`}).join(", ");c+=`fields: ${a}, values: [${d}]`}const u=e.events;return t.concat([{name:n+hh,on:u?[{events:u,update:`${l} ? {${c}} : null`,force:true}]:[]}])}};function mp(e){let{model:o,channelDef:t,vgChannel:r,invalidValueRef:n,mainRefFn:s}=e;const a=hl(t)&&t.condition;let i=[];if(a){const c=te.array(a);i=c.map(e=>{const t=s(e);if(ol(e)){const{param:r,empty:n}=e;const a=kh(o,{param:r,empty:n});return{test:a,...t}}else{const i=Ih(o,e.test);return{test:i,...t}}})}if(n!==undefined)i.push(n);const l=s(t);if(l!==undefined)i.push(l);if(i.length>1||i.length===1&&Boolean(i[0].test))return{[r]:i};else if(i.length===1)return{[r]:i[0]};return{}}function _p(t){let e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"text";const r=t.encoding[e];return mp({model:t,channelDef:r,vgChannel:e,mainRefFn:e=>yp(e,t.config),invalidValueRef:undefined})}function yp(e,t){let r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"datum";if(e){if(Sl(e))return L(e.value);if(T(e)){const{format:n,formatType:a}=Gl(e);return js({fieldOrDatumDef:e,format:n,formatType:a,expr:r,config:t})}}return undefined}function Tp(e){let n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const{encoding:a,markDef:i,config:o,stack:s}=e;const t=a.tooltip;if(te.isArray(t))return{tooltip:vp({tooltip:t},s,o,n)};else{const l=n.reactiveGeom?"datum.datum":"datum";const r=e=>{const t=yp(e,o,l);if(t)return t;if(e===null)return undefined;let r=ne("tooltip",i,o);if(r===true)r={content:"encoding"};if(te.isString(r))return{value:r};else if(te.isObject(r))if(x(r))return r;else if(r.content==="encoding")return vp(a,s,o,n);else return{signal:l};return undefined};return mp({model:e,channelDef:t,vgChannel:"tooltip",mainRefFn:r,invalidValueRef:undefined})}}function bp(g,m,e){let{reactiveGeom:t}=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};const _={...e,...e.tooltipFormat};const y={};const T=t?"datum.datum":"datum";const b=[];function r(e,t){const r=Zt(t);const n=v(e)?e:{...e,type:g[r].type};const a=n.title||Hl(n,_);const i=te.array(a).join(", ").replaceAll(/"/g,'\\"');let o;if(P(t)){const s=t==="x"?"x2":"y2";const l=Wl(g[s]);if(D(n.bin)&&l){const c=j(n,{expr:T});const u=j(l,{expr:T});const{format:d,formatType:f}=Gl(n);o=Ys(c,u,d,f,_);y[s]=true}}if((P(t)||t===tt||t===Xe)&&m&&m.fieldChannel===t&&m.offset==="normalize"){const{format:p,formatType:h}=Gl(n);o=js({fieldOrDatumDef:n,format:p,formatType:h,expr:T,config:_,normalizeStack:true}).signal}o??=yp(n,_,T).signal;b.push({channel:t,key:i,value:o})}Sc(g,(e,t)=>{if(B(e))r(e,t);else if(gl(e))r(e.condition,t)});const n={};for(const{channel:a,key:i,value:o}of b)if(!y[a]&&!n[i])n[i]=o;return n}function vp(e,t,r){let{reactiveGeom:n}=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};const a=bp(e,t,r,{reactiveGeom:n});const i=Oe(a).map(e=>{let[t,r]=e;return`"${t}": ${r}`});return i.length>0?{signal:`{${i.join(", ")}}`}:undefined}function Ep(e){const{markDef:t,config:r}=e;const n=ne("aria",t,r);if(n===false)return{};return{...n?{aria:n}:{},...Sp(e),...Ap(e)}}function Sp(e){const{mark:t,markDef:r,config:n}=e;if(n.aria===false)return{};const a=ne("ariaRoleDescription",r,n);if(a!=null)return{ariaRoleDescription:{value:a}};return t in Tn?{}:{ariaRoleDescription:{value:t}}}function Ap(t){const{encoding:e,markDef:r,config:n,stack:a}=t;const i=e.description;if(i)return mp({model:t,channelDef:i,vgChannel:"description",mainRefFn:e=>yp(e,t.config),invalidValueRef:undefined});const o=ne("description",r,n);if(o!=null)return{description:L(o)};if(n.aria===false)return{};const s=bp(e,a,n);if(re(s))return undefined;return{description:{signal:Oe(s).map((e,t)=>{let[r,n]=e;return`"${t>0?"; ":""}${r}: " + (${n})`}).join(" + ")}}}function V(t,e){let r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};const{markDef:n,encoding:a,config:i}=e;const{vgChannel:o}=r;let{defaultRef:s,defaultValue:l}=r;if(s===undefined){l??=ne(t,n,i,{vgChannel:o,ignoreVgConfig:true});if(l!==undefined)s=L(l)}const c=a[t];const u={markDef:n,config:i,scaleName:e.scaleName(t),scale:e.getScaleComponent(t)};const d=ws({...u,scaleChannel:t,channelDef:c});const f=e=>{return xs({...u,channel:t,channelDef:e,stack:null,defaultRef:s})};return mp({model:e,channelDef:c,vgChannel:o??t,invalidValueRef:d,mainRefFn:f})}function Op(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{filled:undefined};const{markDef:r,encoding:n,config:a}=e;const{type:i}=r;const o=t.filled??ne("filled",r,a);const s=w(["bar","point","circle","square","geoshape"],i)?"transparent":undefined;const l=ne(o===true?"color":undefined,r,a,{vgChannel:"fill"})??a.mark[o===true&&"color"]??s;const c=ne(o===false?"color":undefined,r,a,{vgChannel:"stroke"})??a.mark[o===false&&"color"];const u=o?"fill":"stroke";const d={...l?{fill:L(l)}:{},...c?{stroke:L(c)}:{}};if(r.color&&(o?r.fill:r.stroke))ae(ma("property",{fill:"fill"in r,stroke:"stroke"in r}));return{...d,...V("color",e,{vgChannel:u,defaultValue:o?l:c}),...V("fill",e,{defaultValue:n.fill?l:undefined}),...V("stroke",e,{defaultValue:n.stroke?c:undefined})}}function Cp(e){const{encoding:t,mark:r}=e;const n=t.order;if(!as(r)&&Sl(n))return mp({model:e,channelDef:n,vgChannel:"zindex",mainRefFn:e=>L(e.value),invalidValueRef:undefined});return{}}function kp(e){let{channel:t,markDef:r,encoding:n={},model:a,bandPosition:i}=e;const o=`${t}Offset`;const s=r[o];const l=n[o];if((o==="xOffset"||o==="yOffset")&&l){const u=xs({channel:o,channelDef:l,markDef:r,config:a?.config,scaleName:a.scaleName(o),scale:a.getScaleComponent(o),stack:null,defaultRef:L(s),bandPosition:i});return{offsetType:"encoding",offset:u}}const c=r[o];if(c)return{offsetType:"visual",offset:c};return{}}function d(e,t,r){let{defaultPos:n,vgChannel:a}=r;const{encoding:i,markDef:o,config:s,stack:l}=t;const c=i[e];const u=i[Xt(e)];const d=t.scaleName(e);const f=t.getScaleComponent(e);const{offset:p,offsetType:h}=kp({channel:e,markDef:o,encoding:i,model:t,bandPosition:.5});const g=Rp({model:t,defaultPos:n,channel:e,scaleName:d,scale:f});const m=!c&&P(e)&&(i.latitude||i.longitude)?{field:t.getName(e)}:wp({channel:e,channelDef:c,channel2Def:u,markDef:o,config:s,scaleName:d,scale:f,stack:l,offset:p,defaultRef:g,bandPosition:h==="encoding"?0:undefined});return m?{[a||e]:m}:undefined}function wp(e){const{channel:t,channelDef:r,scaleName:n,stack:a,offset:i,markDef:o}=e;if(T(r)&&a&&t===a.fieldChannel){if(B(r)){let e=r.bandPosition;if(e===undefined&&o.type==="text"&&(t==="radius"||t==="theta"))e=.5;if(e!==undefined)return Ns({scaleName:n,fieldOrDatumDef:r,startSuffix:"start",bandPosition:e,offset:i})}return Ps(r,n,{suffix:"end"},{offset:i})}return Is(e)}function Rp(e){let{model:a,defaultPos:i,channel:o,scaleName:s,scale:l}=e;const{markDef:c,config:u}=a;return()=>{const e=Zt(o);const t=Qt(o);const r=ne(o,c,u,{vgChannel:t});if(r!==undefined)return Ls(o,r);switch(i){case"zeroOrMin":return Ip({scaleName:s,scale:l,mode:"zeroOrMin",mainChannel:e,config:u});case"zeroOrMax":return Ip({scaleName:s,scale:l,mode:{zeroOrMax:{widthSignal:a.width.signal,heightSignal:a.height.signal}},mainChannel:e,config:u});case"mid":{const n=a[er(o)];return{...n,mult:.5}}}return undefined}}function Ip(e){let{mainChannel:t,config:r,...n}=e;const a=ks(n);const{mode:i}=n;if(a)return a;switch(t){case"radius":{if(i==="zeroOrMin")return{value:0};const{widthSignal:o,heightSignal:s}=i.zeroOrMax;return{signal:`min(${o},${s})/2`}}case"theta":return i==="zeroOrMin"?{value:0}:{signal:"2*PI"};case"x":return i==="zeroOrMin"?{value:0}:{field:{group:"width"}};case"y":return i==="zeroOrMin"?{field:{group:"height"}}:{value:0}}}const Mp={left:"x",center:"xc",right:"x2"},Pp={top:"y",middle:"yc",bottom:"y2"};function Np(e,t,r){let n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:"middle";if(e==="radius"||e==="theta")return Qt(e);const a=e==="x"?"align":"baseline";const i=ne(a,t,r);let o;if(x(i)){ae(Ca(a));o=undefined}else o=i;if(e==="x")return Mp[o||(n==="top"?"left":"center")];else return Pp[o||n]}function Dp(e,t,r){let{defaultPos:n,defaultPos2:a,range:i}=r;if(i)return xp(e,t,{defaultPos:n,defaultPos2:a});return d(e,t,{defaultPos:n})}function xp(e,t,r){let{defaultPos:n,defaultPos2:a}=r;const{markDef:i,config:o}=t;const s=Xt(e);const l=er(e);const c=Lp(t,a,s);const u=c[l]?Np(e,i,o):Qt(e);return{...d(e,t,{defaultPos:n,vgChannel:u}),...c}}function Lp(e,t,r){const{encoding:n,mark:a,markDef:i,stack:o,config:s}=e;const l=Zt(r);const c=er(r);const u=Qt(r);const d=n[l];const f=e.scaleName(l);const p=e.getScaleComponent(l);const{offset:h}=r in n||r in i?kp({channel:r,markDef:i,encoding:n,model:e}):kp({channel:l,markDef:i,encoding:n,model:e});if(!d&&(r==="x2"||r==="y2")&&(n.latitude||n.longitude)){const m=er(r);const _=e.markDef[m];if(_!=null)return{[m]:{value:_}};else return{[u]:{field:e.getName(r)}}}const g=Fp({channel:r,channelDef:d,channel2Def:n[r],markDef:i,config:s,scaleName:f,scale:p,stack:o,offset:h,defaultRef:undefined});if(g!==undefined)return{[u]:g};return Up(r,i)||Up(r,{[r]:In(r,i,s.style),[c]:In(c,i,s.style)})||Up(r,s[a])||Up(r,s.mark)||{[u]:Rp({model:e,defaultPos:t,channel:r,scaleName:f,scale:p})()}}function Fp(e){let{channel:t,channelDef:r,channel2Def:n,markDef:a,config:i,scaleName:o,scale:s,stack:l,offset:c,defaultRef:u}=e;if(T(r)&&l&&t.charAt(0)===l.fieldChannel.charAt(0))return Ps(r,o,{suffix:"start"},{offset:c});return Is({channel:t,channelDef:n,scaleName:o,scale:s,stack:l,markDef:a,config:i,offset:c,defaultRef:u})}function Up(e,t){const r=er(e);const n=Qt(e);if(t[n]!==undefined)return{[n]:Ls(e,t[n])};else if(t[e]!==undefined)return{[n]:Ls(e,t[e])};else if(t[r]){const a=t[r];if(_s(a))ae(_a(r));else return{[r]:Ls(e,a)}}return undefined}function Bp(e,t){const{config:r,encoding:n,markDef:a}=e;const i=a.type;const o=Xt(t);const s=er(t);const l=n[t];const c=n[o];const u=e.getScaleComponent(t);const d=u?u.get("type"):undefined;const f=a.orient;const p=n[s]??n.size??ne("size",a,r,{vgChannel:s});const h=tr(t);const g=i==="bar"&&(t==="x"?f==="vertical":f==="horizontal");if(B(l)&&(N(l.bin)||D(l.bin)||l.timeUnit&&!c)&&!(p&&!_s(p))&&!n[h]&&!U(d))return Vp({fieldDef:l,fieldDef2:c,channel:t,model:e});else if((T(l)&&U(d)||g)&&!c)return Hp(l,t,e);else return xp(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function jp(e,t,r,n,a,i,o){if(_s(a))if(r){const l=r.get("type");if(l==="band"){let e=`bandwidth('${t}')`;if(a.band!==1)e=`${a.band} * ${e}`;const c=Rn("minBandSize",{type:o},n);return{signal:c?`max(${Cn(c)}, ${e})`:e}}else if(a.band!==1){ae(Ia(l));a=undefined}}else return{mult:a.band,field:{group:e}};else if(x(a))return a;else if(a)return{value:a};if(r){const u=r.get("range");if(pn(u)&&te.isNumber(u.step))return{value:u.step-2}}if(!i){const{bandPaddingInner:d,barBandPaddingInner:f,rectBandPaddingInner:p}=n.scale;const h=R(d,o==="bar"?f:p);if(x(h))return{signal:`(1 - (${h.signal})) * ${e}`};else if(te.isNumber(h))return{signal:`${1-h} * ${e}`}}const s=Nu(n.view,e);return{value:s-2}}function Hp(e,t,r){const{markDef:n,encoding:a,config:i,stack:o}=r;const s=n.orient;const l=r.scaleName(t);const c=r.getScaleComponent(t);const u=er(t);const d=Xt(t);const f=tr(t);const p=r.scaleName(f);const h=r.getScaleComponent(rr(t));const g=s==="horizontal"&&t==="y"||s==="vertical"&&t==="x";let m;if(a.size||n.size)if(g)m=V("size",r,{vgChannel:u,defaultRef:L(n.size)});else ae(Da(n.type));const _=!!m;const y=dl({channel:t,fieldDef:e,markDef:n,config:i,scaleType:(c||h)?.get("type"),useVlSizeChannel:g});m=m||{[u]:jp(u,p||l,h||c,i,y,!!e,n.type)};const T=(c||h)?.get("type")==="band"&&_s(y)&&!_?"top":"middle";const b=Np(t,n,i,T);const v=b==="xc"||b==="yc";const{offset:E,offsetType:S}=kp({channel:t,markDef:n,encoding:a,model:r,bandPosition:v?.5:0});const A=Is({channel:t,channelDef:e,markDef:n,config:i,scaleName:l,scale:c,stack:o,offset:E,defaultRef:Rp({model:r,defaultPos:"mid",channel:t,scaleName:l,scale:c}),bandPosition:v?S==="encoding"?0:.5:x(y)?{signal:`(1-${y})/2`}:_s(y)?(1-y.band)/2:0});if(u)return{[b]:A,...m};else{const O=Qt(d);const C=m[u];const k=E?{...C,offset:E}:C;return{[b]:A,[O]:te.isArray(A)?[A[0],{...A[1],offset:k}]:{...A,offset:k}}}}function Gp(e,t,r,n,a,i,o){if(wt(e))return 0;const s=e==="x"||e==="y2";const l=s?-t/2:t/2;if(x(r)||x(a)||x(n)||i){const c=Cn(r);const u=Cn(a);const d=Cn(n);const f=Cn(i);const p=s?"":"-";const h=i?`(${o} < ${f} ? ${p}0.5 * (${f} - (${o})) : ${l})`:l;const g=d?`${d} + `:"";const m=c?`(${c} ? -1 : 1) * `:"";const _=u?`(${u} + ${h})`:h;return{signal:g+m+_}}else{a=a||0;return n+(r?-a-l:+a+l)}}function Vp(e){let{fieldDef:t,fieldDef2:r,channel:n,model:a}=e;const{config:i,markDef:o,encoding:s}=a;const l=a.getScaleComponent(n);const c=a.scaleName(n);const u=l?l.get("type"):undefined;const d=l.get("reverse");const f=dl({channel:n,fieldDef:t,markDef:o,config:i,scaleType:u});const p=a.component.axes[n]?.[0];const h=p?.get("translate")??.5;const g=P(n)?ne("binSpacing",o,i)??0:0;const m=Xt(n);const _=Qt(n);const y=Qt(m);const T=Rn("minBandSize",o,i);const{offset:b}=kp({channel:n,markDef:o,encoding:s,model:a,bandPosition:0});const{offset:v}=kp({channel:m,markDef:o,encoding:s,model:a,bandPosition:0});const E=Ds({fieldDef:t,scaleName:c});const S=Gp(n,g,d,h,b,T,E);const A=Gp(m,g,d,h,v??b,T,E);const O=x(f)?{signal:`(1-${f.signal})/2`}:_s(f)?(1-f.band)/2:.5;const C=ul({fieldDef:t,fieldDef2:r,markDef:o,config:i});if(N(t.bin)||t.timeUnit){const k=t.timeUnit&&C!==.5;return{[y]:Wp({fieldDef:t,scaleName:c,bandPosition:O,offset:A,useRectOffsetField:k}),[_]:Wp({fieldDef:t,scaleName:c,bandPosition:x(O)?{signal:`1-${O.signal}`}:1-O,offset:S,useRectOffsetField:k})}}else if(D(t.bin)){const w=Ps(t,c,{},{offset:A});if(B(r))return{[y]:w,[_]:Ps(r,c,{},{offset:S})};else if(sn(t.bin)&&t.bin.step)return{[y]:w,[_]:{signal:`scale("${c}", ${j(t,{expr:"datum"})} + ${t.bin.step})`,offset:S}}}ae(ri(m));return undefined}function Wp(e){let{fieldDef:t,scaleName:r,bandPosition:n,offset:a,useRectOffsetField:i}=e;return Ns({scaleName:r,fieldOrDatumDef:t,bandPosition:n,offset:a,...i?{startSuffix:Zf,endSuffix:Qf}:{}})}const qp=new Set(["aria","width","height"]);function $p(e,t){const{fill:r=undefined,stroke:n=undefined}=t.color==="include"?Op(e):{};return{...Kp(e.markDef,t),...zp("fill",r),...zp("stroke",n),...V("opacity",e),...V("fillOpacity",e),...V("strokeOpacity",e),...V("strokeWidth",e),...V("strokeDash",e),...Cp(e),...Tp(e),..._p(e,"href"),...Ep(e)}}function zp(e,t){return t?{[e]:t}:{}}function Kp(r,n){return yn.reduce((e,t)=>{if(!qp.has(t)&&r[t]!==undefined&&n[t]!=="ignore")e[t]=L(r[t]);return e},{})}function Yp(o){const{config:s,markDef:l}=o;const c=new Set;o.forEachFieldDef((e,t)=>{let r;if(!Gr(t)||!(r=o.getScaleType(t)))return;const n=tn(e.aggregate);const a=Os({scaleChannel:t,markDef:l,config:s,scaleType:r,isCountAggregate:n});if(Cs(a)){const i=o.vgField(t,{expr:"datum",binSuffix:o.stack?.impute?"mid":undefined});if(i)c.add(i)}});if(c.size>0){const e=[...c].map(e=>eo(e,true)).join(" && ");return{defined:{signal:e}}}return undefined}function Jp(e,t){if(t!==undefined)return{[e]:L(t)};return undefined}const Zp="voronoi",Qp={defined:e=>{return e.type==="point"&&e.nearest},parse:(e,t)=>{if(t.events)for(const r of t.events)r.markname=e.getName(Zp)},marks:(n,e,t)=>{const{x:r,y:a}=e.project.hasChannel;const i=n.mark;if(as(i)){ae(Wn(i));return t}const o={name:n.getName(Zp),type:"path",interactive:true,from:{data:n.getName("marks")},encode:{update:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:true},...Tp(n,{reactiveGeom:true})}},transform:[{type:"voronoi",x:{expr:r||!a?"datum.datum.x || 0":"0"},y:{expr:a||!r?"datum.datum.y || 0":"0"},size:[n.getSizeSignalRef("width"),n.getSizeSignalRef("height")]}]};let s=0;let l=false;t.forEach((e,t)=>{const r=e.name??"";if(r===n.component.mark[0].name)s=t;else if(r.indexOf(Zp)>=0)l=true});if(!l)t.splice(s+1,0,o);return t}},Xp={defined:e=>{return e.type==="point"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!_u(e.bind)},parse:(e,t,r)=>vh(t,r),topLevelSignals:(e,a,i)=>{const o=a.name;const t=a.project;const s=a.bind;const l=a.init&&a.init[0];const c=Qp.defined(a)?"(item().isVoronoi ? datum.datum : datum)":"datum";t.items.forEach((e,t)=>{const r=k(`${o}_${e.field}`);const n=i.filter(e=>e.name===r);if(!n.length)i.unshift({name:r,...l?{init:Uf(l[t])}:{value:null},on:a.events?[{events:a.events,update:`datum && item().mark.marktype !== 'group' ? ${c}[${te.stringValue(e.field)}] : null`}]:[],bind:s[e.field]??s[e.channel]??s})});return i},signals:(e,t,r)=>{const n=t.name;const a=t.project;const i=r.filter(e=>e.name===n+hh)[0];const o=n+rp;const s=a.items.map(e=>k(`${n}_${e.field}`));const l=s.map(e=>`${e} !== null`).join(" && ");if(s.length)i.update=`${l} ? {fields: ${o}, values: [${s.join(", ")}]} : null`;delete i.value;delete i.on;return r}},eh="_toggle",th={defined:e=>{return e.type==="point"&&!!e.toggle},signals:(e,t,r)=>{return r.concat({name:t.name+eh,value:false,on:[{events:t.events,update:t.toggle}]})},modifyExpr:(e,t)=>{const r=t.name+hh;const n=t.name+eh;return`${n} ? null : ${r}, `+(t.resolve==="global"?`${n} ? null : true, `:`${n} ? null : {unit: ${Th(e)}}, `)+`${n} ? ${r} : null`}},rh={defined:e=>{return e.clear!==undefined&&e.clear!==false},parse:(e,t)=>{if(t.clear)t.clear=te.isString(t.clear)?te.parseSelector(t.clear,"view"):t.clear},topLevelSignals:(e,t,r)=>{if(Xp.defined(t))for(const n of t.project.items){const a=r.findIndex(e=>e.name===k(`${t.name}_${n.field}`));if(a!==-1)r[a].on.push({events:t.clear,update:"null"})}return r},signals:(e,r,n)=>{function t(e,t){if(e!==-1&&n[e].on)n[e].on.push({events:r.clear,update:t})}if(r.type==="interval")for(const a of r.project.items){const i=n.findIndex(e=>e.name===a.signals.visual);t(i,"[0, 0]");if(i===-1){const o=n.findIndex(e=>e.name===a.signals.data);t(o,"null")}}else{let e=n.findIndex(e=>e.name===r.name+hh);t(e,"null");if(th.defined(r)){e=n.findIndex(e=>e.name===r.name+eh);t(e,"false")}}return n}},nh={defined:e=>{const t=e.resolve==="global"&&e.bind&&_u(e.bind);const r=e.project.items.length===1&&e.project.items[0].field!==gu;if(t&&!r)ae(Yn);return t&&r},parse:(e,t,r)=>{const n=g(r);n.select=te.isString(n.select)?{type:n.select,toggle:t.toggle}:{...n.select,toggle:t.toggle};vh(t,n);if(te.isObject(r.select)&&(r.select.on||r.select.clear)){const o='event.item && indexof(event.item.mark.role, "legend") < 0';for(const a of t.events){a.filter=te.array(a.filter??[]);if(!a.filter.includes(o))a.filter.push(o)}}const a=yu(t.bind)?t.bind.legend:"click";const i=te.isString(a)?te.parseSelector(a,"view"):te.array(a);t.bind={legend:{merge:i}}},topLevelSignals:(e,t,r)=>{const n=t.name;const a=yu(t.bind)&&t.bind.legend;const i=r=>e=>{const t=g(e);t.markname=r;return t};for(const o of t.project.items){if(!o.hasLegend)continue;const s=`${k(o.field)}_legend`;const l=`${n}_${s}`;const c=r.filter(e=>e.name===l);if(c.length===0){const u=a.merge.map(i(`${s}_symbols`)).concat(a.merge.map(i(`${s}_labels`))).concat(a.merge.map(i(`${s}_entries`)));r.unshift({name:l,...!t.init?{value:null}:{},on:[{events:u,update:"isDefined(datum.value) ? datum.value : item().items[0].items[0].datum.value",force:true},{events:a.merge,update:`!event.item || !datum ? null : ${l}`,force:true}]})}}return r},signals:(e,t,r)=>{const n=t.name;const a=t.project;const i=r.find(e=>e.name===n+hh);const o=n+rp;const s=a.items.filter(e=>e.hasLegend).map(e=>k(`${n}_${k(e.field)}_legend`));const l=s.map(e=>`${e} !== null`).join(" && ");const c=`${l} ? {fields: ${o}, values: [${s.join(", ")}]} : null`;if(t.events&&s.length>0)i.on.push({events:s.map(e=>({signal:e})),update:c});else if(s.length>0){i.update=c;delete i.value;delete i.on}const u=r.find(e=>e.name===n+eh);const d=yu(t.bind)&&t.bind.legend;if(u)if(!t.events)u.on[0].events=d;else u.on.push({...u.on[0],events:d});return r}};function ah(e,t,r){const n=e.fieldDef(t)?.field;for(const a of C(e.component.selection??{})){const i=a.project.hasField[n]??a.project.hasChannel[t];if(i&&nh.defined(a)){const o=r.get("selections")??[];o.push(a.name);r.set("selections",o,false);i.hasLegend=true}}}const ih="_translate_anchor",oh="_translate_delta",sh={defined:e=>{return e.type==="interval"&&e.translate},signals:(e,t,r)=>{const n=t.name;const a=ip.defined(t);const i=n+ih;const{x:o,y:s}=t.project.hasChannel;let l=te.parseSelector(t.translate,"scope");if(!a)l=l.map(e=>(e.between[0].markname=n+lp,e));r.push({name:i,value:{},on:[{events:l.map(e=>e.between[0]),update:"{x: x(unit), y: y(unit)"+(o!==undefined?`, extent_x: ${a?op(e,I):`slice(${o.signals.visual})`}`:"")+(s!==undefined?`, extent_y: ${a?op(e,M):`slice(${s.signals.visual})`}`:"")+"}"}]},{name:n+oh,value:{},on:[{events:l,update:`{x: ${i}.x - x(unit), y: ${i}.y - y(unit)}`}]});if(o!==undefined)lh(e,t,o,"width",r);if(s!==undefined)lh(e,t,s,"height",r);return r}};function lh(e,t,r,n,a){const i=t.name;const o=i+ih;const s=i+oh;const l=r.channel;const c=ip.defined(t);const u=a.filter(e=>e.name===r.signals[c?"data":"visual"])[0];const d=e.getSizeSignalRef(n).signal;const f=e.getScaleComponent(l);const p=f&&f.get("type");const h=f&&f.get("reverse");const g=!c?"":l===I?h?"":"-":h?"-":"";const m=`${o}.extent_${l}`;const _=`${g}${s}.${l} / ${c?`${d}`:`span(${m})`}`;const y=!c||!f?"panLinear":p==="log"?"panLog":p==="symlog"?"panSymlog":p==="pow"?"panPow":"panLinear";const T=!c?"":p==="pow"?`, ${f.get("exponent")??1}`:p==="symlog"?`, ${f.get("constant")??1}`:"";const b=`${y}(${m}, ${_}${T})`;u.on.push({events:{signal:s},update:c?b:`clampRange(${b}, 0, ${d})`})}const ch="_zoom_anchor",uh="_zoom_delta",dh={defined:e=>{return e.type==="interval"&&e.zoom},signals:(e,t,r)=>{const n=t.name;const a=ip.defined(t);const i=n+uh;const{x:o,y:s}=t.project.hasChannel;const l=te.stringValue(e.scaleName(I));const c=te.stringValue(e.scaleName(M));let u=te.parseSelector(t.zoom,"scope");if(!a)u=u.map(e=>(e.markname=n+lp,e));r.push({name:n+ch,on:[{events:u,update:!a?`{x: x(unit), y: y(unit)}`:"{"+[l?`x: invert(${l}, x(unit))`:"",c?`y: invert(${c}, y(unit))`:""].filter(e=>e).join(", ")+"}"}]},{name:i,on:[{events:u,force:true,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]});if(o!==undefined)fh(e,t,o,"width",r);if(s!==undefined)fh(e,t,s,"height",r);return r}};function fh(e,t,r,n,a){const i=t.name;const o=r.channel;const s=ip.defined(t);const l=a.filter(e=>e.name===r.signals[s?"data":"visual"])[0];const c=e.getSizeSignalRef(n).signal;const u=e.getScaleComponent(o);const d=u&&u.get("type");const f=s?op(e,o):l.name;const p=i+uh;const h=`${i}${ch}.${o}`;const g=!s||!u?"zoomLinear":d==="log"?"zoomLog":d==="symlog"?"zoomSymlog":d==="pow"?"zoomPow":"zoomLinear";const m=!s?"":d==="pow"?`, ${u.get("exponent")??1}`:d==="symlog"?`, ${u.get("constant")??1}`:"";const _=`${g}(${f}, ${h}, ${p}${m})`;l.on.push({events:{signal:p},update:s?_:`clampRange(${_}, 0, ${c})`})}const ph="_store",hh="_tuple",gh="_modify",mh="vlSelectionResolve",_h=[gp,pp,ap,th,Xp,ip,nh,rh,sh,dh,Qp];function yh(e){let t=e.parent;while(t){if(y_(t))break;t=t.parent}return t}function Th(e){let{escape:t}=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{escape:true};let r=t?te.stringValue(e.name):e.name;const n=yh(e);if(n){const{facet:a}=n;for(const i of Lt)if(a[i])r+=` + '__facet_${i}_' + (facet[${te.stringValue(n.vgField(i))}])`}return r}function bh(e){return C(e.component.selection??{}).reduce((e,t)=>{return e||t.project.hasSelectionId},false)}function vh(e,t){if(te.isString(t.select)||!t.select.on)delete e.events;if(te.isString(t.select)||!t.select.clear)delete e.clear;if(te.isString(t.select)||!t.select.toggle)delete e.toggle}function Eh(e){const t=[];if(e.type==="Identifier")return[e.name];if(e.type==="Literal")return[e.value];if(e.type==="MemberExpression"){t.push(...Eh(e.object));t.push(...Eh(e.property))}return t}function Sh(e){if(e.object.type==="MemberExpression")return Sh(e.object);return e.object.name==="datum"}function Ah(e){const t=te.parseExpression(e);const r=new Set;t.visit(e=>{if(e.type==="MemberExpression"&&Sh(e))r.add(Eh(e).slice(1).join("."))});return r}class Oh extends r{clone(){return new Oh(null,this.model,g(this.filter))}constructor(e,t,r){super(e);this.model=t;this.filter=r;this.expr=Ih(this.model,this.filter,this);this._dependentFields=Ah(this.expr)}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function Ch(e,t){const r={};const n=e.config.selection;if(!t||!t.length)return r;for(const a of t){const i=k(a.name);const o=a.select;const s=te.isString(o)?o:o.type;const l=te.isObject(o)?g(o):{type:s};const c=n[s];for(const f in c){if(f==="fields"||f==="encodings")continue;if(f==="mark")l[f]={...c[f],...l[f]};if(l[f]===undefined||l[f]===true)l[f]=g(c[f]??l[f])}const u=r[i]={...l,name:i,type:s,init:a.value,bind:a.bind,events:te.isString(l.on)?te.parseSelector(l.on,"scope"):te.array(g(l.on))};const d=g(a);for(const p of _h)if(p.defined(u)&&p.parse)p.parse(e,u,d)}return r}function kh(e,t,r){let n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:"datum";const a=te.isString(t)?t:t.param;const i=k(a);const o=te.stringValue(i+ph);let s;try{s=e.getSelectionComponent(i,a)}catch(e){return`!!${i}`}if(s.project.timeUnit){const f=r??e.component.data.raw;const p=s.project.timeUnit.clone();if(f.parent)p.insertAsParentOf(f);else f.parent=p}const l=s.project.hasSelectionId?"vlSelectionIdTest(":"vlSelectionTest(";const c=s.resolve==="global"?")":`, ${te.stringValue(s.resolve)})`;const u=`${l}${o}, ${n}${c}`;const d=`length(data(${o}))`;return t.empty===false?`${d} && ${u}`:`!${d} || ${u}`}function wh(e,t,r){const n=k(t);const a=r["encoding"];let i=r["field"];let o;try{o=e.getSelectionComponent(n,t)}catch(e){return n}if(!a&&!i){i=o.project.items[0].field;if(o.project.items.length>1)ae('A "field" or "encoding" must be specified when using a selection as a scale domain. '+`Using "field": ${te.stringValue(i)}.`)}else if(a&&!i){const s=o.project.items.filter(e=>e.channel===a);if(!s.length||s.length>1){i=o.project.items[0].field;ae((!s.length?"No ":"Multiple ")+`matching ${te.stringValue(a)} encoding found for selection ${te.stringValue(r.param)}. `+`Using "field": ${te.stringValue(i)}.`)}else i=s[0].field}return`${o.name}[${te.stringValue(Ne(i))}]`}function Rh(e,t){for(const[r,n]of Oe(e.component.selection??{})){const a=e.getName(`lookup_${r}`);e.component.data.outputNodes[a]=n.materialized=new zf(new Oh(t,e,{param:r}),a,G.Lookup,e.component.data.outputNodeRefCounts)}}function Ih(t,e,r){return ke(e,e=>{if(te.isString(e))return e;else if(Hi(e))return kh(t,e,r);else return Xi(e)})}function Mh(e,t){if(!e)return undefined;if(te.isArray(e)&&!fn(e))return e.map(e=>Hl(e,t)).join(", ");return e}function Ph(e,t,r,n){e.encode??={};e.encode[t]??={};e.encode[t].update??={};e.encode[t].update[r]=n}function Nh(e,t,r){let n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{header:false};const{disable:a,orient:i,scale:o,labelExpr:s,title:l,zindex:c,...u}=e.combine();if(a)return undefined;for(const d in u){const f=oc[d];const p=u[d];if(f&&f!==t&&f!=="both")delete u[d];else if(ac(p)){const{condition:h,...g}=p;const m=te.array(h);const _=nc[d];if(_){const{vgProp:y,part:T}=_;const b=[...m.map(e=>{const{test:t,...r}=e;return{test:Ih(null,t),...r}}),g];Ph(u,T,y,b);delete u[d]}else if(_===null){const v={signal:m.map(e=>{const{test:t,...r}=e;return`${Ih(null,t)} ? ${On(r)} : `}).join("")+On(g)};u[d]=v}}else if(x(p)){const E=nc[d];if(E){const{vgProp:S,part:A}=E;Ph(u,A,S,p);delete u[d]}}if(w(["labelAlign","labelBaseline"],d)&&u[d]===null)delete u[d]}if(t==="grid"){if(!u.grid)return undefined;if(u.encode){const{grid:O}=u.encode;u.encode={...O?{grid:O}:{}};if(re(u.encode))delete u.encode}return{scale:o,orient:i,...u,domain:false,labels:false,aria:false,maxExtent:0,minExtent:0,ticks:false,zindex:R(c,0)}}else{if(!n.header&&e.mainExtracted)return undefined;if(s!==undefined){let e=s;if(u.encode?.labels?.update&&x(u.encode.labels.update.text))e=De(s,"datum.label",u.encode.labels.update.text.signal);Ph(u,"labels","text",{signal:e})}if(u.labelAlign===null)delete u.labelAlign;if(u.encode){for(const k of ic)if(!e.hasAxisPart(k))delete u.encode[k];if(re(u.encode))delete u.encode}const C=Mh(l,r);return{scale:o,orient:i,grid:false,...C?{title:C}:{},...u,...r.aria===false?{aria:false}:{},zindex:R(c,0)}}}function Dh(e){const{axes:t}=e.component;const r=[];for(const n of Er)if(t[n])for(const a of t[n])if(!a.get("disable")&&!a.get("gridScale")){const i=n==="x"?"height":"width";const o=e.getSizeSignalRef(i).signal;if(i!==o)r.push({name:i,update:o})}return r}function xh(e,t){const{x:r=[],y:n=[]}=e;return[...r.map(e=>Nh(e,"grid",t)),...n.map(e=>Nh(e,"grid",t)),...r.map(e=>Nh(e,"main",t)),...n.map(e=>Nh(e,"main",t))].filter(e=>e)}function Lh(e,s,l,c){return Object.assign.apply(null,[{},...e.map(e=>{if(e==="axisOrient"){const t=l==="x"?"bottom":"left";const r=s[l==="x"?"axisBottom":"axisLeft"]||{};const n=s[l==="x"?"axisTop":"axisRight"]||{};const a=new Set([...A(r),...A(n)]);const i={};for(const o of a.values())i[o]={signal:`${c["signal"]} === "${t}" ? ${Cn(r[o])} : ${Cn(n[o])}`};return i}return s[e]})])}function Fh(e,t,r,n){const a=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:yo(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[];const i=e==="x"?"axisX":"axisY";const o=x(r)?"axisOrient":`axis${Re(r)}`;const s=[...a,...a.map(e=>i+e.substr(4))];const l=["axis",o,i];return{vlOnlyAxisConfig:Lh(s,n,e,r),vgAxisConfig:Lh(l,n,e,r),axisConfigStyle:Uh([...l,...s],n)}}function Uh(e,t){const r=[{}];for(const n of e){let e=t[n]?.style;if(e){e=te.array(e);for(const a of e)r.push(t.style[a])}}return Object.assign.apply(null,r)}function Bh(e,t,r){let n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};const a=Mn(e,r,t);if(a!==undefined)return{configFrom:"style",configValue:a};for(const i of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(n[i]?.[e]!==undefined)return{configFrom:i,configValue:n[i][e]};return{}}const jh={scale:e=>{let{model:t,channel:r}=e;return t.scaleName(r)},format:e=>{let{format:t}=e;return t},formatType:e=>{let{formatType:t}=e;return t},grid:e=>{let{fieldOrDatumDef:t,axis:r,scaleType:n}=e;return r.grid??Hh(n,t)},gridScale:e=>{let{model:t,channel:r}=e;return Gh(t,r)},labelAlign:e=>{let{axis:t,labelAngle:r,orient:n,channel:a}=e;return t.labelAlign||$h(r,n,a)},labelAngle:e=>{let{labelAngle:t}=e;return t},labelBaseline:e=>{let{axis:t,labelAngle:r,orient:n,channel:a}=e;return t.labelBaseline||qh(r,n,a)},labelFlush:e=>{let{axis:t,fieldOrDatumDef:r,channel:n}=e;return t.labelFlush??zh(r.type,n)},labelOverlap:e=>{let{axis:t,fieldOrDatumDef:r,scaleType:n}=e;return t.labelOverlap??Kh(r.type,n,B(r)&&!!r.timeUnit,B(r)?r.sort:undefined)},orient:e=>{let{orient:t}=e;return t},tickCount:e=>{let{channel:t,model:r,axis:n,fieldOrDatumDef:a,scaleType:i}=e;const o=t==="x"?"width":t==="y"?"height":undefined;const s=o?r.getSizeSignalRef(o):undefined;return n.tickCount??Jh({fieldOrDatumDef:a,scaleType:i,size:s,values:n.values})},tickMinStep:Zh,title:e=>{let{axis:t,model:r,channel:n}=e;if(t.title!==undefined)return t.title;const a=Qh(r,n);if(a!==undefined)return a;const i=r.typedFieldDef(n);const o=n==="x"?"x2":"y2";const s=r.fieldDef(o);return Nn(i?[ll(i)]:[],B(s)?[ll(s)]:[])},values:e=>{let{axis:t,fieldOrDatumDef:r}=e;return Xh(t,r)},zindex:e=>{let{axis:t,fieldOrDatumDef:r,mark:n}=e;return t.zindex??eg(n,r)}};function Hh(e,t){return!U(e)&&B(t)&&!N(t?.bin)&&!D(t?.bin)}function Gh(e,t){const r=t==="x"?"y":"x";if(e.getScaleComponent(r))return e.scaleName(r);return undefined}function Vh(e,t,r,n,a){const i=t?.labelAngle;if(i!==undefined)return x(i)?i:Ge(i);else{const{configValue:o}=Bh("labelAngle",n,t?.style,a);if(o!==undefined)return Ge(o);else{if(r===I&&w([lo,oo],e.type)&&!(B(e)&&e.timeUnit))return 270;return undefined}}}function Wh(e){return`(((${e.signal} % 360) + 360) % 360)`}function qh(e,t,r,n){if(e!==undefined)if(r==="x"){if(x(e)){const a=Wh(e);const i=x(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${a} && ${a} < 135) || (225 < ${a} && ${a} < 315) ? "middle" :`+`(${a} <= 45 || 315 <= ${a}) === ${i} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(x(t)){const o=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${o} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)===(t==="top")?"bottom":"top"}else{if(x(e)){const s=Wh(e);const l=x(t)?`(${t.signal} === "left")`:t==="left";const c=n?'"middle"':"null";return{signal:`${s} <= 45 || 315 <= ${s} || (135 <= ${s} && ${s} <= 225) ? ${c} : (45 <= ${s} && ${s} <= 135) === ${l} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return n?"middle":null;if(x(t)){const u=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${u} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)===(t==="left")?"top":"bottom"}return undefined}function $h(e,t,r){if(e===undefined)return undefined;const n=r==="x";const a=n?0:90;const i=n?"bottom":"left";if(x(e)){const o=Wh(e);const s=x(t)?`(${t.signal} === "${i}")`:t===i;return{signal:`(${a?`(${o} + 90)`:o} % 180 === 0) ? ${n?null:'"center"'} :`+`(${a} < ${o} && ${o} < ${180+a}) === ${s} ? "left" : "right"`}}if((e+a)%180===0)return n?null:"center";if(x(t)){const l=a<e&&e<180+a?"===":"!==";const c=`${t.signal} ${l} "${i}"`;return{signal:`${c} ? "left" : "right"`}}if((a<e&&e<180+a)===(t===i))return"left";return"right"}function zh(e,t){if(t==="x"&&w(["quantitative","temporal"],e))return true;return undefined}function Kh(e,t,r,n){if(r&&!te.isObject(n)||e!=="nominal"&&e!=="ordinal"){if(t==="log"||t==="symlog")return"greedy";return true}return undefined}function Yh(e){return e==="x"?"bottom":"left"}function Jh(e){let{fieldOrDatumDef:t,scaleType:r,size:n,values:a}=e;if(!a&&!U(r)&&r!=="log"){if(B(t)){if(N(t.bin))return{signal:`ceil(${n.signal}/10)`};if(t.timeUnit&&w(["month","hours","day","quarter"],F(t.timeUnit)?.unit))return undefined}return{signal:`ceil(${n.signal}/40)`}}return undefined}function Zh(e){let{format:t,fieldOrDatumDef:r}=e;if(t==="d")return 1;if(B(r)){const{timeUnit:n}=r;if(n){const a=Fi(n);if(a)return{signal:a}}}return undefined}function Qh(e,t){const r=t==="x"?"x2":"y2";const n=e.fieldDef(t);const a=e.fieldDef(r);const i=n?n.title:undefined;const o=a?a.title:undefined;if(i&&o)return Dn(i,o);else if(i)return i;else if(o)return o;else if(i!==undefined)return i;else if(o!==undefined)return o;return undefined}function Xh(e,t){const r=e.values;if(te.isArray(r))return tc(t,r);else if(x(r))return r;return undefined}function eg(e,t){if(e==="rect"&&Il(t))return 1;return 0}class tg extends r{clone(){return new tg(null,g(this.transform))}constructor(e,t){super(e);this.transform=t;this._dependentFields=Ah(this.transform.calculate)}static parseAllForSortIndex(o,e){e.forEachFieldDef((e,t)=>{if(!Al(e))return;if(rl(e.sort)){const{field:r,timeUnit:n}=e;const a=e.sort;const i=a.map((e,t)=>{return`${Xi({field:r,timeUnit:n,equal:e})} ? ${t} : `}).join("")+a.length;o=new tg(o,{calculate:i,as:rg(e,t,{forAs:true})})}});return o}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${S(this.transform)}`}}function rg(e,t,r){return j(e,{prefix:t,suffix:"sort_index",...r})}function ng(e,t){if(w(["top","bottom"],t))return"column";else if(w(["left","right"],t))return"row";return e==="row"?"row":"column"}function ag(e,t,r,n){const a=n==="row"?r.headerRow:n==="column"?r.headerColumn:r.headerFacet;return R((t||{})[e],a[e],r.header[e])}function ig(e,t,r,n){const a={};for(const i of e){const o=ag(i,t||{},r,n);if(o!==undefined)a[i]=o}return a}const og=["row","column"],sg=["header","footer"];function lg(e,t){const r=e.component.layoutHeaders[t].title;const n=e.config?e.config:undefined;const a=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:undefined;const{titleAnchor:i,titleAngle:o,titleOrient:s}=ig(["titleAnchor","titleAngle","titleOrient"],a.header,n,t);const l=ng(t,s);const c=Ge(o);return{name:`${t}-title`,type:"group",role:`${l}-title`,title:{text:r,...t==="row"?{orient:"left"}:{},style:"guide-title",...ug(c,l),...cg(l,c,i),...yg(n,a,t,lu,ou)}}}function cg(e,t){let r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"middle";switch(r){case"start":return{align:"left"};case"end":return{align:"right"}}const n=$h(t,e==="row"?"left":"top",e==="row"?"y":"x");return n?{align:n}:{}}function ug(e,t){const r=qh(e,t==="row"?"left":"top",t==="row"?"y":"x",true);return r?{baseline:r}:{}}function dg(e,t){const r=e.component.layoutHeaders[t];const n=[];for(const a of sg)if(r[a])for(const i of r[a]){const o=hg(e,t,a,r,i);if(o!=null)n.push(o)}return n}function fg(e,t){const{sort:r}=e;if(tl(r))return{field:j(r,{expr:"datum"}),order:r.order??"ascending"};else if(te.isArray(r))return{field:rg(e,t,{expr:"datum"}),order:"ascending"};else return{field:j(e,{expr:"datum"}),order:r??"ascending"}}function pg(e,t,r){const{format:n,formatType:a,labelAngle:i,labelAnchor:o,labelOrient:s,labelExpr:l}=ig(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,r,t);const c=js({fieldOrDatumDef:e,format:n,formatType:a,expr:"parent",config:r}).signal;const u=ng(t,s);return{text:{signal:l?De(De(l,"datum.label",c),"datum.value",j(e,{expr:"parent"})):c},...t==="row"?{orient:"left"}:{},style:"guide-label",frame:"group",...ug(i,u),...cg(u,i,o),...yg(r,e,t,cu,su)}}function hg(t,r,n,a,i){if(i){let e=null;const{facetFieldDef:o}=a;const s=t.config?t.config:undefined;if(o&&i.labels){const{labelOrient:d}=ig(["labelOrient"],o.header,s,r);if(r==="row"&&!w(["top","bottom"],d)||r==="column"&&!w(["left","right"],d))e=pg(o,r,s)}const l=y_(t)&&!nl(t.facet);const c=i.axes;const u=c?.length>0;if(e||u){const f=r==="row"?"height":"width";return{name:t.getName(`${r}_${n}`),type:"group",role:`${r}-${n}`,...a.facetFieldDef?{from:{data:t.getName(`${r}_domain`)},sort:fg(o,r)}:{},...u&&l?{from:{data:t.getName(`facet_domain_${r}`)}}:{},...e?{title:e}:{},...i.sizeSignal?{encode:{update:{[f]:i.sizeSignal}}}:{},...u?{axes:c}:{}}}}return null}const gg={column:{start:0,end:1},row:{start:1,end:0}};function mg(e,t){return gg[t][e]}function _g(e,t){const r={};for(const n of Lt){const a=e[n];if(a?.facetFieldDef){const{titleAnchor:i,titleOrient:o}=ig(["titleAnchor","titleOrient"],a.facetFieldDef.header,t,n);const s=ng(n,o);const l=mg(i,s);if(l!==undefined)r[s]=l}}return re(r)?undefined:r}function yg(e,t,r,n,a){const i={};for(const o of n){if(!a[o])continue;const s=ag(o,t?.header,e,r);if(s!==undefined)i[a[o]]=s}return i}function Tg(e){return[...bg(e,"width"),...bg(e,"height"),...bg(e,"childWidth"),...bg(e,"childHeight")]}function bg(e,t){const r=t==="width"?"x":"y";const n=e.component.layoutSize.get(t);if(!n||n==="merged")return[];const a=e.getSizeSignalRef(t).signal;if(n==="step"){const i=e.getScaleComponent(r);if(i){const o=i.get("type");const s=i.get("range");if(U(o)&&pn(s)){const l=e.scaleName(r);if(y_(e.parent)){const c=e.parent.component.resolve;if(c.scale[r]==="independent")return[vg(l,s)]}return[vg(l,s),{name:a,update:Eg(l,i,`domain('${l}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(n=="container"){const u=a.endsWith("width");const d=u?"containerSize()[0]":"containerSize()[1]";const f=Pu(e.config.view,u?"width":"height");const p=`isFinite(${d}) ? ${d} : ${f}`;return[{name:a,init:p,on:[{update:p,events:"window:resize"}]}]}else return[{name:a,value:n}]}function vg(e,t){const r=`${e}_step`;if(x(t.step))return{name:r,update:t.step.signal};else return{name:r,value:t.step}}function Eg(e,t,r){const n=t.get("type");const a=t.get("padding");const i=R(t.get("paddingOuter"),a);let o=t.get("paddingInner");o=n==="band"?o!==undefined?o:a:1;return`bandspace(${r}, ${Cn(o)}, ${Cn(i)}) * ${e}_step`}function Sg(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function Ag(r,n){return A(r).reduce((e,t)=>{return{...e,...mp({model:n,channelDef:r[t],vgChannel:t,mainRefFn:e=>L(e.value),invalidValueRef:undefined})}},{})}function Og(e,t){if(y_(t))return e==="theta"?"independent":"shared";else if(b_(t))return"shared";else if(T_(t))return P(e)||e==="theta"||e==="radius"?"independent":"shared";throw new Error("invalid model type for resolve")}function Cg(e,t){const r=e.scale[t];const n=P(t)?"axis":"legend";if(r==="independent"){if(e[n][t]==="shared")ae(Ha(t));return"independent"}return e[n][t]||"shared"}const kg={...hu,disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1},wg=A(kg);class Rg extends vf{}const Ig={symbols:Mg,gradient:Pg,labels:Ng,entries:Dg};function Mg(e,t){let{fieldOrDatumDef:r,model:n,channel:a,legendCmpt:i,legendType:o}=t;if(o!=="symbol")return undefined;const{markDef:s,encoding:l,config:c,mark:u}=n;const d=s.filled&&u!=="trail";let f={...kn({},n,us),...Op(n,{filled:d})};const p=i.get("symbolOpacity")??c.legend.symbolOpacity;const h=i.get("symbolFillColor")??c.legend.symbolFillColor;const g=i.get("symbolStrokeColor")??c.legend.symbolStrokeColor;const m=p===undefined?xg(l.opacity)??s.opacity:undefined;if(f.fill)if(a==="fill"||d&&a===st)delete f.fill;else if(f.fill["field"])if(h)delete f.fill;else{f.fill=L(c.legend.symbolBaseFillColor??"black");f.fillOpacity=L(m??1)}else if(te.isArray(f.fill)){const _=Lg(l.fill??l.color)??s.fill??(d&&s.color);if(_)f.fill=L(_)}if(f.stroke)if(a==="stroke"||!d&&a===st)delete f.stroke;else if(f.stroke["field"]||g)delete f.stroke;else if(te.isArray(f.stroke)){const y=R(Lg(l.stroke||l.color),s.stroke,d?s.color:undefined);if(y)f.stroke={value:y}}if(a!==pt){const T=B(r)&&Ug(n,i,r);if(T)f.opacity=[{test:T,...L(m??1)},L(c.legend.unselectedOpacity)];else if(m)f.opacity=L(m)}f={...f,...e};return re(f)?undefined:f}function Pg(e,t){let{model:r,legendType:n,legendCmpt:a}=t;if(n!=="gradient")return undefined;const{config:i,markDef:o,encoding:s}=r;let l={};const c=a.get("gradientOpacity")??i.legend.gradientOpacity;const u=c===undefined?xg(s.opacity)||o.opacity:undefined;if(u)l.opacity=L(u);l={...l,...e};return re(l)?undefined:l}function Ng(e,t){let{fieldOrDatumDef:r,model:n,channel:a,legendCmpt:i}=t;const o=n.legend(a)||{};const s=n.config;const l=B(r)?Ug(n,i,r):undefined;const c=l?[{test:l,value:1},{value:s.legend.unselectedOpacity}]:undefined;const{format:u,formatType:d}=o;let f=undefined;if(Fs(d))f=Gs({fieldOrDatumDef:r,field:"datum.value",format:u,formatType:d,config:s});else if(u===undefined&&d===undefined&&s.customFormatTypes)if(r.type==="quantitative"&&s.numberFormatType)f=Gs({fieldOrDatumDef:r,field:"datum.value",format:s.numberFormat,formatType:s.numberFormatType,config:s});else if(r.type==="temporal"&&s.timeFormatType&&B(r)&&r.timeUnit===undefined)f=Gs({fieldOrDatumDef:r,field:"datum.value",format:s.timeFormat,formatType:s.timeFormatType,config:s});const p={...c?{opacity:c}:{},...f?{text:f}:{},...e};return re(p)?undefined:p}function Dg(e,t){let{legendCmpt:r}=t;const n=r.get("selections");return n?.length?{...e,fill:{value:"transparent"}}:e}function xg(e){return Fg(e,(e,t)=>Math.max(e,t.value))}function Lg(e){return Fg(e,(e,t)=>{return R(e,t.value)})}function Fg(e,t){if(_l(e))return te.array(e.condition).reduce(t,e.value);else if(Sl(e))return e.value;return undefined}function Ug(e,t,r){const n=t.get("selections");if(!n?.length)return undefined;const a=te.stringValue(r.field);return n.map(e=>{const t=te.stringValue(k(e)+ph);return`(!length(data(${t})) || (${e}[${a}] && indexof(${e}[${a}], datum.value) >= 0))`}).join(" || ")}const Bg={direction:e=>{let{direction:t}=e;return t},format:e=>{let{fieldOrDatumDef:t,legend:r,config:n}=e;const{format:a,formatType:i}=r;return Vs(t,t.type,a,i,n,false)},formatType:e=>{let{legend:t,fieldOrDatumDef:r,scaleType:n}=e;const{formatType:a}=t;return Ws(a,r,n)},gradientLength:e=>{const{legend:t,legendConfig:r}=e;return t.gradientLength??r.gradientLength??$g(e)},labelOverlap:e=>{let{legend:t,legendConfig:r,scaleType:n}=e;return t.labelOverlap??r.labelOverlap??Kg(n)},symbolType:e=>{let{legend:t,markDef:r,channel:n,encoding:a}=e;return t.symbolType??Hg(r.type,n,a.shape,r.shape)},title:e=>{let{fieldOrDatumDef:t,config:r}=e;return Bl(t,r,{allowDisabling:true})},type:e=>{let{legendType:t,scaleType:r,channel:n}=e;if(Dt(n)&&So(r)){if(t==="gradient")return undefined}else if(t==="symbol")return undefined;return t},values:e=>{let{fieldOrDatumDef:t,legend:r}=e;return jg(r,t)}};function jg(e,t){const r=e.values;if(te.isArray(r))return tc(t,r);else if(x(r))return r;return undefined}function Hg(e,t,r,n){if(t!=="shape"){const a=Lg(r)??n;if(a)return a}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function Gg(e){const{legend:t}=e;return R(t.type,Vg(e))}function Vg(e){let{channel:t,timeUnit:r,scaleType:n}=e;if(Dt(t)){if(w(["quarter","month","day"],r))return"symbol";if(So(n))return"gradient"}return"symbol"}function Wg(e){let{legendConfig:t,legendType:r,orient:n,legend:a}=e;return a.direction??t[r?"gradientDirection":"symbolDirection"]??qg(n,r)}function qg(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case undefined:return undefined;default:return t==="gradient"?"horizontal":undefined}}function $g(e){let{legendConfig:t,model:r,direction:n,orient:a,scaleType:i}=e;const{gradientHorizontalMaxLength:o,gradientHorizontalMinLength:s,gradientVerticalMaxLength:l,gradientVerticalMinLength:c}=t;if(So(i))if(n==="horizontal")if(a==="top"||a==="bottom")return zg(r,"width",s,o);else return s;else return zg(r,"height",c,l);return undefined}function zg(e,t,r,n){const a=e.getSizeSignalRef(t).signal;return{signal:`clamp(${a}, ${r}, ${n})`}}function Kg(e){if(w(["quantile","threshold","log","symlog"],e))return"greedy";return undefined}function Yg(e){const t=q(e)?Jg(e):em(e);e.component.legends=t;return t}function Jg(e){const{encoding:t}=e;const r={};for(const n of[st,...fu]){const a=H(t[n]);if(!a||!e.getScaleComponent(n))continue;if(n===ut&&B(a)&&a.type===co)continue;r[n]=Xg(e,n)}return r}function Zg(e,t){const r=e.scaleName(t);if(e.mark==="trail")if(t==="color")return{stroke:r};else if(t==="size")return{strokeWidth:r};if(t==="color")return e.markDef.filled?{fill:r}:{stroke:r};return{[t]:r}}function Qg(e,t,r,n){switch(t){case"disable":return r!==undefined;case"values":return!!r?.values;case"title":if(t==="title"&&e===n?.title)return true}return e===(r||{})[t]}function Xg(e,t){let r=e.legend(t);const{markDef:n,encoding:a,config:i}=e;const o=i.legend;const s=new Rg({},Zg(e,t));ah(e,t,s);const l=r!==undefined?!r:o.disable;s.set("disable",l,r!==undefined);if(l)return s;r=r||{};const c=e.getScaleComponent(t).get("type");const u=H(a[t]);const d=B(u)?F(u.timeUnit)?.unit:undefined;const f=r.orient||i.legend.orient||"right";const p=Gg({legend:r,channel:t,timeUnit:d,scaleType:c});const h=Wg({legend:r,legendType:p,orient:f,legendConfig:o});const g={legend:r,channel:t,model:e,markDef:n,encoding:a,fieldOrDatumDef:u,legendConfig:o,config:i,scaleType:c,orient:f,legendType:p,direction:h};for(const b of wg){if(p==="gradient"&&b.startsWith("symbol")||p==="symbol"&&b.startsWith("gradient"))continue;const v=b in Bg?Bg[b](g):r[b];if(v!==undefined){const E=Qg(v,b,r,e.fieldDef(t));if(E||i.legend[b]===undefined)s.set(b,v,E)}}const m=r?.encoding??{};const _=s.get("selections");const y={};const T={fieldOrDatumDef:u,model:e,channel:t,legendCmpt:s,legendType:p};for(const S of["labels","legend","title","symbols","gradient","entries"]){const A=Ag(m[S]??{},e);const O=S in Ig?Ig[S](A,T):A;if(O!==undefined&&!re(O))y[S]={..._?.length&&B(u)?{name:`${k(u.field)}_legend_${S}`}:{},..._?.length?{interactive:!!_}:{},update:O}}if(!re(y))s.set("encode",y,!!r?.encoding);return s}function em(e){const{legends:t,resolve:r}=e.component;for(const n of e.children){Yg(n);for(const a of A(n.component.legends)){r.legend[a]=Cg(e.component.resolve,a);if(r.legend[a]==="shared"){t[a]=tm(t[a],n.component.legends[a]);if(!t[a]){r.legend[a]="independent";delete t[a]}}}}for(const i of A(t))for(const o of e.children){if(!o.component.legends[i])continue;if(r.legend[i]==="shared")delete o.component.legends[i]}return t}function tm(e,t){if(!e)return t.clone();const r=e.getWithExplicit("orient");const n=t.getWithExplicit("orient");if(r.explicit&&n.explicit&&r.value!==n.value)return undefined;let a=false;for(const i of wg){const o=Cf(e.getWithExplicit(i),t.getWithExplicit(i),i,"legend",(e,t)=>{switch(i){case"symbolType":return rm(e,t);case"title":return xn(e,t);case"type":a=true;return Sf("symbol")}return Of(e,t,i,"legend")});e.setWithExplicit(i,o)}if(a){if(e.implicit?.encode?.gradient)we(e.implicit,["encode","gradient"]);if(e.explicit?.encode?.gradient)we(e.explicit,["encode","gradient"])}return e}function rm(e,t){if(t.value==="circle")return t;return e}function nm(e,t,r,n){e.encode??={};e.encode[t]??={};e.encode[t].update??={};e.encode[t].update[r]=n}function am(t){const e=t.component.legends;const r={};for(const a of A(e)){const i=t.getScaleComponent(a);const o=m(i.get("domains"));if(r[o])for(const s of r[o]){const l=tm(s,e[a]);if(!l)r[o].push(e[a])}else r[o]=[e[a].clone()]}const n=C(r).flat().map(e=>im(e,t.config)).filter(e=>e!==undefined);return n}function im(e,t){const{disable:r,labelExpr:n,selections:a,...i}=e.combine();if(r)return undefined;if(t.aria===false&&i.aria==undefined)i.aria=false;if(i.encode?.symbols){const o=i.encode.symbols.update;if(o.fill&&o.fill["value"]!=="transparent"&&!o.stroke&&!i.stroke)o.stroke={value:"transparent"};for(const s of fu)if(i[s])delete o[s]}if(!i.title)delete i.title;if(n!==undefined){let e=n;if(i.encode?.labels?.update&&x(i.encode.labels.update.text))e=De(n,"datum.label",i.encode.labels.update.text.signal);nm(i,"labels","text",{signal:e})}return i}function om(e){if(b_(e)||T_(e))return sm(e);else return lm(e)}function sm(e){return e.children.reduce((e,t)=>{return e.concat(t.assembleProjections())},lm(e))}function lm(n){const e=n.component.projection;if(!e||e.merged)return[];const t=e.combine();const{name:r}=t;if(!e.data)return[{name:r,translate:{signal:"[width / 2, height / 2]"},...t}];else{const a={signal:`[${e.size.map(e=>e.signal).join(", ")}]`};const i=e.data.reduce((e,t)=>{const r=x(t)?t.signal:`data('${n.lookupDataSource(t)}')`;if(!w(e,r))e.push(r);return e},[]);if(i.length<=0)throw new Error("Projection's fit didn't find any data sources");return[{name:r,size:a,fit:{signal:i.length>1?`[${i.join(", ")}]`:i[0]},...t}]}}const cm=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class um extends vf{merged=false;constructor(e,t,r,n){super({...t},{name:e});this.specifiedProjection=t;this.size=r;this.data=n}get isFit(){return!!this.data}}function dm(e){e.component.projection=q(e)?fm(e):gm(e)}function fm(e){if(e.hasProjection){const t=_(e.specifiedProjection);const r=!(t&&(t.scale!=null||t.translate!=null));const n=r?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:undefined;const a=r?pm(e):undefined;const i=new um(e.projectionName(true),{..._(e.config.projection),...t},n,a);if(!i.get("type"))i.set("type","equalEarth",false);return i}return undefined}function pm(e){const t=[];const{encoding:r}=e;for(const n of[[at,nt],[ot,it]])if(H(r[n[0]])||H(r[n[1]]))t.push({signal:e.getName(`geojson_${t.length}`)});if(e.channelHasField(ut)&&e.typedFieldDef(ut).type===co)t.push({signal:e.getName(`geojson_${t.length}`)});if(t.length===0)t.push(e.requestDataName(G.Main));return t}function hm(t,r){const e=me(cm,e=>{if(!te.hasOwnProperty(t.explicit,e)&&!te.hasOwnProperty(r.explicit,e))return true;if(te.hasOwnProperty(t.explicit,e)&&te.hasOwnProperty(r.explicit,e)&&qe(t.get(e),r.get(e)))return true;return false});const n=qe(t.size,r.size);if(n)if(e)return t;else if(qe(t.explicit,{}))return r;else if(qe(r.explicit,{}))return t;return null}function gm(e){if(e.children.length===0)return undefined;let n;for(const r of e.children)dm(r);const t=me(e.children,e=>{const t=e.component.projection;if(!t)return true;else if(!n){n=t;return true}else{const r=hm(n,t);if(r)n=r;return!!r}});if(n&&t){const a=e.projectionName(true);const i=new um(a,n.specifiedProjection,n.size,g(n.data));for(const o of e.children){const s=o.component.projection;if(s){if(s.isFit)i.data.push(...o.component.projection.data);o.renameProjection(s.get("name"),a);s.merged=true}}return i}return undefined}function mm(e,t,r,n){if(rc(t,r)){const a=q(e)?e.axis(r)??e.legend(r)??{}:{};const i=j(t,{expr:"datum"});const o=j(t,{expr:"datum",binSuffix:"end"});return{formulaAs:j(t,{binSuffix:"range",forAs:true}),formula:Ys(i,o,a.format,a.formatType,n)}}return{}}function _m(e,t){return`${on(e)}_${t}`}function ym(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function Tm(e,t,r){const n=Yl(r,undefined)??{};const a=_m(n,t);return e.getName(`${a}_bins`)}function bm(e){return"as"in e}function vm(e,t,r){let n;let a;if(bm(e))n=te.isString(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]];else n=[j(e,{forAs:true}),j(e,{binSuffix:"end",forAs:true})];const i={...Yl(t,undefined)};const o=_m(i,e.field);const{signal:s,extentSignal:l}=ym(r,o);if(ln(i.extent)){const u=i.extent;a=wh(r,u.param,u);delete i.extent}const c={bin:i,field:e.field,as:[n],...s?{signal:s}:{},...l?{extentSignal:l}:{},...a?{span:a}:{}};return{key:o,binComponent:c}}class Em extends r{clone(){return new Em(null,g(this.bins))}constructor(e,t){super(e);this.bins=t}static makeFromEncoding(e,i){const t=i.reduceFieldDef((e,t,r)=>{if(v(t)&&N(t.bin)){const{key:n,binComponent:a}=vm(t,t.bin,i);e[n]={...a,...e[n],...mm(i,t,r,i.config)}}return e},{});if(re(t))return null;return new Em(e,t)}static makeFromTransform(e,t,r){const{key:n,binComponent:a}=vm(t,t.bin,r);return new Em(e,{[n]:a})}merge(e,t){for(const r of A(e.bins))if(r in this.bins){t(e.bins[r].signal,this.bins[r].signal);this.bins[r].as=Te([...this.bins[r].as,...e.bins[r].as],S)}else this.bins[r]=e.bins[r];for(const n of e.children){e.removeChild(n);n.parent=this}e.remove()}producedFields(){return new Set(C(this.bins).map(e=>e.as).flat(2))}dependentFields(){return new Set(C(this.bins).map(e=>e.field))}hash(){return`Bin ${S(this.bins)}`}assemble(){return C(this.bins).flatMap(e=>{const t=[];const[r,...n]=e.as;const{extent:a,...i}=e.bin;const o={type:"bin",field:Ne(e.field),as:r,signal:e.signal,...!ln(a)?{extent:a}:{extent:null},...e.span?{span:{signal:`span(${e.span})`}}:{},...i};if(!a&&e.extentSignal){t.push({type:"extent",field:Ne(e.field),signal:e.extentSignal});o.extent={signal:e.extentSignal}}t.push(o);for(const s of n)for(let e=0;e<2;e++)t.push({type:"formula",expr:j({field:r[e]},{expr:"datum"}),as:s[e]});if(e.formula)t.push({type:"formula",expr:e.formula,as:e.formulaAs});return t})}}function Sm(e,t,r,n){const a=q(n)?n.encoding[Xt(t)]:undefined;if(v(r)&&q(n)&&fl(r,a,n.markDef,n.config)){e.add(j(r,{}));e.add(j(r,{suffix:"end"}));const{mark:i,markDef:o,config:s}=n;const l=ul({fieldDef:r,markDef:o,config:s});if(is(i)&&l!==.5&&P(t)){e.add(j(r,{suffix:Zf}));e.add(j(r,{suffix:Qf}))}if(r.bin&&rc(r,t))e.add(j(r,{binSuffix:"range"}))}else if(Mt(t)){const c=It(t);e.add(n.getName(c))}else e.add(j(r));if(Al(r)&&Ro(r.scale?.range))e.add(r.scale.range.field);return e}function Am(e,t){for(const r of A(t)){const n=t[r];for(const a of A(n))if(r in e)e[r][a]=new Set([...e[r][a]??[],...n[a]]);else e[r]={[a]:n[a]}}}class Om extends r{clone(){return new Om(null,new Set(this.dimensions),g(this.measures))}constructor(e,t,r){super(e);this.dimensions=t;this.measures=r}get groupBy(){return this.dimensions}static makeFromEncoding(e,o){let t=false;o.forEachFieldDef(e=>{if(e.aggregate)t=true});const s={};const l=new Set;if(!t)return null;o.forEachFieldDef((e,t)=>{const{aggregate:r,field:n}=e;if(r)if(r==="count"){s["*"]??={};s["*"]["count"]=new Set([j(e,{forAs:true})])}else{if(Zr(r)||Qr(r)){const a=Zr(r)?"argmin":"argmax";const i=r[a];s[i]??={};s[i][a]=new Set([j({op:a,field:i},{forAs:true})])}else{s[n]??={};s[n][r]=new Set([j(e,{forAs:true})])}if(Gr(t)&&o.scaleDomain(t)==="unaggregated"){s[n]??={};s[n]["min"]=new Set([j({field:n,aggregate:"min"},{forAs:true})]);s[n]["max"]=new Set([j({field:n,aggregate:"max"},{forAs:true})])}}else Sm(l,t,e,o)});if(l.size+A(s).length===0)return null;return new Om(e,l,s)}static makeFromTransform(e,t){const r=new Set;const n={};for(const a of t.aggregate){const{op:i,field:o,as:s}=a;if(i)if(i==="count"){n["*"]??={};n["*"]["count"]=new Set([s?s:j(a,{forAs:true})])}else{n[o]??={};n[o][i]=new Set([s?s:j(a,{forAs:true})])}}for(const l of t.groupby??[])r.add(l);if(r.size+A(n).length===0)return null;return new Om(e,r,n)}merge(e){if(ve(this.dimensions,e.dimensions)){Am(this.measures,e.measures);return true}ci("different dimensions, cannot merge");return false}addDimensions(e){e.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...A(this.measures)])}producedFields(){const e=new Set;for(const t of A(this.measures))for(const r of A(this.measures[t])){const n=this.measures[t][r];if(n.size===0)e.add(`${r}_${t}`);else n.forEach(e.add,e)}return e}hash(){return`Aggregate ${S({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const e=[];const t=[];const r=[];for(const a of A(this.measures))for(const i of A(this.measures[a]))for(const o of this.measures[a][i]){r.push(o);e.push(i);t.push(a==="*"?null:Ne(a))}const n={type:"aggregate",groupby:[...this.dimensions].map(Ne),ops:e,fields:t,as:r};return n}}class Cm extends r{constructor(e,t,r,n){super(e);this.model=t;this.name=r;this.data=n;for(const a of Lt){const i=t.facet[a];if(i){const{bin:o,sort:s}=i;this[a]={name:t.getName(`${a}_domain`),fields:[j(i),...N(o)?[j(i,{binSuffix:"end"})]:[]],...tl(s)?{sortField:s}:te.isArray(s)?{sortIndexField:rg(i,a)}:{}}}}this.childModel=t.child}hash(){let e=`Facet`;for(const t of Lt)if(this[t])e+=` ${t.charAt(0)}:${S(this[t])}`;return e}get fields(){const e=[];for(const t of Lt)if(this[t]?.fields)e.push(...this[t].fields);return e}dependentFields(){const e=new Set(this.fields);for(const t of Lt)if(this[t]){if(this[t].sortField)e.add(this[t].sortField.field);if(this[t].sortIndexField)e.add(this[t].sortIndexField)}return e}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const e={};for(const t of Er){const r=this.childModel.component.scales[t];if(r&&!r.merged){const n=r.get("type");const a=r.get("range");if(U(n)&&pn(a)){const i=R0(this.childModel,t);const o=w0(i);if(o)e[t]=o;else ae(Hn(t))}}}return e}assembleRowColumnHeaderData(e,t,r){const n={row:"y",column:"x",facet:undefined}[e];const a=[];const i=[];const o=[];if(n&&r&&r[n]){if(t){a.push(`distinct_${r[n]}`);i.push("max")}else{a.push(r[n]);i.push("distinct")}o.push(`distinct_${r[n]}`)}const{sortField:s,sortIndexField:l}=this[e];if(s){const{op:c=Zs,field:u}=s;a.push(u);i.push(c);o.push(j(s,{forAs:true}))}else if(l){a.push(l);i.push("max");o.push(l)}return{name:this[e].name,source:t??this.data,transform:[{type:"aggregate",groupby:this[e].fields,...a.length?{fields:a,ops:i,as:o}:{}}]}}assembleFacetHeaderData(e){const{columns:t}=this.model.layout;const{layoutHeaders:r}=this.model.component;const n=[];const a={};for(const s of og){for(const l of sg){const c=(r[s]&&r[s][l])??[];for(const u of c)if(u.axes?.length>0){a[s]=true;break}}if(a[s]){const d=`length(data("${this.facet.name}"))`;const f=s==="row"?t?{signal:`ceil(${d} / ${t})`}:1:t?{signal:`min(${d}, ${t})`}:{signal:d};n.push({name:`${this.facet.name}_${s}`,transform:[{type:"sequence",start:0,stop:f}]})}}const{row:i,column:o}=a;if(i||o)n.unshift(this.assembleRowColumnHeaderData("facet",null,e));return n}assemble(){const e=[];let t=null;const r=this.getChildIndependentFieldsWithStep();const{column:n,row:a,facet:i}=this;if(n&&a&&(r.x||r.y)){t=`cross_${this.column.name}_${this.row.name}`;const o=[].concat(r.x??[],r.y??[]);const s=o.map(()=>"distinct");e.push({name:t,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:o,ops:s}]})}for(const l of[ze,$e])if(this[l])e.push(this.assembleRowColumnHeaderData(l,t,r));if(i){const c=this.assembleFacetHeaderData(r);if(c)e.push(...c)}return e}}function km(e){if(e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"'))return e.slice(1,-1);return e}function wm(e,t){const r=Ie(e);if(t==="number")return`toNumber(${r})`;else if(t==="boolean")return`toBoolean(${r})`;else if(t==="string")return`toString(${r})`;else if(t==="date")return`toDate(${r})`;else if(t==="flatten")return r;else if(t.startsWith("date:")){const n=km(t.slice(5,t.length));return`timeParse(${r},'${n}')`}else if(t.startsWith("utc:")){const a=km(t.slice(4,t.length));return`utcParse(${r},'${a}')`}else{ae(na(t));return null}}function Rm(e){const r={};ce(e.filter,t=>{if(Ji(t)){let e=null;if(Gi(t))e=En(t.equal);else if(Wi(t))e=En(t.lte);else if(Vi(t))e=En(t.lt);else if(qi(t))e=En(t.gt);else if($i(t))e=En(t.gte);else if(zi(t))e=t.range[0];else if(Ki(t))e=(t.oneOf??t["in"])[0];if(e)if(ui(e))r[t.field]="date";else if(te.isNumber(e))r[t.field]="number";else if(te.isString(e))r[t.field]="string";if(t.timeUnit)r[t.field]="date"}});return r}function Im(a){const t={};function i(e){if(Ql(e))t[e.field]="date";else if(e.type==="quantitative"&&rn(e.aggregate))t[e.field]="number";else if(Le(e.field)>1){if(!(e.field in t))t[e.field]="flatten"}else if(Al(e)&&tl(e.sort)&&Le(e.sort.field)>1)if(!(e.sort.field in t))t[e.sort.field]="flatten"}if(q(a)||y_(a))a.forEachFieldDef((e,t)=>{if(v(e))i(e);else{const r=Zt(t);const n=a.fieldDef(r);i({...e,type:n.type})}});if(q(a)){const{mark:e,markDef:r,encoding:n}=a;if(as(e)&&!a.encoding.order){const o=r.orient==="horizontal"?"y":"x";const s=n[o];if(B(s)&&s.type==="quantitative"&&!(s.field in t))t[s.field]="number"}}return t}function Mm(e){const t={};if(q(e)&&e.component.selection)for(const r of A(e.component.selection)){const n=e.component.selection[r];for(const a of n.project.items)if(!a.channel&&Le(a.field)>1)t[a.field]="flatten"}return t}class Pm extends r{clone(){return new Pm(null,g(this._parse))}constructor(e,t){super(e);this._parse=t}hash(){return`Parse ${S(this._parse)}`}static makeExplicit(e,t,r){let n={};const a=t.data;if(!Mf(a)&&a?.format?.parse)n=a.format.parse;return this.makeWithAncestors(e,n,{},r)}static makeWithAncestors(e,t,r,n){for(const o of A(r)){const s=n.getWithExplicit(o);if(s.value!==undefined)if(s.explicit||s.value===r[o]||s.value==="derived"||r[o]==="flatten")delete r[o];else ae(aa(o,r[o],s.value))}for(const l of A(t)){const c=n.get(l);if(c!==undefined)if(c===t[l])delete t[l];else ae(aa(l,t[l],c))}const a=new vf(t,r);n.copyAll(a);const i={};for(const u of A(a.combine())){const d=a.get(u);if(d!==null)i[u]=d}if(A(i).length===0||n.parseNothing)return null;return new Pm(e,i)}get parse(){return this._parse}merge(e){this._parse={...this._parse,...e.parse};e.remove()}assembleFormatParse(){const e={};for(const t of A(this._parse)){const r=this._parse[t];if(Le(t)===1)e[t]=r}return e}producedFields(){return new Set(A(this._parse))}dependentFields(){return new Set(A(this._parse))}assembleTransforms(){let t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;return A(this._parse).filter(e=>t?Le(e)>1:true).map(e=>{const t=wm(e,this._parse[e]);if(!t)return null;const r={type:"formula",expr:t,as:xe(e)};return r}).filter(e=>e!==null)}}class Nm extends r{clone(){return new Nm(null)}constructor(e){super(e)}dependentFields(){return new Set}producedFields(){return new Set([gu])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:gu}}}class Dm extends r{clone(){return new Dm(null,this.params)}constructor(e,t){super(e);this.params=t}dependentFields(){return new Set}producedFields(){return undefined}hash(){return`Graticule ${S(this.params)}`}assemble(){return{type:"graticule",...this.params===true?{}:this.params}}}class xm extends r{clone(){return new xm(null,this.params)}constructor(e,t){super(e);this.params=t}dependentFields(){return new Set}producedFields(){return new Set([this.params.as??"data"])}hash(){return`Hash ${S(this.params)}`}assemble(){return{type:"sequence",...this.params}}}class Lm extends r{constructor(t){super(null);t??={name:"source"};let r;if(!Mf(t))r=t.format?{...pe(t.format,["parse"])}:{};if(Rf(t))this._data={values:t.values};else if(wf(t)){this._data={url:t.url};if(!r.type){let e=/(?:\.([^.]+))?$/.exec(t.url)[1];if(!w(["json","csv","tsv","dsv","topojson"],e))e="json";r.type=e}}else if(Nf(t))this._data={values:[{type:"Sphere"}]};else if(If(t)||Mf(t))this._data={};this._generator=Mf(t);if(t.name)this._name=t.name;if(r&&!re(r))this._data.format=r}dependentFields(){return new Set}producedFields(){return undefined}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(e){this._name=e}set parent(e){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return{name:this._name,...this._data,transform:[]}}}function Fm(e){return e instanceof Lm||e instanceof Dm||e instanceof xm}class Um{#modified;constructor(){this.#modified=false}setModified(){this.#modified=true}get modifiedFlag(){return this.#modified}}class Bm extends Um{getNodeDepths(e,t,r){r.set(e,t);for(const n of e.children)this.getNodeDepths(n,t+1,r);return r}optimize(e){const t=this.getNodeDepths(e,0,new Map);const r=[...t.entries()].sort((e,t)=>t[1]-e[1]);for(const n of r)this.run(n[0]);return this.modifiedFlag}}class jm extends Um{optimize(e){this.run(e);for(const t of e.children)this.optimize(t);return this.modifiedFlag}}class Hm extends jm{mergeNodes(e,t){const r=t.shift();for(const n of t){e.removeChild(n);n.parent=r;n.remove()}}run(t){const r=t.children.map(e=>e.hash());const n={};for(let e=0;e<r.length;e++)if(n[r[e]]===undefined)n[r[e]]=[t.children[e]];else n[r[e]].push(t.children[e]);for(const e of A(n))if(n[e].length>1){this.setModified();this.mergeNodes(t,n[e])}}}class Gm extends jm{constructor(e){super();this.requiresSelectionId=e&&bh(e)}run(e){if(e instanceof Nm)if(!(this.requiresSelectionId&&(Fm(e.parent)||e.parent instanceof Om||e.parent instanceof Pm))){this.setModified();e.remove()}}}class Vm extends Um{optimize(e){this.run(e,new Set);return this.modifiedFlag}run(e,t){let r=new Set;if(e instanceof Jf){r=e.producedFields();if(Ee(r,t)){this.setModified();e.removeFormulas(t);if(e.producedFields.length===0)e.remove()}}for(const n of e.children)this.run(n,new Set([...t,...r]))}}class Wm extends jm{constructor(){super()}run(e){if(e instanceof zf&&!e.isRequired()){this.setModified();e.remove()}}}class qm extends Bm{run(e){if(Fm(e))return;if(e.numChildren()>1)return;for(const t of e.children)if(t instanceof Pm)if(e instanceof Pm){this.setModified();e.merge(t)}else{if(Ae(e.producedFields(),t.dependentFields()))continue;this.setModified();t.swapWithParent()}return}}class $m extends Bm{run(e){const t=[...e.children];const r=e.children.filter(e=>e instanceof Pm);if(e.numChildren()>1&&r.length>=1){const n={};const a=new Set;for(const i of r){const o=i.parse;for(const s of A(o))if(!(s in n))n[s]=o[s];else if(n[s]!==o[s])a.add(s)}for(const l of a)delete n[l];if(!re(n)){this.setModified();const c=new Pm(e,n);for(const u of t){if(u instanceof Pm)for(const d of A(n))delete u.parse[d];e.removeChild(u);u.parent=c;if(u instanceof Pm&&A(u.parse).length===0)u.remove()}}}}}class zm extends Bm{run(e){if(e instanceof zf||e.numChildren()>0||e instanceof Cm);else if(e instanceof Lm);else{this.setModified();e.remove()}}}class Km extends Bm{run(e){const t=e.children.filter(e=>e instanceof Jf);const r=t.pop();for(const n of t){this.setModified();r.merge(n)}}}class Ym extends Bm{run(e){const t=e.children.filter(e=>e instanceof Om);const r={};for(const n of t){const a=S(n.groupBy);if(!(a in r))r[a]=[];r[a].push(n)}for(const i of A(r)){const o=r[i];if(o.length>1){const s=o.pop();for(const l of o)if(s.merge(l)){e.removeChild(l);l.parent=s;l.remove();this.setModified()}}}}}class Jm extends Bm{constructor(e){super();this.model=e}run(e){const t=!(Fm(e)||e instanceof Oh||e instanceof Pm||e instanceof Nm);const r=[];const n=[];for(const a of e.children)if(a instanceof Em)if(t&&!Ae(e.producedFields(),a.dependentFields()))r.push(a);else n.push(a);if(r.length>0){const i=r.pop();for(const o of r)i.merge(o,this.model.renameSignal.bind(this.model));this.setModified();if(e instanceof Em)e.merge(i,this.model.renameSignal.bind(this.model));else i.swapWithParent()}if(n.length>1){const s=n.pop();for(const l of n)s.merge(l,this.model.renameSignal.bind(this.model));this.setModified()}}}class Zm extends Bm{run(t){const e=[...t.children];const r=ge(e,e=>e instanceof zf);if(!r||t.numChildren()<=1)return;const n=[];let a;for(const i of e)if(i instanceof zf){let e=i;while(e.numChildren()===1){const[o]=e.children;if(o instanceof zf)e=o;else break}n.push(...e.children);if(a){t.removeChild(i);i.parent=a.parent;a.parent.removeChild(a);a.parent=e;this.setModified()}else a=e}else n.push(i);if(n.length){this.setModified();for(const s of n){s.parent.removeChild(s);s.parent=a}}}}class Qm extends r{clone(){return new Qm(null,g(this.transform))}constructor(e,t){super(e);this.transform=t}addDimensions(e){this.transform.groupby=Te(this.transform.groupby.concat(e),e=>e)}dependentFields(){const e=new Set;if(this.transform.groupby)this.transform.groupby.forEach(e.add,e);this.transform.joinaggregate.map(e=>e.field).filter(e=>e!==undefined).forEach(e.add,e);return e}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(e){return e.as??j(e)}hash(){return`JoinAggregateTransform ${S(this.transform)}`}assemble(){const e=[];const t=[];const r=[];for(const a of this.transform.joinaggregate){t.push(a.op);r.push(this.getDefaultName(a));e.push(a.field===undefined?null:a.field)}const n=this.transform.groupby;return{type:"joinaggregate",as:r,ops:t,fields:e,...n!==undefined?{groupby:n}:{}}}}class Xm extends r{clone(){return new Xm(null,{...this.filter})}constructor(e,t){super(e);this.filter=t}static make(e,s,t){const{config:l,markDef:c}=s;const{marks:r,scales:n}=t;if(r==="include-invalid-values"&&n==="include-invalid-values")return null;const a=s.reduceFieldDef((e,t,r)=>{const n=Gr(r)&&s.getScaleComponent(r);if(n){const a=n.get("type");const{aggregate:i}=t;const o=Os({scaleChannel:r,markDef:c,config:l,scaleType:a,isCountAggregate:tn(i)});if(o!=="show"&&o!=="always-valid")e[t.field]=t}return e},{});if(!A(a).length)return null;return new Xm(e,a)}dependentFields(){return new Set(A(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${S(this.filter)}`}assemble(){const e=A(this.filter).reduce((e,t)=>{const r=this.filter[t];const n=j(r,{expr:"datum"});if(r!==null)if(r.type==="temporal")e.push(`(isDate(${n}) || (${e0(n)}))`);else if(r.type==="quantitative")e.push(e0(n));else;return e},[]);return e.length>0?{type:"filter",expr:e.join(" && ")}:null}}function e0(e){return`isValid(${e}) && isFinite(+${e})`}function t0(e){return e.stack.stackBy.reduce((e,t)=>{const r=t.fieldDef;const n=j(r);if(n)e.push(n);return e},[])}function r0(e){return te.isArray(e)&&e.every(e=>te.isString(e))&&e.length>1}class n0 extends r{clone(){return new n0(null,g(this._stack))}constructor(e,t){super(e);this._stack=t}static makeFromTransform(e,t){const{stack:r,groupby:n,as:a,offset:i="zero"}=t;const o=[];const s=[];if(t.sort!==undefined)for(const u of t.sort){o.push(u.field);s.push(R(u.order,"ascending"))}const l={field:o,order:s};let c;if(r0(a))c=a;else if(te.isString(a))c=[a,`${a}_end`];else c=[`${t.stack}_start`,`${t.stack}_end`];return new n0(e,{dimensionFieldDefs:[],stackField:r,groupby:n,offset:i,sort:l,facetby:[],as:c})}static makeFromEncoding(e,t){const r=t.stack;const{encoding:n}=t;if(!r)return null;const{groupbyChannels:a,fieldChannel:i,offset:o,impute:s}=r;const l=a.map(e=>{const t=n[e];return Wl(t)}).filter(e=>!!e);const c=t0(t);const u=t.encoding.order;let d;if(te.isArray(u)||B(u))d=Pn(u);else{const f=pl(u)?u.sort:i==="y"?"descending":"ascending";d=c.reduce((e,t)=>{if(!e.field.includes(t)){e.field.push(t);e.order.push(f)}return e},{field:[],order:[]})}return new n0(e,{dimensionFieldDefs:l,stackField:t.vgField(i),facetby:[],stackby:c,sort:d,offset:o,impute:s,as:[t.vgField(i,{suffix:"start",forAs:true}),t.vgField(i,{suffix:"end",forAs:true})]})}get stack(){return this._stack}addDimensions(e){this._stack.facetby.push(...e)}dependentFields(){const e=new Set;e.add(this._stack.stackField);this.getGroupbyFields().forEach(e.add,e);this._stack.facetby.forEach(e.add,e);this._stack.sort.field.forEach(e.add,e);return e}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${S(this._stack)}`}getGroupbyFields(){const{dimensionFieldDefs:e,impute:t,groupby:r}=this._stack;if(e.length>0)return e.map(e=>{if(e.bin){if(t)return[j(e,{binSuffix:"mid"})];return[j(e,{}),j(e,{binSuffix:"end"})]}return[j(e)]}).flat();return r??[]}assemble(){const e=[];const{facetby:t,dimensionFieldDefs:r,stackField:n,stackby:a,sort:i,offset:o,impute:s,as:l}=this._stack;if(s)for(const c of r){const{bandPosition:u=.5,bin:d}=c;if(d){const f=j(c,{expr:"datum"});const p=j(c,{expr:"datum",binSuffix:"end"});e.push({type:"formula",expr:`${e0(f)} ? ${u}*${f}+${1-u}*${p} : ${f}`,as:j(c,{binSuffix:"mid",forAs:true})})}e.push({type:"impute",field:n,groupby:[...a,...t],key:j(c,{binSuffix:"mid"}),method:"value",value:0})}e.push({type:"stack",groupby:[...this.getGroupbyFields(),...t],field:n,sort:i,as:l,offset:o});return e}}class a0 extends r{clone(){return new a0(null,g(this.transform))}constructor(e,t){super(e);this.transform=t}addDimensions(e){this.transform.groupby=Te(this.transform.groupby.concat(e),e=>e)}dependentFields(){const t=new Set;(this.transform.groupby??[]).forEach(t.add,t);(this.transform.sort??[]).forEach(e=>t.add(e.field));this.transform.window.map(e=>e.field).filter(e=>e!==undefined).forEach(t.add,t);return t}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(e){return e.as??j(e)}hash(){return`WindowTransform ${S(this.transform)}`}assemble(){const e=[];const t=[];const r=[];const n=[];for(const u of this.transform.window){t.push(u.op);r.push(this.getDefaultName(u));n.push(u.param===undefined?null:u.param);e.push(u.field===undefined?null:u.field)}const a=this.transform.frame;const i=this.transform.groupby;if(a&&a[0]===null&&a[1]===null&&t.every(e=>Xr(e)))return{type:"joinaggregate",as:r,ops:t,fields:e,...i!==undefined?{groupby:i}:{}};const o=[];const s=[];if(this.transform.sort!==undefined)for(const d of this.transform.sort){o.push(d.field);s.push(d.order??"ascending")}const l={field:o,order:s};const c=this.transform.ignorePeers;return{type:"window",params:n,as:r,ops:t,fields:e,sort:l,...c!==undefined?{ignorePeers:c}:{},...i!==undefined?{groupby:i}:{},...a!==undefined?{frame:a}:{}}}}function i0(a){function i(e){if(!(e instanceof Cm)){const t=e.clone();if(t instanceof zf){const r=l0+t.getSource();t.setSource(r);a.model.component.data.outputNodes[r]=t}else if(t instanceof Om||t instanceof n0||t instanceof a0||t instanceof Qm)t.addDimensions(a.fields);for(const n of e.children.flatMap(i))n.parent=t;return[t]}return e.children.flatMap(i)}return i}function o0(e){if(e instanceof Cm)if(e.numChildren()===1&&!(e.children[0]instanceof zf)){const t=e.children[0];if(t instanceof Om||t instanceof n0||t instanceof a0||t instanceof Qm)t.addDimensions(e.fields);t.swapWithParent();o0(e)}else{const r=e.model.component.data.main;s0(r);const n=i0(e);const a=e.children.map(n).flat();for(const i of a)i.parent=r}else e.children.map(o0)}function s0(e){if(e instanceof zf&&e.type===G.Main)if(e.numChildren()===1){const t=e.children[0];if(!(t instanceof Cm)){t.swapWithParent();s0(e)}}}const l0="scale_",c0=5;function u0(e){for(const t of e){for(const r of t.children)if(r.parent!==t)return false;if(!u0(t.children))return false}return true}function d0(e,t){let r=false;for(const n of t)r=e.optimize(n)||r;return r}function f0(e,t,r){let n=e.sources;let a=false;a=d0(new Wm,n)||a;a=d0(new Gm(t),n)||a;n=n.filter(e=>e.numChildren()>0);a=d0(new zm,n)||a;n=n.filter(e=>e.numChildren()>0);if(!r){a=d0(new qm,n)||a;a=d0(new Jm(t),n)||a;a=d0(new Vm,n)||a;a=d0(new $m,n)||a;a=d0(new Ym,n)||a;a=d0(new Km,n)||a;a=d0(new Hm,n)||a;a=d0(new Zm,n)||a}e.sources=n;return a}function p0(t,r){u0(t.sources);let n=0;let a=0;for(let e=0;e<c0;e++){if(!f0(t,r,true))break;n++}t.sources.map(o0);for(let e=0;e<c0;e++){if(!f0(t,r,false))break;a++}u0(t.sources);if(Math.max(n,a)===c0)ae(`Maximum optimization runs(${c0}) reached.`)}class W{constructor(e){Object.defineProperty(this,"signal",{enumerable:true,get:e})}static fromName(e,t){return new W(()=>e(t))}}function h0(e){if(q(e))g0(e);else m0(e)}function g0(t){const e=t.component.scales;for(const r of A(e)){const n=y0(t,r);const a=e[r];a.setWithExplicit("domains",n);S0(t,r);if(t.component.data.isFaceted){let e=t;while(!y_(e)&&e.parent)e=e.parent;const i=e.component.resolve.scale[r];if(i==="shared")for(const o of n.value)if(mn(o))o.data=l0+o.data.replace(l0,"")}}}function m0(r){for(const e of r.children)h0(e);const n=r.component.scales;for(const a of A(n)){let e;let t=null;for(const i of r.children){const o=i.component.scales[a];if(o){if(e===undefined)e=o.getWithExplicit("domains");else e=Cf(e,o.getWithExplicit("domains"),"domains","scale",C0);const s=o.get("selectionExtent");if(t&&s&&t.param!==s.param)ae(Qn);t=s}}n[a].setWithExplicit("domains",e);if(t)n[a].set("selectionExtent",t,true)}}function _0(e,t,r,n){if(e==="unaggregated"){const{valid:a,reason:i}=O0(t,r);if(!a){ae(i);return undefined}}else if(e===undefined&&n.useUnaggregatedDomain){const{valid:o}=O0(t,r);if(o)return"unaggregated"}return e}function y0(e,t){const r=e.getScaleComponent(t).get("type");const{encoding:n}=e;const a=_0(e.scaleDomain(t),e.typedFieldDef(t),r,e.config.scale);if(a!==e.scaleDomain(t))e.specifiedScales[t]={...e.specifiedScales[t],domain:a};if(t==="x"&&H(n.x2))if(H(n.x))return Cf(v0(r,a,e,"x"),v0(r,a,e,"x2"),"domain","scale",C0);else return v0(r,a,e,"x2");else if(t==="y"&&H(n.y2))if(H(n.y))return Cf(v0(r,a,e,"y"),v0(r,a,e,"y2"),"domain","scale",C0);else return v0(r,a,e,"y2");return v0(r,a,e,t)}function T0(e,r,n){return e.map(e=>{const t=ec(e,{timeUnit:n,type:r});return{signal:`{data: ${t}}`}})}function b0(e,t,r){const n=F(r)?.unit;if(t==="temporal"||n)return T0(e,t,n);return[e]}function v0(e,t,r,n){const{encoding:a,markDef:i,mark:o,config:s,stack:l}=r;const c=H(a[n]);const{type:u}=c;const d=c["timeUnit"];const f=Lf({invalid:Rn("invalid",i,s),isPath:as(o)});if(wo(t)){const g=v0(e,undefined,r,n);const m=b0(t.unionWith,u,d);return Ef([...m,...g.value])}else if(x(t))return Ef([t]);else if(t&&t!=="unaggregated"&&!ko(t))return Ef(b0(t,u,d));if(l&&n===l.fieldChannel){if(l.offset==="normalize")return Sf([[0,1]]);const _=r.requestDataName(f);return Sf([{data:_,field:r.vgField(n,{suffix:"start"})},{data:_,field:r.vgField(n,{suffix:"end"})}])}const p=Gr(n)&&B(c)?A0(r,n,e):undefined;if(Tl(c)){const y=b0([c.datum],u,d);return Sf(y)}const h=c;if(t==="unaggregated"){const{field:T}=c;return Sf([{data:r.requestDataName(f),field:j({field:T,aggregate:"min"})},{data:r.requestDataName(f),field:j({field:T,aggregate:"max"})}])}else if(N(h.bin))if(U(e)){if(e==="bin-ordinal")return Sf([]);return Sf([{data:Ce(p)?r.requestDataName(f):r.requestDataName(G.Raw),field:r.vgField(n,rc(h,n)?{binSuffix:"range"}:{}),sort:p===true||!te.isObject(p)?{field:r.vgField(n,{}),op:"min"}:p}])}else{const{bin:b}=h;if(N(b)){const v=Tm(r,h.field,b);return Sf([new W(()=>{const e=r.getSignalName(v);return`[${e}.start, ${e}.stop]`})])}else return Sf([{data:r.requestDataName(f),field:r.vgField(n,{})}])}else if(h.timeUnit&&w(["time","utc"],e)){const E=a[Xt(n)];if(fl(h,E,i,s)){const S=r.requestDataName(f);const A=ul({fieldDef:h,fieldDef2:E,markDef:i,config:s});const O=is(o)&&A!==.5&&P(n);return Sf([{data:S,field:r.vgField(n,O?{suffix:Zf}:{})},{data:S,field:r.vgField(n,{suffix:O?Qf:"end"})}])}}if(p)return Sf([{data:Ce(p)?r.requestDataName(f):r.requestDataName(G.Raw),field:r.vgField(n),sort:p}]);else return Sf([{data:r.requestDataName(f),field:r.vgField(n)}])}function E0(e,t){const{op:r,field:n,order:a}=e;return{op:r??(t?"sum":Zs),...n?{field:Ne(n)}:{},...a?{order:a}:{}}}function S0(e,t){const r=e.component.scales[t];const n=e.specifiedScales[t].domain;const a=e.fieldDef(t)?.bin;const i=ko(n)&&n;const o=sn(a)&&ln(a.extent)&&a.extent;if(i||o)r.set("selectionExtent",i??o,true)}function A0(e,t,r){if(!U(r))return undefined;const n=e.fieldDef(t);const a=n.sort;if(rl(a))return{op:"min",field:rg(n,t),order:"ascending"};const{stack:i}=e;const o=i?new Set([...i.groupbyFields,...i.stackBy.map(e=>e.fieldDef.field)]):undefined;if(tl(a)){const s=i&&!o.has(a.field);return E0(a,s)}else if(el(a)){const{encoding:l,order:c}=a;const u=e.fieldDef(l);const{aggregate:d,field:f}=u;const p=i&&!o.has(f);if(Zr(d)||Qr(d))return E0({field:j(u),order:c},p);else if(Xr(d)||!d)return E0({op:d,field:f,order:c},p)}else if(a==="descending")return{op:"min",field:e.vgField(t),order:"descending"};else if(w(["ascending",undefined],a))return true;return undefined}function O0(e,t){const{aggregate:r,type:n}=e;if(!r)return{valid:false,reason:Ma(e)};if(te.isString(r)&&!an.has(r))return{valid:false,reason:Pa(r)};if(n==="quantitative")if(t==="log")return{valid:false,reason:Na(e)};return{valid:true}}function C0(e,t,r,n){if(e.explicit&&t.explicit)ae(ja(r,n,e.value,t.value));return{explicit:e.explicit,value:[...e.value,...t.value]}}function k0(e){const t=Te(e.map(e=>{if(mn(e)){const{sort:t,...r}=e;return r}return e}),S);const r=Te(e.map(e=>{if(mn(e)){const t=e.sort;if(t!==undefined&&!Ce(t)){if("op"in t&&t.op==="count")delete t.field;if(t.order==="ascending")delete t.order}return t}return undefined}).filter(e=>e!==undefined),S);if(t.length===0)return undefined;else if(t.length===1){const o=e[0];if(mn(o)&&r.length>0){let e=r[0];if(r.length>1){ae(Va);const s=r.filter(e=>te.isObject(e)&&"op"in e&&e.op!=="min");if(r.every(e=>te.isObject(e)&&"op"in e)&&s.length===1)e=s[0];else e=true}else if(te.isObject(e)&&"field"in e){const l=e.field;if(o.field===l)e=e.order?{order:e.order}:true}return{...o,sort:e}}return o}const n=Te(r.map(e=>{if(Ce(e)||!("op"in e)||te.isString(e.op)&&e.op in Jr)return e;ae(Ga(e));return true}),S);let a;if(n.length===1)a=n[0];else if(n.length>1){ae(Va);a=true}const i=Te(e.map(e=>{if(mn(e))return e.data;return null}),e=>e);if(i.length===1&&i[0]!==null){const c={data:i[0],fields:t.map(e=>e.field),...a?{sort:a}:{}};return c}return{fields:t,...a?{sort:a}:{}}}function w0(t){if(mn(t)&&te.isString(t.field))return t.field;else if(hn(t)){let e;for(const r of t.fields)if(mn(r)&&te.isString(r.field))if(!e)e=r.field;else if(e!==r.field){ae(Wa);return e}ae(qa);return e}else if(gn(t)){ae($a);const e=t.fields[0];return te.isString(e)?e:undefined}return undefined}function R0(t,e){const r=t.component.scales[e];const n=r.get("domains").map(e=>{if(mn(e))e.data=t.lookupDataSource(e.data);return e});return k0(n)}function I0(e){if(b_(e)||T_(e))return e.children.reduce((e,t)=>{return e.concat(I0(t))},M0(e));else return M0(e)}function M0(h){return A(h.component.scales).reduce((e,t)=>{const r=h.component.scales[t];if(r.merged)return e;const n=r.combine();const{name:a,type:i,selectionExtent:o,domains:s,range:l,reverse:c,...u}=n;const d=P0(n.range,a,t,h);const f=R0(h,t);const p=o?qf(h,o,r,f):null;e.push({name:a,type:i,...f?{domain:f}:{},...p?{domainRaw:p}:{},range:d,...c!==undefined?{reverse:c}:{},...u});return e},[])}function P0(e,t,r,n){if(P(r)){if(pn(e))return{step:{signal:`${t}_step`}}}else if(te.isObject(e)&&mn(e))return{...e,data:n.lookupDataSource(e.data)};return e}class N0 extends vf{merged=false;constructor(e,t){super({},{name:e});this.setWithExplicit("type",t)}domainHasZero(){const e=this.get("type");if(w([y.LOG,y.TIME,y.UTC],e))return"definitely-not";const t=this.get("zero");if(t===true||t===undefined&&w([y.LINEAR,y.SQRT,y.POW],e))return"definitely";const n=this.get("domains");if(n.length>0){let e=false;let t=false;let r=false;for(const a of n){if(te.isArray(a)){const i=a[0];const o=a[a.length-1];if(te.isNumber(i)&&te.isNumber(o))if(i<=0&&o>=0){e=true;continue}else{t=true;continue}}r=true}if(e)return"definitely";else if(t&&!r)return"definitely-not"}return"maybe"}}const D0=["range","scheme"];function x0(e){const t=e.component.scales;for(const r of Hr){const n=t[r];if(!n)continue;const a=F0(r,e);n.setWithExplicit("range",a)}}function L0(r,n){const e=r.fieldDef(n);if(e?.bin){const{bin:a,field:t}=e;const i=er(n);const o=r.getName(i);if(te.isObject(a)&&a.binned&&a.step!==undefined)return new W(()=>{const e=r.scaleName(n);const t=`(domain("${e}")[1] - domain("${e}")[0]) / ${a.step}`;return`${r.getSignalName(o)} / (${t})`});else if(N(a)){const s=Tm(r,t,a);return new W(()=>{const e=r.getSignalName(s);const t=`(${e}.stop - ${e}.start) / ${e}.step`;return`${r.getSignalName(o)} / (${t})`})}}return undefined}function F0(e,n){const t=n.specifiedScales[e];const{size:r}=n;const a=n.getScaleComponent(e);const i=a.get("type");for(const d of D0)if(t[d]!==undefined){const f=Bo(i,d);const p=jo(e,d);if(!f)ae(Fa(i,d,e));else if(p)ae(p);else switch(d){case"range":{const h=t.range;if(te.isArray(h)){if(P(e))return Ef(h.map(e=>{if(e==="width"||e==="height"){const t=n.getName(e);const r=n.getSignalName.bind(n);return W.fromName(r,t)}return e}))}else if(te.isObject(h))return Ef({data:n.requestDataName(G.Main),field:h.field,sort:{op:"min",field:n.vgField(e)}});return Ef(h)}case"scheme":return Ef(U0(t[d]))}}const o=e===I||e==="xOffset"?"width":"height";const s=r[o];if(Cu(s))if(P(e))if(U(i)){const g=H0(s,n,e);if(g)return Ef({step:g})}else ae(Ua(o));else if(kr(e)){const m=e===Ze?"x":"y";const _=n.getScaleComponent(m);const y=_.get("type");if(y==="band"){const T=G0(s,i);if(T)return Ef(T)}}const{rangeMin:l,rangeMax:c}=t;const u=j0(e,n);if((l!==undefined||c!==undefined)&&Bo(i,"rangeMin")&&te.isArray(u)&&u.length===2)return Ef([l??u[0],c??u[1]]);return Sf(u)}function U0(e){if(Co(e))return{scheme:e.name,...pe(e,["name"])};return{scheme:e}}function B0(e,t,r){let{center:n}=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};const a=er(e);const i=t.getName(a);const o=t.getSignalName.bind(t);if(e===M&&Eo(r))return n?[W.fromName(e=>`${o(e)}/2`,i),W.fromName(e=>`-${o(e)}/2`,i)]:[W.fromName(o,i),0];else return n?[W.fromName(e=>`-${o(e)}/2`,i),W.fromName(e=>`${o(e)}/2`,i)]:[0,W.fromName(o,i)]}function j0(e,r){const{size:t,config:n,mark:a,encoding:i}=r;const{type:o}=H(i[e]);const s=r.getScaleComponent(e);const l=s.get("type");const{domain:c,domainMid:u}=r.specifiedScales[e];switch(e){case I:case M:{if(w(["point","band"],l)){const d=W0(e,t,n.view);if(Cu(d)){const f=H0(d,r,e);return{step:f}}}return B0(e,r,l)}case Ze:case Qe:return V0(e,r,l);case dt:{const p=z0(a,n);const h=Y0(a,t,r,n);if(Ao(l))return $0(p,h,q0(l,n,c,e));else return[p,h]}case tt:return[0,Math.PI*2];case ft:return[0,360];case Xe:return[0,new W(()=>{const e=r.getSignalName(y_(r.parent)?"child_width":"width");const t=r.getSignalName(y_(r.parent)?"child_height":"height");return`min(${e},${t})/2`})];case mt:return[n.scale.minStrokeWidth,n.scale.maxStrokeWidth];case _t:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case ut:return"symbol";case st:case lt:case ct:if(l==="ordinal")return o==="nominal"?"category":"ordinal";else if(u!==undefined)return"diverging";else return a==="rect"||a==="geoshape"?"heatmap":"ramp";case pt:case ht:case gt:return[n.scale.minOpacity,n.scale.maxOpacity]}}function H0(t,r,e){const{encoding:n}=r;const a=r.getScaleComponent(e);const i=rr(e);const o=n[i];const s=Ou({step:t,offsetIsDiscrete:T(o)&&ao(o.type)});if(s==="offset"&&gc(n,i)){const l=r.getScaleComponent(i);const c=r.scaleName(i);let e=`domain('${c}').length`;if(l.get("type")==="band"){const d=l.get("paddingInner")??l.get("padding")??0;const f=l.get("paddingOuter")??l.get("padding")??0;e=`bandspace(${e}, ${d}, ${f})`}const u=a.get("paddingInner")??a.get("padding");return{signal:`${t.step} * ${e} / (1-${An(u)})`}}else return t.step}function G0(e,t){const r=Ou({step:e,offsetIsDiscrete:U(t)});if(r==="offset")return{step:e.step};return undefined}function V0(e,t,r){const n=e===Ze?"x":"y";const a=t.getScaleComponent(n);if(!a)return B0(n,t,r,{center:true});const i=a.get("type");const o=t.scaleName(n);const{markDef:s,config:l}=t;if(i==="band"){const c=W0(n,t.size,t.config.view);if(Cu(c)){const u=G0(c,r);if(u)return u}return[0,{signal:`bandwidth('${o}')`}]}else{const d=t.encoding[n];if(B(d)&&d.timeUnit){const f=Fi(d.timeUnit,e=>`scale('${o}', ${e})`);const p=t.config.scale.bandWithNestedOffsetPaddingInner;const h=ul({fieldDef:d,markDef:s,config:l})-.5;const g=h!==0?` + ${h}`:"";if(p){const m=x(p)?`${p.signal}/2`+g:`${p/2+h}`;const _=x(p)?`(1 - ${p.signal}/2)`+g:`${1-p/2+h}`;return[{signal:`${m} * (${f})`},{signal:`${_} * (${f})`}]}return[0,{signal:f}]}return de(`Cannot use ${e} scale if ${n} scale is not discrete.`)}}function W0(e,t,r){const n=e===I?"width":"height";const a=t[n];if(a)return a;return Du(r,n)}function q0(e,t,r,n){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":if(r!==undefined&&te.isArray(r))return r.length+1;else{ae(ai(n));return 3}}}function $0(n,a,i){const e=()=>{const e=Cn(a);const t=Cn(n);const r=`(${e} - ${t}) / (${i} - 1)`;return`sequence(${t}, ${e} + ${r}, ${r})`};if(x(a))return new W(e);else return{signal:e()}}function z0(e,t){switch(e){case"bar":case"tick":return t.scale.minBandSize;case"line":case"trail":case"rule":return t.scale.minStrokeWidth;case"text":return t.scale.minFontSize;case"point":case"square":case"circle":return t.scale.minSize}throw new Error(ba("size",e))}const K0=.95;function Y0(e,t,r,n){const a={x:L0(r,"x"),y:L0(r,"y")};switch(e){case"bar":case"tick":{if(n.scale.maxBandSize!==undefined)return n.scale.maxBandSize;const i=J0(t,a,n.view);if(te.isNumber(i))return i-1;else return new W(()=>`${i.signal} - 1`)}case"line":case"trail":case"rule":return n.scale.maxStrokeWidth;case"text":return n.scale.maxFontSize;case"point":case"square":case"circle":{if(n.scale.maxSize)return n.scale.maxSize;const o=J0(t,a,n.view);if(te.isNumber(o))return Math.pow(K0*o,2);else return new W(()=>`pow(${K0} * ${o.signal}, 2)`)}}throw new Error(ba("size",e))}function J0(e,t,r){const n=Cu(e.width)?e.width.step:Nu(r,"width");const a=Cu(e.height)?e.height.step:Nu(r,"height");if(t.x||t.y)return new W(()=>{const e=[t.x?t.x.signal:n,t.y?t.y.signal:a];return`min(${e.join(", ")})`});return Math.min(n,a)}function Z0(e,t){if(q(e))Q0(e,t);else t_(e,t)}function Q0(e,t){const r=e.component.scales;const{config:n,encoding:a,markDef:i,specifiedScales:o}=e;for(const s of A(r)){const l=o[s];const c=r[s];const u=e.getScaleComponent(s);const d=H(a[s]);const f=l[t];const p=u.get("type");const h=u.get("padding");const g=u.get("paddingInner");const m=Bo(p,t);const _=jo(s,t);if(f!==undefined)if(!m)ae(Fa(p,t,s));else if(_)ae(_);if(m&&_===undefined)if(f!==undefined){const y=d["timeUnit"];const T=d.type;switch(t){case"domainMax":case"domainMin":if(ui(l[t])||T==="temporal"||y)c.set(t,{signal:ec(l[t],{type:T,timeUnit:y})},true);else c.set(t,l[t],true);break;default:c.copyKeyFromObject(t,l)}}else{const b=t in X0?X0[t]({model:e,channel:s,fieldOrDatumDef:d,scaleType:p,scalePadding:h,scalePaddingInner:g,domain:l.domain,domainMin:l.domainMin,domainMax:l.domainMax,markDef:i,config:n,hasNestedOffsetScale:mc(a,s),hasSecondaryRangeChannel:!!a[Xt(s)]}):n.scale[t];if(b!==undefined)c.set(t,b,false)}}}const X0={bins:e=>{let{model:t,fieldOrDatumDef:r}=e;return B(r)?r_(t,r):undefined},interpolate:e=>{let{channel:t,fieldOrDatumDef:r}=e;return n_(t,r.type)},nice:e=>{let{scaleType:t,channel:r,domain:n,domainMin:a,domainMax:i,fieldOrDatumDef:o}=e;return a_(t,r,n,a,i,o)},padding:e=>{let{channel:t,scaleType:r,fieldOrDatumDef:n,markDef:a,config:i}=e;return i_(t,r,i.scale,n,a,i.bar)},paddingInner:e=>{let{scalePadding:t,channel:r,markDef:n,scaleType:a,config:i,hasNestedOffsetScale:o}=e;return o_(t,r,n.type,a,i.scale,o)},paddingOuter:e=>{let{scalePadding:t,channel:r,scaleType:n,scalePaddingInner:a,config:i,hasNestedOffsetScale:o}=e;return s_(t,r,n,a,i.scale,o)},reverse:e=>{let{fieldOrDatumDef:t,scaleType:r,channel:n,config:a}=e;const i=B(t)?t.sort:undefined;return l_(r,i,n,a.scale)},zero:e=>{let{channel:t,fieldOrDatumDef:r,domain:n,markDef:a,scaleType:i,config:o,hasSecondaryRangeChannel:s}=e;return c_(t,r,n,a,i,o.scale,s)}};function e_(e){if(q(e))x0(e);else t_(e,"range")}function t_(t,r){const n=t.component.scales;for(const e of t.children)if(r==="range")e_(e);else Z0(e,r);for(const a of A(n)){let e;for(const i of t.children){const o=i.component.scales[a];if(o){const s=o.getWithExplicit(r);e=Cf(e,s,r,"scale",Af((e,t)=>{switch(r){case"range":if(e.step&&t.step)return e.step-t.step;return 0}return 0}))}}n[a].setWithExplicit(r,e)}}function r_(e,t){const r=t.bin;if(N(r)){const n=Tm(e,t.field,r);return new W(()=>{return e.getSignalName(n)})}else if(D(r)&&sn(r)&&r.step!==undefined)return{step:r.step};return undefined}function n_(e,t){if(w([st,lt,ct],e)&&t!=="nominal")return"hcl";return undefined}function a_(e,t,r,n,a,i){if(Wl(i)?.bin||te.isArray(r)||a!=null||n!=null||w([y.TIME,y.UTC],e))return undefined;return P(t)?true:undefined}function i_(e,t,r,n,a,i){if(P(e)){if(So(t)){if(r.continuousPadding!==undefined)return r.continuousPadding;const{type:o,orient:s}=a;if(o==="bar"&&!(B(n)&&(n.bin||n.timeUnit)))if(s==="vertical"&&e==="x"||s==="horizontal"&&e==="y")return i.continuousBandSize}if(t===y.POINT)return r.pointPadding}return undefined}function o_(e,t,r,n,a){let i=arguments.length>5&&arguments[5]!==undefined?arguments[5]:false;if(e!==undefined)return undefined;if(P(t)){const{bandPaddingInner:o,barBandPaddingInner:s,rectBandPaddingInner:l,bandWithNestedOffsetPaddingInner:c}=a;if(i)return c;return R(o,r==="bar"?s:l)}else if(kr(t))if(n===y.BAND)return a.offsetBandPaddingInner;return undefined}function s_(e,t,r,n,a){let i=arguments.length>5&&arguments[5]!==undefined?arguments[5]:false;if(e!==undefined)return undefined;if(P(t)){const{bandPaddingOuter:o,bandWithNestedOffsetPaddingOuter:s}=a;if(i)return s;if(r===y.BAND)return R(o,x(n)?{signal:`${n.signal}/2`}:n/2)}else if(kr(t))if(r===y.POINT)return.5;else if(r===y.BAND)return a.offsetBandPaddingOuter;return undefined}function l_(e,t,r,n){if(r==="x"&&n.xReverse!==undefined){if(Eo(e)&&t==="descending")if(x(n.xReverse))return{signal:`!${n.xReverse.signal}`};else return!n.xReverse;return n.xReverse}if(Eo(e)&&t==="descending")return true;return undefined}function c_(e,t,r,n,a,i,o){const s=!!r&&r!=="unaggregated";if(s)if(Eo(a)){if(te.isArray(r)){const l=r[0];const c=r[r.length-1];if(te.isNumber(l)&&l<=0&&te.isNumber(c)&&c>=0)return true}return false}if(e==="size"&&t.type==="quantitative"&&!Ao(a))return true;if(!(B(t)&&t.bin)&&w([...Er,...Ar],e)){const{orient:u,type:d}=n;if(w(["bar","area","line","trail"],d))if(u==="horizontal"&&e==="y"||u==="vertical"&&e==="x")return false;if(w(["bar","area"],d)&&!o)return true;return i?.zero}return false}function u_(e,t,r,n){let a=arguments.length>4&&arguments[4]!==undefined?arguments[4]:false;const i=d_(t,r,n,a);const{type:o}=e;if(!Gr(t))return null;if(o!==undefined){if(!Go(t,o)){ae(xa(t,o,i));return i}if(B(r)&&!Ho(o,r.type)){ae(La(o,i));return i}return o}return i}function d_(e,t,r,n){switch(t.type){case"nominal":case"ordinal":{if(Dt(e)||Kr(e)==="discrete"){if(e==="shape"&&t.type==="ordinal")ae(Oa(e,"ordinal"));return"ordinal"}if(P(e)||kr(e)){if(w(["rect","bar","image","rule"],r.type))return"band";if(n)return"band"}else if(r.type==="arc"&&e in Sr)return"band";const a=r[er(e)];if(_s(a))return"band";if(Ol(t)&&t.axis?.tickBand)return"band";return"point"}case"temporal":if(Dt(e))return"time";else if(Kr(e)==="discrete"){ae(Oa(e,"temporal"));return"ordinal"}else if(B(t)&&t.timeUnit&&F(t.timeUnit).utc)return"utc";return"time";case"quantitative":if(Dt(e)){if(B(t)&&N(t.bin))return"bin-ordinal";return"linear"}else if(Kr(e)==="discrete"){ae(Oa(e,"quantitative"));return"ordinal"}return"linear";case"geojson":return undefined}throw new Error(pa(t.type))}function f_(e){let{ignoreRange:t}=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};p_(e);h0(e);for(const r of Uo)Z0(e,r);if(!t)e_(e)}function p_(e){if(q(e))e.component.scales=h_(e);else e.component.scales=m_(e)}function h_(t){const{encoding:r,mark:n,markDef:a}=t;const i={};for(const o of Hr){const s=H(r[o]);if(s&&n===ns&&o===ut&&s.type===co)continue;let e=s&&s["scale"];if(s&&e!==null&&e!==false){e??={};const l=mc(r,o);const c=u_(e,o,s,a,l);i[o]=new N0(t.scaleName(`${o}`,true),{value:c,explicit:e.type===c})}}return i}const g_=Af((e,t)=>go(e)-go(t));function m_(e){const t=e.component.scales={};const r={};const n=e.component.resolve;for(const a of e.children){p_(a);for(const i of A(a.component.scales)){n.scale[i]??=Og(i,e);if(n.scale[i]==="shared"){const o=r[i];const s=a.component.scales[i].getWithExplicit("type");if(o)if(po(o.value,s.value))r[i]=Cf(o,s,"type","scale",g_);else{n.scale[i]="independent";delete r[i]}else r[i]=s}}}for(const l of A(r)){const c=e.scaleName(l,true);const u=r[l];t[l]=new N0(c,u);for(const d of e.children){const f=d.component.scales[l];if(f){d.renameScale(f.get("name"),c);f.merged=true}}}return t}class __{constructor(){this.nameMap={}}rename(e,t){this.nameMap[e]=t}has(e){return this.nameMap[e]!==undefined}get(e){while(this.nameMap[e]&&e!==this.nameMap[e])e=this.nameMap[e];return e}}function q(e){return e?.type==="unit"}function y_(e){return e?.type==="facet"}function T_(e){return e?.type==="concat"}function b_(e){return e?.type==="layer"}class v_{constructor(e,t,r,n,a,i,o){this.type=t;this.parent=r;this.config=a;this.parent=r;this.config=a;this.view=_(o);this.name=e.name??n;this.title=fn(e.title)?{text:e.title}:e.title?_(e.title):undefined;this.scaleNameMap=r?r.scaleNameMap:new __;this.projectionNameMap=r?r.projectionNameMap:new __;this.signalNameMap=r?r.signalNameMap:new __;this.data=e.data;this.description=e.description;this.transforms=tf(e.transform??[]);this.layout=t==="layer"||t==="unit"?{}:Mu(e,t,a);this.component={data:{sources:r?r.component.data.sources:[],outputNodes:r?r.component.data.outputNodes:{},outputNodeRefCounts:r?r.component.data.outputNodeRefCounts:{},isFaceted:il(e)||r?.component.data.isFaceted&&e.data===undefined},layoutSize:new vf,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:{scale:{},axis:{},legend:{},...i?g(i):{}},selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale();this.parseLayoutSize();this.renameTopLevelLayoutSizeSignal();this.parseSelections();this.parseProjection();this.parseData();this.parseAxesAndHeaders();this.parseLegends();this.parseMarkGroup()}parseScale(){f_(this)}parseProjection(){dm(this)}renameTopLevelLayoutSizeSignal(){if(this.getName("width")!=="width")this.renameSignal(this.getName("width"),"width");if(this.getName("height")!=="height")this.renameSignal(this.getName("height"),"height")}parseLegends(){Yg(this)}assembleEncodeFromView(e){const{style:t,...r}=e;const n={};for(const a of A(r)){const i=r[a];if(i!==undefined)n[a]=L(i)}return n}assembleGroupEncodeEntry(e){let t={};if(this.view)t=this.assembleEncodeFromView(this.view);if(!e){if(this.description)t["description"]=L(this.description);if(this.type==="unit"||this.type==="layer")return{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height"),...t}}return re(t)?undefined:t}assembleLayout(){if(!this.layout)return undefined;const{spacing:e,...t}=this.layout;const{component:r,config:n}=this;const a=_g(r.layoutHeaders,n);return{padding:e,...this.assembleDefaultLayout(),...t,...a?{titleBand:a}:{}}}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:e}=this.component;let t=[];for(const r of Lt)if(e[r].title)t.push(lg(this,r));for(const n of og)t=t.concat(dg(this,n));return t}assembleAxes(){return xh(this.component.axes,this.config)}assembleLegends(){return am(this)}assembleProjections(){return om(this)}assembleTitle(){const{encoding:e,...t}=this.title??{};const r={...dn(this.config.title).nonMarkTitleProperties,...t,...e?{encode:{update:e}}:{}};if(r.text){if(w(["unit","layer"],this.type)){if(w(["middle",undefined],r.anchor))r.frame??="group"}else r.anchor??="start";return re(r)?undefined:r}return undefined}assembleGroup(){let e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];const t={};e=e.concat(this.assembleSignals());if(e.length>0)t.signals=e;const r=this.assembleLayout();if(r)t.layout=r;t.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const n=!this.parent||y_(this.parent)?I0(this):[];if(n.length>0)t.scales=n;const a=this.assembleAxes();if(a.length>0)t.axes=a;const i=this.assembleLegends();if(i.length>0)t.legends=i;return t}getName(e){return k((this.name?`${this.name}_`:"")+e)}getDataName(e){return this.getName(G[e].toLowerCase())}requestDataName(e){const t=this.getDataName(e);const r=this.component.data.outputNodeRefCounts;r[t]=(r[t]||0)+1;return t}getSizeSignalRef(e){if(y_(this.parent)){const t=Sg(e);const r=Or(t);const n=this.component.scales[r];if(n&&!n.merged){const a=n.get("type");const i=n.get("range");if(U(a)&&pn(i)){const o=n.get("name");const s=R0(this,r);const l=w0(s);if(l){const c=j({aggregate:"distinct",field:l},{expr:"datum"});return{signal:Eg(o,n,c)}}else{ae(Hn(r));return null}}}}return{signal:this.signalNameMap.get(this.getName(e))}}lookupDataSource(e){const t=this.component.data.outputNodes[e];if(!t)return e;return t.getSource()}getSignalName(e){return this.signalNameMap.get(e)}renameSignal(e,t){this.signalNameMap.rename(e,t)}renameScale(e,t){this.scaleNameMap.rename(e,t)}renameProjection(e,t){this.projectionNameMap.rename(e,t)}scaleName(e,t){if(t)return this.getName(e);if(Kt(e)&&Gr(e)&&this.component.scales[e]||this.scaleNameMap.has(this.getName(e)))return this.scaleNameMap.get(this.getName(e));return undefined}projectionName(e){if(e)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"));return undefined}correctDataNames=e=>{if(e.from?.data)e.from.data=this.lookupDataSource(e.from.data);if(e.from?.facet?.data)e.from.facet.data=this.lookupDataSource(e.from.facet.data);return e};getScaleComponent(e){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const t=this.component.scales[e];if(t&&!t.merged)return t;return this.parent?this.parent.getScaleComponent(e):undefined}getScaleType(e){const t=this.getScaleComponent(e);return t?t.get("type"):undefined}getSelectionComponent(e,t){let r=this.component.selection[e];if(!r&&this.parent)r=this.parent.getSelectionComponent(e,t);if(!r)throw new Error($n(t));return r}hasAxisOrientSignalRef(){return this.component.axes.x?.some(e=>e.hasOrientSignalRef())||this.component.axes.y?.some(e=>e.hasOrientSignalRef())}}class E_ extends v_{vgField(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const r=this.fieldDef(e);if(!r)return undefined;return j(r,t)}reduceFieldDef(a,e){return Ac(this.getMapping(),(e,t,r)=>{const n=Wl(t);if(n)return a(e,n,r);return e},e)}forEachFieldDef(n,e){Sc(this.getMapping(),(e,t)=>{const r=Wl(e);if(r)n(r,t)},e)}}class S_ extends r{clone(){return new S_(null,g(this.transform))}constructor(e,t){super(e);this.transform=t;this.transform=g(t);const r=this.transform.as??[undefined,undefined];this.transform.as=[r[0]??"value",r[1]??"density"];const n=this.transform.resolve??"shared";this.transform.resolve=n}dependentFields(){return new Set([this.transform.density,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${S(this.transform)}`}assemble(){const{density:e,...t}=this.transform;const r={type:"kde",field:e,...t};r.resolve=this.transform.resolve;return r}}class A_ extends r{clone(){return new A_(null,g(this.transform))}constructor(e,t){super(e);this.transform=t;this.transform=g(t)}dependentFields(){return new Set([this.transform.extent])}producedFields(){return new Set([])}hash(){return`ExtentTransform ${S(this.transform)}`}assemble(){const{extent:e,param:t}=this.transform;const r={type:"extent",field:e,signal:t};return r}}class O_ extends r{clone(){return new O_(this.parent,g(this.transform))}constructor(e,t){super(e);this.transform=t;this.transform=g(t);const{flatten:r,as:n=[]}=this.transform;this.transform.as=r.map((e,t)=>n[t]??e)}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${S(this.transform)}`}assemble(){const{flatten:e,as:t}=this.transform;const r={type:"flatten",fields:e,as:t};return r}}class C_ extends r{clone(){return new C_(null,g(this.transform))}constructor(e,t){super(e);this.transform=t;this.transform=g(t);const r=this.transform.as??[undefined,undefined];this.transform.as=[r[0]??"key",r[1]??"value"]}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${S(this.transform)}`}assemble(){const{fold:e,as:t}=this.transform;const r={type:"fold",fields:e,as:t};return r}}class k_ extends r{clone(){return new k_(null,g(this.fields),this.geojson,this.signal)}static parseAll(e,r){if(r.component.projection&&!r.component.projection.isFit)return e;let t=0;for(const n of[[at,nt],[ot,it]]){const a=n.map(e=>{const t=H(r.encoding[e]);return B(t)?t.field:Tl(t)?{expr:`${t.datum}`}:Sl(t)?{expr:`${t["value"]}`}:undefined});if(a[0]||a[1])e=new k_(e,a,null,r.getName(`geojson_${t++}`))}if(r.channelHasField(ut)){const i=r.typedFieldDef(ut);if(i.type===co)e=new k_(e,null,i.field,r.getName(`geojson_${t++}`))}return e}constructor(e,t,r,n){super(e);this.fields=t;this.geojson=r;this.signal=n}dependentFields(){const e=(this.fields??[]).filter(te.isString);return new Set([...this.geojson?[this.geojson]:[],...e])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${S(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],{type:"geojson",...this.fields?{fields:this.fields}:{},...this.geojson?{geojson:this.geojson}:{},signal:this.signal}]}}class w_ extends r{clone(){return new w_(null,this.projection,g(this.fields),g(this.as))}constructor(e,t,r,n){super(e);this.projection=t;this.fields=r;this.as=n}static parseAll(e,r){if(!r.projectionName())return e;for(const t of[[at,nt],[ot,it]]){const n=t.map(e=>{const t=H(r.encoding[e]);return B(t)?t.field:Tl(t)?{expr:`${t.datum}`}:Sl(t)?{expr:`${t["value"]}`}:undefined});const a=t[0]===ot?"2":"";if(n[0]||n[1])e=new w_(e,r.projectionName(),n,[r.getName(`x${a}`),r.getName(`y${a}`)])}return e}dependentFields(){return new Set(this.fields.filter(te.isString))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${S(this.fields)} ${S(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class R_ extends r{clone(){return new R_(null,g(this.transform))}constructor(e,t){super(e);this.transform=t}dependentFields(){return new Set([this.transform.impute,this.transform.key,...this.transform.groupby??[]])}producedFields(){return new Set([this.transform.impute])}processSequence(e){const{start:t=0,stop:r,step:n}=e;const a=[t,r,...n?[n]:[]].join(",");return{signal:`sequence(${a})`}}static makeFromTransform(e,t){return new R_(e,t)}static makeFromEncoding(e,t){const r=t.encoding;const n=r.x;const a=r.y;if(B(n)&&B(a)){const i=n.impute?n:a.impute?a:undefined;if(i===undefined)return undefined;const o=n.impute?a:a.impute?n:undefined;const{method:s,value:l,frame:c,keyvals:u}=i.impute;const d=Oc(t.mark,r);return new R_(e,{impute:i.field,key:o.field,...s?{method:s}:{},...l!==undefined?{value:l}:{},...c?{frame:c}:{},...u!==undefined?{keyvals:u}:{},...d.length?{groupby:d}:{}})}return null}hash(){return`Impute ${S(this.transform)}`}assemble(){const{impute:e,key:t,keyvals:r,method:n,groupby:a,value:i,frame:o=[null,null]}=this.transform;const s={type:"impute",field:e,key:t,...r?{keyvals:Dd(r)?this.processSequence(r):r}:{},method:"value",...a?{groupby:a}:{},value:!n||n==="value"?i:null};if(n&&n!=="value"){const l={type:"window",as:[`imputed_${e}_value`],ops:[n],fields:[e],frame:o,ignorePeers:false,...a?{groupby:a}:{}};const c={type:"formula",expr:`datum.${e} === null ? datum.imputed_${e}_value : datum.${e}`,as:e};return[s,l,c]}else return[s]}}class I_ extends r{clone(){return new I_(null,g(this.transform))}constructor(e,t){super(e);this.transform=t;this.transform=g(t);const r=this.transform.as??[undefined,undefined];this.transform.as=[r[0]??t.on,r[1]??t.loess]}dependentFields(){return new Set([this.transform.loess,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${S(this.transform)}`}assemble(){const{loess:e,on:t,...r}=this.transform;const n={type:"loess",x:t,y:e,...r};return n}}class M_ extends r{clone(){return new M_(null,g(this.transform),this.secondary)}constructor(e,t,r){super(e);this.transform=t;this.secondary=r}static make(e,t,r,n){const a=t.component.data.sources;const{from:i}=r;let o=null;if(Ld(i)){let e=X_(i.data,a);if(!e){e=new Lm(i.data);a.push(e)}const s=t.getName(`lookup_${n}`);o=new zf(e,s,G.Lookup,t.component.data.outputNodeRefCounts);t.component.data.outputNodes[s]=o}else if(Fd(i)){const l=i.param;r={as:l,...r};let e;try{e=t.getSelectionComponent(k(l),l)}catch(e){throw new Error(Jn(l))}o=e.materialized;if(!o)throw new Error(Zn(l))}return new M_(e,r,o.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?te.array(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${S({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t={values:this.transform.from.fields,...this.transform.as?{as:te.array(this.transform.as)}:{}};else{let e=this.transform.as;if(!te.isString(e)){ae(sa);e="_lookup"}t={as:[e]}}return{type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup],...t,...this.transform.default?{default:this.transform.default}:{}}}}class P_ extends r{clone(){return new P_(null,g(this.transform))}constructor(e,t){super(e);this.transform=t;this.transform=g(t);const r=this.transform.as??[undefined,undefined];this.transform.as=[r[0]??"prob",r[1]??"value"]}dependentFields(){return new Set([this.transform.quantile,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${S(this.transform)}`}assemble(){const{quantile:e,...t}=this.transform;const r={type:"quantile",field:e,...t};return r}}class N_ extends r{clone(){return new N_(null,g(this.transform))}constructor(e,t){super(e);this.transform=t;this.transform=g(t);const r=this.transform.as??[undefined,undefined];this.transform.as=[r[0]??t.on,r[1]??t.regression]}dependentFields(){return new Set([this.transform.regression,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${S(this.transform)}`}assemble(){const{regression:e,on:t,...r}=this.transform;const n={type:"regression",x:t,y:e,...r};return n}}class D_ extends r{clone(){return new D_(null,g(this.transform))}constructor(e,t){super(e);this.transform=t}addDimensions(e){this.transform.groupby=Te((this.transform.groupby??[]).concat(e),e=>e)}producedFields(){return undefined}dependentFields(){return new Set([this.transform.pivot,this.transform.value,...this.transform.groupby??[]])}hash(){return`PivotTransform ${S(this.transform)}`}assemble(){const{pivot:e,value:t,groupby:r,limit:n,op:a}=this.transform;return{type:"pivot",field:e,value:t,...n!==undefined?{limit:n}:{},...a!==undefined?{op:a}:{},...r!==undefined?{groupby:r}:{}}}}class x_ extends r{clone(){return new x_(null,g(this.transform))}constructor(e,t){super(e);this.transform=t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${S(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function L_(o){let s=0;function l(t,r){if(t instanceof Lm)if(!t.isGenerator&&!wf(t.data)){o.push(r);const e={name:null,source:r.name,transform:[]};r=e}if(t instanceof Pm)if(t.parent instanceof Lm&&!r.source){r.format={...r.format,parse:t.assembleFormatParse()};r.transform.push(...t.assembleTransforms(true))}else r.transform.push(...t.assembleTransforms());if(t instanceof Cm){if(!r.name)r.name=`data_${s++}`;if(!r.source||r.transform.length>0){o.push(r);t.data=r.name}else t.data=r.source;o.push(...t.assemble());return}if(t instanceof Dm||t instanceof xm||t instanceof Xm||t instanceof Oh||t instanceof tg||t instanceof w_||t instanceof Om||t instanceof M_||t instanceof a0||t instanceof Qm||t instanceof C_||t instanceof O_||t instanceof S_||t instanceof I_||t instanceof P_||t instanceof N_||t instanceof Nm||t instanceof x_||t instanceof D_||t instanceof A_)r.transform.push(t.assemble());if(t instanceof Em||t instanceof Jf||t instanceof R_||t instanceof n0||t instanceof k_)r.transform.push(...t.assemble());if(t instanceof zf)if(r.source&&r.transform.length===0)t.setSource(r.source);else if(t.parent instanceof zf)t.setSource(r.name);else{if(!r.name)r.name=`data_${s++}`;t.setSource(r.name);if(t.numChildren()===1){o.push(r);const n={name:null,source:r.name,transform:[]};r=n}}switch(t.numChildren()){case 0:if(t instanceof zf&&(!r.source||r.transform.length>0))o.push(r);break;case 1:l(t.children[0],r);break;default:{if(!r.name)r.name=`data_${s++}`;let e=r.name;if(!r.source||r.transform.length>0)o.push(r);else e=r.source;for(const a of t.children){const i={name:null,source:e,transform:[]};l(a,i)}break}}}return l}function F_(e){const t=[];const r=L_(t);for(const n of e.children)r(n,{source:e.name,name:null,transform:[]});return t}function U_(e,t){const r=[];const n=L_(r);let a=0;for(const o of e.sources){if(!o.hasName())o.dataName=`source_${a++}`;const s=o.assemble();n(o,s)}for(const l of r)if(l.transform.length===0)delete l.transform;let i=0;for(const[c,u]of r.entries())if((u.transform??[]).length===0&&!u.source)r.splice(i++,0,r.splice(c,1)[0]);for(const d of r)for(const f of d.transform??[])if(f.type==="lookup")f.from=e.outputNodes[f.from].getSource();for(const p of r)if(p.name in t)p.values=t[p.name];return r}function B_(e){if(e==="top"||e==="left"||x(e))return"header";return"footer"}function j_(e){for(const t of Lt)H_(e,t);V_(e,"x");V_(e,"y")}function H_(t,r){const{facet:n,config:a,child:i,component:o}=t;if(t.channelHasField(r)){const s=n[r];const l=ag("title",null,a,r);let e=Bl(s,a,{allowDisabling:true,includeDefault:l===undefined||!!l});if(i.component.layoutHeaders[r].title){e=te.isArray(e)?e.join(", "):e;e+=` / ${i.component.layoutHeaders[r].title}`;i.component.layoutHeaders[r].title=null}const c=ag("labelOrient",s.header,a,r);const u=s.header!==null?R(s.header?.labels,a.header.labels,true):false;const d=w(["bottom","right"],c)?"footer":"header";o.layoutHeaders[r]={title:s.header!==null?e:null,facetFieldDef:s,[d]:r==="facet"?[]:[G_(t,r,u)]}}}function G_(e,t,r){const n=t==="row"?"height":"width";return{labels:r,sizeSignal:e.child.component.layoutSize.get(n)?e.child.getSizeSignalRef(n):undefined,axes:[]}}function V_(e,t){const{child:r}=e;if(r.component.axes[t]){const{layoutHeaders:n,resolve:a}=e.component;a.axis[t]=Cg(a,t);if(a.axis[t]==="shared"){const i=t==="x"?"column":"row";const o=n[i];for(const s of r.component.axes[t]){const l=B_(s.get("orient"));o[l]??=[G_(e,i,false)];const c=Nh(s,"main",e.config,{header:true});if(c)o[l][0].axes.push(c);s.mainExtracted=true}}}}function W_(e){$_(e);z_(e,"width");z_(e,"height")}function q_(e){$_(e);const t=e.layout.columns===1?"width":"childWidth";const r=e.layout.columns===undefined?"height":"childHeight";z_(e,t);z_(e,r)}function $_(e){for(const t of e.children)t.parseLayoutSize()}function z_(e,t){const r=Sg(t);const n=Or(r);const a=e.component.resolve;const i=e.component.layoutSize;let o;for(const s of e.children){const l=s.component.layoutSize.getWithExplicit(r);const c=a.scale[n]??Og(n,e);if(c==="independent"&&l.value==="step"){o=undefined;break}if(o){if(c==="independent"&&o.value!==l.value){o=undefined;break}o=Cf(o,l,r,"")}else o=l}if(o){for(const u of e.children){e.renameSignal(u.getName(r),e.getName(t));u.component.layoutSize.set(r,"merged",false)}i.setWithExplicit(t,o)}else i.setWithExplicit(t,{explicit:false,value:undefined})}function K_(e){const{size:t,component:r}=e;for(const n of Er){const a=er(n);if(t[a]){const i=t[a];r.layoutSize.set(a,Cu(i)?"step":i,true)}else{const o=Y_(e,a);r.layoutSize.set(a,o,false)}}}function Y_(e,t){const r=t==="width"?"x":"y";const n=e.config;const a=e.getScaleComponent(r);if(a){const i=a.get("type");const o=a.get("range");if(U(i)){const s=Du(n.view,t);if(pn(o)||Cu(s))return"step";else return s}else return Pu(n.view,t)}else if(e.hasProjection||e.mark==="arc")return Pu(n.view,t);else{const l=Du(n.view,t);return Cu(l)?l.step:l}}function J_(e,t,r){return j(t,{suffix:`by_${j(e)}`,...r})}class Z_ extends E_{constructor(e,t,r,n){super(e,"facet",t,r,n,e.resolve);this.child=Zy(e.spec,this,this.getName("child"),undefined,n);this.children=[this.child];this.facet=this.initFacet(e.facet)}initFacet(e){if(!nl(e))return{facet:this.initFacetFieldDef(e,"facet")};const t=A(e);const r={};for(const n of t){if(![$e,ze].includes(n)){ae(ba(n,"facet"));break}const a=e[n];if(a.field===undefined){ae(ya(a,n));break}r[n]=this.initFacetFieldDef(a,n)}return r}initFacetFieldDef(e,t){const r=Kl(e,t);if(r.header)r.header=_(r.header);else if(r.header===null)r.header=null;return r}channelHasField(e){return!!this.facet[e]}fieldDef(e){return this.facet[e]}parseData(){this.component.data=ry(this);this.child.parseData()}parseLayoutSize(){$_(this)}parseSelections(){this.child.parseSelections();this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders();j_(this)}assembleSelectionTopLevelSignals(e){return this.child.assembleSelectionTopLevelSignals(e)}assembleSignals(){this.child.assembleSignals();return[]}assembleSelectionData(e){return this.child.assembleSelectionData(e)}getHeaderLayoutMixins(){const e={};for(const t of Lt)for(const r of sg){const n=this.component.layoutHeaders[t];const a=n[r];const{facetFieldDef:i}=n;if(i){const o=ag("titleOrient",i.header,this.config,t);if(["right","bottom"].includes(o)){const s=ng(t,o);e.titleAnchor??={};e.titleAnchor[s]="end"}}if(a?.[0]){const l=t==="row"?"height":"width";const c=r==="header"?"headerBand":"footerBand";if(t!=="facet"&&!this.child.component.layoutSize.get(l)){e[c]??={};e[c][t]=.5}if(n.title){e.offset??={};e.offset[t==="row"?"rowTitle":"columnTitle"]=10}}}return e}assembleDefaultLayout(){const{column:e,row:t}=this.facet;const r=e?this.columnDistinctSignal():t?1:undefined;let n="all";if(!t&&this.component.resolve.scale.x==="independent")n="none";else if(!e&&this.component.resolve.scale.y==="independent")n="none";return{...this.getHeaderLayoutMixins(),...r?{columns:r}:{},bounds:"full",align:n}}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(this.parent&&this.parent instanceof Z_)return undefined;else{const e=this.getName("column_domain");return{signal:`length(data('${e}'))`}}}assembleGroupStyle(){return undefined}assembleGroup(e){if(this.parent&&this.parent instanceof Z_)return{...this.channelHasField("column")?{encode:{update:{columns:{field:j(this.facet.column,{prefix:"distinct"})}}}}:{},...super.assembleGroup(e)};return super.assembleGroup(e)}getCardinalityAggregateForChild(){const e=[];const t=[];const r=[];if(this.child instanceof Z_){if(this.child.channelHasField("column")){const n=j(this.child.facet.column);e.push(n);t.push("distinct");r.push(`distinct_${n}`)}}else for(const a of Er){const i=this.child.component.scales[a];if(i&&!i.merged){const o=i.get("type");const s=i.get("range");if(U(o)&&pn(s)){const l=R0(this.child,a);const c=w0(l);if(c){e.push(c);t.push("distinct");r.push(`distinct_${c}`)}else ae(Hn(a))}}}return{fields:e,ops:t,as:r}}assembleFacet(){const{name:e,data:t}=this.component.data.facetRoot;const{row:r,column:n}=this.facet;const{fields:a,ops:i,as:o}=this.getCardinalityAggregateForChild();const s=[];for(const c of Lt){const u=this.facet[c];if(u){s.push(j(u));const{bin:d,sort:f}=u;if(N(d))s.push(j(u,{binSuffix:"end"}));if(tl(f)){const{field:p,op:h=Zs}=f;const g=J_(u,f);if(r&&n){a.push(g);i.push("max");o.push(g)}else{a.push(p);i.push(h);o.push(g)}}else if(te.isArray(f)){const m=rg(u,c);a.push(m);i.push("max");o.push(m)}}}const l=!!r&&!!n;return{name:e,data:t,groupby:s,...l||a.length>0?{aggregate:{...l?{cross:l}:{},...a.length?{fields:a,ops:i,as:o}:{}}}:{}}}facetSortFields(e){const{facet:t}=this;const r=t[e];if(r){if(tl(r.sort))return[J_(r,r.sort,{expr:"datum"})];else if(te.isArray(r.sort))return[rg(r,e,{expr:"datum"})];return[j(r,{expr:"datum"})]}return[]}facetSortOrder(e){const{facet:t}=this;const r=t[e];if(r){const{sort:n}=r;const a=(tl(n)?n.order:!te.isArray(n)&&n)||"ascending";return[a]}return[]}assembleLabelTitle(){const{facet:e,config:t}=this;if(e.facet)return pg(e.facet,"facet",t);const r={row:["top","bottom"],column:["left","right"]};for(const n of og)if(e[n]){const a=ag("labelOrient",e[n]?.header,t,n);if(r[n].includes(a))return pg(e[n],n,t)}return undefined}assembleMarks(){const{child:e}=this;const t=this.component.data.facetRoot;const r=F_(t);const n=e.assembleGroupEncodeEntry(false);const a=this.assembleLabelTitle()||e.assembleTitle();const i=e.assembleGroupStyle();const o={name:this.getName("cell"),type:"group",...a?{title:a}:{},...i?{style:i}:{},from:{facet:this.assembleFacet()},sort:{field:Lt.map(e=>this.facetSortFields(e)).flat(),order:Lt.map(e=>this.facetSortOrder(e)).flat()},...r.length>0?{data:r}:{},...n?{encode:{update:n}}:{},...e.assembleGroup(jf(this,[]))};return[o]}getMapping(){return this.facet}}function Q_(t,e){const{row:r,column:n}=e;if(r&&n){let e=null;for(const a of[r,n])if(tl(a.sort)){const{field:i,op:o=Zs}=a.sort;t=e=new Qm(t,{joinaggregate:[{op:o,field:i,as:J_(a,a.sort,{forAs:true})}],groupby:[j(a)]})}return e}return null}function X_(e,t){for(const r of t){const n=r.data;if(e.name&&r.hasName()&&e.name!==r.dataName)continue;const a=e["format"]?.mesh;const i=n.format?.feature;if(a&&i)continue;const o=e["format"]?.feature;if((o||i)&&o!==i)continue;const s=n.format?.mesh;if((a||s)&&a!==s)continue;if(Rf(e)&&Rf(n)){if(qe(e.values,n.values))return r}else if(wf(e)&&wf(n)){if(e.url===n.url)return r}else if(If(e))if(e.name===r.dataName)return r}return null}function ey(e,t){if(e.data||!e.parent){if(e.data===null){const n=new Lm({values:[]});t.push(n);return n}const r=X_(e.data,t);if(r){if(!Mf(e.data))r.data.format=_e({},e.data.format,r.data.format);if(!r.hasName()&&e.data.name)r.dataName=e.data.name;return r}else{const a=new Lm(e.data);t.push(a);return a}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function ty(r,n,a){let i=0;for(const o of n.transforms){let e=undefined;let t;if(zd(o)){t=r=new tg(r,o);e="derived"}else if(Nd(o)){const s=Rm(o);t=r=Pm.makeWithAncestors(r,{},s,a)??r;r=new Oh(r,n,o.filter)}else if(Kd(o)){t=r=Em.makeFromTransform(r,o,n);e="number"}else if(Jd(o)){e="date";const l=a.getWithExplicit(o.field);if(l.value===undefined){r=new Pm(r,{[o.field]:e});a.set(o.field,e,false)}t=r=Jf.makeFromTransform(r,o)}else if(Zd(o)){t=r=Om.makeFromTransform(r,o);e="number";if(bh(n))r=new Nm(r)}else if(xd(o)){t=r=M_.make(r,n,o,i++);e="derived"}else if(Wd(o)){t=r=new a0(r,o);e="number"}else if(qd(o)){t=r=new Qm(r,o);e="number"}else if(Qd(o)){t=r=n0.makeFromTransform(r,o);e="derived"}else if(Xd(o)){t=r=new C_(r,o);e="derived"}else if(ef(o)){t=r=new A_(r,o);e="derived"}else if($d(o)){t=r=new O_(r,o);e="derived"}else if(Ud(o)){t=r=new D_(r,o);e="derived"}else if(Vd(o))r=new x_(r,o);else if(Yd(o)){t=r=R_.makeFromTransform(r,o);e="derived"}else if(Bd(o)){t=r=new S_(r,o);e="derived"}else if(jd(o)){t=r=new P_(r,o);e="derived"}else if(Hd(o)){t=r=new N_(r,o);e="derived"}else if(Gd(o)){t=r=new I_(r,o);e="derived"}else{ae(oa(o));continue}if(t&&e!==undefined)for(const c of t.producedFields()??[])a.set(c,e,false)}return r}function ry(e){let t=ey(e,e.component.data.sources);const{outputNodes:r,outputNodeRefCounts:n}=e.component.data;const a=e.data;const i=a&&(Mf(a)||wf(a)||Rf(a));const o=!i&&e.parent?e.parent.component.data.ancestorParse.clone():new kf;if(Mf(a)){if(Pf(a))t=new xm(t,a.sequence);else if(Df(a))t=new Dm(t,a.graticule);o.parseNothing=true}else if(a?.format?.parse===null)o.parseNothing=true;t=Pm.makeExplicit(t,e,o)??t;t=new Nm(t);const s=e.parent&&b_(e.parent);if(q(e)||y_(e))if(s)t=Em.makeFromEncoding(t,e)??t;if(e.transforms.length>0)t=ty(t,e,o);const l=Mm(e);const c=Im(e);t=Pm.makeWithAncestors(t,{},{...l,...c},o)??t;if(q(e)){t=k_.parseAll(t,e);t=w_.parseAll(t,e)}if(q(e)||y_(e)){if(!s)t=Em.makeFromEncoding(t,e)??t;t=Jf.makeFromEncoding(t,e)??t;t=tg.parseAllForSortIndex(t,e)}const u=t=ny(G.Raw,e,t);if(q(e)){const m=Om.makeFromEncoding(t,e);if(m){t=m;if(bh(e))t=new Nm(t)}t=R_.makeFromEncoding(t,e)??t;t=n0.makeFromEncoding(t,e)??t}let d;let f;if(q(e)){const{markDef:_,mark:y,config:T}=e;const b=ne("invalid",_,T);const{marks:v,scales:E}=f=xf({invalid:b,isPath:as(y)});if(v!==E&&E==="include-invalid-values")d=t=ny(G.PreFilterInvalid,e,t);if(v==="exclude-invalid-values")t=Xm.make(t,e,f)??t}const p=t=ny(G.Main,e,t);let h;if(q(e)&&f){const{marks:S,scales:A}=f;if(S==="include-invalid-values"&&A==="exclude-invalid-values"){t=Xm.make(t,e,f)??t;h=t=ny(G.PostFilterInvalid,e,t)}}if(q(e))Rh(e,p);let g=null;if(y_(e)){const O=e.getName("facet");t=Q_(t,e.facet)??t;g=new Cm(t,e,O,p.getSource());r[O]=g}return{...e.component.data,outputNodes:r,outputNodeRefCounts:n,raw:u,main:p,facetRoot:g,ancestorParse:o,preFilterInvalid:d,postFilterInvalid:h}}function ny(e,t,r){const{outputNodes:n,outputNodeRefCounts:a}=t.component.data;const i=t.getDataName(e);const o=new zf(r,i,e,a);n[i]=o;return o}class ay extends v_{constructor(e,t,r,n){super(e,"concat",t,r,n,e.resolve);if(e.resolve?.axis?.x==="shared"||e.resolve?.axis?.y==="shared")ae(ra);this.children=this.getChildren(e).map((e,t)=>{return Zy(e,this,this.getName(`concat_${t}`),undefined,n)})}parseData(){this.component.data=ry(this);for(const e of this.children)e.parseData()}parseSelections(){this.component.selection={};for(const e of this.children){e.parseSelections();for(const t of A(e.component.selection))this.component.selection[t]=e.component.selection[t]}}parseMarkGroup(){for(const e of this.children)e.parseMarkGroup()}parseAxesAndHeaders(){for(const e of this.children)e.parseAxesAndHeaders()}getChildren(e){if(Su(e))return e.vconcat;else if(Au(e))return e.hconcat;return e.concat}parseLayoutSize(){q_(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(e){return this.children.reduce((e,t)=>t.assembleSelectionTopLevelSignals(e),e)}assembleSignals(){this.children.forEach(e=>e.assembleSignals());return[]}assembleLayoutSignals(){const e=Tg(this);for(const t of this.children)e.push(...t.assembleLayoutSignals());return e}assembleSelectionData(e){return this.children.reduce((e,t)=>t.assembleSelectionData(e),e)}assembleMarks(){return this.children.map(e=>{const t=e.assembleTitle();const r=e.assembleGroupStyle();const n=e.assembleGroupEncodeEntry(false);return{type:"group",name:e.getName("group"),...t?{title:t}:{},...r?{style:r}:{},...n?{encode:{update:n}}:{},...e.assembleGroup()}})}assembleGroupStyle(){return undefined}assembleDefaultLayout(){const e=this.layout.columns;return{...e!=null?{columns:e}:{},bounds:"full",align:"each"}}}function iy(e){return e===false||e===null}const oy={disable:1,gridScale:1,scale:1,...sc,labelExpr:1,encode:1},sy=A(oy);class ly extends vf{constructor(){let e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};let r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;super();this.explicit=e;this.implicit=t;this.mainExtracted=r}clone(){return new ly(g(this.explicit),g(this.implicit),this.mainExtracted)}hasAxisPart(e){if(e==="axis")return true;if(e==="grid"||e==="title")return!!this.get(e);return!iy(this.get(e))}hasOrientSignalRef(){return x(this.explicit.orient)}}function cy(e,t,r){const{encoding:n,config:a}=e;const i=H(n[t])??H(n[Xt(t)]);const o=e.axis(t)||{};const{format:s,formatType:l}=o;if(Fs(l))return{text:Gs({fieldOrDatumDef:i,field:"datum.value",format:s,formatType:l,config:a}),...r};else if(s===undefined&&l===undefined&&a.customFormatTypes){if(yl(i)==="quantitative")if(Ol(i)&&i.stack==="normalize"&&a.normalizedNumberFormatType)return{text:Gs({fieldOrDatumDef:i,field:"datum.value",format:a.normalizedNumberFormat,formatType:a.normalizedNumberFormatType,config:a}),...r};else if(a.numberFormatType)return{text:Gs({fieldOrDatumDef:i,field:"datum.value",format:a.numberFormat,formatType:a.numberFormatType,config:a}),...r};if(yl(i)==="temporal"&&a.timeFormatType&&B(i)&&!i.timeUnit)return{text:Gs({fieldOrDatumDef:i,field:"datum.value",format:a.timeFormat,formatType:a.timeFormatType,config:a}),...r}}return r}function uy(r){return Er.reduce((e,t)=>{if(r.component.scales[t])e[t]=[_y(t,r)];return e},{})}const dy={bottom:"top",top:"bottom",left:"right",right:"left"};function fy(e){const{axes:t,resolve:r}=e.component;const n={top:0,bottom:0,right:0,left:0};for(const a of e.children){a.parseAxesAndHeaders();for(const i of A(a.component.axes)){r.axis[i]=Cg(e.component.resolve,i);if(r.axis[i]==="shared"){t[i]=py(t[i],a.component.axes[i]);if(!t[i]){r.axis[i]="independent";delete t[i]}}}}for(const o of Er){for(const s of e.children){if(!s.component.axes[o])continue;if(r.axis[o]==="independent"){t[o]=(t[o]??[]).concat(s.component.axes[o]);for(const l of s.component.axes[o]){const{value:c,explicit:u}=l.getWithExplicit("orient");if(x(c))continue;if(n[c]>0&&!u){const d=dy[c];if(n[c]>n[d])l.set("orient",d,false)}n[c]++}}delete s.component.axes[o]}if(r.axis[o]==="independent"&&t[o]&&t[o].length>1)for(const[f,p]of(t[o]||[]).entries())if(f>0&&!!p.get("grid")&&!p.explicit.grid)p.implicit.grid=false}}function py(t,r){if(t){if(t.length!==r.length)return undefined;const n=t.length;for(let e=0;e<n;e++){const a=t[e];const i=r[e];if(!!a!==!!i)return undefined;else if(a&&i){const o=a.getWithExplicit("orient");const s=i.getWithExplicit("orient");if(o.explicit&&s.explicit&&o.value!==s.value)return undefined;else t[e]=hy(a,i)}}}else return r.map(e=>e.clone());return t}function hy(e,t){for(const r of sy){const n=Cf(e.getWithExplicit(r),t.getWithExplicit(r),r,"axis",(e,t)=>{switch(r){case"title":return xn(e,t);case"gridScale":return{explicit:e.explicit,value:R(e.value,t.value)}}return Of(e,t,r,"axis")});e.setWithExplicit(r,n)}return e}function gy(e,t,r,n,a){if(t==="disable")return r!==undefined;r=r||{};switch(t){case"titleAngle":case"labelAngle":return e===(x(r.labelAngle)?r.labelAngle:Ge(r.labelAngle));case"values":return!!r.values;case"encode":return!!r.encoding||!!r.labelAngle;case"title":if(e===Qh(n,a))return true}return e===r[t]}const my=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function _y(a,i){let e=i.axis(a);const o=new ly;const t=H(i.encoding[a]);const{mark:r,config:n}=i;const s=e?.orient||n[a==="x"?"axisX":"axisY"]?.orient||n.axis?.orient||Yh(a);const l=i.getScaleComponent(a).get("type");const c=Fh(a,l,s,i.config);const u=e!==undefined?!e:Bh("disable",n.style,e?.style,c).configValue;o.set("disable",u,e!==undefined);if(u)return o;e=e||{};const d=Vh(t,e,a,n.style,c);const f=Ws(e.formatType,t,l);const p=Vs(t,t.type,e.format,e.formatType,n,true);const h={fieldOrDatumDef:t,axis:e,channel:a,model:i,scaleType:l,orient:s,labelAngle:d,format:p,formatType:f,mark:r,config:n};for(const _ of sy){const y=_ in jh?jh[_](h):cc(_)?e[_]:undefined;const T=y!==undefined;const b=gy(y,_,e,i,a);if(T&&b)o.set(_,y,b);else{const{configValue:v=undefined,configFrom:E=undefined}=cc(_)&&_!=="values"?Bh(_,n.style,e.style,c):{};const S=v!==undefined;if(T&&!S)o.set(_,y,b);else if(!(E==="vgAxisConfig")||my.has(_)&&S||ac(v)||x(v))o.set(_,v,false)}}const g=e.encoding??{};const m=ic.reduce((e,t)=>{if(!o.hasAxisPart(t))return e;const r=Ag(g[t]??{},i);const n=t==="labels"?cy(i,a,r):r;if(n!==undefined&&!re(n))e[t]={update:n};return e},{});if(!re(m))o.set("encode",m,!!e.encoding||e.labelAngle!==undefined);return o}function yy(e){let{encoding:t,size:r}=e;for(const n of Er){const a=er(n);if(Cu(r[a]))if(bl(t[n])){delete r[a];ae(Ua(a))}}return r}const Ty={vgMark:"arc",encodeEntry:e=>{return{...$p(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...d("x",e,{defaultPos:"mid"}),...d("y",e,{defaultPos:"mid"}),...Bp(e,"radius"),...Bp(e,"theta")}}},by={vgMark:"area",encodeEntry:e=>{return{...$p(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"}),...Dp("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"}),...Dp("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"}),...Yp(e)}}},vy={vgMark:"rect",encodeEntry:e=>{return{...$p(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Bp(e,"x"),...Bp(e,"y")}}},Ey={vgMark:"shape",encodeEntry:e=>{return{...$p(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})}},postEncodingTransform:e=>{const{encoding:t}=e;const r=t.shape;const n={type:"geoshape",projection:e.projectionName(),...r&&B(r)&&r.type===co?{field:j(r,{expr:"datum"})}:{}};return[n]}},Sy={vgMark:"image",encodeEntry:e=>{return{...$p(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"}),...Bp(e,"x"),...Bp(e,"y"),..._p(e,"url")}}},Ay={vgMark:"line",encodeEntry:e=>{return{...$p(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...d("x",e,{defaultPos:"mid"}),...d("y",e,{defaultPos:"mid"}),...V("size",e,{vgChannel:"strokeWidth"}),...Yp(e)}}},Oy={vgMark:"trail",encodeEntry:e=>{return{...$p(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...d("x",e,{defaultPos:"mid"}),...d("y",e,{defaultPos:"mid"}),...V("size",e),...Yp(e)}}};function Cy(e,t){const{config:r}=e;return{...$p(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...d("x",e,{defaultPos:"mid"}),...d("y",e,{defaultPos:"mid"}),...V("size",e),...V("angle",e),...ky(e,r,t)}}function ky(e,t,r){if(r)return{shape:{value:r}};return V("shape",e)}const wy={vgMark:"symbol",encodeEntry:e=>{return Cy(e)}},Ry={vgMark:"symbol",encodeEntry:e=>{return Cy(e,"circle")}},Iy={vgMark:"symbol",encodeEntry:e=>{return Cy(e,"square")}},My={vgMark:"rect",encodeEntry:e=>{return{...$p(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Bp(e,"x"),...Bp(e,"y")}}},Py={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e;const r=t.orient;if(!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude)return{};return{...$p(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Dp("x",e,{defaultPos:r==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:r!=="vertical"}),...Dp("y",e,{defaultPos:r==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:r!=="horizontal"}),...V("size",e,{vgChannel:"strokeWidth"})}}},Ny={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:r}=e;return{...$p(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"}),...d("x",e,{defaultPos:"mid"}),...d("y",e,{defaultPos:"mid"}),..._p(e),...V("size",e,{vgChannel:"fontSize"}),...V("angle",e),...Jp("align",Dy(e.markDef,r,t)),...Jp("baseline",xy(e.markDef,r,t)),...d("radius",e,{defaultPos:null}),...d("theta",e,{defaultPos:null})}}};function Dy(e,t,r){const n=ne("align",e,r);if(n===undefined)return"center";return undefined}function xy(e,t,r){const n=ne("baseline",e,r);if(n===undefined)return"middle";return undefined}const Ly={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:r}=e;const n=r.orient;const a=n==="horizontal"?"width":"height";const i=n==="horizontal"?"height":"width";return{...$p(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...d("x",e,{defaultPos:"mid",vgChannel:"xc"}),...d("y",e,{defaultPos:"mid",vgChannel:"yc"}),...V("size",e,{defaultValue:Fy(e),vgChannel:a}),[i]:L(ne("thickness",r,t))}}};function Fy(e){const{config:t,markDef:r}=e;const{orient:n}=r;const a=n==="horizontal"?"width":"height";const i=e.getScaleComponent(n==="horizontal"?"x":"y");const o=ne("size",r,t,{vgChannel:a})??t.tick.bandSize;if(o!==undefined)return o;else{const s=i?i.get("range"):undefined;if(s&&pn(s)&&te.isNumber(s.step))return s.step*3/4;const l=Nu(t.view,a);return l*3/4}}const Uy={arc:Ty,area:by,bar:vy,circle:Ry,geoshape:Ey,image:Sy,line:Ay,point:wy,rect:My,rule:Py,square:Iy,text:Ny,tick:Ly,trail:Oy};function By(t){if(w([Ko,qo,es],t.mark)){const e=Oc(t.mark,t.encoding);if(e.length>0)return Hy(t,e)}else if(t.mark===$o){const r=bn.some(e=>ne(e,t.markDef,t.config));if(t.stack&&!t.fieldDef("size")&&r)return Vy(t)}return qy(t)}const jy="faceted_path_";function Hy(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:jy+e.requestDataName(G.Main),data:e.requestDataName(G.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:qy(e,{fromPrefix:jy})}]}const Gy="stack_group_";function Vy(n){const[a]=qy(n,{fromPrefix:Gy});const i=n.scaleName(n.stack.fieldChannel);const o=function(){let e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return n.vgField(n.stack.fieldChannel,e)};const e=(e,t)=>{const r=[o({prefix:"min",suffix:"start",expr:t}),o({prefix:"max",suffix:"start",expr:t}),o({prefix:"min",suffix:"end",expr:t}),o({prefix:"max",suffix:"end",expr:t})];return`${e}(${r.map(e=>`scale('${i}',${e})`).join(",")})`};let t;let r;if(n.stack.fieldChannel==="x"){t={...fe(a.encode.update,["y","yc","y2","height",...bn]),x:{signal:e("min","datum")},x2:{signal:e("max","datum")},clip:{value:true}};r={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}};a.encode.update={...pe(a.encode.update,["y","yc","y2"]),height:{field:{group:"height"}}}}else{t={...fe(a.encode.update,["x","xc","x2","width"]),y:{signal:e("min","datum")},y2:{signal:e("max","datum")},clip:{value:true}};r={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}};a.encode.update={...pe(a.encode.update,["x","xc","x2"]),width:{field:{group:"width"}}}}for(const c of bn){const u=Rn(c,n.markDef,n.config);if(a.encode.update[c]){t[c]=a.encode.update[c];delete a.encode.update[c]}else if(u)t[c]=L(u);if(u)a.encode.update[c]={value:0}}const s=[];if(n.stack.groupbyChannels?.length>0)for(const d of n.stack.groupbyChannels){const f=n.fieldDef(d);const p=j(f);if(p)s.push(p);if(f?.bin||f?.timeUnit)s.push(j(f,{binSuffix:"end"}))}const l=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"];t=l.reduce((e,t)=>{if(a.encode.update[t])return{...e,[t]:a.encode.update[t]};else{const r=Rn(t,n.markDef,n.config);if(r!==undefined)return{...e,[t]:L(r)};else return e}},t);if(t.stroke){t.strokeForeground={value:true};t.strokeOffset={value:0}}return[{type:"group",from:{facet:{data:n.requestDataName(G.Main),name:Gy+n.requestDataName(G.Main),groupby:s,aggregate:{fields:[o({suffix:"start"}),o({suffix:"start"}),o({suffix:"end"}),o({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:t},marks:[{type:"group",encode:{update:r},marks:[a]}]}]}function Wy(e){const{encoding:t,stack:r,mark:n,markDef:a,config:i}=e;const o=t.order;if(!te.isArray(o)&&Sl(o)&&he(o.value)||!o&&he(ne("order",a,i)))return undefined;else if((te.isArray(o)||B(o))&&!r)return Pn(o,{expr:"datum"});else if(as(n)){const s=a.orient==="horizontal"?"y":"x";const l=t[s];if(B(l))return{field:s}}return undefined}function qy(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{fromPrefix:""};const{mark:r,markDef:n,encoding:a,config:i}=e;const o=R(n.clip,$y(e),zy(e));const s=wn(n);const l=a.key;const c=Wy(e);const u=Ky(e);const d=ne("aria",n,i);const f=Uy[r].postEncodingTransform?Uy[r].postEncodingTransform(e):null;return[{name:e.getName("marks"),type:Uy[r].vgMark,...o?{clip:o}:{},...s?{style:s}:{},...l?{key:l.field}:{},...c?{sort:c}:{},...u?u:{},...d===false?{aria:d}:{},from:{data:t.fromPrefix+e.requestDataName(G.Main)},encode:{update:Uy[r].encodeEntry(e)},...f?{transform:f}:{}}]}function $y(e){const t=e.getScaleComponent("x");const r=e.getScaleComponent("y");return t?.get("selectionExtent")||r?.get("selectionExtent")?true:undefined}function zy(e){const t=e.component.projection;return t&&!t.isFit?true:undefined}function Ky(e){if(!e.component.selection)return null;const t=A(e.component.selection).length;let r=t;let n=e.parent;while(n&&r===0){r=A(n.component.selection).length;n=n.parent}return r?{interactive:t>0||e.mark==="geoshape"||!!e.encoding.tooltip||!!e.markDef.tooltip}:null}class Yy extends E_{specifiedScales={};specifiedAxes={};specifiedLegends={};specifiedProjection={};selection=[];children=[];constructor(e,t,r){let n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};let a=arguments.length>4?arguments[4]:undefined;super(e,"unit",t,r,a,undefined,ku(e)?e.view:undefined);const i=ss(e.mark)?{...e.mark}:{type:e.mark};const o=i.type;if(i.filled===undefined)i.filled=gd(i,a,{graticule:e.data&&Df(e.data)});const s=this.encoding=bc(e.encoding||{},o,i.filled,a);this.markDef=fd(i,s,a);this.size=yy({encoding:s,size:ku(e)?{...n,...e.width?{width:e.width}:{},...e.height?{height:e.height}:{}}:n});this.stack=dd(this.markDef,s);this.specifiedScales=this.initScales(o,s);this.specifiedAxes=this.initAxes(s);this.specifiedLegends=this.initLegends(s);this.specifiedProjection=e.projection;this.selection=(e.params??[]).filter(e=>Tu(e))}get hasProjection(){const{encoding:t}=this;const e=this.mark===ns;const r=t&&Pt.some(e=>T(t[e]));return e||r}scaleDomain(e){const t=this.specifiedScales[e];return t?t.domain:undefined}axis(e){return this.specifiedAxes[e]}legend(e){return this.specifiedLegends[e]}initScales(e,n){return Hr.reduce((e,t)=>{const r=H(n[t]);if(r)e[t]=this.initScale(r.scale??{});return e},{})}initScale(e){const{domain:t,range:r}=e;const n=_(e);if(te.isArray(t))n.domain=t.map(En);if(te.isArray(r))n.range=r.map(En);return n}initAxes(a){return Er.reduce((e,t)=>{const r=a[t];if(T(r)||t===I&&T(a.x2)||t===M&&T(a.y2)){const n=T(r)?r.axis:undefined;e[t]=n?this.initAxis({...n}):n}return e},{})}initAxis(e){const t=A(e);const r={};for(const n of t){const a=e[n];r[n]=ac(a)?vn(a):En(a)}return r}initLegends(a){return Fr.reduce((e,t)=>{const r=H(a[t]);if(r&&Br(t)){const n=r.legend;e[t]=n?_(n):n}return e},{})}parseData(){this.component.data=ry(this)}parseLayoutSize(){K_(this)}parseSelections(){this.component.selection=Ch(this,this.selection)}parseMarkGroup(){this.component.mark=By(this)}parseAxesAndHeaders(){this.component.axes=uy(this)}assembleSelectionTopLevelSignals(e){return Hf(this,e)}assembleSignals(){return[...Dh(this),...Bf(this,[])]}assembleSelectionData(e){return Gf(this,e)}assembleLayout(){return null}assembleLayoutSignals(){return Tg(this)}assembleMarks(){let e=this.component.mark??[];if(!this.parent||!b_(this.parent))e=Vf(this,e);return e.map(this.correctDataNames)}assembleGroupStyle(){const{style:e}=this.view||{};if(e!==undefined)return e;if(this.encoding.x||this.encoding.y)return"cell";else return"view"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(e){return hc(this.encoding,e)}fieldDef(e){const t=this.encoding[e];return Wl(t)}typedFieldDef(e){const t=this.fieldDef(e);if(v(t))return t;return null}}class Jy extends v_{constructor(e,t,r,n,a){super(e,"layer",t,r,a,e.resolve,e.view);const i={...n,...e.width?{width:e.width}:{},...e.height?{height:e.height}:{}};this.children=e.layer.map((e,t)=>{if(ed(e))return new Jy(e,this,this.getName(`layer_${t}`),i,a);else if(fc(e))return new Yy(e,this,this.getName(`layer_${t}`),i,a);throw new Error(Ln(e))})}parseData(){this.component.data=ry(this);for(const e of this.children)e.parseData()}parseLayoutSize(){W_(this)}parseSelections(){this.component.selection={};for(const e of this.children){e.parseSelections();for(const t of A(e.component.selection))this.component.selection[t]=e.component.selection[t]}}parseMarkGroup(){for(const e of this.children)e.parseMarkGroup()}parseAxesAndHeaders(){fy(this)}assembleSelectionTopLevelSignals(e){return this.children.reduce((e,t)=>t.assembleSelectionTopLevelSignals(e),e)}assembleSignals(){return this.children.reduce((e,t)=>{return e.concat(t.assembleSignals())},Dh(this))}assembleLayoutSignals(){return this.children.reduce((e,t)=>{return e.concat(t.assembleLayoutSignals())},Tg(this))}assembleSelectionData(e){return this.children.reduce((e,t)=>t.assembleSelectionData(e),e)}assembleGroupStyle(){const e=new Set;for(const r of this.children)for(const n of te.array(r.assembleGroupStyle()))e.add(n);const t=Array.from(e);return t.length>1?t:t.length===1?t[0]:undefined}assembleTitle(){let e=super.assembleTitle();if(e)return e;for(const t of this.children){e=t.assembleTitle();if(e)return e}return undefined}assembleLayout(){return null}assembleMarks(){return Wf(this,this.children.flatMap(e=>{return e.assembleMarks()}))}assembleLegends(){return this.children.reduce((e,t)=>{return e.concat(t.assembleLegends())},am(this))}}function Zy(e,t,r,n,a){if(il(e))return new Z_(e,t,r,a);else if(ed(e))return new Jy(e,t,r,n,a);else if(fc(e))return new Yy(e,t,r,n,a);else if(vu(e))return new ay(e,t,r,a);throw new Error(Ln(e))}function Qy(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(t.logger)si(t.logger);if(t.fieldTitle)Fl(t.fieldTitle);try{const r=zu(te.mergeConfig(t.config,e.config));const n=uf(e,r);const a=Zy(n,null,"",undefined,r);a.parse();p0(a.component.data,a);const i=eT(a,Xy(e,n.autosize,r,a),e.datasets,e.usermeta);return{spec:i,normalized:n}}finally{if(t.logger)li();if(t.fieldTitle)Ul()}}function Xy(e,t,r,n){const a=n.component.layoutSize.get("width");const i=n.component.layoutSize.get("height");if(t===undefined){t={type:"pad"};if(n.hasAxisOrientSignalRef())t.resize=true}else if(te.isString(t))t={type:t};if(a&&i&&_f(t.type))if(a==="step"&&i==="step"){ae(jn());t.type="pad"}else if(a==="step"||i==="step"){const o=a==="step"?"width":"height";ae(jn(Or(o)));const s=o==="width"?"height":"width";t.type=yf(s)}return{...A(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t},...bf(r,false),...bf(e,true)}}function eT(e,t){let r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};let n=arguments.length>3?arguments[3]:undefined;const a=e.config?Zu(e.config):undefined;const i=[].concat(e.assembleSelectionData([]),U_(e.component.data,r));const o=e.assembleProjections();const s=e.assembleTitle();const l=e.assembleGroupStyle();const c=e.assembleGroupEncodeEntry(true);let u=e.assembleLayoutSignals();u=u.filter(e=>{if((e.name==="width"||e.name==="height")&&e.value!==undefined){t[e.name]=+e.value;return false}return true});const{params:d,...f}=t;return{$schema:"https://vega.github.io/schema/vega/v5.json",...e.description?{description:e.description}:{},...f,...s?{title:s}:{},...l?{style:l}:{},...c?{encode:{update:c}}:{},data:i,...o.length>0?{projections:o}:{},...e.assembleGroup([...u,...e.assembleSelectionTopLevelSignals([]),...bu(d)]),...a?{config:a}:{},...n?{usermeta:n}:{}}}const tT=ie.version;e.accessPathDepth=Le,e.accessPathWithDatum=Ie,e.compile=Qy,e.contains=w,e.deepEqual=qe,e.deleteNestedProperty=we,e.duplicate=g,e.entries=Oe,e.every=me,e.fieldIntersection=Ae,e.flatAccessWithDatum=Me,e.getFirstDefined=R,e.hasIntersection=Ee,e.hash=S,e.internalField=je,e.isBoolean=Ce,e.isEmpty=re,e.isEqual=be,e.isInternalField=He,e.isNullOrFalse=he,e.isNumeric=Ve,e.keys=A,e.logicalExpr=ke,e.mergeDeep=_e,e.never=de,e.normalize=uf,e.normalizeAngle=Ge,e.omit=pe,e.pick=fe,e.prefixGenerator=Se,e.removePathFromField=xe,e.replaceAll=De,e.replacePathInField=Ne,e.resetIdCounter=Be,e.setEqual=ve,e.some=ge,e.stringify=m,e.titleCase=Re,e.unique=Te,e.uniqueId=Ue,e.vals=C,e.varName=k,e.version=tT}(Cd.exports,Ad())),Cd.exports}var wd,Rd={};function Id(){if(!wd){wd=1,Object.defineProperty(Rd,"__esModule",{value:!0}),Rd.getErrorMessage=r,Rd.ignoreCacheUnactionableErrors=function(e,t){{if(r(e).includes("UnknownError"))return t;throw e}};const n=z();function r(e){if((0,n.exists)(e)&&"object"==typeof e){var t=e;if((0,n.exists)(t.message))return String(t.message);if((0,n.exists)(t.error)&&(0,n.exists)(t.error.message))return String(t.error.message)}t=String(e);if("[object Object]"===t)try{return JSON.stringify(e)}catch(e){}return t}}return Rd}var Md,Pd,Nd={};function Dd(){if(!Md){Md=1,Object.defineProperty(Nd,"__esModule",{value:!0}),Nd.SimpleResizeObserver=void 0;class e{observer;constructor(e,t){var r=new ResizeObserver(()=>{t()});r.observe(e),this.observer=r}[Symbol.dispose](){this.observer&&(this.observer.disconnect(),this.observer=void 0)}}Nd.SimpleResizeObserver=e}return Nd}function xd(){if(!Pd){Pd=1,Object.defineProperty(Wc,"__esModule",{value:!0}),Wc.VegaView=void 0;var i,e=or;const t=e.__importDefault(ae()),o=e.__importStar(Ad()),s=e.__importStar(kd()),r=Id(),l=te(),n=Dd(),c=Z(),a=Tl(),u=$l();(e=i=i||{})[e.Empty=0]="Empty",e[e.Loading=1]="Loading",e[e.Error=2]="Error",e[e.Done=3]="Done";class d{engine;loader;constructor(e){this.engine=e,this.loader=o.loader()}async load(e,t){if(void 0===this.engine)return"";try{for(var r=await this.engine.query(e),n=r.columns(),a=[],i=r.iter({});i.valid();i.next()){var o={};for(const s of n){let e=i.get(s);"bigint"==typeof e&&(e=Number(e)),o[s]=e}a.push(o)}return JSON.stringify(a)}catch(e){if(e instanceof c.QueryError)return console.error(e),"";throw e}}sanitize(e,t){return this.loader.sanitize(e,t)}http(e,t){return this.loader.http(e,t)}file(e){return this.loader.file(e)}}class f{dom;_spec;_data;view;pending;_status;_error;_engine;constructor(e){this.dom=e,this._status=i.Empty}get status(){return this._status}get error(){return this._error??""}set spec(e){this._spec!==e&&(this._spec=e,this.updateView())}set data(e){this._data===e||(0,l.shallowEquals)(this._data,e)||(this._data=e,this.updateView())}set engine(e){this._engine=e}onResize(){this.view&&this.view.resize()}updateView(){if(this._status=i.Empty,this._error=void 0,this.pending&&(this.pending=void 0),this.view&&(this.view.finalize(),this.view=void 0),void 0!==this._spec&&void 0!==this._data){let e;try{e=JSON.parse(this._spec)}catch(e){return void this.setError(e)}if(function(e){if("object"==typeof e){e=e.$schema;if(void 0!==e&&(0,l.isString)(e))return e.includes("vega-lite")}return 1}(e))try{e=s.compile(e,{}).spec}catch(e){return void this.setError(e)}var t,r,n=o.parse(e);this.view=new o.View(n,{loader:new d(this._engine)}),this.view.initialize(this.dom);for([t,r]of Object.entries(this._data))this.view.data(t,r);const a=this.view.runAsync();a.then(()=>{this.handleComplete(a)}).catch(e=>{this.handleError(a,e)}),this.pending=a,this._status=i.Loading}}handleComplete(e){this.pending===e&&(this._status=i.Done,(this.pending=void 0,a.scheduleFullRedraw)())}handleError(e,t){this.pending===e&&(this.pending=void 0,this.setError(t))}setError(e){this._status=i.Error,this._error=(0,r.getErrorMessage)(e),(0,a.scheduleFullRedraw)()}[Symbol.dispose](){this._data=void 0,this._spec=void 0,this.updateView()}}Wc.VegaView=class{wrapper;resize;oncreate({dom:e,attrs:t}){const r=new f(e.firstElementChild);r.spec=t.spec,r.data=t.data,r.engine=t.engine,this.wrapper=r,this.resize=new n.SimpleResizeObserver(e,()=>{r.onResize()})}onupdate({attrs:e}){this.wrapper&&(this.wrapper.spec=e.spec,this.wrapper.data=e.data,this.wrapper.engine=e.engine)}onremove(){this.resize&&(this.resize[Symbol.dispose](),this.resize=void 0),this.wrapper&&(this.wrapper[Symbol.dispose](),this.wrapper=void 0)}view(e){return(0,t.default)(".pf-vega-view",(0,t.default)(""),this.wrapper?.status===i.Loading&&(0,t.default)(".pf-vega-view-status",(0,t.default)(u.Spinner)),this.wrapper?.status===i.Error&&(0,t.default)(".pf-vega-view-status",this.wrapper?.error??"Error"))}}}return Wc}var Ld,Fd={};function Ud(){if(!Ld){Ld=1,Object.defineProperty(Fd,"__esModule",{value:!0}),Fd.addEphemeralTab=function(e,t){t=t+"#"+(0,r.uuidv4)();n.globals.tabManager.registerTab({uri:t,content:new a.BottomTabToTabAdapter(e),isEphemeral:!0}),n.globals.dispatch(i.Actions.showTab({uri:t}))};const r=P(),n=oe(),a=ms(),i=ne()}return Fd}var Bd,jd={};var Hd,Gd,Vd,Wd={};function qd(){return Hd||(Hd=1,Object.defineProperty(Wd,"__esModule",{value:!0}),Wd.stringifyJsonWithBigints=function(e){return JSON.stringify(e,(e,t)=>"bigint"==typeof t?t.toString():t)}),Wd}function $d(){if(Gd)return Vc;Gd=1,Object.defineProperty(Vc,"__esModule",{value:!0}),Vc.HistogramTab=void 0,Vc.addHistogramTab=function(e,t){e=new c({config:e,engine:t,uuid:(0,r.uuidv4)()});(0,i.addEphemeralTab)(e,"histogramTab")};const e=or.__importDefault(ae()),t=F(),r=P();var n=Pl();const a=xd(),i=Ud(),o=function(){if(!Bd){Bd=1,Object.defineProperty(jd,"__esModule",{value:!0}),jd.HistogramState=void 0;const n=ie();jd.HistogramState=class{sqlColumn;engine;query;data;chartConfig;get isLoading(){return void 0===this.data}constructor(e,t,r){this.engine=e,this.query=t,this.sqlColumn=r,this.chartConfig={binAxis:"x",binAxisType:"nominal",countAxis:"y",sort:"false",isBinned:!0,labelLimit:500},this.getData()}async getData(){for(var e=[],t=(await this.engine.query(`
      SELECT ${this.sqlColumn}
      FROM (
        ${this.query}
      )
    `)).iter({});t.valid();t.next()){var r=t.get(this.sqlColumn);"nominal"===this.chartConfig.binAxisType&&"bigint"==typeof r&&(this.chartConfig.binAxisType="quantitative"),e.push({[this.sqlColumn]:r})}this.data=e,"nominal"===this.chartConfig.binAxisType&&(this.chartConfig.binAxis="y",this.chartConfig.countAxis="x",this.chartConfig.sort=`{
          "op": "count",
          "order": "descending"
        }`,this.chartConfig.isBinned=!1),n.raf.scheduleFullRedraw()}}}return jd}(),s=qd(),l=te();class c extends n.BottomTab{static kind="dev.perfetto.HistogramTab";state;constructor(e){super(e),this.state=new o.HistogramState(this.engine,this.config.query,this.config.sqlColumn)}static create(e){return new c(e)}viewTab(){return(0,e.default)(t.DetailsShell,{title:this.getTitle(),description:this.getDescription()},(0,e.default)(".histogram",(0,e.default)(a.VegaView,{spec:`
            {
              "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
              "mark": "bar",
              "data": {
                "values": ${this.state.data?(0,s.stringifyJsonWithBigints)(this.state.data):[]}
              },
              "encoding": {
                "${this.state.chartConfig.binAxis}": {
                  "bin": ${this.state.chartConfig.isBinned},
                  "field": "${this.config.sqlColumn}",
                  "type": "${this.state.chartConfig.binAxisType}",
                  "title": "${this.config.columnTitle}",
                  "sort": ${this.state.chartConfig.sort},
                  "axis": {
                    "labelLimit": ${this.state.chartConfig.labelLimit}
                  }
                },
                "${this.state.chartConfig.countAxis}": {
                  "aggregate": "count",
                  "title": "Count"
                }
              }
            }
          `,data:{}})))}getTitle(){return this.toTitleCase(this.config.columnTitle)+" "+("quantitative"===this.state.chartConfig.binAxisType?"Histogram":"Counts")}getDescription(){let e=`Count distribution for ${this.config.tableDisplay??""} table`;if(this.config.filters){var t=[];e+=" where ";for(const r of this.config.filters)t.push(""+((0,l.isString)(r)?r:r.argName+" "+r.op));e+=t.join(", ")}return e}toTitleCase(e){var t=e.split(/\s/);for(let e=0;e<t.length;++e)t[e]=t[e][0].toUpperCase()+t[e].substring(1);return t.join(" ")}isLoading(){return this.state.isLoading}}return Vc.HistogramTab=c,Vc}function zd(){if(!Vd){Vd=1,Object.defineProperty(mc,"__esModule",{value:!0}),mc.SqlTable=void 0;const i=or.__importDefault(ae()),n=te(),a=X(),o=se(),t=yc(),s=le(),l=vl(),r=$l(),c=function(){if(!vc){vc=1,Object.defineProperty(Ec,"__esModule",{value:!0}),Ec.ArgumentSelector=void 0;const e=or.__importDefault(ae()),a=ie(),i=Z(),o=D(),r=Cc(),n=$l(),s=hc();Ec.ArgumentSelector=class{argList;constructor({attrs:e}){this.load(e)}async load(e){for(var t=await e.engine.query(`
      -- Encapsulate the query in a CTE to avoid clashes between filters
      -- and columns of the 'args' table.
      WITH arg_sets AS (
        ${(0,o.constraintsToQueryPrefix)(e.constraints)}
        SELECT DISTINCT ${e.tableName}.${e.argSetId.name} as arg_set_id
        FROM ${e.tableName}
        ${(0,o.constraintsToQuerySuffix)(e.constraints)}
      )
      SELECT
        DISTINCT args.key as key
      FROM arg_sets
      JOIN args USING (arg_set_id)
    `),r=(this.argList=[],t.iter({key:i.STR}));r.valid();r.next()){var n=(0,s.argColumn)(e.tableName,e.argSetId,r.key);e.alreadySelectedColumns.has(n.alias)||this.argList.push(r.key)}a.raf.scheduleFullRedraw()}view({attrs:t}){return void 0===this.argList?(0,e.default)(n.Spinner):(0,e.default)(r.FilterableSelect,{values:this.argList,onSelected:e=>t.onArgumentSelected(e),maxDisplayedItems:15,autofocusInput:!0})}}}return Ec}(),u=hc(),d=Hc(),f=pc(),p=Gl(),h=$d();mc.SqlTable=class{table;engine;state;constructor(e){this.state=e.attrs.state,this.table=this.state.table,this.engine=this.state.engine}renderFilters(){var e=[];for(const r of this.state.getFilters()){var t=(0,n.isString)(r)?r:`Arg(${r.argName}) `+r.op;e.push((0,i.default)(s.Button,{label:t,icon:"close",intent:p.Intent.Primary,onclick:()=>{this.state.removeFilter(r)}}))}return e}renderAddColumnOptions(t){var e=new Set;for(const n of this.state.getSelectedColumns())e.add(n.alias);var r=[];for(const a of this.table.columns)e.has(a.name)||((0,f.isArgSetIdColumn)(a)?r.push((0,i.default)(l.MenuItem,{label:a.name},(0,i.default)(c.ArgumentSelector,{engine:this.engine,argSetId:a,tableName:this.table.name,constraints:this.state.getQueryConstraints(),alreadySelectedColumns:e,onArgumentSelected:e=>{t((0,u.argColumn)(this.table.name,a,e))}}))):r.push((0,i.default)(l.MenuItem,{label:a.name,onclick:()=>t((0,u.columnFromSqlTableColumn)(a))})));return r}renderColumnHeader(e,t){var r=this.state.isSortedBy(e),n="ASC"===r?a.Icons.SortedAsc:"DESC"===r?a.Icons.SortedDesc:a.Icons.ContextMenu;return(0,i.default)(l.PopupMenu2,{trigger:(0,i.default)(o.Anchor,{icon:n},e.title)},"DESC"!==r&&(0,i.default)(l.MenuItem,{label:"Sort: highest first",icon:a.Icons.SortedDesc,onclick:()=>{this.state.sortBy({column:e,direction:"DESC"})}}),"ASC"!==r&&(0,i.default)(l.MenuItem,{label:"Sort: lowest first",icon:a.Icons.SortedAsc,onclick:()=>{this.state.sortBy({column:e,direction:"ASC"})}}),void 0!==r&&(0,i.default)(l.MenuItem,{label:"Unsort",icon:a.Icons.Close,onclick:()=>this.state.unsort()}),1<this.state.getSelectedColumns().length&&(0,i.default)(l.MenuItem,{label:"Hide",icon:a.Icons.Hide,onclick:()=>this.state.hideColumnAtIndex(t)}),(0,i.default)(l.MenuItem,{label:"Create histogram",icon:a.Icons.Chart,onclick:()=>{(0,h.addHistogramTab)({sqlColumn:e.alias,columnTitle:e.title,filters:this.state.getFilters(),tableDisplay:this.table.displayName,query:this.state.buildSqlSelectStatement().selectStatement},this.engine)}}),(0,i.default)(l.MenuDivider),(0,i.default)(l.MenuItem,{label:"Add column",icon:a.Icons.AddColumn},this.renderAddColumnOptions(e=>{this.state.addColumn(e,t)})))}view(){var e=this.state.getDisplayedRows();return[(0,i.default)("div",this.renderFilters()),(0,i.default)(t.BasicTable,{data:e,columns:this.state.getSelectedColumns().map((t,e)=>({title:this.renderColumnHeader(t,e),render:e=>(0,d.renderCell)(t,e,this.state)}))}),this.state.isLoading()&&(0,i.default)(r.Spinner),void 0!==this.state.getQueryError()&&(0,i.default)(".query-error",this.state.getQueryError())]}}}return mc}var Kd,Yd,Jd,Zd,Qd={},Xd={};function ef(){if(!Kd){Kd=1,Object.defineProperty(Xd,"__esModule",{value:!0}),Xd.FormLabel=Xd.Form=void 0;const c=or.__importDefault(ae()),u=le(),d=bl(),f=Gl();Xd.Form=class{view({attrs:e,children:t}){const{submitIcon:r=void 0,submitLabel:n="Submit",cancelLabel:a,resetLabel:i,onSubmit:o=()=>{},preventDefault:s=!0,...l}=e;return(0,c.default)("form.pf-form",l,t,(0,c.default)(".pf-form-button-bar",(0,c.default)(u.Button,{type:"submit",label:n,rightIcon:r,className:d.Popup.DISMISS_POPUP_GROUP_CLASS,intent:f.Intent.Primary,onclick:e=>{s&&e.preventDefault(),o()}}),a&&(0,c.default)(u.Button,{type:"button",label:a,className:d.Popup.DISMISS_POPUP_GROUP_CLASS}),i&&(0,c.default)(u.Button,{label:i,type:"reset"})))}};Xd.FormLabel=class{view({attrs:e,children:t}){return(0,c.default)("label.pf-form-label",e,t)}}}return Xd}function tf(){if(!Yd){Yd=1,Object.defineProperty(Qd,"__esModule",{value:!0}),Qd.AddDebugTrackMenu=void 0,Qd.uuidToViewName=function(e){return"view_"+e.split("-").join("_")};const n=or.__importDefault(ae()),t=hl(),r=ie(),a=ef(),i=Cc(),o=Oc(),s=$f(),l=oe(),c="TRACK_NAME_FIELD";Qd.AddDebugTrackMenu=class{columns;name="";trackType="slice";renderParams;constructor(e){this.columns=[...e.attrs.dataSource.columns];e=e=>{for(const t of this.columns)if(t===e)return t;for(const r of this.columns)if(r.endsWith("_"+e))return r;return"dur"===e?"0":this.columns[0]};this.renderParams={ts:e("ts"),dur:e("dur"),name:e("name"),value:e("value"),pivot:""}}oncreate({dom:e}){this.focusTrackNameField(e)}focusTrackNameField(e){e=(0,t.findRef)(e,c);e&&e instanceof HTMLInputElement&&e.focus()}renderTrackTypeSelect(){var e=[];for(const t of["slice","counter"])e.push((0,n.default)("option",{value:t,selected:this.trackType===t||void 0},t));return(0,n.default)(i.Select,{id:"track_type",oninput:e=>{e.target&&(this.trackType=e.target.value,r.raf.scheduleFullRedraw())}},e)}view(e){var t=t=>{var e=[];"pivot"===t&&e.push((0,n.default)("option",{selected:""===this.renderParams[t]||void 0},(0,n.default)("i","")));for(const r of this.columns)e.push((0,n.default)("option",{selected:this.renderParams[t]===r||void 0},r));return"dur"===t&&e.push((0,n.default)("option",{selected:"0"===this.renderParams[t]||void 0},(0,n.default)("i","0"))),[(0,n.default)(a.FormLabel,{for:t},t),(0,n.default)(i.Select,{id:t,oninput:e=>{e.target&&(this.renderParams[t]=e.target.value)}},e)]};return(0,n.default)(a.Form,{onSubmit:()=>{switch(this.trackType){case"slice":const n={ts:this.renderParams.ts,dur:this.renderParams.dur,name:this.renderParams.name};this.renderParams.pivot?(0,s.addPivotedTracks)({engine:e.attrs.engine,registerTrack:e=>l.globals.trackManager.registerTrack(e)},e.attrs.dataSource,this.name,this.renderParams.pivot,async(e,t,r)=>(0,s.addDebugSliceTrack)(e,t,r,n,this.columns)):(0,s.addDebugSliceTrack)({engine:e.attrs.engine,registerTrack:e=>l.globals.trackManager.registerTrack(e)},e.attrs.dataSource,this.name,n,this.columns);break;case"counter":const a={ts:this.renderParams.ts,value:this.renderParams.value};this.renderParams.pivot?(0,s.addPivotedTracks)({engine:e.attrs.engine,registerTrack:e=>l.globals.trackManager.registerTrack(e)},e.attrs.dataSource,this.name,this.renderParams.pivot,async(e,t,r)=>(0,s.addDebugCounterTrack)(e,t,r,a)):(0,s.addDebugCounterTrack)({engine:e.attrs.engine,registerTrack:e=>l.globals.trackManager.registerTrack(e)},e.attrs.dataSource,this.name,a)}},submitLabel:"Show"},(0,n.default)(a.FormLabel,{for:"track_name"},"Track name"),(0,n.default)(o.TextInput,{id:"track_name",ref:c,onkeydown:e=>{e.key},oninput:e=>{e.target&&(this.name=e.target.value)}}),(0,n.default)(a.FormLabel,{for:"track_type"},"Track type"),this.renderTrackTypeSelect(),t("ts"),"slice"===this.trackType&&t("dur"),"slice"===this.trackType&&t("name"),"counter"===this.trackType&&t("value"),t("pivot"))}}}return Qd}function rf(){if(Jd)return rc;Jd=1,Object.defineProperty(rc,"__esModule",{value:!0}),rc.SqlTableTab=void 0,rc.addSqlTableTab=function(e){e=new m({config:e,engine:function(){var e=h.globals.getCurrentEngine(),e=(0,r.assertExists)(e).id;return(0,r.assertExists)(h.globals.engines.get(e)).getProxy("QueryResult")}(),uuid:(0,d.uuidv4)()});(0,f.addEphemeralTab)(e,"sqlTable")};const n=or.__importDefault(ae()),a=Ws(),i=X(),o=z(),s=le(),l=F(),c=bl(),t=function(){if(!uc){uc=1,Object.defineProperty(ic,"__esModule",{value:!0}),ic.SqlTableState=void 0;const t=sc(),a=te(),i=J(),r=ie(),n=Z(),o=D(),s=hc(),l=pc();ic.SqlTableState=class{engine_;table_;additionalImports;get engine(){return this.engine_}get table(){return this.table_}filters;columns;orderBy;offset=0;data;rowCount;constructor(e,t,r,n){this.engine_=e,this.table_=t,this.additionalImports=n||[],this.filters=r||[],this.columns=[];for(const a of this.table.columns)(0,l.startsHidden)(a)||this.columns.push((0,s.columnFromSqlTableColumn)(a));this.orderBy=[],this.reload()}getSQLProjections(){var e=[],t=new Set;for(const r of this.columns)for(const n of(0,s.sqlProjectionsForColumn)(r))t.has(n.alias)||(t.add(n.alias),e.push(n));return e}getQueryConstraints(){var e,t={commonTableExpressions:{},joins:[],filters:[]};let r=0;for(const n of this.filters)(0,a.isString)(n)?t.filters.push(n):(e="arg_sets_"+r++,t.commonTableExpressions[e]=`
          SELECT DISTINCT arg_set_id
          FROM args
          WHERE key = ${(0,i.sqliteString)(n.argName)}
            AND display_value ${n.op}
        `,t.joins.push(`JOIN ${e} ON ${e}.arg_set_id = ${this.table.name}.`+n.argSetIdColumn));return t}getSQLImports(){return[...this.table.imports||[],...this.additionalImports].map(e=>`INCLUDE PERFETTO MODULE ${e};`).join("\n")}getCountRowsSQLQuery(){var e=this.getQueryConstraints();return`
      ${this.getSQLImports()}

      ${(0,o.constraintsToQueryPrefix)(e)}
      SELECT
        COUNT() AS count
      FROM ${this.table.name}
      ${(0,o.constraintsToQuerySuffix)(e)}
    `}buildSqlSelectStatement(){var e=this.getSQLProjections(),t=this.orderBy.map(e=>({fieldName:e.column.alias,direction:e.direction})),r=this.getQueryConstraints(),t=(r.orderBy=t,`
      ${(0,o.constraintsToQueryPrefix)(r)}
      SELECT
        ${e.map(s.formatSqlProjection).join(",\n")}
      FROM ${this.table.name}
      ${(0,o.constraintsToQuerySuffix)(r)}
    `);return{selectStatement:t,columns:e.map(e=>e.alias)}}getNonPaginatedSQLQuery(){return`
      ${this.getSQLImports()}

      ${this.buildSqlSelectStatement().selectStatement}
    `}getPaginatedSQLQuery(){return`
      ${this.getNonPaginatedSQLQuery()}
      LIMIT 101
      OFFSET ${this.offset}
    `}canGoForward(){return void 0!==this.data&&100<this.data.rows.length}canGoBack(){return void 0!==this.data&&0<this.offset}goForward(){this.canGoForward()&&(this.offset+=100,this.reload({offset:"keep"}))}goBack(){this.canGoBack()&&(this.offset-=100,this.reload({offset:"keep"}))}getDisplayedRange(){if(void 0!==this.data)return{from:this.offset+1,to:this.offset+Math.min(this.data.rows.length,100)}}async loadRowCount(){var e=Array.from(this.filters),t=await this.engine.query(this.getCountRowsSQLQuery());if(void 0===t.error())return{count:t.firstRow({count:n.NUM}).count,filters:e}}async loadData(){for(var e=await this.engine.query(this.getPaginatedSQLQuery()),t=[],r=e.iter({});r.valid();r.next()){var n={};for(const a of e.columns())n[a]=r.get(a);t.push(n)}return{rows:t,error:e.error()}}async reload(e){"reset"===(e?.offset??"reset")&&(this.offset=0);e=this.rowCount?.filters,e=e&&(0,t.arrayEquals)(e,this.filters);this.data=void 0,e||(this.rowCount=void 0),setTimeout(()=>r.raf.scheduleFullRedraw(),50),e||(this.rowCount=await this.loadRowCount()),this.data=await this.loadData(),r.raf.scheduleFullRedraw()}getTotalRowCount(){return this.rowCount?.count}getDisplayedRows(){return this.data?.rows||[]}getQueryError(){return this.data?.error}isLoading(){return void 0===this.data}removeFilter(t){this.filters=this.filters.filter(e=>e!==t),this.reload()}addFilter(e){this.filters.push(e),this.reload()}getFilters(){return this.filters}sortBy(t){this.orderBy=this.orderBy.filter(e=>e.column!==t.column),this.orderBy.unshift(t),this.reload()}unsort(){this.orderBy=[],this.reload()}isSortedBy(e){if(0!==this.orderBy.length&&this.orderBy[0].column===e)return this.orderBy[0].direction}addColumn(e,t){this.columns.splice(t+1,0,e),this.reload({offset:"keep"})}hideColumnAtIndex(e){const t=this.columns[e];this.columns.splice(e,1),this.orderBy=this.orderBy.filter(e=>e.column!==t),this.reload({offset:"keep"})}getSelectedColumns(){return this.columns}}}return ic}(),u=zd(),e=pc(),r=ee(),d=P(),f=Ud();var p=Pl();const h=oe(),g=tf();class m extends p.BottomTab{static kind="dev.perfetto.SqlTableTab";state;constructor(e){super(e),this.state=new t.SqlTableState(this.engine,this.config.table,this.config.filters,this.config.imports)}static create(e){return new m(e)}viewTab(){var e=this.state.getDisplayedRange(),t=this.state.getTotalRowCount(),e=[(0,o.exists)(e)&&(0,o.exists)(t)&&`Showing rows ${e.from}-${e.to} of `+t,(0,n.default)(s.Button,{icon:i.Icons.GoBack,disabled:!this.state.canGoBack(),onclick:()=>this.state.goBack()}),(0,n.default)(s.Button,{icon:i.Icons.GoForward,disabled:!this.state.canGoForward(),onclick:()=>this.state.goForward()})],{selectStatement:t,columns:r}=this.state.buildSqlSelectStatement(),t=(0,n.default)(c.Popup,{trigger:(0,n.default)(s.Button,{label:"Show debug track"}),position:c.PopupPosition.Top},(0,n.default)(g.AddDebugTrackMenu,{dataSource:{sqlSource:t,columns:r},engine:this.engine}));return(0,n.default)(l.DetailsShell,{title:"Table",description:this.getDisplayName(),buttons:[...e,t,(0,n.default)(s.Button,{label:"Copy SQL query",onclick:()=>(0,a.copyToClipboard)(this.state.getNonPaginatedSQLQuery())})]},(0,n.default)(u.SqlTable,{state:this.state}))}getTitle(){var e=this.state.getTotalRowCount(),e=void 0===e?"":` (${e})`;return"Table "+this.getDisplayName()+e}getDisplayName(){return this.config.displayName??(0,e.tableDisplayName)(this.config.table)}isLoading(){return this.state.isLoading()}}return rc.SqlTableTab=m,rc}function nf(){if(!Zd){Zd=1,Object.defineProperty(Dl,"__esModule",{value:!0}),Dl.renderArguments=function(e,t){if(0<t.length)return t=(0,n.convertArgsToTree)(t),function o(s,e){return e.map(e=>{const{key:t,value:r,children:n}=e;if(n&&1===n.length){const a=n[0],i={...a,key:d(t,a.key)};return o(s,[i])}return(0,f.default)(m.TreeNode,{left:l(s,d(t),r),right:(0,p.exists)(r)&&c(r),summary:n&&u(n)},n&&o(s,n))})}(e,t)},Dl.hasArgs=function(e){return(0,p.exists)(e)&&0<e.length};const f=or.__importDefault(ae()),r=te(),i=X(),o=J(),p=z(),n=Ll(),s=Ql(),h=se(),g=vl(),m=ce(),_=oe(),y=rf(),T=ga();function l(e,t,r){if(void 0===r)return t;{const{key:n,displayValue:a}=r;return(0,f.default)(g.PopupMenu2,{trigger:(0,f.default)(h.Anchor,{icon:i.Icons.ContextMenu},t)},(0,f.default)(g.MenuItem,{label:"Copy full key",icon:"content_copy",onclick:()=>navigator.clipboard.writeText(n)}),(0,f.default)(g.MenuItem,{label:"Find slices with same arg value",icon:"search",onclick:()=>{(0,y.addSqlTableTab)({table:T.SqlTables.slice,filters:[{type:"arg_filter",argSetIdColumn:"arg_set_id",argName:n,op:"= "+(0,o.sqliteString)(a)}]})}}),(0,f.default)(g.MenuItem,{label:"Visualise argument values",icon:"query_stats",onclick:()=>{(0,s.addVisualisedArgTracks)({engine:e,registerTrack:e=>_.globals.trackManager.registerTrack(e)},n)}}))}}function c({value:e}){return t=e,(0,r.isString)(t)&&(t.startsWith("http://")||t.startsWith("https://"))?(t=e,(0,f.default)(h.Anchor,{href:t,target:"_blank",icon:"open_in_new"},t)):""+e;var t}function u(e){var t=e.slice(0,2).map(({key:e})=>e).join(", "),e=e.length-2;return 0<e?`{${t}, ... (${e} more items)}`:`{${t}}`}function d(...e){return e.map((e,t)=>"number"==typeof e?`[${e}]`:(0===t?"":".")+e).join("")}}return Dl}var af,of={},sf={};function lf(){if(!af){af=1,Object.defineProperty(sf,"__esModule",{value:!0}),sf.getArgs=async function(e,t){var e=await e.query(`
    SELECT
      id,
      type,
      flat_key as flatKey,
      key,
      int_value as intValue,
      string_value as stringValue,
      real_value as realValue,
      value_type as valueType,
      display_value as displayValue
    FROM args
    WHERE arg_set_id = ${t}
    ORDER BY id`),r=e.iter({id:i.NUM,type:i.STR,flatKey:i.STR,key:i.STR,intValue:i.LONG_NULL,stringValue:i.STR_NULL,realValue:i.NUM_NULL,valueType:i.STR,displayValue:i.STR_NULL}),n=[];for(;r.valid();r.next()){var a=function(e,t){switch(e){case"int":case"uint":return t.intValue;case"pointer":return null===t.intValue?null:"0x"+t.intValue.toString(16);case"string":return t.stringValue;case"bool":return!!t.intValue;case"real":return t.realValue;case"null":return null;default:throw new Error("Unable to process arg of type "+e)}}(r.valueType,r);n.push({id:(0,o.asArgId)(r.id),type:r.type,flatKey:r.flatKey,key:r.key,value:a,displayValue:r.displayValue??"NULL"})}return n};const i=Z(),o=Nc()}return sf}var cf,uf,df,ff={},pf={};function hf(){if(!cf){cf=1,Object.defineProperty(pf,"__esModule",{value:!0}),pf.getProcessInfo=async function(e,t){e=await e.query(`
    include perfetto module android.process_metadata;
    select
      p.upid,
      p.pid,
      p.name,
      p.uid,
      m.package_name as packageName,
      m.version_code as versionCode
    from process p
    left join android_process_metadata m using (upid)
    where upid = ${t};
  `),e=e.firstRow({upid:r.NUM,pid:r.NUM,name:r.STR_NULL,uid:r.NUM_NULL,packageName:r.STR_NULL,versionCode:r.NUM_NULL});return{upid:t,pid:e.pid,name:e.name??void 0,uid:(0,n.fromNumNull)(e.uid),packageName:e.packageName??void 0,versionCode:(0,n.fromNumNull)(e.versionCode)}},pf.getProcessName=function(e){return function(e,t){return void 0!==e?void 0===t?e:e+` [${t}]`:void 0===t?void 0:""+t}(e?.name,e?.pid)};const r=Z(),n=D()}return pf}function gf(){if(!uf){uf=1,Object.defineProperty(ff,"__esModule",{value:!0}),ff.getThreadInfo=async function(e,t){var r=(await e.query(`
        SELECT tid, name, upid
        FROM thread
        WHERE utid = ${t};
    `)).iter({tid:a.NUM,name:a.STR_NULL,upid:a.NUM_NULL});if(!r.valid())return{utid:t};var n=(0,i.fromNumNull)(r.upid);return{utid:t,tid:r.tid,name:r.name??void 0,process:n?await(0,o.getProcessInfo)(e,n):void 0}},ff.getThreadName=t,ff.getFullThreadName=function(e){return void 0!==e?.process?t(e)+" "+(0,o.getProcessName)(e.process):t(e)};const a=Z(),i=D(),o=hf();function t(e){return t=e?.name,e=e?.tid,void 0===t?void 0===e?void 0:""+e:void 0===e?t:t+` [${e}]`;var t}}return ff}function mf(){if(!df){df=1,Object.defineProperty(of,"__esModule",{value:!0}),of.getSliceFromConstraints=o,of.getSlice=s,of.getDescendantSliceTree=async function(e,t){const r=await s(e,t);if(void 0===r)return;var e=await o(e,{filters:["track_id="+r.trackId,"depth >= "+r.depth,"ts >= "+r.ts,0<=r.dur?`ts <= (${r.ts} + ${r.dur})`:void 0],orderBy:["ts","depth"]}),n=Object.fromEntries(e.map(e=>[e.id,{children:[],...e}]));for(const[i,r]of Object.entries(n)){var a;void 0!==r.parentId&&(a=n[r.parentId],(r.parent=a).children.push(r))}return n[t]};const u=K(),d=z(),f=Z(),p=D(),h=Nc(),g=lf(),m=gf(),_=hf();async function o(e,t){for(var r,n,a=(await e.query(`
    SELECT
      id,
      name,
      ts,
      dur,
      track_id as trackId,
      depth,
      parent_id as parentId,
      thread_dur as threadDur,
      thread_ts as threadTs,
      category,
      arg_set_id as argSetId,
      ABS_TIME_STR(ts) as absTime
    FROM slice
    `+(0,p.constraintsToQuerySuffix)(t))).iter({id:f.NUM,name:f.STR,ts:f.LONG,dur:f.LONG,trackId:f.NUM,depth:f.NUM,parentId:f.NUM_NULL,threadDur:f.LONG_NULL,threadTs:f.LONG_NULL,category:f.STR_NULL,argSetId:f.NUM,absTime:f.STR_NULL}),i=[];a.valid();a.next()){s=e,c=a.trackId,n=o=l=r=void 0,l=(await s.query(`
    WITH
       leafTrackTable AS (SELECT type FROM track WHERE id = ${c}),
       cols AS (
            SELECT name
            FROM pragma_table_info((SELECT type FROM leafTrackTable))
        )
    SELECT
       type as leafTrackTable,
      'upid' in cols AS hasUpid,
      'utid' in cols AS hasUtid
    FROM leafTrackTable
  `)).firstRow({hasUpid:f.NUM,hasUtid:f.NUM,leafTrackTable:f.STR}),o=0!==l.hasUpid,n={},0!==l.hasUtid?(r=(await s.query(`
        SELECT utid
        FROM ${l.leafTrackTable}
        WHERE id = ${c};
    `)).firstRow({utid:f.NUM}).utid,n.utid=(0,h.asUtid)(r)):o&&(r=(await s.query(`
        SELECT upid
        FROM ${l.leafTrackTable}
        WHERE id = ${c};
    `)).firstRow({upid:f.NUM}).upid,n.upid=(0,h.asUpid)(r));var{utid:o,upid:s}=await n,l=void 0===o?void 0:await(0,m.getThreadInfo)(e,o),c=void 0!==l?l.process:void 0===s?void 0:await(0,_.getProcessInfo)(e,s);i.push({id:(0,h.asSliceSqlId)(a.id),name:a.name,ts:u.Time.fromRaw(a.ts),dur:a.dur,trackId:a.trackId,depth:a.depth,parentId:(0,h.asSliceSqlId)(a.parentId??void 0),thread:l,process:c,threadDur:a.threadDur??void 0,threadTs:(0,d.exists)(a.threadTs)?u.Time.fromRaw(a.threadTs):void 0,category:a.category??void 0,args:await(0,g.getArgs)(e,(0,h.asArgSetId)(a.argSetId)),absTime:a.absTime??void 0})}return i}async function s(e,t){e=await o(e,{filters:["id="+t]});if(1<e.length)throw new Error("slice table has more than one row with id "+t);if(0!==e.length)return e[0]}}return of}var _f,yf={},Tf={};function bf(){if(!_f){_f=1,Object.defineProperty(Tf,"__esModule",{value:!0}),Tf.translateState=function(t,e=void 0){if(void 0===t)return"";switch(t){case"Running":case"Initialized":case"Deferred Ready":case"Transition":case"Stand By":case"Waiting":return t}if(null===t)return"Unknown";let r=n[t[0]];!0===e?r+=" (IO)":!1===e&&(r+=" (non-IO)");for(let e=1;e<t.length;e++)r=(r+="+"===t[e]?" ":" + ")+n[t[e]];return void 0===r?t:r};const n={R:"Runnable",S:"Sleeping",D:"Uninterruptible Sleep",T:"Stopped",t:"Traced",X:"Exit (Dead)",Z:"Exit (Zombie)",x:"Task Dead",I:"Idle",K:"Wake Kill",W:"Waking",P:"Parked",N:"No Load","+":"(Preempted)"}}return Tf}var vf,Ef,e={};function Q(){return vf||(vf=1,Object.defineProperty(e,"__esModule",{value:!0}),e.CPUSS_ESTIMATE_TRACK_KIND=e.COUNTER_TRACK_KIND=e.PERF_SAMPLES_PROFILE_TRACK_KIND=e.ASYNC_SLICE_TRACK_KIND=e.ACTUAL_FRAMES_SLICE_TRACK_KIND=e.EXPECTED_FRAMES_SLICE_TRACK_KIND=e.THREAD_SLICE_TRACK_KIND=e.THREAD_STATE_TRACK_KIND=e.CPU_SLICE_TRACK_KIND=void 0,e.CPU_SLICE_TRACK_KIND="CpuSliceTrack",e.THREAD_STATE_TRACK_KIND="ThreadStateTrack",e.THREAD_SLICE_TRACK_KIND="ThreadSliceTrack",e.EXPECTED_FRAMES_SLICE_TRACK_KIND="ExpectedFramesSliceTrack",e.ACTUAL_FRAMES_SLICE_TRACK_KIND="ActualFramesSliceTrack",e.ASYNC_SLICE_TRACK_KIND="AsyncSliceTrack",e.PERF_SAMPLES_PROFILE_TRACK_KIND="PerfSamplesProfileTrack",e.COUNTER_TRACK_KIND="CounterTrack",e.CPUSS_ESTIMATE_TRACK_KIND="CpuSubsystemEstimateTrack"),e}function Sf(){if(!Ef){Ef=1,Object.defineProperty(yf,"__esModule",{value:!0}),yf.getThreadStateFromConstraints=r,yf.getThreadState=async function(e,t){e=await r(e,{filters:["id="+t]});if(1<e.length)throw new Error("thread_state table has more than one row with id "+t);if(0!==e.length)return e[0]},yf.goToSchedSlice=function(e,t,r){let n;for(const i of Object.values(d.globals.state.tracks))if((0,s.exists)(i?.uri)){var a=d.globals.trackManager.resolveTrackInfo(i.uri);if(a?.tags?.kind===h.CPU_SLICE_TRACK_KIND&&a?.tags?.cpu===e){n=i.key;break}}void 0!==n&&(d.globals.setLegacySelection({kind:"SCHED_SLICE",id:t,trackKey:n},{clearSearch:!0,pendingScrollId:void 0,switchToCurrentSelectionTab:!0}),(0,f.scrollToTrackAndTs)(n,r))};const o=K(),s=z(),l=bf(),c=Z(),u=D(),d=oe(),f=Bc(),p=Nc(),h=Q(),g=gf();async function r(e,t){for(var r=(await e.query(`
    SELECT
      thread_state.id as threadStateSqlId,
      (select sched.id
        from sched
        where sched.ts=thread_state.ts and sched.utid=thread_state.utid
        limit 1
       ) as schedSqlId,
      ts,
      thread_state.dur as dur,
      thread_state.cpu as cpu,
      state,
      thread_state.blocked_function as blockedFunction,
      io_wait as ioWait,
      thread_state.utid as utid,
      waker_utid as wakerUtid
    FROM thread_state
    `+(0,u.constraintsToQuerySuffix)(t))).iter({threadStateSqlId:c.NUM,schedSqlId:c.NUM_NULL,ts:c.LONG,dur:c.LONG,cpu:c.NUM_NULL,state:c.STR_NULL,blockedFunction:c.STR_NULL,ioWait:c.NUM_NULL,utid:c.NUM,wakerUtid:c.NUM_NULL}),n=[];r.valid();r.next()){var a=null===r.ioWait?void 0:0<r.ioWait,i=(0,p.asUtid)(r.wakerUtid??void 0);n.push({threadStateSqlId:r.threadStateSqlId,schedSqlId:(0,u.fromNumNull)(r.schedSqlId),ts:o.Time.fromRaw(r.ts),dur:r.dur,cpu:(0,u.fromNumNull)(r.cpu),state:(0,l.translateState)(r.state??void 0,a),blockedFunction:r.blockedFunction??void 0,thread:await(0,g.getThreadInfo)(e,(0,p.asUtid)(r.utid)),wakerThread:i?await(0,g.getThreadInfo)(e,i):void 0})}return n}}return yf}var Af,Of={};function Cf(){if(!Af){Af=1,Object.defineProperty(Of,"__esModule",{value:!0}),Of.GridLayoutColumn=Of.GridLayout=void 0;const t=or.__importDefault(ae());Of.GridLayout=class{view({children:e}){return(0,t.default)("div.pf-grid-layout",e)}};Of.GridLayoutColumn=class{view({children:e}){return(0,t.default)("div.pf-grid-layout-column",e)}}}return Of}var kf,wf={};function Rf(){if(!kf){kf=1,Object.defineProperty(wf,"__esModule",{value:!0}),wf.Section=void 0;const a=or.__importDefault(ae());wf.Section=class{view({attrs:e,children:t}){const{title:r,...n}=e;return(0,a.default)("section.pf-section",n,(0,a.default)("header",(0,a.default)("h1",r)),(0,a.default)("article",t))}}}return wf}var If,Mf,Pf,Nf={};function Df(){if(!If){If=1,Object.defineProperty(Nf,"__esModule",{value:!0}),Nf.ThreadStateRef=void 0,Nf.threadStateRef=function(e){return void 0===e.thread?null:(0,t.default)(n,{id:e.threadStateSqlId,ts:e.ts,dur:e.dur,utid:e.thread?.utid})};const t=or.__importDefault(ae()),e=se(),r=X(),a=oe(),i=Q(),o=ne(),s=Bc();class n{view(n){return(0,t.default)(e.Anchor,{icon:r.Icons.UpdateSelection,onclick:()=>{let e;for(const r of Object.values(a.globals.state.tracks)){var t=a.globals.trackManager.resolveTrackInfo(r.uri);t&&t.tags?.kind===i.THREAD_STATE_TRACK_KIND&&t.tags?.utid===n.attrs.utid&&(e=r.key)}e&&(a.globals.makeSelection(o.Actions.selectThreadState({id:n.attrs.id,trackKey:e.toString()})),(0,s.scrollToTrackAndTs)(e,n.attrs.ts,!0))}},n.attrs.name??"Thread State "+n.attrs.id)}}Nf.ThreadStateRef=n}return Nf}function xf(){if(!Mf){Mf=1;{var n=Il;Object.defineProperty(n,"__esModule",{value:!0}),n.DebugSliceDetailsTab=n.ARG_PREFIX=void 0;const i=or.__importDefault(ae()),o=K(),s=ie();var e=Pl();const t=nf(),l=mf(),c=Nc(),u=Sf(),d=L(),f=x(),p=Z(),h=D(),g=F(),m=Cf(),_=Rf(),y=ce(),r=Df(),T=gf(),b=hf(),v=jc();function a(e){return"bigint"==typeof e?Number(e):"number"==typeof e?e:void 0}n.ARG_PREFIX="arg_";class E extends e.BottomTab{static kind="dev.perfetto.DebugSliceDetailsTab";data;threadState;slice;static create(e){return new E(e)}async maybeLoadThreadState(e,t,r,n,a){return void 0!==e&&void 0!==a&&void 0!==(e=await(0,u.getThreadState)(this.engine,e))&&("thread_state"===n||e.ts===t&&e.dur===r&&e.thread?.utid===a)?e:void 0}renderThreadStateInfo(){return void 0===this.threadState?null:(0,i.default)(y.TreeNode,{left:(0,r.threadStateRef)(this.threadState),right:""},function(e){var t=[];for(const r of Object.keys(e))null!==e[r]&&void 0!==e[r]&&t.push((0,i.default)(y.TreeNode,{left:r,right:e[r]}));return t}({Thread:(0,T.getThreadName)(this.threadState.thread),Process:(0,b.getProcessName)(this.threadState.thread?.process),State:this.threadState.state}))}async maybeLoadSlice(e,t,r,n,a){return void 0!==e&&("slice"===n||void 0!==a)&&void 0!==(e=await(0,l.getSlice)(this.engine,(0,c.asSliceSqlId)(e)))&&("slice"===n||e.ts===t&&e.dur===r&&e.trackId===a)?e:void 0}renderSliceInfo(){return void 0===this.slice?null:(0,i.default)(y.TreeNode,{left:(0,v.sliceRef)(this.slice,"Slice"),right:""},(0,i.default)(y.TreeNode,{left:"Name",right:this.slice.name}),(0,i.default)(y.TreeNode,{left:"Thread",right:(0,T.getThreadName)(this.slice.thread)}),(0,i.default)(y.TreeNode,{left:"Process",right:(0,b.getProcessName)(this.slice.process)}),(0,t.hasArgs)(this.slice.args)&&(0,i.default)(y.TreeNode,{left:"Args"},(0,t.renderArguments)(this.engine,this.slice.args)))}async loadData(){var e,t=(await this.engine.query(`select * from ${this.config.sqlTableName} where id = `+this.config.id)).firstRow({ts:p.LONG,dur:p.LONG,name:p.STR});this.data={name:t.name,ts:o.Time.fromRaw(t.ts),dur:t.dur,args:{}};for(const r of Object.keys(t))r.startsWith(n.ARG_PREFIX)&&(this.data.args[r.substr(n.ARG_PREFIX.length)]=t[r]);this.threadState=await this.maybeLoadThreadState(a(this.data.args.id),this.data.ts,this.data.dur,(0,h.sqlValueToReadableString)(this.data.args.table_name),"bigint"==typeof(e=this.data.args.utid)?Number(e):"number"==typeof e?e:void 0),this.slice=await this.maybeLoadSlice(a(this.data.args.id)??a(this.data.args.slice_id),this.data.ts,this.data.dur,(0,h.sqlValueToReadableString)(this.data.args.table_name),a(this.data.args.track_id)),s.raf.scheduleRedraw()}constructor(e){super(e),this.loadData()}viewTab(){if(void 0===this.data)return(0,i.default)("h2","Loading");var e=(0,y.dictToTreeNodes)({Name:this.data.name,"Start time":(0,i.default)(f.Timestamp,{ts:(0,p.timeFromSql)(this.data.ts)}),Duration:(0,i.default)(d.DurationWidget,{dur:(0,p.durationFromSql)(this.data.dur)}),"Debug slice id":`${this.config.sqlTableName}[${this.config.id}]`}),t=(e.push(this.renderThreadStateInfo()),e.push(this.renderSliceInfo()),{});for(const r of Object.keys(this.data.args))t[r]=(0,h.sqlValueToReadableString)(this.data.args[r]);return(0,i.default)(g.DetailsShell,{title:"Debug Slice"},(0,i.default)(m.GridLayout,(0,i.default)(_.Section,{title:"Details"},(0,i.default)(y.Tree,e)),(0,i.default)(_.Section,{title:"Arguments"},(0,y.dictToTree)(t))))}getTitle(){return"Current Selection"}isLoading(){return void 0===this.data}}n.DebugSliceDetailsTab=E}}return Il}var Lf,Ff,Uf,Bf,jf,Hf={},Gf={},Vf={};function Wf(){return Lf||(Lf=1,Object.defineProperty(Vf,"__esModule",{value:!0}),Vf.search=r,Vf.searchEq=function(e,t,r){var r=i(e,t,r),[n,a]=r;return e[n]===t?r:[a,a]},Vf.searchRange=i,Vf.searchSegment=function(e,t){if(!e.length)return[-1,-1];t=r(e,t);return-1===t?[t,0]:t+1===e.length?[t,-1]:[t,t+1]}),Vf;function r(e,t){return function e(t,r,n,a){var i;return n===a?-1:n+1===a?r>=t[n]?n:-1:r<t[i=Math.floor((a-n)/2)+n]?e(t,r,n,i):e(t,r,i,a)}(e,t,0,e.length)}function i(e,t,r){var[r,n]=r||[0,e.length];return function e(t,r,n,a){if(n!==a){if(n+1===a)return t[n]<=r?[n,a]:[n,n];var i=Math.floor((a-n)/2)+n,o=t[i];if(r<o)return e(t,r,n,i);if(o<r)return e(t,r,i,a);for(;t[n]!==r;)n++;for(;t[a-1]!==r;)a--}return[n,a]}(e,t,r,n)}}function qf(){if(!Ff){Ff=1,Object.defineProperty(Gf,"__esModule",{value:!0}),Gf.BaseCounterTrack=void 0;const t=or.__importDefault(ae()),a=Wf(),w=ee(),R=K();var e=P();const I=Rs(),o=ie(),r=Bs(),n=le(),i=vl(),c=Z(),M=Ps(),u=V();class d{static singleton;static get(){return void 0===d.singleton&&(d.singleton=new d),d.singleton}tagToRange;keyToEnabled;constructor(){this.tagToRange=new Map,this.keyToEnabled=new Map}isEnabled(e){e=this.keyToEnabled.get(e);return void 0===e||e}setEnabled(e,t){this.keyToEnabled.set(e,t)}share(e,[t,r]){var n=e.yRangeSharingKey;return void 0!==n&&this.isEnabled(n)?(n=`${e.yRangeSharingKey}-${e.yMode}-${e.yDisplay}-`+!!e.enlarge,void 0===(e=this.tagToRange.get(n))?(this.tagToRange.set(n,[t,r]),[t,r]):(e[0]=Math.min(t,e[0]),e[1]=Math.max(r,e[1]),[e[0],e[1]])):[t,r]}}function s(e){var t=Math.ceil(Math.log10(Math.max(Math.abs(e),1))),t=Math.pow(10,t);return Math.sign(e)*(Math.ceil(Math.abs(e)/(t/20))*(t/20))}function l(e){if(0===e)return"0";var t=[[1e-9,"n"],[1e-6,"u"],[.001,"m"],[1,""],[1e3,"K"],[1e6,"M"],[1e9,"G"],[1e12,"T"]];let r,n;[r,n]=t[0];var a,i,o=Math.abs(e);for([a,i]of t){if(a>o)break;[r,n]=[a,i]}return""+Math.round(e/r)+n}Gf.BaseCounterTrack=class{engine;trackKey;trackUuid=(0,e.uuidv4Sql)();countersKey=r.CacheKey.zero();counters={timestamps:new BigInt64Array(0),minDisplayValues:new Float64Array(0),maxDisplayValues:new Float64Array(0),lastDisplayValues:new Float64Array(0),displayValueRange:[0,0]};limits;mousePos={x:0,y:0};hover;defaultOptions;options;trash;getCounterOptions(){if(void 0===this.options){var e,t,r=this.getDefaultCounterOptions();for([e,t]of Object.entries(this.defaultOptions))void 0!==t&&(r[e]=t);this.options=r}return this.options}async onInit(){}getDefaultCounterOptions(){return{yRange:"all",yRangeRounding:"human_readable",yMode:"value",yDisplay:"zero"}}constructor(e){this.engine=e.engine,this.trackKey=e.trackKey,this.defaultOptions=e.options??{},this.trash=new u.AsyncDisposableStack}getHeight(){return this.getCounterOptions().enlarge?160:40}getCounterContextMenuItems(){const r=this.getCounterOptions();return[(0,t.default)(i.MenuItem,{label:`Display (currently: ${r.yDisplay})`},(0,t.default)(i.MenuItem,{label:"Zero-based",icon:"zero"===r.yDisplay?"radio_button_checked":"radio_button_unchecked",onclick:()=>{r.yDisplay="zero",this.invalidate()}}),(0,t.default)(i.MenuItem,{label:"Min/Max",icon:"minmax"===r.yDisplay?"radio_button_checked":"radio_button_unchecked",onclick:()=>{r.yDisplay="minmax",this.invalidate()}}),(0,t.default)(i.MenuItem,{label:"Log",icon:"log"===r.yDisplay?"radio_button_checked":"radio_button_unchecked",onclick:()=>{r.yDisplay="log",this.invalidate()}})),(0,t.default)(i.MenuItem,{label:"Zoom on scroll",icon:"viewport"===r.yRange?"check_box":"check_box_outline_blank",onclick:()=>{r.yRange="viewport"===r.yRange?"all":"viewport",this.invalidate()}}),(0,t.default)(i.MenuItem,{label:"Enlarge",icon:r.enlarge?"check_box":"check_box_outline_blank",onclick:()=>{r.enlarge=!r.enlarge,this.invalidate()}}),r.yRangeSharingKey&&(0,t.default)(i.MenuItem,{label:`Share y-axis scale (group: ${r.yRangeSharingKey})`,icon:d.get().isEnabled(r.yRangeSharingKey)?"check_box":"check_box_outline_blank",onclick:()=>{var e,t=r.yRangeSharingKey;void 0!==t&&((e=d.get()).setEnabled(t,!e.isEnabled(t)),this.invalidate())}}),(0,t.default)(i.MenuDivider),(0,t.default)(i.MenuItem,{label:`Mode (currently: ${r.yMode})`},(0,t.default)(i.MenuItem,{label:"Value",icon:"value"===r.yMode?"radio_button_checked":"radio_button_unchecked",onclick:()=>{r.yMode="value",this.invalidate()}}),(0,t.default)(i.MenuItem,{label:"Delta",icon:"delta"===r.yMode?"radio_button_checked":"radio_button_unchecked",onclick:()=>{r.yMode="delta",this.invalidate()}}),(0,t.default)(i.MenuItem,{label:"Rate",icon:"rate"===r.yMode?"radio_button_checked":"radio_button_unchecked",onclick:()=>{r.yMode="rate",this.invalidate()}})),(0,t.default)(i.MenuItem,{label:"Round y-axis scale",icon:"human_readable"===r.yRangeRounding?"check_box":"check_box_outline_blank",onclick:()=>{r.yRangeRounding="human_readable"===r.yRangeRounding?"strict":"human_readable",this.invalidate()}})]}invalidate(){this.limits=void 0,this.countersKey=r.CacheKey.zero(),this.counters={timestamps:new BigInt64Array(0),minDisplayValues:new Float64Array(0),maxDisplayValues:new Float64Array(0),lastDisplayValues:new Float64Array(0),displayValueRange:[0,0]},this.hover=void 0,o.raf.scheduleFullRedraw()}getCounterContextMenu(){return(0,t.default)(i.PopupMenu2,{trigger:(0,t.default)(n.Button,{icon:"show_chart",compact:!0})},this.getCounterContextMenuItems())}getTrackShellButtons(){return this.getCounterContextMenu()}async onCreate(){var e=await this.onInit();e&&this.trash.use(e),this.limits=await this.createTableAndFetchLimits(!1)}async onUpdate({visibleWindow:e,size:t}){t=Math.max(1,t.width),e=e.toTimeSpan(),e=r.CacheKey.create(e.start,e.end,t);await this.maybeRequestData(e)}render({ctx:r,size:n,timescale:a}){var i=this.limits,o=this.counters;if(0!==o.timestamps.length&&void 0!==i){(0,w.assertTrue)(o.timestamps.length===o.minDisplayValues.length),(0,w.assertTrue)(o.timestamps.length===o.maxDisplayValues.length),(0,w.assertTrue)(o.timestamps.length===o.lastDisplayValues.length);var s=this.getCounterOptions(),l=o.timestamps,c=o.minDisplayValues,u=o.maxDisplayValues,d=o.lastDisplayValues;const{yRange:E,yMin:S,yMax:A,yLabel:O}=this.computeYRange(i,o.displayValueRange),C=this.getHeight()-3.5;var i=n.width,o=Math.ceil(Math.log10(Math.max(A,1))),o=Math.min(o-3,9),o=(180-Math.floor(30*o)+360)%360,f=(r.fillStyle=`hsl(${o}, 45%, 75%)`,r.strokeStyle=`hsl(${o}, 45%, 45%)`,e=>Math.floor(a.timeToPx(e))),p=e=>3.5+C-Math.round((e-S)/E*C),h;let e;e=0<=S?C+3.5:A<0?3.5:C*(A/(A-S))+3.5,r.beginPath();const k=R.Time.fromRaw(l[0]);r.moveTo(Math.max(0,f(k)),e);let t=e;for(let e=0;e<l.length;e++){const k=R.Time.fromRaw(l[e]);var g=Math.max(0,f(k)),m=p(c[e]),_=p(u[e]),y=p(d[e]);r.lineTo(g,t),m===_?(0,w.assertTrue)(y===m):(r.lineTo(g,m),r.lineTo(g,_)),r.lineTo(g,y),t=y}if(r.lineTo(i,t),r.lineTo(i,e),r.closePath(),r.fill(),r.stroke(),S<0&&0<A&&(r.strokeStyle=`hsl(${o}, 10%, 71%)`,r.beginPath(),r.setLineDash([2,4]),r.moveTo(0,e),r.lineTo(i,e),r.closePath(),r.stroke(),r.setLineDash([])),r.font="10px Roboto Condensed",void 0!==(h=this.hover)){let e=""+h.lastDisplayValue.toLocaleString();var T=this.unit;switch(s.yMode){case"value":e=e+" "+T;break;case"delta":e=e+" Δ"+T;break;case"rate":e+=` Δ${T}/s`;break;default:(0,w.assertUnreachable)(s.yMode)}r.fillStyle=`hsl(${o}, 45%, 75%)`,r.strokeStyle=`hsl(${o}, 45%, 45%)`;var o=f(h.ts),b=Math.max(0,o),v=void 0===h.tsEnd?i:Math.floor(a.timeToPx(h.tsEnd)),h=3.5+C-Math.round((h.lastDisplayValue-S)/E*C);r.beginPath(),r.moveTo(b,h),r.lineTo(v,h),r.lineWidth=3,r.stroke(),r.lineWidth=1,-6<=o&&(r.beginPath(),r.arc(b,h,3,0,2*Math.PI),r.fill(),r.stroke()),(0,I.drawTrackHoverTooltip)(r,this.mousePos,n,e)}r.fillStyle="rgba(255, 255, 255, 0.6)",r.fillRect(0,0,42,13),r.fillStyle="#666",r.textAlign="left",r.textBaseline="alphabetic",r.fillText(""+O,5,11),1/0<i&&(r.fillStyle="#0000001f",r.fillRect(1/0,0,i-1/0,this.getHeight()))}(0,M.checkerboardExcept)(r,this.getHeight(),0,n.width,a.timeToPx(this.countersKey.start),a.timeToPx(this.countersKey.end))}onMouseMove({x:e,y:t,timescale:r}){var n=this.counters;void 0!==n&&(this.mousePos={x:e,y:t},t=r.pxToHpTime(e),[r,e]=(0,a.searchSegment)(n.timestamps,t.toTime()),-1===r?this.hover=void 0:(t=R.Time.fromRaw(n.timestamps[r]),e=-1===e?void 0:R.Time.fromRaw(n.timestamps[e]),n=n.lastDisplayValues[r],this.hover={ts:t,tsEnd:e,lastDisplayValue:n}))}onMouseOut(){this.hover=void 0}async onDestroy(){await this.trash.asyncDispose()}computeYRange(e,t){var r=this.getCounterOptions();let n=e.minDisplayValue,a=e.maxDisplayValue;"viewport"===r.yRange&&([n,a]=t),"zero"===r.yDisplay&&(n=Math.min(0,n),a=Math.max(0,a)),void 0!==r.yOverrideMaximum&&(a=Math.max(r.yOverrideMaximum,a)),void 0!==r.yOverrideMinimum&&(n=Math.min(r.yOverrideMinimum,n)),"human_readable"===r.yRangeRounding&&(n="log"===r.yDisplay?(a=Math.log(s(Math.exp(a))),Math.log(s(Math.exp(n)))):(a=s(a),s(n)));e=d.get();[n,a]=e.share(r,[n,a]);let i;if("minmax"===r.yDisplay)i="min - max";else{let e=a,t=n;"log"===r.yDisplay&&(e=Math.exp(e),t=Math.exp(t)),i=e<0?l(t-e):l(e-t)}var o=this.unit;switch(r.yMode){case"value":i+=" "+o;break;case"delta":i+="Δ"+o;break;case"rate":i+=`Δ${o}/s`;break;default:(0,w.assertUnreachable)(r.yMode)}return"log"===r.yDisplay&&(i=`log(${i})`),{yMin:n,yMax:a,yLabel:i,yRange:a-n}}getValueExpression(){var e=this.getCounterOptions();let t;switch(e.yMode){case"value":t="value";break;case"delta":t="lead(value, 1, value) over (order by ts) - value";break;case"rate":t="(lead(value, 1, value) over (order by ts) - value) / ((lead(ts, 1, 100) over (order by ts) - ts) / 1e9)";break;default:(0,w.assertUnreachable)(e.yMode)}return"log"===e.yDisplay?`ifnull(ln(${t}), 0)`:t}getTableName(){return"counter_"+this.trackUuid}async maybeRequestData(e){if(!e.isCoveredBy(this.countersKey)){var n=e.normalize();if(!e.isCoveredBy(n))throw new Error(`Normalization error ${n.toString()} `+e.toString());void 0===this.limits&&(this.limits=await this.createTableAndFetchLimits(!0));var e=await this.engine.query(`
      SELECT
        min_value as minDisplayValue,
        max_value as maxDisplayValue,
        last_ts as ts,
        last_value as lastDisplayValue
      FROM ${this.getTableName()}(
        ${n.start},
        ${n.end},
        ${n.bucketSize}
      );
    `),a=e.iter({ts:c.LONG,minDisplayValue:c.NUM,maxDisplayValue:c.NUM,lastDisplayValue:c.NUM}),e=e.numRows(),i={timestamps:new BigInt64Array(e),minDisplayValues:new Float64Array(e),maxDisplayValues:new Float64Array(e),lastDisplayValues:new Float64Array(e),displayValueRange:[0,0]};let t=0,r=0;for(let e=0;a.valid();a.next(),e++)i.timestamps[e]=R.Time.fromRaw(a.ts),i.minDisplayValues[e]=a.minDisplayValue,i.maxDisplayValues[e]=a.maxDisplayValue,i.lastDisplayValues[e]=a.lastDisplayValue,t=Math.min(t,a.minDisplayValue),r=Math.max(r,a.maxDisplayValue);i.displayValueRange=[t,r],this.countersKey=n,this.counters=i,o.raf.scheduleRedraw()}}async createTableAndFetchLimits(e){var e=e?`drop table ${this.getTableName()};`:"",e=await this.engine.query(`
      ${e}
      create virtual table ${this.getTableName()}
      using __intrinsic_counter_mipmap((
        select
          ts,
          ${this.getValueExpression()} as value
        from (${this.getSqlSource()})
      ));
      select
        min_value as minDisplayValue,
        max_value as maxDisplayValue
      from ${this.getTableName()}(
        trace_start(), trace_end(), trace_dur()
      );
    `),{minDisplayValue:e,maxDisplayValue:t}=(this.trash.defer(async()=>{this.engine.tryQuery("drop table if exists "+this.getTableName())}),e.firstRow({minDisplayValue:c.NUM,maxDisplayValue:c.NUM}));return{minDisplayValue:e,maxDisplayValue:t}}get unit(){return this.getCounterOptions().unit??""}}}return Gf}function $f(){if(!Bf){Bf=1,Object.defineProperty(ys,"__esModule",{value:!0}),ys.addPivotedTracks=async function(e,t,r,n,a){var i=(await e.engine.query(`
    with all_vals as (${t.sqlSource})
    select DISTINCT ${n} from all_vals
    order by ${n}
  `)).iter({});for(;i.valid();i.next())await a(e,{sqlSource:`select * from
        (${t.sqlSource})
        where ${n} `+(0,f.matchesSqlValue)(i.get(n))},`${r.trim()||"Pivot Track"}: `+(0,f.sqlValueToReadableString)(i.get(n)))},ys.addDebugSliceTrack=async function(t,e,r,n,a){const i="__debug_slice_"+(0,c.uuidv4Sql)(),o=(await(0,f.createPerfettoTable)(t.engine,i,function(e,t,r){var n=void 0!==e.columns?`(${e.columns.join(", ")})`:"",a="0"===t.dur?0:t.dur;return`
    with data${n} as (
      ${e.sqlSource}
    ),
    prepared_data as (
      select
        ${t.ts} as ts,
        ifnull(cast(${a} as int), -1) as dur,
        printf('%s', ${t.name}) as name
        ${0<r.length?",":""}
        ${r.map(e=>e+" as "+p.ARG_PREFIX+e).join(",\n")}
      from data
    )
    select
      row_number() over (order by ts) as id,
      *
    from prepared_data
    order by ts
  `}(e,n,a)),"debug.slice."+(0,c.uuidv4)()),s=(t.registerTrack({uri:o,title:r,trackFactory:e=>new d.DebugSliceTrack(t.engine,e,i)}),await l(r,o));u.globals.dispatchMultiple(s)},ys.addDebugCounterTrack=async function(t,e,r,n){const a="__debug_counter_"+(0,c.uuidv4Sql)(),i=(await(0,f.createPerfettoTable)(t.engine,a,function(e,t){return`
    with data as (
      ${e.sqlSource}
    )
    select
      ${t.ts} as ts,
      ${t.value} as value
    from data
    order by ts
  `}(e,n)),"debug.counter."+(0,c.uuidv4)()),o=(t.registerTrack({uri:i,title:r,trackFactory:e=>new s.DebugCounterTrack(t.engine,e,a)}),await l(r,i));u.globals.dispatchMultiple(o)};const c=P(),i=ne(),o=Y(),u=oe(),d=function(){if(!Pf){Pf=1,Object.defineProperty(vs,"__esModule",{value:!0}),vs.DebugSliceTrack=void 0;var e=wl();const t=xf();class r extends e.CustomSqlTableSliceTrack{sqlTableName;constructor(e,t,r){super({engine:e,trackKey:t.trackKey}),this.sqlTableName=r}async getSqlDataSource(){return{sqlTableName:this.sqlTableName}}getDetailsPanel(){return{kind:t.DebugSliceDetailsTab.kind,config:{sqlTableName:this.sqlTableName,title:"Debug Slice"}}}}vs.DebugSliceTrack=r}return vs}(),f=D(),s=function(){if(!Uf){Uf=1,Object.defineProperty(Hf,"__esModule",{value:!0}),Hf.DebugCounterTrack=void 0;class e extends qf().BaseCounterTrack{sqlTableName;constructor(e,t,r){super({engine:e,trackKey:t.trackKey}),this.sqlTableName=r}getSqlSource(){return"select * from "+this.sqlTableName}}Hf.DebugCounterTrack=e}return Hf}(),p=xf();let a=0;function l(e,t){var r=++a,n=(0,c.uuidv4)();return[i.Actions.addTrack({key:n,name:e.trim()||"Debug Track "+r,uri:t,trackSortKey:o.PrimaryTrackSortKey.DEBUG_TRACK,trackGroup:o.SCROLLING_TRACK_GROUP,closeable:!0}),i.Actions.toggleTrackPinned({trackKey:n})]}}return ys}function ue(){var e,t,r,n,a,i,o;return jf||(jf=1,e=hs,Object.defineProperty(e,"__esModule",{value:!0}),e.addDebugSliceTrack=e.PrimaryTrackSortKey=e.createStore=e.BottomTabToSCSAdapter=e.STR_NULL=e.STR=e.NUM_NULL=e.NUM=e.LONG_NULL=e.LONG=void 0,t=or,r=Z(),Object.defineProperty(e,"LONG",{enumerable:!0,get:function(){return r.LONG}}),Object.defineProperty(e,"LONG_NULL",{enumerable:!0,get:function(){return r.LONG_NULL}}),Object.defineProperty(e,"NUM",{enumerable:!0,get:function(){return r.NUM}}),Object.defineProperty(e,"NUM_NULL",{enumerable:!0,get:function(){return r.NUM_NULL}}),Object.defineProperty(e,"STR",{enumerable:!0,get:function(){return r.STR}}),Object.defineProperty(e,"STR_NULL",{enumerable:!0,get:function(){return r.STR_NULL}}),n=ms(),Object.defineProperty(e,"BottomTabToSCSAdapter",{enumerable:!0,get:function(){return n.BottomTabToSCSAdapter}}),a=Vr(),Object.defineProperty(e,"createStore",{enumerable:!0,get:function(){return a.createStore}}),i=Y(),Object.defineProperty(e,"PrimaryTrackSortKey",{enumerable:!0,get:function(){return i.PrimaryTrackSortKey}}),o=$f(),Object.defineProperty(e,"addDebugSliceTrack",{enumerable:!0,get:function(){return o.addDebugSliceTrack}}),t.__exportStar(Q(),e)),hs}var zf,Kf={},Yf={};function Jf(){if(!zf){zf=1,Object.defineProperty(Yf,"__esModule",{value:!0}),Yf.runQuery=async function(t,r,n){var a=performance.now(),r=await r.tryQuery(t);{if(r.success){var i=r.result,o=n?.convertNullsToString??!0,n=performance.now()-a,s=[],l=i.columns();let e=0;for(var c=i.iter({});c.valid();c.next()){var u={};for(const f of l){var d=c.get(f);u[f]=null===d&&o?"NULL":d}if(s.push(u),++e>=p)break}return{query:t,durationMs:n,error:i.error(),totalRowCount:i.numRows(),columns:l,rows:s,statementCount:i.statementCount(),statementWithOutputCount:i.statementWithOutputCount(),lastStatementSql:i.lastStatementSql()}}return{query:t,durationMs:performance.now()-a,error:r.error.message,totalRowCount:0,columns:[],rows:[],statementCount:0,statementWithOutputCount:0,lastStatementSql:""}}};const p=1e4}return Yf}var Zf,Qf={},Xf={};function ep(){if(!Zf){Zf=1,Object.defineProperty(Xf,"__esModule",{value:!0}),Xf.Callout=void 0;const a=or.__importDefault(ae()),i=al();Xf.Callout=class{view({attrs:e,children:t}){const{icon:r,...n}=e;return(0,a.default)(".pf-callout",n,r&&(0,a.default)(i.Icon,{className:"pf-left-icon",icon:r}),t)}}}return Xf}var tp,rp={};function np(){if(!tp){tp=1,Object.defineProperty(rp,"__esModule",{value:!0}),rp.onClickCopy=function(t){return e=>{e.preventDefault(),(0,o.copyToClipboard)(t),n.globals.dispatch(r.Actions.updateStatus({msg:"Link copied into the clipboard",timestamp:Date.now()/1e3}))}},rp.queryResponseToClipboard=async function(e){var t=[];t.push(e.columns);for(const a of e.rows){var r=[];for(const i of e.columns){var n=a[i];r.push(null===n?"NULL":""+n)}t.push(r)}(0,o.copyToClipboard)(t.map(e=>e.join("\t")).join("\n"))};const o=Ws(),r=ne(),n=oe()}return rp}var ap,ip,op,sp={};function lp(){return ap||(ap=1,Object.defineProperty(sp,"__esModule",{value:!0}),sp.downloadUrl=r,sp.downloadData=function(e,...t){t=new Blob(t,{type:"application/octet-stream"}),t=URL.createObjectURL(t);r(e,t)}),sp;function r(e,t){var r=document.createElement("a");r.href=t,r.download=e,r.target="_blank",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(t)}}function cp(){if(!ip){ip=1,Object.defineProperty(Qf,"__esModule",{value:!0}),Qf.QueryTable=void 0,Qf.isSliceish=n,Qf.getSliceId=i;const o=or.__importDefault(ae()),s=Rr(),a=Ws(),l=te(),c=K(),u=ne(),d=se(),f=le(),t=ep(),p=F(),h=np(),g=lp(),m=oe(),_=So(),y=Bc();class T{view(e){const{row:t,columns:r}=e.attrs;e=r.map(e=>this.renderCell(e,t[e]));return"/viewer"===_.Router.parseUrl(window.location.href).page&&n(t)?(0,o.default)("tr",{onclick:()=>this.selectAndRevealSlice(t,!1),ondblclick:()=>this.selectAndRevealSlice(t,!0),clickable:!0,title:"Go to slice"},e):(0,o.default)("tr",e)}renderCell(e,t){return t instanceof Uint8Array?(0,o.default)("td",this.renderBlob(e,t)):(0,o.default)("td",""+t)}renderBlob(e,t){return(0,o.default)(d.Anchor,{onclick:()=>(0,g.downloadData)(e+".blob",t)},`Blob (${t.length} bytes)`)}selectAndRevealSlice(e,t){var r=Number(e.track_id),n=c.Time.fromRaw(BigInt(e.ts)),a=s.BigintMath.max(BigInt(e.dur),1n),r=m.globals.trackManager.trackKeyByTrackId.get(r);void 0!==r&&((0,y.reveal)(r,n,c.Time.add(n,a),!0),void 0!==(n=i(e)))&&this.selectSlice(n,r,t)}selectSlice(e,t,r){e=u.Actions.selectSlice({id:e,trackKey:t,table:"slice"});m.globals.makeSelection(e,{switchToCurrentSelectionTab:r})}}class b{previousResponse;onbeforeupdate(e){return e.attrs.resp!==this.previousResponse}view(e){const t=e.attrs.resp;var r=[];for(const a of(this.previousResponse=t).columns)r.push((0,o.default)("td",a));var e=(0,o.default)("tr",r),n=t.rows.map(e=>(0,o.default)(T,{row:e,columns:t.columns}));return t.error?(0,o.default)(".query-error","SQL error: "+t.error):(0,o.default)("table.pf-query-table",(0,o.default)("thead",e),(0,o.default)("tbody",n))}}function r(e){return"bigint"==typeof e||"number"==typeof e&&Number.isInteger(e)}function n(e){return"ts"in(t=e)&&r(t.ts)&&"dur"in(t=e)&&r(t.dur)&&"track_id"in(t=e)&&r(t.track_id);var t}function i(e){if("type"in(t=e)&&(0,l.isString)(t.type)&&e.type.includes("slice")){if("id"in(t=e)&&r(t.id))return Number(e.id)}else if("slice_id"in(t=e)&&r(t.slice_id))return Number(e.slice_id);var t}Qf.QueryTable=class{view({attrs:e}){var{resp:e,query:t,contextButtons:r=[],fillParent:n}=e;return(0,o.default)(p.DetailsShell,{title:this.renderTitle(e),description:t,buttons:this.renderButtons(t,r,e),fillParent:n},e&&this.renderTableContent(e))}renderTitle(e){return e?`Query result (${e.error?"error":e.rows.length+" rows"}) - ${e.durationMs.toLocaleString()}ms`:"Query - running"}renderButtons(e,t,r){return[t,(0,o.default)(f.Button,{label:"Copy query",onclick:()=>{(0,a.copyToClipboard)(e)}}),r&&void 0===r.error&&(0,o.default)(f.Button,{label:"Copy result (.tsv)",onclick:()=>{(0,h.queryResponseToClipboard)(r)}})]}renderTableContent(e){return(0,o.default)(".pf-query-panel",1<e.statementWithOutputCount&&(0,o.default)(".pf-query-warning",(0,o.default)(t.Callout,{icon:"warning"},`${e.statementWithOutputCount} out of ${e.statementCount} `,"statements returned a result. ","Only the results for the last statement are displayed.")),(0,o.default)(b,{resp:e}))}}}return Qf}function up(){if(op)return Kf;op=1,Object.defineProperty(Kf,"__esModule",{value:!0}),Kf.QueryResultTab=void 0,Kf.addQueryResultsTab=function(e,t){e=new g({config:e,engine:function(){var e=f.globals.getCurrentEngine(),e=(0,n.assertExists)(e).id;return(0,n.assertExists)(f.globals.engines.get(e)).getProxy("QueryResult")}(),uuid:(0,r.v4)()}),t="queryResults#"+(t??(0,r.v4)());f.globals.tabManager.registerTab({uri:t,content:new h.BottomTabToTabAdapter(e),isEphemeral:!0}),f.globals.dispatch(p.Actions.showTab({uri:t}))};const e=or.__importDefault(ae()),r=Er(),n=ee(),a=Jf(),i=ie(),o=Z(),s=tf(),t=le(),l=vl(),c=bl();var u=Pl();const d=cp(),f=oe(),p=ne(),h=ms();class g extends u.BottomTab{static kind="dev.perfetto.QueryResultTab";queryResponse;sqlViewName;static create(e){return new g(e)}constructor(e){super(e),this.initTrack(e)}async initTrack(e){let t="";if(void 0!==this.config.prefetchedResponse)this.queryResponse=this.config.prefetchedResponse,t=e.uuid;else{e=await(0,a.runQuery)(this.config.query,this.engine);if(this.queryResponse=e,i.raf.scheduleFullRedraw(),void 0!==e.error)return;t=(0,r.v4)()}""!==t&&(this.sqlViewName=await this.createViewForDebugTrack(t),this.sqlViewName)&&i.raf.scheduleFullRedraw()}getTitle(){var e=this.queryResponse?` (${this.queryResponse.rows.length})`:"";return this.config.title+e}viewTab(){return(0,e.default)(d.QueryTable,{query:this.config.query,resp:this.queryResponse,fillParent:!0,contextButtons:[void 0===this.sqlViewName?null:(0,e.default)(l.PopupMenu2,{trigger:(0,e.default)(t.Button,{label:"Show debug track"}),popupPosition:c.PopupPosition.Top},(0,e.default)(s.AddDebugTrackMenu,{dataSource:{sqlSource:"select * from "+this.sqlViewName,columns:(0,n.assertExists)(this.queryResponse).columns},engine:this.engine}))]})}isLoading(){return void 0===this.queryResponse}async createViewForDebugTrack(e){var e=(0,s.uuidToViewName)(e),t=this.queryResponse&&void 0===this.queryResponse.error?this.queryResponse.lastStatementSql:this.config.query;try{if((await this.engine.query(`create view ${e} as `+t)).error())return""}catch(e){if(e instanceof o.QueryError)return"";throw e}return e}}return Kf.QueryResultTab=g,Kf}var dp,fp,pp={};function hp(){return dp||(dp=1,Object.defineProperty(pp,"__esModule",{value:!0}),pp.defaultPlugins=void 0,pp.defaultPlugins=["com.google.PixelMemory","dev.perfetto.AndroidBinderVizPlugin","dev.perfetto.AndroidClientServer","dev.perfetto.AndroidCujs","dev.perfetto.AndroidLongBatteryTracing","dev.perfetto.AndroidNetwork","dev.perfetto.AndroidPerf","dev.perfetto.AndroidPerfTraceCounters","dev.perfetto.AndroidStartup","dev.perfetto.BookmarkletApi","dev.perfetto.LargeScreensPerf","dev.perfetto.PinAndroidPerfMetrics","dev.perfetto.PinSysUITracks","dev.perfetto.RestorePinnedTrack","dev.perfetto.TimelineSync","dev.perfetto.TraceMetadata","org.kernel.LinuxKernelDevices","perfetto.AndroidLog","perfetto.Annotation","perfetto.AsyncSlices","perfetto.ChromeScrollJank","perfetto.CoreCommands","perfetto.Counter","perfetto.CpuFreq","perfetto.CpuProfile","perfetto.CpuSlices","perfetto.CriticalUserInteraction","perfetto.DebugTracks","perfetto.ExampleTraces","perfetto.Flows","perfetto.Frames","perfetto.FtraceRaw","perfetto.HeapProfile","perfetto.PerfSamplesProfile","perfetto.PivotTable","perfetto.ProcessSummary","perfetto.Sched","perfetto.Screenshots","perfetto.ThreadSlices","perfetto.ThreadState","perfetto.TrackUtils"]),pp}function gp(){if(!fp){fp=1;{var n=mt;Object.defineProperty(n,"__esModule",{value:!0}),n.pluginManager=n.pluginRegistry=n.PluginManager=n.PluginRegistry=n.PluginContextImpl=void 0;const s=Er();var e=Or();const r=K(),l=oe(),c=ue(),u=ne(),d=Y(),f=up(),p=re(),h=ee(),g=ie(),m=hp(),_=Bc();var t=V();class y{pluginId;trash=new t.DisposableStack;alive=!0;registerCommand(e){this.alive&&(e=l.globals.commandManager.registerCommand(e),this.trash.use(e))}runCommand(e,...t){return l.globals.commandManager.runCommand(e,...t)}constructor(e){this.pluginId=e}[Symbol.dispose](){this.trash.dispose(),this.alive=!1}addSidebarMenuItem(e){this.trash.use(l.globals.sidebarMenuItems.register(e))}}n.PluginContextImpl=y;class T{ctx;trash=new t.DisposableStack;alive=!0;engine;constructor(e,t){this.ctx=e;t=t.getProxy(e.pluginId);this.trash.use(t),this.engine=t}registerCommand(e){this.alive&&(e=l.globals.commandManager.registerCommand(e),this.trash.use(e))}addSidebarMenuItem(e){this.alive&&this.trash.use(l.globals.sidebarMenuItems.register(e))}registerTrack(e){this.alive&&(e=l.globals.trackManager.registerTrack({...e,pluginId:this.pluginId}),this.trash.use(e))}addDefaultTrack(e){this.alive&&(e=l.globals.trackManager.addPotentialTrack(e),this.trash.use(e))}registerStaticTrack(e){this.registerTrack(e),this.addDefaultTrack(e)}runCommand(e,...t){return this.ctx.runCommand(e,...t)}registerTab(e){this.alive&&(e=l.globals.tabManager.registerTab(e),this.trash.use(e))}addDefaultTab(e){e=l.globals.tabManager.addDefaultTab(e);this.trash.use(e)}registerDetailsPanel(e){this.alive&&(e=l.globals.tabManager.registerLegacyDetailsPanel(e),this.trash.use(e))}tabs={openQuery:(e,t)=>{(0,f.addQueryResultsTab)({query:e,title:t})},showTab(e){l.globals.dispatch(u.Actions.showTab({uri:e}))},hideTab(e){l.globals.dispatch(u.Actions.hideTab({uri:e}))}};get pluginId(){return this.ctx.pluginId}timeline={addTrack(e,t){var r=(0,s.v4)();return l.globals.dispatch(u.Actions.addTrack({key:r,uri:e,name:t,trackSortKey:c.PrimaryTrackSortKey.ORDINARY_TRACK,trackGroup:d.SCROLLING_TRACK_GROUP})),r},removeTrack(e){l.globals.dispatch(u.Actions.removeTracks({trackKeys:[e]}))},pinTrack(e){a(e)||l.globals.dispatch(u.Actions.toggleTrackPinned({trackKey:e}))},unpinTrack(e){a(e)&&l.globals.dispatch(u.Actions.toggleTrackPinned({trackKey:e}))},pinTracksByPredicate(e){for(const r of Object.values(l.globals.state.tracks)){var t=l.globals.trackManager.resolveTrackInfo(r.uri);t&&e(t)&&!a(r.key)&&l.globals.dispatch(u.Actions.toggleTrackPinned({trackKey:r.key}))}},unpinTracksByPredicate(e){for(const r of Object.values(l.globals.state.tracks)){var t=l.globals.trackManager.resolveTrackInfo(r.uri);t&&e(t)&&a(r.key)&&l.globals.dispatch(u.Actions.toggleTrackPinned({trackKey:r.key}))}},removeTracksByPredicate(t){var e=Object.values(l.globals.state.tracks).filter(e=>{e=l.globals.trackManager.resolveTrackInfo(e.uri);return e&&t(e)}).map(e=>e.key);l.globals.dispatch(u.Actions.removeTracks({trackKeys:e}))},expandGroupsByPredicate(t){var e=l.globals.state.trackGroups;for(const r of Object.values(e).filter(e=>e.collapsed).filter(e=>{e={displayName:e.name,collapsed:e.collapsed};return t(e)}).map(e=>e.key))l.globals.dispatch(u.Actions.toggleTrackGroupCollapsed({groupKey:r}))},collapseGroupsByPredicate(t){var e=l.globals.state.trackGroups;for(const r of Object.values(e).filter(e=>!e.collapsed).filter(e=>{e={displayName:e.name,collapsed:e.collapsed};return t(e)}).map(e=>e.key))l.globals.dispatch(u.Actions.toggleTrackGroupCollapsed({groupKey:r}))},get tracks(){var e=Object.values(l.globals.state.tracks);const r=l.globals.state.pinnedTracks,n=l.globals.state.trackGroups;return e.map(e=>{var t=e.trackGroup?n[e.trackGroup]:void 0;return{title:e.name,uri:e.uri,key:e.key,groupName:t?.name,isPinned:r.includes(e.key)}})},panToTimestamp(e){(0,_.horizontalScrollToTs)(e)},setViewportTime(e,t){l.globals.timeline.updateVisibleTime(new r.TimeSpan(e,t))},get viewport(){return l.globals.timeline.visibleWindow.toTimeSpan()}};[Symbol.dispose](){this.trash.dispose(),this.alive=!1}mountStore(e){return l.globals.store.createSubStore(["plugins",this.pluginId],e)}get trace(){return l.globals.traceContext}get openerPluginArgs(){if("ARRAY_BUFFER"===l.globals.state.engine?.source.type)return(l.globals.state.engine?.source.pluginArgs??{})[this.pluginId]}async prompt(e,t){return l.globals.omnibox.prompt(e,t)}}function a(e){return l.globals.state.pinnedTracks.includes(e)}class b extends e.Registry{constructor(){super(e=>e.pluginId)}}n.PluginRegistry=b;class v{registry;_plugins;engine;flags=new Map;constructor(e){this.registry=e,this._plugins=new Map}get plugins(){return this._plugins}async initialize(){var e;for({pluginId:e}of Array.from(n.pluginRegistry.values()).map(({pluginId:e})=>({pluginId:e,sort:Math.random()})).sort((e,t)=>e.sort-t.sort)){var t="plugin_"+e,r="Plugin: "+e,t=p.featureFlags.register({id:t,name:r,description:`Overrides '${e}' plugin.`,defaultValue:m.defaultPlugins.includes(e)});this.flags.set(e,t),t.get()&&await this.activatePlugin(e)}}async enablePlugin(e,t){var r=this.flags.get(e);r&&r.set(!0),t&&await this.activatePlugin(e)}async disablePlugin(e,t){var r=this.flags.get(e);r&&r.set(!1),t&&await this.deactivatePlugin(e)}async activatePlugin(e){var t,r;this.isActive(e)||(r=this.registry.get(e),r="function"==typeof(r=(r=r).plugin)?new r:r,t=new y(e),r.onActivate?.(t),r={plugin:r,context:t},this.engine&&await i(r,this.engine),this._plugins.set(e,r),g.raf.scheduleFullRedraw())}async deactivatePlugin(e){var t,r,n=this.getPluginContext(e);void 0!==n&&({context:t,plugin:r}=n,await o(n),r.onDeactivate&&r.onDeactivate(t),t[Symbol.dispose](),this._plugins.delete(e),g.raf.scheduleFullRedraw())}async restoreDefaults(e){for(const r of n.pluginRegistry.values()){var t=r.pluginId,t=(0,h.assertExists)(this.flags.get(t));t.reset(),e&&(t.get()?await this.activatePlugin(r.pluginId):await this.deactivatePlugin(r.pluginId))}}isActive(e){return void 0!==this.getPluginContext(e)}isEnabled(e){return Boolean(this.flags.get(e)?.get())}getPluginContext(e){return this._plugins.get(e)}async onTraceLoad(e,t){var r,n;this.engine=e;for({id:r,plugin:n}of Array.from(this._plugins.entries()).map(([e,t])=>({id:e,plugin:t,sort:Math.random()})).sort((e,t)=>e.sort-t.sort))t?.(r),await i(n,e)}onTraceClose(){for(const e of this._plugins.values())o(e);this.engine=void 0}metricVisualisations(){return Array.from(this._plugins.values()).flatMap(e=>{var t=e.plugin;return t.metricVisualisations?t.metricVisualisations(e.context):[]})}}async function i(e,t){var{plugin:r,context:n}=e,n=new T(n,t),t=(e.traceContext=n,performance.now()),r=await Promise.resolve(r.onTraceLoad?.(n)),n=performance.now()-t;return e.previousOnTraceLoadTimeMillis=n,g.raf.scheduleFullRedraw(),r}async function o(e){var{traceContext:t,plugin:r}=e;t&&(r.onTraceUnload&&await r.onTraceUnload(t),t[Symbol.dispose](),e.traceContext=void 0)}n.PluginManager=v,n.pluginRegistry=new b,n.pluginManager=new v(n.pluginRegistry)}}return mt}var mp,_p={};var yp,Tp={};var bp,vp,Ep={},Sp={};function Ap(){if(!vp){vp=1,Object.defineProperty(Ep,"__esModule",{value:!0}),Ep.plugin=void 0;const e=or.__importStar((bp||(bp=1,Object.defineProperty(Sp,"__esModule",{value:!0}),Sp.STARTUP_RELATED_TRACKS=Sp.MAIN_THREAD_TRACK=void 0,Sp.MAIN_THREAD_TRACK=["id.GoogleCamera "],Sp.STARTUP_RELATED_TRACKS=["FirstPreviewFrame","ShutterButtonEnabled"]),Sp));Ep.plugin={pluginId:"com.google.android.GoogleCamera",plugin:class{ctx;async onTraceLoad(e){(this.ctx=e).registerCommand({id:"com.google.android.GoogleCamera#LoadGoogleCameraStartupView",name:"Load google camera startup view",callback:()=>{this.loadGCAStartupView()}}),e.registerCommand({id:"com.google.android.GoogleCamera#PinCameraRelatedTracks",name:"Pin camera related tracks",callback:e=>{var t=prompt("List of additional track names that you would like to pin separated by commas","").split(",").map(function(e){return e.trim()});this.pinTracks(t)}})}loadGCAStartupView(){this.pinTracks(e.MAIN_THREAD_TRACK),this.pinTracks(e.STARTUP_RELATED_TRACKS)}pinTracks(e){const r=this.ctx.timeline.tracks;e.forEach(t=>{r.filter(e=>e.title.match(t)).forEach(e=>{this.ctx.timeline.pinTrack(e.key)})})}}}}return Ep}var Op,Cp={};var kp,wp={};var Rp,Ip={},Mp={},Pp={};function Np(){if(!Rp){Rp=1,Object.defineProperty(Pp,"__esModule",{value:!0}),Pp.SimpleSliceTrack=void 0;var e=wl();const n=P(),i=xf(),t=D();class r extends e.CustomSqlTableSliceTrack{config;sqlTableName;constructor(e,t,r){super({engine:e,trackKey:t.trackKey}),this.config=r,this.sqlTableName="__simple_slice_"+(0,n.uuidv4Sql)(t.trackKey)}async getSqlDataSource(){var e=await(0,t.createPerfettoTable)(this.engine,this.sqlTableName,this.createTableQuery(this.config.data,this.config.columns,this.config.argColumns));return{sqlTableName:this.sqlTableName,disposable:e}}getDetailsPanel(){return{kind:i.DebugSliceDetailsTab.kind,config:{sqlTableName:this.sqlTableName,title:"Debug Slice"}}}createTableQuery(e,t,r){var n=void 0!==e.columns?`(${e.columns.join(", ")})`:"",a="0"===t.dur?0:t.dur;return`
      with data${n} as (
        ${e.sqlSource}
      ),
      prepared_data as (
        select
          ${t.ts} as ts,
          ifnull(cast(${a} as int), -1) as dur,
          printf('%s', ${t.name}) as name
          ${0<r.length?",":""}
          ${r.map(e=>e+" as "+i.ARG_PREFIX+e).join(",\n")}
        from data
      )
      select
        row_number() over (order by ts) as id,
        *
      from prepared_data
      order by ts
    `}}Pp.SimpleSliceTrack=r}return Pp}var Dp,xp,Lp,Fp={};function Up(){if(!Dp){Dp=1,Object.defineProperty(Fp,"__esModule",{value:!0}),Fp.focusOtherFlow=function(t){var e=(0,o.getLegacySelection)(s.globals.state);if(e&&"SLICE"===e.kind){const n=e.id;var r;-1!==n&&(e=s.globals.connectedFlows.filter(e=>e.begin.sliceId===n&&"Forward"===t||e.end.sliceId===n&&"Backward"===t),"Backward"===t?(r=a(e,s.globals.state.focusedFlowIdLeft),s.globals.dispatch(i.Actions.setHighlightedFlowLeftId({flowId:r}))):(r=a(e,s.globals.state.focusedFlowIdRight),s.globals.dispatch(i.Actions.setHighlightedFlowRightId({flowId:r}))))}},Fp.moveByFocusedFlow=function(e){var t=(0,o.getLegacySelection)(s.globals.state);if(t&&"SLICE"===t.kind){var r,n,t=t.id,a="Backward"===e?s.globals.state.focusedFlowIdLeft:s.globals.state.focusedFlowIdRight;if(-1!==t&&-1!==a)for(const i of s.globals.connectedFlows)i.id===a&&(r="Backward"===e?i.begin:i.end,n=s.globals.trackManager.trackKeyByTrackId.get(r.trackId))&&s.globals.setLegacySelection({kind:"SLICE",id:r.sliceId,trackKey:n,table:"slice"},{clearSearch:!0,pendingScrollId:r.sliceId,switchToCurrentSelectionTab:!0})}},Fp.findCurrentSelection=async function(){var e=(0,o.getLegacySelection)(s.globals.state);var t;null!==e&&(t=await s.globals.findTimeRangeOfSelection(),(0,r.exists)(t)&&(0,n.focusHorizontalRange)(t.start,t.end),e.trackKey)&&(0,n.verticalScrollToTrack)(e.trackKey,!0)};const r=z(),i=ne(),o=Y(),s=oe(),n=Bc();function a(e,t){let r=!1;if(0===e.length)return-1;for(const n of e){if(r)return n.id;n.id===t&&(r=!0)}return e[0].id}}return Fp}function Bp(){if(!xp){xp=1,Object.defineProperty(Mp,"__esModule",{value:!0}),Mp.addDebugTrackOnCommand=i,Mp.addDebugTrackOnTraceLoad=o,Mp.addAndPinSliceTrack=function(e,t,r,n,a){"static"==n?o(e,t,r,a??""):"debug"==n&&i(e,t,r)},Mp.focusOnSlice=async function(e){var t;null!=e.sliceId&&null!=e.trackId&&(t=await n(e.trackId),r.globals.setLegacySelection({kind:"SLICE",id:e.sliceId,trackKey:t,table:"slice"},{clearSearch:!0,pendingScrollId:e.sliceId,switchToCurrentSelectionTab:!0}),l.findCurrentSelection)},Mp.focusOnTimeAndTrack=async function(e){var t,r;null!=e.trackId&&null!=e.ts&&null!=e.dur&&(r=e.trackId,t=e.ts,e=u.BigintMath.max(e.dur,1n),null!=(r=await n(r)))&&(0,d.reveal)(r,t,c.Time.add(t,e),!0)},Mp.waitForValue=t;const r=oe(),a=Np(),s=ue(),l=Up(),c=K(),u=Rr(),d=Bc();function i(e,t,r){(0,s.addDebugSliceTrack)(e,t.data,r,t.columns,t.argColumns)}function o(t,r,e,n){t.registerStaticTrack({uri:n,title:e,isPinned:!0,trackFactory:e=>new a.SimpleSliceTrack(t.engine,e,r)})}async function n(e){return await t(()=>r.globals.trackManager.trackKeyByTrackId.get(e))}async function t(e){for(;;){var t=e();if(void 0!==t)return t;await new Promise(e=>setTimeout(e,100))}}}return Mp}function jp(){if(Lp)return Ip;Lp=1,Object.defineProperty(Ip,"__esModule",{value:!0}),Ip.plugin=void 0,Ip.addJankCUJDebugTrack=r;const t=ue(),s=Bp();function r(e,t,r,n,a){[n=[]]=[n],i=l,o=c,n=0<(n="string"==typeof n?[n]:n)?.length?` AND cuj.name IN (${n.map(e=>`'J<${e}>'`).join(",")})`:"";var i,o,n=i={data:{sqlSource:i+n,columns:o},columns:{ts:"ts",dur:"dur",name:"name"},argColumns:o};(0,s.addAndPinSliceTrack)(e,n,t,r,a)}const n=`
  SELECT RUN_METRIC('android/android_jank_cuj.sql');
  INCLUDE PERFETTO MODULE android.critical_blocking_calls;
`;const l=`
    SELECT
      CASE
        WHEN
          EXISTS(
              SELECT 1
              FROM slice AS cuj_state_marker
                     JOIN track marker_track
                          ON marker_track.id = cuj_state_marker.track_id
              WHERE
                cuj_state_marker.ts >= cuj.ts
                AND cuj_state_marker.ts + cuj_state_marker.dur <= cuj.ts + cuj.dur
                AND
                ( /* e.g. J<CUJ_NAME>#FT#cancel#0 this for backward compatibility */
                      cuj_state_marker.name GLOB(cuj.name || '#FT#cancel*')
                    OR (marker_track.name = cuj.name AND cuj_state_marker.name GLOB 'FT#cancel*')
                  )
            )
          THEN ' ❌ '
        WHEN
          EXISTS(
              SELECT 1
              FROM slice AS cuj_state_marker
                     JOIN track marker_track
                          ON marker_track.id = cuj_state_marker.track_id
              WHERE
                cuj_state_marker.ts >= cuj.ts
                AND cuj_state_marker.ts + cuj_state_marker.dur <= cuj.ts + cuj.dur
                AND
                ( /* e.g. J<CUJ_NAME>#FT#end#0 this for backward compatibility */
                      cuj_state_marker.name GLOB(cuj.name || '#FT#end*')
                    OR (marker_track.name = cuj.name AND cuj_state_marker.name GLOB 'FT#end*')
                  )
            )
          THEN ' ✅ '
        ELSE NULL
        END || cuj.name AS name,
      total_frames,
      missed_app_frames,
      missed_sf_frames,
      sf_callback_missed_frames,
      hwui_callback_missed_frames,
      cuj_layer.layer_name,
      /* Boundaries table doesn't contain ts and dur when a CUJ didn't complete successfully.
        In that case we still want to show that it was canceled, so let's take the slice timestamps. */
      CASE WHEN boundaries.ts IS NOT NULL THEN boundaries.ts ELSE cuj.ts END AS ts,
      CASE WHEN boundaries.dur IS NOT NULL THEN boundaries.dur ELSE cuj.dur END AS dur,
      cuj.track_id,
      cuj.slice_id
    FROM slice AS cuj
           JOIN process_track AS pt ON cuj.track_id = pt.id
           LEFT JOIN android_jank_cuj jc
                     ON pt.upid = jc.upid AND cuj.name = jc.cuj_slice_name AND cuj.ts = jc.ts
           LEFT JOIN android_jank_cuj_main_thread_cuj_boundary boundaries using (cuj_id)
           LEFT JOIN android_jank_cuj_layer_name cuj_layer USING (cuj_id)
           LEFT JOIN android_jank_cuj_counter_metrics USING (cuj_id)
    WHERE cuj.name GLOB 'J<*>'
      AND cuj.dur > 0
`,c=["name","total_frames","missed_app_frames","missed_sf_frames","sf_callback_missed_frames","hwui_callback_missed_frames","layer_name","ts","dur","track_id","slice_id"],a=`
    SELECT
      CASE
        WHEN
          EXISTS(
              SELECT 1
              FROM slice AS cuj_state_marker
                     JOIN track marker_track
                          ON marker_track.id = cuj_state_marker.track_id
              WHERE
                cuj_state_marker.ts >= cuj.ts
                AND cuj_state_marker.ts + cuj_state_marker.dur <= cuj.ts + cuj.dur
                AND marker_track.name = cuj.name AND (
                    cuj_state_marker.name GLOB 'cancel' 
                    OR cuj_state_marker.name GLOB 'timeout')
            )
          THEN ' ❌ '
        ELSE ' ✅ '
        END || cuj.name AS name,
      cuj.dur / 1e6 as dur_ms,
      cuj.ts,
      cuj.dur,
      cuj.track_id,
      cuj.slice_id
    FROM slice AS cuj
           JOIN process_track AS pt
                ON cuj.track_id = pt.id
    WHERE cuj.name GLOB 'L<*>'
      AND cuj.dur > 0
`,i=["name","dur_ms","ts","dur","track_id","slice_id"],o=["slice_id","name","ts","cuj_ts","dur","cuj_id","cuj_name","process_name","upid","utid","table_name"];return Ip.plugin={pluginId:"dev.perfetto.AndroidCujs",plugin:class{async onTraceLoad(e){e.registerCommand({id:"dev.perfetto.AndroidCujs#PinJankCUJs",name:"Add track: Android jank CUJs",callback:()=>{e.engine.query(n).then(()=>{r(e,"Jank CUJs","debug")})}}),e.registerCommand({id:"dev.perfetto.AndroidCujs#ListJankCUJs",name:"Run query: Android jank CUJs",callback:()=>{e.engine.query(n).then(()=>e.tabs.openQuery(l,"Android Jank CUJs"))}}),e.registerCommand({id:"dev.perfetto.AndroidCujs#PinLatencyCUJs",name:"Add track: Android latency CUJs",callback:()=>{(0,t.addDebugSliceTrack)(e,{sqlSource:a,columns:i},"Latency CUJs",{ts:"ts",dur:"dur",name:"name"},[])}}),e.registerCommand({id:"dev.perfetto.AndroidCujs#ListLatencyCUJs",name:"Run query: Android Latency CUJs",callback:()=>e.tabs.openQuery(a,"Android Latency CUJs")}),e.registerCommand({id:"dev.perfetto.AndroidCujs#PinBlockingCalls",name:"Add track: Android Blocking calls during CUJs",callback:()=>{e.engine.query(n).then(()=>(0,t.addDebugSliceTrack)(e,{sqlSource:`
    SELECT
      s.id AS slice_id,
      s.name,
      max(s.ts, cuj.ts) AS ts,
      min(s.ts + s.dur, cuj.ts_end) as ts_end,
      min(s.ts + s.dur, cuj.ts_end) - max(s.ts, cuj.ts) AS dur,
      cuj.cuj_id,
      cuj.cuj_name,
      s.process_name,
      s.upid,
      s.utid,
      'slice' AS table_name
    FROM _android_critical_blocking_calls s
      JOIN  android_jank_cuj cuj
      -- only when there is an overlap
      ON s.ts + s.dur > cuj.ts AND s.ts < cuj.ts_end
          -- and are from the same process
          AND s.upid = cuj.upid
`,columns:o},"Blocking calls during CUJs",{ts:"ts",dur:"dur",name:"name"},o))}})}}},Ip}var Hp,Gp,Vp={},Wp={};function qp(){if(!Gp){Gp=1,Object.defineProperty(Vp,"__esModule",{value:!0}),Vp.plugin=void 0;const s=Np(),l=function(){if(!Hp){Hp=1,Object.defineProperty(Wp,"__esModule",{value:!0}),Wp.SimpleCounterTrack=void 0;var e=qf();const n=P(),t=D();class r extends e.BaseCounterTrack{config;sqlTableName;constructor(e,t,r){super({engine:e,trackKey:t.trackKey,options:r.options}),this.config=r,this.sqlTableName="__simple_counter_"+(0,n.uuidv4Sql)()}async onInit(){return(0,t.createPerfettoTable)(this.engine,this.sqlTableName,`
        with data as (
          ${this.config.data.sqlSource}
        )
        select
          ${this.config.columns.ts} as ts,
          ${this.config.columns.value} as value
        from data
        order by ts
      `)}getSqlSource(){return"select * from "+this.sqlTableName}}Wp.SimpleCounterTrack=r}return Wp}(),o=["item","type","raw_wakeup","attribution","suspend_quality","backoff_state","backoff_reason","backoff_count","backoff_millis"],n=["direction","type","hci_cmd","hci_event","hci_ble_event","cmd_status","reason_code","metric_id"],a=["quality_report_id","packet_types","connection_handle","connection_role","tx_power_level","rssi","snr","unused_afh_channel_count","afh_select_unideal_channel_count","lsto","connection_piconet_clock","retransmission_count","no_rx_count","nak_count","flow_off_count","buffer_overflow_bytes","buffer_underflow_bytes"],i=["connection_handle","hci_status","rssi","metric_id"],c=["key","number"],u=["metric_id","error_code","vendor_error_code"];function r(e){return`
  with step1 as (
      select
          ts,
          extract_arg(arg_set_id, 'ble_scan_state_changed.attribution_node[0].tag') as name,
          extract_arg(arg_set_id, 'ble_scan_state_changed.is_opportunistic') as opportunistic,
          extract_arg(arg_set_id, 'ble_scan_state_changed.is_filtered') as filtered,
          extract_arg(arg_set_id, 'ble_scan_state_changed.state') as state
      from track t join slice s on t.id = s.track_id
      where t.name = 'Statsd Atoms'
      and s.name = 'ble_scan_state_changed'
  ),
  step2 as (
      select
          ts,
          name,
          state,
          opportunistic,
          filtered,
          lead(ts) over (partition by name order by ts) - ts as dur
      from step1
  )
  select ts, dur, name from step2 where state = 'ON' and ${e} and dur is not null`}Vp.plugin={pluginId:"dev.perfetto.AndroidLongBatteryTracing",plugin:class{addSliceTrack(t,e,r,n,a=[]){const i={data:{sqlSource:r,columns:["ts","dur","name",...a]},columns:{ts:"ts",dur:"dur",name:"name"},argColumns:a};let o;o=n?`/${n}/long_battery_tracing_`+e:"/long_battery_tracing_"+e,t.registerStaticTrack({uri:o,title:e,trackFactory:e=>new s.SimpleSliceTrack(t.engine,e,i),groupName:n})}addCounterTrack(t,e,r,n,a){const i={data:{sqlSource:r,columns:["ts","value"]},columns:{ts:"ts",value:"value"},options:a};let o;o=n?`/${n}/long_battery_tracing_`+e:"/long_battery_tracing_"+e,t.registerStaticTrack({uri:o,title:e,trackFactory:e=>new l.SimpleCounterTrack(t.engine,e,i),groupName:n})}addBatteryStatsState(e,t,r,n,a){a.has("track."+r)&&this.addSliceTrack(e,t,`SELECT ts, safe_dur AS dur, value_name AS name
    FROM android_battery_stats_state
    WHERE track_name = "${r}"`,n)}addBatteryStatsEvent(e,t,r,n,a){a.has("track."+r)&&this.addSliceTrack(e,t,`SELECT ts, safe_dur AS dur, str_value AS name
    FROM android_battery_stats_event_slices
    WHERE track_name = "${r}"`,n)}async addDeviceState(r,n){var e,t;n.has("track.battery_stats.*")&&(e=(e,t)=>this.addBatteryStatsEvent(r,e,t,void 0,n),await(t=r.engine).query("INCLUDE PERFETTO MODULE android.battery_stats;"),await t.query("INCLUDE PERFETTO MODULE android.suspend;"),await t.query("INCLUDE PERFETTO MODULE counters.intervals;"),this.addSliceTrack(r,"Device State: Screen state",`
  WITH _counter AS (
    SELECT counter.id, ts, 0 AS track_id, value
    FROM counter
    JOIN counter_track ON counter_track.id = counter.track_id
    WHERE name = 'ScreenState'
  )
  SELECT
    ts,
    dur,
    CASE value
      WHEN 1 THEN 'Screen off'
      WHEN 2 THEN 'Screen on'
      WHEN 3 THEN 'Always-on display (doze)'
      ELSE 'unknown'
    END AS name
  FROM counter_leading_intervals!(_counter)`),this.addSliceTrack(r,"Device State: Charging",`
  WITH _counter AS (
    SELECT counter.id, ts, 0 AS track_id, value
    FROM counter
    JOIN counter_track ON counter_track.id = counter.track_id
    WHERE name = 'BatteryStatus'
  )
  SELECT
    ts,
    dur,
    CASE value
      -- 0 and 1 are both unknown
      WHEN 2 THEN 'Charging'
      WHEN 3 THEN 'Discharging'
      -- special case when charger is present but battery isn't charging
      WHEN 4 THEN 'Not charging'
      WHEN 5 THEN 'Full'
      ELSE 'unknown'
    END AS name
  FROM counter_leading_intervals!(_counter)`),this.addSliceTrack(r,"Device State: Suspend / resume",`
  SELECT
    ts,
    dur,
    'Suspended' AS name
  FROM android_suspend_state
  WHERE power_state = 'suspended'`),this.addSliceTrack(r,"Device State: Doze light state",`
  WITH _counter AS (
    SELECT counter.id, ts, 0 AS track_id, value
    FROM counter
    JOIN counter_track ON counter_track.id = counter.track_id
    WHERE name = 'DozeLightState'
  )
  SELECT
    ts,
    dur,
    CASE value
      WHEN 0 THEN 'active'
      WHEN 1 THEN 'inactive'
      WHEN 4 THEN 'idle'
      WHEN 5 THEN 'waiting_for_network'
      WHEN 6 THEN 'idle_maintenance'
      WHEN 7 THEN 'override'
      ELSE 'unknown'
    END AS name
  FROM counter_leading_intervals!(_counter)`),this.addSliceTrack(r,"Device State: Doze deep state",`
  WITH _counter AS (
    SELECT counter.id, ts, 0 AS track_id, value
    FROM counter
    JOIN counter_track ON counter_track.id = counter.track_id
    WHERE name = 'DozeDeepState'
  )
  SELECT
    ts,
    dur,
    CASE value
      WHEN 0 THEN 'active'
      WHEN 1 THEN 'inactive'
      WHEN 2 THEN 'idle_pending'
      WHEN 3 THEN 'sensing'
      WHEN 4 THEN 'locating'
      WHEN 5 THEN 'idle'
      WHEN 6 THEN 'idle_maintenance'
      WHEN 7 THEN 'quick_doze_delay'
      ELSE 'unknown'
    END AS name
  FROM counter_leading_intervals!(_counter)`),e("Device State: Top app","battery_stats.top"),this.addSliceTrack(r,"Device State: Long wakelocks",`SELECT
            ts - 60000000000 as ts,
            safe_dur + 60000000000 as dur,
            str_value AS name,
            package_name as package
        FROM add_package_name!((
          select *, int_value as uid
          from android_battery_stats_event_slices
          WHERE track_name = "battery_stats.longwake"
        ))`,void 0,["package"]),e("Device State: Foreground apps","battery_stats.fg"),e("Device State: Jobs","battery_stats.job"),n.has("atom.thermal_throttling_severity_state_changed"))&&this.addSliceTrack(r,"Device State: Thermal throttling",`
  with step1 as (
      select
          ts,
          EXTRACT_ARG(arg_set_id, 'thermal_throttling_severity_state_changed.sensor_type') as sensor_type,
          EXTRACT_ARG(arg_set_id, 'thermal_throttling_severity_state_changed.sensor_name') as sensor_name,
          EXTRACT_ARG(arg_set_id, 'thermal_throttling_severity_state_changed.temperature_deci_celsius') / 10.0 as temperature_celcius,
          EXTRACT_ARG(arg_set_id, 'thermal_throttling_severity_state_changed.severity') as severity
      from track t join slice s on t.id = s.track_id
      where t.name = 'Statsd Atoms'
      and s.name = 'thermal_throttling_severity_state_changed'
  ),
  step2 as (
      select
          ts,
          lead(ts) over (partition by sensor_type, sensor_name order by ts) - ts as dur,
          sensor_type,
          sensor_name,
          temperature_celcius,
          severity
      from step1
      where sensor_type not like 'TEMPERATURE_TYPE_BCL_%'
  )
  select
    ts,
    dur,
    case sensor_name
        when 'VIRTUAL-SKIN' then ''
        else sensor_name || ' is '
    end || severity || ' (' || temperature_celcius || 'C)' as name
  from step2
  where severity != 'NONE'`)}async addNetworkSummary(e,t){if(t.has("net.modem")||t.has("net.wifi")){var r="Network Summary",n=e.engine;if(await n.query("INCLUDE PERFETTO MODULE android.battery_stats;"),await n.query("INCLUDE PERFETTO MODULE android.network_packets;"),await n.query(`
  create or replace perfetto table network_summary as
  with base as (
      select
          cast(ts / 5000000000 as int64) * 5000000000 AS ts,
          case
              when track_name glob '*wlan*' then 'wifi'
              when track_name glob '*rmnet*' then 'modem'
              else 'unknown'
          end as dev_type,
          package_name as pkg,
          sum(packet_length) AS value
      from android_network_packets
      where (track_name glob '*wlan*' or track_name glob '*rmnet*')
      group by 1,2,3
  ),
  zeroes as (
      select
          ts,
          dev_type,
          pkg,
          value
      from base
      union all
      select
          ts + 5000000000 as ts,
          dev_type,
          pkg,
          0 as value
      from base
  ),
  final as (
      select
          ts,
          dev_type,
          pkg,
          sum(value) as value
      from zeroes
      group by 1, 2, 3
  )
  select * from final where ts is not null`),await n.query(`
  create or replace perfetto view radio_transport_data_conn as
  select ts, safe_dur AS dur, value_name as data_conn, value AS data_conn_val
  from android_battery_stats_state
  where track_name = "battery_stats.data_conn";

  create or replace perfetto view radio_transport_nr_state as
  select ts, safe_dur AS dur, value AS nr_state_val
  from android_battery_stats_state
  where track_name = "battery_stats.nr_state";

  drop table if exists radio_transport_join;
  create virtual table radio_transport_join
  using span_left_join(radio_transport_data_conn, radio_transport_nr_state);

  create or replace perfetto view radio_transport as
  select
    ts, dur,
    case data_conn_val
      -- On LTE with NR connected is 5G NSA.
      when 13 then iif(nr_state_val = 3, '5G (NSA)', data_conn)
      -- On NR with NR state present, is 5G SA.
      when 20 then iif(nr_state_val is null, '5G (SA or NSA)', '5G (SA)')
      else data_conn
    end as name
  from radio_transport_join;`),this.addSliceTrack(e,"Default network",`
  with base as (
      select
          ts,
          substr(s.name, 6) as conn
      from track t join slice s on t.id = s.track_id
      where t.name = 'battery_stats.conn'
  ),
  diff as (
      select
          ts,
          conn,
          conn != lag(conn) over (order by ts) as keep
      from base
  )
  select
      ts,
      ifnull(lead(ts) over (order by ts), (select end_ts from trace_bounds)) - ts as dur,
      case
        when conn like '-1:%' then 'Disconnected'
        when conn like '0:%' then 'Modem'
        when conn like '1:%' then 'WiFi'
        when conn like '4:%' then 'VPN'
        else conn
      end as name
  from diff where keep is null or keep`,r),t.has("atom.network_tethering_reported")&&this.addSliceTrack(e,"Tethering",`
  with base as (
      select
          ts as ts_end,
          EXTRACT_ARG(arg_set_id, 'network_tethering_reported.duration_millis') * 1000000 as dur
      from track t join slice s on t.id = s.track_id
      where t.name = 'Statsd Atoms'
        and s.name = 'network_tethering_reported'
  )
  select ts_end - dur as ts, dur, 'Tethering' as name from base`,r),t.has("net.wifi")){this.addCounterTrack(e,"Wifi total bytes","select ts, sum(value) as value from network_summary where dev_type = 'wifi' group by 1",r,{yDisplay:"log",yRangeSharingKey:"net_bytes",unit:"byte"});for(var a=(await n.query("select pkg, sum(value) from network_summary where dev_type='wifi' group by 1 order by 2 desc limit 10")).iter({pkg:"str"});a.valid();a.next())this.addCounterTrack(e,"Top wifi: "+a.pkg,`select ts, value from network_summary where dev_type = 'wifi' and pkg = '${a.pkg}'`,r,{yDisplay:"log",yRangeSharingKey:"net_bytes",unit:"byte"})}if(this.addBatteryStatsState(e,"Wifi interface","battery_stats.wifi_radio",r,t),this.addBatteryStatsState(e,"Wifi supplicant state","battery_stats.wifi_suppl",r,t),this.addBatteryStatsState(e,"Wifi strength","battery_stats.wifi_signal_strength",r,t),t.has("net.modem")){this.addCounterTrack(e,"Modem total bytes","select ts, sum(value) as value from network_summary where dev_type = 'modem' group by 1",r,{yDisplay:"log",yRangeSharingKey:"net_bytes",unit:"byte"});for(var i=(await n.query("select pkg, sum(value) from network_summary where dev_type='modem' group by 1 order by 2 desc limit 10")).iter({pkg:"str"});i.valid();i.next())this.addCounterTrack(e,"Top modem: "+i.pkg,`select ts, value from network_summary where dev_type = 'modem' and pkg = '${i.pkg}'`,r,{yDisplay:"log",yRangeSharingKey:"net_bytes",unit:"byte"})}this.addBatteryStatsState(e,"Cellular interface","battery_stats.mobile_radio",r,t),this.addSliceTrack(e,"Cellular connection","select ts, dur, name from radio_transport",r),this.addBatteryStatsState(e,"Cellular strength","battery_stats.phone_signal_strength",r,t)}}async addModemDetail(e,t){var r;t.has("atom.modem_activity_info")&&(await this.addModemActivityInfo(e,r="Modem Detail"),t.has("track.ril"))&&await this.addModemRil(e,r)}async addModemActivityInfo(r,n){var e=(e,t)=>this.addCounterTrack(r,e,`select ts, ${t}_ratio as value from modem_activity_info`,n,{yOverrideMaximum:100,unit:"%"});await r.engine.query(`
  drop table if exists modem_activity_info;
  create table modem_activity_info as
  with modem_raw as (
    select
      ts,
      EXTRACT_ARG(arg_set_id, 'modem_activity_info.timestamp_millis') as timestamp_millis,
      EXTRACT_ARG(arg_set_id, 'modem_activity_info.sleep_time_millis') as sleep_time_millis,
      EXTRACT_ARG(arg_set_id, 'modem_activity_info.controller_idle_time_millis') as controller_idle_time_millis,
      EXTRACT_ARG(arg_set_id, 'modem_activity_info.controller_tx_time_pl0_millis') as controller_tx_time_pl0_millis,
      EXTRACT_ARG(arg_set_id, 'modem_activity_info.controller_tx_time_pl1_millis') as controller_tx_time_pl1_millis,
      EXTRACT_ARG(arg_set_id, 'modem_activity_info.controller_tx_time_pl2_millis') as controller_tx_time_pl2_millis,
      EXTRACT_ARG(arg_set_id, 'modem_activity_info.controller_tx_time_pl3_millis') as controller_tx_time_pl3_millis,
      EXTRACT_ARG(arg_set_id, 'modem_activity_info.controller_tx_time_pl4_millis') as controller_tx_time_pl4_millis,
      EXTRACT_ARG(arg_set_id, 'modem_activity_info.controller_rx_time_millis') as controller_rx_time_millis
    from track t join slice s on t.id = s.track_id
    where t.name = 'Statsd Atoms'
      and s.name = 'modem_activity_info'
  ),
  deltas as (
      select
          timestamp_millis * 1000000 as ts,
          lead(timestamp_millis) over (order by ts) - timestamp_millis as dur_millis,
          lead(sleep_time_millis) over (order by ts) - sleep_time_millis as sleep_time_millis,
          lead(controller_idle_time_millis) over (order by ts) - controller_idle_time_millis as controller_idle_time_millis,
          lead(controller_tx_time_pl0_millis) over (order by ts) - controller_tx_time_pl0_millis as controller_tx_time_pl0_millis,
          lead(controller_tx_time_pl1_millis) over (order by ts) - controller_tx_time_pl1_millis as controller_tx_time_pl1_millis,
          lead(controller_tx_time_pl2_millis) over (order by ts) - controller_tx_time_pl2_millis as controller_tx_time_pl2_millis,
          lead(controller_tx_time_pl3_millis) over (order by ts) - controller_tx_time_pl3_millis as controller_tx_time_pl3_millis,
          lead(controller_tx_time_pl4_millis) over (order by ts) - controller_tx_time_pl4_millis as controller_tx_time_pl4_millis,
          lead(controller_rx_time_millis) over (order by ts) - controller_rx_time_millis as controller_rx_time_millis
      from modem_raw
  ),
  ratios as (
      select
          ts,
          100.0 * sleep_time_millis / dur_millis as sleep_time_ratio,
          100.0 * controller_idle_time_millis / dur_millis as controller_idle_time_ratio,
          100.0 * controller_tx_time_pl0_millis / dur_millis as controller_tx_time_pl0_ratio,
          100.0 * controller_tx_time_pl1_millis / dur_millis as controller_tx_time_pl1_ratio,
          100.0 * controller_tx_time_pl2_millis / dur_millis as controller_tx_time_pl2_ratio,
          100.0 * controller_tx_time_pl3_millis / dur_millis as controller_tx_time_pl3_ratio,
          100.0 * controller_tx_time_pl4_millis / dur_millis as controller_tx_time_pl4_ratio,
          100.0 * controller_rx_time_millis / dur_millis as controller_rx_time_ratio
      from deltas
  )
  select * from ratios where sleep_time_ratio is not null and sleep_time_ratio >= 0`),e("Modem sleep","sleep_time"),e("Modem controller idle","controller_idle_time"),e("Modem RX time","controller_rx_time"),e("Modem TX time power 0","controller_tx_time_pl0"),e("Modem TX time power 1","controller_tx_time_pl1"),e("Modem TX time power 2","controller_tx_time_pl2"),e("Modem TX time power 3","controller_tx_time_pl3"),e("Modem TX time power 4","controller_tx_time_pl4")}async addModemRil(r,n){var e=(e,t)=>this.addSliceTrack(r,`Modem signal strength ${e} `+t,`SELECT ts, dur, name FROM RilScreenOn WHERE band_name = '${e}' AND value_name = '${t}'`,n),t=r.engine;await t.query(`
  DROP VIEW IF EXISTS ScreenOn;
  CREATE VIEW ScreenOn AS
  SELECT ts, dur FROM (
      SELECT
          ts, value,
          LEAD(ts, 1, TRACE_END()) OVER (ORDER BY ts)-ts AS dur
      FROM counter, track ON (counter.track_id = track.id)
      WHERE track.name = 'ScreenState'
  ) WHERE value = 2;

  DROP VIEW IF EXISTS RilSignalStrength;
  CREATE VIEW RilSignalStrength AS
  With RilMessages AS (
      SELECT
          ts, slice.name,
          LEAD(ts, 1, TRACE_END()) OVER (ORDER BY ts)-ts AS dur
      FROM slice, track
      ON (slice.track_id = track.id)
      WHERE track.name = 'RIL'
        AND slice.name GLOB 'UNSOL_SIGNAL_STRENGTH*'
  ),
  BandTypes(band_ril, band_name) AS (
      VALUES ("CellSignalStrengthLte:", "LTE"),
              ("CellSignalStrengthNr:", "NR")
  ),
  ValueTypes(value_ril, value_name) AS (
      VALUES ("rsrp=", "rsrp"),
              ("rssi=", "rssi")
  ),
  Extracted AS (
      SELECT ts, dur, band_name, value_name, (
          SELECT CAST(SUBSTR(key_str, start_idx+1, end_idx-start_idx-1) AS INT64) AS value
          FROM (
              SELECT key_str, INSTR(key_str, "=") AS start_idx, INSTR(key_str, " ") AS end_idx
              FROM (
                  SELECT SUBSTR(band_str, INSTR(band_str, value_ril)) AS key_str
                  FROM (SELECT SUBSTR(name, INSTR(name, band_ril)) AS band_str)
              )
          )
      ) AS value
      FROM RilMessages
      JOIN BandTypes
      JOIN ValueTypes
  )
  SELECT
  ts, dur, band_name, value_name, value,
  value_name || "=" || IIF(value = 2147483647, "unknown", ""||value) AS name,
  ROW_NUMBER() OVER (ORDER BY ts) as id,
  DENSE_RANK() OVER (ORDER BY band_name, value_name) AS track_id
  FROM Extracted;

  DROP TABLE IF EXISTS RilScreenOn;
  CREATE VIRTUAL TABLE RilScreenOn
  USING SPAN_JOIN(RilSignalStrength PARTITIONED track_id, ScreenOn)`),await t.query(`
  CREATE OR REPLACE PERFETTO FUNCTION EXTRACT_KEY_VALUE(source STRING, key_name STRING) RETURNS STRING AS
  SELECT SUBSTR(trimmed, INSTR(trimmed, "=")+1, INSTR(trimmed, ",") - INSTR(trimmed, "=") - 1)
  FROM (SELECT SUBSTR($source, INSTR($source, $key_name)) AS trimmed);`),e("LTE","rsrp"),e("LTE","rssi"),e("NR","rsrp"),e("NR","rssi"),this.addSliceTrack(r,"Modem channel config",`
  With RawChannelConfig AS (
      SELECT ts, slice.name AS raw_config
      FROM slice, track
      ON (slice.track_id = track.id)
      WHERE track.name = 'RIL'
      AND slice.name LIKE 'UNSOL_PHYSICAL_CHANNEL_CONFIG%'
  ),
  Attributes(attribute, attrib_name) AS (
      VALUES ("mCellBandwidthDownlinkKhz", "downlink"),
          ("mCellBandwidthUplinkKhz", "uplink"),
          ("mNetworkType", "network"),
          ("mBand", "band")
  ),
  Slots(idx, slot_name) AS (
      VALUES (0, "primary"),
          (1, "secondary 1"),
          (2, "secondary 2")
  ),
  Stage1 AS (
      SELECT *, IFNULL(EXTRACT_KEY_VALUE(STR_SPLIT(raw_config, "}, {", idx), attribute), "") AS name
      FROM RawChannelConfig
      JOIN Attributes
      JOIN Slots
  ),
  Stage2 AS (
      SELECT *, LAG(name) OVER (PARTITION BY idx, attribute ORDER BY ts) AS last_name
      FROM Stage1
  ),
  Stage3 AS (
      SELECT *, LEAD(ts, 1, TRACE_END()) OVER (PARTITION BY idx, attribute ORDER BY ts) - ts AS dur
      FROM Stage2 WHERE name != last_name
  )
  SELECT ts, dur, slot_name || "-" || attrib_name || "=" || name AS name
  FROM Stage3`,n),this.addSliceTrack(r,"Modem cell reselection",`
  with base as (
    select
        ts,
        s.name as raw_ril,
        ifnull(str_split(str_split(s.name, 'CellIdentityLte{', 1), ', operatorNames', 0),
            str_split(str_split(s.name, 'CellIdentityNr{', 1), ', operatorNames', 0)) as cell_id
    from track t join slice s on t.id = s.track_id
    where t.name = 'RIL' and s.name like '%DATA_REGISTRATION_STATE%'
  ),
  base2 as (
    select
        ts,
        raw_ril,
        case
            when cell_id like '%earfcn%' then 'LTE ' || cell_id
            when cell_id like '%nrarfcn%' then 'NR ' || cell_id
            when cell_id is null then 'Unknown'
            else cell_id
        end as cell_id
    from base
  ),
  base3 as (
    select ts, cell_id , lag(cell_id) over (order by ts) as lag_cell_id, raw_ril
    from base2
  )
  select ts, 0 as dur, cell_id as name, raw_ril
  from base3
  where cell_id != lag_cell_id
  order by ts`,n,["raw_ril"])}async addKernelWakelocks(e,t){if(t.has("atom.kernel_wakelock")){t=e.engine;await t.query("INCLUDE PERFETTO MODULE android.suspend;"),await t.query(`
  create or replace perfetto table kernel_wakelocks as
  with kernel_wakelock_args as (
    select
      arg_set_id,
      min(iif(key = 'kernel_wakelock.name', string_value, null)) as wakelock_name,
      min(iif(key = 'kernel_wakelock.count', int_value, null)) as count,
      min(iif(key = 'kernel_wakelock.time_micros', int_value, null)) as time_micros
    from args
    where key in (
      'kernel_wakelock.name',
      'kernel_wakelock.count',
      'kernel_wakelock.time_micros'
    )
    group by 1
  ),
  interesting as (
    select wakelock_name
    from (
      select wakelock_name, max(time_micros)-min(time_micros) as delta_us
      from kernel_wakelock_args
      group by 1
    )
    -- Only consider wakelocks with over 1 second of time during the whole trace
    where delta_us > 1e6
  ),
  step1 as (
    select ts, wakelock_name, count, time_micros
    from kernel_wakelock_args
    join interesting using (wakelock_name)
    join slice using (arg_set_id)
  ),
  step2 as (
    select
      ts,
      wakelock_name,
      lead(ts) over (partition by wakelock_name order by ts) as ts_end,
      lead(count) over (partition by wakelock_name order by ts) - count as count,
      (lead(time_micros) over (partition by wakelock_name order by ts) - time_micros) * 1000 as wakelock_dur
    from step1
  ),
  step3 as (
    select
      ts,
      ts_end,
      ifnull((select sum(dur) from android_suspend_state s
              where power_state = 'suspended'
                and s.ts > step2.ts
                and s.ts < step2.ts_end), 0) as suspended_dur,
      wakelock_name,
      count,
      wakelock_dur
    from step2
    where wakelock_dur is not null
      and wakelock_dur >= 0
  )
  select
    ts,
    ts_end - ts as dur,
    wakelock_name,
    min(100.0 * wakelock_dur / (ts_end - ts - suspended_dur), 100) as value
  from step3`);for(var r=(await t.query(`
  select wakelock_name, max(value) as max_value
  from kernel_wakelocks
  where wakelock_name not in ('PowerManager.SuspendLockout', 'PowerManagerService.Display')
  group by 1
  having max_value > 1
  order by 1;`)).iter({wakelock_name:"str"});r.valid();r.next())this.addCounterTrack(e,r.wakelock_name,`select ts, dur, value from kernel_wakelocks where wakelock_name = "${r.wakelock_name}"`,"Kernel Wakelock Summary",{yRangeSharingKey:"kernel_wakelock",unit:"%"})}}async addWakeups(t,r){if(r.has("track.suspend_backoff")){r=t.engine;await r.query("INCLUDE PERFETTO MODULE android.suspend;"),await r.query(`
  drop table if exists wakeups;
  create table wakeups as
  with wakeup_reason as (
      select
      ts,
      substr(i.name, 0, instr(i.name, ' ')) as id_timestamp,
      substr(i.name, instr(i.name, ' ') + 1) as raw_wakeup
      from track t join instant i on t.id = i.track_id
      where t.name = 'wakeup_reason'
  ),
  wakeup_attribution as (
      select
      substr(i.name, 0, instr(i.name, ' ')) as id_timestamp,
      substr(i.name, instr(i.name, ' ') + 1) as attribution
      from track t join instant i on t.id = i.track_id
      where t.name = 'wakeup_attribution'
  ),
  step1 as(
    select
      ts,
      raw_wakeup,
      attribution,
      null as raw_backoff
    from wakeup_reason r
      left outer join wakeup_attribution using(id_timestamp)
    union all
    select
      ts,
      null as raw_wakeup,
      null as attribution,
      i.name as raw_backoff
    from track t join instant i on t.id = i.track_id
    where t.name = 'suspend_backoff'
  ),
  step2 as (
    select
      ts,
      raw_wakeup,
      attribution,
      lag(raw_backoff) over (order by ts) as raw_backoff
    from step1
  ),
  step3 as (
    select
      ts,
      raw_wakeup,
      attribution,
      str_split(raw_backoff, ' ', 0) as suspend_quality,
      str_split(raw_backoff, ' ', 1) as backoff_state,
      str_split(raw_backoff, ' ', 2) as backoff_reason,
      cast(str_split(raw_backoff, ' ', 3) as int) as backoff_count,
      cast(str_split(raw_backoff, ' ', 4) as int) as backoff_millis,
      false as suspend_end
    from step2
    where raw_wakeup is not null
    union all
    select
      ts,
      null as raw_wakeup,
      null as attribution,
      null as suspend_quality,
      null as backoff_state,
      null as backoff_reason,
      null as backoff_count,
      null as backoff_millis,
      true as suspend_end
    from android_suspend_state
    where power_state = 'suspended'
  ),
  step4 as (
    select
      ts,
      case suspend_quality
        when 'good' then
          min(
            lead(ts, 1, ts + 5e9) over (order by ts) - ts,
            5e9
          )
        when 'bad' then backoff_millis * 1000000
        else 0
      end as dur,
      raw_wakeup,
      attribution,
      suspend_quality,
      backoff_state,
      backoff_reason,
      backoff_count,
      backoff_millis,
      suspend_end
    from step3
  ),
  step5 as (
    select
      ts,
      dur,
      raw_wakeup,
      attribution,
      suspend_quality,
      backoff_state,
      backoff_reason,
      backoff_count,
      backoff_millis
    from step4
    where not suspend_end
  ),
  step6 as (
    select
      ts,
      dur,
      raw_wakeup,
      attribution,
      suspend_quality,
      backoff_state,
      backoff_reason,
      backoff_count,
      backoff_millis,
      case
        when raw_wakeup like 'Abort: Pending Wakeup Sources: %' then 'abort_pending'
        when raw_wakeup like 'Abort: Last active Wakeup Source: %' then 'abort_last_active'
        when raw_wakeup like 'Abort: %' then 'abort_other'
        else 'normal'
      end as type,
      case
        when raw_wakeup like 'Abort: Pending Wakeup Sources: %' then substr(raw_wakeup, 32)
        when raw_wakeup like 'Abort: Last active Wakeup Source: %' then substr(raw_wakeup, 35)
        when raw_wakeup like 'Abort: %' then substr(raw_wakeup, 8)
        else raw_wakeup
      end as main,
      case
        when raw_wakeup like 'Abort: Pending Wakeup Sources: %' then ' '
        when raw_wakeup like 'Abort: %' then 'no delimiter needed'
        else ':'
      end as delimiter
    from step5
  ),
  step7 as (
    select
      ts,
      dur,
      raw_wakeup,
      attribution,
      suspend_quality,
      backoff_state,
      backoff_reason,
      backoff_count,
      backoff_millis,
      type,
      str_split(main, delimiter, 0) as item_0,
      str_split(main, delimiter, 1) as item_1,
      str_split(main, delimiter, 2) as item_2,
      str_split(main, delimiter, 3) as item_3
    from step6
  ),
  step8 as (
    select ts, dur, raw_wakeup, attribution, suspend_quality, backoff_state, backoff_reason, backoff_count, backoff_millis, type, item_0 as item from step7
    union all
    select ts, dur, raw_wakeup, attribution, suspend_quality, backoff_state, backoff_reason, backoff_count, backoff_millis, type, item_1 as item from step7 where item_1 is not null
    union all
    select ts, dur, raw_wakeup, attribution, suspend_quality, backoff_state, backoff_reason, backoff_count, backoff_millis, type, item_2 as item from step7 where item_2 is not null
    union all
    select ts, dur, raw_wakeup, attribution, suspend_quality, backoff_state, backoff_reason, backoff_count, backoff_millis, type, item_3 as item from step7 where item_3 is not null
  )
  select
    ts,
    dur,
    ts + dur as ts_end,
    raw_wakeup,
    attribution,
    suspend_quality,
    backoff_state,
    ifnull(backoff_reason, 'none') as backoff_reason,
    backoff_count,
    backoff_millis,
    type,
    case when type = 'normal' then ifnull(str_split(item, ' ', 1), item) else item end as item
  from step8`);var n=(await r.query(`select
          item,
          sum(dur) as sum_dur
      from wakeups
      group by 1
      having sum_dur > 600e9`)).iter({item:"str"}),a=`select
                ts,
                dur,
                item || case backoff_reason
                  when 'short' then ' (Short suspend backoff)'
                  when 'failed' then ' (Failed suspend backoff)'
                  else ''
                end as name,
                item,
                type,
                raw_wakeup,
                attribution,
                suspend_quality,
                backoff_state,
                backoff_reason,
                backoff_count,
                backoff_millis
            from wakeups`,i=[];let e=!1;for(;n.valid();n.next())e=!0,this.addSliceTrack(t,"Wakeup "+n.item,a+` where item="${n.item}"`,"Wakeups",o),i.push(n.item);this.addSliceTrack(t,e?"Other wakeups":"Wakeups",a+` where item not in ('${i.join("','")}')`,"Wakeups",o)}}async addHighCpu(e,t){if(t.has("atom.cpu_cycles_per_uid_cluster")){t=e.engine;await t.query(`
  create or replace perfetto table high_cpu as
  with cpu_cycles_args AS (
    select
      arg_set_id,
      min(iif(key = 'cpu_cycles_per_uid_cluster.uid', int_value, null)) as uid,
      min(iif(key = 'cpu_cycles_per_uid_cluster.cluster', int_value, null)) as cluster,
      min(iif(key = 'cpu_cycles_per_uid_cluster.time_millis', int_value, null)) as time_millis
    from args
    where key in (
      'cpu_cycles_per_uid_cluster.uid',
      'cpu_cycles_per_uid_cluster.cluster',
      'cpu_cycles_per_uid_cluster.time_millis'
    )
    group by 1
  ),
  interesting AS (
    select uid, cluster
    from (
      select uid, cluster, max(time_millis)-min(time_millis) as delta_ms
      from cpu_cycles_args
      group by 1, 2
    )
    -- Only consider tracks with over 1 second of cpu during the whole trace
    where delta_ms > 1e3
  ),
  base as (
    select ts, uid, cluster, sum(time_millis) as time_millis
    from cpu_cycles_args
    join interesting using (uid, cluster)
    join slice using (arg_set_id)
    group by 1, 2, 3
  ),
  with_windows as (
    select
      ts,
      uid,
      cluster,
      lead(ts) over (partition by uid, cluster order by ts) - ts as dur,
      (lead(time_millis) over (partition by uid, cluster order by ts) - time_millis) * 1000000.0 as cpu_dur
    from base
  ),
  with_ratio as (
    select
      ts,
      iif(dur is null, 0, max(0, 100.0 * cpu_dur / dur)) as value,
      case cluster when 0 then 'little' when 1 then 'mid' when 2 then 'big' else 'cl-' || cluster end as cluster,
      package_name as pkg
    from add_package_name!(with_windows)
  )
  select ts, sum(value) as value, cluster, pkg
  from with_ratio
  group by 1, 3, 4`);for(var r=(await t.query("select distinct pkg, cluster from high_cpu where value > 10 order by 1, 2")).iter({pkg:"str",cluster:"str"});r.valid();r.next())this.addCounterTrack(e,`CPU (${r.cluster}): `+r.pkg,`select ts, value from high_cpu where pkg = "${r.pkg}" and cluster="${r.cluster}"`,"CPU per UID (major users)",{yOverrideMaximum:100,unit:"%"})}}async addBluetooth(e,t){Array.from(t.values()).some(e=>e.startsWith("atom.bluetooth_")||e.startsWith("atom.ble_"))&&(this.addSliceTrack(e,"BLE Scans (opportunistic)",r("opportunistic"),t="Bluetooth"),this.addSliceTrack(e,"BLE Scans (filtered)",r("filtered"),t),this.addSliceTrack(e,"BLE Scans (unfiltered)",r("not filtered"),t),this.addSliceTrack(e,"BLE Scan Results",`
  with step1 as (
      select
          ts,
          extract_arg(arg_set_id, 'ble_scan_result_received.attribution_node[0].tag') as name,
          extract_arg(arg_set_id, 'ble_scan_result_received.num_results') as num_results
      from track t join slice s on t.id = s.track_id
      where t.name = 'Statsd Atoms'
      and s.name = 'ble_scan_result_received'
  )
  select
      ts,
      0 as dur,
      name || ' (' || num_results || ' results)' as name
  from step1`,t),this.addSliceTrack(e,"Connections (ACL)",`
    with acl1 as (
        select
            ts,
            EXTRACT_ARG(arg_set_id, 'bluetooth_acl_connection_state_changed.state') as state,
            EXTRACT_ARG(arg_set_id, 'bluetooth_acl_connection_state_changed.transport') as transport,
            EXTRACT_ARG(arg_set_id, 'bluetooth_acl_connection_state_changed.metric_id') as metric_id
        from track t join slice s on t.id = s.track_id
        where t.name = 'Statsd Atoms'
        and s.name = 'bluetooth_acl_connection_state_changed'
    ),
    acl2 as (
        select
            ts,
            lead(ts) over (partition by metric_id, transport order by ts) - ts as dur,
            state,
            transport,
            metric_id
        from acl1
    )
    select
        ts,
        dur,
        'Device ' || metric_id ||
          ' (' || case transport when 'TRANSPORT_TYPE_BREDR' then 'Classic' when 'TRANSPORT_TYPE_LE' then 'BLE' end || ')' as name
    from acl2
    where state != 'CONNECTION_STATE_DISCONNECTED' and dur is not null`,t),this.addSliceTrack(e,"Connections (SCO)",`
  with sco1 as (
    select
        ts,
        EXTRACT_ARG(arg_set_id, 'bluetooth_sco_connection_state_changed.state') as state,
        EXTRACT_ARG(arg_set_id, 'bluetooth_sco_connection_state_changed.codec') as codec,
        EXTRACT_ARG(arg_set_id, 'bluetooth_sco_connection_state_changed.metric_id') as metric_id
    from track t join slice s on t.id = s.track_id
    where t.name = 'Statsd Atoms'
    and s.name = 'bluetooth_sco_connection_state_changed'
  ),
  sco2 as (
    select
        ts,
        lead(ts) over (partition by metric_id, codec order by ts) - ts as dur,
        state,
        codec,
        metric_id
    from sco1
  )
  select
    ts,
    dur,
    case state when 'CONNECTION_STATE_CONNECTED' then '' when 'CONNECTION_STATE_CONNECTING' then 'Connecting ' when 'CONNECTION_STATE_DISCONNECTING' then 'Disconnecting ' else 'unknown ' end ||
      'Device ' || metric_id || ' (' ||
      case codec when 'SCO_CODEC_CVSD' then 'CVSD' when 'SCO_CODEC_MSBC' then 'MSBC' end || ')' as name
  from sco2
  where state != 'CONNECTION_STATE_DISCONNECTED' and dur is not null`,t),this.addSliceTrack(e,"Link-level Events",`
  with base as (
    select
        ts,
        EXTRACT_ARG(arg_set_id, 'bluetooth_link_layer_connection_event.direction') as direction,
        EXTRACT_ARG(arg_set_id, 'bluetooth_link_layer_connection_event.type') as type,
        EXTRACT_ARG(arg_set_id, 'bluetooth_link_layer_connection_event.hci_cmd') as hci_cmd,
        EXTRACT_ARG(arg_set_id, 'bluetooth_link_layer_connection_event.hci_event') as hci_event,
        EXTRACT_ARG(arg_set_id, 'bluetooth_link_layer_connection_event.hci_ble_event') as hci_ble_event,
        EXTRACT_ARG(arg_set_id, 'bluetooth_link_layer_connection_event.cmd_status') as cmd_status,
        EXTRACT_ARG(arg_set_id, 'bluetooth_link_layer_connection_event.reason_code') as reason_code,
        EXTRACT_ARG(arg_set_id, 'bluetooth_link_layer_connection_event.metric_id') as metric_id
    from track t join slice s on t.id = s.track_id
    where t.name = 'Statsd Atoms'
    and s.name = 'bluetooth_link_layer_connection_event'
  )
  select
    *,
    0 as dur,
    'Device '|| metric_id as name
  from base`,t,n),this.addSliceTrack(e,"A2DP Audio",`
  with step1 as (
    select
        ts,
        EXTRACT_ARG(arg_set_id, 'bluetooth_a2dp_playback_state_changed.playback_state') as playback_state,
        EXTRACT_ARG(arg_set_id, 'bluetooth_a2dp_playback_state_changed.audio_coding_mode') as audio_coding_mode,
        EXTRACT_ARG(arg_set_id, 'bluetooth_a2dp_playback_state_changed.metric_id') as metric_id
    from track t join slice s on t.id = s.track_id
    where t.name = 'Statsd Atoms'
    and s.name = 'bluetooth_a2dp_playback_state_changed'
  ),
  step2 as (
    select
        ts,
        lead(ts) over (partition by metric_id order by ts) - ts as dur,
        playback_state,
        audio_coding_mode,
        metric_id
    from step1
  )
  select
    ts,
    dur,
    audio_coding_mode as name
  from step2
  where playback_state = 'PLAYBACK_STATE_PLAYING'`,t),this.addSliceTrack(e,"Bytes Transferred (L2CAP/RFCOMM)",`
  with step1 as (
    select
        ts,
        EXTRACT_ARG(arg_set_id, 'bluetooth_bytes_transfer.uid') as uid,
        EXTRACT_ARG(arg_set_id, 'bluetooth_bytes_transfer.tx_bytes') as tx_bytes,
        EXTRACT_ARG(arg_set_id, 'bluetooth_bytes_transfer.rx_bytes') as rx_bytes
    from track t join slice s on t.id = s.track_id
    where t.name = 'Statsd Atoms'
    and s.name = 'bluetooth_bytes_transfer'
  ),
  step2 as (
    select
        ts,
        lead(ts) over (partition by uid order by ts) - ts as dur,
        uid,
        lead(tx_bytes) over (partition by uid order by ts) - tx_bytes as tx_bytes,
        lead(rx_bytes) over (partition by uid order by ts) - rx_bytes as rx_bytes
    from step1
  ),
  step3 as (
    select
        ts,
        dur,
        uid % 100000 as uid,
        sum(tx_bytes) as tx_bytes,
        sum(rx_bytes) as rx_bytes
    from step2
    where tx_bytes >=0 and rx_bytes >=0
    group by 1,2,3
    having tx_bytes > 0 or rx_bytes > 0
  )
    select
        ts,
        dur,
        format("%s: TX %d bytes / RX %d bytes", package_name, tx_bytes, rx_bytes) as name
    from add_package_name!(step3)
`,t),await e.engine.query(`
  create perfetto table bt_activity as
  with step1 as (
    select
        EXTRACT_ARG(arg_set_id, 'bluetooth_activity_info.timestamp_millis') * 1000000 as ts,
        EXTRACT_ARG(arg_set_id, 'bluetooth_activity_info.bluetooth_stack_state') as bluetooth_stack_state,
        EXTRACT_ARG(arg_set_id, 'bluetooth_activity_info.controller_idle_time_millis') * 1000000 as controller_idle_dur,
        EXTRACT_ARG(arg_set_id, 'bluetooth_activity_info.controller_tx_time_millis') * 1000000 as controller_tx_dur,
        EXTRACT_ARG(arg_set_id, 'bluetooth_activity_info.controller_rx_time_millis') * 1000000 as controller_rx_dur
    from track t join slice s on t.id = s.track_id
    where t.name = 'Statsd Atoms'
    and s.name = 'bluetooth_activity_info'
  ),
  step2 as (
    select
        ts,
        lead(ts) over (order by ts) - ts as dur,
        bluetooth_stack_state,
        lead(controller_idle_dur) over (order by ts) - controller_idle_dur as controller_idle_dur,
        lead(controller_tx_dur) over (order by ts) - controller_tx_dur as controller_tx_dur,
        lead(controller_rx_dur) over (order by ts) - controller_rx_dur as controller_rx_dur
    from step1
  )
  select
    ts,
    dur,
    bluetooth_stack_state & 0x0000000F as acl_active_count,
    bluetooth_stack_state & 0x000000F0 >> 4 as acl_sniff_count,
    bluetooth_stack_state & 0x00000F00 >> 8 as acl_ble_count,
    bluetooth_stack_state & 0x0000F000 >> 12 as advertising_count,
    case bluetooth_stack_state & 0x000F0000 >> 16
      when 0 then 0
      when 1 then 5
      when 2 then 10
      when 3 then 25
      when 4 then 100
      else -1
    end as le_scan_duty_cycle,
    bluetooth_stack_state & 0x00100000 >> 20 as inquiry_active,
    bluetooth_stack_state & 0x00200000 >> 21 as sco_active,
    bluetooth_stack_state & 0x00400000 >> 22 as a2dp_active,
    bluetooth_stack_state & 0x00800000 >> 23 as le_audio_active,
    max(0, 100.0 * controller_idle_dur / dur) as controller_idle_pct,
    max(0, 100.0 * controller_tx_dur / dur) as controller_tx_pct,
    max(0, 100.0 * controller_rx_dur / dur) as controller_rx_pct
  from step2
`),this.addCounterTrack(e,"ACL Classic Active Count","select ts, dur, acl_active_count as value from bt_activity",t),this.addCounterTrack(e,"ACL Classic Sniff Count","select ts, dur, acl_sniff_count as value from bt_activity",t),this.addCounterTrack(e,"ACL BLE Count","select ts, dur, acl_ble_count as value from bt_activity",t),this.addCounterTrack(e,"Advertising Instance Count","select ts, dur, advertising_count as value from bt_activity",t),this.addCounterTrack(e,"LE Scan Duty Cycle Maximum","select ts, dur, le_scan_duty_cycle as value from bt_activity",t,{unit:"%"}),this.addSliceTrack(e,"Inquiry Active","select ts, dur, 'Active' as name from bt_activity where inquiry_active",t),this.addSliceTrack(e,"SCO Active","select ts, dur, 'Active' as name from bt_activity where sco_active",t),this.addSliceTrack(e,"A2DP Active","select ts, dur, 'Active' as name from bt_activity where a2dp_active",t),this.addSliceTrack(e,"LE Audio Active","select ts, dur, 'Active' as name from bt_activity where le_audio_active",t),this.addCounterTrack(e,"Controller Idle Time","select ts, dur, controller_idle_pct as value from bt_activity",t,{yRangeSharingKey:"bt_controller_time",unit:"%"}),this.addCounterTrack(e,"Controller TX Time","select ts, dur, controller_tx_pct as value from bt_activity",t,{yRangeSharingKey:"bt_controller_time",unit:"%"}),this.addCounterTrack(e,"Controller RX Time","select ts, dur, controller_rx_pct as value from bt_activity",t,{yRangeSharingKey:"bt_controller_time",unit:"%"}),this.addSliceTrack(e,"Quality reports",`
  with base as (
      select
          ts,
          EXTRACT_ARG(arg_set_id, 'bluetooth_quality_report_reported.quality_report_id') as quality_report_id,
          EXTRACT_ARG(arg_set_id, 'bluetooth_quality_report_reported.packet_types') as packet_types,
          EXTRACT_ARG(arg_set_id, 'bluetooth_quality_report_reported.connection_handle') as connection_handle,
          EXTRACT_ARG(arg_set_id, 'bluetooth_quality_report_reported.connection_role') as connection_role,
          EXTRACT_ARG(arg_set_id, 'bluetooth_quality_report_reported.tx_power_level') as tx_power_level,
          EXTRACT_ARG(arg_set_id, 'bluetooth_quality_report_reported.rssi') as rssi,
          EXTRACT_ARG(arg_set_id, 'bluetooth_quality_report_reported.snr') as snr,
          EXTRACT_ARG(arg_set_id, 'bluetooth_quality_report_reported.unused_afh_channel_count') as unused_afh_channel_count,
          EXTRACT_ARG(arg_set_id, 'bluetooth_quality_report_reported.afh_select_unideal_channel_count') as afh_select_unideal_channel_count,
          EXTRACT_ARG(arg_set_id, 'bluetooth_quality_report_reported.lsto') as lsto,
          EXTRACT_ARG(arg_set_id, 'bluetooth_quality_report_reported.connection_piconet_clock') as connection_piconet_clock,
          EXTRACT_ARG(arg_set_id, 'bluetooth_quality_report_reported.retransmission_count') as retransmission_count,
          EXTRACT_ARG(arg_set_id, 'bluetooth_quality_report_reported.no_rx_count') as no_rx_count,
          EXTRACT_ARG(arg_set_id, 'bluetooth_quality_report_reported.nak_count') as nak_count,
          EXTRACT_ARG(arg_set_id, 'bluetooth_quality_report_reported.flow_off_count') as flow_off_count,
          EXTRACT_ARG(arg_set_id, 'bluetooth_quality_report_reported.buffer_overflow_bytes') as buffer_overflow_bytes,
          EXTRACT_ARG(arg_set_id, 'bluetooth_quality_report_reported.buffer_underflow_bytes') as buffer_underflow_bytes
      from track t join slice s on t.id = s.track_id
      where t.name = 'Statsd Atoms'
      and s.name = 'bluetooth_quality_report_reported'
  )
  select
      *,
      0 as dur,
      'Connection '|| connection_handle as name
  from base`,t,a),this.addSliceTrack(e,"RSSI Reports",`
  with base as (
    select
        ts,
        EXTRACT_ARG(arg_set_id, 'bluetooth_device_rssi_reported.connection_handle') as connection_handle,
        EXTRACT_ARG(arg_set_id, 'bluetooth_device_rssi_reported.hci_status') as hci_status,
        EXTRACT_ARG(arg_set_id, 'bluetooth_device_rssi_reported.rssi') as rssi,
        EXTRACT_ARG(arg_set_id, 'bluetooth_device_rssi_reported.metric_id') as metric_id
    from track t join slice s on t.id = s.track_id
    where t.name = 'Statsd Atoms'
    and s.name = 'bluetooth_device_rssi_reported'
  )
  select
    *,
    0 as dur,
    'Connection '|| connection_handle as name
  from base`,t,i),this.addSliceTrack(e,"HAL Crashes",`
  with base as (
      select
          ts,
          EXTRACT_ARG(arg_set_id, 'bluetooth_hal_crash_reason_reported.metric_id') as metric_id,
          EXTRACT_ARG(arg_set_id, 'bluetooth_hal_crash_reason_reported.error_code') as error_code,
          EXTRACT_ARG(arg_set_id, 'bluetooth_hal_crash_reason_reported.vendor_error_code') as vendor_error_code
      from track t join slice s on t.id = s.track_id
      where t.name = 'Statsd Atoms'
      and s.name = 'bluetooth_hal_crash_reason_reported'
  )
  select
      *,
      0 as dur,
      'Device ' || metric_id as name
  from base`,t,u),this.addSliceTrack(e,"Code Path Counter",`
  with base as (
    select
        ts,
        EXTRACT_ARG(arg_set_id, 'bluetooth_code_path_counter.key') as key,
        EXTRACT_ARG(arg_set_id, 'bluetooth_code_path_counter.number') as number
    from track t join slice s on t.id = s.track_id
    where t.name = 'Statsd Atoms'
    and s.name = 'bluetooth_code_path_counter'
  )
  select
    *,
    0 as dur,
    key as name
  from base`,t,c))}async addContainedTraces(r,e){var t=new Map;for(const n of e)t.has(n.subscription)||t.set(n.subscription,[]),t.get(n.subscription).push(n);t.forEach((e,t)=>this.addSliceTrack(r,t,e.map(e=>`SELECT
          CAST(${e.ts} * 1e6 AS int) AS ts,
          CAST(${e.dur} * 1e6 AS int) AS dur,
          '${""===e.trigger?"Trace":e.trigger}' AS name,
          'http://go/trace-uuid/${e.uuid}' AS link
        `).join(" UNION ALL "),"Other traces",["link"]))}async findFeatures(r){const n=new Set;var e=async e=>{for(var t=(await r.query(e)).iter({feature:"str"});t.valid();t.next())n.add(t.feature)};return await e(`
      select distinct 'atom.' || s.name as feature
      from track t join slice s on t.id = s.track_id
      where t.name = 'Statsd Atoms'`),await e(`
      select distinct
        case when name like '%wlan%' then 'net.wifi'
            when name like '%rmnet%' then 'net.modem'
            else 'net.other'
        end as feature
      from track
      where name like '%Transmitted' or name like '%Received'`),await e(`
      select distinct 'track.' || lower(name) as feature
      from track where name in ('RIL', 'suspend_backoff') or name like 'battery_stats.%'`),await e(`
      select distinct 'track.battery_stats.*' as feature
      from track where name like 'battery_stats.%'`),n}async addTracks(e){var t=await this.findFeatures(e.engine),r=e.openerPluginArgs?.containedTraces??[];await e.engine.query(`
  create or replace perfetto table package_name_lookup as
  with installed as (
    select uid, string_agg(package_name, ',') as name
    from package_list
    where uid >= 10000
    group by 1
  ),
  system(uid, name) as (
    values
      (0, 'AID_ROOT'),
      (1000, 'AID_SYSTEM_USER'),
      (1001, 'AID_RADIO'),
      (1082, 'AID_ARTD')
  )
  select uid, name from installed
  union all
  select uid, name from system
  order by uid;

  -- Adds a "package_name" column by joining on "uid" from the source table.
  create or replace perfetto macro add_package_name(src TableOrSubquery) returns TableOrSubquery as (
    select A.*, ifnull(B.name, "uid=" || A.uid) as package_name
    from $src as A
    left join package_name_lookup as B
    on (B.uid = (A.uid % 100000))
  );
`),await this.addNetworkSummary(e,t),await this.addModemDetail(e,t),await this.addKernelWakelocks(e,t),await this.addWakeups(e,t),await this.addDeviceState(e,t),await this.addHighCpu(e,t),await this.addBluetooth(e,t),await this.addContainedTraces(e,r)}async onTraceLoad(e){await this.addTracks(e)}}}}return Vp}var $p,zp={};var Kp,Yp={};var Jp,Zp={};var Qp,Xp={};var eh,th={};var rh,nh={};var ah,ih={};var oh,sh={};var lh,ch={};function uh(){if(!lh){lh=1,Object.defineProperty(ch,"__esModule",{value:!0}),ch.plugin=void 0;const e=ue(),t=kl();class a extends t.NamedSliceTrack{upid;constructor(e,t){super(e),this.upid=t}getRowSpec(){return t.NAMED_ROW}rowToSlice(e){return this.rowToSliceBase(e)}getSqlSource(){return`
      SELECT *
      FROM gpu_slice
      WHERE upid = ${this.upid}
    `}}ch.plugin={pluginId:"dev.perfetto.GpuByProcess",plugin:class{async onTraceLoad(t){for(var r=(await t.engine.query(`
      WITH slice_upids AS (
        SELECT DISTINCT upid FROM gpu_slice
      )
      SELECT upid, pid, name FROM slice_upids JOIN process USING (upid)
    `)).iter({upid:e.NUM_NULL,pid:e.NUM_NULL,name:e.STR_NULL});r.valid();r.next())if(null!=r.upid){const n=r.upid;let e="Unknown";null!=r.name?e=r.name:null!=r.pid&&(e=""+r.pid),t.registerStaticTrack({uri:"dev.perfetto.GpuByProcess#"+n,title:"GPU "+e,trackFactory:({trackKey:e})=>new a({engine:t.engine,trackKey:e},n)})}}async onTraceUnload(e){}}}}return ch}var dh,fh={};var ph,hh={},gh={},mh={},_h={};function yh(){return ph||(ph=1,Object.defineProperty(_h,"__esModule",{value:!0}),_h.expandProcessName=function(e){return e.includes("systemui")?"com.android.systemui":e.includes("launcher")?"com.google.android.apps.nexuslauncher":e}),_h}var Th,bh,vh={};function Eh(){return Th||(Th=1,Object.defineProperty(vh,"__esModule",{value:!0}),vh.PLUGIN_ID=void 0,vh.PLUGIN_ID="dev.perfetto.PinAndroidPerfMetrics"),vh}var Sh,Ah={};var Oh,Ch,kh,wh={};function Rh(){var e,t,r;return Ch||(Ch=1,Object.defineProperty(gh,"__esModule",{value:!0}),gh.METRIC_HANDLERS=void 0,e=function(){if(!bh){bh=1,Object.defineProperty(mh,"__esModule",{value:!0}),mh.pinBlockingCallHandlerInstance=void 0;const t=yh(),i=Eh(),o=jp(),s=Bp();mh.pinBlockingCallHandlerInstance=new class{match(e){e=/perfetto_android_blocking_call-cuj-name-(?<process>.*)-name-(?<cujName>.*)-blocking_calls-name-(?<blockingCallName>([^\-]*))-(?<aggregation>.*)/.exec(e);if(e?.groups)return{process:(0,t.expandProcessName)(e.groups.process),cujName:e.groups.cujName,blockingCallName:e.groups.blockingCallName,aggregation:e.groups.aggregation}}addMetricTrack(e,t,r){this.pinSingleCuj(t,e,r);var n=i.PLUGIN_ID+"#BlockingCallSlices#"+e,{config:e,trackName:a}=this.blockingCallTrackConfig(e);(0,s.addAndPinSliceTrack)(t,e,a,r,n)}pinSingleCuj(e,t,r){var n=i.PLUGIN_ID+"#BlockingCallCUJ#"+t,a="Jank CUJ: "+t.cujName;(0,o.addJankCUJDebugTrack)(e,a,r,t.cujName,n)}blockingCallTrackConfig(e){var t=e.cujName,r=e.process;return{config:{data:{sqlSource:`
  SELECT name, ts, dur
  FROM main_thread_slices_scoped_to_cujs
  WHERE process_name = "${r}"
      AND cuj_name = "${t}"
      AND name = "${e.blockingCallName}"
  `,columns:["name","ts","dur"]},columns:{ts:"ts",dur:"dur",name:"name"},argColumns:["name","ts","dur"]},trackName:"Blocking calls in "+r}}}}return mh}(),t=function(){if(!Sh){Sh=1,Object.defineProperty(Ah,"__esModule",{value:!0}),Ah.pinCujScopedJankInstance=void 0;const t=yh(),r=Z(),i=jp(),o=Bp(),s=Eh(),n=K();Ah.pinCujScopedJankInstance=new class{match(e){e=/perfetto_cuj_(?<process>.*)-(?<cujName>.*)-.*-missed_(?<jankType>frames|sf_frames|app_frames)/.exec(e);if(e?.groups)return{process:(0,t.expandProcessName)(e.groups.process),cujName:e.groups.cujName,jankType:e.groups.jankType}}async addMetricTrack(e,t,r){var{config:n,trackName:a}=await this.cujScopedTrackConfig(e,t),e=(this.pinSingleCuj(t,e,r),s.PLUGIN_ID+"#CUJScopedJankSlice#"+e);(0,o.addAndPinSliceTrack)(t,n,a,r,e),await this.focusOnFirstJank(t)}pinSingleCuj(e,t,r){var n=s.PLUGIN_ID+"#CUJScopedBoundaryTimes#"+t,a="Jank CUJ: "+t.cujName;(0,i.addJankCUJDebugTrack)(e,a,r,t.cujName,n)}async cujScopedTrackConfig(e,t){let r,n="all";e.jankType?.includes("app")?(r=" AND app_missed > 0",n="app"):e.jankType?.includes("sf")&&(r=" AND sf_missed > 0",n="sf");var a=e.cujName,e=e.process,a=`
    CREATE PERFETTO TABLE _janky_frames_during_cuj_from_metric_key AS
    SELECT
      f.vsync as id,
      f.ts AS ts,
      f.dur as dur
    FROM android_jank_cuj_frame f LEFT JOIN android_jank_cuj cuj USING (cuj_id)
    WHERE cuj.process_name = "${e}" 
    AND cuj_name = "${a}" ${r}
    `;await t.engine.query(a);return{config:{data:{sqlSource:`
    SELECT id, ts, dur 
    FROM _janky_frames_during_cuj_from_metric_key
    `,columns:["id","ts","dur"]},columns:{ts:"ts",dur:"dur",name:"id"},argColumns:["id","ts","dur"]},trackName:n+" missed frames in "+e}}async findFirstJank(e){e=(await e.engine.query(`
      SELECT slice_id, track_id, ts, dur FROM slice
        WHERE type = "actual_frame_timeline_slice"
        AND name =
        CAST(
        (SELECT id FROM _janky_frames_during_cuj_from_metric_key LIMIT 1)
        AS VARCHAR(20) );
    `)).firstRow({slice_id:r.NUM,track_id:r.NUM,ts:r.LONG,dur:r.LONG});return{sliceId:e.slice_id,trackId:e.track_id,ts:n.Time.fromRaw(e.ts),dur:e.dur}}async focusOnFirstJank(e){e=await this.findFirstJank(e);await(0,o.focusOnSlice)(e)}}}return Ah}(),r=function(){if(!Oh){Oh=1,Object.defineProperty(wh,"__esModule",{value:!0}),wh.pinFullTraceJankInstance=void 0;const t=yh(),i=Bp(),o=Eh();wh.pinFullTraceJankInstance=new class{match(e){e=/perfetto_ft_(?<process>.*)-missed_(?<jankType>frames|sf_frames|app_frames)/.exec(e);if(e?.groups)return{process:(0,t.expandProcessName)(e.groups.process),jankType:e.groups.jankType}}async addMetricTrack(e,t,r){var n=o.PLUGIN_ID+"#FullTraceJank#"+e,{config:e,trackName:a}=this.fullTraceJankConfig(e);await t.engine.query(`
    INCLUDE PERFETTO MODULE android.frames.jank_type;
    INCLUDE PERFETTO MODULE slices.slices;
    `),(0,i.addAndPinSliceTrack)(t,e,a,r,n)}fullTraceJankConfig(e){let t,r="all";e.jankType?.includes("app")?(t=" android_is_app_jank_type(display_value)",r="app"):e.jankType?.includes("sf")&&(t=" android_is_sf_jank_type(display_value)",r="sf");var e=e.process,n=["name","ts","dur","track_id","slice_id","thread_dur","category","thread_name","tid","process_name","pid"];return{config:{data:{sqlSource:`
      WITH filtered_args AS (
        SELECT DISTINCT arg_set_id
        FROM args
        WHERE key = 'Jank type'
        ${t?"AND "+t:""}
      )
      SELECT
        name,
        ts as ts,
        dur as dur,
        track_id as track_id,
        id as slice_id,
        thread_dur as thread_dur,
        category,
        thread_name,
        tid as tid,
        process_name,
        pid as pid
      FROM _slice_with_thread_and_process_info
      JOIN filtered_args ON filtered_args.arg_set_id = _slice_with_thread_and_process_info.arg_set_id
      WHERE process_name = '${e}'`,columns:n},columns:{ts:"ts",dur:"dur",name:"name"},argColumns:n},trackName:r+" missed frames in "+e}}}}return wh}(),gh.METRIC_HANDLERS=[t.pinCujScopedJankInstance,e.pinBlockingCallHandlerInstance,r.pinFullTraceJankInstance]),gh}var Ih,Mh={};var Ph,Nh={};var Dh,xh,Lh={},Fh={};function de(){if(!Dh){Dh=1,Object.defineProperty(Fh,"__esModule",{value:!0}),Fh.Modal=void 0,Fh.maybeRenderFullscreenModalDialog=function(){if(void 0===i)return[];let e;e=void 0===i.content?null:"function"==typeof i.content?i.content():i.content;return[(0,l.default)(t,i,e)]},Fh.showModal=async function(e){const t=(0,c.defer)(),r=e.onClose??(()=>{}),n=e.key??""+ ++o,a={...e,key:n,onClose:()=>{r(),t.resolve()}};return i=a,(0,u.scheduleFullRedraw)(),t},Fh.redrawModal=function(){void 0!==i&&(0,u.scheduleFullRedraw)()},Fh.closeModal=s,Fh.getCurrentModalKey=function(){return i?.key};const l=or.__importDefault(ae()),c=Wa(),u=Tl();class t{onbeforeremove(e){const t=(0,c.defer)();return e.dom.addEventListener("animationend",()=>t.resolve()),e.dom.classList.add("modal-fadeout"),t}onremove(e){void 0!==e.attrs.onClose&&(e.attrs.onClose(),(0,u.scheduleFullRedraw)())}oncreate(e){e.dom instanceof HTMLElement&&((e.dom.querySelector(".modal-btn-primary")||e.dom).focus(),e.dom.scrollIntoView({block:"center"}))}view(e){const t=e.attrs;var r=[];for(const a of t.buttons||[])r.push((0,l.default)("button.modal-btn",{class:a.primary?"modal-btn-primary":"",id:a.id,onclick:()=>{s(t.key),void 0!==a.action&&a.action()}},a.text));var n="TOP"===t.vAlign?".modal-dialog-valign-top":"";return(0,l.default)(".modal-backdrop",{onclick:this.onBackdropClick.bind(this,t),onkeyup:this.onBackdropKeyupdown.bind(this,t),onkeydown:this.onBackdropKeyupdown.bind(this,t),tabIndex:0},(0,l.default)(`.modal-dialog${n}[aria-labelledby=mm-title][aria-model][role=dialog]`,(0,l.default)("header",(0,l.default)("h2",{id:"mm-title"},t.title),(0,l.default)("button[aria-label=Close Modal]",{onclick:()=>s(t.key)},l.default.trust("&#x2715"))),(0,l.default)("main",e.children),0<r.length?(0,l.default)("footer",r):null))}onBackdropClick(e,t){t.stopPropagation();t=t.target;t instanceof Element&&t.classList.contains("modal-backdrop")&&s(e.key)}onBackdropKeyupdown(e,t){t.stopPropagation(),"Escape"===t.key&&"keyup"!==t.type&&s(e.key)}}Fh.Modal=t;let i=void 0,o=0;function s(e){void 0===i||void 0!==e&&i.key!==e||(i=void 0,u.scheduleFullRedraw)()}}return Fh}var Uh,Bh={};var jh,Hh,Gh,Vh={},Wh={};function qh(){if(!jh){jh=1,Object.defineProperty(Wh,"__esModule",{value:!0}),Wh.AsyncSliceTrack=void 0;const e=kl(),n=xs();class t extends e.NamedSliceTrack{trackIds;constructor(e,t,r){super(e),this.trackIds=r,this.sliceLayout={...n.SLICE_LAYOUT_FIT_CONTENT_DEFAULTS,depthGuess:t}}getRowSpec(){return e.NAMED_ROW}rowToSlice(e){return this.rowToSliceBase(e)}getSqlSource(){return`
      select
        ts,
        dur,
        layout_depth as depth,
        ifnull(name, '[null]') as name,
        id,
        thread_dur as threadDur
      from experimental_slice_layout
      where filter_track_ids = '${this.trackIds.join(",")}'
    `}onUpdatedSlices(e){for(const t of e)t.isHighlighted=t===this.hoveredSlice}}Wh.AsyncSliceTrack=t}return Wh}function $h(){var e,t,r,n,a,i,o,s,l,c,u,d,f,p,h,g,m,_,y,T,b,v,E,S;Gh||(Gh=1,Object.defineProperty(gt,"__esModule",{value:!0}),e=gp(),t=function(){if(!mp){mp=1,Object.defineProperty(_p,"__esModule",{value:!0}),_p.plugin=void 0;var e=ue();_p.plugin={pluginId:"com.example.Skeleton",plugin:class{store=(0,e.createStore)({foo:"foo"});onActivate(e){}async onTraceLoad(e){this.store=e.mountStore(e=>({foo:"bar"})),this.store.edit(e=>{e.foo="baz"}),void 0!==e.openerPluginArgs&&console.log("Postmessage args for "+e.pluginId,e.openerPluginArgs)}async onTraceUnload(e){this.store[Symbol.dispose]()}onDeactivate(e){}metricVisualisations(e){return[]}}}}return _p}(),r=function(){if(!yp){yp=1,Object.defineProperty(Tp,"__esModule",{value:!0}),Tp.plugin=void 0;const r=$f();Tp.plugin={pluginId:"com.google.PixelMemory",plugin:class{async onTraceLoad(t){t.registerCommand({id:"dev.perfetto.PixelMemory#ShowTotalMemory",name:"Add tracks: show a process total memory",callback:async e=>{void 0===e&&null===(e=prompt("Enter a process pid",""))||(await t.engine.query(`
          INCLUDE PERFETTO MODULE android.gpu.memory;
          INCLUDE PERFETTO MODULE linux.memory.process;

          DROP TABLE IF EXISTS process_mem_rss_anon_file_shmem_swap_gpu;

          CREATE VIRTUAL TABLE process_mem_rss_anon_file_shmem_swap_gpu
          USING
            SPAN_OUTER_JOIN(
              android_gpu_memory_per_process PARTITIONED upid,
              memory_rss_and_swap_per_process PARTITIONED upid
            );
        `),await(0,r.addDebugCounterTrack)(t,{sqlSource:`
                SELECT
                  ts,
                  COALESCE(rss_and_swap, 0) + COALESCE(gpu_memory, 0) AS value
                FROM process_mem_rss_anon_file_shmem_swap_gpu
                WHERE pid = ${e}
            `,columns:["ts","value"]},e+"_rss_anon_file_swap_shmem_gpu",{ts:"ts",value:"value"}))}})}}}}return Tp}(),n=Ap(),a=function(){if(!Op){Op=1,Object.defineProperty(Cp,"__esModule",{value:!0}),Cp.plugin=void 0;Cp.plugin={pluginId:"dev.perfetto.AndroidBinderVizPlugin",plugin:class{metricVisualisations(){return[{metric:"android_binder",spec:`
{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": "container",
  "height": 300,
  "description": ".",
  "data": {
    "name": "metric"
  },
  "mark": "bar",
  "encoding": {
    "x": {"field": "client_process", "type": "nominal"},
    "y": {"field": "client_dur", "aggregate": "max"}
  }
}
`,path:["android_binder","unaggregated_txn_breakdown"]}]}}}}return Cp}(),i=function(){if(!kp){kp=1,Object.defineProperty(wp,"__esModule",{value:!0}),wp.plugin=void 0;const n=ue(),a=ue();wp.plugin={pluginId:"dev.perfetto.AndroidClientServer",plugin:class{async onTraceLoad(r){r.registerCommand({id:"dev.perfetto.AndroidClientServer#ThreadRuntimeIPC",name:"Show dependencies in client server model",callback:async e=>{if(void 0!==e||null!==(e=prompt("Enter a slice id",""))){await r.engine.query(`
          include perfetto module android.binder;
          include perfetto module graphs.search;

          create or replace perfetto table __binder_for_slice_${e} as
          with s as materialized (
            select slice.id, ts, ts + dur as ts_end, dur, upid
            from thread_slice slice
            where slice.id = ${e}
          ),
          child_binder_txns_for_slice as materialized (
            select
              (select id from s) as source_node_id,
              binder_txn_id as dest_node_id
            from descendant_slice((select id from s)) as desc
            join android_binder_txns txns on desc.id = txns.binder_txn_id
          ),
          binder_txns_in_slice_intervals as materialized (
            select
              binder_txn_id as source_node_id,
              binder_reply_id as dest_node_id
            from android_binder_txns
            where client_ts > (select ts from s)
              and client_ts < (select ts + dur from s)
          ),
          nested_binder_txns_in_slice_interval as materialized (
            select
              parent.binder_reply_id as source_node_id,
              child.binder_txn_id as dest_node_id
            from android_binder_txns parent
            join descendant_slice(parent.binder_reply_id) desc
            join android_binder_txns child on desc.id = child.binder_txn_id
            where parent.server_ts > (select ts from s)
              and parent.server_ts < (select ts + dur from s)
          ),
          all_binder_txns_considered as materialized (
            select * from child_binder_txns_for_slice
            union
            select * from binder_txns_in_slice_intervals
            union
            select * from nested_binder_txns_in_slice_interval
          )
          select
            dfs.node_id as id,
            coalesce(client.client_ts, server.client_ts, slice.ts) as ts,
            coalesce(client.client_dur, server.client_dur, slice.dur) as dur,
            coalesce(
              client.aidl_name,
              server.aidl_name,
              iif(
                server.binder_reply_id is not null,
                coalesce(
                  server.server_process,
                  server.server_thread,
                  'Unknown server'
                ),
                slice.name
              )
            ) name,
            coalesce(
              client.client_utid,
              server.server_utid,
              thread_track.utid
            ) as utid,
            case
              when client.binder_txn_id is not null then 'client'
              when server.binder_reply_id is not null then 'server'
              else 'slice'
            end as slice_type,
            coalesce(client.is_sync, server.is_sync, true) as is_sync
          from graph_reachable_dfs!(
            all_binder_txns_considered,
            (select id as node_id from s)
          ) dfs
          join slice on dfs.node_id = slice.id
          join thread_track on slice.track_id = thread_track.id
          left join android_binder_txns client on dfs.node_id = client.binder_txn_id
          left join android_binder_txns server on dfs.node_id = server.binder_reply_id
          order by ts;
        `),await r.engine.query(`
          include perfetto module intervals.intersect;

          create or replace perfetto table __enhanced_binder_for_slice_${e} as
          with foo as (
            select
              bfs.id as binder_id,
              bfs.name as binder_name,
              ii.ts,
              ii.dur,
              tstate.utid,
              thread.upid,
              tstate.cpu,
              tstate.state,
              tstate.io_wait,
              (
                select name
                from thread_slice tslice
                where tslice.utid = tstate.utid and tslice.ts < ii.ts
                order by ts desc
                limit 1
              ) as enclosing_slice_name
            from _interval_intersect!(
              (
                select id, ts, dur
                from __binder_for_slice_${e}
                where slice_type IN ('slice', 'server')
                  and is_sync
                  and dur > 0
              ),
              (
                select id, ts, dur
                from thread_state tstate
                where
                  tstate.utid in (
                    select distinct utid
                    from __binder_for_slice_${e}
                    where
                      slice_type IN ('slice', 'server')
                      and is_sync
                      and dur > 0
                  )
                  and dur > 0
              ),
              ()
            ) ii
            join __binder_for_slice_${e} bfs on ii.id_0 = bfs.id
            join thread_state tstate on ii.id_1 = tstate.id
            join thread using (utid)
            where bfs.utid = tstate.utid
          )
          select
            *,
            case
              when state = 'S' and enclosing_slice_name = 'binder transaction' then 'Waiting for server'
              when state = 'S' and enclosing_slice_name GLOB 'Lock*' then 'Waiting for lock'
              when state = 'S' and enclosing_slice_name GLOB 'Monitor*' then 'Waiting for contention'
              when state = 'S' then 'Sleeping'
              when state = 'R' then 'Waiting for CPU'
              when state = 'Running' then 'Running on CPU ' || foo.cpu
              when state GLOB 'R*' then 'Runnable'
              when state GLOB 'D*' and io_wait then 'IO'
              when state GLOB 'D*' and not io_wait then 'Unint-sleep'
            end as name
          from foo
          order by binder_id;
        `);for(var t=(await r.engine.query(`
          select id, name
          from __binder_for_slice_${e} bfs
          where slice_type IN ('slice', 'server')
            and dur > 0
          order by ts
        `)).iter({id:n.NUM,name:n.STR});t.valid();t.next())await(0,a.addDebugSliceTrack)(r,{sqlSource:`
                SELECT ts, dur, name
                FROM __enhanced_binder_for_slice_${e}
                WHERE binder_id = ${t.id}
              `},t.name,{ts:"ts",dur:"dur",name:"name"},[])}}})}}}}return wp}(),o=jp(),s=qp(),l=function(){if(!$p){$p=1,Object.defineProperty(zp,"__esModule",{value:!0}),zp.plugin=void 0;const a=ue();zp.plugin={pluginId:"dev.perfetto.AndroidNetwork",plugin:class{async addSimpleTrack(e,t,r,n){await(0,a.addDebugSliceTrack)(e,{sqlSource:`SELECT ${n.join(",")} FROM `+r,columns:n},t,{ts:n[0],dur:n[1],name:n[2]},n.slice(2))}async onTraceLoad(a){a.registerCommand({id:"dev.perfetto.AndroidNetwork#batteryEvents",name:"Add track: battery events",callback:async e=>{void 0===e&&null===(e=prompt("Battery Track",""))||(await a.engine.query("SELECT IMPORT('android.battery_stats');"),await this.addSimpleTrack(a,e,`(SELECT *
            FROM android_battery_stats_event_slices
            WHERE track_name = "${e}")`,["ts","dur","str_value","int_value"]))}}),a.registerCommand({id:"dev.perfetto.AndroidNetwork#activityTrack",name:"Add track: network activity",callback:async(e,t,r)=>{var n;void 0===e&&null===(e=prompt("Group by","package_name"))||void 0===t&&null===(t=prompt("Filter","TRUE"))||(n=(new Date).getTime(),await a.engine.query(`
          SELECT RUN_METRIC(
            'android/network_activity_template.sql',
            'view_name', 'android_network_activity_${n}',
            'group_by',  '${e}',
            'filter',    '${t}',
            'idle_ns',   '10e9',
            'quant_ns',  '3e9'
          );
        `),t=e.replaceAll(" ","").split(","),await this.addSimpleTrack(a,r??"Network Activity","android_network_activity_"+n,["ts","dur",...t,"packet_length","packet_count"]))}})}}}}return zp}(),c=function(){if(!Kp){Kp=1,Object.defineProperty(Yp,"__esModule",{value:!0}),Yp.plugin=void 0;const a=ue();Yp.plugin={pluginId:"dev.perfetto.AndroidPerf",plugin:class{async addAppProcessStartsDebugTrack(e,t,r){var n=["id","ts","dur","reason","process_name","intent","table_name"];await(0,a.addDebugSliceTrack)(e,{sqlSource:`
                    SELECT
                      start_id AS id,
                      proc_start_ts AS ts,
                      total_dur AS dur,
                      reason,
                      process_name,
                      intent,
                      'slice' AS table_name
                    FROM _android_app_process_starts
                    WHERE reason = '${t}'
                 `,columns:n},"app_"+r+"_start reason: "+t,{ts:"ts",dur:"dur",name:r},n)}async onTraceLoad(t){t.registerCommand({id:"dev.perfetto.AndroidPerf#BinderSystemServerIncoming",name:"Run query: system_server incoming binder graph",callback:()=>t.tabs.openQuery(`INCLUDE PERFETTO MODULE android.binder;
           SELECT * FROM android_binder_incoming_graph((SELECT upid FROM process WHERE name = 'system_server'))`,"system_server incoming binder graph")}),t.registerCommand({id:"dev.perfetto.AndroidPerf#BinderSystemServerOutgoing",name:"Run query: system_server outgoing binder graph",callback:()=>t.tabs.openQuery(`INCLUDE PERFETTO MODULE android.binder;
           SELECT * FROM android_binder_outgoing_graph((SELECT upid FROM process WHERE name = 'system_server'))`,"system_server outgoing binder graph")}),t.registerCommand({id:"dev.perfetto.AndroidPerf#MonitorContentionSystemServer",name:"Run query: system_server monitor_contention graph",callback:()=>t.tabs.openQuery(`INCLUDE PERFETTO MODULE android.monitor_contention;
           SELECT * FROM android_monitor_contention_graph((SELECT upid FROM process WHERE name = 'system_server'))`,"system_server monitor_contention graph")}),t.registerCommand({id:"dev.perfetto.AndroidPerf#BinderAll",name:"Run query: all process binder graph",callback:()=>t.tabs.openQuery(`INCLUDE PERFETTO MODULE android.binder;
           SELECT * FROM android_binder_graph(-1000, 1000, -1000, 1000)`,"all process binder graph")}),t.registerCommand({id:"dev.perfetto.AndroidPerf#ThreadClusterDistribution",name:"Run query: runtime cluster distribution for a thread",callback:async e=>{void 0===e&&null===(e=prompt("Enter a thread tid",""))||t.tabs.openQuery(`
          INCLUDE PERFETTO MODULE android.cpu.cluster_type;
          WITH
            total_runtime AS (
              SELECT sum(dur) AS total_runtime
              FROM sched s
              LEFT JOIN thread t
                USING (utid)
              WHERE t.tid = ${e}
            )
            SELECT
              c.cluster_type AS cluster,
              sum(dur)/1e6 AS total_dur_ms,
              sum(dur) * 1.0 / (SELECT * FROM total_runtime) AS percentage
            FROM sched s
            LEFT JOIN thread t
              USING (utid)
            LEFT JOIN android_cpu_cluster_mapping c
              USING (cpu)
            WHERE t.tid = ${e}
            GROUP BY 1`,"runtime cluster distrubtion for tid "+e)}}),t.registerCommand({id:"dev.perfetto.AndroidPerf#SchedLatency",name:"Run query: top 50 sched latency for a thread",callback:async e=>{void 0===e&&null===(e=prompt("Enter a thread tid",""))||t.tabs.openQuery(`
          SELECT ts.*, t.tid, t.name, tt.id AS track_id
          FROM thread_state ts
          LEFT JOIN thread_track tt
           USING (utid)
          LEFT JOIN thread t
           USING (utid)
          WHERE ts.state IN ('R', 'R+') AND tid = ${e}
           ORDER BY dur DESC
          LIMIT 50`,"top 50 sched latency slice for tid "+e)}}),t.registerCommand({id:"dev.perfetto.AndroidPerf#AppProcessStarts",name:"Add tracks: app process starts",callback:async()=>{await t.engine.query("INCLUDE PERFETTO MODULE android.app_process_starts;");for(const e of["activity","service","broadcast","provider"])await this.addAppProcessStartsDebugTrack(t,e,"process_name")}}),t.registerCommand({id:"dev.perfetto.AndroidPerf#AppIntentStarts",name:"Add tracks: app intent starts",callback:async()=>{await t.engine.query("INCLUDE PERFETTO MODULE android.app_process_starts;");for(const e of["activity","service","broadcast"])await this.addAppProcessStartsDebugTrack(t,e,"intent")}})}}}}return Yp}(),u=function(){if(!Jp){Jp=1,Object.defineProperty(Zp,"__esModule",{value:!0}),Zp.plugin=void 0;const n=ue();Zp.plugin={pluginId:"dev.perfetto.AndroidPerfTraceCounters",plugin:class{async onTraceLoad(r){0!==(await r.engine.query(`
  SELECT
    str_value
  FROM metadata
  WHERE
    name = 'trace_config_pbtxt'
    AND str_value GLOB '*ftrace_events: "perf_trace_counters/sched_switch_with_ctrs"*'
`)).numRows()&&r.registerCommand({id:"dev.perfetto.AndroidPerfTraceCounters#ThreadRuntimeIPC",name:"Add a track to show a thread runtime ipc",callback:async e=>{var t;void 0===e&&null===(e=prompt("Enter a thread tid",""))||(t=`
          WITH
            sched_switch_ipc AS (
              SELECT
                ts,
                EXTRACT_ARG(arg_set_id, 'prev_pid') AS tid,
                EXTRACT_ARG(arg_set_id, 'prev_comm') AS thread_name,
                EXTRACT_ARG(arg_set_id, 'inst') / (EXTRACT_ARG(arg_set_id, 'cyc') * 1.0) AS ipc,
                EXTRACT_ARG(arg_set_id, 'inst') AS instruction,
                EXTRACT_ARG(arg_set_id, 'cyc') AS cycle,
                EXTRACT_ARG(arg_set_id, 'stallbm') AS stall_backend_mem,
                EXTRACT_ARG(arg_set_id, 'l3dm') AS l3_cache_miss
              FROM ftrace_event
              WHERE name = 'sched_switch_with_ctrs' AND tid = ${e}
            ),
            target_thread_sched_slice AS (
              SELECT s.*, t.tid, t.name FROM sched s LEFT JOIN thread t USING (utid)
                WHERE t.tid = ${e}
            ),
            target_thread_ipc_slice AS (
              SELECT
                (
                  SELECT
                    ts
                  FROM target_thread_sched_slice ts
                  WHERE ts.tid = ssi.tid AND ts.ts < ssi.ts
                  ORDER BY ts.ts DESC
                  LIMIT 1
                ) AS ts,
                (
                  SELECT
                    dur
                  FROM target_thread_sched_slice ts
                  WHERE ts.tid = ssi.tid AND ts.ts < ssi.ts
                  ORDER BY ts.ts DESC
                  LIMIT 1
                ) AS dur,
                ssi.ipc,
                ssi.instruction,
                ssi.cycle,
                ssi.stall_backend_mem,
                ssi.l3_cache_miss
              FROM sched_switch_ipc ssi
            )
        `,await(0,n.addDebugSliceTrack)(r,{sqlSource:t+`
              SELECT * FROM target_thread_ipc_slice WHERE ts IS NOT NULL`},"Rutime IPC:"+e,{ts:"ts",dur:"dur",name:"ipc"},["instruction","cycle","stall_backend_mem","l3_cache_miss"]),r.tabs.openQuery(t+`
            SELECT
              (sum(instruction) * 1.0 / sum(cycle)*1.0) AS avg_ipc,
              sum(dur)/1e6 as total_runtime_ms,
              sum(instruction) AS total_instructions,
              sum(cycle) AS total_cycles,
              sum(stall_backend_mem) as total_stall_backend_mem,
              sum(l3_cache_miss) as total_l3_cache_miss
            FROM target_thread_ipc_slice WHERE ts IS NOT NULL`,"target thread ipc statistic"))}})}}}}return Zp}(),d=function(){if(!Qp){Qp=1,Object.defineProperty(Xp,"__esModule",{value:!0}),Xp.plugin=void 0;const n=ue(),a=Np();Xp.plugin={pluginId:"dev.perfetto.AndroidStartup",plugin:class{async onTraceLoad(t){var e=t.engine,e=(await e.query("include perfetto module android.startup.startups;"),await e.query("select count() cnt from android_startups"));if(0n!==e.firstRow({cnt:n.LONG}).cnt){const r={data:{sqlSource:`
          SELECT l.ts AS ts, l.dur AS dur, l.package AS name
          FROM android_startups l
        `,columns:["ts","dur","name"]},columns:{ts:"ts",dur:"dur",name:"name"},argColumns:[]};t.registerStaticTrack({uri:"/android_startups",title:"Android App Startups",trackFactory:e=>new a.SimpleSliceTrack(t.engine,e,r)})}}}}}return Xp}(),f=function(){if(!eh){eh=1,Object.defineProperty(th,"__esModule",{value:!0}),th.plugin=void 0;th.plugin={pluginId:"dev.perfetto.BookmarkletApi",plugin:class{pluginCtx;onActivate(e){this.pluginCtx=e,window.ctx=e}async onTraceLoad(e){window.ctx=e}async onTraceUnload(e){window.ctx=this.pluginCtx}onDeactivate(e){window.ctx=void 0}}}}return th}(),p=function(){if(!rh){rh=1,Object.defineProperty(nh,"__esModule",{value:!0}),nh.plugin=void 0;const t=ue();nh.plugin={pluginId:"dev.perfetto.Chaos",plugin:class{onActivate(e){e.registerCommand({id:"dev.perfetto.Chaos#CrashNow",name:"Chaos: crash now",callback:()=>{throw new Error("Manual crash from dev.perfetto.Chaos#CrashNow")}})}async onTraceLoad(e){e.registerCommand({id:"dev.perfetto.Chaos#CrashNowQuery",name:"Chaos: run crashing query",callback:()=>{e.engine.query(`this is a
          syntactically
          invalid
          query
          over
          many
          lines
        `)}}),e.registerCommand({id:"dev.perfetto.Chaos#AddCrashingDebugTrack",name:"Chaos: add crashing debug track",callback:()=>{(0,t.addDebugSliceTrack)(e,{sqlSource:`
            syntactically
            invalid
            query
            over
            many
          `},"Chaos track",{ts:"ts",dur:"dur",name:"name"},[])}})}async onTraceUnload(e){}onDeactivate(e){}}}}return nh}(),h=function(){if(!ah){ah=1,Object.defineProperty(ih,"__esModule",{value:!0}),ih.plugin=void 0;ih.plugin={pluginId:"dev.perfetto.ExampleSimpleCommand",plugin:class{onActivate(e){e.registerCommand({id:"dev.perfetto.ExampleSimpleCommand#LogHelloWorld",name:'Log "Hello, world!"',callback:()=>console.log("Hello, world!")})}}}}return ih}(),g=function(){if(!oh){oh=1,Object.defineProperty(sh,"__esModule",{value:!0}),sh.plugin=void 0;const t=z();var e=ue();sh.plugin={pluginId:"dev.perfetto.ExampleState",plugin:class{store=(0,e.createStore)({counter:0});migrate(e){return(0,t.exists)(e)&&"object"==typeof e&&"counter"in e&&"number"==typeof e.counter?{counter:e.counter}:{counter:0}}async onTraceLoad(t){this.store=t.mountStore(e=>this.migrate(e)),t.registerCommand({id:"dev.perfetto.ExampleState#ShowCounter",name:"Show ExampleState counter",callback:()=>{var e=this.store.state.counter;t.tabs.openQuery(`SELECT ${e} as counter;`,"Show counter "+e),this.store.edit(e=>{++e.counter})}})}async onTraceUnload(e){this.store[Symbol.dispose]()}}}}return sh}(),m=uh(),_=function(){if(!dh){dh=1,Object.defineProperty(fh,"__esModule",{value:!0}),fh.plugin=void 0;fh.plugin={pluginId:"dev.perfetto.LargeScreensPerf",plugin:class{async onTraceLoad(e){e.registerCommand({id:"dev.perfetto.LargeScreensPerf#PinUnfoldLatencyTracks",name:"Pin: Unfold latency tracks",callback:()=>{e.timeline.pinTracksByPredicate(e=>!!e.title.includes("UnfoldTransition")||e.title.includes("Screen on blocked")||e.title.includes("hingeAngle")||e.title.includes("UnfoldLightRevealOverlayAnimation")||e.title.startsWith("waitForAllWindowsDrawn")||e.title.endsWith("UNFOLD_ANIM>")||e.title.endsWith("UNFOLD>")||"Waiting for KeyguardDrawnCallback#onDrawn"==e.title||"FoldedState"==e.title||"FoldUpdate"==e.title)}})}}}}return fh}(),y=function(){if(!kh){kh=1,Object.defineProperty(hh,"__esModule",{value:!0}),hh.plugin=void 0;const n=Rh(),a=Eh();hh.plugin={pluginId:a.PLUGIN_ID,plugin:class{metrics=[];onActivate(){this.metrics=this.getMetricsFromHash()}async onTraceLoad(t){t.registerCommand({id:"dev.perfetto.PinAndroidPerfMetrics#PinAndroidPerfMetrics",name:"Add and Pin: Jank Metric Slice",callback:async e=>{null!==(e=prompt("Metrics names (seperated by comma)",""))&&(e=e.split(","),this.callHandlers(e,t,"debug"))}}),0!==this.metrics.length&&this.callHandlers(this.metrics,t,"static")}async callHandlers(e,t,r){e=this.getMetricsToShow(e);if(0!==e.length){await t.engine.query(`
  SELECT RUN_METRIC('android/android_blocking_calls_cuj_metric.sql');
`);for(var{metricData:n,metricHandler:a}of e)a.addMetricTrack(n,t,r)}}getMetricsFromHash(){var e=location.hash,t=new RegExp(a.PLUGIN_ID+":metrics=(.*)"),e=e.match(t);if(null===e)return[];t=e[1];let r=[];return(r=t.includes("--")?t.split("--"):[t]).map(e=>decodeURIComponent(e))}getMetricsToShow(e){const t=[];return e.forEach(e=>{e=this.matchMetricToHandler(e);e&&t.push(e)}),t}matchMetricToHandler(e){for(const r of n.METRIC_HANDLERS){var t=r.match(e);if(t)return{metricData:t,metricHandler:r}}return null}}}}return hh}(),T=function(){if(!Ih){Ih=1,Object.defineProperty(Mh,"__esModule",{value:!0}),Mh.plugin=void 0;const n=ue(),a=["Actual Timeline","Expected Timeline","ndroid.systemui","IKeyguardService","Transition:","L<","UI Events"];Mh.plugin={pluginId:"dev.perfetto.PinSysUITracks",plugin:class{async onTraceLoad(e){var t=await e.engine.query(`
      INCLUDE PERFETTO MODULE android.process_metadata;
      select
        _process_available_info_summary.upid
      from _process_available_info_summary
      join process using(upid)
      where process.name = 'com.android.systemui';
    `);if(0!==t.numRows()){const r=t.firstRow({upid:n.NUM}).upid;e.registerCommand({id:"dev.perfetto.PinSysUITracks#PinSysUITracks",name:"Pin: System UI Related Tracks",callback:()=>{e.timeline.pinTracksByPredicate(t=>!!t.uri.startsWith("/process_"+r)&&!!a.some(e=>t.title.startsWith(e))),e.timeline.expandGroupsByPredicate(e=>e.displayName?.startsWith("com.android.systemui")??!1)}})}}}}}return Mh}(),b=function(){if(!Ph){Ph=1,Object.defineProperty(Nh,"__esModule",{value:!0}),Nh.plugin=void 0;const t="dev.perfetto.RestorePinnedTrack",n=t+"#savedPerfettoTracks";Nh.plugin={pluginId:t,plugin:class{onActivate(e){}ctx;async onTraceLoad(e){(this.ctx=e).registerCommand({id:t+"#save",name:"Save: Pinned tracks",callback:()=>{this.saveTracks()}}),e.registerCommand({id:t+"#restore",name:"Restore: Pinned tracks",callback:()=>{this.restoreTracks()}})}saveTracks(){var e=this.ctx.timeline.tracks.filter(e=>e.isPinned).map(e=>({groupName:e.groupName,trackName:e.title}));window.localStorage.setItem(n,JSON.stringify(e))}restoreTracks(){var e=window.localStorage.getItem(n);if(e){e=JSON.parse(e);const r=this.ctx.timeline.tracks;e.forEach(t=>{var e=r.find(e=>e.key&&t.trackName===e.title&&t.groupName===e.groupName);e?this.ctx.timeline.pinTrack(e.key):(e=r.find(e=>e.key&&this.removeNumbers(t.trackName)===this.removeNumbers(e.title)&&this.removeNumbers(t.groupName)===this.removeNumbers(e.groupName)))?this.ctx.timeline.pinTrack(e.key):console.warn("[RestorePinnedTracks] No track found that matches",t)})}else alert("No saved tracks. Use the Save command first")}removeNumbers(e){return e?.replace(/\d+/g,"")}}}}return Nh}(),v=function(){if(!xh){xh=1,Object.defineProperty(Lh,"__esModule",{value:!0}),Lh.plugin=void 0;const s=or.__importDefault(ae()),a=K(),n=de(),i=ee();var e="dev.perfetto.TimelineSync";const o=1000000000n;Lh.plugin={pluginId:e,plugin:class{_chan;_ctx;_traceLoadTime=0;_clientId=Math.floor(1e6*Math.random());_lastReceivedUpdateMillis=0;_lastViewportBounds;_advertisedClients=new Map;_sessionId=0;_sessionidFromUrl=0;_initialBoundsForSibling=new Map;onActivate(e){e.registerCommand({id:"dev.perfetto.SplitScreen#enableTimelineSync",name:"Enable timeline sync with other Perfetto UI tabs",callback:()=>this.showTimelineSyncDialog()}),e.registerCommand({id:"dev.perfetto.SplitScreen#disableTimelineSync",name:"Disable timeline sync",callback:()=>this.disableTimelineSync(this._sessionId)}),e.registerCommand({id:"dev.perfetto.SplitScreen#toggleTimelineSync",name:"Toggle timeline sync with other PerfettoUI tabs",callback:()=>this.toggleTimelineSync(),defaultHotkey:"Mod+Alt+S"}),this._chan=new BroadcastChannel("dev.perfetto.TimelineSync#broadcastChannel"),this._chan.onmessage=this.onmessage.bind(this),document.addEventListener("visibilitychange",()=>this.advertise()),window.addEventListener("focus",()=>this.advertise()),setInterval(()=>this.advertise(),1e4);e=/dev.perfetto.TimelineSync:enable(=\d+)?/.exec(location.hash);null!==e&&(this._sessionidFromUrl=e[1]?parseInt(e[1].substring(1)):1)}onDeactivate(e){this.disableTimelineSync(this._sessionId)}async onTraceLoad(e){this._ctx=e,this._traceLoadTime=Date.now(),this.advertise(),0!==this._sessionidFromUrl&&this.enableTimelineSync(this._sessionidFromUrl)}async onTraceUnload(e){this.disableTimelineSync(this._sessionId),this._ctx=void 0}advertise(){void 0!==this._ctx&&this._chan?.postMessage({perfettoSync:{cmd:"MSG_ADVERTISE",title:document.title,traceLoadTime:this._traceLoadTime},clientId:this._clientId})}toggleTimelineSync(){0===this._sessionId?this.showTimelineSyncDialog():this.disableTimelineSync(this._sessionId)}showTimelineSyncDialog(){let o;(0,n.showModal)({title:"Synchronize timeline across several tabs",content:()=>{var e,t,r=[],n=(this.purgeInactiveClients(),Array.from(this._advertisedClients.entries()));n.sort((e,t)=>t[1].traceLoadTime-e[1].traceLoadTime);for([e,t]of n){var a=new Date(t.traceLoadTime).toLocaleTimeString(),i={value:e};1===this._advertisedClients.size&&(i.selected=!0),r.push((0,s.default)("option",i,t.title+` (${a})`))}return(0,s.default)("div",{style:"display: flex;  flex-direction: column;"},(0,s.default)("div","Select the perfetto UI tab(s) you want to keep in sync (Ctrl+Click to select many)."),(0,s.default)("div","If you don't see the trace listed here, temporarily focus the corresponding browser tab and then come back here."),(0,s.default)("select[multiple=multiple][size=8]",{oncreate:e=>{o=e.dom}},r))},buttons:[{primary:!0,text:"Synchronize timelines",action:()=>{this.disableTimelineSync(this._sessionId);var t=new Array,r=(0,i.assertExists)(o).selectedOptions;for(let e=0;e<r.length;e++){var n=parseInt(r[e].value);isNaN(n)||t.push(n)}t.push(this._clientId),this._sessionId=Math.floor(1e6*Math.random()),this._chan?.postMessage({perfettoSync:{cmd:"MSG_SESSION_START",sessionId:this._sessionId,clients:t},clientId:this._clientId}),this._initialBoundsForSibling.clear(),this.scheduleViewportUpdateMessage()}}]})}enableTimelineSync(e){e!==this._sessionId&&(this._sessionId=e,this._initialBoundsForSibling.clear(),this.scheduleViewportUpdateMessage())}disableTimelineSync(e,t=!1){e===this._sessionId&&0!==this._sessionId&&(t||this._chan?.postMessage({perfettoSync:{cmd:"MSG_SESSION_STOP",sessionId:this._sessionId},clientId:this._clientId}),this._sessionId=0,this._initialBoundsForSibling.clear())}shouldThrottleViewportUpdates(){return Date.now()-this._lastReceivedUpdateMillis<=1e3}scheduleViewportUpdateMessage(){var e;this.active&&(e=this.getCurrentViewportBounds(),this._lastViewportBounds&&this._lastViewportBounds.equals(e)||this.shouldThrottleViewportUpdates()||(this.sendViewportBounds(e),this._lastViewportBounds=e),requestAnimationFrame(this.scheduleViewportUpdateMessage.bind(this)))}sendViewportBounds(e){this._chan?.postMessage({perfettoSync:{cmd:"MSG_SET_VIEWPORT",sessionId:this._sessionId,viewportBounds:e},clientId:this._clientId})}onmessage(e){if(void 0!==this._ctx&&"perfettoSync"in e.data){var t=e.data,r=t.perfettoSync;switch(r.cmd){case"MSG_ADVERTISE":t.clientId!==this._clientId&&(this._advertisedClients.set(t.clientId,{title:r.title,traceLoadTime:r.traceLoadTime,lastHeartbeat:Date.now()}),this.purgeInactiveClients(),(0,n.redrawModal)());break;case"MSG_SESSION_START":r.clients.includes(this._clientId)&&this.enableTimelineSync(r.sessionId);break;case"MSG_SESSION_STOP":this.disableTimelineSync(r.sessionId,!0);break;case"MSG_SET_VIEWPORT":r.sessionId===this._sessionId&&this.onViewportSyncReceived(r.viewportBounds,t.clientId)}}}onViewportSyncReceived(e,t){this.active&&(this.cacheSiblingInitialBoundIfNeeded(e,t),e=this.remapViewportBounds(e,t),this.getCurrentViewportBounds().equals(e)||(this._lastReceivedUpdateMillis=Date.now(),this._lastViewportBounds=e,this._ctx?.timeline.setViewportTime(e.start,e.end)))}cacheSiblingInitialBoundIfNeeded(e,t){this._initialBoundsForSibling.has(t)||this._initialBoundsForSibling.set(t,{thisWindow:this.getCurrentViewportBounds(),otherWindow:e})}remapViewportBounds(e,t){var t=this._initialBoundsForSibling.get(t),r=t.otherWindow,t=t.thisWindow,[r,e]=this.percentageChange(r.start,r.end,e.start,e.end),n=t.end-t.start;return new a.TimeSpan(a.Time.fromRaw(t.start+n*r/o),a.Time.fromRaw(t.start+n*e/o))}percentageChange(e,t,r,n){t-=e,n-=e;return[this.divide(r-e,t),this.divide(n,t)]}divide(e,t){return e*o/t}getCurrentViewportBounds(){return this._ctx.timeline.viewport}purgeInactiveClients(){var e,t,r=Date.now();for([e,t]of this._advertisedClients.entries())r-t.lastHeartbeat<3e4||this._advertisedClients.delete(e)}get active(){return 0!==this._sessionId}}}}return Lh}(),E=function(){if(!Uh){Uh=1,Object.defineProperty(Bh,"__esModule",{value:!0}),Bh.plugin=void 0;const e=ue(),r=Np();Bh.plugin={pluginId:"dev.perfetto.TraceMetadata",plugin:class{async onTraceLoad(t){0!==(await t.engine.query(`
      select count() as cnt from (select 1 from clock_snapshot limit 1)
    `)).firstRow({cnt:e.NUM}).cnt&&t.registerStaticTrack({uri:"/clock_snapshots",title:"Clock Snapshots",trackFactory:e=>new r.SimpleSliceTrack(t.engine,e,{data:{sqlSource:`
              select ts, 0 as dur, 'Snapshot' as name
              from clock_snapshot
            `,columns:["ts","dur","name"]},columns:{ts:"ts",dur:"dur",name:"name"},argColumns:[]})})}}}}return Bh}(),S=function(){if(!Hh){Hh=1,Object.defineProperty(Vh,"__esModule",{value:!0}),Vh.plugin=void 0;const a=ue(),i=qh(),o=ue();Vh.plugin={pluginId:"org.kernel.LinuxKernelDevices",plugin:class{async onTraceLoad(t){for(var e=(await t.engine.query(`
      select
        t.id as trackId,
        t.name
      from linux_device_track t
      join _slice_track_summary using (id)
      order by t.name;
    `)).iter({name:a.STR_NULL,trackId:a.NUM});e.valid();e.next()){const n=e.trackId;var r=e.name??""+n;t.registerStaticTrack({uri:"/kernel_devices/"+r,title:r,trackFactory:({trackKey:e})=>new i.AsyncSliceTrack({engine:t.engine,trackKey:e},0,[n]),tags:{kind:o.ASYNC_SLICE_TRACK_KIND,trackIds:[n]},groupName:"Linux Kernel Devices"})}}}}}return Vh}(),e.pluginRegistry.register(t.plugin),e.pluginRegistry.register(r.plugin),e.pluginRegistry.register(n.plugin),e.pluginRegistry.register(a.plugin),e.pluginRegistry.register(i.plugin),e.pluginRegistry.register(o.plugin),e.pluginRegistry.register(s.plugin),e.pluginRegistry.register(l.plugin),e.pluginRegistry.register(c.plugin),e.pluginRegistry.register(u.plugin),e.pluginRegistry.register(d.plugin),e.pluginRegistry.register(f.plugin),e.pluginRegistry.register(p.plugin),e.pluginRegistry.register(h.plugin),e.pluginRegistry.register(g.plugin),e.pluginRegistry.register(m.plugin),e.pluginRegistry.register(_.plugin),e.pluginRegistry.register(y.plugin),e.pluginRegistry.register(T.plugin),e.pluginRegistry.register(b.plugin),e.pluginRegistry.register(v.plugin),e.pluginRegistry.register(E.plugin),e.pluginRegistry.register(S.plugin))}var zh,Kh={},Yh={},Jh={},Zh={};function Qh(){if(!zh){zh=1,Object.defineProperty(Zh,"__esModule",{value:!0}),Zh.Monitor=void 0;Zh.Monitor=class{reducers;cached;constructor(e){this.reducers=e,this.cached=e.map(()=>{})}ifStateChanged(e){const r=this.cached;var t=this.reducers.map(e=>e());return!!(this.cached=t).some((e,t)=>e!==r[t])&&(e?.(),!0)}}}return Zh}var Xh,eg,tg,rg={},ng={},ag={};function ig(){return Xh||(Xh=1,Object.defineProperty(ag,"__esModule",{value:!0}),ag.intersectRects=function(e,t){return{top:Math.max(e.top,t.top),left:Math.max(e.left,t.left),bottom:Math.min(e.bottom,t.bottom),right:Math.min(e.right,t.right)}},ag.expandRect=function(e,t){return{top:e.top-t,left:e.left-t,bottom:e.bottom+t,right:e.right+t}},ag.rebaseRect=function(e,t,r){return{left:e.left-t,right:e.right-t,top:e.top-r,bottom:e.bottom-r}},ag.rectSize=function(e){return{width:e.right-e.left,height:e.bottom-e.top}},ag.containsRect=function(e,t){return!(t.top<e.top||t.bottom>e.bottom||t.left<e.left||t.right>e.right)},ag.translateRect=function(e,t){return{top:e.top+t.y,left:e.left+t.x,bottom:e.bottom+t.y,right:e.right+t.x}}),ag}function og(){if(!eg){eg=1,Object.defineProperty(ng,"__esModule",{value:!0}),ng.VirtualScrollHelper=void 0;var e=or,t=V();const u=e.__importStar(ig());class r{_trash=new t.DisposableStack;_data=[];constructor(s,l,e=[]){this._data=e.map(e=>({opts:e}));const t=()=>{this._data.forEach(e=>{var t,r=s,n=l,{tolerancePx:a,overdrawPx:i,callback:o}=e.opts;e.rect?(t=n.getBoundingClientRect(),t=u.expandRect(t,a),a=r.getBoundingClientRect(),t=u.intersectRects(t,a),a=u.translateRect(e.rect,{x:a.x,y:a.y}),u.containsRect(a,t)||(a=c(r,n,i),o(a),e.rect=a)):(t=c(r,n,i),o(t),e.rect=t)})},r=(l.addEventListener("scroll",t,{passive:!0}),this._trash.defer(()=>l.removeEventListener("scroll",t)),new ResizeObserver(()=>{t()}));r.observe(l),r.observe(s),this._trash.defer(()=>{r.disconnect()})}[Symbol.dispose](){this._trash.dispose()}}function c(e,t,r){e=e.getBoundingClientRect(),t=t.getBoundingClientRect(),t=u.intersectRects(t,e),t=u.expandRect(t,r),r=u.intersectRects(t,e);return u.rebaseRect(r,e.x,e.y)}ng.VirtualScrollHelper=r}return ng}function sg(){if(!tg){tg=1,Object.defineProperty(rg,"__esModule",{value:!0}),rg.VirtualTable=void 0;const c=or.__importDefault(ae()),s=hl(),l=ee(),u=Tl(),d=og();var e=V();rg.VirtualTable=class{CONTAINER_REF="CONTAINER";SLIDER_REF="SLIDER";trash=new e.DisposableStack;renderBounds={rowStart:0,rowEnd:0};view({attrs:e}){var{columns:t,className:r,numRows:n,rowHeight:a,style:i}=e;return(0,c.default)(".pf-vtable",{className:r,style:i,ref:this.CONTAINER_REF},(0,c.default)(".pf-vtable-content",(0,c.default)(".pf-vtable-header",t.map(e=>(0,c.default)(".pf-vtable-data",{style:{width:e.width}},e.header))),(0,c.default)(".pf-vtable-slider",{ref:this.SLIDER_REF,style:{height:a*n+"px"}},(0,c.default)(".pf-vtable-puck",{style:{transform:`translateY(${this.renderBounds.rowStart*a}px)`}},this.renderContent(e)))))}renderContent(t){var r=[];for(let e=this.renderBounds.rowStart;e<this.renderBounds.rowEnd;++e)r.push(this.renderRow(t,e));return r}renderRow(e,t){const{rows:r,firstRowOffset:n,rowHeight:a,columns:i,onRowHover:o,onRowOut:s}=e;if(n<=t&&t<n+r.length){const l=r[t-n];return(0,c.default)(".pf-vtable-row",{className:l.className,style:{height:a+"px"},onmouseover:()=>{o?.(l.id)},onmouseout:()=>{s?.(l.id)}},l.cells.map((e,t)=>(0,c.default)(".pf-vtable-data",{style:{width:i[t].width}},e)))}return(0,c.default)("",{style:{height:a+"px"}})}oncreate({dom:e,attrs:r}){var{renderOverdrawPx:t=200,renderTolerancePx:n=100,queryOverdrawPx:a=1e4,queryTolerancePx:i=5e3}=r,o=(0,s.toHTMLElement)((0,l.assertExists)((0,s.findRef)(e,this.SLIDER_REF))),e=(0,l.assertExists)((0,s.findRef)(e,this.CONTAINER_REF)),o=new d.VirtualScrollHelper(o,e,[{overdrawPx:t,tolerancePx:n,callback:({top:e,bottom:t})=>{t-=e,e=2*Math.floor(e/r.rowHeight/2),t=2*Math.ceil(t/r.rowHeight/2);this.renderBounds={rowStart:e,rowEnd:e+t},(0,u.scheduleFullRedraw)()}},{overdrawPx:a,tolerancePx:i,callback:({top:e,bottom:t})=>{e=2*Math.floor(e/r.rowHeight/2),t=Math.ceil(t/r.rowHeight);r.onReload?.(e,t-e)}}]);this.trash.use(o)}onremove(e){this.trash.dispose()}}}return rg}var lg,cg,ug={};function dg(){if(!lg){lg=1,Object.defineProperty(ug,"__esModule",{value:!0}),ug.TagInput=void 0;const d=or.__importDefault(ae()),f=al(),p=hl();ug.TagInput=class{view({attrs:e}){const{value:t,onChange:r,tags:n,onTagAdd:a,onTagRemove:i,onfocus:o,onblur:s,placeholder:l,...c}=e,u=void 0!==t;return(0,d.default)(".pf-tag-input",{onclick:e=>{e=e.currentTarget,e=(0,p.findRef)(e,"input");e&&e.focus()},...c},n.map((e,t)=>{return e=e,r=()=>i(t),(0,d.default)("span.pf-tag",e,(0,d.default)(f.Icon,{icon:"close",onclick:()=>{r()}}));var r}),(0,d.default)("input",{ref:"input",value:t,placeholder:l,onkeydown:e=>{var t;"Enter"===e.key?""!==(t=e.target).value.trim()&&(a(t.value),u||(t.value="")):"Backspace"===e.key&&""===e.target.value&&0!==n.length&&(t=n.length-1,i(t))},oninput:e=>{e=e.target;r?.(e.value)},onfocus:o,onblur:s}))}}}return ug}function fg(){if(!cg){cg=1;{var d=Jh;Object.defineProperty(d,"__esModule",{value:!0}),d.LogsFilters=d.LOG_PRIORITIES=d.LogPanel=void 0;const f=or.__importDefault(ae()),p=K(),n=ne(),i=ie(),a=F(),o=oe(),h=x(),g=ue(),t=Qh();var e=qa();const s=os(),l=Cc(),c=le(),r=Oc(),u=sg(),m=Qs(),_=dg();d.LogPanel=class{entries;pagination={offset:0,count:0};rowsMonitor;filterMonitor;queryLimiter=new e.AsyncLimiter;constructor({attrs:e}){this.rowsMonitor=new t.Monitor([()=>e.filterStore.state,()=>o.globals.timeline.visibleWindow.toTimeSpan().start,()=>o.globals.timeline.visibleWindow.toTimeSpan().end]),this.filterMonitor=new t.Monitor([()=>e.filterStore.state])}view({attrs:r}){this.rowsMonitor.ifStateChanged()&&this.reloadData(r);var e=this.entries&&0<this.entries.processName.filter(e=>e).length,t=this.entries?.totalEvents??0;return(0,f.default)(a.DetailsShell,{title:"Android Logs",description:"Total messages: "+t,buttons:(0,f.default)(v,{store:r.filterStore})},(0,f.default)(u.VirtualTable,{className:"pf-android-logs-table",columns:[{header:"Timestamp",width:"13em"},{header:"Level",width:"4em"},{header:"Tag",width:"13em"},...e?[{header:"Process",width:"18em"}]:[],{header:"Message",width:""}],rows:this.renderRows(e),firstRowOffset:this.entries?.offset??0,numRows:this.entries?.totalEvents??0,rowHeight:20,onReload:(e,t)=>{this.pagination={offset:e,count:t},this.reloadData(r)},onRowHover:e=>{e=this.entries?.timestamps[e];void 0!==e&&o.globals.dispatch(n.Actions.setHoverCursorTimestamp({ts:e}))},onRowOut:()=>{o.globals.dispatch(n.Actions.setHoverCursorTimestamp({ts:p.Time.INVALID}))}}))}reloadData(a){this.queryLimiter.schedule(async()=>{var e=o.globals.timeline.visibleWindow.toTimeSpan();if(this.filterMonitor.ifStateChanged()){{var t=a.engine;var r=a.filterStore.state;await t.query("drop view if exists filtered_logs");var n=function(e,t){return e?`msg glob ${(0,s.escapeGlob)(t)} as is_msg_chosen,
      (process.name is not null and process.name glob ${(0,s.escapeGlob)(t)}) as is_process_chosen,
      0 as is_msg_highlighted,
      0 as is_process_highlighted`:t?`1 as is_msg_chosen,
      1 as is_process_chosen,
      msg glob ${(0,s.escapeGlob)(t)} as is_msg_highlighted,
      (process.name is not null and process.name glob ${(0,s.escapeGlob)(t)}) as is_process_highlighted`:`1 as is_msg_chosen,
      1 as is_process_chosen,
      0 as is_msg_highlighted,
      0 as is_process_highlighted`}(r.hideNonMatching,r.textEntry);let e=`select prio, ts, tag, msg,
      process.name as process_name, ${n}
      from android_logs
      left join thread using(utid)
      left join process using(upid)
      where prio >= `+r.minimumLevel;r.tags.length&&(e+=` and tag in (${function(e){return e.map(e=>(0,s.escapeQuery)(e)).join()}(r.tags)})`);await t.query(`create view filtered_logs as select *
    from (${e})
    where is_msg_chosen is 1 or is_process_chosen is 1`)}await 0}this.entries=await async function(e,t,r){var n=await e.query(`
        select
          ts,
          prio,
          ifnull(tag, '[NULL]') as tag,
          ifnull(msg, '[NULL]') as msg,
          is_msg_highlighted as isMsgHighlighted,
          is_process_highlighted as isProcessHighlighted,
          ifnull(process_name, '') as processName
        from filtered_logs
        where ts >= ${t.start} and ts <= ${t.end}
        order by ts
        limit ${r.offset}, ${r.count}
    `),a=[],i=[],o=[],s=[],l=[],c=[],u=n.iter({ts:g.LONG,prio:g.NUM,tag:g.STR,msg:g.STR,isMsgHighlighted:g.NUM_NULL,isProcessHighlighted:g.NUM,processName:g.STR});for(;u.valid();u.next())a.push(p.Time.fromRaw(u.ts)),i.push(u.prio),o.push(u.tag),s.push(u.msg),l.push(1===u.isMsgHighlighted||1===u.isProcessHighlighted),c.push(u.processName);n=await e.query(`
    select
      count(*) as totalEvents
    from filtered_logs
    where ts >= ${t.start} and ts <= ${t.end}
  `),e=n.firstRow({totalEvents:g.NUM}).totalEvents;return{offset:r.offset,timestamps:a,priorities:i,tags:o,messages:s,isHighlighted:l,processName:c,totalEvents:e}}(a.engine,e,this.pagination),i.raf.scheduleFullRedraw()})}renderRows(t){if(!this.entries)return[];var r=this.entries.timestamps,n=this.entries.priorities,a=this.entries.tags,i=this.entries.messages,o=this.entries.processName,s=[];for(let e=0;e<this.entries.timestamps.length;e++){var l=d.LOG_PRIORITIES[n[e]][0],c=r[e],u=l??"";s.push({id:e,className:(0,m.classNames)(u,this.entries.isHighlighted[e]&&"pf-highlighted"),cells:[(0,f.default)(h.Timestamp,{ts:c}),l||"?",a[e],...t?[o[e]]:[],i[e]]})}return s}},d.LOG_PRIORITIES=["-","-","Verbose","Debug","Info","Warn","Error","Fatal"];class y{view(e){const t=e.attrs;var r=[];for(let e=2;e<t.options.length;e++){var n=e===t.selectedIndex;r.push((0,f.default)("option",{value:e,selected:n},t.options[e]))}return(0,f.default)(l.Select,{onchange:e=>{e=e.target.value;t.onSelect(Number(e))}},r)}}class T{view({attrs:t}){return(0,f.default)(r.TextInput,{placeholder:"Search logs...",onkeyup:e=>{e=e.target;t.onChange(e.value)}})}}class b{view({attrs:e}){var t=e.hideNonMatching?"unfold_less":"unfold_more",r=e.hideNonMatching?"Expand all and view highlighted":"Collapse all";return(0,f.default)(c.Button,{icon:t,title:r,disabled:e.disabled,onclick:e.onClick})}}class v{view({attrs:e}){return[(0,f.default)(".log-label","Log Level"),(0,f.default)(y,{options:d.LOG_PRIORITIES,selectedIndex:e.store.state.minimumLevel,onSelect:t=>{e.store.edit(e=>{e.minimumLevel=t})}}),(0,f.default)(_.TagInput,{placeholder:"Filter by tag...",tags:e.store.state.tags,onTagAdd:t=>{e.store.edit(e=>{e.tags.push(t)})},onTagRemove:t=>{e.store.edit(e=>{e.tags.splice(t,1)})}}),(0,f.default)(T,{onChange:t=>{e.store.edit(e=>{e.textEntry=t})}}),(0,f.default)(b,{hideNonMatching:e.store.state.hideNonMatching,onClick:()=>{e.store.edit(e=>{e.hideNonMatching=!e.hideNonMatching})},disabled:""===e.store.state.textEntry})]}}d.LogsFilters=v}}return Jh}var pg,hg={},gg={};function mg(){return pg||(pg=1,Object.defineProperty(gg,"__esModule",{value:!0}),gg.LIMIT=void 0,gg.LIMIT=1e4),gg}var _g,yg,Tg,bg={};function vg(){if(!_g){_g=1,Object.defineProperty(bg,"__esModule",{value:!0}),bg.TimelineFetcher=void 0;const n=Rr(),a=K(),i=ie();class e{doFetch;data_;latestTimespan;latestResolution;constructor(e){this.doFetch=e,this.latestTimespan=a.TimeSpan.ZERO,this.latestResolution=0n}async requestData(e,t){var r;this.shouldLoadNewData(e,t)&&(r=(e=e.pad(e.duration)).start,e=e.end,r=a.Time.fromRaw(n.BigintMath.quantFloor(r,t)),e=a.Time.fromRaw(n.BigintMath.quantCeil(e,t)),this.latestTimespan=new a.TimeSpan(r,e),this.latestResolution=t,await this.loadData())}get data(){return this.data_}invalidate(){this.data_=void 0}[Symbol.dispose](){this.data_=void 0}shouldLoadNewData(e,t){return void 0===this.data_||e.start<this.latestTimespan.start||e.end>this.latestTimespan.end||t!==this.latestResolution}async loadData(){var{start:e,end:t}=this.latestTimespan,r=this.latestResolution;this.data_=await this.doFetch(e,t,r),i.raf.scheduleRedraw()}}bg.TimelineFetcher=e}return bg}function Eg(){if(!Tg){Tg=1;{var i=Yh;Object.defineProperty(i,"__esModule",{value:!0}),i.plugin=i.ANDROID_LOGS_TRACK_KIND=void 0;const o=or.__importDefault(ae()),s=fg(),l=Z(),c=function(){if(!yg){yg=1,Object.defineProperty(hg,"__esModule",{value:!0}),hg.AndroidLogTrack=void 0;const u=K(),l=mg();var e=vg();const d=Ps(),c=ue(),f=[{color:"hsl(122, 39%, 49%)",prios:[0,1,2,3]},{color:"hsl(0, 0%, 70%)",prios:[4]},{color:"hsl(45, 100%, 51%)",prios:[5]},{color:"hsl(4, 90%, 58%)",prios:[6]},{color:"hsl(291, 64%, 42%)",prios:[7]}];hg.AndroidLogTrack=class{engine;fetcher=new e.TimelineFetcher(this.onBoundsChange.bind(this));constructor(e){this.engine=e}async onUpdate({visibleWindow:e,resolution:t}){await this.fetcher.requestData(e.toTimeSpan(),t)}async onDestroy(){this.fetcher[Symbol.dispose]()}getHeight(){return 40}async onBoundsChange(e,t,r){var n=await this.engine.query(`
      select
        cast(ts / ${r} as integer) * ${r} as tsQuant,
        prio,
        count(prio) as numEvents
      from android_logs
      where ts >= ${e} and ts <= ${t}
      group by tsQuant, prio
      order by tsQuant, prio limit ${l.LIMIT};`),a=n.numRows(),i={start:e,end:t,resolution:r,length:a,numEvents:0,timestamps:new BigInt64Array(a),priorities:new Uint8Array(a)},o=n.iter({tsQuant:c.LONG,prio:c.NUM,numEvents:c.NUM});for(let e=0;o.valid();o.next(),e++){i.timestamps[e]=o.tsQuant;var s=Math.min(o.prio,7);i.priorities[e]|=1<<s,i.numEvents+=o.numEvents}return i}render({ctx:n,size:e,timescale:a}){var i=this.fetcher.data;if(void 0!==i){var o,t=a.timeToPx(i.start),r=a.timeToPx(i.end),s=((0,d.checkerboardExcept)(n,this.getHeight(),0,e.width,t,r),Math.max(2,a.durationToPx(i.resolution))),l=35/f.length;for(let r=0;r<i.timestamps.length;r++)for(let t=0;t<f.length;t++){let e=!1;for(const c of f[t].prios)i.priorities[r]&1<<c&&(e=!0);e&&(n.fillStyle=f[t].color,o=u.Time.fromRaw(i.timestamps[r]),o=Math.floor(a.timeToPx(o)),n.fillRect(o,2+l*t,s,l))}}}}}return hg}(),u=z(),d=(i.ANDROID_LOGS_TRACK_KIND="AndroidLogTrack",{version:1,filter:{minimumLevel:2,tags:[],textEntry:"",hideNonMatching:!0}});i.plugin={pluginId:"perfetto.AndroidLog",plugin:class{async onTraceLoad(e){var t=e.mountStore(e=>(0,u.exists)(e)&&1===e.version?e:d),r=(await e.engine.query("select count(1) as cnt from android_logs")).firstRow({cnt:l.NUM}).cnt;0<r&&e.registerStaticTrack({uri:"perfetto.AndroidLog",title:"Android logs",tags:{kind:i.ANDROID_LOGS_TRACK_KIND},trackFactory:()=>new c.AndroidLogTrack(e.engine)});const n="perfetto.AndroidLog#tab",a=t.createSubStore(["filter"],e=>e);e.registerTab({isEphemeral:!1,uri:n,content:{render:()=>(0,o.default)(s.LogPanel,{filterStore:a,engine:e.engine}),getTitle:()=>"Android Logs"}}),0<r&&e.addDefaultTab(n),e.registerCommand({id:"perfetto.AndroidLog#ShowLogsTab",name:"Show android logs tab",callback:()=>{e.tabs.showTab(n)}})}}}}}return Yh}var Sg,Ag,Og={},Cg={};function kg(){if(!Sg){Sg=1,Object.defineProperty(Cg,"__esModule",{value:!0}),Cg.TraceProcessorCounterTrack=void 0;const r=oe(),n=ue();class e extends qf().BaseCounterTrack{trackId;rootTable;constructor(e){super(e),this.trackId=e.trackId,this.rootTable=e.rootTable??"counter"}getSqlSource(){return`
      select
        ts,
        value
      from ${this.rootTable}
      where track_id = ${this.trackId}
    `}onMouseClick({x:e,timescale:t}){t=t.pxToHpTime(e).toTime("floor"),e=`
      select
        id,
        ts as leftTs,
        (
          select ts
          from ${this.rootTable}
          where
            track_id = ${this.trackId}
            and ts >= ${t}
          order by ts
          limit 1
        ) as rightTs
      from ${this.rootTable}
      where
        track_id = ${this.trackId}
        and ts < ${t}
      order by ts DESC
      limit 1
    `;return this.engine.query(e).then(e=>{var e=e.iter({id:n.NUM,leftTs:n.LONG,rightTs:n.LONG_NULL});e.valid()&&(e=e.id,r.globals.selectSingleEvent(this.trackKey,e))}),!0}}Cg.TraceProcessorCounterTrack=e}return Cg}var wg,Rg={};var Ig,Mg,Pg={},Ng={},Dg={},xg={};function Lg(){if(!Ig){Ig=1,Object.defineProperty(xg,"__esModule",{value:!0}),xg.SqlRef=void 0;const n=or.__importDefault(ae()),a=Ws(),i=X(),o=se(),s=vl();xg.SqlRef=class{view({attrs:e}){const{table:t,id:r}=e;return void 0!==r?(0,n.default)(s.PopupMenu2,{trigger:(0,n.default)(o.Anchor,{icon:i.Icons.ContextMenu},`${t}[${r}]`)},(0,n.default)(s.MenuItem,{label:"Copy ID",icon:"content_copy",onclick:()=>(0,a.copyToClipboard)(""+r)}),(0,n.default)(s.MenuItem,{label:"Copy SQL query",icon:"file_copy",onclick:()=>(0,a.copyToClipboard)(`select * from ${t} where id=`+r)})):t+"[Unknown]"}}}return xg}function Fg(){if(Mg)return Dg;Mg=1,Object.defineProperty(Dg,"__esModule",{value:!0}),Dg.Details=Dg.DetailsSchema=void 0,Dg.createSqlIdRefRenderer=function(e,t){return{fetch:e,render:t}};const S=or.__importDefault(ae()),A=K(),O=z(),l=ie(),C=D(),k=se(),w=Ic(),n=Lg(),R=ce(),I=nf(),c=Nc(),M=L(),P=x(),u=lf();Dg.DetailsSchema={Dict:function(e){return new i(e.data,{skipIfEmpty:e.skipIfEmpty})},Arr:function(e){return new o(e.data,{skipIfEmpty:e.skipIfEmpty})},Timestamp:function(e,t){return new s("timestamp",e,t)},Duration:function(e,t){return new s("duration",e,t)},Interval:function(e,t,r){return new d(e,t,r)},ThreadInterval:function(e,t,r,n){return new f(e,t,r,n)},ArgSetId:function(e,t){return new s("arg_set_id",e,t)},Value:function(e,t){return new s("value",e,t)},URLValue:function(e,t){return new s("url",e,t)},SqlIdRef:function(e,t,r){return new p(e,t,r)}};Dg.Details=class{engine;sqlTable;id;constructor(e,t,r,n,a={}){this.engine=e,this.sqlTable=t,this.id=r,this.dataController=new h(e,t,r,a),this.resolvedSchema={kind:"dict",data:Object.fromEntries(Object.entries(n).map(([e,t])=>[e,function r(e,n){if("string"==typeof e)return{kind:"value",source:n.addExpression(e)};if(Array.isArray(e))return{kind:"array",data:e.map(e=>r(e,n))};if(e instanceof o)return{kind:"array",data:e.data.map(e=>r(e,n)),...e.params};if(e instanceof s)return"arg_set_id"===e.kind?{kind:e.kind,source:n.addArgSet(e.sourceExpression),...e.params}:{kind:e.kind,source:n.addExpression(e.sourceExpression),...e.params};if(e instanceof d)return{kind:"interval",ts:n.addExpression(e.ts),dur:n.addExpression(e.dur),...e.params};if(e instanceof f)return{kind:"thread_interval",ts:n.addExpression(e.ts),dur:n.addExpression(e.dur),utid:n.addExpression(e.utid),...e.params};if(e instanceof p)return{kind:"sql_id_ref",ref:n.addSqlIdRef(e.table,e.id),...e.params};if(e instanceof i)return{kind:"dict",data:Object.fromEntries(Object.entries(e.data).map(([e,t])=>[e,r(t,n)])),...e.params};return{kind:"dict",data:Object.fromEntries(Object.entries(e).map(([e,t])=>[e,r(t,n)]))}}(t,this.dataController)]))},this.dataController.fetch()}isLoading(){return void 0===this.dataController.data}render(){if(void 0===this.dataController.data)return(0,S.default)("h2","Loading");var e,t,r=[];for([e,t]of Object.entries(this.resolvedSchema.data))r.push(function r(n,a,i,o,s){switch(i.kind){case"value":return null===o.values[i.source]&&i.skipIfNull?null:(0,S.default)(R.TreeNode,{left:a,right:(0,C.sqlValueToReadableString)(o.values[i.source])});case"url":{const d=o.values[i.source];let e;if(null===d){if(i.skipIfNull)return null;e=(0,S.default)("i","NULL")}else e="string"!=typeof d?(0,w.renderError)(`Incorrect type for URL ${o.valueExpressions[i.source]}: expected string, got `+typeof d):(0,S.default)(k.Anchor,{href:d,target:"_blank",icon:"open_in_new"},d);return(0,S.default)(R.TreeNode,{left:a,right:e})}case"timestamp":{const f=o.values[i.source];let e;if(null===f){if(i.skipIfNull)return null;e=(0,S.default)("i","NULL")}else e="bigint"!=typeof f?(0,w.renderError)(`Incorrect type for timestamp ${o.valueExpressions[i.source]}: expected bigint, got `+typeof f):(0,S.default)(P.Timestamp,{ts:A.Time.fromRaw(f)});return(0,S.default)(R.TreeNode,{left:a,right:e})}case"duration":{const p=o.values[i.source];return(0,S.default)(R.TreeNode,{left:a,right:"bigint"==typeof p&&(0,S.default)(M.DurationWidget,{dur:p})})}case"interval":case"thread_interval":{const h=o.values[i.dur];return(0,S.default)(R.TreeNode,{left:a,right:"bigint"==typeof h&&(0,S.default)(M.DurationWidget,{dur:h})})}case"sql_id_ref":const l=o.sqlIdRefs[i.ref],c=o.sqlIdRefData[i.ref];let e,t;if(c instanceof N)e=(0,w.renderError)(c.message);else{const g=s[l.tableName];if(void 0===g)e=(0,w.renderError)(`Unknown table ${l.tableName} (${l.tableName}[${c.id}])`);else{const m=g.render(c.data);e=m.value,t=m.children}}return(0,S.default)(R.TreeNode,{left:a,right:e},t);case"arg_set_id":const u=o.argSets[i.source];return u instanceof N?(0,w.renderError)(u.message):(0,I.hasArgs)(u)&&(0,S.default)(R.TreeNode,{left:a},(0,I.renderArguments)(n,u));case"array":{const _=[];for(const y of i.data){const T=r(n,`[${_.length}]`,y,o,s);(0,O.exists)(T)&&_.push(T)}return 0===_.length&&i.skipIfEmpty?null:(0,S.default)(R.TreeNode,{left:a},_)}case"dict":{const b=[];for(const[a,v]of Object.entries(i.data)){const E=r(n,a,v,o,s);(0,O.exists)(E)&&b.push(E)}return 0===b.length&&i.skipIfEmpty?null:(0,S.default)(R.TreeNode,{left:a},b)}}}(this.engine,e,t,this.dataController.data,this.dataController.sqlIdRefRenderers));return r.push((0,S.default)(R.TreeNode,{left:"SQL ID",right:(0,S.default)(n.SqlRef,{table:this.sqlTable,id:this.id})})),(0,S.default)(R.Tree,r)}dataController;resolvedSchema};class i{data;params;constructor(e,t){this.data=e,this.params=t}}class o{data;params;constructor(e,t){this.data=e,this.params=t}}class s{kind;sourceExpression;params;constructor(e,t,r){this.kind=e,this.sourceExpression=t,this.params=r}}class d{ts;dur;params;constructor(e,t,r){this.ts=e,this.dur=t,this.params=r}}class f{ts;dur;utid;params;constructor(e,t,r,n){this.ts=e,this.dur=t,this.utid=r,this.params=n}}class p{table;id;params;constructor(e,t,r){this.table=e,this.id=t,this.params=r}}class N{message;constructor(e){this.message=e}}class h{engine;sqlTable;id;sqlIdRefRenderers;expressions=[];argSets=[];sqlIdRefs=[];data;constructor(e,t,r,n){this.engine=e,this.sqlTable=t,this.id=r,this.sqlIdRefRenderers=n}async fetch(){var t={valueExpressions:this.expressions,values:[],argSetExpressions:this.argSets.map(e=>this.expressions[e]),argSets:[],sqlIdRefs:this.sqlIdRefs.map(e=>({tableName:e.tableName,idExpression:this.expressions[e.id]})),sqlIdRefData:[]};const r=e=>"col_"+e;var n=(await this.engine.query(`
      SELECT
        ${this.expressions.map((e,t)=>e+" as "+r(t)).join(",\n")}
      FROM ${this.sqlTable}
      WHERE id = ${this.id}
    `)).firstRow({});for(let e=0;e<this.expressions.length;++e)t.values.push(n[r(e)]);for(const o of this.argSets){var e=t.values[o];null===e?t.argSets.push([]):"number"!=typeof e?t.argSets.push(new N(`Incorrect type for arg set ${t.argSetExpressions[o]}: expected a number, got ${typeof e} instead}`)):t.argSets.push(await(0,u.getArgs)(this.engine,(0,c.asArgSetId)(e)))}for(const s of this.sqlIdRefs){var a,i=this.sqlIdRefRenderers[s.tableName];void 0===i?t.sqlIdRefData.push(new N("Unknown table "+s.tableName)):"bigint"!=typeof(a=t.values[s.id])?t.sqlIdRefData.push(new N(`Incorrect type for SQL reference ${t.valueExpressions[s.id]}: expected a bigint, got ${typeof a} instead}`)):void 0===(i=await i.fetch(this.engine,a))?t.sqlIdRefData.push(new N(`Failed to fetch the data with id ${a} for table `+s.tableName)):t.sqlIdRefData.push({data:i,id:a})}this.data=t,l.raf.scheduleFullRedraw()}addExpression(e){var t=this.expressions.length;return this.expressions.push(e),t}addArgSet(e){var t=this.argSets.length;return this.argSets.push(this.addExpression(e)),t}addSqlIdRef(e,t){var r=this.sqlIdRefs.length;return this.sqlIdRefs.push({tableName:e,id:this.addExpression(t)}),r}}return Dg}var Ug,Bg={},jg={};function Hg(){if(!Ug){Ug=1,Object.defineProperty(jg,"__esModule",{value:!0}),jg.renderProcessRef=function(e){const t=e.name;return(0,r.default)(a.PopupMenu2,{trigger:(0,r.default)(i.Anchor,(0,n.getProcessName)(e))},(0,o.exists)(t)&&(0,r.default)(a.MenuItem,{icon:s.Icons.Copy,label:"Copy process name",onclick:()=>(0,l.copyToClipboard)(t)}),(0,o.exists)(e.pid)&&(0,r.default)(a.MenuItem,{icon:s.Icons.Copy,label:"Copy pid",onclick:()=>(0,l.copyToClipboard)(""+e.pid)}),(0,r.default)(a.MenuItem,{icon:s.Icons.Copy,label:"Copy upid",onclick:()=>(0,l.copyToClipboard)(""+e.upid)}))};const r=or.__importDefault(ae()),n=hf(),a=vl(),i=se(),o=z(),s=X(),l=Ws()}return jg}var Gg,Vg,Wg,qg={};function $g(){if(!Gg){Gg=1,Object.defineProperty(qg,"__esModule",{value:!0}),qg.renderThreadRef=function(e){const t=e.name;return(0,r.default)(a.PopupMenu2,{trigger:(0,r.default)(i.Anchor,(0,n.getThreadName)(e))},(0,o.exists)(t)&&(0,r.default)(a.MenuItem,{icon:s.Icons.Copy,label:"Copy thread name",onclick:()=>(0,l.copyToClipboard)(t)}),(0,o.exists)(e.tid)&&(0,r.default)(a.MenuItem,{icon:s.Icons.Copy,label:"Copy tid",onclick:()=>(0,l.copyToClipboard)(""+e.tid)}),(0,r.default)(a.MenuItem,{icon:s.Icons.Copy,label:"Copy utid",onclick:()=>(0,l.copyToClipboard)(""+e.utid)}))};const r=or.__importDefault(ae()),n=gf(),a=vl(),i=se(),o=z(),s=X(),l=Ws()}return qg}function zg(){if(!Vg){Vg=1,Object.defineProperty(Bg,"__esModule",{value:!0}),Bg.wellKnownTypes=void 0;const r=hf(),n=mf(),a=Nc(),i=gf(),t=Hg(),o=jc(),s=$g();var e=Fg();Bg.wellKnownTypes={process:(0,e.createSqlIdRefRenderer)(async(e,t)=>(0,r.getProcessInfo)(e,(0,a.asUpid)(Number(t))),e=>({value:(0,t.renderProcessRef)(e)})),thread:(0,e.createSqlIdRefRenderer)(async(e,t)=>(0,i.getThreadInfo)(e,(0,a.asUtid)(Number(t))),e=>({value:(0,s.renderThreadRef)(e)})),slice:(0,e.createSqlIdRefRenderer)(async(e,t)=>({id:t,slice:await(0,n.getSlice)(e,(0,a.asSliceSqlId)(Number(t)))}),({id:e,slice:t})=>({value:void 0!==t?(0,o.sliceRef)(t):"Unknown slice "+e}))}}return Bg}function Kg(){if(!Wg){Wg=1,Object.defineProperty(Ng,"__esModule",{value:!0}),Ng.PageLoadDetailsPanel=void 0;const r=or.__importDefault(ae());var e=Pl();const n=F(),a=Cf(),i=Fg(),o=zg();var t=i.DetailsSchema;class s extends e.BottomTab{static kind="org.perfetto.PageLoadDetailsPanel";data;static create(e){return new s(e)}constructor(e){super(e),this.data=new i.Details(this.engine,"chrome_page_loads",this.config.id,{"Navigation start":t.Timestamp("navigation_start_ts"),"FCP event":t.Timestamp("fcp_ts"),FCP:t.Interval("navigation_start_ts","fcp"),"LCP event":t.Timestamp("lcp_ts",{skipIfNull:!0}),LCP:t.Interval("navigation_start_ts","lcp",{skipIfNull:!0}),DOMContentLoaded:t.Timestamp("dom_content_loaded_event_ts",{skipIfNull:!0}),"onload timestamp":t.Timestamp("load_event_ts",{skipIfNull:!0}),"performance.mark timings":t.Dict({data:{"Fully loaded":t.Timestamp("mark_fully_loaded_ts",{skipIfNull:!0}),"Fully visible":t.Timestamp("mark_fully_visible_ts",{skipIfNull:!0}),Interactive:t.Timestamp("mark_interactive_ts",{skipIfNull:!0})},skipIfEmpty:!0}),"Navigation ID":"navigation_id","Browser process":t.SqlIdRef("process","browser_upid"),URL:t.URLValue("url")},o.wellKnownTypes)}viewTab(){return(0,r.default)(n.DetailsShell,{title:this.getTitle()},(0,r.default)(a.GridLayout,(0,r.default)(a.GridLayoutColumn,this.data.render())))}getTitle(){return this.config.title}isLoading(){return this.data.isLoading()}}Ng.PageLoadDetailsPanel=s}return Ng}var Yg,Jg={};function Zg(){if(!Yg){Yg=1,Object.defineProperty(Jg,"__esModule",{value:!0}),Jg.StartupDetailsPanel=void 0;const t=or.__importDefault(ae()),r=K();var e=Pl();const n=L(),a=x(),i=Z(),o=F(),s=Cf(),l=Rf(),c=Lg(),u=ce(),d=Nc();class f extends e.BottomTab{static kind="org.perfetto.StartupDetailsPanel";loaded=!1;data;static create(e){return new f(e)}constructor(e){super(e),this.loadData()}async loadData(){var e=(await this.engine.query(`
      SELECT
        activity_id AS startupId,
        name,
        startup_begin_ts AS startupBeginTs,
        CASE
          WHEN first_visible_content_ts IS NULL THEN 0
          ELSE first_visible_content_ts - startup_begin_ts
        END AS durTofirstVisibleContent,
        launch_cause AS launchCause,
        browser_upid AS upid
      FROM chrome_startups
      WHERE id = ${this.config.id};
    `)).firstRow({startupId:i.NUM,name:i.STR,startupBeginTs:i.LONG,durTofirstVisibleContent:i.LONG,launchCause:i.STR_NULL,upid:i.NUM});this.data={startupId:e.startupId,eventName:e.name,startupBeginTs:r.Time.fromRaw(e.startupBeginTs),durToFirstVisibleContent:e.durTofirstVisibleContent,upid:(0,d.asUpid)(e.upid)},e.launchCause&&(this.data.launchCause=e.launchCause),this.loaded=!0}getDetailsDictionary(){var e={};return void 0!==this.data&&(e["Activity ID"]=this.data.startupId,e["Browser Upid"]=this.data.upid,e["Startup Event"]=this.data.eventName,e["Startup Timestamp"]=(0,t.default)(a.Timestamp,{ts:this.data.startupBeginTs}),e["Duration to First Visible Content"]=(0,t.default)(n.DurationWidget,{dur:this.data.durToFirstVisibleContent}),this.data.launchCause&&(e["Launch Cause"]=this.data.launchCause),e["SQL ID"]=(0,t.default)(c.SqlRef,{table:"chrome_startups",id:this.config.id})),e}viewTab(){return this.isLoading()?(0,t.default)("h2","Loading"):(0,t.default)(o.DetailsShell,{title:this.getTitle()},(0,t.default)(s.GridLayout,(0,t.default)(s.GridLayoutColumn,(0,t.default)(l.Section,{title:"Details"},(0,t.default)(u.Tree,(0,u.dictToTreeNodes)(this.getDetailsDictionary()))))))}getTitle(){return this.config.title}isLoading(){return!this.loaded}}Jg.StartupDetailsPanel=f}return Jg}var Qg,Xg={};function em(){if(!Qg){Qg=1,Object.defineProperty(Xg,"__esModule",{value:!0}),Xg.WebContentInteractionPanel=void 0;const t=or.__importDefault(ae()),r=K();var e=Pl();const n=Nc(),a=L(),i=x(),o=Z(),s=F(),l=Cf(),c=Rf(),u=Lg(),d=ce();class f extends e.BottomTab{static kind="org.perfetto.WebContentInteractionPanel";loaded=!1;data;static create(e){return new f(e)}constructor(e){super(e),this.loadData()}async loadData(){var e=(await this.engine.query(`
      SELECT
        ts,
        dur,
        interaction_type AS interactionType,
        total_duration_ms AS totalDurationMs,
        renderer_upid AS upid
      FROM chrome_web_content_interactions
      WHERE id = ${this.config.id};
    `)).firstRow({ts:o.LONG,dur:o.LONG,interactionType:o.STR,totalDurationMs:o.LONG,upid:o.NUM});this.data={ts:r.Time.fromRaw(e.ts),dur:e.ts,interactionType:e.interactionType,totalDurationMs:e.totalDurationMs,upid:(0,n.asUpid)(e.upid)},this.loaded=!0}getDetailsDictionary(){var e={};return void 0!==this.data&&(e.Interaction=this.data.interactionType,e.Timestamp=(0,t.default)(i.Timestamp,{ts:this.data.ts}),e.Duration=(0,t.default)(a.DurationWidget,{dur:this.data.dur}),e["Renderer Upid"]=this.data.upid,e["Total duration of all events"]=(0,t.default)(a.DurationWidget,{dur:this.data.totalDurationMs}),e["SQL ID"]=(0,t.default)(u.SqlRef,{table:"chrome_web_content_interactions",id:this.config.id})),e}viewTab(){return this.isLoading()?(0,t.default)("h2","Loading"):(0,t.default)(s.DetailsShell,{title:this.getTitle()},(0,t.default)(l.GridLayout,(0,t.default)(l.GridLayoutColumn,(0,t.default)(c.Section,{title:"Details"},(0,t.default)(d.Tree,(0,d.dictToTreeNodes)(this.getDetailsDictionary()))))))}getTitle(){return this.config.title}isLoading(){return!this.loaded}}Xg.WebContentInteractionPanel=f}return Xg}var tm,rm,nm,am={},im={};function om(){if(!rm){rm=1;{var e=am;Object.defineProperty(e,"__esModule",{value:!0}),e.CriticalUserInteractionTrack=e.CRITICAL_USER_INTERACTIONS_ROW=e.CRITICAL_USER_INTERACTIONS_KIND=void 0;const i=ne(),o=function(){if(!tm){tm=1,Object.defineProperty(im,"__esModule",{value:!0}),im.GenericSliceDetailsTab=void 0;const a=or.__importDefault(ae()),t=ie(),i=D(),o=F(),s=Cf(),l=Rf(),c=Lg(),u=ce();class r extends Pl().BottomTab{static kind="dev.perfetto.GenericSliceDetailsTab";data;static create(e){return new r(e)}constructor(e){super(e),this.engine.query(`select * from ${this.config.sqlTableName} where id = `+this.config.id).then(e=>{this.data=e.firstRow({}),t.raf.scheduleFullRedraw()})}viewTab(){if(void 0===this.data)return(0,a.default)("h2","Loading");var t={};if(void 0!==this.config.columns)for(const r of Object.keys(this.config.columns)){let e=r;t[e=void 0!==this.config.columns[r].displayName?this.config.columns[r].displayName:e]=(0,i.sqlValueToReadableString)(this.data[r])}else for(const n of Object.keys(this.data))t[n]=(0,i.sqlValueToReadableString)(this.data[n]);var e=(0,u.dictToTree)(t);return(0,a.default)(o.DetailsShell,{title:this.config.title},(0,a.default)(s.GridLayout,(0,a.default)(l.Section,{title:"Details"},(0,a.default)(u.Tree,e)),(0,a.default)(l.Section,{title:"Metadata"},(0,a.default)(u.Tree,[(0,a.default)(u.TreeNode,{left:"SQL ID",right:(0,a.default)(c.SqlRef,{table:this.config.sqlTableName,id:this.config.id})})]))))}getTitle(){return this.config.title}isLoading(){return void 0===this.data}}im.GenericSliceDetailsTab=r}return im}(),s=oe();var r,t=kl(),n=ue(),a=wl();const l=Kg(),c=Zg(),u=em();e.CRITICAL_USER_INTERACTIONS_KIND="org.chromium.CriticalUserInteraction.track",e.CRITICAL_USER_INTERACTIONS_ROW={...t.NAMED_ROW,scopedId:n.NUM,type:n.STR},(t=r=r||{}).UNKNOWN="Unknown",t.PAGE_LOAD="chrome_page_loads",t.STARTUP="chrome_startups",t.WEB_CONTENT_INTERACTION="chrome_web_content_interactions";class d extends a.CustomSqlTableSliceTrack{static kind="/critical_user_interactions";getSqlDataSource(){return{columns:["hash(type, scoped_id) AS id","scoped_id AS scopedId","name","ts","dur","type"],sqlTableName:"chrome_interactions"}}getDetailsPanel(e){let t={kind:o.GenericSliceDetailsTab.kind,config:{sqlTableName:this.tableName,title:"Chrome Interaction"}};switch(function(e){switch(e){case r.PAGE_LOAD:return r.PAGE_LOAD;case r.STARTUP:return r.STARTUP;case r.WEB_CONTENT_INTERACTION:return r.WEB_CONTENT_INTERACTION;default:return r.UNKNOWN}}(e.slice.type)){case r.PAGE_LOAD:t={kind:l.PageLoadDetailsPanel.kind,config:{sqlTableName:this.tableName,title:"Chrome Page Load"}};break;case r.STARTUP:t={kind:c.StartupDetailsPanel.kind,config:{sqlTableName:this.tableName,title:"Chrome Startup"}};break;case r.WEB_CONTENT_INTERACTION:t={kind:u.WebContentInteractionPanel.kind,config:{sqlTableName:this.tableName,title:"Chrome Web Content Interaction"}}}return t}onSliceClick(e){var t=this.getDetailsPanel(e);s.globals.makeSelection(i.Actions.selectGenericSlice({id:e.slice.scopedId,sqlTableName:this.tableName,start:e.slice.ts,duration:e.slice.dur,trackKey:this.trackKey,detailsPanelConfig:{kind:t.kind,config:t.config}}))}getSqlImports(){return{modules:["chrome.interactions"]}}getRowSpec(){return e.CRITICAL_USER_INTERACTIONS_ROW}rowToSlice(e){var t=super.rowToSlice(e),r=e.scopedId,e=e.type;return{...t,scopedId:r,type:e}}}e.CriticalUserInteractionTrack=d}}return am}function sm(){if(!nm){nm=1,Object.defineProperty(Pg,"__esModule",{value:!0}),Pg.plugin=void 0;const r=Er(),t=ne(),n=Y(),a=oe(),i=ue(),o=Kg(),s=Zg(),l=em(),c=om();Pg.plugin={pluginId:"perfetto.CriticalUserInteraction",plugin:class{async onTraceLoad(t){t.registerTrack({uri:c.CriticalUserInteractionTrack.kind,tags:{kind:c.CriticalUserInteractionTrack.kind},title:"Chrome Interactions",trackFactory:e=>new c.CriticalUserInteractionTrack({engine:t.engine,trackKey:e.trackKey})}),t.registerDetailsPanel(new i.BottomTabToSCSAdapter({tabFactory:e=>{if("GENERIC_SLICE"===e.kind&&e.detailsPanelConfig.kind===o.PageLoadDetailsPanel.kind)return e=e.detailsPanelConfig.config,new o.PageLoadDetailsPanel({config:e,engine:t.engine,uuid:(0,r.v4)()})}})),t.registerDetailsPanel(new i.BottomTabToSCSAdapter({tabFactory:e=>{if("GENERIC_SLICE"===e.kind&&e.detailsPanelConfig.kind===s.StartupDetailsPanel.kind)return e=e.detailsPanelConfig.config,new s.StartupDetailsPanel({config:e,engine:t.engine,uuid:(0,r.v4)()})}})),t.registerDetailsPanel(new i.BottomTabToSCSAdapter({tabFactory:e=>{if("GENERIC_SLICE"===e.kind&&e.detailsPanelConfig.kind===l.WebContentInteractionPanel.kind)return e=e.detailsPanelConfig.config,new l.WebContentInteractionPanel({config:e,engine:t.engine,uuid:(0,r.v4)()})}}))}onActivate(e){e.registerCommand({id:"perfetto.CriticalUserInteraction.AddInteractionTrack",name:"Add track: Chrome interactions",callback:()=>{var e;e=(0,r.v4)(),a.globals.dispatchMultiple([t.Actions.addTrack({key:e,uri:c.CriticalUserInteractionTrack.kind,name:"Chrome Interactions",trackSortKey:i.PrimaryTrackSortKey.DEBUG_TRACK,trackGroup:n.SCROLLING_TRACK_GROUP}),t.Actions.toggleTrackPinned({trackKey:e})])}})}}}}return Pg}var lm,cm,um={},dm={},fm={};function pm(){if(!lm){lm=1,Object.defineProperty(fm,"__esModule",{value:!0}),fm.CHROME_EVENT_LATENCY_TRACK_KIND=fm.ScrollJankV3TrackKind=fm.ScrollJankPluginState=fm.ENABLE_CHROME_SCROLL_JANK_PLUGIN=fm.SCROLL_JANK_GROUP_ID=void 0;var e=re();fm.SCROLL_JANK_GROUP_ID="chrome-scroll-jank-track-group",fm.ENABLE_CHROME_SCROLL_JANK_PLUGIN=e.featureFlags.register({id:"enableChromeScrollJankPlugin",name:"Enable Chrome Scroll Jank plugin",description:"Adds new tracks for scroll jank in Chrome",defaultValue:!1});class t{static instance;tracks;constructor(){this.tracks={}}static getInstance(){return t.instance||(t.instance=new t),t.instance}registerTrack(e){this.tracks[e.kind]={key:e.trackKey,sqlTableName:e.tableName,detailsPanelConfig:e.detailsPanelConfig}}unregisterTrack(e){delete this.tracks[e]}getTrack(e){return this.tracks[e]}}fm.ScrollJankPluginState=t,fm.ScrollJankV3TrackKind="org.chromium.ScrollJank.scroll_jank_v3_track",fm.CHROME_EVENT_LATENCY_TRACK_KIND="org.chromium.ScrollJank.event_latencies"}return fm}function hm(){if(!cm){cm=1,Object.defineProperty(dm,"__esModule",{value:!0}),dm.ChromeTasksScrollJankTrack=void 0,dm.decideTracks=async function(e,t){var r={tracksToAdd:[]};return i.ENABLE_CHROME_SCROLL_JANK_PLUGIN.get()&&(e=(await e.query(`
    select
      utid,
      upid
    from thread
    where name='CrBrowserMain'
  `)).iter({utid:a.NUM,upid:a.NUM})).valid()&&r.tracksToAdd.push({uri:"perfetto.ChromeScrollJank",trackSortKey:{utid:e.utid,priority:n.InThreadTrackSortKey.ORDINARY},name:"Scroll Jank causes - long tasks",trackGroup:t(e.utid,e.upid)}),r};const n=Y(),e=kl(),a=Z(),i=pm();class t extends e.NamedSliceTrack{static kind="org.chromium.ScrollJank.BrowserUIThreadLongTasks";constructor(e){super(e)}getRowSpec(){return e.NAMED_ROW}rowToSlice(e){return this.rowToSliceBase(e)}getSqlSource(){return`
      select
        s2.ts as ts,
        s2.dur as dur,
        s2.id as id,
        0 as depth,
        s1.full_name as name
      from chrome_tasks_delaying_input_processing s1
      join slice s2 on s2.id=s1.slice_id
    `}}dm.ChromeTasksScrollJankTrack=t}return dm}var gm,mm,_m={},ym={},Tm={};function bm(){if(!gm){gm=1,Object.defineProperty(Tm,"__esModule",{value:!0}),Tm.BreakdownByThreadStateTreeNode=void 0,Tm.breakDownIntervalByThreadState=async function(e,t,r){var e=await e.query(`
    INCLUDE PERFETTO MODULE sched.time_in_state;
    INCLUDE PERFETTO MODULE sched.states;
    INCLUDE PERFETTO MODULE android.cpu.cluster_type;

    SELECT
      sched_state_io_to_human_readable_string(state, io_wait) as state,
      state AS rawState,
      cluster_type AS clusterType,
      cpu,
      blocked_function AS blockedFunction,
      dur
    FROM sched_time_in_state_and_cpu_for_thread_in_interval(${t.start}, ${t.duration}, ${r})
    LEFT JOIN android_cpu_cluster_mapping USING(cpu);
  `),n=e.iter({state:s.STR,rawState:s.STR,clusterType:s.STR_NULL,cpu:s.NUM_NULL,blockedFunction:s.STR_NULL,dur:s.LONG}),a=new u;for(;n.valid();n.next()){let e=a;e=e.getOrCreateChild(n.state),null!==n.clusterType&&(e=e.getOrCreateChild(n.clusterType)),null!==n.cpu&&(e=e.getOrCreateChild("CPU "+n.cpu)),(e=null!==n.blockedFunction?e.getOrCreateChild(""+n.blockedFunction):e).addDuration(n.dur)}return{root:a}};const o=or.__importDefault(ae()),s=Z(),l=ce(),c=L();class u{parent;children;dur;startsCollapsed=!0;constructor(e){this.parent=e,this.children=new Map,this.dur=0n}getOrCreateChild(e){let t=this.children.get(e);return t||(t=new u(this),this.children.set(e,t)),t}addDuration(e){let t=this;for(;void 0!==t;)t.dur+=e,t=t.parent}}function i(e,a){return Array.from(e.children.entries()).map(([e,t])=>{return t=t,e=e,r=a,n=100*Number(t.dur)/Number(r),(0,o.default)(l.TreeNode,{left:e,right:[(0,o.default)(c.DurationWidget,{dur:t.dur}),` (${n.toFixed(2)}%)`],startsCollapsed:t.startsCollapsed},i(t,r));var r,n})}Tm.BreakdownByThreadStateTreeNode=class{view({attrs:e}){return i(e.data.root,e.dur)}}}return Tm}function vm(){if(!mm){mm=1,Object.defineProperty(ym,"__esModule",{value:!0}),ym.renderDetails=function(e,t){return(0,r.default)(l.Section,{title:"Details"},(0,r.default)(u.Tree,(0,r.default)(u.TreeNode,{left:"Name",right:(0,r.default)(s.PopupMenu2,{trigger:(0,r.default)(o.Anchor,e.name)},(0,r.default)(s.MenuItem,{label:"Slices with the same name",onclick:()=>{(0,h.addSqlTableTab)({table:g.SqlTables.slice,displayName:"slice",filters:["name = "+(0,a.sqliteString)(e.name)]})}}))}),(0,r.default)(u.TreeNode,{left:"Category",right:e.category&&"[NULL]"!==e.category?e.category:"N/A"}),(0,r.default)(u.TreeNode,{left:"Start time",right:(0,r.default)(p.Timestamp,{ts:e.ts})}),(0,i.exists)(e.absTime)&&(0,r.default)(u.TreeNode,{left:"Absolute Time",right:e.absTime}),(0,r.default)(u.TreeNode,{left:"Duration",right:(0,r.default)(f.DurationWidget,{dur:e.dur})},(0,i.exists)(t)&&0<e.dur&&(0,r.default)(d.BreakdownByThreadStateTreeNode,{data:t,dur:e.dur})),function(e){{var t;if((0,i.exists)(e.threadTs)&&(0,i.exists)(e.threadDur))return t=n.BigintMath.ratio(e.threadDur,e.dur),t=-1n===e.threadDur?"":` (${(100*t).toFixed(2)}%)`,(0,r.default)(u.TreeNode,{left:"Thread duration",right:[(0,r.default)(f.DurationWidget,{dur:e.threadDur}),t]})}}(e),e.thread&&(0,r.default)(u.TreeNode,{left:"Thread",right:(0,m.getThreadName)(e.thread)}),e.process&&(0,r.default)(u.TreeNode,{left:"Process",right:(0,_.getProcessName)(e.process)}),e.process&&(0,i.exists)(e.process.uid)&&(0,r.default)(u.TreeNode,{left:"User ID",right:e.process.uid}),e.process&&e.process.packageName&&(0,r.default)(u.TreeNode,{left:"Package name",right:e.process.packageName}),e.process&&(0,i.exists)(e.process.versionCode)&&(0,r.default)(u.TreeNode,{left:"Version code",right:e.process.versionCode}),(0,r.default)(u.TreeNode,{left:"SQL ID",right:(0,r.default)(c.SqlRef,{table:"slice",id:e.id})})))};const r=or.__importDefault(ae()),n=Rr(),a=J(),i=z(),o=se(),s=vl(),l=Rf(),c=Lg(),u=ce(),d=bm(),f=L(),p=x(),h=rf(),g=ga(),m=gf(),_=hf()}return ym}var Em,Sm={},Am={};function Om(){if(!Em){Em=1,Object.defineProperty(Am,"__esModule",{value:!0}),Am.comparingBy=function(r,n){return(e,t)=>n(r(e),r(t))},Am.withDirection=function(r,e){return"DESC"===e?(e,t)=>r(t,e):r},Am.compareUniversal=function(t,r){if(void 0===t&&void 0===r)return 0;if(null===t&&null===r)return 0;if("number"==typeof t&&"number"==typeof r)return t-r;if((0,n.isString)(t)&&(0,n.isString)(r))return t.localeCompare(r);if(t instanceof Uint8Array&&r instanceof Uint8Array){for(let e=0;e<t.length&&e<r.length;e++){if(t[e]<r[e])return-1;if(t[e]>r[e])return 1}return t.length-r.length}return e(t)-e(r)};const n=te();function e(e){return void 0===e?0:null===e?1:"number"==typeof e?2:(0,n.isString)(e)?3:4}}return Am}var Cm,km,wm={};function Rm(){if(!Cm){Cm=1,Object.defineProperty(wm,"__esModule",{value:!0}),wm.PopupMenuButton=void 0,wm.menuItem=function(e,t){return{itemType:"regular",text:e,callback:t}},wm.popupMenuIcon=function(e){switch(e){case void 0:return"more_horiz";case"DESC":return"arrow_drop_down";case"ASC":return"arrow_drop_up"}};const r=or.__importDefault(ae()),n=ie();const t=new class a{popup=void 0;initialized=!1;listener;constructor(){this.listener=e=>{void 0===e.composedPath().find(a.isDropdownElement)&&this.ensureHidden()}}static isDropdownElement(e){return e instanceof HTMLElement&&"DIV"===e.tagName&&e.classList.contains("dropdown")}ensureHidden(){void 0!==this.popup&&this.popup.setVisible(!1)}clear(){void 0!==this.popup&&(this.popup=void 0,window.removeEventListener("click",this.listener))}showPopup(e){this.ensureHidden(),this.popup=e,window.addEventListener("click",this.listener)}};wm.PopupMenuButton=class{popupShown=!1;expandedGroups=new Set;setVisible(e){this.popupShown=e,this.popupShown?t.showPopup(this):t.clear(),n.raf.scheduleFullRedraw()}renderItem(e){switch(e.itemType){case"regular":return(0,r.default)("button.open-menu",{onclick:()=>{e.callback(),this.setVisible(!1)}},e.text);case"group":var t=this.expandedGroups.has(e.itemId);return(0,r.default)("div",(0,r.default)("button.open-menu.disallow-selection",{onclick:()=>{this.expandedGroups.has(e.itemId)?this.expandedGroups.delete(e.itemId):this.expandedGroups.add(e.itemId),n.raf.scheduleFullRedraw()}},e.text+(t?" ▲":" ▼")),t?(0,r.default)("div.nested-menu",e.children.map(e=>this.renderItem(e))):null)}}view(e){return(0,r.default)(".dropdown",(0,r.default)(".dropdown-button",{onclick:()=>{this.setVisible(!this.popupShown)}},e.children,(0,r.default)("i.material-icons",e.attrs.icon)),(0,r.default)(this.popupShown?".popup-menu.opened":".popup-menu.closed",e.attrs.items.map(e=>this.renderItem(e))))}}}return wm}function Im(){if(!km){km=1,Object.defineProperty(Sm,"__esModule",{value:!0}),Sm.Table=Sm.TableData=Sm.ColumnDescriptor=void 0,Sm.numberColumn=function(e,t,r){return new a(e,t,{contextMenu:r,sortKey:t})},Sm.stringColumn=function(e,t,r){return new a(e,t,{contextMenu:r,sortKey:t})},Sm.widgetColumn=function(e,t){return new a(e,t)};const l=or.__importDefault(ae()),t=sc(),n=Om(),r=ie(),c=Rm();class a{name;render;id;contextMenu;ordering;constructor(e,t,r){if(this.name=e,this.render=t,this.id=void 0===r?.columnId?e:r.columnId,void 0!==r){if(void 0!==r.sortKey&&void 0!==r.ordering)throw new Error("only one way to order a column should be specified");void 0!==r.sortKey&&(this.ordering=(0,n.comparingBy)(r.sortKey,n.compareUniversal)),void 0!==r.ordering&&(this.ordering=r.ordering)}}}Sm.ColumnDescriptor=a;Sm.TableData=class{data;_sortingInfo;permutation;constructor(e){this.data=e,this.permutation=(0,t.range)(e.length)}*iterateItems(){for(const e of this.permutation)yield this.data[e]}items(){return Array.from(this.iterateItems())}setItems(e){this.data=e,this.permutation=(0,t.range)(e.length),void 0!==this._sortingInfo&&this.reorder(this._sortingInfo),r.raf.scheduleFullRedraw()}resetOrder(){this.permutation=(0,t.range)(this.data.length),this._sortingInfo=void 0,r.raf.scheduleFullRedraw()}get sortingInfo(){return this._sortingInfo}reorder(e){this._sortingInfo=e,this.permutation.sort((0,n.withDirection)((0,n.comparingBy)(e=>this.data[e],e.ordering),e.direction)),r.raf.scheduleFullRedraw()}};Sm.Table=class{renderColumnHeader(e,t){let r=void 0,n=t.contextMenu;if(void 0!==t.ordering){const s=t.ordering;var a=[];"ASC"!==(r=(i=t.id,void 0!==(o=e.attrs.data.sortingInfo)&&o.columnId===i?o.direction:void 0))&&a.push((0,c.menuItem)("Sort ascending",()=>{e.attrs.data.reorder({columnId:t.id,direction:"ASC",ordering:s})})),"DESC"!==r&&a.push((0,c.menuItem)("Sort descending",()=>{e.attrs.data.reorder({columnId:t.id,direction:"DESC",ordering:s})})),void 0!==r&&a.push((0,c.menuItem)("Restore original order",()=>{e.attrs.data.resetOrder()})),n=[...a,...n??[]]}var i,o;return(0,l.default)("td",t.name,void 0===n?null:(0,l.default)(c.PopupMenuButton,{icon:(0,c.popupMenuIcon)(r),items:n}))}checkValid(e){if(!(0,t.allUnique)(e.columns.map(e=>e.id)))throw new Error("column IDs should be unique")}oncreate(e){this.checkValid(e.attrs)}onupdate(e){this.checkValid(e.attrs)}view(t){const e=t.attrs;return(0,l.default)("table.generic-table",(0,l.default)("thead",(0,l.default)("tr.header",e.columns.map(e=>this.renderColumnHeader(t,e)))),e.data.items().map(t=>(0,l.default)("tr",e.columns.map(e=>(0,l.default)("td",e.render(t))))))}}}return Sm}var Mm,Pm={};function Nm(){if(!Mm){Mm=1,Object.defineProperty(Pm,"__esModule",{value:!0}),Pm.TreeTable=void 0;const f=or.__importDefault(ae()),p=Qs(),h=ie();Pm.TreeTable=class{collapsedPaths=new Set;view({attrs:e}){var{columns:t,rows:r}=e,t=t.map(({name:e})=>(0,f.default)("th",e)),r=this.renderRows(r,0,e,[]);return(0,f.default)("table.pf-treetable",(0,f.default)("thead",(0,f.default)("tr",t)),(0,f.default)("tbody",r))}renderRows(e,n,t,r){var{columns:a,getChildren:i}=t,o=[];for(const c of e){var s=i(c),l=this.keyForRow(c,t);const u=r.concat([l]),d=s&&0<s.length;l=a.map(({getData:e},t)=>{var r=(0,p.classNames)(d&&"pf-treetable-node",this.isCollapsed(u)&&"pf-collapsed");return 0===t?(t={"--indentation-level":n},(0,f.default)("td",{style:t,class:(0,p.classNames)(r,"pf-treetable-maincol")},(0,f.default)(".pf-treetable-gutter",{onclick:()=>{this.isCollapsed(u)?this.expandPath(u):this.collapsePath(u),h.raf.scheduleFullRedraw()}}),e(c))):(t={"--indentation-level":0},(0,f.default)("td",{style:t},e(c)))});o.push((0,f.default)("tr",l)),s&&!this.isCollapsed(u)&&o.push(this.renderRows(s,n+1,t,u))}return o}collapsePath(e){e=e.join("/");this.collapsedPaths.add(e)}expandPath(e){e=e.join("/");this.collapsedPaths.delete(e)}isCollapsed(e){e=e.join("/");return this.collapsedPaths.has(e)}keyForRow(e,t){t=t.columns;return t[0].getData(e)}}}return Pm}var Dm,xm={};function Lm(){if(!Dm){Dm=1,Object.defineProperty(xm,"__esModule",{value:!0}),xm.MultiParagraphText=xm.TextParagraph=void 0;const n=or.__importDefault(ae()),r=Qs();xm.TextParagraph=class{view({attrs:e}){let{text:t,compressSpace:r}=e;return void 0===r&&(r=!0),(0,n.default)("div.pf-text-paragraph",r?t.replace(/\s\s+/g," "):t)}};xm.MultiParagraphText=class{view({attrs:e,children:t}){var{className:e=""}=e,e=(0,r.classNames)(e);return(0,n.default)("div",{class:e},t)}}}return xm}var Fm,Um,Bm={},jm={};function Hm(){if(!Fm){Fm=1,Object.defineProperty(jm,"__esModule",{value:!0}),jm.ScrollJankCauseMap=jm.CauseThread=jm.CauseProcess=void 0;const t=z(),s=Z();var i,o,e;(e=i||(jm.CauseProcess=i={}))[e.UNKNOWN=0]="UNKNOWN",e.BROWSER="Browser",e.RENDERER="Renderer",e.GPU="GPU",(e=o||(jm.CauseThread=o={}))[e.UNKNOWN=0]="UNKNOWN",e.BROWSER_MAIN="CrBrowserMain",e.RENDERER_MAIN="CrRendererMain",e.COMPOSITOR="Compositor",e.CHROME_CHILD_IO_THREAD="Chrome_ChildIOThread",e.VIZ_COMPOSITOR="VizCompositorThread",e.SURFACE_FLINGER="surfaceflinger";class r{static instance;causes;constructor(){this.causes={}}async initializeCauseMap(e){for(var t=(await e.query(`
      INCLUDE PERFETTO MODULE chrome.scroll_jank.scroll_jank_cause_map;

      SELECT
        IFNULL(name, '') AS name,
        IFNULL(description, '') AS description,
        IFNULL(cause_process, '') AS causeProcess,
        IFNULL(cause_thread, '') AS causeThread,
        IFNULL(cause_description, '') AS causeDescription
      FROM chrome_scroll_jank_causes_with_event_latencies;
    `)).iter({name:s.STR,description:s.STR,causeProcess:s.STR,causeThread:s.STR,causeDescription:s.STR});t.valid();t.next()){var r=t.name,n=(r in this.causes||(this.causes[r]={description:t.description,jankCauses:[]}),function(e){switch(e){case i.BROWSER:return i.BROWSER;case i.RENDERER:return i.RENDERER;case i.GPU:return i.GPU;default:return i.UNKNOWN}}(t.causeProcess)),a=function(e){switch(e){case o.BROWSER_MAIN:return o.BROWSER_MAIN;case o.RENDERER_MAIN:return o.RENDERER_MAIN;case o.CHROME_CHILD_IO_THREAD:return o.CHROME_CHILD_IO_THREAD;case o.COMPOSITOR:return o.COMPOSITOR;case o.VIZ_COMPOSITOR:return o.VIZ_COMPOSITOR;case o.SURFACE_FLINGER:return o.SURFACE_FLINGER;default:return o.UNKNOWN}}(t.causeThread);this.causes[r].jankCauses.push({description:t.causeDescription,process:n,thread:a})}}static async initialize(e){(0,t.exists)(r.instance)||(r.instance=new r,await r.instance.initializeCauseMap(e))}static getEventLatencyDetails(e){if(e in r.instance.causes)return r.instance.causes[e]}}jm.ScrollJankCauseMap=r}return jm}function Gm(){if(!Um){Um=1,Object.defineProperty(Bm,"__esModule",{value:!0}),Bm.getScrollJankCauseStage=async function(e,t){var e=await e.query(`
    SELECT
      IFNULL(cause_of_jank, '${i}') AS causeOfJank,
      IFNULL(sub_cause_of_jank, '${i}') AS subCauseOfJank,
      IFNULL(substage.ts, -1) AS ts,
      IFNULL(substage.dur, -1) AS dur
    FROM chrome_janky_frame_presentation_intervals
      JOIN descendant_slice(event_latency_id) substage
    WHERE event_latency_id = ${t}
      AND substage.name = COALESCE(sub_cause_of_jank, cause_of_jank)
  `),r=e.iter({causeOfJank:p.STR,subCauseOfJank:p.STR,ts:p.LONG,dur:p.LONG});for(;r.valid();r.next()){var n=r.causeOfJank,a=r.subCauseOfJank;return""==n||n==i?void 0:{name:a==i?n:a,eventLatencyId:t,ts:l.Time.fromRaw(r.ts),dur:r.dur}}return},Bm.getEventLatencyCauseTracks=async function(e,t){var r=[],n=g.ScrollJankCauseMap.getEventLatencyDetails(t.name);if(void 0!==n)for(const a of n.jankCauses)switch(a.process){case g.CauseProcess.RENDERER:case g.CauseProcess.BROWSER:case g.CauseProcess.GPU:for(const i of await async function(e,t,r,n){const a=await e.query(`
      INCLUDE PERFETTO MODULE chrome.scroll_jank.scroll_jank_cause_utils;

      SELECT DISTINCT
        utid,
        id AS trackId
      FROM thread_track
      WHERE utid IN (
        SELECT DISTINCT
          utid
        FROM chrome_select_scroll_jank_cause_thread(
          ${t},
          '${r}',
          '${n}'
        )
      );
  `),i=a.iter({utid:p.NUM,trackId:p.NUM}),o={},s=[];for(;i.valid();i.next()){var l=i.utid;l in o?o[l].trackIds.push(i.trackId):(o[l]={trackIds:[i.trackId],thread:n,causeDescription:""},s.push(l))}return s.map(e=>o[e])}(e,t.eventLatencyId,a.process,a.thread))i.causeDescription=a.description,r.push(i);break;case g.CauseProcess.UNKNOWN:}return r},Bm.getCauseLink=function(e,t,r){const n=[];for(const i of e.trackIds){var a=d.globals.trackManager.trackKeyByTrackId.get(i);if(void 0===a)return`Could not locate track ${i} for thread ${e.thread} in the global state`;n.push(a)}return 0!=n.length?(0,o.default)("div[style='width:250px']",(0,o.default)(h.Anchor,{icon:s.Icons.UpdateSelection,onclick:()=>{(0,f.verticalScrollToTrack)(n[0],!0),(0,c.exists)(t)&&(0,c.exists)(r)&&((0,f.focusHorizontalRange)(t,l.Time.fromRaw(t+r),.3),d.globals.timeline.selectArea(t,l.Time.fromRaw(t+r),n),d.globals.dispatch(u.Actions.selectArea({start:t,end:l.Time.fromRaw(t+r),tracks:n})))}},e.thread)):`No valid tracks for thread ${e.thread}.`};const o=or.__importDefault(ae()),s=X(),l=K(),c=z(),u=ne(),d=oe(),f=Bc(),p=Z(),h=se(),g=Hm(),i="Unknown"}return Bm}var Vm,Wm,qm={};function $m(){if(!Vm){Vm=1,Object.defineProperty(qm,"__esModule",{value:!0}),qm.ScrollJankSliceRef=void 0,qm.getScrollJankSlices=async function(e,t){var r=d.ScrollJankPluginState.getInstance().getTrack(d.ScrollJankV3TrackKind);if(null==r)throw new Error(d.ScrollJankV3TrackKind+" track is not registered.");e=await n(e,r,{filters:["event_latency_id="+t]});return e},qm.getEventLatencySlice=async function(e,t){var r=d.ScrollJankPluginState.getInstance().getTrack(d.CHROME_EVENT_LATENCY_TRACK_KIND);if(null==r)throw new Error(d.CHROME_EVENT_LATENCY_TRACK_KIND+" track is not registered.");e=await n(e,r,{filters:["id="+t]});return e[0]},qm.getEventLatencyDescendantSlice=async function(e,t,r){var e=await e.query(`
    SELECT
      id as sliceId,
      ts,
      dur as dur
    FROM descendant_slice(${t})
    WHERE name='${r}'`),n=e.iter({sliceId:l.NUM,ts:l.LONG,dur:l.LONG}),a=[];for(;n.valid();n.next())a.push({sliceId:n.sliceId,ts:i.Time.fromRaw(n.ts),dur:n.dur});e=d.ScrollJankPluginState.getInstance().getTrack(d.CHROME_EVENT_LATENCY_TRACK_KIND);if(null==e)throw new Error(d.CHROME_EVENT_LATENCY_TRACK_KIND+" track is not registered.");if(1<a.length)throw new Error(`
        Slice table and track view ${e.sqlTableName} has more than one descendant of slice id ${t} with name `+r);if(0!==a.length)return a[0]},qm.getSliceForTrack=function(e,t,r){return(0,a.default)(f,{id:e.sliceId,ts:e.ts,dur:e.dur,name:r,kind:t})};const a=or.__importDefault(ae()),e=X(),i=K(),r=ne(),o=oe(),s=Bc(),l=Z(),c=D(),u=se(),d=pm();class f{view(t){return(0,a.default)(u.Anchor,{icon:e.Icons.UpdateSelection,onclick:()=>{var e=d.ScrollJankPluginState.getInstance().getTrack(t.attrs.kind);if(null==e)throw new Error(t.attrs.kind+" track is not registered.");o.globals.makeSelection(r.Actions.selectGenericSlice({id:t.attrs.id,sqlTableName:e.sqlTableName,start:t.attrs.ts,duration:t.attrs.dur,trackKey:e.key,detailsPanelConfig:e.detailsPanelConfig})),(0,s.scrollToTrackAndTs)(e.key,t.attrs.ts,!0)}},t.attrs.name)}}async function n(e,t,r){for(var n=(await e.query(`
    SELECT
      id AS sliceId,
      ts,
      dur AS dur
    FROM ${t.sqlTableName}
    `+(0,c.constraintsToQuerySuffix)(r))).iter({sliceId:l.NUM,ts:l.LONG,dur:l.LONG}),a=[];n.valid();n.next())a.push({sliceId:n.sliceId,ts:i.Time.fromRaw(n.ts),dur:n.dur});return a}qm.ScrollJankSliceRef=f}return qm}function zm(){if(!Wm){Wm=1,Object.defineProperty(_m,"__esModule",{value:!0}),_m.EventLatencySliceDetailsPanel=void 0;const l=or.__importDefault(ae()),a=K(),i=ie();var e=Pl();const o=nf(),s=vm(),c=mf(),u=Nc(),d=Im(),f=Nm(),p=Z(),h=F(),g=Cf(),m=Rf(),_=Lm(),y=ce(),T=Gm(),b=Hm(),v=$m(),E=pm(),S=jc();class A extends e.BottomTab{static kind="dev.perfetto.EventLatencySliceDetailsPanel";loaded=!1;name="";topEventLatencyId=void 0;sliceDetails;jankySlice;isJankStage=!1;relevantThreadStage;relevantThreadTracks=[];eventLatencyBreakdown;nextEventLatencyBreakdown;prevEventLatencyBreakdown;static create(e){return new A(e)}constructor(e){super(e),this.loadData()}async loadData(){var e=(await this.engine.query(`
      SELECT
        name
      FROM ${this.config.sqlTableName}
      WHERE id = ${this.config.id}
      `)).firstRow({name:p.STR});this.name=e.name,await this.loadSlice(),await this.loadJankSlice(),await this.loadRelevantThreads(),await this.loadEventLatencyBreakdown(),this.loaded=!0}async loadSlice(){this.sliceDetails=await(0,c.getSlice)(this.engine,(0,u.asSliceSqlId)(this.config.id)),i.raf.scheduleRedraw()}async loadJankSlice(){var e;this.sliceDetails&&("EventLatency"===this.sliceDetails.name?this.topEventLatencyId=this.sliceDetails.id:this.topEventLatencyId=(0,u.asSliceSqlId)(await this.getOldestAncestorSliceId()),0<(e=await(0,v.getScrollJankSlices)(this.engine,this.topEventLatencyId)).length)&&(this.jankySlice=e[0])}async loadRelevantThreads(){var e;this.sliceDetails&&this.topEventLatencyId&&("EventLatency"!==this.sliceDetails.name||this.jankySlice)&&(e=await(0,T.getScrollJankCauseStage)(this.engine,this.topEventLatencyId),"EventLatency"===this.sliceDetails.name?(this.isJankStage=!0,this.relevantThreadStage=e):(e&&this.sliceDetails.name===e.name&&(this.isJankStage=!0),this.relevantThreadStage={name:this.sliceDetails.name,eventLatencyId:this.topEventLatencyId,ts:this.sliceDetails.ts,dur:this.sliceDetails.dur}),this.relevantThreadStage)&&(this.relevantThreadTracks=await(0,T.getEventLatencyCauseTracks)(this.engine,this.relevantThreadStage))}async loadEventLatencyBreakdown(){var e,t;void 0!==this.topEventLatencyId&&(this.eventLatencyBreakdown=await(0,c.getDescendantSliceTree)(this.engine,this.topEventLatencyId),e=`
    EXTRACT_ARG(arg_set_id, 'event_latency.event_type') IN (
      'FIRST_GESTURE_SCROLL_UPDATE',
      'GESTURE_SCROLL_UPDATE',
      'INERTIAL_GESTURE_SCROLL_UPDATE')
    AND HAS_DESCENDANT_SLICE_WITH_NAME(
      id,
      'SubmitCompositorFrameToPresentationCompositorFrame')`,0<(t=await(0,c.getSliceFromConstraints)(this.engine,{filters:["name = 'EventLatency'","id < "+this.topEventLatencyId,e],orderBy:[{fieldName:"id",direction:"DESC"}],limit:1})).length&&(this.prevEventLatencyBreakdown=await(0,c.getDescendantSliceTree)(this.engine,t[0].id)),0<(t=await(0,c.getSliceFromConstraints)(this.engine,{filters:["name = 'EventLatency'","id > "+this.topEventLatencyId,e],orderBy:["id"],limit:1})).length)&&(this.nextEventLatencyBreakdown=await(0,c.getDescendantSliceTree)(this.engine,t[0].id))}getRelevantLinks(){if(this.sliceDetails&&("EventLatency"!==this.sliceDetails.name||this.relevantThreadStage)){var e=(this.relevantThreadStage||this.sliceDetails).name,r=(this.relevantThreadStage||this.sliceDetails).ts,n=(this.relevantThreadStage||this.sliceDetails).dur,t=b.ScrollJankCauseMap.getEventLatencyDetails(e);if(void 0!==t){var a=[],t=(a.push((0,l.default)(_.TextParagraph,{text:t.description})),[(0,d.widgetColumn)("Relevant Thread",e=>(0,T.getCauseLink)(e.tracks,e.ts,e.dur)),(0,d.widgetColumn)("Description",e=>""===e.description?e.description:(0,l.default)(_.TextParagraph,{text:e.description}))]),i=[];for(let t=0;t<this.relevantThreadTracks.length;t++){var o=this.relevantThreadTracks[t];let e="";0!=t&&o.thread==this.relevantThreadTracks[t-1].thread||(e=o.causeDescription),i.push({description:e,tracks:this.relevantThreadTracks[t],ts:r,dur:n})}var s=new d.TableData(i);return 0<i.length&&a.push((0,l.default)(d.Table,{data:s,columns:t})),(0,l.default)(m.Section,{title:this.isJankStage?"Jank Cause: "+e:e},a)}}}async getOldestAncestorSliceId(){let e=-1;if(this.sliceDetails)for(var t=(await this.engine.query(`
      SELECT
        id
      FROM ancestor_slice(${this.sliceDetails.id})
      WHERE name = 'EventLatency'
    `)).iter({id:p.NUM});t.valid();t.next()){e=t.id;break}return e}getLinksSection(){return(0,l.default)(m.Section,{title:"Quick links"},(0,l.default)(y.Tree,(0,l.default)(y.TreeNode,{left:this.sliceDetails?(0,S.sliceRef)(this.sliceDetails,"EventLatency in context of other Input events"):"EventLatency in context of other Input events",right:this.sliceDetails?"":"N/A"}),(0,l.default)(y.TreeNode,{left:this.jankySlice?(0,v.getSliceForTrack)(this.jankySlice,E.ScrollJankV3TrackKind,"Jank Interval"):"Jank Interval",right:this.jankySlice?"":"N/A"})))}getBreakdownSection(){var e;if(void 0!==this.eventLatencyBreakdown)return e={rows:[this.eventLatencyBreakdown],getChildren:e=>e.children,columns:[{name:"Name",getData:e=>e.name},{name:"Duration",getData:e=>a.Duration.humanise(e.dur)},{name:"vs prev",getData:e=>n(e.dur,r(this.prevEventLatencyBreakdown,t(e))?.dur)},{name:"vs next",getData:e=>n(e.dur,r(this.nextEventLatencyBreakdown,t(e))?.dur)}]},(0,l.default)(m.Section,{title:"EventLatency Stage Breakdown"},(0,l.default)(f.TreeTable,e))}getDescriptionText(){return(0,l.default)(_.MultiParagraphText,(0,l.default)(_.TextParagraph,{text:`EventLatency tracks the latency of handling a given input event
                 (Scrolls, Touches, Taps, etc). Ideally from when the input was
                 read by the hardware to when it was reflected on the screen.`}),(0,l.default)(_.TextParagraph,{text:`Note however the concept of coalescing or terminating early. This
               occurs when we receive multiple events or handle them quickly by
               converting them into a different event. Such as a TOUCH_MOVE
               being converted into a GESTURE_SCROLL_UPDATE type, or a multiple
               GESTURE_SCROLL_UPDATE events being formed into a single frame at
               the end of the RendererCompositorQueuingDelay.`}),(0,l.default)(_.TextParagraph,{text:`*Important:* On some platforms (MacOS) we do not get feedback on
               when something is presented on the screen so the timings are only
               accurate for what we know on a given platform.`}))}viewTab(){var e,t,r;return this.sliceDetails?(e=this.sliceDetails,(t=[]).push((0,l.default)(m.Section,{title:"Description"},(0,l.default)(".div",this.getDescriptionText()))),(r=this.getRelevantLinks())&&t.push(r),t.push(this.getLinksSection()),t.push(this.getBreakdownSection()),(0,l.default)(h.DetailsShell,{title:"Slice",description:this.name},(0,l.default)(g.GridLayout,(0,l.default)(g.GridLayoutColumn,(0,s.renderDetails)(e),(0,o.hasArgs)(e.args)&&(0,l.default)(m.Section,{title:"Arguments"},(0,l.default)(y.Tree,(0,o.renderArguments)(this.engine,e.args)))),(0,l.default)(g.GridLayoutColumn,t)))):(0,l.default)(h.DetailsShell,{title:"Slice",description:"Loading..."})}isLoading(){return!this.loaded}getTitle(){return"Current Selection"}}function t(e){var t=[];let r=e;for(;void 0!==r.parent;)t.push(r.name),r=r.parent;return t.reverse()}function r(e,r){if(void 0!==e){let t=e;for(const n of r){let e=!1;for(const a of t.children)if(a.name===n){e=!0,t=a;break}if(!e)return}return t}}function n(e,t){return void 0===t?"NULL":(0<(e=e-t)?"+":"")+a.Duration.humanise(e)}_m.EventLatencySliceDetailsPanel=A}return _m}var Km,Ym,Jm={},Zm={};function Qm(){var e,t;return Km||(Km=1,Object.defineProperty(Zm,"__esModule",{value:!0}),Zm.JANK_COLOR=void 0,e=_n(),t=M(),Zm.JANK_COLOR=(0,t.makeColorScheme)(new e.HSLColor([343,100,43]))),Zm}var Xm,e0,t0={},r0={};function n0(){if(!Xm){Xm=1,Object.defineProperty(r0,"__esModule",{value:!0}),r0.getInputScrollDeltas=async function(e,t){var e=await e.query(`
    INCLUDE PERFETTO MODULE chrome.scroll_jank.scroll_offsets;

    SELECT
      ts,
      IFNULL(scroll_update_id, 0) AS scrollUpdateId,
      delta_y AS deltaY,
      relative_offset_y AS offsetY
    FROM chrome_scroll_input_offsets
    WHERE scroll_id = ${t};
  `),r=e.iter({ts:l.LONG,scrollUpdateId:l.NUM,deltaY:l.NUM,offsetY:l.NUM}),n=[];for(;r.valid();r.next())n.push({ts:s.Time.fromRaw(r.ts),scrollUpdateId:r.scrollUpdateId,scrollOffset:r.offsetY,scrollDelta:r.deltaY,predictorJank:0});return n},r0.getPresentedScrollDeltas=async function(e,t){var e=await e.query(`
    INCLUDE PERFETTO MODULE chrome.scroll_jank.scroll_offsets;

    SELECT
      ts,
      IFNULL(scroll_update_id, 0) AS scrollUpdateId,
      delta_y AS deltaY,
      relative_offset_y AS offsetY
    FROM chrome_presented_scroll_offsets
    WHERE scroll_id = ${t}
      AND delta_y IS NOT NULL;
  `),r=e.iter({ts:l.LONG,scrollUpdateId:l.NUM,deltaY:l.NUM,offsetY:l.NUM}),n=[];var a;for(;r.valid();r.next())a=r.offsetY,n.push({ts:s.Time.fromRaw(r.ts),scrollUpdateId:r.scrollUpdateId,scrollOffset:a,scrollDelta:r.deltaY,predictorJank:0});return n},r0.getPredictorJankDeltas=async function(e,t){var e=await e.query(`
    INCLUDE PERFETTO MODULE chrome.scroll_jank.predictor_error;

    SELECT
      present_ts AS ts,
      IFNULL(scroll_update_id, 0) AS scrollUpdateId,
      delta_y AS deltaY,
      relative_offset_y AS offsetY,
      predictor_jank AS predictorJank
    FROM chrome_predictor_error
    WHERE scroll_id = ${t}
      AND predictor_jank != 0 AND predictor_jank IS NOT NULL;
  `),r=e.iter({ts:l.LONG,scrollUpdateId:l.NUM,deltaY:l.NUM,offsetY:l.NUM,predictorJank:l.NUM}),n=[];var a;for(;r.valid();r.next())a=r.offsetY,n.push({ts:s.Time.fromRaw(r.ts),scrollUpdateId:r.scrollUpdateId,scrollOffset:a,scrollDelta:r.deltaY,predictorJank:r.predictorJank});return n},r0.getJankIntervals=async function(e,t,r){var e=await e.query(`
    INCLUDE PERFETTO MODULE chrome.scroll_jank.scroll_jank_intervals;

    SELECT
      ts,
      dur
    FROM chrome_janky_frame_presentation_intervals
    WHERE ts >= ${t} AND ts <= ${t+r};
  `),n=e.iter({ts:l.LONG,dur:l.LONG}),a=[];for(;n.valid();n.next())a.push({start_ts:Number(n.ts),end_ts:Number(n.ts+n.dur)});return a},r0.buildScrollOffsetsGraph=function(e,t,n,r){var e=i(e,u),t=t.filter(t=>{for(let e=0;e<n.length;e++){var r=n[e];if(r.ts==t.ts&&r.scrollUpdateId==t.scrollUpdateId)return!1}return!0}),t=i(t,d),a=i(n,f),r=function(t){let r="";for(let e=0;e<t.length;e++){0!=e&&(r+=",");var n=t[e];r+=`
    {
      "start": ${n.start_ts/1e9},
      "end": ${n.end_ts/1e9}
    }
    `}return r}(r);return(0,o.default)(c.VegaView,{spec:`
{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "Scatter plot showcasing the pixel offset deltas between input frames and presented frames.",
  "width": "container",
  "height": 200,
  "padding": 5,

  "data": {
    "name": "table"
  },

  "layer": [
    {
      "mark": "rect",
      "data": {
        "values": [
          ${r}
        ]
      },
      "encoding": {
        "x": {
          "field": "start",
          "type": "quantitative"
        },
        "x2": {
          "field": "end",
          "type": "quantitative"
        },
        "color": {
          "value": "#D3D3D3"
        }
      }
    },
    {
      "mark": {
        "type": "point",
        "filled": true
      },

      "encoding": {
        "x": {
          "field": "ts",
          "type": "quantitative",
          "title": "Raw Timestamp",
          "axis" : {
            "labels": true
          },
          "scale": {"zero":false}
        },
        "y": {
          "field": "offset",
          "type": "quantitative",
          "title": "Offset (pixels)",
          "scale": {"zero":false}
        },
        "color": {
          "field": "category",
          "type": "nominal",
          "scale": {
            "domain": [
              "${u}",
              "${d}",
              "${f}"
            ],
            "range": ["blue", "red", "orange"]
          },
          "legend": {
            "title":null
          }
        },
        "tooltip": [
          {
            "field": "delta",
            "type": "quantitative",
            "title": "Delta",
            "format": ".2f"
          },
          {
            "field": "scrollUpdateId",
            "type": "quantititive",
            "title": "Trace Id"
          },
          {
            "field": "predictorJank",
            "type": "nominal",
            "title": "Predictor Jank"
          }
        ]
      }
    }
  ]
}
`,data:{table:e.concat(t).concat(a)}})};const o=or.__importDefault(ae()),s=K(),l=Z(),c=xd(),u="Input",d="Presented",f="Presented with Predictor Jank";function i(e,t){var r=[];for(const n of e){let e="N/A";0<n.predictorJank&&(e=parseFloat(n.predictorJank.toString()).toFixed(2),e+=" (times delta compared to the next/previous frame's delta)"),r.push({category:t,ts:Number(n.ts)/1e9,scrollUpdateId:n.scrollUpdateId,offset:n.scrollOffset,delta:n.scrollDelta,predictorJank:e})}return r}}return r0}function a0(){if(!e0){e0=1,Object.defineProperty(t0,"__esModule",{value:!0}),t0.ScrollDetailsPanel=void 0;const a=or.__importDefault(ae()),t=K(),i=z(),r=ie();var e=Pl();const o=Im(),s=L(),n=x(),l=Z(),c=F(),u=Cf(),d=Rf(),f=Lg(),p=Lm(),h=ce(),g=pm(),m=n0(),_=$m();class y extends e.BottomTab{static kind="org.perfetto.ScrollDetailsPanel";loaded=!1;data;metrics={};orderedJankSlices=[];scrollDeltas;static create(e){return new y(e)}constructor(e){super(e),this.loadData()}async loadData(){var e=(await this.engine.query(`
      WITH scrolls AS (
        SELECT
          id,
          IFNULL(gesture_scroll_begin_ts, ts) AS start_ts,
          CASE
            WHEN gesture_scroll_end_ts IS NOT NULL THEN gesture_scroll_end_ts
            WHEN gesture_scroll_begin_ts IS NOT NULL 
              THEN gesture_scroll_begin_ts + dur
            ELSE ts + dur
          END AS end_ts
        FROM chrome_scrolls WHERE id = ${this.config.id})
      SELECT
        id,
        start_ts AS ts,
        end_ts - start_ts AS dur
      FROM scrolls`)).firstRow({id:l.NUM,ts:l.LONG,dur:l.LONG});this.data={id:e.id,ts:t.Time.fromRaw(e.ts),dur:e.dur},await this.loadMetrics(),this.loaded=!0,r.raf.scheduleFullRedraw()}async loadMetrics(){await this.loadInputEventCount(),await this.loadFrameStats(),await this.loadDelayData(),await this.loadScrollOffsets()}async loadInputEventCount(){var e;(0,i.exists)(this.data)&&(e=(await this.engine.query(`
        SELECT
          COUNT(*) AS inputEventCount
        FROM slice s
        WHERE s.name = "EventLatency"
          AND EXTRACT_ARG(arg_set_id, 'event_latency.event_type') = 'TOUCH_MOVED'
          AND s.ts >= ${this.data.ts}
          AND s.ts + s.dur <= ${this.data.ts+this.data.dur}
      `)).firstRow({inputEventCount:l.NUM}),this.metrics.inputEventCount=e.inputEventCount)}async loadFrameStats(){var e;(0,i.exists)(this.data)&&(e=(await this.engine.query(`
        SELECT
          IFNULL(frame_count, 0) AS frameCount,
          IFNULL(missed_vsyncs, 0) AS missedVsyncs,
          IFNULL(presented_frame_count, 0) AS presentedFrameCount,
          IFNULL(janky_frame_count, 0) AS jankyFrameCount,
          ROUND(IFNULL(janky_frame_percent, 0), 2) AS jankyFramePercent
        FROM chrome_scroll_stats
        WHERE scroll_id = ${this.data.id}
      `)).iter({frameCount:l.NUM,missedVsyncs:l.NUM,presentedFrameCount:l.NUM,jankyFrameCount:l.NUM,jankyFramePercent:l.NUM})).valid()&&(this.metrics.frameCount=e.frameCount,this.metrics.missedVsyncs=e.missedVsyncs,this.metrics.presentedFrameCount=e.presentedFrameCount,this.metrics.jankyFrameCount=e.jankyFrameCount,this.metrics.jankyFramePercent=e.jankyFramePercent)}async loadDelayData(){if((0,i.exists)(this.data))for(var e=(await this.engine.query(`
        SELECT
          IFNULL(sub_cause_of_jank, IFNULL(cause_of_jank, 'Unknown')) AS cause,
          IFNULL(event_latency_id, 0) AS eventLatencyId,
          IFNULL(dur, 0) AS delayDur,
          IFNULL(delayed_frame_count, 0) AS delayVsync
        FROM chrome_janky_frame_presentation_intervals s
        WHERE s.ts >= ${this.data.ts}
          AND s.ts + s.dur <= ${this.data.ts+this.data.dur}
        ORDER by delayDur DESC;
      `)).iter({cause:l.STR,eventLatencyId:l.NUM,delayDur:l.LONG,delayVsync:l.NUM});e.valid()&&!(e.delayDur<=0);e.next()){var t=await(0,_.getScrollJankSlices)(this.engine,e.eventLatencyId);this.orderedJankSlices.push({cause:e.cause,jankSlice:t[0],delayDur:e.delayDur,delayVsync:e.delayVsync})}}async loadScrollOffsets(){if((0,i.exists)(this.data)){var e=await(0,m.getInputScrollDeltas)(this.engine,this.data.id),r=await(0,m.getPresentedScrollDeltas)(this.engine,this.data.id),t=await(0,m.getPredictorJankDeltas)(this.engine,this.data.id),n=await(0,m.getJankIntervals)(this.engine,this.data.ts,this.data.dur);if(this.scrollDeltas=(0,m.buildScrollOffsetsGraph)(e,r,t,n),0<r.length){this.metrics.startOffset=r[0].scrollOffset,this.metrics.endOffset=r[r.length-1].scrollOffset;let t=0;for(let e=0;e<r.length;e++)t+=Math.abs(r[e].scrollDelta);0!=t&&(this.metrics.totalPixelsScrolled=t)}}}renderMetricsDictionary(){var e={};return e["Total Finger Input Event Count"]=this.metrics.inputEventCount,e["Total Vsyncs within Scrolling period"]=this.metrics.frameCount,e["Total Chrome Presented Frames"]=this.metrics.presentedFrameCount,e["Total Janky Frames"]=this.metrics.jankyFrameCount,e["Number of Vsyncs Janky Frames were Delayed by"]=this.metrics.missedVsyncs,void 0!==this.metrics.jankyFramePercent&&(e["Janky Frame Percentage (Total Janky Frames / Total Chrome Presented Frames)"]=this.metrics.jankyFramePercent+"%"),null!=this.metrics.startOffset&&(e["Starting Offset"]=this.metrics.startOffset),null!=this.metrics.endOffset&&(e["Ending Offset"]=this.metrics.endOffset),null!=this.metrics.startOffset&&null!=this.metrics.endOffset&&(e["Net Pixels Scrolled"]=Math.abs(this.metrics.endOffset-this.metrics.startOffset)),null!=this.metrics.totalPixelsScrolled&&(e["Total Pixels Scrolled (all directions)"]=this.metrics.totalPixelsScrolled),(0,h.dictToTreeNodes)(e)}getDelayTable(){if(0<this.orderedJankSlices.length){var e=[(0,o.widgetColumn)("Cause",e=>e.jankLink),(0,o.widgetColumn)("Duration",e=>e.dur),(0,o.numberColumn)("Delayed Vsyncs",e=>e.delayedVSyncs)],t=[];for(const n of this.orderedJankSlices)t.push({jankLink:(0,_.getSliceForTrack)(n.jankSlice,g.ScrollJankV3TrackKind,n.cause),dur:(0,a.default)(s.DurationWidget,{dur:n.delayDur}),delayedVSyncs:n.delayVsync});var r=new o.TableData(t);return(0,a.default)(o.Table,{data:r,columns:e})}return"None"}getDescriptionText(){return(0,a.default)(p.MultiParagraphText,(0,a.default)(p.TextParagraph,{text:`The interval during which the user has started a scroll ending
                 after their finger leaves the screen and any resulting fling
                 animations have finished.`}),(0,a.default)(p.TextParagraph,{text:`Note: This can contain periods of time where the finger is down
                 and not moving and no active scrolling is occurring.`}),(0,a.default)(p.TextParagraph,{text:`Note: Sometimes if a user touches the screen quickly after 
                 letting go or Chrome was hung and got into a bad state. A new
                 scroll will start which will result in a slightly overlapping
                 scroll. This can occur due to the last scroll still outputting
                 frames (to get caught up) and the "new" scroll having started
                 producing frames after the user has started scrolling again.`}))}getGraphText(){return(0,a.default)(p.MultiParagraphText,(0,a.default)(p.TextParagraph,{text:`The scroll offset is the discrepancy in physical screen pixels
                 between two consecutive frames.`}),(0,a.default)(p.TextParagraph,{text:`The overall curve of the graph indicates the direction (up or
                 down) by which the user scrolled over time.`}),(0,a.default)(p.TextParagraph,{text:`Grey blocks in the graph represent intervals of jank
                 corresponding with the Chrome Scroll Janks track.`}),(0,a.default)(p.TextParagraph,{text:`Yellow dots represent frames that were presented (sae as the red
                 dots), but that we suspect are visible to users as unsmooth
                 velocity/stutter (predictor jank).`}))}viewTab(){var e;return this.isLoading()||null==this.data?(0,a.default)("h2","Loading"):(e=(0,h.dictToTreeNodes)({"Scroll ID":this.data.id,"Start time":(0,a.default)(n.Timestamp,{ts:this.data.ts}),Duration:(0,a.default)(s.DurationWidget,{dur:this.data.dur}),"SQL ID":(0,a.default)(f.SqlRef,{table:"chrome_scrolls",id:this.config.id})}),(0,a.default)(c.DetailsShell,{title:this.getTitle()},(0,a.default)(u.GridLayout,(0,a.default)(u.GridLayoutColumn,(0,a.default)(d.Section,{title:"Details"},(0,a.default)(h.Tree,e)),(0,a.default)(d.Section,{title:"Slice Metrics"},(0,a.default)(h.Tree,this.renderMetricsDictionary())),(0,a.default)(d.Section,{title:"Frame Presentation Delays"},this.getDelayTable())),(0,a.default)(u.GridLayoutColumn,(0,a.default)(d.Section,{title:"Description"},this.getDescriptionText()),(0,a.default)(d.Section,{title:"Scroll Offsets Plot"},(0,a.default)(".div[style='padding-bottom:5px']",this.getGraphText()),this.scrollDeltas)))))}getTitle(){return this.config.title}isLoading(){return!this.loaded}}t0.ScrollDetailsPanel=y}return t0}var i0,o0={};function s0(){if(!i0){i0=1,Object.defineProperty(o0,"__esModule",{value:!0}),o0.ScrollJankV3DetailsPanel=void 0;const r=or.__importDefault(ae()),t=K(),n=z(),a=ie();var e=Pl();const i=mf(),o=Nc(),s=L(),l=x(),c=Z(),u=F(),d=Cf(),f=Rf(),p=Lg(),h=Lm(),g=ce(),m=pm(),_=$m();class y extends e.BottomTab{static kind="org.perfetto.ScrollJankV3DetailsPanel";data;loaded=!1;sliceDetails;eventLatencySliceDetails;causeSliceDetails;subcauseSliceDetails;static create(e){return new y(e)}constructor(e){super(e),this.loadData()}async loadData(){var e=(await this.engine.query(`
      SELECT
        IIF(
          cause_of_jank IS NOT NULL,
          cause_of_jank || IIF(
            sub_cause_of_jank IS NOT NULL, "::" || sub_cause_of_jank, ""
            ), "Unknown") || " Jank" AS name,
        id,
        ts,
        dur,
        delayed_frame_count AS delayedVsyncCount,
        event_latency_id AS eventLatencyId,
        IFNULL(cause_of_jank, "UNKNOWN") AS causeOfJank,
        IFNULL(sub_cause_of_jank, "UNKNOWN") AS subcauseOfJank
      FROM chrome_janky_frame_presentation_intervals
      WHERE id = `+this.config.id)).firstRow({name:c.STR,id:c.NUM,ts:c.LONG,dur:c.LONG,delayedVsyncCount:c.NUM,eventLatencyId:c.NUM,causeOfJank:c.STR,subcauseOfJank:c.STR});this.data={name:e.name,id:e.id,ts:t.Time.fromRaw(e.ts),dur:e.dur,delayedVsyncCount:e.delayedVsyncCount,eventLatencyId:e.eventLatencyId,jankCause:e.causeOfJank,jankSubcause:e.subcauseOfJank},await this.loadJankyFrames(),await this.loadSlices(),this.loaded=!0,a.raf.scheduleFullRedraw()}hasCause(){return void 0!==this.data&&"UNKNOWN"!==this.data.jankCause}hasSubcause(){return void 0!==this.data&&this.hasCause()&&"UNKNOWN"!==this.data.jankSubcause}async loadSlices(){var e,t;(0,n.exists)(this.data)&&(this.sliceDetails=(e=this.engine,t=this.data.eventLatencyId,await(0,i.getSlice)(e,(0,o.asSliceSqlId)(t))),this.eventLatencySliceDetails=await(0,_.getEventLatencySlice)(this.engine,this.data.eventLatencyId),this.hasCause()&&(this.causeSliceDetails=await(0,_.getEventLatencyDescendantSlice)(this.engine,this.data.eventLatencyId,this.data.jankCause)),this.hasSubcause())&&(this.subcauseSliceDetails=await(0,_.getEventLatencyDescendantSlice)(this.engine,this.data.eventLatencyId,this.data.jankSubcause))}async loadJankyFrames(){var e;(0,n.exists)(this.data)&&(e=(await this.engine.query(`
        SELECT
          COUNT(*) AS jankyFrames
        FROM chrome_frame_info_with_delay
        WHERE delay_since_last_frame >
          (
            SELECT
              vsync_interval + vsync_interval / 2
            FROM chrome_vsyncs)
          AND delay_since_last_input <
            (
              SELECT
                vsync_interval + vsync_interval / 2
              FROM chrome_vsyncs)
          AND presentation_timestamp >= ${this.data.ts}
          AND presentation_timestamp <= ${this.data.ts+this.data.dur};
      `)).firstRow({jankyFrames:c.NUM}),this.data.jankyFrames=e.jankyFrames)}renderDetailsDictionary(){var e={};return(0,n.exists)(this.data)&&(e.Name=this.data.name,e["Expected Frame Presentation Timestamp"]=(0,r.default)(l.Timestamp,{ts:this.data.ts}),e["Actual Frame Presentation Timestamp"]=(0,r.default)(l.Timestamp,{ts:t.Time.add(this.data.ts,this.data.dur)}),e["Frame Presentation Delay"]=(0,r.default)(s.DurationWidget,{dur:this.data.dur}),e["Vsyncs Delayed"]=this.data.delayedVsyncCount,(0,n.exists)(this.data.jankyFrames)&&(e["Janky Frame Count"]=this.data.jankyFrames),e["Original Event Latency"]=this.data.eventLatencyId,e["SQL ID"]=(0,r.default)(p.SqlRef,{table:"chrome_janky_frame_presentation_intervals",id:this.data.id})),(0,g.dictToTreeNodes)(e)}getDescriptionText(){return(0,r.default)(h.MultiParagraphText,(0,r.default)(h.TextParagraph,{text:`Delay between when the frame was expected to be presented and
                 when it was actually presented.`}),(0,r.default)(h.TextParagraph,{text:`This is the period of time during which the user is viewing a
                 frame that isn't correct.`}))}getLinksSection(){var e,t={};return(0,n.exists)(this.sliceDetails)&&(0,n.exists)(this.data)?(t["Janked Event Latency stage"]=(0,n.exists)(this.causeSliceDetails)?(0,_.getSliceForTrack)(this.causeSliceDetails,m.CHROME_EVENT_LATENCY_TRACK_KIND,this.data.jankCause):this.data.jankCause,this.hasSubcause()&&(t["Sub-cause of Jank"]=(0,n.exists)(this.subcauseSliceDetails)?(0,_.getSliceForTrack)(this.subcauseSliceDetails,m.CHROME_EVENT_LATENCY_TRACK_KIND,this.data.jankSubcause):this.data.jankSubcause),e=(0,g.dictToTreeNodes)(t),(0,n.exists)(this.eventLatencySliceDetails)?e.unshift((0,r.default)(g.TreeNode,{left:(0,_.getSliceForTrack)(this.eventLatencySliceDetails,m.CHROME_EVENT_LATENCY_TRACK_KIND,"Input EventLatency in context of ScrollUpdates"),right:""})):e.unshift("Event Latency"),e):(0,g.dictToTreeNodes)(t)}viewTab(){var e;return void 0===this.data?(0,r.default)("h2","Loading"):(e=this.renderDetailsDictionary(),(0,r.default)(u.DetailsShell,{title:this.getTitle()},(0,r.default)(d.GridLayout,(0,r.default)(d.GridLayoutColumn,(0,r.default)(f.Section,{title:"Details"},(0,r.default)(g.Tree,e))),(0,r.default)(d.GridLayoutColumn,(0,r.default)(f.Section,{title:"Description"},this.getDescriptionText()),(0,r.default)(f.Section,{title:"Jank Cause"},(0,r.default)(g.Tree,this.getLinksSection()))))))}getTitle(){return this.config.title}isLoading(){return!this.loaded}}o0.ScrollJankV3DetailsPanel=y}return o0}var l0,c0={};var u0,d0,f0={};function p0(){if(!d0){d0=1,Object.defineProperty(um,"__esModule",{value:!0}),um.plugin=um.ENABLE_SCROLL_JANK_PLUGIN_V2=void 0,um.getScrollJankTracks=async function(e){var t={tracksToAdd:[]},r=await(0,g.addTopLevelScrollTrack)(),r=(t.tracksToAdd=t.tracksToAdd.concat(r.tracksToAdd),await(0,h.addScrollJankV3ScrollTrack)()),r=(t.tracksToAdd=t.tracksToAdd.concat(r.tracksToAdd),await(0,u.addLatencyTracks)()),r=(t.tracksToAdd=t.tracksToAdd.concat(r.tracksToAdd),i.Actions.addTrackGroup({name:"Chrome Scroll Jank",key:l.SCROLL_JANK_GROUP_ID,collapsed:!1,fixedOrdering:!0}));return await f.ScrollJankCauseMap.initialize(e),{tracks:t,addTrackGroup:r}};const n=Er(),a=P(),i=ne(),o=As();var e=re();const s=ue(),r=hm(),l=pm(),c=zm(),u=function(){if(!Ym){Ym=1;{var t=Jm;Object.defineProperty(t,"__esModule",{value:!0}),t.EventLatencyTrack=t.JANKY_LATENCY_NAME=void 0,t.addLatencyTracks=async function(){var e={tracksToAdd:[]};return e.tracksToAdd.push({uri:"perfetto.ChromeScrollJank#eventLatency",trackSortKey:r.PrimaryTrackSortKey.ASYNC_SLICE_TRACK,name:"Chrome Scroll Input Latencies",trackGroup:s.SCROLL_JANK_GROUP_ID}),e};const a=oe(),r=ue();var e=wl();const n=zm(),i=Qm(),o=Y(),s=pm();t.JANKY_LATENCY_NAME="Janky EventLatency";class l extends e.CustomSqlTableSliceTrack{baseTable;constructor(e,t){super(e),this.baseTable=t,s.ScrollJankPluginState.getInstance().registerTrack({kind:s.CHROME_EVENT_LATENCY_TRACK_KIND,trackKey:this.trackKey,tableName:this.tableName,detailsPanelConfig:this.getDetailsPanel()})}async onDestroy(){await super.onDestroy(),s.ScrollJankPluginState.getInstance().unregisterTrack(s.CHROME_EVENT_LATENCY_TRACK_KIND)}getSqlSource(){return"SELECT * FROM "+this.baseTable}getDetailsPanel(){return{kind:n.EventLatencySliceDetailsPanel.kind,config:{title:"",sqlTableName:this.tableName}}}getSqlDataSource(){return{sqlTableName:this.baseTable}}rowToSlice(e){e=super.rowToSlice(e);return e.title===t.JANKY_LATENCY_NAME?{...e,colorScheme:i.JANK_COLOR}:e}onUpdatedSlices(e){for(const n of e){var t=(0,o.getLegacySelection)(a.globals.state),t=t&&"GENERIC_SLICE"===t.kind&&void 0!==t.id&&t.id===n.id,r=a.globals.state.highlightedSliceId===n.id;n.isHighlighted=!!(r||t)}super.onUpdatedSlices(e)}}t.EventLatencyTrack=l}}return Jm}(),d=a0(),f=Hm(),p=s0(),h=function(){if(!l0){l0=1,Object.defineProperty(c0,"__esModule",{value:!0}),c0.ScrollJankV3Track=void 0,c0.addScrollJankV3ScrollTrack=async function(){var e={tracksToAdd:[]};return e.tracksToAdd.push({uri:"perfetto.ChromeScrollJank#scrollJankV3",trackSortKey:t.PrimaryTrackSortKey.ASYNC_SLICE_TRACK,name:"Chrome Scroll Janks",trackGroup:s.SCROLL_JANK_GROUP_ID}),e};const a=oe(),t=ue();var e=wl();const r=Qm(),n=s0(),i=M(),o=Y(),s=pm();class l extends e.CustomSqlTableSliceTrack{constructor(e){super(e),s.ScrollJankPluginState.getInstance().registerTrack({kind:s.ScrollJankV3TrackKind,trackKey:this.trackKey,tableName:this.tableName,detailsPanelConfig:this.getDetailsPanel()})}getSqlDataSource(){return{columns:[`IIF(
          cause_of_jank IS NOT NULL,
          cause_of_jank || IIF(
            sub_cause_of_jank IS NOT NULL, "::" || sub_cause_of_jank, ""
            ), "Unknown") || " Jank" AS name`,"id","ts","dur","event_latency_id"],sqlTableName:"chrome_janky_frame_presentation_intervals"}}getDetailsPanel(){return{kind:n.ScrollJankV3DetailsPanel.kind,config:{sqlTableName:"chrome_janky_frame_presentation_intervals",title:"Chrome Scroll Janks"}}}async onDestroy(){await super.onDestroy(),s.ScrollJankPluginState.getInstance().unregisterTrack(s.ScrollJankV3TrackKind)}rowToSlice(e){e=super.rowToSlice(e);let t=e.title.substring(0,e.title.indexOf(" Jank"));return"Unknown"==(t=-1!=t.indexOf("::")?t.substring(t.indexOf("::")+"::".length):t)?{...e,colorScheme:r.JANK_COLOR}:{...e,colorScheme:(0,i.getColorForSlice)(t)}}onUpdatedSlices(e){for(const n of e){var t=(0,o.getLegacySelection)(a.globals.state),t=t&&"GENERIC_SLICE"===t.kind&&void 0!==t.id&&t.id===n.id,r=a.globals.state.highlightedSliceId===n.id;n.isHighlighted=!!(r||t)}super.onUpdatedSlices(e)}}c0.ScrollJankV3Track=l}return c0}(),g=function(){if(!u0){u0=1;{var e=f0;Object.defineProperty(e,"__esModule",{value:!0}),e.TopLevelScrollTrack=e.CHROME_TOPLEVEL_SCROLLS_KIND=void 0,e.addTopLevelScrollTrack=async function(){var e={tracksToAdd:[]};return e.tracksToAdd.push({uri:"perfetto.ChromeScrollJank#toplevelScrolls",trackSortKey:r.PrimaryTrackSortKey.ASYNC_SLICE_TRACK,name:"Chrome Scrolls",trackGroup:n.SCROLL_JANK_GROUP_ID}),e};const r=ue();var t=wl();const n=pm(),a=a0();e.CHROME_TOPLEVEL_SCROLLS_KIND="org.chromium.TopLevelScrolls.scrolls";class i extends t.CustomSqlTableSliceTrack{static kind=e.CHROME_TOPLEVEL_SCROLLS_KIND;getSqlDataSource(){return{columns:['printf("Scroll %s", CAST(id AS STRING)) AS name',"*"],sqlTableName:"chrome_scrolls"}}getDetailsPanel(){return{kind:a.ScrollDetailsPanel.kind,config:{sqlTableName:this.tableName,title:"Chrome Top Level Scrolls"}}}constructor(e){super(e),n.ScrollJankPluginState.getInstance().registerTrack({kind:i.kind,trackKey:this.trackKey,tableName:this.tableName,detailsPanelConfig:this.getDetailsPanel()})}async onDestroy(){await super.onDestroy(),n.ScrollJankPluginState.getInstance().unregisterTrack(i.kind)}}e.TopLevelScrollTrack=i}}return f0}();um.ENABLE_SCROLL_JANK_PLUGIN_V2=e.featureFlags.register({id:"enableScrollJankPluginV2",name:"Enable Chrome Scroll Jank plugin V2",description:"Adds new tracks and visualizations for scroll jank.",defaultValue:!1});um.plugin={pluginId:"perfetto.ChromeScrollJank",plugin:class{async onTraceLoad(e){await this.addChromeScrollJankTrack(e),await this.addTopLevelScrollTrack(e),await this.addEventLatencyTrack(e),await this.addScrollJankV3ScrollTrack(e),l.ENABLE_CHROME_SCROLL_JANK_PLUGIN.get()&&await async function(e){e=await e.query(`
      select utid, upid
      from thread
      where name='CrBrowserMain'
      `),e=e.iter({utid:s.NUM,upid:s.NUM});return e.valid()}(e.engine)&&(await e.engine.query(`
      INCLUDE PERFETTO MODULE deprecated.v42.common.slices;
      SELECT RUN_METRIC(
        'chrome/chrome_tasks_delaying_input_processing.sql',
        'duration_causing_jank_ms',
        /* duration_causing_jank_ms = */ '8');`),e.tabs.openQuery(`
       select
         s1.full_name,
         s1.duration_ms,
         s1.slice_id,
         s1.thread_dur_ms,
         s2.id,
         s2.ts,
         s2.dur,
         s2.track_id
       from chrome_tasks_delaying_input_processing s1
       join slice s2 on s1.slice_id=s2.id
       `,"Scroll Jank: long tasks"))}async addChromeScrollJankTrack(t){t.registerTrack({uri:"perfetto.ChromeScrollJank",title:"Scroll Jank causes - long tasks",tags:{kind:r.ChromeTasksScrollJankTrack.kind},trackFactory:({trackKey:e})=>new r.ChromeTasksScrollJankTrack({engine:t.engine,trackKey:e})})}async addTopLevelScrollTrack(t){await t.engine.query(`
      INCLUDE PERFETTO MODULE chrome.chrome_scrolls;
      INCLUDE PERFETTO MODULE chrome.scroll_jank.scroll_offsets;
    `),t.registerTrack({uri:"perfetto.ChromeScrollJank#toplevelScrolls",title:"Chrome Scrolls",tags:{kind:g.CHROME_TOPLEVEL_SCROLLS_KIND},trackFactory:({trackKey:e})=>new g.TopLevelScrollTrack({engine:t.engine,trackKey:e})}),t.registerDetailsPanel(new s.BottomTabToSCSAdapter({tabFactory:e=>{if("GENERIC_SLICE"===e.kind&&e.detailsPanelConfig.kind===d.ScrollDetailsPanel.kind)return e=e.detailsPanelConfig.config,new d.ScrollDetailsPanel({config:e,engine:t.engine,uuid:(0,n.v4)()})}}))}async addEventLatencyTrack(t){var e=(0,o.generateSqlWithInternalLayout)({columns:["id","ts","dur","track_id","name"],sourceTable:"slice",ts:"ts",dur:"dur",whereClause:`
        EXTRACT_ARG(arg_set_id, 'event_latency.event_type') IN (
          'FIRST_GESTURE_SCROLL_UPDATE',
          'GESTURE_SCROLL_UPDATE',
          'INERTIAL_GESTURE_SCROLL_UPDATE')
        AND has_descendant_slice_with_name(
          id,
          'SubmitCompositorFrameToPresentationCompositorFrame')
        AND name = 'EventLatency'
        AND depth = 0`});const r=`table_${(0,a.uuidv4Sql)()}_janky_event_latencies_v3`;e=`CREATE TABLE ${r} AS
        WITH
        event_latencies AS MATERIALIZED (
          ${e}
        ),
        latency_stages AS (
          SELECT
            stage.id,
            stage.ts,
            stage.dur,
            stage.track_id,
            stage.name,
            stage.depth,
            event.id as event_latency_id,
            event.depth as event_latency_depth
          FROM event_latencies event
          JOIN descendant_slice(event.id) stage
          UNION ALL
          SELECT
            event.id,
            event.ts,
            event.dur,
            event.track_id,
            IIF(
              id IN (SELECT id FROM chrome_janky_event_latencies_v3),
              '${u.JANKY_LATENCY_NAME}',
              name
            ) as name,
            0 as depth,
            event.id as event_latency_id,
            event.depth as event_latency_depth
          FROM event_latencies event
        ),
        -- Event latencies have already had layout computed, but the width of event latency can vary (3 or 4),
        -- so we have to compute the max stage depth for each event latency depth to compute offset for each
        -- event latency row.
        event_latency_height_per_row AS (
          SELECT
            event_latency_depth,
            MAX(depth) AS max_depth
          FROM latency_stages
          GROUP BY event_latency_depth
        ),
        -- Compute the offset for each event latency depth using max depth info for each depth.
        event_latency_layout_offset AS (
          SELECT
            event_latency_depth,
            -- As the sum is exclusive, it will return NULL for the first row — we need to set it to 0 explicitly.
            IFNULL(
              SUM(max_depth + 1) OVER (
                ORDER BY event_latency_depth
                ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING
              ),
            0) as offset
          FROM event_latency_height_per_row
        )
      SELECT
        stage.id,
        stage.ts,
        stage.dur,
        stage.name,
        stage.depth + (
          (
            SELECT offset.offset
            FROM event_latencies event
            JOIN event_latency_layout_offset offset ON event.depth = offset.event_latency_depth
            WHERE id = stage.event_latency_id
          )
        ) AS depth
      FROM latency_stages stage;`;await t.engine.query("INCLUDE PERFETTO MODULE chrome.scroll_jank.scroll_jank_intervals"),await t.engine.query(e),t.registerTrack({uri:"perfetto.ChromeScrollJank#eventLatency",title:"Chrome Scroll Input Latencies",tags:{kind:l.CHROME_EVENT_LATENCY_TRACK_KIND},trackFactory:({trackKey:e})=>new u.EventLatencyTrack({engine:t.engine,trackKey:e},r)}),t.registerDetailsPanel(new s.BottomTabToSCSAdapter({tabFactory:e=>{if("GENERIC_SLICE"===e.kind&&e.detailsPanelConfig.kind===c.EventLatencySliceDetailsPanel.kind)return e=e.detailsPanelConfig.config,new c.EventLatencySliceDetailsPanel({config:e,engine:t.engine,uuid:(0,n.v4)()})}}))}async addScrollJankV3ScrollTrack(t){await t.engine.query("INCLUDE PERFETTO MODULE chrome.scroll_jank.scroll_jank_intervals"),t.registerTrack({uri:"perfetto.ChromeScrollJank#scrollJankV3",title:"Chrome Scroll Janks",tags:{kind:l.ScrollJankV3TrackKind},trackFactory:({trackKey:e})=>new h.ScrollJankV3Track({engine:t.engine,trackKey:e})}),t.registerDetailsPanel(new s.BottomTabToSCSAdapter({tabFactory:e=>{if("GENERIC_SLICE"===e.kind&&e.detailsPanelConfig.kind===p.ScrollJankV3DetailsPanel.kind)return e=e.detailsPanelConfig.config,new p.ScrollJankV3DetailsPanel({config:e,engine:t.engine,uuid:(0,n.v4)()})}}))}}}}return um}var h0,g0={},m0={};function _0(){if(!h0){h0=1,Object.defineProperty(m0,"__esModule",{value:!0}),m0.ChromeTasksDetailsTab=void 0;const r=or.__importDefault(ae());var e=Pl();const n=F(),a=Cf(),i=Fg(),o=zg();var t=i.DetailsSchema;class s extends e.BottomTab{static kind="org.chromium.ChromeTasks.TaskDetailsTab";data;constructor(e){super(e),this.data=new i.Details(this.engine,"chrome_tasks",this.config.id,{"Task name":"name","Start time":t.Timestamp("ts"),Duration:t.Interval("ts","dur"),Process:t.SqlIdRef("process","upid"),Thread:t.SqlIdRef("thread","utid"),Slice:t.SqlIdRef("slice","id")},o.wellKnownTypes)}viewTab(){return(0,r.default)(n.DetailsShell,{title:this.getTitle()},(0,r.default)(a.GridLayout,(0,r.default)(a.GridLayoutColumn,this.data.render())))}getTitle(){return this.config.title}isLoading(){return this.data.isLoading()}}m0.ChromeTasksDetailsTab=s}return m0}var y0,T0={};var b0,v0,E0={};function S0(){if(!v0){v0=1,Object.defineProperty(g0,"__esModule",{value:!0}),g0.plugin=void 0;const a=P(),t=rf(),i=Nc(),o=ue(),s=_0(),r=(y0||(y0=1,Object.defineProperty(T0,"__esModule",{value:!0}),T0.chromeTasksTable=void 0,T0.chromeTasksTable={imports:["chrome.tasks"],name:"chrome_tasks",columns:[{name:"id",title:"ID",display:{type:"slice_id",ts:"ts",dur:"dur",trackId:"track_id"}},{name:"ts",title:"Timestamp",display:{type:"timestamp"}},{name:"dur",title:"Duration",display:{type:"duration"}},{name:"thread_dur",title:"Thread duration",display:{type:"thread_duration"}},{name:"category",title:"Category"},{name:"name",title:"Name"},{name:"track_id",title:"Track ID",startsHidden:!0},{name:"track_name",title:"Track name",startsHidden:!0},{name:"thread_name",title:"Thread name"},{name:"utid",startsHidden:!0},{name:"process_name",title:"Process name"},{name:"upid",startsHidden:!0},{name:"arg_set_id",title:"Arg",type:"arg_set_id"}]}),T0),l=function(){if(!b0){b0=1,Object.defineProperty(E0,"__esModule",{value:!0}),E0.ChromeTasksThreadTrack=void 0;var e=wl();const t=_0();class r extends e.CustomSqlTableSliceTrack{utid;constructor(e,t,r){super({engine:e,trackKey:t}),this.utid=r}getSqlDataSource(){return{columns:["name","id","ts","dur"],sqlTableName:"chrome_tasks",whereClause:"utid = "+this.utid}}getDetailsPanel(){return{kind:t.ChromeTasksDetailsTab.kind,config:{sqlTableName:"chrome_tasks",title:"Chrome Tasks"}}}}E0.ChromeTasksThreadTrack=r}return E0}();g0.plugin={pluginId:"org.chromium.ChromeTasks",plugin:class{onActivate(){}async onTraceLoad(e){await this.createTracks(e),e.registerCommand({id:"org.chromium.ChromeTasks.ShowChromeTasksTable",name:"Show chrome_tasks table",callback:()=>(0,t.addSqlTableTab)({table:r.chromeTasksTable})})}async createTracks(t){for(var e=(await t.engine.query(`
      INCLUDE PERFETTO MODULE chrome.tasks;

      with relevant_threads as (
        select distinct utid from chrome_tasks
      )
      select
        (CASE process.name
          WHEN 'Browser' THEN 1
          WHEN 'Gpu' THEN 2
          WHEN 'Renderer' THEN 4
          ELSE 3
        END) as processRank,
        process.name as processName,
        process.pid,
        process.upid,
        (CASE thread.name
          WHEN 'CrBrowserMain' THEN 1
          WHEN 'CrRendererMain' THEN 1
          WHEN 'CrGpuMain' THEN 1
          WHEN 'Chrome_IOThread' THEN 2
          WHEN 'Chrome_ChildIOThread' THEN 2
          WHEN 'VizCompositorThread' THEN 3
          WHEN 'NetworkService' THEN 3
          WHEN 'Compositor' THEN 3
          WHEN 'CompositorGpuThread' THEN 4
          WHEN 'CompositorTileWorker&' THEN 5
          WHEN 'ThreadPoolService' THEN 6
          WHEN 'ThreadPoolSingleThreadForegroundBlocking&' THEN 6
          WHEN 'ThreadPoolForegroundWorker' THEN 6
          ELSE 7
         END) as threadRank,
         thread.name as threadName,
         thread.tid,
         thread.utid
      from relevant_threads
      join thread using (utid)
      join process using (upid)
      order by processRank, upid, threadRank, utid
    `)).iter({processRank:o.NUM,processName:o.STR_NULL,pid:o.NUM_NULL,upid:o.NUM,threadRank:o.NUM,threadName:o.STR_NULL,tid:o.NUM_NULL,utid:o.NUM});e.valid();e.next()){const n=e.utid;var r="org.chromium.ChromeTasks#thread."+n;t.registerStaticTrack({uri:r,trackFactory:({trackKey:e})=>new l.ChromeTasksThreadTrack(t.engine,e,(0,i.asUtid)(n)),groupName:"Chrome Tasks",title:e.threadName+" "+e.tid})}t.registerDetailsPanel(new o.BottomTabToSCSAdapter({tabFactory:e=>{if("GENERIC_SLICE"===e.kind&&e.detailsPanelConfig.kind===s.ChromeTasksDetailsTab.kind)return e=e.detailsPanelConfig.config,new s.ChromeTasksDetailsTab({config:e,engine:t.engine,uuid:(0,a.uuidv4)()})}}))}}}}return g0}var A0,O0,C0,k0,w0,R0,I0,M0,P0,N0,D0={},x0={},L0={},F0={},U0={},B0={};function j0(){if(!A0){const u=0,d=A0=1;const f=29,p=256,h=p+1+f,g=30,m=19,_=2*h+1,y=15,n=16,j=7,T=256,b=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),v=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),H=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),E=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);const S=new Array(2*(h+2)),A=(e(S),new Array(2*g)),O=(e(A),new Array(512)),C=(e(O),new Array(256)),k=(e(C),new Array(f)),w=(e(k),new Array(g));e(w);let o,s,l;const R=e=>e<256?O[e]:O[256+(e>>>7)],a=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},I=(e,t,r)=>{e.bi_valid>n-r?(e.bi_buf|=t<<e.bi_valid&65535,a(e,e.bi_buf),e.bi_buf=t>>n-e.bi_valid,e.bi_valid+=r-n):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},M=(e,t,r)=>{I(e,r[2*t],r[2*t+1])},P=(e,t)=>{let r=0;for(;r|=1&e,e>>>=1,r<<=1,0<--t;);return r>>>1},G=(e,t)=>{var r,n=t.dyn_tree,a=t.max_code,i=t.stat_desc.static_tree,o=t.stat_desc.has_stree,s=t.stat_desc.extra_bits,l=t.stat_desc.extra_base,c=t.stat_desc.max_length;let u,d,f,p,h,g=0;for(p=0;p<=y;p++)e.bl_count[p]=0;for(n[2*e.heap[e.heap_max]+1]=0,u=e.heap_max+1;u<_;u++)d=e.heap[u],(p=n[2*n[2*d+1]+1]+1)>c&&(p=c,g++),n[2*d+1]=p,d>a||(e.bl_count[p]++,h=0,d>=l&&(h=s[d-l]),r=n[2*d],e.opt_len+=r*(p+h),o&&(e.static_len+=r*(i[2*d+1]+h)));if(0!==g){do{for(p=c-1;0===e.bl_count[p];)p--}while(e.bl_count[p]--,e.bl_count[p+1]+=2,e.bl_count[c]--,0<(g-=2));for(p=c;0!==p;p--)for(d=e.bl_count[p];0!==d;)a<(f=e.heap[--u])||(n[2*f+1]!==p&&(e.opt_len+=(p-n[2*f+1])*n[2*f],n[2*f+1]=p),d--)}},N=(e,t,r)=>{var n=new Array(y+1);let a=0,i,o;for(i=1;i<=y;i++)a=a+r[i-1]<<1,n[i]=a;for(o=0;o<=t;o++){var s=e[2*o+1];0!==s&&(e[2*o]=P(n[s]++,s))}},D=e=>{let t;for(t=0;t<h;t++)e.dyn_ltree[2*t]=0;for(t=0;t<g;t++)e.dyn_dtree[2*t]=0;for(t=0;t<m;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*T]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},x=e=>{8<e.bi_valid?a(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},i=(e,t,r,n)=>{var a=2*t,i=2*r;return e[a]<e[i]||e[a]===e[i]&&n[t]<=n[r]},L=(e,t,r)=>{var n=e.heap[r];let a=r<<1;for(;a<=e.heap_len&&(a<e.heap_len&&i(t,e.heap[a+1],e.heap[a],e.depth)&&a++,!i(t,n,e.heap[a],e.depth));)e.heap[r]=e.heap[a],r=a,a<<=1;e.heap[r]=n},F=(e,t,r)=>{var n,a,i,o;let s=0;if(0!==e.sym_next)for(;n=255&e.pending_buf[e.sym_buf+s++],n+=(255&e.pending_buf[e.sym_buf+s++])<<8,a=e.pending_buf[e.sym_buf+s++],0==n?M(e,a,t):(i=C[a],M(e,i+p+1,t),0!==(o=b[i])&&(a-=k[i],I(e,a,o)),n--,i=R(n),M(e,i,r),0!==(o=v[i])&&(n-=w[i],I(e,n,o))),s<e.sym_next;);M(e,T,t)},U=(e,t)=>{var r=t.dyn_tree,n=t.stat_desc.static_tree,a=t.stat_desc.has_stree,i=t.stat_desc.elems;let o,s,l=-1,c;for(e.heap_len=0,e.heap_max=_,o=0;o<i;o++)0!==r[2*o]?(e.heap[++e.heap_len]=l=o,e.depth[o]=0):r[2*o+1]=0;for(;e.heap_len<2;)r[2*(c=e.heap[++e.heap_len]=l<2?++l:0)]=1,e.depth[c]=0,e.opt_len--,a&&(e.static_len-=n[2*c+1]);for(t.max_code=l,o=e.heap_len>>1;1<=o;o--)L(e,r,o);for(c=i;o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],L(e,r,1),s=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=s,r[2*c]=r[2*o]+r[2*s],e.depth[c]=(e.depth[o]>=e.depth[s]?e.depth[o]:e.depth[s])+1,r[2*o+1]=r[2*s+1]=c,e.heap[1]=c++,L(e,r,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],G(e,t),N(r,l,e.bl_count)},B=(e,t,r)=>{let n,a=-1;var i;let o=t[1],s=0,l=7,c=4;for(0===o&&(l=138,c=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=o,o=t[2*(n+1)+1],++s<l&&i===o||(s<c?e.bl_tree[2*i]+=s:0!==i?(i!==a&&e.bl_tree[2*i]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,a=i,c=0===o?(l=138,3):i===o?(l=6,3):(l=7,4))},V=(e,t,r)=>{let n,a=-1;var i;let o=t[1],s=0,l=7,c=4;for(0===o&&(l=138,c=3),n=0;n<=r;n++)if(i=o,o=t[2*(n+1)+1],!(++s<l&&i===o)){if(s<c)for(;M(e,i,e.bl_tree),0!=--s;);else 0!==i?(i!==a&&(M(e,i,e.bl_tree),s--),M(e,16,e.bl_tree),I(e,s-3,2)):s<=10?(M(e,17,e.bl_tree),I(e,s-3,3)):(M(e,18,e.bl_tree),I(e,s-11,7));s=0,a=i,c=0===o?(l=138,3):i===o?(l=6,3):(l=7,4)}};let t=!1;const W=(e,t,r,n)=>{I(e,0+(n?1:0),3),x(e),a(e,r),a(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r};function e(e){let t=e.length;for(;0<=--t;)e[t]=0}function c(e,t,r,n,a){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=a,this.has_stree=e&&e.length}function r(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}B0._tr_init=e=>{if(!t){{let e,t,r,n,a;var i=new Array(y+1);for(r=0,n=0;n<f-1;n++)for(k[n]=r,e=0;e<1<<b[n];e++)C[r++]=n;for(C[r-1]=n,a=0,n=0;n<16;n++)for(w[n]=a,e=0;e<1<<v[n];e++)O[a++]=n;for(a>>=7;n<g;n++)for(w[n]=a<<7,e=0;e<1<<v[n]-7;e++)O[256+a++]=n;for(t=0;t<=y;t++)i[t]=0;for(e=0;e<=143;)S[2*e+1]=8,e++,i[8]++;for(;e<=255;)S[2*e+1]=9,e++,i[9]++;for(;e<=279;)S[2*e+1]=7,e++,i[7]++;for(;e<=287;)S[2*e+1]=8,e++,i[8]++;for(N(S,h+1,i),e=0;e<g;e++)A[2*e+1]=5,A[2*e]=P(e,5);o=new c(S,b,p+1,h,y),s=new c(A,v,0,g,y),l=new c(new Array(0),H,0,m,j)}t=!0}e.l_desc=new r(e.dyn_ltree,o),e.d_desc=new r(e.dyn_dtree,s),e.bl_desc=new r(e.bl_tree,l),e.bi_buf=0,e.bi_valid=0,D(e)},B0._tr_stored_block=W,B0._tr_flush_block=(t,r,n,e)=>{let a,i,o=0;if(0<t.level?(2===t.strm.data_type&&(t.strm.data_type=(e=>{let t=4093624447,r;for(r=0;r<=31;r++,t>>>=1)if(1&t&&0!==e.dyn_ltree[2*r])return u;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return d;for(r=32;r<p;r++)if(0!==e.dyn_ltree[2*r])return d;return u})(t)),U(t,t.l_desc),U(t,t.d_desc),o=(e=>{let t;for(B(e,e.dyn_ltree,e.l_desc.max_code),B(e,e.dyn_dtree,e.d_desc.max_code),U(e,e.bl_desc),t=m-1;3<=t&&0===e.bl_tree[2*E[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(t),a=t.opt_len+3+7>>>3,(i=t.static_len+3+7>>>3)<=a&&(a=i)):a=i=n+5,n+4<=a&&-1!==r)W(t,r,n,e);else if(4===t.strategy||i===a)I(t,2+(e?1:0),3),F(t,S,A);else{I(t,4+(e?1:0),3);{var s=t;r=t.l_desc.max_code+1;n=t.d_desc.max_code+1;var l=o+1;let e;for(I(s,r-257,5),I(s,n-1,5),I(s,l-4,4),e=0;e<l;e++)I(s,s.bl_tree[2*E[e]+1],3);V(s,s.dyn_ltree,r-1),V(s,s.dyn_dtree,n-1)}F(t,t.dyn_ltree,t.dyn_dtree)}D(t),e&&x(t)},B0._tr_tally=(e,t,r)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(C[r]+p+1)]++,e.dyn_dtree[2*R(t)]++),e.sym_next===e.sym_end),B0._tr_align=e=>{I(e,2,3),M(e,T,S),16===(e=e).bi_valid?(a(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}}return B0}function H0(){return C0||(C0=1,O0=(e,t,r,n)=>{let a=65535&e|0,i=e>>>16&65535|0,o=0;for(;0!==r;){for(r-=o=2e3<r?2e3:r;a=a+t[n++]|0,i=i+a|0,--o;);a%=65521,i%=65521}return a|i<<16|0}),O0}function G0(){if(!w0){w0=1;const o=new Uint32Array((()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t})());k0=(t,r,e,n)=>{var a=o,i=n+e;t^=-1;for(let e=n;e<i;e++)t=t>>>8^a[255&(t^r[e])];return-1^t}}return k0}function V0(){return I0||(I0=1,R0={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}),R0}function W0(){return M0=P0?M0:{Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:P0=1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}}function q0(){if(!N0){N0=1;const{_tr_init:a,_tr_stored_block:c,_tr_flush_block:i,_tr_tally:s,_tr_align:H}=j0(),G=H0(),o=G0(),V=V0(),{Z_NO_FLUSH:u,Z_PARTIAL_FLUSH:W,Z_FULL_FLUSH:q,Z_FINISH:d,Z_BLOCK:$,Z_OK:f,Z_STREAM_END:z,Z_STREAM_ERROR:p,Z_DATA_ERROR:K,Z_BUF_ERROR:h,Z_DEFAULT_COMPRESSION:Y,Z_FILTERED:J,Z_HUFFMAN_ONLY:g,Z_RLE:Z,Z_FIXED:Q,Z_DEFAULT_STRATEGY:X,Z_UNKNOWN:ee,Z_DEFLATED:m}=W0(),te=9;const r=286,re=30,ne=19,ae=2*r+1,ie=15,_=3,y=258,T=y+_+1,b=42,v=57,E=69,S=73,A=91,oe=103,O=113,C=666,k=1,w=2,R=3,I=4,M=(e,t)=>(e.msg=V[t],t),se=e=>2*e-(4<e?9:0),P=e=>{let t=e.length;for(;0<=--t;)e[t]=0},le=e=>{let t,r,n;var a=e.w_size;for(t=e.hash_size,n=t;r=e.head[--n],e.head[n]=r>=a?r-a:0,--t;);for(t=a,n=t;r=e.prev[--n],e.prev[n]=r>=a?r-a:0,--t;);};let l=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask;const N=e=>{var t=e.state;let r=t.pending;0!==(r=r>e.avail_out?e.avail_out:r)&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending)&&(t.pending_out=0)},D=(e,t)=>{i(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,N(e.strm)},x=(e,t)=>{e.pending_buf[e.pending++]=t},L=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},ce=(e,t,r,n)=>{let a=e.avail_in;return 0===(a=a>n?n:a)?0:(e.avail_in-=a,t.set(e.input.subarray(e.next_in,e.next_in+a),r),1===e.state.wrap?e.adler=G(e.adler,t,a,r):2===e.state.wrap&&(e.adler=o(e.adler,t,a,r)),e.next_in+=a,e.total_in+=a,a)},ue=(e,t)=>{let r=e.max_chain_length,n=e.strstart,a;var i;let o=e.prev_length,s=e.nice_match;var l=e.strstart>e.w_size-T?e.strstart-(e.w_size-T):0,c=e.window,u=e.w_mask,d=e.prev,f=e.strstart+y;let p=c[n+o-1],h=c[n+o];e.prev_length>=e.good_match&&(r>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(a=t)+o]===h&&c[a+o-1]===p&&c[a]===c[n]&&c[++a]===c[n+1]){for(n+=2,a++;c[++n]===c[++a]&&c[++n]===c[++a]&&c[++n]===c[++a]&&c[++n]===c[++a]&&c[++n]===c[++a]&&c[++n]===c[++a]&&c[++n]===c[++a]&&c[++n]===c[++a]&&n<f;);if(i=y-(f-n),n=f-y,i>o){if(e.match_start=t,(o=i)>=s)break;p=c[n+o-1],h=c[n+o]}}}while((t=d[t&u])>l&&0!=--r);return o<=e.lookahead?o:e.lookahead},F=e=>{var t=e.w_size;let r,n,a;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-T)&&(e.window.set(e.window.subarray(t,t+t-n),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),le(e),n+=t),0===e.strm.avail_in)break;if(r=ce(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=r,e.lookahead+e.insert>=_)for(a=e.strstart-e.insert,e.ins_h=e.window[a],e.ins_h=l(e,e.ins_h,e.window[a+1]);e.insert&&(e.ins_h=l(e,e.ins_h,e.window[a+_-1]),e.prev[a&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=a,a++,e.insert--,!(e.lookahead+e.insert<_)););}while(e.lookahead<T&&0!==e.strm.avail_in)},de=(e,t)=>{let r=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,n,a,i,o=0;for(var s=e.strm.avail_in;n=65535,i=e.bi_valid+42>>3,!(e.strm.avail_out<i||(i=e.strm.avail_out-i,a=e.strstart-e.block_start,(n=(n=n>a+e.strm.avail_in?a+e.strm.avail_in:n)>i?i:n)<r&&(0===n&&t!==d||t===u||n!==a+e.strm.avail_in))||(o=t===d&&n===a+e.strm.avail_in?1:0,c(e,0,0,o),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,N(e.strm),a&&(a>n&&(a=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+a),e.strm.next_out),e.strm.next_out+=a,e.strm.avail_out-=a,e.strm.total_out+=a,e.block_start+=a,n-=a),n&&(ce(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n),0!==o)););return(s-=e.strm.avail_in)&&(s>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=s&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart)&&(e.insert=e.strstart),e.window.set(e.strm.input.subarray(e.strm.next_in-s,e.strm.next_in),e.strstart),e.strstart+=s,e.insert+=s>e.w_size-e.insert?e.w_size-e.insert:s),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),o?I:t!==u&&t!==d&&0===e.strm.avail_in&&e.strstart===e.block_start?w:(i=e.window_size-e.strstart,e.strm.avail_in>i&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,i+=e.w_size,e.insert>e.strstart)&&(e.insert=e.strstart),(i=i>e.strm.avail_in?e.strm.avail_in:i)&&(ce(e.strm,e.window,e.strstart,i),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.high_water<e.strstart&&(e.high_water=e.strstart),i=e.bi_valid+42>>3,i=65535<e.pending_buf_size-i?65535:e.pending_buf_size-i,r=i>e.w_size?e.w_size:i,((a=e.strstart-e.block_start)>=r||(a||t===d)&&t!==u&&0===e.strm.avail_in&&a<=i)&&(n=a>i?i:a,o=t===d&&0===e.strm.avail_in&&n===a?1:0,c(e,e.block_start,n,o),e.block_start+=n,N(e.strm)),o?R:k)};var n=(e,t)=>{let r,n;for(;;){if(e.lookahead<T){if(F(e),e.lookahead<T&&t===u)return k;if(0===e.lookahead)break}if(r=0,e.lookahead>=_&&(e.ins_h=l(e,e.ins_h,e.window[e.strstart+_-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-T&&(e.match_length=ue(e,r)),e.match_length>=_)if(n=s(e,e.strstart-e.match_start,e.match_length-_),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=_){for(e.match_length--;e.strstart++,e.ins_h=l(e,e.ins_h,e.window[e.strstart+_-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=l(e,e.ins_h,e.window[e.strstart+1]);else n=s(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(D(e,!1),0===e.strm.avail_out))return k}return e.insert=e.strstart<_-1?e.strstart:_-1,t===d?(D(e,!0),0===e.strm.avail_out?R:I):e.sym_next&&(D(e,!1),0===e.strm.avail_out)?k:w},e=(e,t)=>{let r,n;for(var a;;){if(e.lookahead<T){if(F(e),e.lookahead<T&&t===u)return k;if(0===e.lookahead)break}if(r=0,e.lookahead>=_&&(e.ins_h=l(e,e.ins_h,e.window[e.strstart+_-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=_-1,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-T&&(e.match_length=ue(e,r),e.match_length<=5)&&(e.strategy===J||e.match_length===_&&4096<e.strstart-e.match_start)&&(e.match_length=_-1),e.prev_length>=_&&e.match_length<=e.prev_length){for(a=e.strstart+e.lookahead-_,n=s(e,e.strstart-1-e.prev_match,e.prev_length-_),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=a&&(e.ins_h=l(e,e.ins_h,e.window[e.strstart+_-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=_-1,e.strstart++,n&&(D(e,!1),0===e.strm.avail_out))return k}else if(e.match_available){if((n=s(e,0,e.window[e.strstart-1]))&&D(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return k}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=s(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<_-1?e.strstart:_-1,t===d?(D(e,!0),0===e.strm.avail_out?R:I):e.sym_next&&(D(e,!1),0===e.strm.avail_out)?k:w};const U=[new t(0,0,0,0,de),new t(4,4,8,4,n),new t(4,5,16,8,n),new t(4,6,32,32,n),new t(4,4,16,16,e),new t(8,16,32,32,e),new t(8,16,128,128,e),new t(8,32,128,256,e),new t(32,128,258,1024,e),new t(32,258,258,4096,e)],B=e=>{var t;return!e||!(t=e.state)||t.strm!==e||t.status!==b&&t.status!==v&&t.status!==E&&t.status!==S&&t.status!==A&&t.status!==oe&&t.status!==O&&t.status!==C?1:0},fe=e=>{if(B(e))return M(e,p);e.total_in=e.total_out=0,e.data_type=ee;var t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?v:t.wrap?b:O,e.adler=2===t.wrap?0:1,t.last_flush=-2,a(t),f},pe=e=>{var t=fe(e);return t===f&&((e=e.state).window_size=2*e.w_size,P(e.head),e.max_lazy_match=U[e.level].max_lazy,e.good_match=U[e.level].good_length,e.nice_match=U[e.level].nice_length,e.max_chain_length=U[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=_-1,e.match_available=0,e.ins_h=0),t};const he=(e,t,r,n,a,i)=>{if(!e)return p;let o=1;if(t===Y&&(t=6),n<0?(o=0,n=-n):15<n&&(o=2,n-=16),a<1||a>te||r!==m||n<8||15<n||t<0||9<t||i<0||i>Q||8===n&&1!==o)return M(e,p);8===n&&(n=9);var s=new j;return(e.state=s).strm=e,s.status=b,s.wrap=o,s.gzhead=null,s.w_bits=n,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=a+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+_-1)/_),s.window=new Uint8Array(2*s.w_size),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<a+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Uint8Array(s.pending_buf_size),s.sym_buf=s.lit_bufsize,s.sym_end=3*(s.lit_bufsize-1),s.level=t,s.strategy=i,s.method=r,pe(e)};function t(e,t,r,n,a){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=a}function j(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=m,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*ae),this.dyn_dtree=new Uint16Array(2*(2*re+1)),this.bl_tree=new Uint16Array(2*(2*ne+1)),P(this.dyn_ltree),P(this.dyn_dtree),P(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(ie+1),this.heap=new Uint16Array(2*r+1),P(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*r+1),P(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}U0.deflateInit=(e,t)=>he(e,t,m,15,8,X),U0.deflateInit2=he,U0.deflateReset=pe,U0.deflateResetKeep=fe,U0.deflateSetHeader=(e,t)=>B(e)||2!==e.state.wrap?p:(e.state.gzhead=t,f),U0.deflate=(r,e)=>{if(B(r)||e>$||e<0)return r?M(r,p):p;var n=r.state;if(!r.output||0!==r.avail_in&&!r.input||n.status===C&&e!==d)return M(r,0===r.avail_out?h:p);var a=n.last_flush;if(n.last_flush=e,0!==n.pending){if(N(r),0===r.avail_out)return n.last_flush=-1,f}else if(0===r.avail_in&&se(e)<=se(a)&&e!==d)return M(r,h);if(n.status===C&&0!==r.avail_in)return M(r,h);if(n.status===b&&0===n.wrap&&(n.status=O),n.status===b){let e=m+(n.w_bits-8<<4)<<8,t=-1;if(t=n.strategy>=g||n.level<2?0:n.level<6?1:6===n.level?2:3,e|=t<<6,0!==n.strstart&&(e|=32),e+=31-e%31,L(n,e),0!==n.strstart&&(L(n,r.adler>>>16),L(n,65535&r.adler)),r.adler=1,n.status=O,N(r),0!==n.pending)return n.last_flush=-1,f}if(n.status===v)if(r.adler=0,x(n,31),x(n,139),x(n,8),n.gzhead)x(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),x(n,255&n.gzhead.time),x(n,n.gzhead.time>>8&255),x(n,n.gzhead.time>>16&255),x(n,n.gzhead.time>>24&255),x(n,9===n.level?2:n.strategy>=g||n.level<2?4:0),x(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(x(n,255&n.gzhead.extra.length),x(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(r.adler=o(r.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=E;else if(x(n,0),x(n,0),x(n,0),x(n,0),x(n,0),x(n,9===n.level?2:n.strategy>=g||n.level<2?4:0),x(n,3),n.status=O,N(r),0!==n.pending)return n.last_flush=-1,f;if(n.status===E){if(n.gzhead.extra){let e=n.pending,t=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+t>n.pending_buf_size;){var i=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+i),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>e&&(r.adler=o(r.adler,n.pending_buf,n.pending-e,e)),n.gzindex+=i,N(r),0!==n.pending)return n.last_flush=-1,f;e=0,t-=i}a=new Uint8Array(n.gzhead.extra);n.pending_buf.set(a.subarray(n.gzindex,n.gzindex+t),n.pending),n.pending+=t,n.gzhead.hcrc&&n.pending>e&&(r.adler=o(r.adler,n.pending_buf,n.pending-e,e)),n.gzindex=0}n.status=S}if(n.status===S){if(n.gzhead.name){let e=n.pending,t;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>e&&(r.adler=o(r.adler,n.pending_buf,n.pending-e,e)),N(r),0!==n.pending)return n.last_flush=-1,f;e=0}}while(t=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,x(n,t),0!==t);n.gzhead.hcrc&&n.pending>e&&(r.adler=o(r.adler,n.pending_buf,n.pending-e,e)),n.gzindex=0}n.status=A}if(n.status===A){if(n.gzhead.comment){let e=n.pending,t;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>e&&(r.adler=o(r.adler,n.pending_buf,n.pending-e,e)),N(r),0!==n.pending)return n.last_flush=-1,f;e=0}}while(t=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,x(n,t),0!==t);n.gzhead.hcrc&&n.pending>e&&(r.adler=o(r.adler,n.pending_buf,n.pending-e,e))}n.status=oe}if(n.status===oe){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(N(r),0!==n.pending))return n.last_flush=-1,f;x(n,255&r.adler),x(n,r.adler>>8&255),r.adler=0}if(n.status=O,N(r),0!==n.pending)return n.last_flush=-1,f}if(0!==r.avail_in||0!==n.lookahead||e!==u&&n.status!==C){a=0===n.level?de(n,e):n.strategy===g?((e,t)=>{for(var r;;){if(0===e.lookahead&&(F(e),0===e.lookahead)){if(t===u)return k;break}if(e.match_length=0,r=s(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(D(e,!1),0===e.strm.avail_out))return k}return e.insert=0,t===d?(D(e,!0),0===e.strm.avail_out?R:I):e.sym_next&&(D(e,!1),0===e.strm.avail_out)?k:w})(n,e):n.strategy===Z?((e,t)=>{let r;var n;let a,i;for(var o=e.window;;){if(e.lookahead<=y){if(F(e),e.lookahead<=y&&t===u)return k;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=_&&0<e.strstart&&(n=o[a=e.strstart-1])===o[++a]&&n===o[++a]&&n===o[++a]){for(i=e.strstart+y;n===o[++a]&&n===o[++a]&&n===o[++a]&&n===o[++a]&&n===o[++a]&&n===o[++a]&&n===o[++a]&&n===o[++a]&&a<i;);e.match_length=y-(i-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=_?(r=s(e,1,e.match_length-_),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=s(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(D(e,!1),0===e.strm.avail_out))return k}return e.insert=0,t===d?(D(e,!0),0===e.strm.avail_out?R:I):e.sym_next&&(D(e,!1),0===e.strm.avail_out)?k:w})(n,e):U[n.level].func(n,e);if(a!==R&&a!==I||(n.status=C),a===k||a===R)return 0===r.avail_out&&(n.last_flush=-1),f;if(a===w&&(e===W?H(n):e!==$&&(c(n,0,0,!1),e===q)&&(P(n.head),0===n.lookahead)&&(n.strstart=0,n.block_start=0,n.insert=0),N(r),0===r.avail_out))return n.last_flush=-1,f}return e!==d||!(n.wrap<=0)&&(2===n.wrap?(x(n,255&r.adler),x(n,r.adler>>8&255),x(n,r.adler>>16&255),x(n,r.adler>>24&255),x(n,255&r.total_in),x(n,r.total_in>>8&255),x(n,r.total_in>>16&255),x(n,r.total_in>>24&255)):(L(n,r.adler>>>16),L(n,65535&r.adler)),N(r),0<n.wrap&&(n.wrap=-n.wrap),0!==n.pending)?f:z},U0.deflateEnd=e=>{var t;return B(e)?p:(t=e.state.status,e.state=null,t===O?M(e,K):f)},U0.deflateSetDictionary=(e,t)=>{let r=t.length;if(B(e))return p;var n=e.state,a=n.wrap;if(2===a||1===a&&n.status!==b||n.lookahead)return p;1===a&&(e.adler=G(e.adler,t,r,0)),n.wrap=0,r>=n.w_size&&(0===a&&(P(n.head),n.strstart=0,n.block_start=0,n.insert=0),(i=new Uint8Array(n.w_size)).set(t.subarray(r-n.w_size,r),0),t=i,r=n.w_size);var i=e.avail_in,o=e.next_in,s=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,F(n);n.lookahead>=_;){let e=n.strstart,t=n.lookahead-(_-1);for(;n.ins_h=l(n,n.ins_h,n.window[e+_-1]),n.prev[e&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=e,e++,--t;);n.strstart=e,n.lookahead=_-1,F(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=_-1,n.match_available=0,e.next_in=o,e.input=s,e.avail_in=i,n.wrap=a,f},U0.deflateInfo="pako deflate (from Nodeca project)"}return U0}var $0,z0={};function K0(){if(!$0){$0=1;z0.assign=function(e){for(var t,r,n=Array.prototype.slice.call(arguments,1);n.length;){var a=n.shift();if(a){if("object"!=typeof a)throw new TypeError(a+"must be non-object");for(const i in a)t=a,r=i,Object.prototype.hasOwnProperty.call(t,r)&&(e[i]=a[i])}}return e},z0.flattenChunks=n=>{let r=0;for(let e=0,t=n.length;e<t;e++)r+=n[e].length;var a=new Uint8Array(r);for(let e=0,t=0,r=n.length;e<r;e++){var i=n[e];a.set(i,t),t+=i.length}return a}}return z0}var Y0,J0,Z0,Q0,X0={};function e_(){if(!Y0){Y0=1;let c=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){c=!1}const u=new Uint8Array(256);for(let e=0;e<256;e++)u[e]=252<=e?6:248<=e?5:240<=e?4:224<=e?3:192<=e?2:1;u[254]=u[254]=1,X0.string2buf=e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,r,n,a,i,o=e.length,s=0;for(a=0;a<o;a++)55296==(64512&(r=e.charCodeAt(a)))&&a+1<o&&56320==(64512&(n=e.charCodeAt(a+1)))&&(r=65536+(r-55296<<10)+(n-56320),a++),s+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(s),i=0,a=0;i<s;a++)55296==(64512&(r=e.charCodeAt(a)))&&a+1<o&&56320==(64512&(n=e.charCodeAt(a+1)))&&(r=65536+(r-55296<<10)+(n-56320),a++),r<128?t[i++]=r:(r<2048?t[i++]=192|r>>>6:(r<65536?t[i++]=224|r>>>12:(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63),t[i++]=128|r>>>6&63),t[i++]=128|63&r);return t};X0.buf2string=(r,e)=>{var n=e||r.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(r.subarray(0,e));let a,i;var o=new Array(2*n);for(i=0,a=0;a<n;){let t=r[a++];if(t<128)o[i++]=t;else{let e=u[t];if(4<e)o[i++]=65533,a+=e-1;else{for(t&=2===e?31:3===e?15:7;1<e&&a<n;)t=t<<6|63&r[a++],e--;1<e?o[i++]=65533:t<65536?o[i++]=t:(t-=65536,o[i++]=55296|t>>10&1023,o[i++]=56320|1023&t)}}}{var s=o,l=i;if(l<65534&&s.subarray&&c)return String.fromCharCode.apply(null,s.length===l?s:s.subarray(0,l));let t="";for(let e=0;e<l;e++)t+=String.fromCharCode(s[e]);return t}},X0.utf8border=(e,t)=>{let r=(t=(t=t||e.length)>e.length?e.length:t)-1;for(;0<=r&&128==(192&e[r]);)r--;return!(r<0)&&0!==r&&r+u[e[r]]>t?r:t}}return X0}function t_(){return Z0||(Z0=1,J0=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}),J0}function r_(){if(!Q0){Q0=1;const o=q0(),a=K0(),s=e_(),i=V0(),e=t_(),l=Object.prototype.toString,{Z_NO_FLUSH:c,Z_SYNC_FLUSH:u,Z_FULL_FLUSH:d,Z_FINISH:f,Z_OK:p,Z_STREAM_END:h,Z_DEFAULT_COMPRESSION:g,Z_DEFAULT_STRATEGY:m,Z_DEFLATED:_}=W0();function r(t){this.options=a.assign({level:g,method:_,chunkSize:16384,windowBits:15,memLevel:8,strategy:m},t||{});var t=this.options,r=(t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new e,this.strm.avail_out=0,o.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy));if(r!==p)throw new Error(i[r]);if(t.header&&o.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?s.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(r=o.deflateSetDictionary(this.strm,e))!==p)throw new Error(i[r]);this._dict_set=!0}}function n(e,t){t=new r(t);if(t.push(e,!0),t.err)throw t.msg||i[t.err];return t.result}r.prototype.push=function(e,t){var r=this.strm,n=this.options.chunkSize;let a,i;if(this.ended)return!1;for(i=t===~~t?t:!0===t?f:c,"string"==typeof e?r.input=s.string2buf(e):"[object ArrayBuffer]"===l.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;)if(0===r.avail_out&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(i===u||i===d)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if(o.deflate(r,i)===h)return 0<r.next_out&&this.onData(r.output.subarray(0,r.next_out)),a=o.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===p;if(0===r.avail_out)this.onData(r.output);else if(0<i&&0<r.next_out)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(0===r.avail_in)break}return!0},r.prototype.onData=function(e){this.chunks.push(e)},r.prototype.onEnd=function(e){e===p&&(this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},F0.Deflate=r,F0.deflate=n,F0.deflateRaw=function(e,t){return(t=t||{}).raw=!0,n(e,t)},F0.gzip=function(e,t){return(t=t||{}).gzip=!0,n(e,t)},F0.constants=W0()}return F0}var n_,a_,i_,o_,s_,l_,c_,u_,d_,f_={},p_={};function h_(){if(!s_){s_=1;const N=H0(),D=G0(),x=function(){if(!a_){a_=1;const k=16209,w=16191;n_=function(e,t){let r;var n,a,i,o,s,l,c,u,d,f,p,h,g,m,_;let y,T,b,v,E,S,A,O;var C=e.state;r=e.next_in,m=e.input,n=r+(e.avail_in-5),y=e.next_out,_=e.output,a=y-(t-e.avail_out),i=y+(e.avail_out-257),o=C.dmax,s=C.wsize,l=C.whave,c=C.wnext,u=C.window,T=C.hold,b=C.bits,d=C.lencode,f=C.distcode,p=(1<<C.lenbits)-1,h=(1<<C.distbits)-1;e:do{for(b<15&&(T+=m[r++]<<b,b+=8,T+=m[r++]<<b,b+=8),v=d[T&p];;){if(E=v>>>24,T>>>=E,b-=E,0===(E=v>>>16&255))_[y++]=65535&v;else{if(!(16&E)){if(0==(64&E)){v=d[(65535&v)+(T&(1<<E)-1)];continue}if(32&E){C.mode=w;break e}e.msg="invalid literal/length code",C.mode=k;break e}for(S=65535&v,(E&=15)&&(b<E&&(T+=m[r++]<<b,b+=8),S+=T&(1<<E)-1,T>>>=E,b-=E),b<15&&(T+=m[r++]<<b,b+=8,T+=m[r++]<<b,b+=8),v=f[T&h];;){if(E=v>>>24,T>>>=E,b-=E,!(16&(E=v>>>16&255))){if(0==(64&E)){v=f[(65535&v)+(T&(1<<E)-1)];continue}e.msg="invalid distance code",C.mode=k;break e}if(g=65535&v,E&=15,b<E&&(T+=m[r++]<<b,(b+=8)<E)&&(T+=m[r++]<<b,b+=8),o<(g+=T&(1<<E)-1)){e.msg="invalid distance too far back",C.mode=k;break e}if(T>>>=E,b-=E,g>(E=y-a)){if((E=g-E)>l&&C.sane){e.msg="invalid distance too far back",C.mode=k;break e}if(A=0,O=u,0===c){if(A+=s-E,E<S){for(S-=E;_[y++]=u[A++],--E;);A=y-g,O=_}}else if(c<E){if(A+=s+c-E,(E-=c)<S){for(S-=E;_[y++]=u[A++],--E;);if(A=0,c<S){for(E=c,S-=E;_[y++]=u[A++],--E;);A=y-g,O=_}}}else if(A+=c-E,E<S){for(S-=E;_[y++]=u[A++],--E;);A=y-g,O=_}for(;2<S;)_[y++]=O[A++],_[y++]=O[A++],_[y++]=O[A++],S-=3;S&&(_[y++]=O[A++],1<S)&&(_[y++]=O[A++])}else{for(A=y-g;_[y++]=_[A++],_[y++]=_[A++],_[y++]=_[A++],2<(S-=3););S&&(_[y++]=_[A++],1<S)&&(_[y++]=_[A++])}break}}break}}while(r<n&&y<i);S=b>>3,r-=S,b-=S<<3,T&=(1<<b)-1,e.next_in=r,e.next_out=y,e.avail_in=r<n?n-r+5:5-(r-n),e.avail_out=y<i?i-y+257:257-(y-i),C.hold=T,C.bits=b}}return n_}(),L=function(){if(!o_){o_=1;const P=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),N=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),D=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),x=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);i_=(e,t,r,n,a,i,o,s)=>{var l,c=s.bits;let u=0,d=0,f=0,p=0,h=0,g=0,m=0,_=0,y=0,T=0,b,v,E,S,A=null,O;var C=new Uint16Array(16),k=new Uint16Array(16);let w=null,R,I,M;for(u=0;u<=15;u++)C[u]=0;for(d=0;d<n;d++)C[t[r+d]]++;for(h=c,p=15;1<=p&&0===C[p];p--);if(h>p&&(h=p),0===p)a[i++]=20971520,a[i++]=20971520,s.bits=1;else{for(f=1;f<p&&0===C[f];f++);for(h<f&&(h=f),_=1,u=1;u<=15;u++)if((_=(_<<=1)-C[u])<0)return-1;if(0<_&&(0===e||1!==p))return-1;for(k[1]=0,u=1;u<15;u++)k[u+1]=k[u]+C[u];for(d=0;d<n;d++)0!==t[r+d]&&(o[k[t[r+d]]++]=d);if(O=0===e?(A=w=o,20):1===e?(A=P,w=N,257):(A=D,w=x,0),T=0,d=0,u=f,S=i,g=h,m=0,E=-1,l=(y=1<<h)-1,1===e&&852<y||2===e&&592<y)return 1;for(;;){for(R=u-m,M=o[d]+1<O?(I=0,o[d]):o[d]>=O?(I=w[o[d]-O],A[o[d]-O]):(I=96,0),b=1<<u-m,v=1<<g,f=v;v-=b,a[S+(T>>m)+v]=R<<24|I<<16|M|0,0!==v;);for(b=1<<u-1;T&b;)b>>=1;if(T=0!==b?(T&=b-1)+b:0,d++,0==--C[u]){if(u===p)break;u=t[r+o[d]]}if(u>h&&(T&l)!==E){for(0===m&&(m=h),S+=f,g=u-m,_=1<<g;g+m<p&&!((_-=C[g+m])<=0);)g++,_<<=1;if(y+=1<<g,1===e&&852<y||2===e&&592<y)return 1;a[E=T&l]=h<<24|g<<16|S-i|0}}0!==T&&(a[S+T]=u-m<<24|64<<16|0),s.bits=h}return 0}}return i_}(),F=1,U=2,{Z_FINISH:B,Z_BLOCK:j,Z_TREES:H,Z_OK:G,Z_STREAM_END:V,Z_NEED_DICT:W,Z_STREAM_ERROR:q,Z_DATA_ERROR:$,Z_MEM_ERROR:z,Z_BUF_ERROR:K,Z_DEFLATED:Y}=W0(),J=16180,Z=16191,Q=16209,X=16211,r=852,a=592;const ee=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24),te=e=>{var t;return!e||!(t=e.state)||t.strm!==e||t.mode<J||t.mode>X?1:0},i=e=>{var t;return te(e)?q:(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=J,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(r),t.distcode=t.distdyn=new Int32Array(a),t.sane=1,t.back=-1,G)},o=e=>{var t;return te(e)?q:((t=e.state).wsize=0,t.whave=0,t.wnext=0,i(e))},s=(e,t)=>{let r;var n;return te(e)||(n=e.state,t<0?(r=0,t=-t):(r=5+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t))?q:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,o(e))},t=(e,t)=>{var r;return e?(r=new n,(e.state=r).strm=e,r.window=null,r.mode=J,(r=s(e,t))!==G&&(e.state=null),r):q};let I=!0,M,P;const re=(e,t,r,n)=>{let a;e=e.state;return null===e.window&&(e.wsize=1<<e.wbits,e.wnext=0,e.whave=0,e.window=new Uint8Array(e.wsize)),n>=e.wsize?(e.window.set(t.subarray(r-e.wsize,r),0),e.wnext=0,e.whave=e.wsize):((a=e.wsize-e.wnext)>n&&(a=n),e.window.set(t.subarray(r-n,r-n+a),e.wnext),(n-=a)?(e.window.set(t.subarray(r-n,r),0),e.wnext=n,e.whave=e.wsize):(e.wnext+=a,e.wnext===e.wsize&&(e.wnext=0),e.whave<e.wsize&&(e.whave+=a))),0};function n(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}p_.inflateReset=o,p_.inflateReset2=s,p_.inflateResetKeep=i,p_.inflateInit=e=>t(e,15),p_.inflateInit2=t,p_.inflate=(e,t)=>{var r;let n,a,i,o,s,l,c,u,d,f,p,h,g,m=0,_,y,T,b,v,E,S,A;var O=new Uint8Array(4);let C,k;var w=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(te(e)||!e.output||!e.input&&0!==e.avail_in)return q;(r=e.state).mode===Z&&(r.mode=16192),o=e.next_out,a=e.output,l=e.avail_out,i=e.next_in,n=e.input,s=e.avail_in,c=r.hold,u=r.bits,d=s,f=l,A=G;e:for(;;)switch(r.mode){case J:if(0===r.wrap)r.mode=16192;else{for(;u<16;){if(0===s)break e;s--,c+=n[i++]<<u,u+=8}2&r.wrap&&35615===c?(0===r.wbits&&(r.wbits=15),O[r.check=0]=255&c,O[1]=c>>>8&255,r.check=D(r.check,O,2,0),c=0,u=0,r.mode=16181):(r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&c)<<8)+(c>>8))%31?(e.msg="incorrect header check",r.mode=Q):(15&c)!==Y?(e.msg="unknown compression method",r.mode=Q):(c>>>=4,u-=4,S=8+(15&c),0===r.wbits&&(r.wbits=S),15<S||S>r.wbits?(e.msg="invalid window size",r.mode=Q):(r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=512&c?16189:Z,c=0,u=0)))}break;case 16181:for(;u<16;){if(0===s)break e;s--,c+=n[i++]<<u,u+=8}if(r.flags=c,(255&r.flags)!==Y){e.msg="unknown compression method",r.mode=Q;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=Q;break}r.head&&(r.head.text=c>>8&1),512&r.flags&&4&r.wrap&&(O[0]=255&c,O[1]=c>>>8&255,r.check=D(r.check,O,2,0)),c=0,u=0,r.mode=16182;case 16182:for(;u<32;){if(0===s)break e;s--,c+=n[i++]<<u,u+=8}r.head&&(r.head.time=c),512&r.flags&&4&r.wrap&&(O[0]=255&c,O[1]=c>>>8&255,O[2]=c>>>16&255,O[3]=c>>>24&255,r.check=D(r.check,O,4,0)),c=0,u=0,r.mode=16183;case 16183:for(;u<16;){if(0===s)break e;s--,c+=n[i++]<<u,u+=8}r.head&&(r.head.xflags=255&c,r.head.os=c>>8),512&r.flags&&4&r.wrap&&(O[0]=255&c,O[1]=c>>>8&255,r.check=D(r.check,O,2,0)),c=0,u=0,r.mode=16184;case 16184:if(1024&r.flags){for(;u<16;){if(0===s)break e;s--,c+=n[i++]<<u,u+=8}r.length=c,r.head&&(r.head.extra_len=c),512&r.flags&&4&r.wrap&&(O[0]=255&c,O[1]=c>>>8&255,r.check=D(r.check,O,2,0)),c=0,u=0}else r.head&&(r.head.extra=null);r.mode=16185;case 16185:if(1024&r.flags&&((p=(p=r.length)>s?s:p)&&(r.head&&(S=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(i,i+p),S)),512&r.flags&&4&r.wrap&&(r.check=D(r.check,n,p,i)),s-=p,i+=p,r.length-=p),r.length))break e;r.length=0,r.mode=16186;case 16186:if(2048&r.flags){if(0===s)break e;for(p=0;S=n[i+p++],r.head&&S&&r.length<65536&&(r.head.name+=String.fromCharCode(S)),S&&p<s;);if(512&r.flags&&4&r.wrap&&(r.check=D(r.check,n,p,i)),s-=p,i+=p,S)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=16187;case 16187:if(4096&r.flags){if(0===s)break e;for(p=0;S=n[i+p++],r.head&&S&&r.length<65536&&(r.head.comment+=String.fromCharCode(S)),S&&p<s;);if(512&r.flags&&4&r.wrap&&(r.check=D(r.check,n,p,i)),s-=p,i+=p,S)break e}else r.head&&(r.head.comment=null);r.mode=16188;case 16188:if(512&r.flags){for(;u<16;){if(0===s)break e;s--,c+=n[i++]<<u,u+=8}if(4&r.wrap&&c!==(65535&r.check)){e.msg="header crc mismatch",r.mode=Q;break}c=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=Z;break;case 16189:for(;u<32;){if(0===s)break e;s--,c+=n[i++]<<u,u+=8}e.adler=r.check=ee(c),c=0,u=0,r.mode=16190;case 16190:if(0===r.havedict)return e.next_out=o,e.avail_out=l,e.next_in=i,e.avail_in=s,r.hold=c,r.bits=u,W;e.adler=r.check=1,r.mode=Z;case Z:if(t===j||t===H)break e;case 16192:if(r.last)c>>>=7&u,u-=7&u,r.mode=16206;else{for(;u<3;){if(0===s)break e;s--,c+=n[i++]<<u,u+=8}switch(r.last=1&c,c>>>=1,--u,3&c){case 0:r.mode=16193;break;case 1:var R=r;if(I){M=new Int32Array(512),P=new Int32Array(32);let e=0;for(;e<144;)R.lens[e++]=8;for(;e<256;)R.lens[e++]=9;for(;e<280;)R.lens[e++]=7;for(;e<288;)R.lens[e++]=8;for(L(F,R.lens,0,288,M,0,R.work,{bits:9}),e=0;e<32;)R.lens[e++]=5;L(U,R.lens,0,32,P,0,R.work,{bits:5}),I=!1}if(R.lencode=M,R.lenbits=9,R.distcode=P,R.distbits=5,r.mode=16199,t!==H)break;c>>>=2,u-=2;break e;case 2:r.mode=16196;break;case 3:e.msg="invalid block type",r.mode=Q}c>>>=2,u-=2}break;case 16193:for(c>>>=7&u,u-=7&u;u<32;){if(0===s)break e;s--,c+=n[i++]<<u,u+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Q;break}if(r.length=65535&c,c=0,u=0,r.mode=16194,t===H)break e;case 16194:r.mode=16195;case 16195:if(p=r.length){if(0===(p=(p=p>s?s:p)>l?l:p))break e;a.set(n.subarray(i,i+p),o),s-=p,i+=p,l-=p,o+=p,r.length-=p}else r.mode=Z;break;case 16196:for(;u<14;){if(0===s)break e;s--,c+=n[i++]<<u,u+=8}if(r.nlen=257+(31&c),c>>>=5,u-=5,r.ndist=1+(31&c),c>>>=5,u-=5,r.ncode=4+(15&c),c>>>=4,u-=4,286<r.nlen||30<r.ndist){e.msg="too many length or distance symbols",r.mode=Q;break}r.have=0,r.mode=16197;case 16197:for(;r.have<r.ncode;){for(;u<3;){if(0===s)break e;s--,c+=n[i++]<<u,u+=8}r.lens[w[r.have++]]=7&c,c>>>=3,u-=3}for(;r.have<19;)r.lens[w[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,C={bits:r.lenbits},A=L(0,r.lens,0,19,r.lencode,0,r.work,C),r.lenbits=C.bits,A){e.msg="invalid code lengths set",r.mode=Q;break}r.have=0,r.mode=16198;case 16198:for(;r.have<r.nlen+r.ndist;){for(;m=r.lencode[c&(1<<r.lenbits)-1],_=m>>>24,y=m>>>16&255,T=65535&m,!(_<=u);){if(0===s)break e;s--,c+=n[i++]<<u,u+=8}if(T<16)c>>>=_,u-=_,r.lens[r.have++]=T;else{if(16===T){for(k=_+2;u<k;){if(0===s)break e;s--,c+=n[i++]<<u,u+=8}if(c>>>=_,u-=_,0===r.have){e.msg="invalid bit length repeat",r.mode=Q;break}S=r.lens[r.have-1],p=3+(3&c),c>>>=2,u-=2}else if(17===T){for(k=_+3;u<k;){if(0===s)break e;s--,c+=n[i++]<<u,u+=8}c>>>=_,u-=_,S=0,p=3+(7&c),c>>>=3,u-=3}else{for(k=_+7;u<k;){if(0===s)break e;s--,c+=n[i++]<<u,u+=8}c>>>=_,u-=_,S=0,p=11+(127&c),c>>>=7,u-=7}if(r.have+p>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Q;break}for(;p--;)r.lens[r.have++]=S}}if(r.mode===Q)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=Q;break}if(r.lenbits=9,C={bits:r.lenbits},A=L(F,r.lens,0,r.nlen,r.lencode,0,r.work,C),r.lenbits=C.bits,A){e.msg="invalid literal/lengths set",r.mode=Q;break}if(r.distbits=6,r.distcode=r.distdyn,C={bits:r.distbits},A=L(U,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,C),r.distbits=C.bits,A){e.msg="invalid distances set",r.mode=Q;break}if(r.mode=16199,t===H)break e;case 16199:r.mode=16200;case 16200:if(6<=s&&258<=l){e.next_out=o,e.avail_out=l,e.next_in=i,e.avail_in=s,r.hold=c,r.bits=u,x(e,f),o=e.next_out,a=e.output,l=e.avail_out,i=e.next_in,n=e.input,s=e.avail_in,c=r.hold,u=r.bits,r.mode===Z&&(r.back=-1);break}for(r.back=0;m=r.lencode[c&(1<<r.lenbits)-1],_=m>>>24,y=m>>>16&255,T=65535&m,!(_<=u);){if(0===s)break e;s--,c+=n[i++]<<u,u+=8}if(y&&0==(240&y)){for(b=_,v=y,E=T;m=r.lencode[E+((c&(1<<b+v)-1)>>b)],_=m>>>24,y=m>>>16&255,T=65535&m,!(b+_<=u);){if(0===s)break e;s--,c+=n[i++]<<u,u+=8}c>>>=b,u-=b,r.back+=b}if(c>>>=_,u-=_,r.back+=_,r.length=T,0===y){r.mode=16205;break}if(32&y){r.back=-1,r.mode=Z;break}if(64&y){e.msg="invalid literal/length code",r.mode=Q;break}r.extra=15&y,r.mode=16201;case 16201:if(r.extra){for(k=r.extra;u<k;){if(0===s)break e;s--,c+=n[i++]<<u,u+=8}r.length+=c&(1<<r.extra)-1,c>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=16202;case 16202:for(;m=r.distcode[c&(1<<r.distbits)-1],_=m>>>24,y=m>>>16&255,T=65535&m,!(_<=u);){if(0===s)break e;s--,c+=n[i++]<<u,u+=8}if(0==(240&y)){for(b=_,v=y,E=T;m=r.distcode[E+((c&(1<<b+v)-1)>>b)],_=m>>>24,y=m>>>16&255,T=65535&m,!(b+_<=u);){if(0===s)break e;s--,c+=n[i++]<<u,u+=8}c>>>=b,u-=b,r.back+=b}if(c>>>=_,u-=_,r.back+=_,64&y){e.msg="invalid distance code",r.mode=Q;break}r.offset=T,r.extra=15&y,r.mode=16203;case 16203:if(r.extra){for(k=r.extra;u<k;){if(0===s)break e;s--,c+=n[i++]<<u,u+=8}r.offset+=c&(1<<r.extra)-1,c>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Q;break}r.mode=16204;case 16204:if(0===l)break e;if(p=f-l,r.offset>p){if((p=r.offset-p)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Q;break}h=p>r.wnext?(p-=r.wnext,r.wsize-p):r.wnext-p,p>r.length&&(p=r.length),g=r.window}else g=a,h=o-r.offset,p=r.length;for(p>l&&(p=l),l-=p,r.length-=p;a[o++]=g[h++],--p;);0===r.length&&(r.mode=16200);break;case 16205:if(0===l)break e;a[o++]=r.length,l--,r.mode=16200;break;case 16206:if(r.wrap){for(;u<32;){if(0===s)break e;s--,c|=n[i++]<<u,u+=8}if(f-=l,e.total_out+=f,r.total+=f,4&r.wrap&&f&&(e.adler=r.check=(r.flags?D:N)(r.check,a,f,o-f)),f=l,4&r.wrap&&(r.flags?c:ee(c))!==r.check){e.msg="incorrect data check",r.mode=Q;break}c=0,u=0}r.mode=16207;case 16207:if(r.wrap&&r.flags){for(;u<32;){if(0===s)break e;s--,c+=n[i++]<<u,u+=8}if(4&r.wrap&&c!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=Q;break}c=0,u=0}r.mode=16208;case 16208:A=V;break e;case Q:A=$;break e;case 16210:return z;default:X;return q}return e.next_out=o,e.avail_out=l,e.next_in=i,e.avail_in=s,r.hold=c,r.bits=u,(r.wsize||f!==e.avail_out&&r.mode<Q&&(r.mode<16206||t!==B))&&re(e,e.output,e.next_out,f-e.avail_out),d-=e.avail_in,f-=e.avail_out,e.total_in+=d,e.total_out+=f,r.total+=f,4&r.wrap&&f&&(e.adler=r.check=(r.flags?D:N)(r.check,a,f,e.next_out-f)),e.data_type=r.bits+(r.last?64:0)+(r.mode===Z?128:0)+(16199===r.mode||16194===r.mode?256:0),A=(0==d&&0===f||t===B)&&A===G?K:A},p_.inflateEnd=e=>{var t;return te(e)?q:((t=e.state).window&&(t.window=null),e.state=null,G)},p_.inflateGetHeader=(e,t)=>{return te(e)||0==(2&(e=e.state).wrap)?q:((e.head=t).done=!1,G)},p_.inflateSetDictionary=(e,t)=>{var r,n=t.length;return te(e)||0!==(r=e.state).wrap&&16190!==r.mode?q:16190===r.mode&&N(1,t,n,0)!==r.check?$:re(e,t,n,n)?(r.mode=16210,z):(r.havedict=1,G)},p_.inflateInfo="pako inflate (from Nodeca project)"}return p_}function g_(){if(!u_){u_=1;const d=h_(),a=K0(),f=e_(),i=V0(),o=t_(),s=(c_||(c_=1,l_=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}),l_),p=Object.prototype.toString,{Z_NO_FLUSH:h,Z_FINISH:g,Z_OK:m,Z_STREAM_END:_,Z_NEED_DICT:y,Z_STREAM_ERROR:T,Z_DATA_ERROR:b,Z_MEM_ERROR:v}=W0();function r(e){this.options=a.assign({chunkSize:65536,windowBits:15,to:""},e||{});var t=this.options,e=(t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits)&&(t.windowBits=-15),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0,d.inflateInit2(this.strm,t.windowBits));if(e!==m)throw new Error(i[e]);if(this.header=new s,d.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=f.string2buf(t.dictionary):"[object ArrayBuffer]"===p.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw)&&(e=d.inflateSetDictionary(this.strm,t.dictionary))!==m)throw new Error(i[e])}function n(e,t){t=new r(t);if(t.push(e),t.err)throw t.msg||i[t.err];return t.result}r.prototype.push=function(e,t){var r,n,a,i=this.strm,o=this.options.chunkSize,s=this.options.dictionary;let l,c,u;if(this.ended)return!1;for(c=t===~~t?t:!0===t?g:h,"[object ArrayBuffer]"===p.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;){for(0===i.avail_out&&(i.output=new Uint8Array(o),i.next_out=0,i.avail_out=o),(l=d.inflate(i,c))===y&&s&&((l=d.inflateSetDictionary(i,s))===m?l=d.inflate(i,c):l===b&&(l=y));0<i.avail_in&&l===_&&0<i.state.wrap&&0!==e[i.next_in];)d.inflateReset(i),l=d.inflate(i,c);switch(l){case T:case b:case y:case v:return this.onEnd(l),!(this.ended=!0)}if(u=i.avail_out,!i.next_out||0!==i.avail_out&&l!==_||("string"===this.options.to?(r=f.utf8border(i.output,i.next_out),n=i.next_out-r,a=f.buf2string(i.output,r),i.next_out=n,i.avail_out=o-n,n&&i.output.set(i.output.subarray(r,r+n),0),this.onData(a)):this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out))),l!==m||0!==u){if(l===_)return l=d.inflateEnd(this.strm),this.onEnd(l),this.ended=!0;if(0===i.avail_in)break}}return!0},r.prototype.onData=function(e){this.chunks.push(e)},r.prototype.onEnd=function(e){e===m&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},f_.Inflate=r,f_.inflate=n,f_.inflateRaw=function(e,t){return(t=t||{}).raw=!0,n(e,t)},f_.ungzip=n,f_.constants=W0()}return f_}var m_,__={},y_={},T_={};function b_(){var i;return m_||(m_=1,i=T_,Object.defineProperty(i,"__esModule",{value:!0}),i.PARSING_UNRECOGNIZED_MESSAGE=i.PARSING_UNRECOGNIZED_PORT=i.PARSING_UNABLE_TO_DECODE_METHOD=i.PARSING_UNKNWON_REQUEST_ID=i.RECORDING_IN_PROGRESS=i.BUFFER_USAGE_INCORRECT_FORMAT=i.BUFFER_USAGE_NOT_ACCESSIBLE=i.MALFORMED_EXTENSION_MESSAGE=i.EXTENSION_NOT_INSTALLED=i.EXTENSION_NAME=i.EXTENSION_URL=i.EXTENSION_ID=i.ADB_DEVICE_FILTER=i.NO_DEVICE_SELECTED=i.CUSTOM_TRACED_CONSUMER_SOCKET_PATH=i.DEFAULT_TRACED_CONSUMER_SOCKET_PATH=i.ALLOW_USB_DEBUGGING=i.TRACEBOX_FETCH_TIMEOUT=i.TRACEBOX_DEVICE_PATH=i.BINARY_PUSH_UNKNOWN_RESPONSE=i.BINARY_PUSH_FAILURE=i.WEBSOCKET_CLOSED_ABNORMALLY_CODE=i.WEBSOCKET_UNABLE_TO_CONNECT=i.RECORDING_MODAL_DIALOG_KEY=void 0,i.buildAbdWebsocketCommand=function(e){var t=e.length.toString(16).padStart(4,"0");return t+e},i.isMacOs=function(e){return e.toLowerCase().includes(" mac os ")},i.isLinux=function(e){return e.toLowerCase().includes(" linux ")},i.isWindows=function(e){return e.toLowerCase().includes("windows ")},i.isCrOS=function(e){return e.toLowerCase().includes(" cros ")},i.findInterfaceAndEndpoint=function(e){var t=i.ADB_DEVICE_FILTER;for(const r of e.configurations)for(const n of r.interfaces)for(const a of n.alternates)if(a.interfaceClass===t.classCode&&a.interfaceSubclass===t.subclassCode&&a.interfaceProtocol===t.protocolCode)return{configurationValue:r.configurationValue,usbInterfaceNumber:n.interfaceNumber,endpoints:a.endpoints};return},i.RECORDING_MODAL_DIALOG_KEY="recording_target",i.WEBSOCKET_UNABLE_TO_CONNECT="Unable to connect to device via websocket.",i.WEBSOCKET_CLOSED_ABNORMALLY_CODE=1006,i.BINARY_PUSH_FAILURE="BinaryPushFailure",i.BINARY_PUSH_UNKNOWN_RESPONSE="BinaryPushUnknownResponse",i.TRACEBOX_DEVICE_PATH="/data/local/tmp/tracebox",i.TRACEBOX_FETCH_TIMEOUT=3e4,i.ALLOW_USB_DEBUGGING="Please allow USB debugging on device and try again.",i.DEFAULT_TRACED_CONSUMER_SOCKET_PATH="localfilesystem:/dev/socket/traced_consumer",i.CUSTOM_TRACED_CONSUMER_SOCKET_PATH="localabstract:traced_consumer",i.NO_DEVICE_SELECTED="No device selected.",i.ADB_DEVICE_FILTER={classCode:255,subclassCode:66,protocolCode:1},i.EXTENSION_ID="lfmkphfpdbjijhpomgecfikhfohaoine",i.EXTENSION_URL="https://chrome.google.com/webstore/detail/perfetto-ui/"+i.EXTENSION_ID,i.EXTENSION_NAME="Chrome extension",i.EXTENSION_NOT_INSTALLED=`To trace Chrome from the Perfetto UI, you need to install our
    ${i.EXTENSION_URL} and then reload this page.`,i.MALFORMED_EXTENSION_MESSAGE="Malformed extension message.",i.BUFFER_USAGE_NOT_ACCESSIBLE="Buffer usage not accessible",i.BUFFER_USAGE_INCORRECT_FORMAT="The buffer usage data has am incorrect format",i.RECORDING_IN_PROGRESS="Recording in progress",i.PARSING_UNKNWON_REQUEST_ID="Unknown request id",i.PARSING_UNABLE_TO_DECODE_METHOD="Unable to decode method",i.PARSING_UNRECOGNIZED_PORT="Unrecognized consumer port response",i.PARSING_UNRECOGNIZED_MESSAGE="Unrecognized frame message"),T_}var v_,E_,S_,A_,O_,C_,k_={},w_={};function R_(){if(!v_){v_=1,Object.defineProperty(w_,"__esModule",{value:!0}),w_.TraceHttpStream=w_.TraceBufferStream=w_.TraceFileStream=void 0;const t=Wa(),r=ee(),l=z();w_.TraceFileStream=class{traceFile;reader;pendingRead;bytesRead=0;constructor(e){this.traceFile=e,this.reader=new FileReader,this.reader.onloadend=()=>this.onLoad()}onLoad(){var e,t=(0,r.assertExists)(this.pendingRead);this.pendingRead=void 0,this.reader.error?t.reject(this.reader.error):(e=(0,r.assertExists)(this.reader.result),this.bytesRead+=e.byteLength,t.resolve({data:new Uint8Array(e),eof:this.bytesRead>=this.traceFile.size,bytesRead:this.bytesRead,bytesTotal:this.traceFile.size}))}readChunk(){var e=Math.min(this.bytesRead+33554432,this.traceFile.size),e=this.traceFile.slice(this.bytesRead,e);return this.pendingRead=(0,t.defer)(),this.reader.readAsArrayBuffer(e),this.pendingRead}};w_.TraceBufferStream=class{traceBuf;bytesRead=0;constructor(e){this.traceBuf=e}readChunk(){(0,r.assertTrue)(this.bytesRead<=this.traceBuf.byteLength);var e=Math.min(33554432,this.traceBuf.byteLength-this.bytesRead),t=new Uint8Array(this.traceBuf,this.bytesRead,e);return this.bytesRead+=e,Promise.resolve({data:t,eof:this.bytesRead>=this.traceBuf.byteLength,bytesRead:this.bytesRead,bytesTotal:this.traceBuf.byteLength})}};w_.TraceHttpStream=class{bytesRead=0;bytesTotal=0;uri;httpStream;constructor(e){(0,r.assertTrue)(e.startsWith("http://")||e.startsWith("https://")),this.uri=e}async readChunk(){if(void 0===this.httpStream){var e=await fetch(this.uri);if(200!==e.status)throw new Error(`HTTP ${e.status} - `+e.statusText);var t=e.headers.get("Content-Length");this.bytesTotal=(0,l.exists)(t)?Number.parseInt(t,10):0,this.httpStream=e.body.getReader()}let r=!1,n=0;for(var a=[];!r&&n<33554432;){var i=await this.httpStream.read();i.value&&(a.push(i.value),n+=i.value.length),r=i.done}let o;if(1===a.length)o=a[0];else{o=new Uint8Array(n);let e=0;for(const s of a)o.set(s,e),e+=s.length}return this.bytesRead+=o.length,{data:o,eof:r,bytesRead:this.bytesRead,bytesTotal:this.bytesTotal}}}}return w_}function I_(){if(!E_){E_=1;{var n=k_;Object.defineProperty(n,"__esModule",{value:!0}),n.GcsUploader=n.MIME_BINARY=n.MIME_JSON=n.BUCKET_NAME=void 0;var e=Wa();const r=K(),s=R_();n.BUCKET_NAME="perfetto-ui-data",n.MIME_JSON="application/json; charset=utf-8",n.MIME_BINARY="application/octet-stream";async function i(e){let t;return t="string"==typeof e?(new TextEncoder).encode(e):e,o(await crypto.subtle.digest("SHA-1",t))}function o(e){return Array.from(new Uint8Array(e)).map(e=>e.toString(16).padStart(2,"0")).join("")}n.GcsUploader=class{state="UPLOADING";error="";totalSize=0;uploadedSize=0;uploadedUrl="";uploadedFileName="";args;onProgress;req;donePromise=(0,e.defer)();startTime=performance.now();constructor(e,t){this.args=t,this.onProgress=t.onProgress??(e=>{}),this.req=new XMLHttpRequest,this.start(e)}async start(e){let t=this.args.fileName;var r;void 0===t&&(t=e instanceof Blob?await async function(e){var t=new s.TraceFileStream(e);let r="";for(;;){var n=await t.readChunk(),a=await crypto.subtle.digest("SHA-1",n.data);if(r+=o(a),n.eof)break}return i(r)}(e):await i(e)),this.uploadedFileName=t,this.uploadedUrl=`https://storage.googleapis.com/${n.BUCKET_NAME}/`+t,200===(await fetch(`https://www.googleapis.com/storage/v1/b/${n.BUCKET_NAME}/o/`+t)).status?(console.log(`Skipping upload of ${this.uploadedUrl} because it exists already`),this.state="UPLOADED",this.donePromise.resolve()):(r="https://www.googleapis.com/upload/storage/v1/b/"+n.BUCKET_NAME+"/o?uploadType=media"+`&name=${t}&predefinedAcl=publicRead`,this.req.onabort=e=>this.onRpcEvent(e),this.req.onerror=e=>this.onRpcEvent(e),this.req.upload.onprogress=e=>this.onRpcEvent(e),this.req.onloadend=e=>this.onRpcEvent(e),this.req.open("POST",r,!0),r=this.args.mimeType??n.MIME_BINARY,this.req.setRequestHeader("Content-Type",r),this.req.send(e))}waitForCompletion(){return this.donePromise}abort(){"UPLOADING"===this.state&&this.req.abort()}getEtaString(){var e=Math.ceil(100*this.uploadedSize/this.totalSize)+"%",t=(e+=` (${(this.uploadedSize/1e6).toFixed(2)} MB)`,(performance.now()-this.startTime)/1e3),t=this.uploadedSize/t,t=Math.round((this.totalSize-this.uploadedSize)/t);return e+=" - ETA: "+r.Time.toTimecode(r.Time.fromSeconds(t)).dhhmmss}onRpcEvent(e){let t=!1;switch(e.type){case"progress":this.uploadedSize=e.loaded,this.totalSize=e.total;break;case"abort":this.state="ERROR",this.error="Upload aborted";break;case"error":this.state="ERROR",this.error=this.req.status+" - "+this.req.statusText;break;case"loadend":t=!0,200===this.req.status?this.state="UPLOADED":"UPLOADING"===this.state&&(this.state="ERROR",this.error=this.req.status+" - "+this.req.statusText);break;default:return}this.onProgress(this),t&&this.donePromise.resolve()}}}}return k_}function M_(){if(S_)return y_;S_=1,Object.defineProperty(y_,"__esModule",{value:!0}),y_.maybeShowErrorDialog=function(e){var t=performance.now();if(e.message.includes("Cannot enlarge memory")||e.stack.some(e=>e.name.includes("OutOfMemoryHandler"))||e.stack.some(e=>e.name.includes("_emscripten_resize_heap"))||e.stack.some(e=>e.name.includes("sbrk"))||/^out of memory$/m.exec(e.message)){var r="https://perfetto.dev/docs/quickstart/trace-analysis#get-trace-processor";(0,s.showModal)({title:"Oops! Your WASM trace processor ran out of memory",content:(0,i.default)("div",(0,i.default)("span","The in-memory representation of the trace is too big for the browser memory limits (typically 2GB per tab)."),(0,i.default)("br"),(0,i.default)("span","You can work around this problem by using the trace_processor native binary as an accelerator for the UI as follows:"),(0,i.default)("br"),(0,i.default)("br"),(0,i.default)(".modal-bash","curl -LO https://get.perfetto.dev/trace_processor\nchmod +x ./trace_processor\ntrace_processor --httpd /path/to/trace.pftrace\n# Reload the UI, it will prompt to use the HTTP+RPC interface"),(0,i.default)("br"),(0,i.default)("span","For details see "),(0,i.default)("a",{href:r,target:"_blank"},r))}),d=t}else{if(!n.RECORDING_V2_FLAG.get()){if(e.message.includes("Unable to claim interface"))return(0,s.showModal)({title:"A WebUSB error occurred",content:(0,i.default)("div",(0,i.default)("span",`Is adb already running on the host? Run this command and
      try again.`),(0,i.default)("br"),(0,i.default)(".modal-bash","> adb kill-server"),(0,i.default)("br"),(0,i.default)("span","For details see "),(0,i.default)("a",{href:"http://b/159048331",target:"_blank"},"b/159048331"))}),void(d=t);if(e.message.includes("A transfer error has occurred")||e.message.includes("The device was disconnected")||e.message.includes("The transfer was cancelled"))return p(),void(d=t)}e.message.includes("(ERR:fmt)")?(0,s.showModal)({title:"Cannot open this file",content:(0,i.default)("div",(0,i.default)("p","The file opened doesn't look like a Perfetto trace or any other format recognized by the Perfetto TraceProcessor."),(0,i.default)("p","Formats supported:"),(0,i.default)("ul",(0,i.default)("li","Perfetto protobuf trace"),(0,i.default)("li","chrome://tracing JSON"),(0,i.default)("li","Android systrace"),(0,i.default)("li","Fuchsia trace"),(0,i.default)("li","Ninja build log")))}):e.message.includes("(ERR:rpc_seq)")?(0,s.showModal)({title:"A TraceProcessor RPC error occurred",content:(0,i.default)("div",(0,i.default)("p","The trace processor RPC sequence ID was broken"),(0,i.default)("p",`This can happen when using a HTTP trace processor instance and
either accidentally sharing this between multiple tabs or
restarting the trace processor while still in use by UI.`),(0,i.default)("p",`Please refresh this tab and ensure that trace processor is used
at most one tab at a time.`))}):e.message.includes("State hash does not match")?(0,s.showModal)({title:"Cannot deserialize the permalink",content:(0,i.default)("div",(0,i.default)("p","The state hash doesn't match."),(0,i.default)("p","This usually happens when the permalink is generated by a version the UI that is newer than the current version, e.g., when a colleague created the permalink using the Canary or Autopush channel and you are trying to open it using Stable channel."),(0,i.default)("p","Try switching to Canary or Autopush channel from the Flags page  and try again.")),buttons:[{text:"Take me to the flags page",primary:!0,action:()=>l.Router.navigate("#!/flags/releaseChannel")}]}):0<d&&t-d<=u?console.log("Suppressing crash dialog, last error notified too soon."):(d=t,(0,s.getCurrentModalKey)()!==c&&(0,s.showModal)({key:c,title:"Oops, something went wrong. Please file a bug.",content:()=>(0,i.default)(f,e)}))}},y_.showWebUSBErrorV2=function(){(0,s.showModal)({title:"A WebUSB error occurred",content:(0,i.default)("div",(0,i.default)("span",`Is adb already running on the host? Run this command and
      try again.`),(0,i.default)("br"),(0,i.default)(".modal-bash","> adb kill-server"),(0,i.default)("br"),(0,i.default)("span","If after running 'adb kill-server', you don't see a 'Start Recording' button on the page and you don't see 'Allow USB debugging' on the device, you will need to reload this page."),(0,i.default)("br"),(0,i.default)("br"),(0,i.default)("span","For details see "),(0,i.default)("a",{href:"http://b/159048331",target:"_blank"},"b/159048331"))})},y_.showConnectionLostError=p,y_.showAllowUSBDebugging=function(){(0,s.showModal)({title:"Could not connect to the device",content:(0,i.default)("div",(0,i.default)("span","Please allow USB debugging on the device."),(0,i.default)("br"))})},y_.showNoDeviceSelected=function(){(0,s.showModal)({title:"No device was selected for recording",content:(0,i.default)("div",(0,i.default)("span",`If you want to connect to an ADB device,
           please select it from the list.`),(0,i.default)("br"))})},y_.showExtensionNotInstalled=function(){(0,s.showModal)({title:"Perfetto Chrome extension not installed",content:(0,i.default)("div",(0,i.default)(".note","To trace Chrome from the Perfetto UI, you need to install our ",(0,i.default)("a",{href:e.EXTENSION_URL,target:"_blank"},"Chrome extension")," and then reload this page."),(0,i.default)("br"))})},y_.showWebsocketConnectionIssue=function(e){(0,s.showModal)({title:"Unable to connect to the device via websocket",content:(0,i.default)("div",(0,i.default)("span",e),(0,i.default)("br"))})},y_.showIssueParsingTheTracedResponse=function(e){(0,s.showModal)({title:"A problem was encountered while connecting to the Perfetto tracing service",content:(0,i.default)("div",(0,i.default)("span",e),(0,i.default)("br"))})},y_.showFailedToPushBinary=function(e){(0,s.showModal)({title:"Failed to push a binary to the device",content:(0,i.default)("div",(0,i.default)("span","This can happen if your Android device has an OS version lower than Q. Perfetto tried to push the latest version of its embedded binary but failed."),(0,i.default)("br"),(0,i.default)("br"),(0,i.default)("span","Error message:"),(0,i.default)("br"),(0,i.default)("span",e))})};const i=or.__importDefault(ae()),e=b_(),r=I_(),n=re(),a=ie(),o=Nr(),s=de(),t=oe(),l=So(),c="crash_modal",u=1e4;let d=0;class f{traceState;traceType="No trace loaded";traceData;traceUrl;attachTrace=!1;uploadStatus="";userDescription="";errorMessage="";uploader;constructor(){this.traceState="NOT_AVAILABLE";var e=t.globals.getCurrentEngine();if(void 0!==e)if(this.traceType=e.source.type,"url"in e.source&&void 0!==e.source.url)this.traceUrl=e.source.url,this.traceState="UPLOADED",this.attachTrace=!0;else if(t.globals.isInternalUser){if("FILE"===e.source.type)this.traceState="NOT_UPLOADED",this.traceData=e.source.file;else{if("ARRAY_BUFFER"!==e.source.type)return;this.traceData=e.source.buffer}this.traceState="NOT_UPLOADED"}}view(e){const t=e.attrs;let r=`UI: ${location.protocol}//${location.host}/${o.VERSION}

`;r+=t.message+`
`;for(const a of t.stack)r+=` - ${a.name} (${a.location})
`;r+="\n",this.attachTrace&&this.traceUrl?r+=`Trace: ${this.traceUrl}
`:this.attachTrace&&"UPLOADING"===this.traceState?r+=`Trace: uploading...
`:r+=`Trace: not available (${this.traceType}). Provide repro steps.
`,r=(r+=`UA: ${navigator.userAgent}
`)+`Referrer: ${document.referrer}
`,this.errorMessage=r;let n=null;return"NOT_AVAILABLE"!==this.traceState&&(n=(0,i.default)("div",(0,i.default)("label",(0,i.default)("input[type=checkbox]",{checked:this.attachTrace,oninput:e=>{e=e.target.checked;this.onUploadCheckboxChange(e)}}),"UPLOADING"===this.traceState?"Uploading trace... "+this.uploadStatus:"Tick to share the current trace and help debugging"),(0,i.default)("div.modal-small",`This will upload the trace and attach a link to the bug.
          You may leave it unchecked and attach the trace manually to the bug
          if preferred.`))),[(0,i.default)("div",(0,i.default)(".modal-logs",r),(0,i.default)("span",`Please provide any additional details describing
        how the crash occurred:`),(0,i.default)("textarea.modal-textarea",{rows:3,maxlength:1e3,oninput:e=>{this.userDescription=e.target.value},onkeydown:e=>e.stopPropagation(),onkeyup:e=>e.stopPropagation()}),n),(0,i.default)("footer",(0,i.default)("button.modal-btn.modal-btn-primary",{onclick:()=>this.fileBug(t)},"File a bug (Googlers only)"))]}onUploadCheckboxChange(e){if(a.raf.scheduleFullRedraw(),(this.attachTrace=e)&&void 0!==this.traceData&&"NOT_UPLOADED"===this.traceState){this.traceState="UPLOADING",this.uploadStatus="";const t=new r.GcsUploader(this.traceData,{onProgress:()=>{a.raf.scheduleFullRedraw(),this.uploadStatus=t.getEtaString(),"UPLOADED"===t.state?(this.traceState="UPLOADED",this.traceUrl=t.uploadedUrl):"ERROR"===t.state&&(this.traceState="NOT_UPLOADED",this.uploadStatus=t.error)}});this.uploader=t}else!e&&this.uploader&&this.uploader.abort()}fileBug(e){e=e.message.split("\n",1)[0].substring(0,80);let t="https://goto.google.com/perfetto-ui-bug";t=t+("?title="+encodeURIComponent("UI Error: "+e))+"&description=",""!==this.userDescription&&(t+=encodeURIComponent("User description:\n"+this.userDescription+"\n\n")),t=(t+=encodeURIComponent(this.errorMessage)).substring(0,8e3),window.open(t,"_blank")}}function p(){(0,s.showModal)({title:"Connection with the ADB device lost",content:(0,i.default)("div",(0,i.default)("span","Please connect the device again to restart the recording."),(0,i.default)("br"))})}return y_}function P_(){if(!A_){A_=1,Object.defineProperty(__,"__esModule",{value:!0}),__.convertTraceToJsonAndDownload=function(e){n({kind:"ConvertTraceAndDownload",trace:e,format:"json"})},__.convertTraceToSystraceAndDownload=function(e){n({kind:"ConvertTraceAndDownload",trace:e,format:"systrace"})},__.convertToJson=function(e,t){n({kind:"ConvertTraceAndOpenInLegacy",trace:e,truncate:t})},__.convertTraceToPprofAndDownload=function(e,t,r){n({kind:"ConvertTraceToPprof",trace:e,pid:t,ts:r})};const a=Ws(),i=J(),o=ne(),s=M_(),l=oe(),c=N_();function r(e){e=e.data;if("updateStatus"===e.kind)l.globals.dispatch(o.Actions.updateStatus({msg:e.status,timestamp:Date.now()/1e3}));else if("updateJobStatus"===e.kind)l.globals.setConversionJobStatus(e.name,e.status);else if("downloadFile"===e.kind)(0,a.download)(new File([new Blob([e.buffer])],e.name));else if("openTraceInLegacy"===e.kind){var t=(0,i.utf8Decode)(e.buffer);(0,c.openBufferWithLegacyTraceViewer)("trace.json",t,0)}else{if("error"!==e.kind)throw new Error("Unhandled message "+JSON.stringify(e));(0,s.maybeShowErrorDialog)(e.error)}}function n(e){var t=new Worker(l.globals.root+"traceconv_bundle.js");t.onmessage=r,t.postMessage(e)}}return __}function N_(){if(!O_){var e,t,r,n,a,i,o,s,l;O_=1,Object.defineProperty(x0,"__esModule",{value:!0}),x0.isLegacyTrace=async function(t){var r=t.name.toLowerCase();if(r.endsWith(".json")||r.endsWith(".json.gz")||r.endsWith(".zip")||r.endsWith(".html"))return!0;if(await c(t))return!0;if(r.endsWith(".trace")){r=(await u(t.slice(0,512))).split("\n");let e=0;for(const n of r)n.startsWith("#")&&e++;if(5<e)return!0}return!1},x0.openFileWithLegacyTraceViewer=async function(t){const r=new FileReader;r.onload=()=>{var e;return r.result instanceof ArrayBuffer?d(t.name,r.result,r.result.byteLength):(e=r.result,d(t.name,e,e.length))},r.onerror=e=>{console.error(e)},t.name.endsWith(".gz")||t.name.endsWith(".zip")||await c(t)?r.readAsArrayBuffer(t):r.readAsText(t)},x0.openBufferWithLegacyTraceViewer=d,x0.openInOldUIWithSizeCheck=function(e){var t;e.size<52428800?(0,T.convertToJson)(e):(t=Math.round(e.size/1048576),(0,m.showModal)({title:"Legacy UI may fail to open this trace",content:(0,f.default)("div",(0,f.default)("p",`This trace is ${t}mb, opening it in the legacy UI `+"may fail."),(0,f.default)("p","More options can be found at ",(0,f.default)("a",{href:"https://goto.google.com/opening-large-traces",target:"_blank"},"go/opening-large-traces"),".")),buttons:[{text:"Open full trace (not recommended)",action:()=>(0,T.convertToJson)(e)},{text:"Open beginning of trace",action:()=>(0,T.convertToJson)(e,"start")},{text:"Open end of trace",primary:!0,action:()=>(0,T.convertToJson)(e,"end")}]}))};const f=or.__importDefault(ae()),p=(d_||(d_=1,{Deflate:e,deflate:t,deflateRaw:r,gzip:n}=r_(),{Inflate:a,inflate:i,inflateRaw:o,ungzip:s}=g_(),l=W0(),L0.Deflate=e,L0.deflate=t,L0.deflateRaw=r,L0.gzip=n,L0.Inflate=a,L0.inflate=i,L0.inflateRaw=o,L0.ungzip=s,L0.constants=l),L0),h=ee(),g=te(),m=de(),_=oe(),y=J(),T=P_(),b="TRACE:\n";async function c(e){var t=e.name.toLowerCase();if(t.endsWith(".ctrace"))return!0;if(t.endsWith(".txt")&&(await u(e.slice(0,128))).includes(b))return!0;return!1}function u(n){return new Promise((e,t)=>{const r=new FileReader;r.onload=()=>{if((0,g.isString)(r.result))return e(r.result)},r.onerror=e=>{t(e)},r.readAsText(n)})}function d(t,r,e){r instanceof ArrayBuffer&&((0,h.assertTrue)(e<=r.byteLength),e!==r.byteLength&&(r=r.slice(0,e)),(n=(0,y.utf8Decode)(r.slice(0,128))).includes(b))&&(n=n.indexOf(b)+b.length,r=(0,p.inflate)(new Uint8Array(r.slice(n)),{to:"string"}));var n=_.globals.root+"assets/catapult_trace_viewer.html",n=window.open(n);n?n.addEventListener("load",e=>{e.target.querySelector("x-profiling-view").setActiveTrace(t,r)}):(0,m.showModal)({title:"Open trace in the legacy Catapult Trace Viewer",content:(0,f.default)("div",(0,f.default)("div","You are seeing this interstitial because popups are blocked"),(0,f.default)("div","Enable popups to skip this dialog next time.")),buttons:[{text:"Open legacy UI",primary:!0,action:()=>d(t,r,e)}]})}}return x0}function D_(){if(!C_){C_=1,Object.defineProperty(D0,"__esModule",{value:!0}),D0.plugin=void 0;const r=K(),a=z(),i=ne(),o=oe(),s=N_(),l=N_();var e=V();function n(e){if(!(e.target instanceof HTMLInputElement))throw new Error("Not an input element");var t;e.target.files&&(t=e.target.files[0],e.target.value="","1"===e.target.dataset.useCatapultLegacyUi?async function(e){o.globals.logging.logEvent("Trace Actions","Open trace in Legacy UI"),(await(0,l.isLegacyTrace)(e)?(0,l.openFileWithLegacyTraceViewer):(0,s.openInOldUIWithSizeCheck))(e)}(t):(o.globals.logging.logEvent("Trace Actions","Open trace from file"),o.globals.dispatch(i.Actions.openTraceFromFile({file:t}))))}D0.plugin={pluginId:"perfetto.CoreCommands",plugin:class{disposable=new e.DisposableStack;onActivate(e){e.registerCommand({id:"perfetto.CoreCommands#ToggleLeftSidebar",name:"Toggle left sidebar",callback:()=>{o.globals.state.sidebarVisible?o.globals.dispatch(i.Actions.setSidebar({visible:!1})):o.globals.dispatch(i.Actions.setSidebar({visible:!0}))},defaultHotkey:"!Mod+B"});const t=document.createElement("input");t.classList.add("trace_file"),t.setAttribute("type","file"),t.style.display="none",t.addEventListener("change",n),document.body.appendChild(t),this.disposable.defer(()=>{document.body.removeChild(t)});var r="perfetto.CoreCommands#openTrace",r=(e.registerCommand({id:r,name:"Open trace file",callback:()=>{delete t.dataset.useCatapultLegacyUi,t.click()},defaultHotkey:"!Mod+O"}),e.addSidebarMenuItem({commandId:r,group:"navigation",icon:"folder_open"}),"perfetto.CoreCommands#openTraceInLegacyUi");e.registerCommand({id:r,name:"Open with legacy UI",callback:()=>{t.dataset.useCatapultLegacyUi="1",t.click()}}),e.addSidebarMenuItem({commandId:r,group:"navigation",icon:"filter_none"})}async onTraceLoad(t){t.registerCommand({id:"perfetto.CoreCommands#RunQueryAllProcesses",name:"Run query: All processes",callback:()=>{t.tabs.openQuery("select name, pid from process order by name;","All Processes")}}),t.registerCommand({id:"perfetto.CoreCommands#RunQueryCpuTimeByProcess",name:"Run query: CPU time by process",callback:()=>{t.tabs.openQuery(`
select
  process.name,
  sum(dur)/1e9 as cpu_sec
from sched
join thread using(utid)
join process using(upid)
group by upid
order by cpu_sec desc
limit 100;`,"CPU time by process")}}),t.registerCommand({id:"perfetto.CoreCommands#RunQueryCyclesByStateByCpu",name:"Run query: cycles by p-state by CPU",callback:()=>{t.tabs.openQuery(`
select
  cpu,
  freq,
  dur,
  sum(dur * freq)/1e6 as mcycles
from (
  select
    cpu,
    value as freq,
    lead(ts) over (partition by cpu order by ts) - ts as dur
  from counter
  inner join cpu_counter_track on counter.track_id = cpu_counter_track.id
  where name = 'cpufreq'
) group by cpu, freq
order by mcycles desc limit 32;`,"Cycles by p-state by CPU")}}),t.registerCommand({id:"perfetto.CoreCommands#RunQueryCyclesByCpuByProcess",name:"Run query: CPU Time by CPU by process",callback:()=>{t.tabs.openQuery(`
select
  process.name as process,
  thread.name as thread,
  cpu,
  sum(dur) / 1e9 as cpu_sec
from sched
inner join thread using(utid)
inner join process using(upid)
group by utid, cpu
order by cpu_sec desc
limit 30;`,"CPU time by CPU by process")}}),t.registerCommand({id:"perfetto.CoreCommands#RunQueryHeapGraphBytesPerType",name:"Run query: heap graph bytes per type",callback:()=>{t.tabs.openQuery(`
select
  o.upid,
  o.graph_sample_ts,
  c.name,
  sum(o.self_size) as total_self_size
from heap_graph_object o join heap_graph_class c on o.type_id = c.id
group by
 o.upid,
 o.graph_sample_ts,
 c.name
order by total_self_size desc
limit 100;`,"Heap graph bytes per type")}}),t.registerCommand({id:"perfetto.CoreCommands#DebugSqlPerformance",name:"Debug SQL performance",callback:()=>{t.tabs.openQuery(`
with first as (select started as ts from sqlstats limit 1)
select
    round((max(ended - started, 0))/1e6) as runtime_ms,
    round((started - first.ts)/1e6) as t_start_ms,
    query
from sqlstats, first
order by started desc`,"Recent SQL queries")}}),t.registerCommand({id:"perfetto.CoreCommands#UnpinAllTracks",name:"Unpin all pinned tracks",callback:()=>{t.timeline.unpinTracksByPredicate(e=>!0)}}),t.registerCommand({id:"perfetto.CoreCommands#ExpandAllGroups",name:"Expand all track groups",callback:()=>{t.timeline.expandGroupsByPredicate(e=>!0)}}),t.registerCommand({id:"perfetto.CoreCommands#CollapseAllGroups",name:"Collapse all track groups",callback:()=>{t.timeline.collapseGroupsByPredicate(e=>!0)}}),t.registerCommand({id:"perfetto.CoreCommands#PanToTimestamp",name:"Pan to timestamp",callback:e=>{if((0,a.exists)(e)){if("bigint"!=typeof e)throw Error(e+" is not a bigint");t.timeline.panToTimestamp(r.Time.fromRaw(e))}else{e=function(e){e=window.prompt(e);if(null!==e)try{return r.Time.fromRaw(BigInt(e))}catch{window.alert(e+" is not an integer")}return}("Enter a timestamp");(0,a.exists)(e)&&t.timeline.panToTimestamp(r.Time.fromRaw(e))}}}),t.registerCommand({id:"perfetto.CoreCommands#ShowCurrentSelectionTab",name:"Show current selection tab",callback:()=>{t.tabs.showTab("current_selection")}})}onDeactivate(e){this.disposable[Symbol.dispose]()}}}}return D0}var x_,L_,F_={},U_={};function B_(){if(!x_){x_=1,Object.defineProperty(U_,"__esModule",{value:!0}),U_.CounterDetailsPanel=void 0;var e=or,t=qa();const a=K(),r=ie(),i=ue(),n=e.__importDefault(ae()),o=F(),s=Cf(),l=Rf(),c=ce(),u=x(),d=L();U_.CounterDetailsPanel=class{queryLimiter=new t.AsyncLimiter;engine;trackId;rootTable;trackName;id;counterDetails;constructor(e,t,r,n="counter"){this.engine=e,this.trackId=t,this.trackName=r,this.rootTable=n}render(e){return e!==this.id&&(this.id=e,this.queryLimiter.schedule(async()=>{this.counterDetails=await async function(e,t,r,n){n=`
    WITH CTE AS (
      SELECT
        id,
        ts as leftTs,
        value,
        LAG(value) OVER (ORDER BY ts) AS prevValue,
        LEAD(ts) OVER (ORDER BY ts) AS rightTs
      FROM ${n}
      WHERE track_id = ${t}
    )
    SELECT * FROM CTE WHERE id = ${r}
  `,t=await e.query(n),r=t.iter({value:i.NUM,prevValue:i.NUM_NULL,leftTs:i.LONG,rightTs:i.LONG_NULL}),e=r.value,n=a.Time.fromRaw(r.leftTs),t=null!==r.rightTs?a.Time.fromRaw(r.rightTs):n,r=null!==r.prevValue?r.prevValue:e,r=e-r,t-=n;return{ts:n,value:e,delta:r,duration:t}}(this.engine,this.trackId,e,this.rootTable),r.raf.scheduleFullRedraw()})),this.renderView()}renderView(){var e=this.counterDetails;return e?(0,n.default)(o.DetailsShell,{title:"Counter",description:""+this.trackName},(0,n.default)(s.GridLayout,(0,n.default)(l.Section,{title:"Properties"},(0,n.default)(c.Tree,(0,n.default)(c.TreeNode,{left:"Name",right:""+this.trackName}),(0,n.default)(c.TreeNode,{left:"Start time",right:(0,n.default)(u.Timestamp,{ts:e.ts})}),(0,n.default)(c.TreeNode,{left:"Value",right:""+e.value.toLocaleString()}),(0,n.default)(c.TreeNode,{left:"Delta",right:""+e.delta.toLocaleString()}),(0,n.default)(c.TreeNode,{left:"Duration",right:(0,n.default)(d.DurationWidget,{dur:e.duration})}))))):(0,n.default)(o.DetailsShell,{title:"Counter",description:"Loading..."})}isLoading(){return void 0===this.counterDetails}}}return U_}function j_(){if(!L_){L_=1,Object.defineProperty(F_,"__esModule",{value:!0}),F_.plugin=void 0;const f=ue(),p=ms(),h=kg(),g=B_(),n=K();var e=new RegExp("^.* (Received|Transmitted)( KB)?$"),t=new RegExp("^Entity residency:");const a=[[new RegExp("^power..*$"),"rate"],[new RegExp("^psi..*$"),"rate"],[e,"rate"],[t,"rate"]];function u(e){var t={};t.yMode=function(e){for(var[t,r]of a)if(e.match(t))return r}(e),e.endsWith("_pct")&&(t.yOverrideMinimum=0,t.yOverrideMaximum=100,t.unit="%"),e.startsWith("power.")&&(t.yRangeSharingKey="power"),e.startsWith("battery_stats.")&&(t.yRangeSharingKey="battery_stats");var r=new RegExp("Entity residency: ([^ ]+) ").exec(e);return r&&(t.yRangeSharingKey="entity-residency-"+r[1]),new RegExp("GPU .* Frequency").exec(e)&&(t.yRangeSharingKey="gpu-frequency"),t}async function d(e,t,r){e=(await e.query(`
    WITH CTE AS (
      SELECT
        id,
        ts as leftTs,
        LEAD(ts) OVER (ORDER BY ts) AS rightTs
      FROM counter
      WHERE track_id = ${t}
    )
    SELECT * FROM CTE WHERE id = ${r}
  `)).iter({leftTs:f.LONG,rightTs:f.LONG_NULL}),t=n.Time.fromRaw(e.leftTs);return{ts:t,dur:(null!==e.rightTs?n.Time.fromRaw(e.rightTs):t)-t}}F_.plugin={pluginId:"perfetto.Counter",plugin:class{async onTraceLoad(e){await this.addCounterTracks(e),await this.addGpuFrequencyTracks(e),await this.addCpuFreqLimitCounterTracks(e),await this.addCpuPerfCounterTracks(e),await this.addThreadCounterTracks(e),await this.addProcessCounterTracks(e)}async addCounterTracks(t){for(var e=(await t.engine.query(`
      select name, id, unit
      from (
        select name, id, unit
        from counter_track
        join _counter_track_summary using (id)
        where type = 'counter_track'
        union
        select name, id, unit
        from gpu_counter_track
        join _counter_track_summary using (id)
        where name != 'gpufreq'
      )
      order by name
    `)).iter({name:f.STR,unit:f.STR_NULL,id:f.NUM});e.valid();e.next()){const r=e.id,n=e.name,a=e.unit??void 0;t.registerStaticTrack({uri:"/counter_"+r,title:n,tags:{kind:f.COUNTER_TRACK_KIND,trackIds:[r]},trackFactory:e=>new h.TraceProcessorCounterTrack({engine:t.engine,trackKey:e.trackKey,trackId:r,options:{...u(n),unit:a}}),sortKey:f.PrimaryTrackSortKey.COUNTER_TRACK,detailsPanel:new g.CounterDetailsPanel(t.engine,r,n),getEventBounds:async e=>d(t.engine,r,e)})}}async addCpuFreqLimitCounterTracks(e){this.addCpuCounterTracks(e,`
      select name, id
      from cpu_counter_track
      join _counter_track_summary using (id)
      where name glob "Cpu * Freq Limit"
      order by name asc
    `)}async addCpuPerfCounterTracks(e){this.addCpuCounterTracks(e,`
      select printf("Cpu %u %s", cpu, name) as name, id
      from perf_counter_track as pct
      join _counter_track_summary using (id)
      order by perf_session_id asc, pct.name asc, cpu asc
    `)}async addCpuCounterTracks(t,e){for(var r=(await t.engine.query(e)).iter({name:f.STR,id:f.NUM});r.valid();r.next()){const n=r.name,a=r.id;t.registerTrack({uri:"/cpu_counter_"+a,title:n,tags:{kind:f.COUNTER_TRACK_KIND,trackIds:[a]},trackFactory:e=>new h.TraceProcessorCounterTrack({engine:t.engine,trackKey:e.trackKey,trackId:a,options:u(n)}),detailsPanel:new g.CounterDetailsPanel(t.engine,a,n),getEventBounds:async e=>d(t.engine,a,e)})}}async addThreadCounterTracks(t){for(var e=(await t.engine.query(`
      select
        thread_counter_track.name as trackName,
        utid,
        upid,
        tid,
        thread.name as threadName,
        thread_counter_track.id as trackId,
        thread.start_ts as startTs,
        thread.end_ts as endTs
      from thread_counter_track
      join _counter_track_summary using (id)
      join thread using(utid)
      where thread_counter_track.name != 'thread_time'
    `)).iter({startTs:f.LONG_NULL,trackId:f.NUM,endTs:f.LONG_NULL,trackName:f.STR_NULL,utid:f.NUM,upid:f.NUM_NULL,tid:f.NUM_NULL,threadName:f.STR_NULL});e.valid();e.next()){var r=e.utid,n=e.upid,a=e.tid;const l=e.trackId;var i=e.trackName,o=e.threadName,s=f.COUNTER_TRACK_KIND;const c=(0,p.getTrackName)({name:i,utid:r,tid:a,kind:s,threadName:o,threadTrack:!0});t.registerTrack({uri:(0,p.getThreadUriPrefix)(n,r)+"_counter_"+l,title:c,tags:{kind:s,trackIds:[l]},trackFactory:e=>new h.TraceProcessorCounterTrack({engine:t.engine,trackKey:e.trackKey,trackId:l,options:u(c)}),detailsPanel:new g.CounterDetailsPanel(t.engine,l,c),getEventBounds:async e=>d(t.engine,l,e)})}}async addProcessCounterTracks(t){var r=(await t.engine.query(`
    select
      process_counter_track.id as trackId,
      process_counter_track.name as trackName,
      upid,
      process.pid,
      process.name as processName
    from process_counter_track
    join _counter_track_summary using (id)
    join process using(upid);
  `)).iter({trackId:f.NUM,trackName:f.STR_NULL,upid:f.NUM,pid:f.NUM_NULL,processName:f.STR_NULL});for(let e=0;r.valid();++e,r.next()){const l=r.trackId;var n=r.pid,a=r.trackName,i=r.upid,o=r.processName,s=f.COUNTER_TRACK_KIND;const c=(0,p.getTrackName)({name:a,upid:i,pid:n,kind:s,processName:o});t.registerTrack({uri:`/process_${i}/counter_`+l,title:c,tags:{kind:f.COUNTER_TRACK_KIND,trackIds:[l]},trackFactory:e=>new h.TraceProcessorCounterTrack({engine:t.engine,trackKey:e.trackKey,trackId:l,options:u(c)}),detailsPanel:new g.CounterDetailsPanel(t.engine,l,c),getEventBounds:async e=>d(t.engine,l,e)})}}async addGpuFrequencyTracks(t){var r=t.engine,n=t.trace.gpuCount;for(let e=0;e<n;e++){var a=await r.query(`
        select id
        from gpu_counter_track
        join _counter_track_summary using (id)
        where name = 'gpufreq' and gpu_id = ${e}
        limit 1;
      `);if(0<a.numRows()){const i=a.firstRow({id:f.NUM}).id;a="/gpu_frequency_"+e;const o=`Gpu ${e} Frequency`;t.registerTrack({uri:a,title:o,tags:{kind:f.COUNTER_TRACK_KIND,trackIds:[i]},trackFactory:e=>new h.TraceProcessorCounterTrack({engine:t.engine,trackKey:e.trackKey,trackId:i,options:u(o)}),detailsPanel:new g.CounterDetailsPanel(t.engine,i,o),getEventBounds:async e=>d(t.engine,i,e)})}}}}}}return F_}var H_,G_={};var V_,W_={},q_={};var $_,z_,K_={};function Y_(){if(!z_){z_=1;{var i=W_;Object.defineProperty(i,"__esModule",{value:!0}),i.plugin=i.CPU_PROFILE_TRACK_KIND=void 0;const o=or.__importDefault(ae()),s=function(){if(!V_){V_=1,Object.defineProperty(q_,"__esModule",{value:!0}),q_.CpuProfileDetailsPanel=void 0;const n=or.__importDefault(ae()),r=oe();q_.CpuProfileDetailsPanel=class{view(){var e=r.globals.cpuProfileDetails,t=(0,n.default)(".details-panel-heading",(0,n.default)("h2","CPU Profile Sample Details"));return void 0===e.id?(0,n.default)(".details-panel",t):(0,n.default)(".details-panel",t,(0,n.default)("table",this.getStackText(e.stack)))}getStackText(t){if(!t)return[];var r=[];for(let e=t.length-1;0<=e;--e)r.push((0,n.default)("tr",(0,n.default)("td",t[e].name),(0,n.default)("td",t[e].mapping)));return r}}}return q_}(),l=Z(),c=function(){if(!$_){$_=1,Object.defineProperty(K_,"__esModule",{value:!0}),K_.CpuProfileTrack=void 0;const o=Wf(),d=K(),f=Y(),s=ne(),p=M();var e=vg();const h=oe(),l=Z();K_.CpuProfileTrack=class{centerY=this.getHeight()/2+3;markerWidth=(this.getHeight()-4.5-3)/2;hoveredTs=void 0;fetcher=new e.TimelineFetcher(this.onBoundsChange.bind(this));engine;utid;constructor(e,t){this.engine=e,this.utid=t}async onUpdate({visibleWindow:e,resolution:t}){await this.fetcher.requestData(e.toTimeSpan(),t)}async onBoundsChange(e,t,r){var n=`select
        id,
        ts,
        callsite_id as callsiteId
      from cpu_profile_stack_sample
      where utid = ${this.utid}
      order by ts`,n=await this.engine.query(n),a=n.numRows(),i={start:e,end:t,resolution:r,length:a,ids:new Float64Array(a),tsStarts:new BigInt64Array(a),callsiteId:new Uint32Array(a)},o=n.iter({id:l.NUM,ts:l.LONG,callsiteId:l.NUM});for(let e=0;o.valid();o.next(),++e)i.ids[e]=o.id,i.tsStarts[e]=o.ts,i.callsiteId[e]=o.callsiteId;return i}async onDestroy(){this.fetcher[Symbol.dispose]()}getHeight(){return 34}render({ctx:r,timescale:n}){var a=this.fetcher.data;if(void 0!==a){for(let e=0;e<a.tsStarts.length;e++){var i=d.Time.fromRaw(a.tsStarts[e]),o=(0,f.getLegacySelection)(h.globals.state),s=this.hoveredTs===i,o=null!==o&&"CPU_PROFILE_SAMPLE"===o.kind&&o.ts===i?3:0;this.drawMarker(r,n.timeToPx(i),this.centerY,s,o,a.callsiteId[e])}let t=0;for(;t<a.tsStarts.length;){var l,c,u=a.callsiteId[t];let e=t;for(;e+1<a.tsStarts.length&&a.callsiteId[e+1]===u;)e++;t!==e&&(l=d.Time.fromRaw(a.tsStarts[t]),c=d.Time.fromRaw(a.tsStarts[e]),l=n.timeToPx(l)-this.markerWidth,c=n.timeToPx(c)+this.markerWidth-l,r.fillStyle=(0,p.colorForSample)(u,!1),r.fillRect(l,4.5,c,3)),t=e+1}}}drawMarker(e,t,r,n,a,i){e.beginPath(),e.moveTo(t-this.markerWidth,r-this.markerWidth),e.lineTo(t,r+this.markerWidth),e.lineTo(t+this.markerWidth,r-this.markerWidth),e.lineTo(t-this.markerWidth,r-this.markerWidth),e.closePath(),e.fillStyle=(0,p.colorForSample)(i,n),e.fill(),0<a&&(e.strokeStyle=(0,p.colorForSample)(i,!1),e.lineWidth=a,e.stroke())}onMouseMove({x:e,y:t,timescale:r}){var n,a,i=this.fetcher.data;void 0!==i&&(a=r.pxToHpTime(e),[a,n]=(0,o.searchSegment)(i.tsStarts,a.toTime()),a=this.findTimestampIndex(a,r,i,e,t,n),this.hoveredTs=-1===a?void 0:d.Time.fromRaw(i.tsStarts[a]))}onMouseOut(){this.hoveredTs=void 0}onMouseClick({x:e,y:t,timescale:r}){var n,a,i=this.fetcher.data;return void 0!==i&&(a=r.pxToHpTime(e),[a,n]=(0,o.searchSegment)(i.tsStarts,a.toTime()),-1!==(a=this.findTimestampIndex(a,r,i,e,t,n)))&&(r=i.ids[a],e=d.Time.fromRaw(i.tsStarts[a]),h.globals.makeSelection(s.Actions.selectCpuProfileSample({id:r,utid:this.utid,ts:e})),!0)}findTimestampIndex(e,t,r,n,a,i){let o=-1;var s;return-1!==e&&(s=d.Time.fromRaw(r.tsStarts[e]),s=t.timeToPx(s),this.isInMarker(n,a,s))&&(o=e),o=-1!==i&&(s=d.Time.fromRaw(r.tsStarts[i]),e=t.timeToPx(s),this.isInMarker(n,a,e))?i:o}isInMarker(e,t,r){return Math.abs(e-r)+Math.abs(t-this.centerY)<=this.markerWidth}}}return K_}(),u=ms();i.CPU_PROFILE_TRACK_KIND="CpuProfileTrack";i.plugin={pluginId:"perfetto.CpuProfile",plugin:class{async onTraceLoad(e){for(var t=(await e.engine.query(`
      with thread_cpu_sample as (
        select distinct utid
        from cpu_profile_stack_sample
        where utid != 0
      )
      select
        utid,
        tid,
        upid,
        thread.name as threadName
      from thread_cpu_sample
      join thread using(utid)`)).iter({utid:l.NUM,upid:l.NUM_NULL,tid:l.NUM_NULL,threadName:l.STR_NULL});t.valid();t.next()){const a=t.utid;var r=t.upid,n=t.threadName;e.registerTrack({uri:(0,u.getThreadUriPrefix)(r,a)+"_cpu_samples",title:n+" (CPU Stack Samples)",tags:{kind:i.CPU_PROFILE_TRACK_KIND,utid:a},trackFactory:()=>new c.CpuProfileTrack(e.engine,a)})}e.registerDetailsPanel({render:e=>{if("CPU_PROFILE_SAMPLE"===e.kind)return(0,o.default)(s.CpuProfileDetailsPanel)}})}}}}}return W_}var J_,Z_,Q_={},X_={},ey={};function ty(){if(!Z_){Z_=1,Object.defineProperty(X_,"__esModule",{value:!0}),X_.SliceDetailsPanel=void 0;const i=or.__importDefault(ae()),o=ne(),s=bf(),l=se(),r=F(),n=Cf(),c=Rf(),u=Lg(),d=ce(),f=oe(),p=Bc();var e=function(){if(!J_){J_=1,Object.defineProperty(ey,"__esModule",{value:!0}),ey.SlicePanel=void 0;const r=z();function t(e,t){return void 0===e?void 0===t?void 0:""+t:void 0===t?e:e+" "+t}ey.SlicePanel=class{getProcessThreadDetails(e){return new Map([["Thread",t(e.threadName,e.tid)],["Process",t(e.processName,e.pid)],["User ID",(0,r.exists)(e.uid)?String(e.uid):void 0],["Package name",e.packageName],["Version code",e.versionCode?String(e.versionCode):void 0]])}}}return ey}();const h=L(),g=x(),m=Q();class t extends e.SlicePanel{view(){var e,t=f.globals.sliceDetails;if(void 0!==t.utid)return e=f.globals.threads.get(t.utid),(0,i.default)(r.DetailsShell,{title:"CPU Sched Slice",description:this.renderDescription(t)},(0,i.default)(n.GridLayout,this.renderDetails(t,e),this.renderSchedLatencyInfo(t)))}renderDescription(e){e=f.globals.threads.get(e.wakerUtid);return e?`${e.procName} [${e.pid}]`:null}renderSchedLatencyInfo(e){return this.hasSchedLatencyInfo(e)?(0,i.default)(c.Section,{title:"Scheduling Latency"},(0,i.default)(".slice-details-latency-panel",(0,i.default)("img.slice-details-image",{src:f.globals.root+"assets/scheduling_latency.png"}),this.renderWakeupText(e),this.renderDisplayLatencyText(e))):null}renderWakeupText(e){var t;return void 0!==e.wakerUtid&&(t=f.globals.threads.get(e.wakerUtid))?(0,i.default)(".slice-details-wakeup-text",(0,i.default)("","Wakeup @ ",(0,i.default)(g.Timestamp,{ts:e.wakeupTs}),` on CPU ${e.wakerCpu} by`),(0,i.default)("",`P: ${t.procName} [${t.pid}]`),(0,i.default)("",`T: ${t.threadName} [${t.tid}]`)):null}renderDisplayLatencyText(e){return void 0===e.ts||void 0===e.wakeupTs?null:(e=e.ts-e.wakeupTs,(0,i.default)(".slice-details-latency-text",(0,i.default)("","Scheduling latency: ",(0,i.default)(h.DurationWidget,{dur:e})),(0,i.default)(".text-detail",`This is the interval from when the task became eligible to run
        (e.g. because of notifying a wait queue it was suspended on) to
        when it started running.`)))}hasSchedLatencyInfo({wakeupTs:e,wakerUtid:t}){return void 0!==e&&void 0!==t}renderThreadDuration(e){return void 0!==e.threadDur&&void 0!==e.threadTs?(0,i.default)(d.TreeNode,{icon:"timer",left:"Thread Duration",right:(0,i.default)(h.DurationWidget,{dur:e.threadDur})}):null}renderPriorityText(e){if(void 0!==e)return e<100?e+" (real-time)":""+e}renderDetails(e,t){if(t&&void 0!==e.ts&&void 0!==e.dur){var r,n,a=[];for([r,n]of this.getProcessThreadDetails(e))void 0!==n&&a.push((0,i.default)(d.TreeNode,{left:r,right:n}));t=[(0,i.default)(d.TreeNode,{left:"Process",right:`${t.procName} [${t.pid}]`}),(0,i.default)(d.TreeNode,{left:"Thread",right:(0,i.default)(l.Anchor,{icon:"call_made",onclick:()=>{this.goToThread()}},`${t.threadName} [${t.tid}]`)}),(0,i.default)(d.TreeNode,{left:"Cmdline",right:t.cmdline}),(0,i.default)(d.TreeNode,{left:"Start time",right:(0,i.default)(g.Timestamp,{ts:e.ts})}),(0,i.default)(d.TreeNode,{left:"Duration",right:(0,i.default)(h.DurationWidget,{dur:e.dur})}),this.renderThreadDuration(e),(0,i.default)(d.TreeNode,{left:"Priority",right:this.renderPriorityText(e.priority)}),(0,i.default)(d.TreeNode,{left:"End State",right:(0,s.translateState)(e.endState)}),(0,i.default)(d.TreeNode,{left:"SQL ID",right:(0,i.default)(u.SqlRef,{table:"sched",id:e.id})}),...a];return(0,i.default)(c.Section,{title:"Details"},(0,i.default)(d.Tree,t))}return null}goToThread(){var t=f.globals.sliceDetails;if(void 0!==t.utid){var r=f.globals.threads.get(t.utid);if(void 0!==t.id&&void 0!==t.ts&&void 0!==t.dur&&void 0!==t.cpu&&void 0!==r){let e;for(const a of Object.values(f.globals.state.tracks)){var n=f.globals.trackManager.resolveTrackInfo(a.uri);n&&n.tags?.kind===m.THREAD_STATE_TRACK_KIND&&n.tags?.utid===r.utid&&(e=a.key)}e&&t.threadStateId&&(f.globals.makeSelection(o.Actions.selectThreadState({id:t.threadStateId,trackKey:e.toString()})),(0,p.scrollToTrackAndTs)(e,t.ts,!0))}}}renderCanvas(){}}X_.SliceDetailsPanel=t}return X_}var ry,ny,ay={};function iy(){if(!ry){ry=1,Object.defineProperty(ay,"__esModule",{value:!0}),ay.CpuSliceTrack=void 0;const s=Rr(),S=Wf(),A=ee(),O=K(),c=ne(),C=Y(),k=Rs(),w=J(),R=M();var e=vg();const i=Ps(),I=oe(),l=Z();var t=P();ay.CpuSliceTrack=class{mousePos;utidHoveredInThisTrack=-1;fetcher=new e.TimelineFetcher(this.onBoundsChange.bind(this));lastRowId=-1;engine;cpu;trackKey;trackUuid=(0,t.uuidv4Sql)();constructor(e,t,r){this.engine=e,this.trackKey=t,this.cpu=r}async onCreate(){await this.engine.query(`
      create virtual table cpu_slice_${this.trackUuid}
      using __intrinsic_slice_mipmap((
        select
          id,
          ts,
          iif(dur = -1, lead(ts, 1, trace_end()) over (order by ts) - ts, dur),
          0 as depth
        from sched
        where cpu = ${this.cpu} and utid != 0
      ));
    `);var e=await this.engine.query(`
      select coalesce(max(id), -1) as lastRowId
      from sched
      where cpu = ${this.cpu} and utid != 0
    `);this.lastRowId=e.firstRow({lastRowId:l.NUM}).lastRowId}async onUpdate({visibleWindow:e,resolution:t}){await this.fetcher.requestData(e.toTimeSpan(),t)}async onBoundsChange(e,t,r){(0,A.assertTrue)(1===s.BigintMath.popcount(r),r+" not pow of 2");var n=await this.engine.query(`
      select
        (z.ts / ${r}) * ${r} as tsQ,
        (((z.ts + z.dur) / ${r}) + 1) * ${r} as tsEndQ,
        s.utid,
        s.id,
        s.dur = -1 as isIncomplete,
        ifnull(s.priority < 100, 0) as isRealtime
      from cpu_slice_${this.trackUuid}(${e}, ${t}, ${r}) z
      cross join sched s using (id)
    `),a=n.numRows(),i={start:e,end:t,resolution:r,length:a,lastRowId:this.lastRowId,ids:new Float64Array(a),startQs:new BigInt64Array(a),endQs:new BigInt64Array(a),utids:new Uint32Array(a),flags:new Uint8Array(a)},o=n.iter({tsQ:l.LONG,tsEndQ:l.LONG,utid:l.NUM,id:l.NUM,isIncomplete:l.NUM,isRealtime:l.NUM});for(let e=0;o.valid();o.next(),e++)i.startQs[e]=o.tsQ,i.endQs[e]=o.tsEndQ,i.utids[e]=o.utid,i.ids[e]=o.id,i.flags[e]=0,o.isIncomplete&&(i.flags[e]|=1),o.isRealtime&&(i.flags[e]|=2);return i}async onDestroy(){await this.engine.tryQuery("drop table if exists cpu_slice_"+this.trackUuid),this.fetcher[Symbol.dispose]()}getHeight(){return 30}render(e){var{ctx:t,size:r,timescale:n}=e,a=this.fetcher.data;void 0!==a&&((0,i.checkerboardExcept)(t,this.getHeight(),0,r.width,n.timeToPx(a.start),n.timeToPx(a.end)),this.renderSlices(e,a))}renderSlices({ctx:i,timescale:r,size:e,visibleWindow:t},o){(0,A.assertTrue)(o.startQs.length===o.endQs.length),(0,A.assertTrue)(o.startQs.length===o.utids.length);var s=e.width,l=(i.textAlign="center",i.font="12px Roboto Condensed",i.measureText("dbpqaouk").width/8),t=t.toTimeSpan();const n=t.start;var c=t.end,t=o.endQs.findIndex(e=>e>=n),t=-1===t?0:t,[,a]=(0,S.searchSegment)(o.startQs,c),u=-1===a?o.startQs.length:a;for(let a=t;a<u;a++){var d=O.Time.fromRaw(o.startQs[a]);let e=O.Time.fromRaw(o.endQs[a]);var f=o.utids[a],d=(o.ids[a]===o.lastRowId&&1&o.flags[a]&&(e=c),r.timeToPx(d)),p=r.timeToPx(e),h=Math.max(1,p-d),g=I.globals.threads.get(f),m=g&&g.pid?g.pid:-1,_=-1!==I.globals.state.hoveredUtid,y=I.globals.state.hoveredUtid===f,m=I.globals.state.hoveredPid===m,T=(0,R.colorForThread)(g);let t,n;if(n=_&&!y?m?(t=T.variant,T.textVariant):(t=T.disabled,T.textDisabled):(t=T.base,T.textBase),i.fillStyle=t.cssString,1&o.flags[a]?(0,k.drawIncompleteSlice)(i,d,3,h,24):i.fillRect(d,3,h,24),!(h<5)){2&o.flags[a]&&(i.fillStyle=((y=_=void 0)===(m=i).sliceHatchedPattern&&((_=document.createElement("canvas")).width=_.height=8,(y=(0,A.assertExists)(_.getContext("2d"))).strokeStyle="rgba(255,255,255,0.3)",y.beginPath(),y.lineWidth=1,y.moveTo(0,8),y.lineTo(8,0),y.stroke(),m.sliceHatchedPattern=(0,A.assertExists)(m.createPattern(_,"repeat"))),m.sliceHatchedPattern),i.fillRect(d,3,h,24));let t=`[utid:${f}]`,r="";if(g)if(void 0!==g.pid&&0!==g.pid){let e=g.procName??"";e.startsWith("/")&&(e=e.substring(e.lastIndexOf("/")+1)),t=`${e} [${g.pid}]`,r=`${g.threadName} [${g.tid}]`}else t=`${g.threadName} [${g.tid}]`;2&o.flags[a]&&(r+=" (RT)");T=Math.min(s,p),y=Math.max(d,0),_=Math.max(T-y,1),m=(t=(0,w.cropText)(t,l,_),r=(0,w.cropText)(r,l,_),y+_/2);i.fillStyle=n.cssString,i.font="12px Roboto Condensed",i.fillText(t,m,14),i.fillStyle=n.setAlpha(.6).cssString,i.font="10px Roboto Condensed",i.fillText(r,m,24)}}var b,v,a=(0,C.getLegacySelection)(I.globals.state),t=I.globals.sliceDetails,E=(null!==a&&"SCHED_SLICE"===a.kind&&([a,E]=(0,S.searchEq)(o.ids,a.id),a!==E&&(E=O.Time.fromRaw(o.startQs[a]),v=O.Time.fromRaw(o.endQs[a]),a=o.utids[a],a=(0,R.colorForThread)(I.globals.threads.get(a)),b=r.timeToPx(E),v=r.timeToPx(v),v=Math.max(1,v-b),i.strokeStyle=a.base.setHSL({l:30}).cssString,i.beginPath(),i.lineWidth=3,i.strokeRect(b,1.5,v,27),i.closePath(),t.wakeupTs)&&(v=b-(a=r.timeToPx(t.wakeupTs)),(0,k.drawDoubleHeadedArrow)(i,a,27,v,20<=v),b=E-t.wakeupTs,E=O.Duration.humanise(b),v>=(b=i.measureText(E)).width+2)&&(i.fillStyle="rgba(255,255,255,0.7)",i.fillRect(a+v/2-b.width/2-1,15,b.width+2,11),i.textBaseline="bottom",i.fillStyle="black",i.fillText(E,a+v/2,26)),this.cpu===t.wakerCpu)&&t.wakeupTs&&(b=Math.floor(r.timeToPx(t.wakeupTs)),i.beginPath(),i.moveTo(b,23),i.fillStyle="black",i.lineTo(b+6,15),i.lineTo(b,7),i.lineTo(b-6,15),i.fill(),i.closePath()),I.globals.threads.get(this.utidHoveredInThisTrack));void 0!==E&&void 0!==this.mousePos&&(a=`T: ${E.threadName}
      [${E.tid}]`,E.pid?(v=`P: ${E.procName}
        [${E.pid}]`,(0,k.drawTrackHoverTooltip)(i,this.mousePos,e,v,a)):(0,k.drawTrackHoverTooltip)(i,this.mousePos,e,a))}onMouseMove({x:e,y:r,timescale:n}){var a=this.fetcher.data;if(this.mousePos={x:e,y:r},void 0!==a)if(r<3||27<r)this.utidHoveredInThisTrack=-1,I.globals.dispatch(c.Actions.setHoveredUtidAndPid({utid:-1,pid:-1}));else{var i=n.pxToHpTime(e);let t=-1;for(let e=0;e<a.startQs.length;e++){var o=O.Time.fromRaw(a.startQs[e]),s=O.Time.fromRaw(a.endQs[e]),l=a.utids[e];if(i.gte(o)&&i.lt(s)){t=l;break}}this.utidHoveredInThisTrack=t;r=I.globals.threads.get(t),n=r&&r.pid||-1;I.globals.dispatch(c.Actions.setHoveredUtidAndPid({utid:t,pid:n}))}}onMouseOut(){this.utidHoveredInThisTrack=-1,I.globals.dispatch(c.Actions.setHoveredUtidAndPid({utid:-1,pid:-1})),this.mousePos=void 0}onMouseClick({x:e,timescale:t}){var r=this.fetcher.data;return void 0!==r&&(t=t.pxToHpTime(e),!(!(t=-1===(e=(0,S.search)(r.startQs,t.toTime()))?void 0:r.ids[e])||-1===this.utidHoveredInThisTrack||(I.globals.setLegacySelection({kind:"SCHED_SLICE",id:t,trackKey:this.trackKey},{clearSearch:!0,pendingScrollId:void 0,switchToCurrentSelectionTab:!0}),0)))}}}return ay}var oy,sy={};var ly,cy={};var uy,dy={},fy={};function py(){if(!uy){uy=1;{var e=fy;Object.defineProperty(e,"__esModule",{value:!0}),e.ActualFramesTrack=e.ACTUAL_FRAME_ROW=void 0;var t=_n(),r=M(),n=kl();const i=xs();var a=ue();const o=(0,r.makeColorScheme)(new t.HSLColor("#03A9F4")),s=(0,r.makeColorScheme)(new t.HSLColor("#90CAF9")),l=(0,r.makeColorScheme)(new t.HSLColor("#4CAF50")),c=(0,r.makeColorScheme)(new t.HSLColor("#A5D6A7")),u=(0,r.makeColorScheme)(new t.HSLColor("#FFEB3B")),d=(0,r.makeColorScheme)(new t.HSLColor("#FFF9C4")),f=(0,r.makeColorScheme)(new t.HSLColor("#FF5722")),p=(0,r.makeColorScheme)(new t.HSLColor("#EF9A9A")),h=(0,r.makeColorScheme)(new t.HSLColor("#C0D588")),g=(0,r.makeColorScheme)(new t.HSLColor("#DCEDC8")),m=(0,r.makeColorScheme)(new t.HSLColor("#F515E0")),_=(0,r.makeColorScheme)(new t.HSLColor("#F48FB1"));e.ACTUAL_FRAME_ROW={...n.NAMED_ROW,jankTag:a.STR_NULL,jankSeverityType:a.STR_NULL};class y extends n.NamedSliceTrack{trackIds;constructor(e,t,r,n){super({engine:e,trackKey:r}),this.trackIds=n,this.sliceLayout={...i.SLICE_LAYOUT_FIT_CONTENT_DEFAULTS,depthGuess:t}}getRowSpec(){return e.ACTUAL_FRAME_ROW}getSqlSource(){return`
      SELECT
        s.ts as ts,
        s.dur as dur,
        s.layout_depth as depth,
        s.name as name,
        s.id as id,
        afs.jank_tag as jankTag,
        afs.jank_severity_type as jankSeverityType
      from experimental_slice_layout s
      join actual_frame_timeline_slice afs using(id)
      where
        filter_track_ids = '${this.trackIds.join(",")}'
    `}rowToSlice(e){return{...this.rowToSliceBase(e),colorScheme:function(e,t){if("Partial"===t)switch(e){case"Self Jank":return p;case"Other Jank":return d;case"Dropped Frame":return s;case"Buffer Stuffing":case"SurfaceFlinger Stuffing":return g;case"No Jank":return c;default:return _}else switch(e){case"Self Jank":return f;case"Other Jank":return u;case"Dropped Frame":return o;case"Buffer Stuffing":case"SurfaceFlinger Stuffing":return h;case"No Jank":return l;default:return m}}(e.jankTag,e.jankSeverityType)}}}e.ActualFramesTrack=y}}return fy}var hy,gy,my={};function _y(){if(!gy){gy=1,Object.defineProperty(dy,"__esModule",{value:!0}),dy.plugin=void 0;const c=ue(),u=ms(),d=Z(),f=py(),p=function(){if(!hy){hy=1,Object.defineProperty(my,"__esModule",{value:!0}),my.ExpectedFramesTrack=void 0;var e=_n(),t=M();const r=kl(),a=xs(),n=(0,t.makeColorScheme)(new e.HSLColor("#4CAF50"));class i extends r.NamedSliceTrack{trackIds;constructor(e,t,r,n){super({engine:e,trackKey:r}),this.trackIds=n,this.sliceLayout={...a.SLICE_LAYOUT_FIT_CONTENT_DEFAULTS,depthGuess:t}}getSqlSource(){return`
      SELECT
        ts,
        dur,
        layout_depth as depth,
        name,
        id
      from experimental_slice_layout
      where
        filter_track_ids = '${this.trackIds.join(",")}'
    `}rowToSlice(e){return{...this.rowToSliceBase(e),colorScheme:n}}getRowSpec(){return r.NAMED_ROW}}my.ExpectedFramesTrack=i}return my}();dy.plugin={pluginId:"perfetto.Frames",plugin:class{async onTraceLoad(e){this.addExpectedFrames(e),this.addActualFrames(e)}async addExpectedFrames(e){const t=e["engine"];for(var r=(await t.query(`
      select
        upid,
        t.name as trackName,
        t.track_ids as trackIds,
        process.name as processName,
        process.pid as pid,
        __max_layout_depth(t.track_count, t.track_ids) as maxDepth
      from _process_track_summary_by_upid_and_name t
      join process using(upid)
      where t.name = "Expected Timeline"
    `)).iter({upid:d.NUM,trackName:d.STR_NULL,trackIds:d.STR,processName:d.STR_NULL,pid:d.NUM_NULL,maxDepth:d.NUM});r.valid();r.next()){var n=r.upid,a=r.trackName;const s=r.trackIds.split(",").map(e=>Number(e));var i=r.processName,o=r.pid;const l=r.maxDepth;a=(0,u.getTrackName)({name:a,upid:n,pid:o,processName:i,kind:"ExpectedFrames"});e.registerTrack({uri:`/process_${n}/expected_frames`,title:a,trackFactory:({trackKey:e})=>new p.ExpectedFramesTrack(t,l,e,s),tags:{trackIds:s,upid:n,kind:c.EXPECTED_FRAMES_SLICE_TRACK_KIND}})}}async addActualFrames(e){const t=e["engine"];for(var r=(await t.query(`
      select
        upid,
        t.name as trackName,
        t.track_ids as trackIds,
        process.name as processName,
        process.pid as pid,
        __max_layout_depth(t.track_count, t.track_ids) as maxDepth
      from _process_track_summary_by_upid_and_name t
      join process using(upid)
      where t.name = "Actual Timeline"
    `)).iter({upid:d.NUM,trackName:d.STR_NULL,trackIds:d.STR,processName:d.STR_NULL,pid:d.NUM_NULL,maxDepth:d.NUM_NULL});r.valid();r.next()){var n=r.upid,a=r.trackName;const s=r.trackIds.split(",").map(e=>Number(e));var i=r.processName,o=r.pid;const l=r.maxDepth;null!==l&&(a=(0,u.getTrackName)({name:a,upid:n,pid:o,processName:i,kind:"ActualFrames"}),e.registerTrack({uri:`/process_${n}/actual_frames`,title:a,trackFactory:({trackKey:e})=>new f.ActualFramesTrack(t,l,e,s),tags:{upid:n,trackIds:s,kind:c.ACTUAL_FRAMES_SLICE_TRACK_KIND}}))}}}}}return dy}var yy,Ty={},by={},vy={},Ey={};function Sy(){if(!yy){yy=1,Object.defineProperty(Ey,"__esModule",{value:!0}),Ey.Checkbox=void 0;const o=or.__importDefault(ae()),s=Qs();Ey.Checkbox=class{view({attrs:e}){const{label:t,disabled:r,checked:n,className:a,...i}=e;e=(0,s.classNames)(r&&"pf-disabled",a);return(0,o.default)("label.pf-checkbox",{...i,className:e},(0,o.default)("input[type=checkbox]",{disabled:r,checked:n}),(0,o.default)("span"),t)}}}return Ey}var Ay,Oy,Cy,ky={};function wy(){if(!Ay){Ay=1,Object.defineProperty(ky,"__esModule",{value:!0}),ky.EmptyState=void 0;const a=or.__importDefault(ae());ky.EmptyState=class{view({attrs:e,children:t}){var{icon:e="search",title:r,className:n}=e;return(0,a.default)(".pf-empty-state",{className:n},(0,a.default)("i.material-icons",e),r&&(0,a.default)(".pf-empty-state-title",r),(0,a.default)(".pf-empty-state-content",t))}}}return ky}function Ry(){if(!Oy){Oy=1,Object.defineProperty(vy,"__esModule",{value:!0}),vy.PopupMultiSelect=vy.MultiSelect=void 0;const o=or.__importDefault(ae()),s=X(),l=le(),i=Sy(),c=wy(),u=bl(),d=Tl(),e=Oc();class f{searchText="";view({attrs:e}){var{options:t,fixedSize:r=!0}=e,t=t.filter(({name:e})=>e.toLowerCase().includes(this.searchText.toLowerCase()));return(0,o.default)(r?".pf-multiselect-panel.pf-multi-select-fixed-size":".pf-multiselect-panel",this.renderSearchBox(),this.renderListOfItems(e,t))}renderListOfItems(e,t){const{repeatCheckedItemsAtTop:r,onChange:n=()=>{}}=e;var a=t.every(({checked:e})=>e),i=t.some(({checked:e})=>e);return 0===t.length?(0,o.default)(c.EmptyState,{title:`No results for '${this.searchText}'`}):[(0,o.default)(".pf-list",r&&i&&(0,o.default)(".pf-multiselect-container",(0,o.default)(".pf-multiselect-header",(0,o.default)("span",""===this.searchText?"Selected":"Selected (Filtered)"),(0,o.default)(l.Button,{label:""===this.searchText?"Clear All":"Clear Filtered",icon:s.Icons.Deselect,onclick:()=>{var e=t.filter(({checked:e})=>e).map(({id:e})=>({id:e,checked:!1}));n(e),(0,d.scheduleFullRedraw)()},disabled:!i})),this.renderOptions(e,t.filter(({checked:e})=>e))),(0,o.default)(".pf-multiselect-container",(0,o.default)(".pf-multiselect-header",(0,o.default)("span",""===this.searchText?"Options":"Options (Filtered)"),(0,o.default)(l.Button,{label:""===this.searchText?"Select All":"Select Filtered",icon:s.Icons.SelectAll,compact:!0,onclick:()=>{var e=t.filter(({checked:e})=>!e).map(({id:e})=>({id:e,checked:!0}));n(e),(0,d.scheduleFullRedraw)()},disabled:a}),(0,o.default)(l.Button,{label:""===this.searchText?"Clear All":"Clear Filtered",icon:s.Icons.Deselect,compact:!0,onclick:()=>{var e=t.filter(({checked:e})=>e).map(({id:e})=>({id:e,checked:!1}));n(e),(0,d.scheduleFullRedraw)()},disabled:!i})),this.renderOptions(e,t)))]}renderSearchBox(){return(0,o.default)(".pf-search-bar",(0,o.default)(e.TextInput,{oninput:e=>{e=e.target;this.searchText=e.value,(0,d.scheduleFullRedraw)()},value:this.searchText,placeholder:"Filter options...",className:"pf-search-box"}),this.renderClearButton())}renderClearButton(){return""!=this.searchText?(0,o.default)(l.Button,{onclick:()=>{(this.searchText="",d.scheduleFullRedraw)()},label:"",icon:"close"}):null}renderOptions(e,t){const{onChange:a=()=>{}}=e;return t.map(e=>{const{checked:t,name:r,id:n}=e;return(0,o.default)(i.Checkbox,{label:r,key:n,checked:t,className:"pf-multiselect-item",onchange:()=>{a([{id:n,checked:!t}]),(0,d.scheduleFullRedraw)()}})})}}vy.MultiSelect=f;vy.PopupMultiSelect=class{view({attrs:e}){var{icon:t,popupPosition:r=u.PopupPosition.Auto,intent:n,compact:a}=e;return(0,o.default)(u.Popup,{trigger:(0,o.default)(l.Button,{label:this.labelText(e),icon:t,intent:n,compact:a}),position:r},(0,o.default)(f,e))}labelText(e){var{options:e,showNumSelected:t,label:r}=e;return t?r+` (${e.filter(({checked:e})=>e).length} selected)`:r}}}return vy}function Iy(){if(!Cy){Cy=1,Object.defineProperty(by,"__esModule",{value:!0}),by.FtraceExplorer=void 0;const s=or.__importDefault(ae()),u=K(),r=ne(),l=M(),t=F(),a=Ry(),i=bl(),d=oe(),c=x(),f=ue(),n=ie();var e=qa();const o=Qh(),p=le(),h=sg();by.FtraceExplorer=class{pagination={offset:0,count:0};monitor;queryLimiter=new e.AsyncLimiter;data;constructor({attrs:t}){this.monitor=new o.Monitor([()=>d.globals.timeline.visibleWindow.toTimeSpan().start,()=>d.globals.timeline.visibleWindow.toTimeSpan().end,()=>t.filterStore.state]),"blank"===t.cache.state&&(async function(e){var t=[],r=(await e.query(`
    select
      name,
      count(1) as cnt
    from ftrace_event
    group by name
    order by cnt desc
  `)).iter({name:f.STR,cnt:f.NUM});for(let e=0;r.valid();r.next(),e++)t.push({name:r.name,count:r.cnt});return t}(t.engine).then(e=>{t.cache.counters=e,t.cache.state="valid"}).catch(()=>{t.cache.state="blank"}),t.cache.state="loading")}view({attrs:r}){return this.monitor.ifStateChanged(()=>{this.reloadData(r)}),(0,s.default)(t.DetailsShell,{title:this.renderTitle(),buttons:this.renderFilterPanel(r),fillParent:!0},(0,s.default)(h.VirtualTable,{className:"pf-ftrace-explorer",columns:[{header:"ID",width:"5em"},{header:"Timestamp",width:"13em"},{header:"Name",width:"24em"},{header:"CPU",width:"3em"},{header:"Process",width:"24em"},{header:"Args",width:"200em"}],firstRowOffset:this.data?.offset??0,numRows:this.data?.numEvents??0,rowHeight:20,rows:this.renderData(),onReload:(e,t)=>{this.pagination={offset:e,count:t},this.reloadData(r)},onRowHover:this.onRowOver.bind(this),onRowOut:this.onRowOut.bind(this)}))}reloadData(e){this.queryLimiter.schedule(async()=>{this.data=await async function(e,t,r,n){var{start:a,end:i}=d.globals.timeline.visibleWindow.toTimeSpan(),n=n.excludeList,n=n.map(e=>`'${e}'`).join(",");let o=await e.query(`
    select count(id) as numEvents
    from ftrace_event
    where
      ftrace_event.name not in (${n}) and
      ts >= ${a} and ts <= ${i}
    `);var s=o.firstRow({numEvents:f.NUM})["numEvents"],l=(o=await e.query(`
    select
      ftrace_event.id as id,
      ftrace_event.ts as ts,
      ftrace_event.name as name,
      ftrace_event.cpu as cpu,
      thread.name as thread,
      process.name as process,
      to_ftrace(ftrace_event.id) as args
    from ftrace_event
    join thread using (utid)
    left join process on thread.upid = process.upid
    where
      ftrace_event.name not in (${n}) and
      ts >= ${a} and ts <= ${i}
    order by id
    limit ${r} offset ${t};`),[]),c=o.iter({id:f.NUM,ts:f.LONG,name:f.STR,cpu:f.NUM,thread:f.STR_NULL,process:f.STR_NULL,args:f.STR});for(let e=0;c.valid();c.next(),e++)l.push({id:c.id,ts:u.Time.fromRaw(c.ts),name:c.name,cpu:c.cpu,thread:c.thread,process:c.process,args:c.args});return{events:l,offset:t,numEvents:s}}(e.engine,this.pagination.offset,this.pagination.count,e.filterStore.state),n.raf.scheduleFullRedraw()})}renderData(){return this.data?this.data.events.map(e=>{var{ts:e,name:t,cpu:r,process:n,args:a,id:i}=e,e=(0,s.default)(c.Timestamp,{ts:e}),o=(0,l.colorForFtrace)(t).base.cssString;return{id:i,cells:[i,e,(0,s.default)(".pf-ftrace-namebox",(0,s.default)(".pf-ftrace-colorbox",{style:{background:o}}),t),r,n,a]}}):[]}onRowOver(t){var e=this.data?.events.find(e=>e.id===t);e&&d.globals.dispatch(r.Actions.setHoverCursorTimestamp({ts:e.ts}))}onRowOut(){d.globals.dispatch(r.Actions.setHoverCursorTimestamp({ts:u.Time.INVALID}))}renderTitle(){var e;return this.data?(e=this.data["numEvents"],`Ftrace Events (${e})`):"Ftrace Events"}renderFilterPanel(t){if("valid"!==t.cache.state)return(0,s.default)(p.Button,{label:"Filter",disabled:!0,loading:!0});const n=t.filterStore.state.excludeList;var e=t.cache.counters.map(({name:t,count:e})=>({id:t,name:t+` (${e})`,checked:!n.some(e=>e===t)}));return(0,s.default)(a.PopupMultiSelect,{label:"Filter",icon:"filter_list_alt",popupPosition:i.PopupPosition.Top,options:e,onChange:e=>{const r=new Set(n);e.forEach(({checked:e,id:t})=>{e?r.delete(t):r.add(t)}),t.filterStore.edit(e=>{e.excludeList=Array.from(r)})}})}}}return by}var My,Py,Ny={};function Dy(){if(!Py){Py=1,Object.defineProperty(Ty,"__esModule",{value:!0}),Ty.plugin=void 0;const s=or.__importDefault(ae()),l=Iy(),n=Z(),c=function(){if(!My){My=1,Object.defineProperty(Ny,"__esModule",{value:!0}),Ny.FtraceRawTrack=void 0;const l=K(),c=M(),s=mg();var e=vg();const u=Ps(),d=Z(),n=Qh();Ny.FtraceRawTrack=class{fetcher=new e.TimelineFetcher(this.onBoundsChange.bind(this));engine;cpu;store;monitor;constructor(e,t,r){this.engine=e,this.cpu=t,this.store=r,this.monitor=new n.Monitor([()=>r.state])}async onUpdate({visibleWindow:e,resolution:t}){this.monitor.ifStateChanged(()=>{this.fetcher.invalidate()}),await this.fetcher.requestData(e.toTimeSpan(),t)}async onDestroy(){this.fetcher[Symbol.dispose]()}getHeight(){return 22}async onBoundsChange(e,t,r){var n=Array.from(this.store.state.excludeList).map(e=>`'${e}'`).join(","),a=void 0===this.cpu?"":"and cpu = "+this.cpu,n=await this.engine.query(`
      select
        cast(ts / ${r} as integer) * ${r} as tsQuant,
        name
      from ftrace_event
      where
        name not in (${n}) and
        ts >= ${e} and ts <= ${t} ${a}
      group by tsQuant
      order by tsQuant limit ${s.LIMIT};`),a=n.numRows(),i={start:e,end:t,resolution:r,length:a,timestamps:new BigInt64Array(a),names:[]},o=n.iter({tsQuant:d.LONG,name:d.STR});for(let e=0;o.valid();o.next(),e++)i.timestamps[e]=o.tsQuant,i.names[e]=o.name;return i}render({ctx:t,size:e,timescale:r}){var n=this.fetcher.data;if(void 0!==n){var a=r.timeToPx(n.start),i=r.timeToPx(n.end),o=((0,u.checkerboardExcept)(t,this.getHeight(),0,e.width,a,i),18/Math.sqrt(2));for(let e=0;e<n.timestamps.length;e++){var s=n.names[e],s=(t.fillStyle=(0,c.colorForFtrace)(s).base.cssString,l.Time.fromRaw(n.timestamps[e])),s=Math.floor(r.timeToPx(s));t.save(),t.translate(s,2),t.rotate(Math.PI/4),t.fillRect(0,0,o,o),t.restore()}}}}}return Ny}();var e=V();const u={version:1,filter:{excludeList:[]}};Ty.plugin={pluginId:"perfetto.FtraceRaw",plugin:class{trash=new e.DisposableStack;async onTraceLoad(e){var t=e.mountStore(e=>"object"==typeof e&&null!==e&&"version"in e&&1===e.version?e:u);this.trash.use(t);const r=t.createSubStore(["filter"],e=>e);this.trash.use(r);for(const o of await this.lookupCpuCores(e.engine)){var n="/ftrace/cpu"+o;e.registerStaticTrack({uri:n,groupName:"Ftrace Events",title:"Ftrace Track for CPU "+o,tags:{cpu:o},trackFactory:()=>new c.FtraceRawTrack(e.engine,o,r)})}const a={state:"blank",counters:[]},i="perfetto.FtraceRaw#FtraceEventsTab";e.registerTab({uri:i,isEphemeral:!1,content:{render:()=>(0,s.default)(l.FtraceExplorer,{filterStore:r,cache:a,engine:e.engine}),getTitle:()=>"Ftrace Events"}}),e.registerCommand({id:"perfetto.FtraceRaw#ShowFtraceTab",name:"Show ftrace tab",callback:()=>{e.tabs.showTab(i)}})}async onTraceUnload(){this.trash[Symbol.dispose]()}async lookupCpuCores(e){for(var t=(await e.query("select distinct cpu from ftrace_event order by cpu")).iter({cpu:n.NUM}),r=[];t.valid();t.next())r.push(t.cpu);return r}}}}return Ty}var xy,Ly={},Fy={},Uy={};function By(){if(!xy){xy=1;{var t=Uy;Object.defineProperty(t,"__esModule",{value:!0}),t.SHOW_HEAP_GRAPH_DOMINATOR_TREE_FLAG=t.FlamegraphViewingOption=void 0,t.viewingOptions=a,t.defaultViewingOption=function(e){return a(e)[0].option},t.expandCallsites=function(t,r){if(-1===r)return t;var n=[];if(!(r>=t.length||r<-1)){var a=t[r];n.unshift(a);let e=a.parentId;for(;-1<e;)n.unshift(t[e]),e=t[e].parentId;var i=[];i.push(r);for(let e=r+1;e<t.length;e++){var o=t[e];i.includes(o.parentId)&&(n.push(o),i.push(o.id))}}return n},t.mergeCallsites=function(a,i){var e=[],o=new Map;for(let n=0;n<a.length;n++)if(!o.has(a[n].id)){var s=function(e){return{id:e.id,parentId:e.parentId,depth:e.depth,name:e.name,totalSize:e.totalSize,mapping:e.mapping,selfSize:e.selfSize,merged:e.merged,highlighted:e.highlighted,location:e.location}}(a[n]);s.parentId=l(s,o);let r=!1;if(s.totalSize<=i&&n+1<a.length){let e=n+1,t=a[e];for(;e<a.length&&s.depth===t.depth;)s.parentId===l(t,o)&&t.totalSize<=i&&(s.totalSize+=t.totalSize,o.set(t.id,s.id),r=!0),e++,t=a[e];r&&(s.name="[merged]",s.merged=!0)}e.push(s)}return e},t.findRootSize=function(e){let t=0,r=0;for(;r<e.length&&0===e[r].depth;)t+=e[r].totalSize,r++;return t};var r,e,n=re();const i=Y();function a(e){switch(e){case i.ProfileType.PERF_SAMPLE:return[{option:r.PERF_SAMPLES_KEY,name:"Samples"}];case i.ProfileType.JAVA_HEAP_GRAPH:return[{option:r.SPACE_MEMORY_ALLOCATED_NOT_FREED_KEY,name:"Size"},{option:r.OBJECTS_ALLOCATED_NOT_FREED_KEY,name:"Objects"}].concat(t.SHOW_HEAP_GRAPH_DOMINATOR_TREE_FLAG.get()?[{option:r.DOMINATOR_TREE_OBJ_SIZE_KEY,name:"Dominated size"},{option:r.DOMINATOR_TREE_OBJ_COUNT_KEY,name:"Dominated objects"}]:[]);case i.ProfileType.HEAP_PROFILE:return[{option:r.SPACE_MEMORY_ALLOCATED_NOT_FREED_KEY,name:"Unreleased size"},{option:r.OBJECTS_ALLOCATED_NOT_FREED_KEY,name:"Unreleased count"},{option:r.ALLOC_SPACE_MEMORY_ALLOCATED_KEY,name:"Total size"},{option:r.OBJECTS_ALLOCATED_KEY,name:"Total count"}];case i.ProfileType.NATIVE_HEAP_PROFILE:return[{option:r.SPACE_MEMORY_ALLOCATED_NOT_FREED_KEY,name:"Unreleased malloc size"},{option:r.OBJECTS_ALLOCATED_NOT_FREED_KEY,name:"Unreleased malloc count"},{option:r.ALLOC_SPACE_MEMORY_ALLOCATED_KEY,name:"Total malloc size"},{option:r.OBJECTS_ALLOCATED_KEY,name:"Total malloc count"}];case i.ProfileType.JAVA_HEAP_SAMPLES:return[{option:r.ALLOC_SPACE_MEMORY_ALLOCATED_KEY,name:"Total allocation size"},{option:r.OBJECTS_ALLOCATED_KEY,name:"Total allocation count"}];case i.ProfileType.MIXED_HEAP_PROFILE:return[{option:r.ALLOC_SPACE_MEMORY_ALLOCATED_KEY,name:"Total allocation size (malloc + java)"},{option:r.OBJECTS_ALLOCATED_KEY,name:"Total allocation count (malloc + java)"}];default:throw new Error("Unhandled case: "+e)}}function l(e,t){return t.has(e.parentId)?+t.get(e.parentId):e.parentId}(e=r||(t.FlamegraphViewingOption=r={})).SPACE_MEMORY_ALLOCATED_NOT_FREED_KEY="SPACE",e.ALLOC_SPACE_MEMORY_ALLOCATED_KEY="ALLOC_SPACE",e.OBJECTS_ALLOCATED_NOT_FREED_KEY="OBJECTS",e.OBJECTS_ALLOCATED_KEY="ALLOC_OBJECTS",e.PERF_SAMPLES_KEY="PERF_SAMPLES",e.DOMINATOR_TREE_OBJ_SIZE_KEY="DOMINATED_OBJ_SIZE",e.DOMINATOR_TREE_OBJ_COUNT_KEY="DOMINATED_OBJ_COUNT",t.SHOW_HEAP_GRAPH_DOMINATOR_TREE_FLAG=n.featureFlags.register({id:"showHeapGraphDominatorTree",name:"Show heap graph dominator tree",description:"Show dominated size and objects tabs in Java heap graph view.",defaultValue:!0})}}return Uy}var jy,Hy={};function Gy(){if(!jy){jy=1,Object.defineProperty(Hy,"__esModule",{value:!0}),Hy.Flamegraph=Hy.FLAMEGRAPH_HOVERED_COLOR=void 0,Hy.findRootSize=n,Hy.splitIfTooBig=a;const r=Wf(),y=J();Hy.FLAMEGRAPH_HOVERED_COLOR="hsl(224, 45%, 55%)";function n(e){let t=0,r=0;for(;r<e.length&&0===e[r].depth;)t+=e[r].totalSize,r++;return t}function a(e,t,r){if(""===e)return{lineWidth:r,lines:[]};for(var n=[],a=r/e.length,i=Math.trunc((t-32)/a);0<e.length;)n.push(e.slice(0,i)),e=e.slice(i);return{lineWidth:r=Math.min(i*a,r),lines:n}}Hy.Flamegraph=class{nodeRendering={};flamegraphData;highlightSomeNodes=!1;maxDepth=-1;totalSize=-1;labelCharWidth=0;labelFontStyle="12px Roboto Mono";rolloverFontStyle="12px Roboto Condensed";graphData=new Map;xStartsPerDepth=new Map;hoveredX=-1;hoveredY=-1;hoveredCallsite;clickedCallsite;startingY=0;constructor(e){this.flamegraphData=e,this.findMaxDepth()}findMaxDepth(){this.maxDepth=Math.max(...this.flamegraphData.map(e=>e.depth))}highlightingExists(){this.highlightSomeNodes=this.flamegraphData.some(e=>e.highlighted)}generateColor(t,e=!1,r){if(e)return"#d9d9d9";if("unknown"===t||"root"===t)return"#c0c0c0";let n=0;for(let e=0;e<t.length;e+=1)n+=t.charCodeAt(e)%64;n%=360;let a="76";return this.highlightSomeNodes&&!r&&(a="90"),`hsl(${n}deg, 45%, ${a}%)`}updateDataIfChanged(e,t,r){this.nodeRendering=e,this.clickedCallsite=r,this.flamegraphData!==t&&(this.flamegraphData=t,this.clickedCallsite=r,this.findMaxDepth(),this.highlightingExists(),this.totalSize=n(t))}draw(n,a,i,o=0,r=0,s="B"){if(void 0!==this.flamegraphData){n.font=this.labelFontStyle,n.textBaseline="middle",0===this.labelCharWidth&&(this.labelCharWidth=n.measureText("_").width),this.startingY=r;var l=new Map;let t=r;l.set(-1,{width:a,nextXForChildren:o,size:this.totalSize,x:o}),this.graphData=new Map,this.xStartsPerDepth=new Map,n.fillStyle=this.generateColor("root",!1,!1),n.fillRect(o,t,a,17);var c=(0,y.cropText)("root: "+this.displaySize(this.totalSize,s,"B"===s?1024:1e3),this.labelCharWidth,a-2);n.fillStyle="black",n.fillText(c,o+5,t+8.5),t+=18,n.strokeStyle="white",n.lineWidth=.5;for(let e=0;e<this.flamegraphData.length&&!(t>i);e++){var u=this.flamegraphData[e],d=l.get(u.parentId);if(void 0!==d){var f=void 0!==this.clickedCallsite,p=f&&u.depth<=this.clickedCallsite.depth,f=f&&u.depth<this.clickedCallsite.depth,h=-1===u.parentId?this.totalSize:d.size;const a=(p?1:u.totalSize/h)*d.width;p=d.nextXForChildren,h=(t=r+18*(u.depth+1),this.getCallsiteName(u)),f=(n.fillStyle=this.generateColor(h,f,u.highlighted),n.fillRect(p,t,a,17),l.set(u.id,{width:a,nextXForChildren:p,size:u.totalSize,x:p}),l.set(u.parentId,{width:d.width,nextXForChildren:p+a,size:d.size,x:d.x}),a-10);let e=(0,y.cropText)(h,this.labelCharWidth,f);1.2*e.length>h.length&&(e=h),n.fillStyle="black",n.fillText(e,p+5,t+8.5,f),n.beginPath(),n.moveTo(p+a,t),n.lineTo(p+a,t+18),n.stroke(),this.graphData.set(u.depth+";"+p,{callsite:u,width:a});d=this.xStartsPerDepth.get(u.depth);void 0===d?this.xStartsPerDepth.set(u.depth,[p]):d.push(p)}}if(-1<this.hoveredX&&-1<this.hoveredY&&this.hoveredCallsite){n.font=this.rolloverFontStyle,n.textBaseline="top";var g=[];let e=this.addToTooltip(this.getCallsiteName(this.hoveredCallsite),a-8,n,g);null!=this.hoveredCallsite.location&&(e=Math.max(e,this.addToTooltip(this.hoveredCallsite.location,a,n,g))),e=Math.max(e,this.addToTooltip(this.hoveredCallsite.mapping,a,n,g)),void 0!==this.nodeRendering.totalSize&&(c=this.hoveredCallsite.totalSize/this.totalSize*100,o=`${this.nodeRendering.totalSize}: ${this.displaySize(this.hoveredCallsite.totalSize,s,"B"===s?1024:1e3)} (${c.toFixed(2)}%)`,e=Math.max(e,this.addToTooltip(o,a,n,g))),void 0!==this.nodeRendering.selfSize&&0<this.hoveredCallsite.selfSize&&(c=this.hoveredCallsite.selfSize/this.totalSize*100,o=`${this.nodeRendering.selfSize}: ${this.displaySize(this.hoveredCallsite.selfSize,s,"B"===s?1024:1e3)} (${c.toFixed(2)}%)`,e=Math.max(e,this.addToTooltip(o,a,n,g)));var s=n.measureText("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),m=Math.round(1.5*s.actualBoundingBoxDescent),c=e+16,o=m*g.length+16;let t=this.hoveredX+4,r=this.hoveredY+4;t+c>a&&(t=a-c),r+o>i&&(r=i-o),n.fillStyle="rgba(255, 255, 255, 0.9)",n.fillRect(t,r,c,o),n.fillStyle="hsl(200, 50%, 40%)",n.textAlign="left";for(let e=0;e<g.length;e++){var _=g[e];n.fillText(_,t+8,r+8+e*m)}}}}addToTooltip(e,t,r,n){t=a(e,t,r.measureText(e).width);return n.push(...t.lines),t.lineWidth}getCallsiteName(e){return void 0===e.name||""===e.name?"unknown":e.name}displaySize(e,t,r=1024){var n,a;return""===t?e.toLocaleString():0===e?"0 "+t:(n=[["",1],["K",r],["M",Math.pow(r,2)],["G",Math.pow(r,3)]],r=Math.trunc(Math.log(e)/Math.log(r)),a=e/+n[r=n.length-1<r?n.length-1:r][1],(e%+n[r][1]==0?a.toString():a.toFixed(2))+" "+n[r][0]+t)}onMouseMove({x:e,y:t}){this.hoveredX=e,this.hoveredY=t,this.hoveredCallsite=this.findSelectedCallsite(e,t);e=void 0!==this.hoveredCallsite;return e||this.onMouseOut(),e}onMouseOut(){this.hoveredX=-1,this.hoveredY=-1,this.hoveredCallsite=void 0}onMouseClick({x:e,y:t}){e=this.findSelectedCallsite(e,t);if(void 0!==e&&!e.merged)return e}findSelectedCallsite(e,t){t=Math.trunc((t-this.startingY)/18)-1;if(0<=t&&this.xStartsPerDepth.has(t)){var r=this.searchSmallest(this.xStartsPerDepth.get(t),e),t=this.graphData.get(t+";"+r);if(void 0!==t)return e<=r+t.width?t.callsite:void 0}}searchSmallest(e,t){e=e.sort((e,t)=>e-t);var[t]=(0,r.searchSegment)(e,t);return-1===t?-1:e[t]}getHeight(){return 0===this.flamegraphData.length?0:18*(this.maxDepth+2)}}}return Hy}var Vy,Wy={},qy={};function $y(){return Vy||(Vy=1,Object.defineProperty(qy,"__esModule",{value:!0}),qy.TRACE_SUFFIX=void 0,qy.TRACE_SUFFIX=".perfetto-trace"),qy}var zy,Ky={};function Yy(){if(!zy){zy=1,Object.defineProperty(Ky,"__esModule",{value:!0}),Ky.Animation=void 0;const r=ie();Ky.Animation=class{onAnimationStep;startMs=0;endMs=0;boundOnAnimationFrame=this.onAnimationFrame.bind(this);constructor(e){this.onAnimationStep=e}start(e){var t=performance.now();t<=this.endMs?this.endMs=t+e:(this.startMs=t,this.endMs=t+e,r.raf.start(this.boundOnAnimationFrame))}stop(){this.endMs=0,r.raf.stop(this.boundOnAnimationFrame)}get startTimeMs(){return this.startMs}onAnimationFrame(e){e>=this.endMs?r.raf.stop(this.boundOnAnimationFrame):this.onAnimationStep(Math.max(Math.round(e-this.startMs),0))}}}return Ky}var Jy,Zy={},Qy={};var Xy,eT,tT={},rT={};function nT(){if(!Xy){Xy=1,Object.defineProperty(rT,"__esModule",{value:!0}),rT.DragGestureHandler=void 0;class e{element;onDrag;onDragStarted;onDragFinished;boundOnMouseDown=this.onMouseDown.bind(this);boundOnMouseMove=this.onMouseMove.bind(this);boundOnMouseUp=this.onMouseUp.bind(this);clientRect;pendingMouseDownEvent;_isDragging=!1;constructor(e,t,r=()=>{},n=()=>{}){this.element=e,this.onDrag=t,this.onDragStarted=r,this.onDragFinished=n,e.addEventListener("mousedown",this.boundOnMouseDown)}onMouseDown(e){this._isDragging=!0,document.body.addEventListener("mousemove",this.boundOnMouseMove),document.body.addEventListener("mouseup",this.boundOnMouseUp),this.pendingMouseDownEvent=e}startDragGesture(e){this.clientRect=this.element.getBoundingClientRect(),this.onDragStarted(e.clientX-this.clientRect.left,e.clientY-this.clientRect.top)}onMouseMove(e){if(0===e.buttons)return this.onMouseUp();this.pendingMouseDownEvent&&(1<Math.abs(e.clientX-this.pendingMouseDownEvent.clientX)||1<Math.abs(e.clientY-this.pendingMouseDownEvent.clientY))&&(this.startDragGesture(this.pendingMouseDownEvent),this.pendingMouseDownEvent=void 0),this.pendingMouseDownEvent||this.onDrag(e.clientX-this.clientRect.left,e.clientY-this.clientRect.top)}onMouseUp(){this._isDragging=!1,document.body.removeEventListener("mousemove",this.boundOnMouseMove),document.body.removeEventListener("mouseup",this.boundOnMouseUp),this.pendingMouseDownEvent||this.onDragFinished()}get isDragging(){return this._isDragging}[Symbol.dispose](){this._isDragging&&this.onMouseUp(),document.body.removeEventListener("mousedown",this.boundOnMouseDown),document.body.removeEventListener("mousemove",this.boundOnMouseMove),document.body.removeEventListener("mouseup",this.boundOnMouseUp)}}rT.DragGestureHandler=e}return rT}function aT(){if(!eT){eT=1,Object.defineProperty(tT,"__esModule",{value:!0}),tT.PanAndZoomHandler=tT.KeyMapping=void 0;const u=V(),s=hl(),l=ie();var t,r,n,e,a=Yy();const d=nT(),f="default";(e=t||(tT.KeyMapping=t={})).KEY_PAN_LEFT="KeyA",e.KEY_PAN_RIGHT="KeyD",e.KEY_ZOOM_IN="KeyW",e.KEY_ZOOM_OUT="KeyS",(e=r=r||{})[e.None=0]="None",e[e.Left=-1]="Left",e[e.Right=1]="Right",(e=n=n||{})[e.None=0]="None",e[e.In=1]="In",e[e.Out=-1]="Out";class c{mousePositionX=null;boundOnMouseMove=this.onMouseMove.bind(this);boundOnWheel=this.onWheel.bind(this);boundOnKeyDown=this.onKeyDown.bind(this);boundOnKeyUp=this.onKeyUp.bind(this);shiftDown=!1;panning=r.None;panOffsetPx=0;targetPanOffsetPx=0;zooming=n.None;zoomRatio=0;targetZoomRatio=0;panAnimation=new a.Animation(this.onPanAnimationStep.bind(this));zoomAnimation=new a.Animation(this.onZoomAnimationStep.bind(this));element;onPanned;onZoomed;editSelection;onSelection;endSelection;trash;constructor({element:e,onPanned:t,onZoomed:r,editSelection:n,onSelection:a,endSelection:i}){this.element=e,this.onPanned=t,this.onZoomed=r,this.editSelection=n,this.onSelection=a,this.endSelection=i,this.trash=new u.DisposableStack,document.body.addEventListener("keydown",this.boundOnKeyDown),document.body.addEventListener("keyup",this.boundOnKeyUp),this.element.addEventListener("mousemove",this.boundOnMouseMove),this.element.addEventListener("wheel",this.boundOnWheel,{passive:!0}),this.trash.defer(()=>{this.element.removeEventListener("wheel",this.boundOnWheel),this.element.removeEventListener("mousemove",this.boundOnMouseMove),document.body.removeEventListener("keyup",this.boundOnKeyUp),document.body.removeEventListener("keydown",this.boundOnKeyDown)});let o=-1,s=-1,l=-1,c=!1;this.trash.use(new d.DragGestureHandler(this.element,(e,t)=>{this.shiftDown?this.onPanned(o-e):this.onSelection(s,l,o,e,t,c),o=e},(e,t)=>{o=e,s=e,l=t,(c=this.editSelection(e))?this.element.style.cursor="ew-resize":this.shiftDown||(this.element.style.cursor=f)},()=>{this.element.style.cursor=this.shiftDown?"move":f,s=-1,l=-1,this.endSelection(c)}))}[Symbol.dispose](){this.trash.dispose()}onPanAnimationStep(e){var t=.4*(this.targetPanOffsetPx-this.panOffsetPx);this.panning!==r.None&&(e=Math.max(8*(1+.02*e),t),this.targetPanOffsetPx+=this.panning*e),this.panOffsetPx+=t,.1<Math.abs(t)?this.onPanned(t):this.panAnimation.stop()}onZoomAnimationStep(e){var t;null!==this.mousePositionX&&(t=.4*(this.targetZoomRatio-this.zoomRatio),this.zooming!==n.None&&(e=Math.max(.008*(1+.02*e),t),this.targetZoomRatio+=this.zooming*e),this.zoomRatio+=t,1e-6<Math.abs(t)?this.onZoomed(this.mousePositionX,t):this.zoomAnimation.stop())}onMouseMove(e){this.mousePositionX=(0,s.currentTargetOffset)(e).x,0===e.buttons&&(this.editSelection(this.mousePositionX)?this.element.style.cursor="ew-resize":this.element.style.cursor=this.shiftDown?"move":f)}onWheel(e){Math.abs(e.deltaX)>Math.abs(e.deltaY)?(this.onPanned(+e.deltaX),l.raf.scheduleRedraw()):e.ctrlKey&&null!==this.mousePositionX&&(e=(e.deltaY<0?-1:1)*Math.log2(1+Math.abs(e.deltaY)),this.onZoomed(this.mousePositionX,-.02*e),l.raf.scheduleRedraw())}onKeyDown(e){e instanceof KeyboardEvent&&((0,s.elementIsEditable)(e.target)||(this.updateShift(e.shiftKey),e.ctrlKey)||e.metaKey||(i(e)!==r.None&&(this.panning!==i(e)&&(this.panAnimation.stop(),this.panOffsetPx=0,this.targetPanOffsetPx=50*i(e)),this.panning=i(e),this.panAnimation.start(700)),o(e)!==n.None&&(this.zooming!==o(e)&&(this.zoomAnimation.stop(),this.zoomRatio=0,this.targetZoomRatio=.1*o(e)),this.zooming=o(e),this.zoomAnimation.start(700))))}onKeyUp(e){e instanceof KeyboardEvent&&(this.updateShift(e.shiftKey),e.ctrlKey||e.metaKey||(i(e)===this.panning&&(this.panning=r.None),o(e)===this.zooming&&(this.zooming=n.None)))}updateShift(e){e!==this.shiftDown&&(this.shiftDown=e,this.shiftDown?this.element.style.cursor="move":null!==this.mousePositionX&&(this.element.style.cursor=f))}}function i(e){return e.code===t.KEY_PAN_LEFT?r.Left:e.code===t.KEY_PAN_RIGHT?r.Right:r.None}function o(e){return e.code===t.KEY_ZOOM_IN?n.In:e.code===t.KEY_ZOOM_OUT?n.Out:n.None}tT.PanAndZoomHandler=c}return tT}var iT,oT,sT,lT={},cT={};function uT(){if(!iT){iT=1,Object.defineProperty(cT,"__esModule",{value:!0}),cT.parseHotkey=o,cT.formatHotkey=function(e,t){e=o(e);return e&&function({modifier:e,key:t},r){return""+function(e,t){t=t||u(),t="Mac"===t?n:a;return t.get(e)??e}(e,r)+t}(e,t)},cT.checkHotkey=function(e,t,r){e=o(e);if(!e)return!1;var{key:n,allowInEditable:a}=e,{target:i=null}=t,i=(0,s.elementIsEditable)(i);return!(i&&!a)&&function(e,t){return e.key.toLowerCase()===t.toLowerCase()}(t,n)&&function(e,t,r){var r=r??u(),{key:t,modifier:n}=t,{ctrlKey:e=!1,altKey:a=!1,shiftKey:i=!1,metaKey:o=!1}=e,s=n.includes("Shift"),l=n.includes("Alt"),c="Mac"===r?n.includes("Ctrl"):n.includes("Ctrl")||n.includes("Mod"),r="Mac"===r&&n.includes("Mod"),n=d.includes(t)||i===s;return o===r&&Boolean(n)&&a===l&&e===c}(t,e,r)},cT.getPlatform=u;const s=hl(),d=["0","1","2","3","4","5","6","7","8","9","/","?","!","[","]"],n=new Map([["",""],["Mod+","⌘"],["Shift+","⇧"],["Ctrl+","⌃"],["Alt+","⌥"],["Mod+Shift+","⌘⇧"],["Mod+Alt+","⌘⌥"],["Mod+Shift+Alt+","⌘⇧⌥"],["Ctrl+Shift+","⌃⇧"],["Ctrl+Alt","⌃⌥"],["Ctrl+Shift+Alt","⌃⇧⌥"]]),a=new Map([["",""],["Mod+","Ctrl+"],["Mod+Shift+","Ctrl+Shift+"],["Mod+Alt+","Ctrl+Alt+"],["Mod+Shift+Alt+","Ctrl+Shift+Alt+"]]);function o(e){e=e.match(/^(!?)((?:Mod\+|Shift\+|Alt\+|Ctrl\+)*)(.*)$/);if(e)return{allowInEditable:"!"===e[1],modifier:e[2],key:e[3]}}function u(){return-1!==window.navigator.platform.indexOf("Mac")?"Mac":"PC"}}return cT}function dT(){if(!oT){oT=1,Object.defineProperty(lT,"__esModule",{value:!0}),lT.KeycapGlyph=lT.HotkeyGlyphs=void 0;const s=or.__importDefault(ae()),l=uT(),c=al();lT.HotkeyGlyphs=class{view({attrs:e}){var t,r,n,a,{hotkey:e,spoof:i}=e,i=i||(0,l.getPlatform)(),e=(0,l.parseHotkey)(e);return e?({key:e,modifier:a}=e,t=a.includes("Mod"),r=a.includes("Ctrl"),n=a.includes("Alt"),a=a.includes("Shift"),(0,s.default)("span.pf-hotkey",t&&(0,s.default)("span.pf-keycap","Mac"===i?(0,s.default)(c.Icon,{icon:"keyboard_command_key"}):"Ctrl"),r&&(0,s.default)("span.pf-keycap","Mac"===i?(0,s.default)(c.Icon,{icon:"keyboard_control_key"}):"Ctrl"),n&&(0,s.default)("span.pf-keycap","Mac"===i?(0,s.default)(c.Icon,{icon:"keyboard_option_key"}):"Alt"),a&&(0,s.default)("span.pf-keycap",(0,s.default)(c.Icon,{icon:"shift"})),(0,s.default)("span.pf-keycap",o(e,i)))):(0,s.default)("span.pf-keycap","???")}};function o(e,t){return"Enter"===e?(0,s.default)(c.Icon,{icon:"keyboard_return"}):"ArrowUp"===e?(0,s.default)(c.Icon,{icon:"arrow_upward"}):"ArrowDown"===e?(0,s.default)(c.Icon,{icon:"arrow_downward"}):"Space"===e?(0,s.default)(c.Icon,{icon:"space_bar"}):"Escape"===e?"Mac"===t?"esc":"Esc":e}lT.KeycapGlyph=class{view({attrs:e}){var{keyValue:e,spoof:t}=e,t=t||(0,l.getPlatform)();return(0,s.default)("span.pf-keycap",o(e,t))}}}return lT}function fT(){if(!sT){sT=1,Object.defineProperty(Zy,"__esModule",{value:!0}),Zy.toggleHelp=function(){i.globals.logging.logEvent("User Actions","Show help"),(0,e.showModal)({title:"Perfetto Help",content:()=>(0,n.default)(d),buttons:[]})};const n=or.__importDefault(ae()),t=ie(),e=de(),a=$l(),i=oe(),o=function(){if(!Jy){Jy=1,Object.defineProperty(Qy,"__esModule",{value:!0}),Qy.NotSupportedError=void 0,Qy.nativeKeyboardLayoutMap=async function(){{if("keyboard"in window.navigator)return window.navigator.keyboard.getLayoutMap();throw new e("Keyboard API is not supported")}};class e extends Error{}Qy.NotSupportedError=e}return Qy}(),s=aT(),l=dT(),c=ee();class u{get(e){return e.replace(/^Key([A-Z])$/,"$1").toLowerCase()}}class d{keyMap;oninit(){(0,o.nativeKeyboardLayoutMap)().then(e=>{this.keyMap=e,t.raf.scheduleFullRedraw()}).catch(e=>{if(!(e instanceof o.NotSupportedError||String(e).includes("SecurityError")))throw e;this.keyMap=new u,t.raf.scheduleFullRedraw()})}view(e){var t=i.globals.hideSidebar?[]:[(0,n.default)("h2","Making SQL queries from the query page"),(0,n.default)("table",(0,n.default)("tr",(0,n.default)("td",r("Ctrl")," + ",r("Enter")),(0,n.default)("td","Execute query")),(0,n.default)("tr",(0,n.default)("td",r("Ctrl")," + ",r("Enter")," (with selection)"),(0,n.default)("td","Execute selection")))];return(0,n.default)(".help",(0,n.default)("h2","Navigation"),(0,n.default)("table",(0,n.default)("tr",(0,n.default)("td",this.codeToKeycap(s.KeyMapping.KEY_ZOOM_IN),"/",this.codeToKeycap(s.KeyMapping.KEY_ZOOM_OUT)),(0,n.default)("td","Zoom in/out")),(0,n.default)("tr",(0,n.default)("td",this.codeToKeycap(s.KeyMapping.KEY_PAN_LEFT),"/",this.codeToKeycap(s.KeyMapping.KEY_PAN_RIGHT)),(0,n.default)("td","Pan left/right"))),(0,n.default)("h2","Mouse Controls"),(0,n.default)("table",(0,n.default)("tr",(0,n.default)("td","Click"),(0,n.default)("td","Select event")),(0,n.default)("tr",(0,n.default)("td","Ctrl + Scroll wheel"),(0,n.default)("td","Zoom in/out")),(0,n.default)("tr",(0,n.default)("td","Click + Drag"),(0,n.default)("td","Select area")),(0,n.default)("tr",(0,n.default)("td","Shift + Click + Drag"),(0,n.default)("td","Pan left/right"))),(0,n.default)("h2","Running commands from the viewer page"),(0,n.default)("table",(0,n.default)("tr",(0,n.default)("td",r(">")," in the (empty) search box"),(0,n.default)("td","Switch to command mode"))),(0,n.default)("h2","Making SQL queries from the viewer page"),(0,n.default)("table",(0,n.default)("tr",(0,n.default)("td",r(":")," in the (empty) search box"),(0,n.default)("td","Switch to query mode")),(0,n.default)("tr",(0,n.default)("td",r("Enter")),(0,n.default)("td","Execute query")),(0,n.default)("tr",(0,n.default)("td",r("Ctrl")," + ",r("Enter")),(0,n.default)("td","Execute query and pin output (output will not be replaced by regular query input)"))),...t,(0,n.default)("h2","Command Hotkeys"),(0,n.default)("table",i.globals.commandManager.commands.filter(({defaultHotkey:e})=>e).sort((e,t)=>e.name.localeCompare(t.name)).map(({defaultHotkey:e,name:t})=>(0,n.default)("tr",(0,n.default)("td",(0,n.default)(l.HotkeyGlyphs,{hotkey:(0,c.assertExists)(e)})),(0,n.default)("td",t)))))}codeToKeycap(e){return this.keyMap?r(this.keyMap.get(e)):r((0,n.default)(a.Spinner))}}function r(e){return(0,n.default)(".keycap",e)}}return Zy}var pT,hT,gT={},mT={},_T={},yT={};function TT(){if(!pT){pT=1,Object.defineProperty(yT,"__esModule",{value:!0}),yT.APP_STATE_SCHEMA=yT.SERIALIZED_STATE_VERSION=void 0;var e=ra();const i=K();yT.SERIALIZED_STATE_VERSION=1;var t=e.z.string().regex(/[-]?\d+/).transform(e=>i.Time.fromRaw(BigInt(e))),r=e.z.discriminatedUnion("kind",[e.z.object({kind:e.z.literal("TRACK_EVENT"),trackKey:e.z.string(),eventId:e.z.string()}),e.z.object({kind:e.z.literal("LEGACY_SLICE"),id:e.z.number()}),e.z.object({kind:e.z.literal("LEGACY_SCHED_SLICE"),id:e.z.number()}),e.z.object({kind:e.z.literal("LEGACY_THREAD_STATE"),id:e.z.number()}),e.z.object({kind:e.z.literal("LEGACY_HEAP_PROFILE"),id:e.z.number(),upid:e.z.number(),ts:t,type:e.z.string()})]),n=e.z.object({id:e.z.string(),start:t,color:e.z.string(),text:e.z.string()}).and(e.z.discriminatedUnion("noteType",[e.z.object({noteType:e.z.literal("DEFAULT")}),e.z.object({noteType:e.z.literal("SPAN"),end:t})])),a=e.z.object({id:e.z.string(),state:e.z.any()});yT.APP_STATE_SCHEMA=e.z.object({version:e.z.number(),pinnedTracks:e.z.array(e.z.string()).default([]),viewport:e.z.object({start:t,end:t}).optional(),selection:e.z.array(r).default([]),notes:e.z.array(n).default([]),plugins:e.z.array(a).default([])})}return yT}function bT(){if(!hT){hT=1,Object.defineProperty(_T,"__esModule",{value:!0}),_T.serializeAppState=function(){var e=c.globals.timeline.visibleWindow.toTimeSpan(),t=new Array;for(var[r,n]of Object.entries(c.globals.state.notes))"DEFAULT"===n.noteType?t.push({noteType:"DEFAULT",id:r,start:n.timestamp,color:n.color,text:n.text}):"SPAN"===n.noteType&&t.push({noteType:"SPAN",id:r,start:n.start,end:n.end,color:n.color,text:n.text});var a=new Array,i=c.globals.state.selection;if("single"===i.kind)a.push({kind:"TRACK_EVENT",trackKey:i.trackKey,eventId:i.eventId.toString()});else if("legacy"===i.kind)switch(i.legacySelection.kind){case"SLICE":a.push({kind:"LEGACY_SLICE",id:i.legacySelection.id});break;case"SCHED_SLICE":a.push({kind:"LEGACY_SCHED_SLICE",id:i.legacySelection.id});break;case"THREAD_STATE":a.push({kind:"LEGACY_THREAD_STATE",id:i.legacySelection.id});break;case"HEAP_PROFILE":a.push({kind:"LEGACY_HEAP_PROFILE",id:i.legacySelection.id,upid:i.legacySelection.upid,ts:i.legacySelection.ts,type:i.legacySelection.type})}var o=new Array;for(var[s,l]of Object.entries(c.globals.state.plugins))o.push({id:s,state:l});return{version:u.SERIALIZED_STATE_VERSION,pinnedTracks:c.globals.state.pinnedTracks,viewport:{start:e.start,end:e.end},notes:t,selection:a,plugins:o}},_T.parseAppState=function(e){e=u.APP_STATE_SCHEMA.safeParse(e);if(e.success)return e.data.version==u.SERIALIZED_STATE_VERSION?{success:!0,data:e.data}:{success:!1,error:"SERIALIZED_STATE_VERSION mismatch "+`(actual: ${e.data.version}, `+`expected: ${u.SERIALIZED_STATE_VERSION})`};return{success:!1,error:e.error.toString()}},_T.deserializeAppStatePhase1=function(r){c.globals.store.edit(e=>{for(const t of r.plugins??[])e.plugins[t.id]=t.state??{}})},_T.deserializeAppStatePhase2=function(o){void 0!==o.viewport&&c.globals.timeline.updateVisibleTime(new e.TimeSpan(o.viewport.start,o.viewport.end));c.globals.store.edit(e=>{var t=[];for(const a of o.pinnedTracks)a in c.globals.state.tracks&&t.push(a);e.pinnedTracks=t;for(const i of o.notes){var r={id:i.id,timestamp:i.start,color:i.color,text:i.text};"DEFAULT"===i.noteType?e.notes[i.id]={noteType:"DEFAULT",...r}:"SPAN"===i.noteType&&(e.notes[i.id]={noteType:"SPAN",start:r.timestamp,end:i.end,...r})}var n=o.selection[0];if(void 0!==n)switch(n.kind){case"TRACK_EVENT":e.selection={kind:"single",trackKey:n.trackKey,eventId:parseInt(n.eventId)};break;case"LEGACY_SCHED_SLICE":e.selection={kind:"legacy",legacySelection:{kind:"SCHED_SLICE",id:n.id}};break;case"LEGACY_SLICE":e.selection={kind:"legacy",legacySelection:{kind:"SLICE",id:n.id}};break;case"LEGACY_THREAD_STATE":e.selection={kind:"legacy",legacySelection:{kind:"THREAD_STATE",id:n.id}};break;case"LEGACY_HEAP_PROFILE":e.selection={kind:"legacy",legacySelection:{kind:"HEAP_PROFILE",id:n.id,upid:n.upid,ts:n.ts,type:n.type}}}})},_T.JsonSerialize=function(e){return JSON.stringify(e,(e,t)=>"bigint"==typeof t?t.toString():t)};const c=oe(),u=TT(),e=K()}return _T}var vT,ET,ST,AT,OT,r={};function CT(){if(!vT){vT=1,Object.defineProperty(r,"__esModule",{value:!0}),r.publishOverviewData=function(e){for(var[t,r]of Object.entries(e))o.globals.overviewStore.has(t)||o.globals.overviewStore.set(t,[]),r instanceof Array?o.globals.overviewStore.get(t).push(...r):o.globals.overviewStore.get(t).push(r);a.raf.scheduleRedraw()},r.clearOverviewData=function(){o.globals.overviewStore.clear(),a.raf.scheduleRedraw()},r.publishTrackData=function(e){o.globals.setTrackData(e.id,e.data),a.raf.scheduleRedraw()},r.publishMetricResult=function(e){o.globals.setMetricResult(e),o.globals.publishRedraw()},r.publishSelectedFlows=function(e){o.globals.selectedFlows=e,o.globals.publishRedraw()},r.publishHttpRpcState=function(e){o.globals.httpRpcState=e,a.raf.scheduleFullRedraw()},r.publishCpuProfileDetails=function(e){o.globals.cpuProfileDetails=e,o.globals.publishRedraw()},r.publishHasFtrace=function(e){o.globals.hasFtrace=e,o.globals.publishRedraw()},r.publishConversionJobStatusUpdate=function(e){o.globals.setConversionJobStatus(e.jobName,e.jobStatus),o.globals.publishRedraw()},r.publishLoading=function(e){o.globals.numQueuedQueries=e,a.raf.scheduleFullRedraw()},r.publishBufferUsage=function(e){o.globals.setBufferUsage(e.percentage),o.globals.publishRedraw()},r.publishSearchResult=function(e){o.globals.currentSearchResults=e,o.globals.publishRedraw()},r.publishRecordingLog=function(e){o.globals.setRecordingLog(e.logs),o.globals.publishRedraw()},r.publishTraceErrors=function(e){o.globals.setTraceErrors(e),o.globals.publishRedraw()},r.publishMetricError=function(e){o.globals.setMetricError(e),o.globals.publishRedraw()},r.publishAggregateData=function(e){o.globals.setAggregateData(e.kind,e.data),o.globals.publishRedraw()},r.publishQueryResult=function(e){o.globals.queryResults.set(e.id,e.data),o.globals.publishRedraw()},r.publishThreads=function(e){o.globals.threads.clear(),e.forEach(e=>{o.globals.threads.set(e.utid,e)}),o.globals.publishRedraw()},r.publishSliceDetails=function(e){e=(o.globals.sliceDetails=e).id;void 0!==e&&e===o.globals.state.pendingScrollId&&((0,t.findCurrentSelection)(),o.globals.dispatch(n.Actions.clearPendingScrollId({id:void 0})));o.globals.publishRedraw()},r.publishThreadStateDetails=function(e){o.globals.threadStateDetails=e,o.globals.publishRedraw()},r.publishConnectedFlows=function(e){o.globals.connectedFlows=e,o.globals.dispatch(n.Actions.setHighlightedFlowLeftId({flowId:-1})),o.globals.dispatch(n.Actions.setHighlightedFlowRightId({flowId:-1}));e=(0,i.getLegacySelection)(o.globals.state);if("SLICE"===e?.kind){var t=e.id;for(const r of o.globals.connectedFlows)r.begin.sliceId===t&&o.globals.dispatch(n.Actions.setHighlightedFlowRightId({flowId:r.id})),r.end.sliceId===t&&o.globals.dispatch(n.Actions.setHighlightedFlowLeftId({flowId:r.id}))}o.globals.publishRedraw()},r.publishShowPanningHint=function(){o.globals.showPanningHint=!0,o.globals.publishRedraw()},r.publishPermalinkHash=function(e){o.globals.permalinkHash=e,o.globals.publishRedraw()};const n=ne(),a=ie(),i=Y(),o=oe(),t=Up()}return r}function kT(){if(!ET){ET=1,Object.defineProperty(mT,"__esModule",{value:!0}),mT.createPermalink=async function(e){var t="create_permalink";(0,f.publishConversionJobStatusUpdate)({jobName:t,jobStatus:n.ConversionJobStatus.InProgress});try{var r=await async function(n){var a={};if("RECORDING_OPTS"===n.mode)a.recordingOpts=d.globals.state.recordConfig;else if("APP_STATE"===n.mode){let e="";n=(0,l.assertExists)(d.globals.getCurrentEngine());let t=void 0,r="trace "+n.id;if("FILE"===n.source.type)t=n.source.file,r=t.name;else if("ARRAY_BUFFER"===n.source.type)t=n.source.buffer;else{if("URL"!==n.source.type)throw new Error("Cannot share trace "+JSON.stringify(n.source));e=n.source.url}if(e)a.traceUrl=e;else if(void 0!==t){s("Uploading "+r);const i=new u.GcsUploader(t,{mimeType:u.MIME_BINARY,onProgress:()=>o(i)});await i.waitForCompletion(),a.traceUrl=i.uploadedUrl}a.appState=(0,c.serializeAppState)()}s("Creating permalink...");const e=(0,c.JsonSerialize)(a),i=new u.GcsUploader(e,{mimeType:u.MIME_JSON,onProgress:()=>o(i)});return await i.waitForCompletion(),i.uploadedFileName}(e);(0,f.publishPermalinkHash)(r)}finally{(0,f.publishConversionJobStatusUpdate)({jobName:t,jobStatus:n.ConversionJobStatus.NotRunning})}},mT.loadPermalink=async function(e){var e=`https://storage.googleapis.com/${u.BUCKET_NAME}/`+e,t=await fetch(e);if(!t.ok)throw new Error(`Could not fetch permalink.
 URL: `+e);e=await t.text(),t=JSON.parse(e);let r,n="";e=function(e){if(void 0===e.version)return;var t=e.frontendLocalState?.visibleState;return{traceUrl:e.engine?.source?.url,appState:{version:h.SERIALIZED_STATE_VERSION,pinnedTracks:e.pinnedTracks??[],viewport:t?{start:t.start?.value,end:t.end?.value}:void 0}}}(t);r=void 0!==e?e:(e=m.safeParse(t),e.success?e.data:(n=e.error.toString(),{}));void 0!==r.recordingOpts?(d.globals.dispatch(i.Actions.setRecordConfig({config:r.recordingOpts})),p.Router.navigate("#!/record")):(void 0!==r.appState&&((t=(0,c.parseAppState)(r.appState)).success?d.globals.restoreAppStateAfterTraceLoad=t.data:n=t.error),r.traceUrl&&d.globals.dispatch(i.Actions.openTraceFromUrl({url:r.traceUrl})),n&&(0,g.showModal)({title:"Failed to restore the serialized app state",content:(0,a.default)("div",(0,a.default)("p","Something went wrong when restoring the app state.This is due to some backwards-incompatible change when the permalink is generated and then opened using two different UI versions."),(0,a.default)("p","I'm going to try to open the trace file anyways, but the zoom level, pinned tracks and other UI state wont't be recovered"),(0,a.default)("p","Error details:"),(0,a.default)(".modal-logs",n)),buttons:[{text:"Open only the trace file",primary:!0}]}))};const a=or.__importDefault(ae()),l=ee(),i=ne(),n=Pa(),c=bT(),u=I_(),d=oe(),f=CT(),p=So(),h=TT();var e=ra();const g=de(),m=e.z.object({traceUrl:e.z.string().optional(),appState:e.z.any().optional(),recordingOpts:e.z.any().optional()});function o(e){switch(e.state){case"UPLOADING":s("Uploading "+e.getEtaString());break;case"ERROR":s("Upload failed "+e.error)}}function s(e){d.globals.dispatch(i.Actions.updateStatus({msg:e,timestamp:Date.now()/1e3}))}}return mT}function wT(){if(!ST){ST=1,Object.defineProperty(gT,"__esModule",{value:!0}),gT.isShareable=r,gT.isDownloadable=e,gT.shareTrace=function(){var e=(0,i.assertExists)(c.globals.getCurrentEngine()),e=e.source.url??"";var t;r()?r()&&(0,u.isTraceLoaded)()&&confirm("Upload UI state and generate a permalink. The trace will be accessible by anybody with the permalink.")&&(c.globals.logging.logEvent("Trace Actions","Create permalink"),(0,o.createPermalink)({mode:"APP_STATE"})):(t=[(0,a.default)("p","This trace was opened by an external site and as such cannot be re-shared preserving the UI state.")],e&&(t.push((0,a.default)("p","By using the URL below you can open this trace again.")),t.push((0,a.default)("p","Clicking will copy the URL into the clipboard.")),t.push(n(e,e))),(0,s.showModal)({title:"Cannot create permalink from external trace",content:(0,a.default)("div",t)}))},gT.createTraceLink=n;const a=or.__importDefault(ae()),i=ee(),o=kT(),s=de(),l=np(),c=oe(),u=RT();function r(){return c.globals.isInternalUser&&e()}function e(){var e=c.globals.getCurrentEngine();return!(!e||"ARRAY_BUFFER"===e.source.type&&e.source.localOnly||"HTTP_RPC"===e.source.type)}function n(e,t){return""===t?(0,a.default)("a.trace-file-name",e):(t={href:t,title:"Click to copy the URL",target:"_blank",onclick:(0,l.onClickCopy)(t)},(0,a.default)("a.trace-file-name",t,e))}}return gT}function RT(){if(!AT){AT=1,Object.defineProperty(Wy,"__esModule",{value:!0}),Wy.Sidebar=void 0,Wy.getCurrentTrace=n,Wy.isTraceLoaded=s;const c=or.__importDefault(ae()),i=ee(),u=te(),d=ne(),f=To(),p=$y(),h=Pa(),g=Aa();var e=re();const m=ie(),_=Nr(),y=de();var t=Yy();const T=lp(),b=oe(),v=fT(),E=So(),S=wT(),A=P_(),O=N_(),C=uT(),k=e.featureFlags.register({id:"showHiringBanner",name:"Show hiring banner",description:'Show the "We\'re hiring" banner link in the side bar.',defaultValue:!1}),w=e.featureFlags.register({id:"showWidgetsPageInNav",name:"Show widgets page",description:"Show a link to the widgets page in the side bar.",defaultValue:!1}),R=e.featureFlags.register({id:"showPluginsPageInNav",name:"Show plugins page",description:"Show a link to the plugins page in the side bar.",defaultValue:!1}),I=e.featureFlags.register({id:"showInsightsPageInNav",name:"Show insights page",description:"Show a link to the insights page in the side bar.",defaultValue:!1}),M=e.featureFlags.register({id:"showVizPageInNav",name:"Show viz page",description:"Show a link to the viz page in the side bar.",defaultValue:!0}),P={view(){let e="",t="Number of pending SQL queries",r,n=!1,a;var i=b.globals.state.engine;return void 0!==i&&(a=i.mode,void 0!==i.failed)&&(e+=".red",t="Query engine crashed\n"+i.failed,n=!0),"HTTP_RPC"===(a=void 0===a?b.globals.httpRpcState.connected&&"USE_HTTP_RPC_IF_AVAILABLE"===b.globals.state.newEngineMode?"HTTP_RPC":"WASM":a)?(e+=".green",r="RPC",t+="\n(Query engine: native accelerator over HTTP+RPC)"):(r="WSM",t+="\n(Query engine: built-in WASM)"),(0,c.default)(".dbg-info-square"+e,{title:t},(0,c.default)("div",r),(0,c.default)("div",""+(n?"FAIL":b.globals.numQueuedQueries)))}},N={view(){let e="",t="Service Worker: ",r="N/A";var n=b.globals.serviceWorkerController;"serviceWorker"in navigator?n.bypassed?(r="OFF",e=".red",t+="Bypassed, using live network. Double-click to re-enable"):n.installing?(r="UPD",e=".amber",t+="Installing / updating ..."):navigator.serviceWorker.controller?(r="ON",e=".green",t+="Serving from cache. Ready for offline use"):(r="N/A",t+="Not available, using network"):(r="N/A",t+="not supported by the browser (requires HTTPS)");return(0,c.default)(".dbg-info-square"+e,{title:t,ondblclick:async()=>{b.globals.serviceWorkerController.bypassed?b.globals.serviceWorkerController.setBypass(!1):(0,y.showModal)({title:"Disable service worker?",content:(0,c.default)("div",(0,c.default)("p",`If you continue the service worker will be disabled until
                      manually re-enabled.`),(0,c.default)("p",`All future requests will be served from the network and the
                    UI won't be available offline.`),(0,c.default)("p",`You should do this only if you are debugging the UI
                    or if you are experiencing caching-related problems.`),(0,c.default)("p",`Disabling will cause a refresh of the UI, the current state
                    will be lost.`)),buttons:[{text:"Disable and reload",primary:!0,action:()=>{b.globals.serviceWorkerController.setBypass(!0).then(()=>location.reload())}},{text:"Cancel"}]})}},(0,c.default)("div","SW"),(0,c.default)("div",r))}},D={view(){return(0,c.default)(".sidebar-footer",(0,c.default)(P),(0,c.default)(N),(0,c.default)(".version",(0,c.default)("a",{href:`https://android.googlesource.com/platform/external/perfetto/+/${_.SCM_REVISION}/ui`,title:"Channel: "+(0,f.getCurrentChannel)(),target:"_blank"},_.VERSION)))}};class x{view(){return(0,c.default)(".hiring-banner",(0,c.default)("a",{href:"http://go/perfetto-open-roles",target:"_blank"},"We're hiring!"))}}function r(t){return b.globals.sidebarMenuItems.valuesAsArray().filter(({group:e})=>e===t).sort((e,t)=>{return(e.priority??0)-(t.priority??0)}).map(e=>{const t=b.globals.commandManager.getCommand(e.commandId);var r=t.defaultHotkey?`${t.name} [${(0,C.formatHotkey)(t.defaultHotkey)}]`:t.name;return{t:t.name,a:e=>{e.preventDefault(),t.callback()},i:e.icon,title:r}})}function o(){return[{title:"Navigation",summary:"Open or record a new trace",expanded:!0,items:[...r("navigation"),{t:"Record new trace",a:j,i:"fiber_smart_record"},{t:"Widgets",a:H,i:"widgets",isVisible:()=>w.get()},{t:"Plugins",a:G,i:"extension",isVisible:()=>R.get()}]},{title:"Current Trace",summary:"Actions on the current trace",expanded:!0,hideIfNoTraceLoaded:!0,appendOpenedTraceTitle:!0,items:[{t:"Show timeline",a:Y,i:"line_style"},{t:"Share",a:J,i:"share",internalUserOnly:!0,isPending:()=>b.globals.getConversionJobStatus("create_permalink")===h.ConversionJobStatus.InProgress},{t:"Download",a:Z,i:"file_download",checkDownloadDisabled:!0},{t:"Query (SQL)",a:V,i:"database"},{t:"Insights",a:W,i:"insights",isVisible:()=>I.get()},{t:"Viz",a:q,i:"area_chart",isVisible:()=>M.get()},{t:"Metrics",a:z,i:"speed"},{t:"Info and stats",a:K,i:"info"}]},{title:"Convert trace",summary:"Convert to other formats",expanded:!0,hideIfNoTraceLoaded:!0,items:[{t:"Switch to legacy UI",a:F,i:"filter_none",isPending:()=>b.globals.getConversionJobStatus("open_in_legacy")===h.ConversionJobStatus.InProgress},{t:"Convert to .json",a:B,i:"file_download",isPending:()=>b.globals.getConversionJobStatus("convert_json")===h.ConversionJobStatus.InProgress,checkDownloadDisabled:!0},{t:"Convert to .systrace",a:U,i:"file_download",isVisible:()=>b.globals.hasFtrace,isPending:()=>b.globals.getConversionJobStatus("convert_systrace")===h.ConversionJobStatus.InProgress,checkDownloadDisabled:!0}]},{title:"Example Traces",expanded:!0,summary:"Open an example trace",items:[...r("example_traces")]},{title:"Support",expanded:!0,summary:"Documentation & Bugs",items:[{t:"Keyboard shortcuts",a:L,i:"help"},{t:"Documentation",a:"https://perfetto.dev/docs",i:"find_in_page"},{t:"Flags",a:$,i:"emoji_flags"},{t:"Report a bug",a:b.globals.isInternalUser?"https://goto.google.com/perfetto-ui-bug":"https://github.com/google/perfetto/issues/new",i:"bug_report"},{t:"Record metatrace",a:Q,i:"fiber_smart_record",checkMetatracingDisabled:!0},{t:"Finalise metatrace",a:X,i:"file_download",checkMetatracingEnabled:!0}]}]}function L(e){e.preventDefault(),(0,v.toggleHelp)()}async function n(){var e,t=(0,i.assertExists)(b.globals.getCurrentEngine()).source;if("ARRAY_BUFFER"===t.type)return new Blob([t.buffer]);if("FILE"===t.type)return t.file;if("URL"===t.type)return e=t.url,c.default.request({method:"GET",url:e,config:e=>{e.responseType="blob",e.onprogress=e=>{e=(100*e.loaded/e.total).toFixed(1);b.globals.dispatch(d.Actions.updateStatus({msg:`Downloading trace ${e}%`,timestamp:Date.now()/1e3}))}},extract:e=>e.response});throw new Error("Loading to catapult from source with type "+t.type)}function F(e){e.preventDefault(),(0,i.assertTrue)(s()),b.globals.logging.logEvent("Trace Actions","Open current trace in legacy UI"),s()&&n().then(e=>{(0,O.openInOldUIWithSizeCheck)(e)}).catch(e=>{throw new Error("Failed to get current trace "+e)})}function U(e){e.preventDefault(),(0,i.assertTrue)(s()),b.globals.logging.logEvent("Trace Actions","Convert to .systrace"),s()&&n().then(e=>{(0,A.convertTraceToSystraceAndDownload)(e)}).catch(e=>{throw new Error("Failed to get current trace "+e)})}function B(e){e.preventDefault(),(0,i.assertTrue)(s()),b.globals.logging.logEvent("Trace Actions","Convert to .json"),s()&&n().then(e=>{(0,A.convertTraceToJsonAndDownload)(e)}).catch(e=>{throw new Error("Failed to get current trace "+e)})}function s(){return void 0!==b.globals.getCurrentEngine()}function j(e){e.preventDefault(),E.Router.navigate("#!/record")}function H(e){e.preventDefault(),E.Router.navigate("#!/widgets")}function G(e){e.preventDefault(),E.Router.navigate("#!/plugins")}function V(e){e.preventDefault(),E.Router.navigate("#!/query")}function W(e){e.preventDefault(),E.Router.navigate("#!/insights")}function q(e){e.preventDefault(),E.Router.navigate("#!/viz")}function $(e){e.preventDefault(),E.Router.navigate("#!/flags")}function z(e){e.preventDefault(),E.Router.navigate("#!/metrics")}function K(e){e.preventDefault(),E.Router.navigate("#!/info")}function Y(e){e.preventDefault(),E.Router.navigate("#!/viewer")}function J(e){e.preventDefault(),(0,S.shareTrace)()}function Z(r){if(r.preventDefault(),(0,S.isDownloadable)()&&s()){b.globals.logging.logEvent("Trace Actions","Download trace");r=b.globals.getCurrentEngine();if(r){let e="",t="trace"+p.TRACE_SUFFIX;r=r.source;if("URL"===r.type)e=r.url,t=e.split("/").slice(-1)[0];else if("ARRAY_BUFFER"===r.type){var n=new Blob([r.buffer],{type:"application/octet-stream"}),a=window.prompt("Please enter a name for your file or leave blank");a?t=a+".perfetto_trace.gz":r.fileName&&(t=r.fileName),e=URL.createObjectURL(n)}else{if("FILE"!==r.type)throw new Error(`Download from ${JSON.stringify(r)} is not supported`);a=r.file;e=URL.createObjectURL(a),t=a.name}(0,T.downloadUrl)(t,e)}}}function a(){var e=b.globals.getCurrentEngine()?.id;if(void 0!==e)return b.globals.engines.get(e)}function l(){return window.crossOriginIsolated||"HTTP_RPC"===b.globals.getCurrentEngine()?.mode}function Q(e){e.preventDefault(),b.globals.logging.logEvent("Trace Actions","Record metatrace");const t=a();t&&(l()?t.enableMetatrace():(0,y.showModal)({title:"Trace processor doesn't have high-precision timers",content:(0,c.default)(".modal-pre",`High-precision timers are not available to WASM trace processor yet.

Modern browsers restrict high-precision timers to cross-origin-isolated pages.
As Perfetto UI needs to open traces via postMessage, it can't be cross-origin
isolated until browsers ship support for
'Cross-origin-opener-policy: restrict-properties'.

Do you still want to record a metatrace?
Note that events under timer precision (1ms) will dropped.
Alternatively, connect to a trace_processor_shell --httpd instance.
`),buttons:[{text:"YES, record metatrace",primary:!0,action:()=>{(0,g.enableMetatracing)(),t.enableMetatrace()}},{text:"NO, cancel"}]}))}async function X(e){e.preventDefault(),b.globals.logging.logEvent("Trace Actions","Finalise metatrace");var e=(0,g.disableMetatracingAndGetTrace)(),t=a();if(t){t=await t.stopAndGetMetatrace();if(0!==t.error.length)throw new Error("Failed to read metatrace: "+t.error);(0,T.downloadData)("metatrace",t.metatrace,e)}}Wy.Sidebar=class{_redrawWhileAnimating=new t.Animation(()=>m.raf.scheduleFullRedraw());view(){if(b.globals.hideSidebar)return null;var e=[];for(const a of o())if(!a.hideIfNoTraceLoaded||s()){var t,r,n=[];for(const i of a.items)if(void 0===i.isVisible||i.isVisible()){let e="",t={onclick:"function"==typeof i.a?i.a:null,href:(0,u.isString)(i.a)?i.a:"#",target:(0,u.isString)(i.a)?"_blank":null,disabled:!1,id:i.t.toLowerCase().replace(/[^\w]/g,"_")};if(i.isPending&&i.isPending()&&(t.onclick=e=>e.preventDefault(),e=".pending"),!i.internalUserOnly||b.globals.isInternalUser){if(i.checkMetatracingEnabled||i.checkMetatracingDisabled){if(!0===i.checkMetatracingEnabled&&!(0,g.isMetatracingEnabled)())continue;if(!0===i.checkMetatracingDisabled&&(0,g.isMetatracingEnabled)())continue;i.checkMetatracingDisabled&&!l()&&(t.disabled=!0)}i.checkDownloadDisabled&&!(0,S.isDownloadable)()&&(t={onclick:e=>{e.preventDefault(),alert("Can not download external trace.")},href:"#",target:null,disabled:!0,id:""}),n.push((0,c.default)("li",(0,c.default)("a"+e,{...t,title:i.title},(0,c.default)("i.material-icons",i.i),i.t)))}}a.appendOpenedTraceTitle&&b.globals.traceContext.traceTitle&&({traceTitle:t,traceUrl:r}=b.globals.traceContext,n.unshift((0,c.default)("li",(0,S.createTraceLink)(t,r)))),e.push((0,c.default)("section"+(a.expanded?".expanded":""),(0,c.default)(".section-header",{onclick:()=>{a.expanded=!a.expanded,m.raf.scheduleFullRedraw()}},(0,c.default)("h1",{title:a.summary},a.title),(0,c.default)("h2",a.summary)),(0,c.default)(".section-content",(0,c.default)("ul",n))))}return(0,c.default)("nav.sidebar",{class:b.globals.state.sidebarVisible?"show-sidebar":"hide-sidebar",ontransitionstart:e=>{e.target===e.currentTarget&&this._redrawWhileAnimating.start(150)},ontransitionend:e=>{e.target===e.currentTarget&&this._redrawWhileAnimating.stop()}},b.globals.isInternalUser&&k.get()?(0,c.default)(x):null,(0,c.default)("header."+(0,f.getCurrentChannel)(),(0,c.default)(`img[src=${b.globals.root}assets/brand.png].brand`),(0,c.default)("button.sidebar-button",{onclick:()=>{b.globals.commandManager.runCommand("perfetto.CoreCommands#ToggleLeftSidebar")}},(0,c.default)("i.material-icons",{title:b.globals.state.sidebarVisible?"Hide menu":"Show menu"},"menu"))),(0,c.default)(".sidebar-scroll",(0,c.default)(".sidebar-scroll-container",...e,(0,c.default)(D))))}}}return Wy}function IT(){if(!OT){OT=1,Object.defineProperty(Fy,"__esModule",{value:!0}),Fy.LegacyFlamegraphDetailsPanel=void 0,Fy.profileType=function(e){if(function(e){return Object.values(c.ProfileType).includes(e)}(e))return e;if(e.startsWith("heap_profile"))return c.ProfileType.HEAP_PROFILE;throw new Error("Unknown type ${s}")},Fy.isHeapGraphDominatorTreeViewingOption=o;const i=or.__importDefault(ae()),a=hl(),s=ee(),l=ne(),_=By(),c=Y(),u=ie(),d=le(),f=al(),p=de(),h=bl(),g=wy(),m=$l();var e=Gy();const y=oe();var t=xo();const T=So(),b=le(),v=L(),E=F(),S=Gl(),A=ue();var r=Qh();const O=sc(),C=RT(),k=P_();var n=qa();const w=[_.FlamegraphViewingOption.DOMINATOR_TREE_OBJ_SIZE_KEY,_.FlamegraphViewingOption.DOMINATOR_TREE_OBJ_COUNT_KEY],R={selfSize:"Self",totalSize:"Total"},I={selfSize:"Self objects",totalSize:"Subtree objects"};class M{undebouncedFocusRegex="";updateFocusRegexDebounced=(0,t.debounce)(()=>{void 0!==this.state&&(this.state.focusRegex=this.undebouncedFocusRegex,u.raf.scheduleFullRedraw())},20);flamegraph=new e.Flamegraph([]);queryLimiter=new n.AsyncLimiter;state;queryMonitor=new r.Monitor([()=>this.state?.selection,()=>this.state?.focusRegex,()=>this.state?.viewingOption]);selectedCallsitesMonitor=new r.Monitor([()=>this.state?.selection,()=>this.state?.focusRegex]);renderResultMonitor=new r.Monitor([()=>this.state?.result?.queryResults,()=>this.state?.selectedCallsites]);view({attrs:e}){if(void 0===e.selection?this.state=void 0:e.selection.profileType===this.state?.selection.profileType&&e.selection.start===this.state.selection.start&&e.selection.end===this.state.selection.end&&(0,O.arrayEquals)(e.selection.upids,this.state.selection.upids)||(this.state={selection:e.selection,focusRegex:"",viewingOption:(0,_.defaultViewingOption)(e.selection.profileType),selectedCallsites:{}}),void 0===this.state)return(0,i.default)(".details-panel",(0,i.default)(".details-panel-heading",(0,i.default)("h2","Flamegraph Profile")));if(this.queryMonitor.ifStateChanged()){this.state.result=void 0;const a=this.state;this.queryLimiter.schedule(()=>M.fetchQueryResults((0,s.assertExists)(this.getCurrentEngine()),e.cache,a))}var t,r;this.selectedCallsitesMonitor.ifStateChanged()&&(this.state.selectedCallsites={}),this.renderResultMonitor.ifStateChanged()&&void 0!==this.state.result&&(t=this.state.selectedCallsites[this.state.viewingOption],r=(0,_.expandCallsites)(this.state.result.queryResults,t?.id??-1),this.state.result.renderResults=(0,_.mergeCallsites)(r,M.getMinSizeDisplayed(r,t?.totalSize)));let n;return n=void 0!==this.state.result?.renderResults?(this.flamegraph.updateDataIfChanged(this.nodeRendering(),this.state.result.renderResults,this.state.selectedCallsites[this.state.viewingOption]),this.flamegraph.getHeight()+30):void 0,(0,i.default)(".flamegraph-profile",this.maybeShowModal(),(0,i.default)(E.DetailsShell,{fillParent:!0,title:(0,i.default)("div.title",this.getTitle(),this.state.selection.profileType===c.ProfileType.MIXED_HEAP_PROFILE&&(0,i.default)(h.Popup,{trigger:(0,i.default)(f.Icon,{icon:"warning"})},(0,i.default)("",{style:{width:"300px"}},'This is a mixed java/native heap profile, free()s are not visualized. To visualize free()s, remove "all_heaps: true" from the config.')),":"),description:this.getViewingOptionButtons(),buttons:[(0,i.default)("div.selected","Selected function: "+(void 0!==(r=this.state.selectedCallsites[this.state.viewingOption])&&void 0!==r.name?r.name:"(none)")),(0,i.default)("div.time","Snapshot time: ",(0,i.default)(v.DurationWidget,{dur:this.state.selection.end-this.state.selection.start})),(0,i.default)("input[type=text][placeholder=Focus]",{oninput:e=>{e=e.target;this.undebouncedFocusRegex=e.value,this.updateFocusRegexDebounced()},onkeydown:e=>e.stopPropagation()}),(this.state.selection.profileType===c.ProfileType.NATIVE_HEAP_PROFILE||this.state.selection.profileType===c.ProfileType.JAVA_HEAP_SAMPLES)&&(0,i.default)(d.Button,{icon:"file_download",intent:S.Intent.Primary,onclick:()=>{this.downloadPprof(),u.raf.scheduleFullRedraw()}})]},(0,i.default)(".flamegraph-content",void 0===this.state.result?(0,i.default)(".loading-container",(0,i.default)(g.EmptyState,{icon:"bar_chart",title:"Computing graph ...",className:"flamegraph-loading"},(0,i.default)(m.Spinner,{easing:!0}))):(0,i.default)("canvas[ref=canvas]",{style:`height:${n}px; width:100%`,onmousemove:e=>{var{offsetX:e,offsetY:t}=e;this.flamegraph.onMouseMove({x:e,y:t}),u.raf.scheduleFullRedraw()},onmouseout:()=>{this.flamegraph.onMouseOut(),u.raf.scheduleFullRedraw()},onclick:e=>{var t,r;void 0!==this.state&&void 0!==this.state.result&&({offsetX:e,offsetY:t}=e,(r={...this.state.selectedCallsites})[this.state.viewingOption]=this.flamegraph.onMouseClick({x:e,y:t}),this.state.selectedCallsites=r,u.raf.scheduleFullRedraw())}}))))}getTitle(){switch((0,s.assertExists)(this.state).selection.profileType){case c.ProfileType.MIXED_HEAP_PROFILE:return"Mixed heap profile";case c.ProfileType.HEAP_PROFILE:return"Heap profile";case c.ProfileType.NATIVE_HEAP_PROFILE:return"Native heap profile";case c.ProfileType.JAVA_HEAP_SAMPLES:return"Java heap samples";case c.ProfileType.JAVA_HEAP_GRAPH:return"Java heap graph";case c.ProfileType.PERF_SAMPLE:return"Profile";default:throw new Error("unknown type")}}nodeRendering(){var e=(0,s.assertExists)(this.state),t=e.selection.profileType;switch(t){case c.ProfileType.JAVA_HEAP_GRAPH:return e.viewingOption===_.FlamegraphViewingOption.OBJECTS_ALLOCATED_NOT_FREED_KEY||e.viewingOption===_.FlamegraphViewingOption.DOMINATOR_TREE_OBJ_COUNT_KEY?I:R;case c.ProfileType.MIXED_HEAP_PROFILE:case c.ProfileType.HEAP_PROFILE:case c.ProfileType.NATIVE_HEAP_PROFILE:case c.ProfileType.JAVA_HEAP_SAMPLES:case c.ProfileType.PERF_SAMPLE:return R;default:throw new Error("Unhandled case: "+t)}}getViewingOptionButtons(){var e=[],t=(0,s.assertExists)(this.state);for(const{option:r,name:n}of(0,_.viewingOptions)(t.selection.profileType))e.push((0,i.default)(d.Button,{label:n,active:r===t.viewingOption,onclick:()=>{(0,s.assertExists)(this.state).viewingOption=r,u.raf.scheduleFullRedraw()}}));return(0,i.default)(b.ButtonBar,e)}onupdate({dom:e}){var t,r,n,e=(0,a.findRef)(e,"canvas");null!==e&&e instanceof HTMLCanvasElement&&this.state?.result?.renderResults&&(e.width=e.offsetWidth*devicePixelRatio,e.height=e.offsetHeight*devicePixelRatio,null!==(t=e.getContext("2d")))&&(t.clearRect(0,0,e.width,e.height),t.save(),t.scale(devicePixelRatio,devicePixelRatio),{offsetWidth:e,offsetHeight:r}=e,n=this.state.viewingOption===_.FlamegraphViewingOption.SPACE_MEMORY_ALLOCATED_NOT_FREED_KEY||this.state.viewingOption===_.FlamegraphViewingOption.ALLOC_SPACE_MEMORY_ALLOCATED_KEY||this.state.viewingOption===_.FlamegraphViewingOption.DOMINATOR_TREE_OBJ_SIZE_KEY?"B":"",this.flamegraph.draw(t,e,r,0,0,n),t.restore())}static async fetchQueryResults(e,t,r){t=await M.prepareViewsAndTables(e,t,r),t=await M.getFlamegraphDataFromTables(e,t,r.viewingOption,r.focusRegex);let n=!1;r.selection.profileType===c.ProfileType.JAVA_HEAP_GRAPH&&(e=await e.query(`
        select value from stats
        where severity = 'error' and name = 'heap_graph_non_finalized_graph'
      `),n=0<e.firstRow({value:A.NUM}).value),r.result={queryResults:t,incomplete:n},u.raf.scheduleFullRedraw()}static async prepareViewsAndTables(r,n,a){var i=function(e){switch(e){case c.ProfileType.HEAP_PROFILE:case c.ProfileType.MIXED_HEAP_PROFILE:case c.ProfileType.NATIVE_HEAP_PROFILE:case c.ProfileType.JAVA_HEAP_SAMPLES:return"native";case c.ProfileType.JAVA_HEAP_GRAPH:return"graph";case c.ProfileType.PERF_SAMPLE:return"perf";default:throw new Error("Unhandled case: "+e)}}(a.selection.profileType);if(a.selection.profileType!==c.ProfileType.PERF_SAMPLE)return a.selection.profileType===c.ProfileType.JAVA_HEAP_GRAPH&&o(a.viewingOption)?((0,s.assertTrue)(a.selection.start==a.selection.end),n.getTableName(r,await this.loadHeapGraphDominatorTreeQuery(r,n,a.selection.upids[0],a.selection.start))):((0,s.assertTrue)(a.selection.start==a.selection.end),n.getTableName(r,`
        select
          id,
          name,
          map_name,
          parent_id,
          depth,
          cumulative_size,
          cumulative_alloc_size,
          cumulative_count,
          cumulative_alloc_count,
          size,
          alloc_size,
          count,
          alloc_count,
          source_file,
          line_number
        from experimental_flamegraph(
          '${i}',
          ${a.selection.start},
          NULL,
          ${a.selection.upids[0]},
          NULL,
          '${a.focusRegex}'
        )
      `));{let e,t;return t=1<a.selection.upids.length?(e="NULL",`'${this.serializeUpidGroup(a.selection.upids)}'`):(e=""+a.selection.upids[0],"NULL"),n.getTableName(r,`
          select
            id,
            name,
            map_name,
            parent_id,
            depth,
            cumulative_size,
            cumulative_alloc_size,
            cumulative_count,
            cumulative_alloc_count,
            size,
            alloc_size,
            count,
            alloc_count,
            source_file,
            line_number
          from experimental_flamegraph(
            '${i}',
            NULL,
            '>=${a.selection.start},<=${a.selection.end}',
            ${e},
            ${t},
            '${a.focusRegex}'
          )
        `)}}static async loadHeapGraphDominatorTreeQuery(e,t,r,n){var a=`heap_graph_type_dominated_${r}_`+n,i="SELECT * FROM "+a;return t.hasQuery(i)||await e.query(`
      INCLUDE PERFETTO MODULE android.memory.heap_graph.dominator_tree;

      -- heap graph dominator tree with objects as nodes and all relavant
      -- object self stats and dominated stats
      CREATE PERFETTO TABLE _heap_graph_object_dominated AS
      SELECT
      node.id,
      node.idom_id,
      node.dominated_obj_count,
      node.dominated_size_bytes + node.dominated_native_size_bytes AS dominated_size,
      node.depth,
      obj.type_id,
      obj.root_type,
      obj.self_size + obj.native_size AS self_size
      FROM heap_graph_dominator_tree node
      JOIN heap_graph_object obj USING(id)
      WHERE obj.upid = ${r} AND obj.graph_sample_ts = ${n}
      -- required to accelerate the recursive cte below
      ORDER BY idom_id;

      -- calculate for each object node in the dominator tree the
      -- HASH(path of type_id's from the super root to the object)
      CREATE PERFETTO TABLE _dominator_tree_path_hash AS
      WITH RECURSIVE _tree_visitor(id, path_hash) AS (
        SELECT
          id,
          HASH(
            CAST(type_id AS TEXT) || '-' || IFNULL(root_type, '')
          ) AS path_hash
        FROM _heap_graph_object_dominated
        WHERE depth = 1
        UNION ALL
        SELECT
          child.id,
          HASH(CAST(parent.path_hash AS TEXT) || '/' || CAST(type_id AS TEXT)) AS path_hash
        FROM _heap_graph_object_dominated child
        JOIN _tree_visitor parent ON child.idom_id = parent.id
      )
      SELECT * from _tree_visitor
      ORDER BY id;

      -- merge object nodes with the same path into one "class type node", so the
      -- end result is a tree where nodes are identified by their types and the
      -- dominator relationships are preserved.
      CREATE PERFETTO TABLE ${a} AS
      SELECT
        map.path_hash as id,
        COALESCE(cls.deobfuscated_name, cls.name, '[NULL]') || IIF(
          node.root_type IS NOT NULL,
          ' [' || node.root_type || ']', ''
        ) AS name,
        IFNULL(parent_map.path_hash, -1) AS parent_id,
        node.depth - 1 AS depth,
        sum(dominated_size) AS cumulative_size,
        -1 AS cumulative_alloc_size,
        sum(dominated_obj_count) AS cumulative_count,
        -1 AS cumulative_alloc_count,
        '' as map_name,
        '' as source_file,
        -1 as line_number,
        sum(self_size) AS size,
        count(*) AS count
      FROM _heap_graph_object_dominated node
      JOIN _dominator_tree_path_hash map USING(id)
      LEFT JOIN _dominator_tree_path_hash parent_map ON node.idom_id = parent_map.id
      JOIN heap_graph_class cls ON node.type_id = cls.id
      GROUP BY map.path_hash, name, parent_id, depth, map_name, source_file, line_number;

      -- These are intermediates and not needed
      DROP TABLE _heap_graph_object_dominated;
      DROP TABLE _dominator_tree_path_hash;
    `),i}static async getFlamegraphDataFromTables(e,t,r,n){let a="",i="cumulativeSize",o="size";switch(r){case _.FlamegraphViewingOption.ALLOC_SPACE_MEMORY_ALLOCATED_KEY:a=`where cumulative_alloc_size > 0 and depth < 100 order by depth, parent_id,
            cumulative_alloc_size desc, name`,i="cumulativeAllocSize",o="size";break;case _.FlamegraphViewingOption.OBJECTS_ALLOCATED_NOT_FREED_KEY:a=`where cumulative_count > 0 and depth < 100 order by depth, parent_id,
            cumulative_count desc, name`,i="cumulativeCount",o="count";break;case _.FlamegraphViewingOption.OBJECTS_ALLOCATED_KEY:a=`where cumulative_alloc_count > 0 and depth < 100 order by depth, parent_id,
            cumulative_alloc_count desc, name`,i="cumulativeAllocCount",o="count";break;case _.FlamegraphViewingOption.PERF_SAMPLES_KEY:case _.FlamegraphViewingOption.SPACE_MEMORY_ALLOCATED_NOT_FREED_KEY:a=`where cumulative_size > 0 and depth < 100 order by depth, parent_id,
            cumulative_size desc, name`,i="cumulativeSize",o="size";break;case _.FlamegraphViewingOption.DOMINATOR_TREE_OBJ_COUNT_KEY:a=`where depth < 100 order by depth,
          cumulativeCount desc, name`,i="cumulativeCount",o="count";break;case _.FlamegraphViewingOption.DOMINATOR_TREE_OBJ_SIZE_KEY:a=`where depth < 100 order by depth,
          cumulativeSize desc, name`,i="cumulativeSize",o="size";break;default:throw new Error("Unhandled case: "+r)}var e=await e.query(`
      SELECT
        id as hash,
        IFNULL(IFNULL(DEMANGLE(name), name), '[NULL]') as name,
        IFNULL(parent_id, -1) as parentHash,
        depth,
        cumulative_size as cumulativeSize,
        cumulative_alloc_size as cumulativeAllocSize,
        cumulative_count as cumulativeCount,
        cumulative_alloc_count as cumulativeAllocCount,
        map_name as mapping,
        size,
        count,
        IFNULL(source_file, '') as sourceFile,
        IFNULL(line_number, -1) as lineNumber
      from ${t}
      ${a}
    `),s=[],l=new Map,c=e.iter({hash:A.NUM,name:A.STR,parentHash:A.NUM,depth:A.NUM,cumulativeSize:A.NUM,cumulativeAllocSize:A.NUM,cumulativeCount:A.NUM,cumulativeAllocCount:A.NUM,mapping:A.STR,sourceFile:A.STR,lineNumber:A.NUM,size:A.NUM,count:A.NUM});for(let r=0;c.valid();++r,c.next()){var u=c.hash;let e=c.name;var d=c.parentHash,f=c.depth,p=c[i],h=c[o],g=c.mapping,m=""!==n&&e.toLocaleLowerCase().includes(n.toLocaleLowerCase()),d=l.has(+d)?l.get(+d):-1;let t;/[a-zA-Z]/i.test(c.sourceFile)&&(t=c.sourceFile,-1!==c.lineNumber)&&(t+=":"+c.lineNumber),99===f&&(e+=" [tree truncated]"),l.set(u,r),s.push({id:r,totalSize:p,depth:f,parentId:d,name:e,selfSize:h,mapping:g,merged:!1,highlighted:m,location:t})}return s}async downloadPprof(){if(void 0!==this.state){var e=this.getCurrentEngine();if(void 0!==e)try{(0,s.assertTrue)(1===this.state.selection.upids.length,"Native profiles can only contain one pid.");var t=await e.query("select pid from process where upid = "+this.state.selection.upids[0]),r=await(0,C.getCurrentTrace)();(0,k.convertTraceToPprofAndDownload)(r,t.firstRow({pid:A.NUM}).pid,this.state.selection.start)}catch(e){throw new Error("Failed to get current trace "+e)}}}maybeShowModal(){var e=(0,s.assertExists)(this.state);if(void 0!==e.result?.incomplete&&e.result.incomplete&&!y.globals.state.flamegraphModalDismissed)return(0,i.default)(p.Modal,{title:"The flamegraph is incomplete",vAlign:"TOP",content:(0,i.default)("div","The current trace does not have a fully formed flamegraph"),buttons:[{text:"Show the errors",primary:!0,action:()=>T.Router.navigate("#!/info")},{text:"Skip",action:()=>{y.globals.dispatch(l.Actions.dismissFlamegraphModal({})),u.raf.scheduleFullRedraw()}}]})}static getMinSizeDisplayed(e,t){return+(t=void 0===t?(0,_.findRootSize)(e):t)/800}static serializeUpidGroup(e){return new Array(e).join()}getCurrentEngine(){var e=y.globals.getCurrentEngine()?.id;if(void 0!==e)return y.globals.engines.get(e)}}function o(e){return w.includes(e)}Fy.LegacyFlamegraphDetailsPanel=M}return Fy}var MT,PT={};var NT,DT,xT,LT,FT={},UT={},BT={};function jT(){if(!NT){NT=1,Object.defineProperty(BT,"__esModule",{value:!0}),BT.SegmentedButtons=void 0;const o=or.__importDefault(ae()),s=le();BT.SegmentedButtons=class{view({attrs:e}){const{options:t,selectedOption:r,disabled:n,onOptionSelected:a,...i}=e;return(0,o.default)(".pf-segmented-buttons",i,t.map((e,t)=>(0,o.default)(s.Button,{...e,disabled:n,active:t===r,onclick:()=>a(t)})))}}}return BT}function HT(){if(!DT){DT=1,Object.defineProperty(UT,"__esModule",{value:!0}),UT.Flamegraph=void 0;const h=or.__importDefault(ae()),t=hl(),A=ee();var e=Qh();const g=le(),n=wy(),a=bl(),m=Tl(),i=Cc(),o=$l(),s=dg(),l=jT(),O=20,C=3;const c=`
Available filters:
- "Show Stack: foo" or "SS: foo" or "foo" to show only stacks containing "foo"
- "Hide Stack: foo" or "HS: foo" to hide all stacks containing "foo"
- "Show From Frame: foo" or "SFF: foo" to show frames containing "foo" and all descendants
- "Hide Frame: foo" or "HF: foo" to hide all frames containing "foo"
- "Pivot: foo" or "P: foo" to pivot on frames containing "foo".
Note: Pivot applies after all other filters and only one pivot can be active at a time.

`;function S(e,t){return(0,A.assertTrue)(0!==e,"Handling zooming root not possible in this function"),0<e&&"BELOW_ROOT"===t.type||e<0&&"ABOVE_ROOT"===t.type}function T(e,t,{x:r,y:n,width:a}){return void 0!==e&&void 0!==t&&r<=e&&e<r+a&&n<=t&&t<n+O}function b(e,t){if(""===t)return e.toLocaleString();if(0===e)return"0 "+t;let r,n;switch(t){case"B":r=1024,n=["B","KiB","MiB","GiB"];break;case"ns":r=1e3,n=["ns","us","ms","s"];break;default:r=1e3,n=[t,"K"+t,"M"+t,"G"+t]}var a=Math.min(Math.trunc(Math.log(e)/Math.log(r)),n.length-1),i=Math.pow(r,a),o=e/i;return(e%i==0?o.toString():o.toFixed(2))+" "+n[a]}function v(e,t){return 0===t?"[NULL]%":(e/t*100).toFixed(2)+"%"}function f(e,t){return t.startsWith("Pivot: ")?[...e.filter(e=>!e.startsWith("Pivot: ")),t]:[...e,t]}function p(e,t){var r=t.filter(e=>e.startsWith("Show Stack: ")).map(e=>e.split(": ",2)[1]),n=((0,A.assertTrue)(r.length<32,"More than 32 show stack filters is not supported"),t.filter(e=>e.startsWith("Show From Frame: ")).map(e=>e.split(": ",2)[1])),a=((0,A.assertTrue)(n.length<32,"More than 32 show from frame filters is not supported"),t.filter(e=>e.startsWith("Pivot: "))),e=((0,A.assertTrue)(a.length<=1,"Only one pivot can be active"),0===a.length?{kind:e}:{kind:"PIVOT",pivot:a[0].split(": ",2)[1]});return{showStack:r,hideStack:t.filter(e=>e.startsWith("Hide Stack: ")).map(e=>e.split(": ",2)[1]),showFromFrame:n,hideFrame:t.filter(e=>e.startsWith("Hide Frame: ")).map(e=>e.split(": ",2)[1]),view:e}}function E(t,e,r){if(e)return`hsl(0deg, 0%, ${r?85:80}%)`;if("unknown"===t||"root"===t)return`hsl(0deg, 0%, ${r?78:73}%)`;let n=0;for(let e=0;e<t.length;++e)n+=t.charCodeAt(e)%64;return`hsl(${n%360}deg, 45%, ${r?78:73}%)`}UT.Flamegraph=class{attrs;rawFilterText="";rawFilters=[];filterFocus=!1;switchState="TOP_DOWN";dataChangeMonitor=new e.Monitor([()=>this.attrs.data]);zoomRegion;renderNodesMonitor=new e.Monitor([()=>this.attrs.data,()=>this.canvasWidth,()=>this.zoomRegion]);renderNodes;tooltipPos;lastClickedNode;hoveredX;hoveredY;canvasWidth=0;labelCharWidth=0;constructor({attrs:e}){this.attrs=e}view({attrs:e}){var t,r;return this.attrs=e,this.dataChangeMonitor.ifStateChanged()&&(this.zoomRegion=void 0,this.lastClickedNode=void 0,this.tooltipPos=void 0),void 0===e.data?(0,h.default)(".pf-flamegraph",this.renderFilterBar(e),(0,h.default)(".loading-container",(0,h.default)(n.EmptyState,{icon:"bar_chart",title:"Computing graph ...",className:"flamegraph-loading"},(0,h.default)(o.Spinner,{easing:!0})))):({minDepth:t,maxDepth:r}=e.data,r=Math.max(r-t+8,8)*O,(0,h.default)(".pf-flamegraph",this.renderFilterBar(e),(0,h.default)(".canvas-container[ref=canvas-container]",{onscroll:()=>(0,m.scheduleFullRedraw)()},(0,h.default)(a.Popup,{trigger:(0,h.default)(".popup-anchor",{style:{left:this.tooltipPos?.x+"px",top:this.tooltipPos?.node.y+"px"}}),position:a.PopupPosition.Bottom,isOpen:"HOVER"===this.tooltipPos?.state||"CLICK"===this.tooltipPos?.state,className:"pf-flamegraph-tooltip-popup",offset:O},this.renderTooltip()),(0,h.default)("canvas[ref=canvas]",{style:`height:${r}px; width:100%`,onmousemove:({offsetX:t,offsetY:r})=>{var e;(0,m.scheduleFullRedraw)(),this.hoveredX=t,this.hoveredY=r,"CLICK"!==this.tooltipPos?.state&&(void 0===(e=this.renderNodes?.find(e=>T(t,r,e)))?this.tooltipPos=void 0:T(this.tooltipPos?.x,this.tooltipPos?.node.y,e)||(this.tooltipPos={x:t,node:e,state:"HOVER"}))},onmouseout:()=>{this.hoveredX=void 0,this.hoveredY=void 0,document.body.style.cursor="default","HOVER"!==this.tooltipPos?.state&&"DECLICK"!==this.tooltipPos?.state||(this.tooltipPos=void 0),(0,m.scheduleFullRedraw)()},onclick:({offsetX:t,offsetY:r})=>{var e=this.renderNodes?.find(e=>T(t,r,e));void 0===(this.lastClickedNode=e)?this.tooltipPos=void 0:T(this.tooltipPos?.x,this.tooltipPos?.node.y,e)?this.tooltipPos.state="CLICK"===this.tooltipPos?.state?"DECLICK":"CLICK":this.tooltipPos={x:t,node:e,state:"CLICK"},(0,m.scheduleFullRedraw)()},ondblclick:({offsetX:t,offsetY:r})=>{var e=this.renderNodes?.find(e=>T(t,r,e));"MERGED"!==e?.source.kind&&(this.zoomRegion=e?.source,(0,m.scheduleFullRedraw)())}}))))}oncreate({dom:e}){this.drawCanvas(e)}onupdate({dom:e}){this.drawCanvas(e)}drawCanvas(e){var r=(0,t.findRef)(e,"canvas-container");if(null!==r){e=(0,t.findRef)(e,"canvas");if(null!==e&&e instanceof HTMLCanvasElement){var n=e.getContext("2d");if(null!==n&&(e.width=e.offsetWidth*devicePixelRatio,e.height=e.offsetHeight*devicePixelRatio,this.canvasWidth=e.offsetWidth,this.renderNodesMonitor.ifStateChanged()&&(void 0===this.attrs.data?(this.renderNodes=void 0,this.lastClickedNode=void 0):(this.renderNodes=function({nodes:t,allRootsCumulativeValue:r,minDepth:n},a,i){var o=[],s=new Map,l=new Map,c=(o.push({x:0,y:-n*O,width:i,source:{kind:"ROOT",queryXStart:0,queryXEnd:r,type:"ROOT"},state:0===a.queryXStart&&a.queryXEnd===r?"NORMAL":"PARTIAL"}),a.queryXEnd-a.queryXStart);for(let e=0;e<t.length;e++){var u,d,f,p,h,g,m,{id:_,parentId:y,depth:T,xStart:b,xEnd:v}=t[e],E=((0,A.assertTrue)(0!==T),S(T,a));E&&(v<=a.queryXStart||b>=a.queryXEnd)||(g=E?c/i:r/i,u=E?b-a.queryXStart:b,f=(E?v-a.queryXStart:v)-u,u=Math.max(0,u)/g,d=O*(T-n),f=E?Math.min(f,c)/g:f/g,E=function(e,t,r,n){if(n){if(e===r.queryXStart&&t===r.queryXEnd)return"SELECTED";if(e<r.queryXStart||t>r.queryXEnd)return"PARTIAL"}return"NORMAL"}(b,v,a,E),f<C?(_=_+"_"+(0<T?T+1:T-1),void 0!==(m=l.get(p=y+"_"+T))?(h=o[m],g=S(T,a)?Math.min(v-h.source.queryXStart,c)/g:(v-h.source.queryXStart)/g,o[m]={...h,width:Math.max(g,C),source:{...h.source,queryXEnd:v}},s.set(_,h.x)):(m=s.get(y+"_"+T)??u,o.push({x:m,y:d,width:Math.max(f,C),source:{kind:"MERGED",queryXStart:b,queryXEnd:v,type:0<T?"BELOW_ROOT":"ABOVE_ROOT"},state:E}),l.set(p,o.length-1),s.set(_,m))):o.push({x:u,y:d,width:f,source:{kind:"NODE",queryXStart:b,queryXEnd:v,queryIdx:e,type:0<T?"BELOW_ROOT":"ABOVE_ROOT"},state:E}))}return o}(this.attrs.data,this.zoomRegion??{queryXStart:0,queryXEnd:this.attrs.data.allRootsCumulativeValue,type:"ROOT"},e.offsetWidth),this.lastClickedNode=this.renderNodes?.find(e=>T(this.lastClickedNode?.x,this.lastClickedNode?.y,e))),this.tooltipPos=void 0),void 0!==this.attrs.data)&&void 0!==this.renderNodes){var r=r.getBoundingClientRect(),a=e.getBoundingClientRect(),i=r.top-a.top,o=r.bottom-a.top,{allRootsCumulativeValue:s,unfilteredCumulativeValue:l,nodes:c}=this.attrs.data,u=(0,A.assertExists)(this.selectedMetric).unit;n.clearRect(0,0,e.offsetWidth,e.offsetHeight),n.save(),n.scale(devicePixelRatio,devicePixelRatio),n.font="12px Roboto",n.textBaseline="middle",n.strokeStyle="white",n.lineWidth=.5,0===this.labelCharWidth&&(this.labelCharWidth=n.measureText("_").width);let t=void 0;for(let e=0;e<this.renderNodes.length;e++){var d=this.renderNodes[e],{x:f,y:p,width:h,source:g,state:m}=d;if(!(p+O<=i||o<=p)){var _,y=T(this.hoveredX,this.hoveredY,d);y&&(t=d);let e;"ROOT"===g.kind?(d=b(s,u),_=v(s,l),e=`root: ${d} (${_})`,n.fillStyle=E("root","PARTIAL"===m,y)):"MERGED"===g.kind?(e="(merged)",n.fillStyle=E(e,"PARTIAL"===m,!1)):(e=c[g.queryIdx].name,n.fillStyle=E(e,"PARTIAL"===m,y)),n.fillRect(f,p,h-1,O-1);d=h-10;5<=d&&(n.fillStyle="black",n.fillText(e.substring(0,d/this.labelCharWidth),f+5,p+(O-1)/2,d)),this.lastClickedNode?.x===f&&this.lastClickedNode?.y===p&&(n.strokeStyle="blue",n.lineWidth=2,n.beginPath(),n.moveTo(f,p),n.lineTo(f+h,p),n.lineTo(f+h,p+O-1),n.lineTo(f,p+O-1),n.lineTo(f,p),n.stroke(),n.strokeStyle="white",n.lineWidth=.5)}}void 0===t?e.style.cursor="default":e.style.cursor="pointer",n.restore()}}}}renderFilterBar(t){const r=this;return(0,h.default)(".filter-bar",(0,h.default)(i.Select,{value:t.selectedMetricName,onchange:e=>{e=e.target;t.onMetricChange(e.value),(0,m.scheduleFullRedraw)()}},t.metrics.map(e=>(0,h.default)("option",{value:e.name},e.name))),(0,h.default)(a.Popup,{trigger:(0,h.default)(s.TagInput,{tags:this.rawFilters,value:this.rawFilterText,onChange:e=>{r.rawFilterText=e,(0,m.scheduleFullRedraw)()},onTagAdd:e=>{r.rawFilters=f(r.rawFilters,function(e){var t=e.toLowerCase();{if(t.startsWith("ss: ")||t.startsWith("show stack: "))return"Show Stack: "+e.split(": ",2)[1];if(t.startsWith("hs: ")||t.startsWith("hide stack: "))return"Hide Stack: "+e.split(": ",2)[1];if(t.startsWith("sff: ")||t.startsWith("show from frame: "))return"Show From Frame: "+e.split(": ",2)[1];if(t.startsWith("hf: ")||t.startsWith("hide frame: "))return"Hide Frame: "+e.split(": ",2)[1];if(t.startsWith("p:")||t.startsWith("pivot: "))return"Pivot: "+e.split(": ",2)[1]}return"Show Stack: "+e}(e)),r.rawFilterText="",r.attrs.onFiltersChanged(p(r.switchState,r.rawFilters)),(0,m.scheduleFullRedraw)()},onTagRemove(e){var t=Array.from(r.rawFilters);t.splice(e,1),r.rawFilters=t,r.attrs.onFiltersChanged(p(r.switchState,r.rawFilters)),(0,m.scheduleFullRedraw)()},onfocus(){r.filterFocus=!0},onblur(){r.filterFocus=!1},placeholder:"Add filter..."}),isOpen:r.filterFocus&&0===this.rawFilterText.length,position:a.PopupPosition.Bottom},(0,h.default)(".pf-flamegraph-filter-bar-popup-content",c.trim())),(0,h.default)(l.SegmentedButtons,{options:[{label:"Top Down"},{label:"Bottom Up"}],selectedOption:"TOP_DOWN"===this.switchState?0:1,onOptionSelected:e=>{this.switchState=0===e?"TOP_DOWN":"BOTTOM_UP",r.attrs.onFiltersChanged(p(r.switchState,r.rawFilters)),(0,m.scheduleFullRedraw)()},disabled:function(e){e=e.filter(e=>e.startsWith("Pivot: "));return(0,A.assertTrue)(e.length<=1,"Only one pivot can be active"),1===e.length}(this.rawFilters)}))}renderTooltip(){if(void 0!==this.tooltipPos){const i=this.tooltipPos["node"];if("MERGED"===i.source.kind)return(0,h.default)("div",(0,h.default)(".tooltip-bold-text","(merged)"),(0,h.default)(".tooltip-text","Nodes too small to show, please use filters"));var{nodes:e,allRootsCumulativeValue:t,unfilteredCumulativeValue:r}=(0,A.assertExists)(this.attrs.data),n=(0,A.assertExists)(this.selectedMetric)["unit"];if("ROOT"===i.source.kind){var a=b(t,n);const d=v(t,r);return(0,h.default)("div",(0,h.default)(".tooltip-bold-text","root"),(0,h.default)(".tooltip-text-line",(0,h.default)(".tooltip-bold-text","Cumulative:"),(0,h.default)(".tooltip-text",a+", "+d)))}t=i.source["queryIdx"];const{name:o,cumulativeValue:s,selfValue:l,properties:c}=e[t],u=e=>{this.rawFilters=f(this.rawFilters,e),this.attrs.onFiltersChanged(p(this.switchState,this.rawFilters)),(this.tooltipPos=void 0,m.scheduleFullRedraw)()},d=v(s,r);a=v(l,r);return(0,h.default)("div",(0,h.default)(".tooltip-bold-text",o),(0,h.default)(".tooltip-text-line",(0,h.default)(".tooltip-bold-text","Cumulative:"),(0,h.default)(".tooltip-text",b(s,n)+", "+d)),(0,h.default)(".tooltip-text-line",(0,h.default)(".tooltip-bold-text","Self:"),(0,h.default)(".tooltip-text",b(l,n)+", "+a)),Array.from(c,([e,t])=>(0,h.default)(".tooltip-text-line",(0,h.default)(".tooltip-bold-text",e+":"),(0,h.default)(".tooltip-text",t))),(0,h.default)(g.ButtonBar,{},(0,h.default)(g.Button,{label:"Zoom",onclick:()=>{this.zoomRegion=i.source,(0,m.scheduleFullRedraw)()}}),(0,h.default)(g.Button,{label:"Show Stack",onclick:()=>{u(`Show Stack: ^${o}$`)}}),(0,h.default)(g.Button,{label:"Hide Stack",onclick:()=>{u(`Hide Stack: ^${o}$`)}}),(0,h.default)(g.Button,{label:"Hide Frame",onclick:()=>{u(`Hide Frame: ^${o}$`)}}),(0,h.default)(g.Button,{label:"Show From Frame",onclick:()=>{u(`Show From Frame: ^${o}$`)}}),(0,h.default)(g.Button,{label:"Pivot",onclick:()=>{u(`Pivot: ^${o}$`)}})))}}get selectedMetric(){return this.attrs.metrics.find(e=>e.name===this.attrs.selectedMetricName)}}}return UT}function GT(){if(!xT){xT=1,Object.defineProperty(FT,"__esModule",{value:!0}),FT.USE_NEW_FLAMEGRAPH_IMPL=FT.QueryFlamegraph=void 0,FT.metricsFromTableOrSubquery=function(e,t,r,n,a){var i=[];for(var{name:o,unit:s,columnName:l}of t)i.push({name:o,unit:s,dependencySql:r,statement:`
        select *, ${l} as value
        from ${e}
      `,unaggregatableProperties:n,aggregatableProperties:a});return i};const U=or,n=U.__importDefault(ae());var e=qa();const B=V(),a=ee();var t=Qh();const j=P(),H=D(),G=Z(),i=HT();var r=re();function F(e){return e.startsWith("^")&&e.endsWith("$")?e.slice(1,-1):`%${e}%`}FT.QueryFlamegraph=class{selectedMetricName;data;filters={showStack:[],hideStack:[],showFromFrame:[],hideFrame:[],view:{kind:"TOP_DOWN"}};attrs;selMonitor=new t.Monitor([()=>this.attrs.metrics]);queryLimiter=new e.AsyncLimiter;constructor({attrs:e}){this.attrs=e,this.selectedMetricName=e.metrics[0].name}view({attrs:t}){return this.attrs=t,this.selMonitor.ifStateChanged()&&(this.selectedMetricName=t.metrics[0].name,this.data=void 0,this.fetchData(t)),(0,n.default)(i.Flamegraph,{metrics:t.metrics,selectedMetricName:this.selectedMetricName,data:this.data,onMetricChange:e=>{this.selectedMetricName=e,this.data=void 0,this.fetchData(t)},onFiltersChanged:e=>{this.filters=e,this.data=void 0,this.fetchData(t)}})}async fetchData(e){const t=(0,a.assertExists)(e.metrics.find(e=>e.name===this.selectedMetricName)),r=e.engine,n=this.filters;this.queryLimiter.schedule(async()=>{this.data=await async function(a,{dependencySql:i,statement:o,unaggregatableProperties:s,aggregatableProperties:l},{showStack:c,hideStack:u,showFromFrame:d,hideFrame:f,view:p}){var h={stack:[],error:void 0,hasError:!1};try{var g=[...c],m=("PIVOT"===p.kind&&g.push(p.pivot),0===g.length?"0":g.map((e,t)=>`((name like '${F(e)}') << ${t})`).join(" | ")),_=(1<<g.length)-1,y=0===u.length?"false":u.map(e=>`name like '${F(e)}'`).join(" OR "),T=0===d.length?"0":d.map((e,t)=>`((name like '${F(e)}') << ${t})`).join(" | "),b=(1<<d.length)-1,v=0===f.length?"false":f.map(e=>`name like '${F(e)}'`).join(" OR "),E=function(e){return"PIVOT"!==e.kind?"BOTTOM_UP"!==e.kind?"0":"value > 0":`name like '${F(e.pivot)}'`}(p),S=s??[],A=S.map(e=>e.name),O=l??[],C=O.map(e=>e.name),k=`(${(0===A.length?["groupingColumn"]:A).join()})`,w=`(${(0===C.length?["groupedColumn"]:C).join()})`,R=(void 0!==i&&await a.query(i),await a.query("include perfetto module viz.flamegraph;"),(0,j.uuidv4Sql)()),I=U.__addDisposableResource(h,new B.AsyncDisposableStack,!0);I.use(await(0,H.createPerfettoTable)(a,"_flamegraph_materialized_statement_"+R,o)),I.use(await(0,H.createPerfettoIndex)(a,`_flamegraph_materialized_statement_${R}_index`,`_flamegraph_materialized_statement_${R}(parentId)`)),I.use(await(0,H.createPerfettoTable)(a,"_flamegraph_source_"+R,`
        select *
        from _viz_flamegraph_prepare_filter!(
          (
            select
              s.id,
              s.parentId,
              s.name,
              s.value,
              ${(0===A.length?["'' as groupingColumn"]:A.map(e=>"s."+e)).join()},
              ${(0===C.length?["'' as groupedColumn"]:C.map(e=>"s."+e)).join()}
            from _flamegraph_materialized_statement_${R} s
          ),
          (${m}),
          (${y}),
          (${T}),
          (${v}),
          (${E}),
          ${1<<g.length},
          ${k}
        )
      `)),I.use(await(0,H.createPerfettoTable)(a,"_flamegraph_filtered_"+R,`
        select *
        from _viz_flamegraph_filter_frames!(
          _flamegraph_source_${R},
          ${b}
        )
      `)),I.use(await(0,H.createPerfettoTable)(a,"_flamegraph_accumulated_"+R,`
        select *
        from _viz_flamegraph_accumulate!(
          _flamegraph_filtered_${R},
          ${_}
        )
      `)),I.use(await(0,H.createPerfettoTable)(a,"_flamegraph_hash_"+R,`
        select *
        from _viz_flamegraph_downwards_hash!(
          _flamegraph_source_${R},
          _flamegraph_filtered_${R},
          _flamegraph_accumulated_${R},
          ${k},
          ${w},
          ${"BOTTOM_UP"===p.kind?"FALSE":"TRUE"}
        )
        union all
        select *
        from _viz_flamegraph_upwards_hash!(
          _flamegraph_source_${R},
          _flamegraph_filtered_${R},
          _flamegraph_accumulated_${R},
          ${k},
          ${w}
        )
        order by hash
      `)),I.use(await(0,H.createPerfettoTable)(a,"_flamegraph_merged_"+R,`
        select *
        from _viz_flamegraph_merge_hashes!(
          _flamegraph_hash_${R},
          ${k},
          ${w}
        )
      `)),I.use(await(0,H.createPerfettoTable)(a,"_flamegraph_layout_"+R,`
        select *
        from _viz_flamegraph_local_layout!(
          _flamegraph_merged_${R}
        );
      `));var M=(await a.query(`
    select *
    from _viz_flamegraph_global_layout!(
      _flamegraph_merged_${R},
      _flamegraph_layout_${R},
      ${k},
      ${w}
    )
  `)).iter({id:G.NUM,parentId:G.NUM,depth:G.NUM,name:G.STR,selfValue:G.NUM,cumulativeValue:G.NUM,xStart:G.NUM,xEnd:G.NUM,...Object.fromEntries(A.map(e=>[e,G.STR_NULL])),...Object.fromEntries(C.map(e=>[e,G.STR_NULL]))});let e=0,t=0,r=0,n=0;for(var P=[];M.valid();M.next()){var N=new Map;for(const L of[...O,...S]){var D=M.get(L.name);null!==D&&N.set(L.displayName,D)}P.push({id:M.id,parentId:M.parentId,depth:M.depth,name:M.name,selfValue:M.selfValue,cumulativeValue:M.cumulativeValue,xStart:M.xStart,xEnd:M.xEnd,properties:N}),1===M.depth?e+=M.cumulativeValue:-1===M.depth&&(t+=M.cumulativeValue),r=Math.min(r,M.depth),n=Math.max(n,M.depth)}var x=(await a.query("select sum(value) v from _flamegraph_source_"+R)).firstRow({v:G.NUM_NULL}).v??0;return{nodes:P,allRootsCumulativeValue:"BOTTOM_UP"===p.kind?t:e,unfilteredCumulativeValue:x,minDepth:r,maxDepth:n}}catch(e){h.error=e,h.hasError=!0}finally{c=U.__disposeResources(h);c&&await c}}(r,t,n)})}},FT.USE_NEW_FLAMEGRAPH_IMPL=r.featureFlags.register({id:"useNewFlamegraphImpl",name:"Use new flamegraph implementation",description:"Use new flamgraph implementation in details panels.",defaultValue:!0})}return FT}function VT(){return LT||(LT=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.plugin=a.HEAP_PROFILE_TRACK_KIND=void 0;const i=or.__importDefault(ae()),o=ee();var e=Qh(),t=Go();const s=ua(),l=IT(),c=x(),u=Z(),d=F(),f=function(){if(!MT){MT=1,Object.defineProperty(PT,"__esModule",{value:!0}),PT.HeapProfileTrack=PT.HEAP_PROFILE_TRACK_KIND=void 0;const r=ne();var e=js();const n=oe(),a=IT();var t=Z();const i=D(),o=(PT.HEAP_PROFILE_TRACK_KIND="HeapProfileTrack",{...e.BASE_ROW,type:t.STR});class s extends e.BaseSliceTrack{upid;constructor(e,t){super(e),this.upid=t}async onInit(){return(0,i.createPerfettoTable)(this.engine,"_heap_profile_track_"+this.trackUuid,`
      with
        heaps as (select group_concat(distinct heap_name) h from heap_profile_allocation where upid = ${this.upid}),
        allocation_tses as (select distinct ts from heap_profile_allocation where upid = ${this.upid}),
        graph_tses as (select distinct graph_sample_ts from heap_graph_object where upid = ${this.upid})
      select
        *,
        0 AS dur,
        0 AS depth
      from (
        select
          (
            select a.id
            from heap_profile_allocation a
            where a.ts = t.ts
            order by a.id
            limit 1
          ) as id,
          ts,
          'heap_profile:' || (select h from heaps) AS type
        from allocation_tses t
        union all
        select
          (
            select o.id
            from heap_graph_object o
            where o.graph_sample_ts = g.graph_sample_ts
            order by o.id
            limit 1
          ) as id,
          graph_sample_ts AS ts,
          'graph' AS type
        from graph_tses g
      )
    `)}getSqlSource(){return"_heap_profile_track_"+this.trackUuid}getRowSpec(){return o}rowToSlice(e){var t=this.rowToSliceBase(e);let r=e.type;return"heap_profile:libc.malloc,com.android.art"===r&&(r="heap_profile:com.android.art,libc.malloc"),{...t,type:(0,a.profileType)(r)}}onSliceOver(e){e.tooltip=[e.slice.type]}onSliceClick(e){n.globals.makeSelection(r.Actions.selectHeapProfile({id:e.slice.id,upid:this.upid,ts:e.slice.ts,type:e.slice.type}))}isSelectionHandled(e){return"HEAP_PROFILE"===e.kind}}PT.HeapProfileTrack=s}return PT}(),p=GT(),h=bl(),g=al(),m=le(),_=Gl(),y=RT(),T=P_(),b=ie(),v=oe(),E=de(),S=So(),A=ne(),O=By();a.HEAP_PROFILE_TRACK_KIND="HeapProfileTrack";class C{engine;heapGraphIncomplete;sel;selMonitor=new e.Monitor([()=>this.sel?.ts,()=>this.sel?.upid,()=>this.sel?.type]);flamegraphAttrs;cache=new t.LegacyFlamegraphCache("heap_profile");constructor(e,t){this.engine=e,this.heapGraphIncomplete=t}render(e){if("HEAP_PROFILE"===e.kind){if(!p.USE_NEW_FLAMEGRAPH_IMPL.get())return(this.sel=void 0,i.default)(l.LegacyFlamegraphDetailsPanel,{cache:this.cache,selection:{profileType:(0,l.profileType)(e.type),start:e.ts,end:e.ts,upids:[e.upid]}});const{ts:t,upid:r,type:n}=e;return this.sel=e,this.selMonitor.ifStateChanged()&&(this.flamegraphAttrs=function(e,t,r,n){switch(n){case s.ProfileType.NATIVE_HEAP_PROFILE:return k(e,t,r,[{name:"Unreleased Malloc Size",unit:"B",columnName:"self_size"},{name:"Unreleased Malloc Count",unit:"",columnName:"self_count"},{name:"Total Malloc Size",unit:"B",columnName:"self_alloc_size"},{name:"Total Malloc Count",unit:"",columnName:"self_alloc_count"}]);case s.ProfileType.HEAP_PROFILE:return k(e,t,r,[{name:"Unreleased Size",unit:"B",columnName:"self_size"},{name:"Unreleased Count",unit:"",columnName:"self_count"},{name:"Total Size",unit:"B",columnName:"self_alloc_size"},{name:"Total Count",unit:"",columnName:"self_alloc_count"}]);case s.ProfileType.JAVA_HEAP_SAMPLES:return k(e,t,r,[{name:"Unreleased Allocation Size",unit:"B",columnName:"self_size"},{name:"Unreleased Allocation Count",unit:"",columnName:"self_count"}]);case s.ProfileType.MIXED_HEAP_PROFILE:return k(e,t,r,[{name:"Unreleased Allocation Size (malloc + java)",unit:"B",columnName:"self_size"},{name:"Unreleased Allocation Count (malloc + java)",unit:"",columnName:"self_count"}]);case s.ProfileType.JAVA_HEAP_GRAPH:return function(e,t,r){var n=O.SHOW_HEAP_GRAPH_DOMINATOR_TREE_FLAG.get()?(0,p.metricsFromTableOrSubquery)(`
          (
            select
              id,
              parent_id as parentId,
              name,
              root_type,
              self_size,
              self_count
            from _heap_graph_dominator_class_tree
            where graph_sample_ts = ${t} and upid = ${r}
          )
        `,[{name:"Dominated Object Size",unit:"B",columnName:"self_size"},{name:"Dominated Object Count",unit:"",columnName:"self_count"}],"include perfetto module android.memory.heap_graph.dominator_class_tree;",[{name:"root_type",displayName:"Root Type"}]):[];return{engine:e,metrics:[...(0,p.metricsFromTableOrSubquery)(`
          (
            select
              id,
              parent_id as parentId,
              name,
              root_type,
              self_size,
              self_count
            from _heap_graph_class_tree
            where graph_sample_ts = ${t} and upid = ${r}
          )
        `,[{name:"Object Size",unit:"B",columnName:"self_size"},{name:"Object Count",unit:"",columnName:"self_count"}],"include perfetto module android.memory.heap_graph.class_tree;",[{name:"root_type",displayName:"Root Type"}]),...n]}}(e,t,r);case s.ProfileType.PERF_SAMPLE:return(0,o.assertFalse)(!1,"Perf sample not supported"),{engine:e,metrics:[]}}}(this.engine,t,r,n)),(0,i.default)(".flamegraph-profile",function(e,t){if(e!==s.ProfileType.JAVA_HEAP_GRAPH||!t)return;if(v.globals.state.flamegraphModalDismissed)return;return(0,i.default)(E.Modal,{title:"The flamegraph is incomplete",vAlign:"TOP",content:(0,i.default)("div","The current trace does not have a fully formed flamegraph"),buttons:[{text:"Show the errors",primary:!0,action:()=>S.Router.navigate("#!/info")},{text:"Skip",action:()=>{v.globals.dispatch(A.Actions.dismissFlamegraphModal({})),b.raf.scheduleFullRedraw()}}]})}(n,this.heapGraphIncomplete),(0,i.default)(d.DetailsShell,{fillParent:!0,title:(0,i.default)(".title",function(e){switch(e){case s.ProfileType.HEAP_PROFILE:return"Heap profile";case s.ProfileType.JAVA_HEAP_GRAPH:return"Java heap graph";case s.ProfileType.JAVA_HEAP_SAMPLES:return"Java heap samples";case s.ProfileType.MIXED_HEAP_PROFILE:return"Mixed heap profile";case s.ProfileType.NATIVE_HEAP_PROFILE:return"Native heap profile";case s.ProfileType.PERF_SAMPLE:return(0,o.assertFalse)(!1,"Perf sample not supported"),"Impossible"}}(n),e.type===s.ProfileType.MIXED_HEAP_PROFILE&&(0,i.default)(h.Popup,{trigger:(0,i.default)(g.Icon,{icon:"warning"})},(0,i.default)("",{style:{width:"300px"}},'This is a mixed java/native heap profile, free()s are not visualized. To visualize free()s, remove "all_heaps: true" from the config.'))),description:[],buttons:[(0,i.default)(".time","Snapshot time: ",(0,i.default)(c.Timestamp,{ts:t})),(e.type===s.ProfileType.NATIVE_HEAP_PROFILE||e.type===s.ProfileType.JAVA_HEAP_SAMPLES)&&(0,i.default)(m.Button,{icon:"file_download",intent:_.Intent.Primary,onclick:()=>{!async function(e,t,r){if(void 0!==e)try{var n=await e.query("select pid from process where upid = "+t),a=await(0,y.getCurrentTrace)();(0,T.convertTraceToPprofAndDownload)(a,n.firstRow({pid:u.NUM}).pid,r)}catch(e){throw new Error("Failed to get current trace "+e)}}(this.engine,r,t),b.raf.scheduleFullRedraw()}})]},(0,i.default)(p.QueryFlamegraph,(0,o.assertExists)(this.flamegraphAttrs))))}this.sel=void 0}}function k(e,t,r,n){return{engine:e,metrics:[...(0,p.metricsFromTableOrSubquery)(`
          (
            select
              id,
              parent_id as parentId,
              name,
              mapping_name,
              source_file,
              cast(line_number AS text) as line_number,
              self_size,
              self_count,
              self_alloc_size,
              self_alloc_count
            from _android_heap_profile_callstacks_for_allocations!((
              select
                callsite_id,
                size,
                count,
                max(size, 0) as alloc_size,
                max(count, 0) as alloc_count
              from heap_profile_allocation a
              where a.ts <= ${t} and a.upid = ${r}
            ))
          )
        `,n,"include perfetto module android.memory.heap_profile.callstacks",[{name:"mapping_name",displayName:"Mapping"}],[{name:"source_file",displayName:"Source File"},{name:"line_number",displayName:"Line Number"}])]}}a.plugin={pluginId:"perfetto.HeapProfile",plugin:class{async onTraceLoad(t){for(const e=(await t.engine.query(`
      select distinct upid from heap_profile_allocation
      union
      select distinct upid from heap_graph_object
    `)).iter({upid:u.NUM});e.valid();e.next()){const n=e.upid;t.registerTrack({uri:`/process_${n}/heap_profile`,title:"Heap Profile",tags:{kind:a.HEAP_PROFILE_TRACK_KIND,upid:n},trackFactory:({trackKey:e})=>new f.HeapProfileTrack({engine:t.engine,trackKey:e},n)})}const e=await t.engine.query(`
      select value from stats
      where name = 'heap_graph_non_finalized_graph'
    `);var r=0<e.firstRow({value:u.NUM}).value;t.registerDetailsPanel(new C(t.engine,r))}}}}(Ly)),Ly}var WT,qT,$T={},zT={};function KT(){if(qT)return $T;qT=1,Object.defineProperty($T,"__esModule",{value:!0}),$T.plugin=void 0;const i=or.__importDefault(ae()),c=ue();var e=Go();const o=IT(),u=Z(),s=GT();var t=Qh();const l=F(),d=ee(),f=x(),p=function(){if(!WT){WT=1,Object.defineProperty(zT,"__esModule",{value:!0}),zT.ThreadPerfSamplesProfileTrack=zT.ProcessPerfSamplesProfileTrack=void 0;var e=js();const t=kl(),n=M(),r=K(),a=oe(),i=ne(),o=ua();class s extends e.BaseSliceTrack{constructor(e){super(e)}getRowSpec(){return t.NAMED_ROW}rowToSlice(e){var t=super.rowToSliceBase(e),e=e.name??"",r=(0,n.getColorForSlice)(e);return{...t,title:e,colorScheme:r}}isSelectionHandled(e){return"PERF_SAMPLES"===e.kind}onUpdatedSlices(e){for(const t of e)t.isHighlighted=t===this.hoveredSlice}}zT.ProcessPerfSamplesProfileTrack=class extends s{upid;constructor(e,t){super(e),this.upid=t}getSqlSource(){return`
      select p.id, ts, 0 as dur, 0 as depth, 'Perf Sample' as name
      from perf_sample p
      join thread using (utid)
      where upid = ${this.upid}
        and callsite_id is not null
      order by ts
    `}onSliceClick({slice:e}){a.globals.makeSelection(i.Actions.selectPerfSamples({id:e.id,upid:this.upid,leftTs:r.Time.fromRaw(e.ts),rightTs:r.Time.fromRaw(e.ts),type:o.ProfileType.PERF_SAMPLE}))}};zT.ThreadPerfSamplesProfileTrack=class extends s{utid;constructor(e,t){super(e),this.utid=t}getSqlSource(){return`
      select p.id, ts, 0 as dur, 0 as depth, 'Perf Sample' as name
      from perf_sample p
      where utid = ${this.utid}
        and callsite_id is not null
      order by ts
    `}onSliceClick({slice:e}){a.globals.makeSelection(i.Actions.selectPerfSamples({id:e.id,utid:this.utid,leftTs:r.Time.fromRaw(e.ts),rightTs:r.Time.fromRaw(e.ts),type:o.ProfileType.PERF_SAMPLE}))}}}return zT}(),h=ms();class g{engine;sel;selMonitor=new t.Monitor([()=>this.sel?.leftTs,()=>this.sel?.rightTs,()=>this.sel?.upid,()=>this.sel?.type]);flamegraphAttrs;cache=new e.LegacyFlamegraphCache("perf_samples");constructor(e){this.engine=e}render(e){var t,r,n,a;if("PERF_SAMPLES"===e.kind)return s.USE_NEW_FLAMEGRAPH_IMPL.get()||void 0===e.upid?({leftTs:t,rightTs:r,upid:n,utid:a}=e,this.sel=e,this.selMonitor.ifStateChanged()&&(this.flamegraphAttrs={engine:this.engine,metrics:[...(0,s.metricsFromTableOrSubquery)(void 0===n?`
                (
                  select
                    id,
                    parent_id as parentId,
                    name,
                    mapping_name,
                    source_file,
                    cast(line_number AS text) as line_number,
                    self_count
                  from _linux_perf_callstacks_for_samples!((
                    select p.callsite_id
                    from perf_sample p
                    where p.ts >= ${t}
                      and p.ts <= ${r}
                      and p.utid = ${a}
                  ))
                )
              `:`
                  (
                    select
                      id,
                      parent_id as parentId,
                      name,
                      mapping_name,
                      source_file,
                      cast(line_number AS text) as line_number,
                      self_count
                    from _linux_perf_callstacks_for_samples!((
                      select p.callsite_id
                      from perf_sample p
                      join thread t using (utid)
                      where p.ts >= ${t}
                        and p.ts <= ${r}
                        and t.upid = ${n}
                    ))
                  )
                `,[{name:"Perf Samples",unit:"",columnName:"self_count"}],"include perfetto module linux.perf.samples",[{name:"mapping_name",displayName:"Mapping"}],[{name:"source_file",displayName:"Source File"},{name:"line_number",displayName:"Line Number"}])]}),(0,i.default)(".flamegraph-profile",(0,i.default)(l.DetailsShell,{fillParent:!0,title:(0,i.default)(".title","Perf Samples"),description:[],buttons:[(0,i.default)("div.time","First timestamp: ",(0,i.default)(f.Timestamp,{ts:this.sel.leftTs})),(0,i.default)("div.time","Last timestamp: ",(0,i.default)(f.Timestamp,{ts:this.sel.rightTs}))]},(0,i.default)(s.QueryFlamegraph,(0,d.assertExists)(this.flamegraphAttrs))))):(this.sel=void 0,i.default)(o.LegacyFlamegraphDetailsPanel,{cache:this.cache,selection:{profileType:(0,o.profileType)(e.type),start:e.leftTs,end:e.rightTs,upids:[e.upid]}});this.sel=void 0}}return $T.plugin={pluginId:"perfetto.PerfSamplesProfile",plugin:class{async onTraceLoad(t){for(var e=(await t.engine.query(`
      select distinct upid
      from perf_sample
      join thread using (utid)
      where callsite_id is not null and upid is not null
    `)).iter({upid:u.NUM});e.valid();e.next()){const a=e.upid;t.registerTrack({uri:`/process_${a}/perf_samples_profile`,title:"Process Callstacks",tags:{kind:c.PERF_SAMPLES_PROFILE_TRACK_KIND,upid:a},trackFactory:({trackKey:e})=>new p.ProcessPerfSamplesProfileTrack({engine:t.engine,trackKey:e},a)})}for(var r=(await t.engine.query(`
      select distinct
        utid,
        tid,
        thread.name as threadName,
        upid
      from perf_sample
      join thread using (utid)
      where callsite_id is not null
    `)).iter({utid:u.NUM,tid:u.NUM,threadName:u.STR_NULL,upid:u.NUM_NULL});r.valid();r.next()){const{threadName:i,utid:o,tid:s,upid:l}=r;var n=null===i?"Thread Callstacks "+s:i+" Callstacks "+s;t.registerTrack({uri:(0,h.getThreadUriPrefix)(l,o)+"_perf_samples_profile",title:n,tags:{kind:c.PERF_SAMPLES_PROFILE_TRACK_KIND,utid:o},trackFactory:({trackKey:e})=>new p.ThreadPerfSamplesProfileTrack({engine:t.engine,trackKey:e},o)})}t.registerDetailsPanel(new g(t.engine))}}},$T}var YT,JT={},ZT={};var QT,XT,eb={};function tb(){if(!XT){XT=1,Object.defineProperty(JT,"__esModule",{value:!0}),JT.plugin=void 0;const g=ms(),m=Z(),_=function(){if(!YT){YT=1,Object.defineProperty(ZT,"__esModule",{value:!0}),ZT.ProcessSchedulingTrack=ZT.PROCESS_SCHEDULING_TRACK_KIND=void 0;const l=Rr(),i=Wf(),g=ee(),m=K(),o=ne(),_=Rs(),y=M();var e=vg();const T=Ps(),b=oe(),c=Z();var t=P();ZT.PROCESS_SCHEDULING_TRACK_KIND="ProcessSchedulingTrack";ZT.ProcessSchedulingTrack=class{mousePos;utidHoveredInThisTrack=-1;fetcher=new e.TimelineFetcher(this.onBoundsChange.bind(this));cpuCount;engine;trackUuid=(0,t.uuidv4Sql)();config;constructor(e,t,r){this.engine=e,this.config=t,this.cpuCount=r}async onCreate(){null!==this.config.upid?await this.engine.query(`
        create virtual table process_scheduling_${this.trackUuid}
        using __intrinsic_slice_mipmap((
          select
            id,
            ts,
            iif(
              dur = -1,
              lead(ts, 1, trace_end()) over (partition by cpu order by ts) - ts,
              dur
            ) as dur,
            cpu as depth
          from experimental_sched_upid
          where
            utid != 0 and
            upid = ${this.config.upid}
        ));
      `):((0,g.assertExists)(this.config.utid),await this.engine.query(`
        create virtual table process_scheduling_${this.trackUuid}
        using __intrinsic_slice_mipmap((
          select
            id,
            ts,
            iif(
              dur = -1,
              lead(ts, 1, trace_end()) over (partition by cpu order by ts) - ts,
              dur
            ) as dur,
            cpu as depth
          from sched
          where utid = ${this.config.utid}
        ));
      `))}async onUpdate({visibleWindow:e,resolution:t}){await this.fetcher.requestData(e.toTimeSpan(),t)}async onDestroy(){this.fetcher[Symbol.dispose](),await this.engine.tryQuery(`
      drop table process_scheduling_${this.trackUuid}
    `)}async onBoundsChange(t,r,e){(0,g.assertTrue)(1===l.BigintMath.popcount(e),e+" not pow of 2");var n=await this.queryData(t,r,e),a=n.numRows(),i={kind:"slice",start:t,end:r,resolution:e,length:a,maxCpu:this.cpuCount,starts:new BigInt64Array(a),ends:new BigInt64Array(a),cpus:new Uint32Array(a),utids:new Uint32Array(a)},o=n.iter({ts:c.LONG,dur:c.LONG,cpu:c.NUM,utid:c.NUM});for(let e=0;o.valid();o.next(),e++){const t=m.Time.fromRaw(o.ts);var s=o.dur;const r=m.Time.add(t,s);i.starts[e]=t,i.ends[e]=r,i.cpus[e]=o.cpu,i.utids[e]=o.utid,i.end=m.Time.max(r,i.end)}return i}async queryData(e,t,r){return this.engine.query(`
      select
        (z.ts / ${r}) * ${r} as ts,
        iif(s.dur = -1, s.dur, max(z.dur, ${r})) as dur,
        s.id,
        z.depth as cpu,
        utid
      from process_scheduling_${this.trackUuid}(
        ${e}, ${t}, ${r}
      ) z
      cross join sched s using (id)
    `)}getHeight(){return 40}render({ctx:r,size:e,timescale:n,visibleWindow:a}){var i=this.fetcher.data;if(void 0!==i){(0,T.checkerboardExcept)(r,this.getHeight(),0,e.width,n.timeToPx(i.start),n.timeToPx(i.end)),(0,g.assertTrue)(i.starts.length===i.ends.length),(0,g.assertTrue)(i.starts.length===i.utids.length);var o=Math.floor(30/i.maxCpu);for(let t=0;t<i.ends.length;t++){var s=m.Time.fromRaw(i.starts[t]),l=m.Time.fromRaw(i.ends[t]);if(a.overlaps(s,l)){var c=i.utids[t],u=i.cpus[t],s=Math.floor(n.timeToPx(s)),l=Math.floor(n.timeToPx(l)),l=Math.max(1,l-s),d=b.globals.threads.get(c),f=(d?d.pid:-1)||-1,p=-1!==b.globals.state.hoveredUtid,c=b.globals.state.hoveredUtid===c,f=b.globals.state.hoveredPid===f,d=(0,y.colorForThread)(d);let e;e=p&&!c?f?d.variant:d.disabled:d.base,r.fillStyle=e.cssString,r.fillRect(s,5+o*u+u,l,o)}}var t,h=b.globals.threads.get(this.utidHoveredInThisTrack);void 0!==h&&void 0!==this.mousePos&&(t=`T: ${h.threadName} [${h.tid}]`,h.pid?(h=`P: ${h.procName} [${h.pid}]`,(0,_.drawTrackHoverTooltip)(r,this.mousePos,e,h,t)):(0,_.drawTrackHoverTooltip)(r,this.mousePos,e,t))}}onMouseMove({x:e,y:t,timescale:r}){var n,a=this.fetcher.data;this.mousePos={x:e,y:t},void 0!==a&&(t<5||35<t||(n=Math.floor(30/a.maxCpu),t=Math.floor((t-5)/(n+1)),n=r.pxToHpTime(e).toTime("floor"),[r,e]=(0,i.searchRange)(a.starts,n,(0,i.searchEq)(a.cpus,t)),r===e)||r>=a.starts.length||n>a.ends[r]?(this.utidHoveredInThisTrack=-1,b.globals.dispatch(o.Actions.setHoveredUtidAndPid({utid:-1,pid:-1}))):(t=a.utids[r],this.utidHoveredInThisTrack=t,n=(e=b.globals.threads.get(t))&&e.pid||-1,b.globals.dispatch(o.Actions.setHoveredUtidAndPid({utid:t,pid:n}))))}onMouseOut(){this.utidHoveredInThisTrack=-1,b.globals.dispatch(o.Actions.setHoveredUtidAndPid({utid:-1,pid:-1})),this.mousePos=void 0}}}return ZT}(),y=function(){if(!QT){QT=1,Object.defineProperty(eb,"__esModule",{value:!0}),eb.ProcessSummaryTrack=eb.PROCESS_SUMMARY_TRACK=void 0;const s=Rr(),l=ee(),c=K(),u=M();var e=vg();const i=Ps(),d=Z();var t=P();eb.PROCESS_SUMMARY_TRACK="ProcessSummaryTrack";eb.ProcessSummaryTrack=class{fetcher=new e.TimelineFetcher(this.onBoundsChange.bind(this));engine;config;uuid=(0,t.uuidv4Sql)();constructor(e,t){this.engine=e,this.config=t}async onCreate(){let e;e=null!==this.config.upid?`
        select tt.id as track_id
        from thread_track as tt
        join _thread_available_info_summary using (utid)
        join thread using (utid)
        where thread.upid = ${this.config.upid}
        order by slice_count desc
      `:`
        select tt.id as track_id
        from thread_track as tt
        join _thread_available_info_summary using (utid)
        where tt.utid = ${(0,l.assertExists)(this.config.utid)}
        order by slice_count desc
      `,await this.engine.query(`
      create virtual table process_summary_${this.uuid}
      using __intrinsic_counter_mipmap((
        with
          tt as materialized (
            ${e}
          ),
          ss as (
            select ts, 1.0 as value
            from slice
            join tt using (track_id)
            where slice.depth = 0
            union all
            select ts + dur as ts, -1.0 as value
            from slice
            join tt using (track_id)
            where slice.depth = 0
          )
        select
          ts,
          sum(value) over (order by ts) / (select count() from tt) as value
        from ss
        order by ts
      ));
    `)}async onUpdate({visibleWindow:e,resolution:t}){await this.fetcher.requestData(e.toTimeSpan(),t)}async onBoundsChange(e,t,r){(0,l.assertTrue)(1===s.BigintMath.popcount(r),r+" not pow of 2");var n=await this.engine.query(`
      select last_ts as ts, last_value as utilization
      from process_summary_${this.uuid}(${e}, ${t}, ${r});
    `),a=n.numRows(),i={start:e,end:t,resolution:r,length:a,starts:new BigInt64Array(a),utilizations:new Float64Array(a)},o=n.iter({ts:d.LONG,utilization:d.NUM});for(let e=0;o.valid();o.next(),e++)i.starts[e]=o.ts,i.utilizations[e]=o.utilization;return i}async onDestroy(){await this.engine.tryQuery(`drop table if exists process_summary_${this.uuid};`),this.fetcher[Symbol.dispose]()}getHeight(){return 40}render(e){var{ctx:t,size:r,timescale:n}=e,a=this.fetcher.data;void 0!==a&&((0,i.checkerboardExcept)(t,this.getHeight(),0,r.width,n.timeToPx(a.start),n.timeToPx(a.end)),this.renderSummary(e,a))}renderSummary({ctx:t,timescale:r},n){let a=0,i=40;var e=(0,u.colorForTid)(this.config.pidForColor);t.fillStyle=e.base.cssString,t.beginPath(),t.moveTo(a,i);for(let e=0;e<n.utilizations.length;e++){var o=c.Time.fromRaw(n.starts[e]),s=n.utilizations[e];a=Math.floor(r.timeToPx(o)),t.lineTo(a,i),i=5+Math.round(35*(1-s)),t.lineTo(a,i)}t.lineTo(a,40),t.closePath(),t.fill()}}}return eb}();JT.plugin={pluginId:"perfetto.ProcessSummary",plugin:class{async onTraceLoad(e){await this.addProcessTrackGroups(e),await this.addKernelThreadSummary(e)}async addProcessTrackGroups(e){const t=Math.max(...e.trace.cpus,-1)+1;for(var r=(await e.engine.query(`
      INCLUDE PERFETTO MODULE android.process_metadata;

      select *
      from (
        select
          _process_available_info_summary.upid,
          null as utid,
          process.pid,
          null as tid,
          process.name as processName,
          null as threadName,
          sum_running_dur > 0 as hasSched,
          android_process_metadata.debuggable as isDebuggable,
          ifnull((
            select group_concat(string_value)
            from args
            where
              process.arg_set_id is not null and
              arg_set_id = process.arg_set_id and
              flat_key = 'chrome.process_label'
          ), '') as chromeProcessLabels
        from _process_available_info_summary
        join process using(upid)
        left join android_process_metadata using(upid)
      )
      union all
      select *
      from (
        select
          null,
          utid,
          null as pid,
          tid,
          null as processName,
          thread.name threadName,
          sum_running_dur > 0 as hasSched,
          0 as isDebuggable,
          '' as chromeProcessLabels
        from _thread_available_info_summary
        join thread using (utid)
        where upid is null
      )
  `)).iter({upid:m.NUM_NULL,utid:m.NUM_NULL,pid:m.NUM_NULL,tid:m.NUM_NULL,hasSched:m.NUM_NULL,isDebuggable:m.NUM_NULL,chromeProcessLabels:m.STR});r.valid();r.next()){var n=r.upid,a=r.utid,i=r.pid,o=r.tid,s=Boolean(r.hasSched),l=Boolean(r.isDebuggable),c=r.chromeProcessLabels,u=i??o??n??a??0,d=(0,g.getThreadOrProcUri)(n,a),f=[];if(l&&f.push("debuggable"),s){const p={pidForColor:u,upid:n,utid:a};e.registerTrack({uri:d,title:`${null===n?o:i} schedule`,tags:{kind:_.PROCESS_SCHEDULING_TRACK_KIND},chips:f,trackFactory:()=>new _.ProcessSchedulingTrack(e.engine,p,t),subtitle:c})}else{const h={pidForColor:u,upid:n,utid:a};e.registerTrack({uri:d,title:`${null===n?o:i} summary`,tags:{kind:y.PROCESS_SUMMARY_TRACK},chips:f,trackFactory:()=>new y.ProcessSummaryTrack(e.engine,h),subtitle:c})}}}async addKernelThreadSummary(e){var t=e["engine"],t=(await t.query(`
      select
        t.utid, p.upid, (case p.pid when 2 then 1 else 0 end) isKthreadd
      from
        thread t
        join process p using (upid)
        left join process parent on (p.parent_upid = parent.upid)
        join
          (select true from metadata m
             where (m.name = 'system_name' and m.str_value = 'Linux')
           union
           select 1 from (select true from sched limit 1))
      where
        p.pid = 2 or parent.pid = 2
      order by isKthreadd desc
    `)).iter({utid:m.NUM,upid:m.NUM});if(t.valid()){const r={pidForColor:2,upid:t.upid,utid:t.utid};e.registerTrack({uri:"/kernel",title:"Kernel thread summary",tags:{kind:y.PROCESS_SUMMARY_TRACK},trackFactory:()=>new y.ProcessSummaryTrack(e.engine,r)})}}}}}return JT}var rb,nb,ab={},ib={},ob={};function sb(){if(!rb){rb=1,Object.defineProperty(ob,"__esModule",{value:!0}),ob.CloseTrackButton=void 0;const t=or.__importDefault(ae()),r=X(),n=ne(),a=oe(),i=le();ob.CloseTrackButton=class{view({attrs:e}){return(0,t.default)(i.Button,{onclick:()=>{a.globals.dispatch(n.Actions.removeTracks({trackKeys:[e.trackKey]}))},icon:r.Icons.Close,title:"Close",compact:!0})}}}return ob}var lb,cb,ub={};function db(){if(!cb){cb=1,Object.defineProperty(ab,"__esModule",{value:!0}),ab.plugin=void 0;const n=P(),a=ne(),s=Y(),l=oe(),c=ue(),u=function(){if(!nb){nb=1,Object.defineProperty(ib,"__esModule",{value:!0}),ib.ActiveCPUCountTrack=ib.CPUType=void 0;const t=or.__importDefault(ae()),r=J();var e=qf();const n=sb();ib.CPUType={Big:"big",Mid:"mid",Little:"little"};class a extends e.BaseCounterTrack{cpuType;constructor(e,t,r){super({engine:t,trackKey:e.trackKey}),this.cpuType=r}getTrackShellButtons(){return(0,t.default)(n.CloseTrackButton,{trackKey:this.trackKey})}getDefaultCounterOptions(){var e=super.getDefaultCounterOptions();return e.yRangeRounding="strict",e.yRange="viewport",e}async onInit(){await this.engine.query(`
      INCLUDE PERFETTO MODULE sched.thread_level_parallelism;
      INCLUDE PERFETTO MODULE android.cpu.cluster_type;
    `)}getSqlSource(){return`
      select
        ts,
        active_cpu_count as value
      from ${void 0===this.cpuType?"sched_active_cpu_count":`_active_cpu_count_for_cluster_type(${(0,r.sqliteString)(this.cpuType)})`}
    `}}ib.ActiveCPUCountTrack=a}return ib}(),d=function(){if(!lb){lb=1,Object.defineProperty(ub,"__esModule",{value:!0}),ub.RunnableThreadCountTrack=void 0;const t=or.__importDefault(ae());var e=qf();const r=sb();class n extends e.BaseCounterTrack{constructor(e){super(e)}getTrackShellButtons(){return(0,t.default)(r.CloseTrackButton,{trackKey:this.trackKey})}getDefaultCounterOptions(){var e=super.getDefaultCounterOptions();return e.yRangeRounding="strict",e.yRange="viewport",e}async onInit(){await this.engine.query("INCLUDE PERFETTO MODULE sched.thread_level_parallelism")}getSqlSource(){return`
      select
        ts,
        runnable_thread_count as value
      from sched_runnable_thread_count
    `}}ub.RunnableThreadCountTrack=n}return ub}();function i(e){var t="/active_cpus";return void 0!==e?t+"_"+e:t}function o(e,t){var r=(0,n.uuidv4)();l.globals.dispatchMultiple([a.Actions.addTrack({key:r,uri:e,name:t,trackSortKey:c.PrimaryTrackSortKey.DEBUG_TRACK,trackGroup:s.SCROLLING_TRACK_GROUP}),a.Actions.toggleTrackPinned({trackKey:r})])}ab.plugin={pluginId:"perfetto.Sched",plugin:class{async onTraceLoad(t){const e="/runnable_thread_count",r=(t.registerTrack({uri:e,title:"Runnable thread count",trackFactory:e=>new d.RunnableThreadCountTrack({engine:t.engine,trackKey:e.trackKey})}),t.registerCommand({id:"dev.perfetto.Sched.AddRunnableThreadCountTrackCommand",name:"Add track: runnable thread count",callback:()=>o(e,"Runnable thread count")}),i()),n="Active CPU count";t.registerTrack({uri:r,title:n,trackFactory:e=>new u.ActiveCPUCountTrack(e,t.engine)}),t.registerCommand({id:"dev.perfetto.Sched.AddActiveCPUCountTrackCommand",name:"Add track: active CPU count",callback:()=>o(r,n)});for(const a of Object.values(u.CPUType)){const r=i(a),n=`Active ${a} CPU count`;t.registerTrack({uri:r,title:n,trackFactory:e=>new u.ActiveCPUCountTrack(e,t.engine,a)}),t.registerCommand({id:"dev.perfetto.Sched.AddActiveCPUCountTrackCommand."+a,name:`Add track: active ${a} CPU count`,callback:()=>o(r,n)})}}}}}return ab}var fb,pb={},hb={};function gb(){if(!fb){fb=1,Object.defineProperty(hb,"__esModule",{value:!0}),hb.ScreenshotTab=void 0;const t=or.__importDefault(ae()),r=ee(),n=z();var e=Pl();const a=mf(),i=Nc();class o extends e.BottomTab{static kind="dev.perfetto.ScreenshotDetailsPanel";sliceDetails;static create(e){return new o(e)}constructor(e){super(e),async function(e,t){return(0,a.getSlice)(e,(0,i.asSliceSqlId)(t))}(this.engine,this.config.id).then(e=>this.sliceDetails=e)}renderTabCanvas(){}getTitle(){return this.config.title}viewTab(){return(0,n.exists)(this.sliceDetails)&&(0,n.exists)(this.sliceDetails.args)&&0!=this.sliceDetails.args.length?((0,r.assertTrue)("screenshot.jpg_image"==this.sliceDetails.args[0].key),(0,t.default)(".screenshot-panel",(0,t.default)("img",{src:"data:image/png;base64, "+this.sliceDetails.args[0].displayValue}))):(0,t.default)("h2","Loading Screenshot")}}hb.ScreenshotTab=o}return hb}var mb,_b,yb={};function Tb(){if(!_b){_b=1,Object.defineProperty(pb,"__esModule",{value:!0}),pb.plugin=void 0,pb.decideTracks=async function(e){var t={tracksToAdd:[]},e=await e.query(`
    INCLUDE PERFETTO MODULE android.screenshots;
    select
      count() as count
    from android_screenshots
  `),e=e.firstRow({count:n.NUM})["count"];0<e&&t.tracksToAdd.push({uri:"/screenshots",name:"Screenshots",trackSortKey:n.PrimaryTrackSortKey.ASYNC_SLICE_TRACK});return t};const r=P(),n=ue(),a=gb(),i=function(){if(!mb){mb=1,Object.defineProperty(yb,"__esModule",{value:!0}),yb.ScreenshotsTrack=void 0;var e=wl();const t=gb();class r extends e.CustomSqlTableSliceTrack{static kind="dev.perfetto.ScreenshotsTrack";getSqlDataSource(){return{sqlTableName:"android_screenshots",columns:["*"]}}getDetailsPanel(){return{kind:t.ScreenshotTab.kind,config:{sqlTableName:this.tableName,title:"Screenshots"}}}}yb.ScreenshotsTrack=r}return yb}();pb.plugin={pluginId:"perfetto.Screenshots",plugin:class{async onTraceLoad(t){var e=(await t.engine.query(`
      INCLUDE PERFETTO MODULE android.screenshots;
      select
        count() as count
      from android_screenshots
    `)).firstRow({count:n.NUM})["count"];0<e&&(t.registerTrack({uri:"/screenshots",title:"Screenshots",trackFactory:({trackKey:e})=>new i.ScreenshotsTrack({engine:t.engine,trackKey:e}),tags:{kind:i.ScreenshotsTrack.kind}}),t.registerDetailsPanel(new n.BottomTabToSCSAdapter({tabFactory:e=>{if("GENERIC_SLICE"===e.kind&&e.detailsPanelConfig.kind===a.ScreenshotTab.kind)return e=e.detailsPanelConfig.config,new a.ScreenshotTab({config:e,engine:t.engine,uuid:(0,r.uuidv4)()})}})))}}}}return pb}var bb,vb={},Eb={},Sb={exports:{}};function Ab(){var e,l,r,t,I,n,c,u,d,f,p,a,i,h;return bb||(bb=1,e=Sb,i="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{},r=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,t=0,n={},I={manual:(l=i).Prism&&l.Prism.manual,disableWorkerMessageHandler:l.Prism&&l.Prism.disableWorkerMessageHandler,util:{encode:function e(t){return t instanceof M?new M(t.type,e(t.content),t.alias):Array.isArray(t)?t.map(e):t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(e){return Object.prototype.toString.call(e).slice(8,-1)},objId:function(e){return e.__id||Object.defineProperty(e,"__id",{value:++t}),e.__id},clone:function r(e,n){var a,t;switch(n=n||{},I.util.type(e)){case"Object":if(t=I.util.objId(e),n[t])return n[t];for(var i in a={},n[t]=a,e)e.hasOwnProperty(i)&&(a[i]=r(e[i],n));return a;case"Array":return(t=I.util.objId(e),n[t])?n[t]:(a=[],n[t]=a,e.forEach(function(e,t){a[t]=r(e,n)}),a);default:return e}},getLanguage:function(e){for(;e;){var t=r.exec(e.className);if(t)return t[1].toLowerCase();e=e.parentElement}return"none"},setLanguage:function(e,t){e.className=e.className.replace(RegExp(r,"gi"),""),e.classList.add("language-"+t)},currentScript:function(){if("undefined"==typeof document)return null;if("currentScript"in document)return document.currentScript;try{throw new Error}catch(e){var t=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(e.stack)||[])[1];if(t){var r,n=document.getElementsByTagName("script");for(r in n)if(n[r].src==t)return n[r]}return null}},isActive:function(e,t,r){for(var n="no-"+t;e;){var a=e.classList;if(a.contains(t))return!0;if(a.contains(n))return!1;e=e.parentElement}return!!r}},languages:{plain:n,plaintext:n,text:n,txt:n,extend:function(e,t){var r,n=I.util.clone(I.languages[e]);for(r in t)n[r]=t[r];return n},insertBefore:function(r,e,t,n){var a,i=(n=n||I.languages)[r],o={};for(a in i)if(i.hasOwnProperty(a)){if(a==e)for(var s in t)t.hasOwnProperty(s)&&(o[s]=t[s]);t.hasOwnProperty(a)||(o[a]=i[a])}var l=n[r];return n[r]=o,I.languages.DFS(I.languages,function(e,t){t===l&&e!=r&&(this[e]=o)}),o},DFS:function e(t,r,n,a){a=a||{};var i,o,s,l=I.util.objId;for(i in t)t.hasOwnProperty(i)&&(r.call(t,i,t[i],n||i),o=t[i],"Object"!==(s=I.util.type(o))||a[l(o)]?"Array"!==s||a[l(o)]||(a[l(o)]=!0,e(o,r,i,a)):(a[l(o)]=!0,e(o,r,null,a)))}},plugins:{},highlightAll:function(e,t){I.highlightAllUnder(document,e,t)},highlightAllUnder:function(e,t,r){var n={callback:r,container:e,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};I.hooks.run("before-highlightall",n),n.elements=Array.prototype.slice.apply(n.container.querySelectorAll(n.selector)),I.hooks.run("before-all-elements-highlight",n);for(var a,i=0;a=n.elements[i++];)I.highlightElement(a,!0===t,n.callback)},highlightElement:function(e,t,r){var n=I.util.getLanguage(e),a=I.languages[n],i=(I.util.setLanguage(e,n),e.parentElement);i&&"pre"===i.nodeName.toLowerCase()&&I.util.setLanguage(i,n);var o={element:e,language:n,grammar:a,code:e.textContent};function s(e){o.highlightedCode=e,I.hooks.run("before-insert",o),o.element.innerHTML=o.highlightedCode,I.hooks.run("after-highlight",o),I.hooks.run("complete",o),r&&r.call(o.element)}I.hooks.run("before-sanity-check",o),(i=o.element.parentElement)&&"pre"===i.nodeName.toLowerCase()&&!i.hasAttribute("tabindex")&&i.setAttribute("tabindex","0"),o.code?(I.hooks.run("before-highlight",o),o.grammar?t&&l.Worker?((n=new Worker(I.filename)).onmessage=function(e){s(e.data)},n.postMessage(JSON.stringify({language:o.language,code:o.code,immediateClose:!0}))):s(I.highlight(o.code,o.grammar,o.language)):s(I.util.encode(o.code))):(I.hooks.run("complete",o),r&&r.call(o.element))},highlight:function(e,t,r){e={code:e,grammar:t,language:r};if(I.hooks.run("before-tokenize",e),e.grammar)return e.tokens=I.tokenize(e.code,e.grammar),I.hooks.run("after-tokenize",e),M.stringify(I.util.encode(e.tokens),e.language);throw new Error('The language "'+e.language+'" has no grammar.')},tokenize:function(e,t){var r=t.rest;if(r){for(var n in r)t[n]=r[n];delete t.rest}for(var a=new g,i=(N(a,a.head,e),!function e(t,r,n,a,i,o){for(var s in n)if(n.hasOwnProperty(s)&&n[s]){var l=n[s];l=Array.isArray(l)?l:[l];for(var c=0;c<l.length;++c){if(o&&o.cause==s+","+c)return;for(var u,d=l[c],f=d.inside,p=!!d.lookbehind,h=!!d.greedy,g=d.alias,m=(h&&!d.pattern.global&&(u=d.pattern.toString().match(/[imsuy]*$/)[0],d.pattern=RegExp(d.pattern.source,u+"g")),d.pattern||d),_=a.next,y=i;_!==r.tail&&!(o&&y>=o.reach);y+=_.value.length,_=_.next){var T=_.value;if(r.length>t.length)return;if(!(T instanceof M)){var b,v=1;if(h){if(!(b=P(m,y,t,p))||b.index>=t.length)break;var E=b.index,S=b.index+b[0].length,A=y;for(A+=_.value.length;A<=E;)_=_.next,A+=_.value.length;if(A-=_.value.length,y=A,_.value instanceof M)continue;for(var O=_;O!==r.tail&&(A<S||"string"==typeof O.value);O=O.next)v++,A+=O.value.length;v--,T=t.slice(y,A),b.index-=y}else if(!(b=P(m,0,T,p)))continue;var E=b.index,C=b[0],k=T.slice(0,E),w=T.slice(E+C.length),T=y+T.length,R=(o&&T>o.reach&&(o.reach=T),_.prev),k=(k&&(R=N(r,R,k),y+=k.length),D(r,R,v),new M(s,f?I.tokenize(C,f):C,g,C));_=N(r,R,k),w&&N(r,_,w),1<v&&(C={cause:s+","+c,reach:T},e(t,r,n,_.prev,y,C),o)&&C.reach>o.reach&&(o.reach=C.reach)}}}}}(e,a,t,a.head,0),a),o=[],s=i.head.next;s!==i.tail;)o.push(s.value),s=s.next;return o},hooks:{all:{},add:function(e,t){var r=I.hooks.all;r[e]=r[e]||[],r[e].push(t)},run:function(e,t){var r=I.hooks.all[e];if(r&&r.length)for(var n,a=0;n=r[a++];)n(t)}},Token:M},l.Prism=I,M.stringify=function t(e,r){if("string"==typeof e)return e;var n;if(Array.isArray(e))return n="",e.forEach(function(e){n+=t(e,r)}),n;var a,i={type:e.type,content:t(e.content,r),tag:"span",classes:["token",e.type],attributes:{},language:r},e=e.alias,o=(e&&(Array.isArray(e)?Array.prototype.push.apply(i.classes,e):i.classes.push(e)),I.hooks.run("wrap",i),"");for(a in i.attributes)o+=" "+a+'="'+(i.attributes[a]||"").replace(/"/g,"&quot;")+'"';return"<"+i.tag+' class="'+i.classes.join(" ")+'"'+o+">"+i.content+"</"+i.tag+">"},l.document?((n=I.util.currentScript())&&(I.filename=n.src,n.hasAttribute("data-manual"))&&(I.manual=!0),I.manual||("loading"===(i=document.readyState)||"interactive"===i&&n&&n.defer?document.addEventListener("DOMContentLoaded",o):window.requestAnimationFrame?window.requestAnimationFrame(o):window.setTimeout(o,16))):l.addEventListener&&!I.disableWorkerMessageHandler&&l.addEventListener("message",function(e){var e=JSON.parse(e.data),t=e.language,r=e.code,e=e.immediateClose;l.postMessage(I.highlight(r,I.languages[t],t)),e&&l.close()},!1),h=I,e.exports&&(e.exports=h),void 0!==be&&(be.Prism=h),h.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},h.languages.markup.tag.inside["attr-value"].inside.entity=h.languages.markup.entity,h.languages.markup.doctype.inside["internal-subset"].inside=h.languages.markup,h.hooks.add("wrap",function(e){"entity"===e.type&&(e.attributes.title=e.content.replace(/&amp;/,"&"))}),Object.defineProperty(h.languages.markup.tag,"addInlined",{value:function(e,t){var r={},r=(r["language-"+t]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:h.languages[t]},r.cdata=/^<!\[CDATA\[|\]\]>$/i,{"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:r}}),t=(r["language-"+t]={pattern:/[\s\S]+/,inside:h.languages[t]},{});t[e]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return e}),"i"),lookbehind:!0,greedy:!0,inside:r},h.languages.insertBefore("markup","cdata",t)}}),Object.defineProperty(h.languages.markup.tag,"addAttribute",{value:function(e,t){h.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+e+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[t,"language-"+t],inside:h.languages[t]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),h.languages.html=h.languages.markup,h.languages.mathml=h.languages.markup,h.languages.svg=h.languages.markup,h.languages.xml=h.languages.extend("markup",{}),h.languages.ssml=h.languages.xml,h.languages.atom=h.languages.xml,h.languages.rss=h.languages.xml,i=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/,(n=h).languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+i.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+i.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+i.source+"$"),alias:"url"}}},selector:{pattern:RegExp("(^|[{}\\s])[^{}\\s](?:[^{};\"'\\s]|\\s+(?![\\s{])|"+i.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:i,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},n.languages.css.atrule.inside.rest=n.languages.css,(i=n.languages.markup)&&(i.tag.addInlined("style","css"),i.tag.addAttribute("style","css")),h.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},h.languages.javascript=h.languages.extend("clike",{"class-name":[h.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),h.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,h.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:h.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:h.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:h.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:h.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:h.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),h.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:h.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),h.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),h.languages.markup&&(h.languages.markup.tag.addInlined("script","javascript"),h.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),h.languages.js=h.languages.javascript,void 0!==h&&"undefined"!=typeof document&&(Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),c=function(e,t){return"✖ Error "+e+" while fetching file: "+t},u="✖ Error: File does not exist or is empty",d={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},p="pre[data-src]:not(["+(f="data-src-status")+'="loaded"]):not(['+f+'="loading"])',h.hooks.add("before-highlightall",function(e){e.selector+=", "+p}),h.hooks.add("before-sanity-check",function(e){var a,t,r,n,i,o,s=e.element;s.matches(p)&&(e.code="",s.setAttribute(f,"loading"),(a=s.appendChild(document.createElement("CODE"))).textContent="Loading…",t=s.getAttribute("data-src"),"none"===(e=e.language)&&(r=(/\.(\w+)$/.exec(t)||[,"none"])[1],e=d[r]||r),h.util.setLanguage(a,e),h.util.setLanguage(s,e),(r=h.plugins.autoloader)&&r.loadLanguages(e),r=t,n=function(e){s.setAttribute(f,"loaded");var t,r,n=function(e){var t,r;if(e=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(e||""))return t=Number(e[1]),r=e[2],e=e[3],r?e?[t,Number(e)]:[t,void 0]:[t,t]}(s.getAttribute("data-range"));n&&(t=e.split(/\r\n?|\n/g),r=n[0],n=null==n[1]?t.length:n[1],r<0&&(r+=t.length),r=Math.max(0,Math.min(r-1,t.length)),n<0&&(n+=t.length),n=Math.max(0,Math.min(n,t.length)),e=t.slice(r,n).join("\n"),s.hasAttribute("data-start")||s.setAttribute("data-start",String(r+1))),a.textContent=e,h.highlightElement(a)},i=function(e){s.setAttribute(f,"failed"),a.textContent=e},(o=new XMLHttpRequest).open("GET",r,!0),o.onreadystatechange=function(){4==o.readyState&&(o.status<400&&o.responseText?n(o.responseText):400<=o.status?i(c(o.status,o.statusText)):i(u))},o.send(null))}),a=!(h.plugins.fileHighlight={highlight:function(e){for(var t,r=(e||document).querySelectorAll(p),n=0;t=r[n++];)h.highlightElement(t)}}),h.fileHighlight=function(){a||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),a=!0),h.plugins.fileHighlight.highlight.apply(this,arguments)})),Sb.exports;function M(e,t,r,n){this.type=e,this.content=t,this.alias=r,this.length=0|(n||"").length}function P(e,t,r,n){e.lastIndex=t;t=e.exec(r);return t&&n&&t[1]&&(e=t[1].length,t.index+=e,t[0]=t[0].slice(e)),t}function g(){var e={value:null,prev:null,next:null},t={value:null,prev:e,next:null};e.next=t,this.head=e,this.tail=t,this.length=0}function N(e,t,r){var n=t.next,r={value:r,prev:t,next:n};return t.next=r,n.prev=r,e.length++,r}function D(e,t,r){for(var n=t.next,a=0;a<r&&n!==e.tail;a++)n=n.next;(t.next=n).prev=t,e.length-=a}function o(){I.manual||I.highlightAll()}}var Ob;var Cb,kb,wb;function Rb(){var a,i,e,t;function o(e){0!=(e=e.filter(function(e){e=((e=e)?window.getComputedStyle?getComputedStyle(e):e.currentStyle||null:null)["white-space"];return"pre-wrap"===e||"pre-line"===e})).length&&((e=e.map(function(e){var t,r=e.querySelector("code"),n=e.querySelector(".line-numbers-rows");if(r&&n)return n=e.querySelector(".line-numbers-sizer"),t=r.textContent.split(i),n||((n=document.createElement("span")).className="line-numbers-sizer",r.appendChild(n)),n.innerHTML="0",n.style.display="block",r=n.getBoundingClientRect().height,n.innerHTML="",{element:e,lines:t,lineHeights:[],oneLinerHeight:r,sizer:n}}).filter(Boolean)).forEach(function(e){var n=e.sizer,t=e.lines,a=e.lineHeights,i=e.oneLinerHeight;a[t.length-1]=void 0,t.forEach(function(e,t){var r;e&&1<e.length?((r=n.appendChild(document.createElement("span"))).style.display="block",r.textContent=e):a[t]=i})}),e.forEach(function(e){for(var t=e.sizer,r=e.lineHeights,n=0,a=0;a<r.length;a++)void 0===r[a]&&(r[a]=t.children[n++].getBoundingClientRect().height)}),e.forEach(function(e){var t=e.sizer,r=e.element.querySelector(".line-numbers-rows");t.style.display="none",t.innerHTML="",e.lineHeights.forEach(function(e,t){r.children[t].style.height=e+"px"})}))}Cb||(Cb=1,"undefined"!=typeof Prism&&"undefined"!=typeof document&&(a="line-numbers",i=/\n(?!$)/g,e=Prism.plugins.lineNumbers={getLine:function(e,t){if("PRE"===e.tagName&&e.classList.contains(a)){var r,n=e.querySelector(".line-numbers-rows");if(n)return r=(t=(r=(e=parseInt(e.getAttribute("data-start"),10)||1)+(n.children.length-1))<(t=t<e?e:t)?r:t)-e,n.children[r]}},resize:function(e){o([e])},assumeViewportIndependence:!0},t=void 0,window.addEventListener("resize",function(){e.assumeViewportIndependence&&t===window.innerWidth||(t=window.innerWidth,o(Array.prototype.slice.call(document.querySelectorAll("pre."+a))))}),Prism.hooks.add("complete",function(e){var t,r,n;e.code&&(t=(r=e.element).parentNode)&&/pre/i.test(t.nodeName)&&(r.querySelector(".line-numbers-rows")||Prism.util.isActive(r,a)&&(r.classList.remove(a),t.classList.add(a),r=(r=e.code.match(i))?r.length+1:1,r=new Array(r+1).join("<span></span>"),(n=document.createElement("span")).setAttribute("aria-hidden","true"),n.className="line-numbers-rows",n.innerHTML=r,t.hasAttribute("data-start")&&(t.style.counterReset="linenumber "+(parseInt(t.getAttribute("data-start"),10)-1)),e.element.appendChild(n),o([t]),Prism.hooks.run("line-numbers",e)))}),Prism.hooks.add("line-numbers",function(e){e.plugins=e.plugins||{},e.plugins.lineNumbers=!0})))}function Ib(){if(!kb){kb=1,Object.defineProperty(Eb,"__esModule",{value:!0}),Eb.ThreadSliceDetailsTab=void 0;var e=or;const s=e.__importDefault(ae()),l=X(),c=K(),u=z(),d=ie(),f=Z(),p=le(),h=F(),g=Cf(),m=vl(),_=Rf(),y=ce();var t=Pl();const T=$f(),b=oe(),v=up(),E=nf(),S=vm(),A=mf(),O=bm(),C=Nc(),k=L(),w=rf(),R=ga(),I=jc(),M=yc(),P=e.__importStar(Ab()),N=(Ob||(Ob=1,Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/},Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python,Prism.languages.py=Prism.languages.python),Rb(),[{name:"Ancestor slices",shouldDisplay:e=>void 0!==e.parentId,run:e=>(0,w.addSqlTableTab)({table:R.SqlTables.slice,filters:[`id IN (SELECT id FROM _slice_ancestor_and_self(${e.id}))`],imports:["slices.hierarchy"]})},{name:"Descendant slices",shouldDisplay:()=>!0,run:e=>(0,w.addSqlTableTab)({table:R.SqlTables.slice,filters:[`id IN (SELECT id FROM _slice_descendant_and_self(${e.id}))`],imports:["slices.hierarchy"]})},{name:"Average duration of slice name",shouldDisplay:e=>void 0!==e.name,run:e=>(0,v.addQueryResultsTab)({query:`SELECT AVG(dur) / 1e9 FROM slice WHERE name = '${e.name}'`,title:e.name+" average dur"})},{name:"Binder txn names + monitor contention on thread",shouldDisplay:e=>{return void 0!==a(e)&&void 0!==i(e)&&void 0!==r(e)&&void 0!==n(e)},run:e=>{const t=function(){var e=b.globals.getCurrentEngine()?.id;if(void 0===e)return;e=b.globals.engines.get(e)?.getProxy("SlicePanel");return e}();void 0!==t&&t.query(`
        INCLUDE PERFETTO MODULE android.binder;
        INCLUDE PERFETTO MODULE android.monitor_contention;
      `).then(()=>(0,T.addDebugSliceTrack)({engine:t,registerTrack:e=>b.globals.trackManager.registerTrack(e)},{sqlSource:`
                                WITH merged AS (
                                  SELECT s.ts, s.dur, tx.aidl_name AS name, 0 AS depth
                                  FROM android_binder_txns tx
                                  JOIN slice s
                                    ON tx.binder_txn_id = s.id
                                  JOIN thread_track
                                    ON s.track_id = thread_track.id
                                  JOIN thread
                                    USING (utid)
                                  JOIN process
                                    USING (upid)
                                  WHERE pid = ${n(e)}
                                        AND tid = ${r(e)}
                                        AND aidl_name IS NOT NULL
                                  UNION ALL
                                  SELECT
                                    s.ts,
                                    s.dur,
                                    short_blocked_method || ' -> ' || blocking_thread_name || ':' || short_blocking_method AS name,
                                    1 AS depth
                                  FROM android_binder_txns tx
                                  JOIN android_monitor_contention m
                                    ON m.binder_reply_tid = tx.server_tid AND m.binder_reply_ts = tx.server_ts
                                  JOIN slice s
                                    ON tx.binder_txn_id = s.id
                                  JOIN thread_track
                                    ON s.track_id = thread_track.id
                                  JOIN thread ON thread.utid = thread_track.utid
                                  JOIN process ON process.upid = thread.upid
                                  WHERE process.pid = ${n(e)}
                                        AND thread.tid = ${r(e)}
                                        AND short_blocked_method IS NOT NULL
                                  ORDER BY depth
                                ) SELECT ts, dur, name FROM merged`},`Binder names (${a(e)}:${i(e)})`,{ts:"ts",dur:"dur",name:"name"},[]))}}]);class D extends t.BottomTab{sliceDetails;breakdownByThreadState;static create(e){return new D(e)}static lastRenderTimestamp=0;static currRenderTimestamp=0;static lastClickedSliceId=-1;static doubleClickHandled=!1;constructor(e){super(e),this.load()}async load(){var{id:e,table:t}=this.config,e=(D.lastRenderTimestamp=D.currRenderTimestamp,D.currRenderTimestamp=Date.now(),D.lastClickedSliceId==e?D.doubleClickHandled=!1:D.doubleClickHandled=!0,D.lastClickedSliceId=e,await o(this.engine,e,t));void 0!==e&&void 0!==e.thread&&0<e.dur&&(this.breakdownByThreadState=await(0,O.breakDownIntervalByThreadState)(this.engine,c.TimeSpan.fromTimeAndDuration(e.ts,e.dur),e.thread.utid)),this.sliceDetails=e,d.raf.scheduleFullRedraw()}getTitle(){return"Current Selection"}viewTab(){var e;return(0,u.exists)(this.sliceDetails)?(e=this.sliceDetails,(0,s.default)(h.DetailsShell,{title:"Slice",description:e.name,buttons:this.renderContextButton(e)},(0,s.default)(g.GridLayout,(0,s.default)(g.GridLayoutColumn,(0,S.renderDetails)(e,this.breakdownByThreadState),this.renderRhs(this.engine,e)),(0,s.default)(g.GridLayoutColumn,this.renderVsCodeButton(e),this.renderSourceCode(e))))):(0,s.default)(h.DetailsShell,{title:"Slice",description:"Loading..."})}isLoading(){return!(0,u.exists)(this.sliceDetails)}renderRhs(e,t){var r=this.renderPrecedingFlows(t),n=this.renderFollowingFlows(t),e=(0,E.hasArgs)(t.args)&&(0,s.default)(_.Section,{title:"Arguments"},(0,s.default)(y.Tree,(0,E.renderArguments)(e,t.args)));if(r??n??e)return(0,s.default)(g.GridLayoutColumn,r,n,e)}renderPrecedingFlows(t){var e=b.globals.connectedFlows.filter(({end:e})=>e.sliceId===t.id);if(0<e.length){const r="ThreadControllerImpl::RunTask"===t.name||"ThreadPool_RunTask"===t.name;return(0,s.default)(_.Section,{title:"Preceding Flows"},(0,s.default)(M.BasicTable,{columns:[{title:"Slice",render:e=>(0,s.default)(I.SliceRef,{id:(0,C.asSliceSqlId)(e.begin.sliceId),name:e.begin.sliceChromeCustomName??e.begin.sliceName,ts:e.begin.sliceStartTs,dur:e.begin.sliceEndTs-e.begin.sliceStartTs,sqlTrackId:e.begin.trackId})},{title:"Delay",render:e=>(0,s.default)(k.DurationWidget,{dur:e.end.sliceStartTs-e.begin.sliceEndTs})},{title:"Thread",render:e=>this.getThreadNameForFlow(e.begin,!r)}],data:e}))}return null}renderFollowingFlows(t){var e=b.globals.connectedFlows.filter(({begin:e})=>e.sliceId===t.id);if(0<e.length){const r="ThreadPool_PostTask"===t.name||"SequenceManager PostTask"===t.name;return(0,s.default)(_.Section,{title:"Following Flows"},(0,s.default)(M.BasicTable,{columns:[{title:"Slice",render:e=>(0,s.default)(I.SliceRef,{id:(0,C.asSliceSqlId)(e.end.sliceId),name:e.end.sliceChromeCustomName??e.end.sliceName,ts:e.end.sliceStartTs,dur:e.end.sliceEndTs-e.end.sliceStartTs,sqlTrackId:e.end.trackId})},{title:"Delay",render:e=>(0,s.default)(k.DurationWidget,{dur:e.end.sliceEndTs-e.end.sliceStartTs})},{title:"Thread",render:e=>this.getThreadNameForFlow(e.end,!r)}],data:e}))}return null}getThreadNameForFlow(e,t){return t?`${e.threadName} (${e.processName})`:e.threadName}renderContextButton(r){t=r;var t,e,n=N.filter(e=>e.shouldDisplay(t));if(0<n.length)return e=(0,s.default)(p.Button,{compact:!0,label:"Contextual Options",rightIcon:l.Icons.ContextMenu}),(0,s.default)(m.PopupMenu2,{trigger:e},n.map(({name:e,run:t})=>(0,s.default)(m.MenuItem,{label:e,onclick:()=>t(r)})))}renderVsCodeButton(e){var e=e.name,t=b.globals.sourceFileStorage;if(b.globals.inVscode&&t&&t.functions){const r=t.functions[e]||null;if(r)return!D.doubleClickHandled&&D.currRenderTimestamp-D.lastRenderTimestamp<500&&(D.doubleClickHandled=!0,window.parent.postMessage({type:"viztracer",action:"openfile",file:r[0],line:r[1]},"*")),(0,s.default)("button",{style:{display:"flex","align-items":"center","justify-content":"center","background-color":"#2d2d2d",padding:"4px","border-radius":"6px",color:"#fff"},onclick:()=>{window.parent.postMessage({type:"viztracer",action:"openfile",file:r[0],line:r[1]},"*")}},"Open in VSCode",(0,s.default)("img",{src:b.globals.root+"assets/vscode-icon.png",style:{"margin-left":"6px",width:"12px"}}))}return(0,s.default)("div",{style:{display:"none"}})}renderSourceCode(e){var t=e.name,r=b.globals.sourceFileStorage;if(r&&r.functions){t=r.functions[t]||null;if(t){var n=t[0];const a=t[1];t=r.files[n][0];const i=r.files[n][1];r=document.createElement("pre"),n=document.createElement("code"),n=(r.className="language-py line-numbers",n.className="language-py",r.appendChild(n),n.innerHTML=P.highlight(t,P.languages.python,"python"),{element:n,language:"python",grammar:P.languages.python,code:t});return P.hooks.run("complete",n),(0,s.default)("pre.language-py.line-numbers",{oncreate:e=>{this.resize(e,a,i,!0)},onupdate:e=>{this.resize(e,a,i)}},s.default.trust(r.innerHTML))}}t=this.getObjStr(e);return t?this.renderObjStr(t):(0,s.default)("h1","No source code found")}renderObjStr(e){var t=document.createElement("pre"),r=document.createElement("code"),r=(t.className="language-py",r.className="language-py",t.appendChild(r),r.innerHTML=P.highlight(e,P.languages.python,"python"),{element:r,language:"python",grammar:P.languages.python,code:e});return P.hooks.run("complete",r),(0,s.default)("pre.language-py",{oncreate:e=>{this.resize(e,-1,-1)},onupdate:e=>{this.resize(e,-1,-1)}},s.default.trust(t.innerHTML))}getObjStr(e){if(e.args)for(const n of e.args){var t=n.key,r=n.value;if("args.object"==t&&"string"==typeof r)return r}return""}resize(e,t,r,n=!1){var a=document.getElementsByClassName("details-panel-container")[0]?.clientHeight,i=document.getElementsByClassName("handle")[0]?.clientHeight,o=document.getElementsByClassName("pf-header-bar")[0]?.clientHeight,s=e.dom,e=e.dom.children[0];s.style.height=a-i-o+"px",n&&(s.scrollTop=12+(t-1)/r*e.offsetHeight)}}function r(e){return e.thread?.tid}function n(e){return e.process?.pid}function a(e){return e.process?.name}function i(e){return e.thread?.name}async function o(e,t,r){return"annotation_slice"===r?async function(e,t){return e=(await e.query(`
    SELECT
      id,
      name,
      ts,
      dur,
      track_id as trackId,
      thread_dur as threadDur,
      cat,
      ABS_TIME_STR(ts) as absTime
    FROM annotation_slice
    where id = `+t)).firstRow({id:f.NUM,name:f.STR_NULL,ts:f.LONG,dur:f.LONG,trackId:f.NUM,threadDur:f.LONG_NULL,cat:f.STR_NULL,absTime:f.STR_NULL}),{id:(0,C.asSliceSqlId)(e.id),name:e.name??"null",ts:c.Time.fromRaw(e.ts),dur:e.dur,depth:0,trackId:e.trackId,threadDur:e.threadDur??void 0,category:e.cat??void 0,absTime:e.absTime??void 0}}(e,t):(0,A.getSlice)(e,(0,C.asSliceSqlId)(t))}Eb.ThreadSliceDetailsTab=D}return Eb}var Mb,Pb={},Nb={};var Db,xb,Lb={};function Fb(){if(!xb){xb=1,Object.defineProperty(Pb,"__esModule",{value:!0}),Pb.plugin=void 0;const u=P(),d=ue(),f=Nc(),p=function(){if(!Mb){Mb=1,Object.defineProperty(Nb,"__esModule",{value:!0}),Nb.ThreadStateTab=void 0;const s=or.__importDefault(ae()),l=K(),t=ie(),a=se(),c=le(),r=F(),n=Cf(),i=Rf(),o=Lg(),u=ce(),d=Gl();var e=Pl();const f=Sf(),p=L(),h=x(),g=$f(),m=oe(),_=hf(),y=gf(),T=Df();class b extends e.BottomTab{static kind="dev.perfetto.ThreadStateTab";state;relatedStates;loaded=!1;static create(e){return new b(e)}constructor(e){super(e),this.load().then(()=>{this.loaded=!0,t.raf.scheduleFullRedraw()})}async load(){var e;this.state=await(0,f.getThreadState)(this.engine,this.config.id),this.state&&((e={}).prev=(await(0,f.getThreadStateFromConstraints)(this.engine,{filters:["ts + dur = "+this.state.ts,"utid = "+this.state.thread?.utid],limit:1}))[0],e.next=(await(0,f.getThreadStateFromConstraints)(this.engine,{filters:["ts = "+(this.state.ts+this.state.dur),"utid = "+this.state.thread?.utid],limit:1}))[0],void 0!==this.state.wakerThread?.utid&&(e.waker=(await(0,f.getThreadStateFromConstraints)(this.engine,{filters:["utid = "+this.state.wakerThread?.utid,"ts <= "+this.state.ts,"ts + dur >= "+this.state.ts]}))[0]),e.wakee=await(0,f.getThreadStateFromConstraints)(this.engine,{filters:["waker_utid = "+this.state.thread?.utid,"state = 'R'","ts >= "+this.state.ts,"ts <= "+(this.state.ts+this.state.dur)]}),this.relatedStates=e)}getTitle(){return"Current Selection"}viewTab(){return(0,s.default)(r.DetailsShell,{title:"Thread State",description:this.renderLoadingText()},(0,s.default)(n.GridLayout,(0,s.default)(i.Section,{title:"Details"},this.state&&this.renderTree(this.state)),(0,s.default)(i.Section,{title:"Related thread states"},this.renderRelatedThreadStates())))}renderLoadingText(){return this.loaded?this.state?this.config.id:`Thread state ${this.config.id} does not exist`:"Loading"}renderTree(e){var t=e.thread,r=e.thread?.process;return(0,s.default)(u.Tree,(0,s.default)(u.TreeNode,{left:"Start time",right:(0,s.default)(h.Timestamp,{ts:e.ts})}),(0,s.default)(u.TreeNode,{left:"Duration",right:(0,s.default)(p.DurationWidget,{dur:e.dur})}),(0,s.default)(u.TreeNode,{left:"State",right:this.renderState(e.state,e.cpu,e.schedSqlId,e.ts)}),e.blockedFunction&&(0,s.default)(u.TreeNode,{left:"Blocked function",right:e.blockedFunction}),r&&(0,s.default)(u.TreeNode,{left:"Process",right:(0,_.getProcessName)(r)}),t&&(0,s.default)(u.TreeNode,{left:"Thread",right:(0,y.getThreadName)(t)}),e.wakerThread&&this.renderWakerThread(e.wakerThread),(0,s.default)(u.TreeNode,{left:"SQL ID",right:(0,s.default)(o.SqlRef,{table:"thread_state",id:e.threadStateSqlId})}))}renderState(e,t,r,n){return e?void 0===r||void 0===t?e:(0,s.default)(a.Anchor,{title:"Go to CPU slice",icon:"call_made",onclick:()=>(0,f.goToSchedSlice)(t,r,n)},e+" on CPU "+t):null}renderWakerThread(e){return(0,s.default)(u.TreeNode,{left:"Waker"},(0,s.default)(u.TreeNode,{left:"Process",right:(0,_.getProcessName)(e.process)}),(0,s.default)(u.TreeNode,{left:"Thread",right:(0,y.getThreadName)(e)}))}renderRelatedThreadStates(){if(void 0===this.state||void 0===this.relatedStates)return"Loading";const t=this.state.ts,r=(e,t)=>(0,s.default)(T.ThreadStateRef,{id:e.threadStateSqlId,ts:e.ts,dur:e.dur,utid:e.thread.utid,name:t}),e={ts:"ts",dur:"dur",name:"name"},n=["id","utid","ts","dur","name","table_name"],a={ts:"ts",dur:"dur",name:"thread_name"},i=["id","utid","ts","dur","thread_name","process_name","table_name"];var o=e=>e.state+" for "+(0,p.renderDuration)(e.dur);return[(0,s.default)(u.Tree,this.relatedStates.waker&&(0,s.default)(u.TreeNode,{left:"Waker",right:r(this.relatedStates.waker,(0,y.getFullThreadName)(this.relatedStates.waker.thread))}),this.relatedStates.prev&&(0,s.default)(u.TreeNode,{left:"Previous state",right:r(this.relatedStates.prev,o(this.relatedStates.prev))}),this.relatedStates.next&&(0,s.default)(u.TreeNode,{left:"Next state",right:r(this.relatedStates.next,o(this.relatedStates.next))}),this.relatedStates.wakee&&0<this.relatedStates.wakee.length&&(0,s.default)(u.TreeNode,{left:"Woken threads"},this.relatedStates.wakee.map(e=>(0,s.default)(u.TreeNode,{left:(0,s.default)(h.Timestamp,{ts:e.ts,display:["Start+",(0,s.default)(p.DurationWidget,{dur:l.Time.sub(e.ts,t)})]}),right:r(e,(0,y.getFullThreadName)(e.thread))})))),(0,s.default)(c.Button,{label:"Critical path lite",intent:d.Intent.Primary,onclick:()=>this.engine.query("INCLUDE PERFETTO MODULE sched.thread_executing_span;").then(()=>(0,g.addDebugSliceTrack)({engine:this.engine,registerTrack:e=>m.globals.trackManager.registerTrack(e)},{sqlSource:`
                    SELECT
                      cr.id,
                      cr.utid,
                      cr.ts,
                      cr.dur,
                      thread.name AS thread_name,
                      process.name AS process_name,
                      'thread_state' AS table_name
                    FROM
                      _thread_executing_span_critical_path(
                        ${this.state?.thread?.utid},
                        trace_bounds.start_ts,
                        trace_bounds.end_ts - trace_bounds.start_ts) cr,
                      trace_bounds
                    JOIN thread USING(utid)
                    JOIN process USING(upid)
                  `,columns:i},""+this.state?.thread?.name,a,i))}),(0,s.default)(c.Button,{label:"Critical path",intent:d.Intent.Primary,onclick:()=>this.engine.query("INCLUDE PERFETTO MODULE sched.thread_executing_span_with_slice;").then(()=>(0,g.addDebugSliceTrack)({engine:this.engine,registerTrack:e=>m.globals.trackManager.registerTrack(e)},{sqlSource:`
                    SELECT cr.id, cr.utid, cr.ts, cr.dur, cr.name, cr.table_name
                      FROM
                        _thread_executing_span_critical_path_stack(
                          ${this.state?.thread?.utid},
                          trace_bounds.start_ts,
                          trace_bounds.end_ts - trace_bounds.start_ts) cr,
                        trace_bounds WHERE name IS NOT NULL
                  `,columns:n},""+this.state?.thread?.name,e,n))})]}isLoading(){return void 0===this.state||void 0===this.relatedStates}}Nb.ThreadStateTab=b}return Nb}(),h=ue(),g=ms(),m=Z(),_=function(){if(!Db){Db=1;{var e=Lb;Object.defineProperty(e,"__esModule",{value:!0}),e.ThreadStateTrack=e.THREAD_STATE_ROW=void 0;const a=ne(),i=M(),o=bf();var t=js();const s=oe();var r=xs(),n=Z();e.THREAD_STATE_ROW={...t.BASE_ROW,state:n.STR,ioWait:n.NUM_NULL};class l extends t.BaseSliceTrack{utid;sliceLayout={...r.SLICE_LAYOUT_FLAT_DEFAULTS};constructor(e,t){super(e),this.utid=t}getRowSpec(){return e.THREAD_STATE_ROW}getSqlSource(){return`
      select
        id,
        ts,
        dur,
        cpu,
        state,
        io_wait as ioWait,
        0 as depth
      from thread_state
      where
        utid = ${this.utid} and
        state not in ('S', 'I')
    `}rowToSlice(e){var t=this.rowToSliceBase(e),r=null===e.ioWait?void 0:!!e.ioWait,e=(0,o.translateState)(e.state,r),r=(0,i.colorForState)(e);return{...t,title:e,colorScheme:r}}onUpdatedSlices(e){for(const t of e)t.isHighlighted=t===this.hoveredSlice}onSliceClick(e){s.globals.makeSelection(a.Actions.selectThreadState({id:e.slice.id,trackKey:this.trackKey}))}isSelectionHandled(e){return"THREAD_STATE"===e.kind}}e.ThreadStateTrack=l}}return Lb}(),y=sc();Pb.plugin={pluginId:"perfetto.ThreadState",plugin:class{async onTraceLoad(t){for(var e=t["engine"],r=(await e.query(`
      include perfetto module viz.threads;
      include perfetto module viz.summary.threads;

      select
        utid,
        t.upid,
        tid,
        t.name as threadName,
        is_main_thread as isMainThread,
        is_kernel_thread as isKernelThread
      from _threads_with_kernel_flag t
      join _sched_summary using (utid)
    `)).iter({utid:m.NUM,upid:m.NUM_NULL,tid:m.NUM_NULL,threadName:m.STR_NULL,isMainThread:m.NUM_NULL,isKernelThread:m.NUM});r.valid();r.next()){const{utid:a,upid:i,tid:o,threadName:s,isMainThread:l,isKernelThread:c}=r;var n=(0,g.getTrackName)({utid:a,tid:o,threadName:s,kind:d.THREAD_STATE_TRACK_KIND});t.registerTrack({uri:(0,g.getThreadUriPrefix)(i,a)+"_state",title:n,tags:{kind:d.THREAD_STATE_TRACK_KIND,utid:a},chips:(0,y.removeFalsyValues)([0===c&&1===l&&"main thread"]),trackFactory:({trackKey:e})=>new _.ThreadStateTrack({engine:t.engine,trackKey:e},a)})}t.registerDetailsPanel(new h.BottomTabToSCSAdapter({tabFactory:e=>{if("THREAD_STATE"===e.kind)return new p.ThreadStateTab({config:{id:(0,f.asThreadStateSqlId)(e.id)},engine:t.engine,uuid:(0,u.uuidv4)()})}}))}}}}return Pb}var Ub,Bb={};var jb,Hb,Gb,Vb={},Wb={};function qb(){if(!jb){jb=1,Object.defineProperty(Wb,"__esModule",{value:!0}),Wb.extractTraceConfig=function(e){try{var t=r.EnableTracingRequest.decode(e);if(t.traceConfig)return r.TraceConfig.encode(t.traceConfig).finish()}catch(e){console.error("Error extracting the config: ",e.message)}},Wb.extractDurationFromTraceConfig=function(e){try{return r.TraceConfig.decode(e).durationMs}catch(e){}},Wb.browserSupportsPerfettoConfig=function(){var e=String((/Chrome\/(([0-9]+\.?){4})/.exec(navigator.userAgent)||[,0])[1]);if(!e)return!1;var t="91.0.4448.0".split(".").map(Number),r=e.split(".").map(Number);for(let e=0;e<t.length;e++)if(r[e]!==t[e])return r[e]>t[e];return!0},Wb.hasSystemDataSourceConfig=function(e){for(const t of e.dataSources)if(!(t.config?.name??"").startsWith("org.chromium."))return!0;return!1},Wb.hasWattsonSupport=async function(e){var t=[`
    INCLUDE PERFETTO MODULE wattson.device_infos;
    SELECT COUNT(*) as numRows FROM _wattson_device
    `,`
    INCLUDE PERFETTO MODULE linux.cpu.frequency;
    SELECT COUNT(*) as numRows FROM cpu_frequency_counters
    `,`
    INCLUDE PERFETTO MODULE linux.cpu.idle;
    SELECT COUNT(*) as numRows FROM cpu_idle_counters
    `];for(const r of t)if(0===(await e.query(r)).firstRow({numRows:n.NUM}).numRows)return!1;return!0};const r=Sa(),n=Z()}return Wb}function $b(){var e,t,r,n,a,i,o,s,l,c,u,d,f,p,h,g,m,_,y,T,b,v,E,S,A;Gb||(Gb=1,Object.defineProperty(Kh,"__esModule",{value:!0}),e=gp(),t=Eg(),r=function(){if(!Ag){Ag=1,Object.defineProperty(Og,"__esModule",{value:!0}),Og.plugin=void 0;const i=ue(),o=Zl(),s=Z(),l=kg(),c=ue();Og.plugin={pluginId:"perfetto.Annotation",plugin:class{async onTraceLoad(e){await this.addAnnotationTracks(e),await this.addAnnotationCounterTracks(e)}async addAnnotationTracks(t){for(var e=t["engine"],r=(await e.query(`
      select id, name
      from annotation_slice_track
      order by name
    `)).iter({id:s.NUM,name:s.STR});r.valid();r.next()){const a=r.id;var n=r.name;t.registerTrack({uri:"/annotation_"+a,title:n,tags:{kind:c.THREAD_SLICE_TRACK_KIND},chips:["metric"],trackFactory:({trackKey:e})=>new o.ThreadSliceTrack({engine:t.engine,trackKey:e},a,0,"annotation_slice")})}}async addAnnotationCounterTracks(t){for(var e=t["engine"],r=(await e.query(`
      SELECT
        id,
        name,
        min_value as minValue,
        max_value as maxValue
      FROM annotation_counter_track`)).iter({id:s.NUM,name:s.STR,minValue:s.NUM_NULL,maxValue:s.NUM_NULL});r.valid();r.next()){const a=r.id;var n=r.name;t.registerTrack({uri:"/annotation_counter_"+a,title:n,tags:{kind:i.COUNTER_TRACK_KIND},chips:["metric"],trackFactory:e=>new l.TraceProcessorCounterTrack({engine:t.engine,trackKey:e.trackKey,trackId:a,rootTable:"annotation_counter"})})}}}}}return Og}(),n=function(){if(!wg){wg=1,Object.defineProperty(Rg,"__esModule",{value:!0}),Rg.plugin=void 0;const u=ue(),d=ms(),f=Z(),p=qh();Rg.plugin={pluginId:"perfetto.AsyncSlices",plugin:class{async onTraceLoad(e){await this.addGlobalAsyncTracks(e),await this.addProcessAsyncSliceTracks(e),await this.addUserAsyncSliceTracks(e)}async addGlobalAsyncTracks(e){const t=e["engine"];for(var r=(await t.query(`
      with global_tracks_grouped as (
        select
          parent_id,
          name,
          group_concat(id) as trackIds,
          count() as trackCount
        from track t
        join _slice_track_summary using (id)
        where t.type in ('track', 'gpu_track', 'cpu_track')
        group by parent_id, name
      )
      select
        t.name as name,
        t.parent_id as parentId,
        t.trackIds as trackIds,
        __max_layout_depth(t.trackCount, t.trackIds) as maxDepth
      from global_tracks_grouped t
    `)).iter({name:f.STR_NULL,parentId:f.NUM_NULL,trackIds:f.STR,maxDepth:f.NUM});r.valid();r.next()){var n=null===r.name?void 0:r.name,a=(0,d.getTrackName)({name:n,kind:u.ASYNC_SLICE_TRACK_KIND});const i=r.trackIds.split(",").map(e=>Number(e)),o=r.maxDepth;e.registerTrack({uri:`/async_slices_${n}_`+r.parentId,title:a,tags:{trackIds:i,kind:u.ASYNC_SLICE_TRACK_KIND},trackFactory:({trackKey:e})=>new p.AsyncSliceTrack({engine:t,trackKey:e},o,i)})}}async addProcessAsyncSliceTracks(t){for(var e=(await t.engine.query(`
      select
        upid,
        t.name as trackName,
        t.track_ids as trackIds,
        process.name as processName,
        process.pid as pid,
        __max_layout_depth(t.track_count, t.track_ids) as maxDepth
      from _process_track_summary_by_upid_and_name t
      join process using(upid)
      where t.name is null or t.name not glob "* Timeline"
    `)).iter({upid:f.NUM,trackName:f.STR_NULL,trackIds:f.STR,processName:f.STR_NULL,pid:f.NUM_NULL,maxDepth:f.NUM});e.valid();e.next()){var r=e.upid,n=e.trackName,a=e.trackIds;const l=a.split(",").map(e=>Number(e));var i=e.processName,o=e.pid;const c=e.maxDepth;var s=u.ASYNC_SLICE_TRACK_KIND,n=(0,d.getTrackName)({name:n,upid:r,pid:o,processName:i,kind:s});t.registerTrack({uri:`/process_${r}/async_slices_`+a,title:n,tags:{trackIds:l,kind:u.ASYNC_SLICE_TRACK_KIND},trackFactory:({trackKey:e})=>new p.AsyncSliceTrack({engine:t.engine,trackKey:e},c,l)})}}async addUserAsyncSliceTracks(e){const t=e["engine"];for(var r=(await t.query(`
      with grouped_packages as materialized (
        select
          uid,
          group_concat(package_name, ',') as package_name,
          count() as cnt
        from package_list
        group by uid
      )
      select
        t.name as name,
        t.uid as uid,
        t.track_ids as trackIds,
        __max_layout_depth(t.track_count, t.track_ids) as maxDepth,
        iif(g.cnt = 1, g.package_name, 'UID ' || g.uid) as packageName
      from _uid_track_track_summary_by_uid_and_name t
      left join grouped_packages g using (uid)
    `)).iter({name:f.STR_NULL,uid:f.NUM_NULL,packageName:f.STR_NULL,trackIds:f.STR,maxDepth:f.NUM_NULL});r.valid();r.next()){var n=u.ASYNC_SLICE_TRACK_KIND,a=null===r.name?void 0:r.name,i=null===r.uid?void 0:r.uid,o=null===r.packageName?"UID "+i:r.packageName;const s=r.trackIds.split(",").map(e=>Number(e)),l=r.maxDepth;null!==l&&(o=(0,d.getTrackName)({name:a,uid:i,userName:o,kind:n,uidTrack:!0}),e.registerTrack({uri:`/async_slices_${a}_`+i,title:o,tags:{trackIds:s,kind:u.ASYNC_SLICE_TRACK_KIND},trackFactory:({trackKey:e})=>new p.AsyncSliceTrack({engine:t,trackKey:e},l,s)}))}}}}}return Rg}(),a=sm(),i=p0(),o=S0(),s=D_(),l=j_(),H_||(H_=1,function(l){Object.defineProperty(l,"__esModule",{value:!0}),l.plugin=l.CPU_FREQ_TRACK_KIND=void 0;const u=Rr(),E=Wf(),S=ee(),A=K(),O=Rs(),C=M();var e=vg();const k=Ps(),w=oe(),d=Z();var t=P();l.CPU_FREQ_TRACK_KIND="CpuFreqTrack";class c{mousePos={x:0,y:0};hoveredValue=void 0;hoveredTs=void 0;hoveredTsEnd=void 0;hoveredIdle=void 0;fetcher=new e.TimelineFetcher(this.onBoundsChange.bind(this));engine;config;trackUuid=(0,t.uuidv4Sql)();constructor(e,t){this.config=e,this.engine=t}async onCreate(){void 0===this.config.idleTrackId?await this.engine.query(`
        create view raw_freq_idle_${this.trackUuid} as
        select ts, dur, value as freqValue, -1 as idleValue
        from experimental_counter_dur c
        where track_id = ${this.config.freqTrackId}
      `):await this.engine.query(`
        create view raw_freq_${this.trackUuid} as
        select ts, dur, value as freqValue
        from experimental_counter_dur c
        where track_id = ${this.config.freqTrackId};

        create view raw_idle_${this.trackUuid} as
        select
          ts,
          dur,
          iif(value = 4294967295, -1, cast(value as int)) as idleValue
        from experimental_counter_dur c
        where track_id = ${this.config.idleTrackId};

        create virtual table raw_freq_idle_${this.trackUuid}
        using span_join(raw_freq_${this.trackUuid}, raw_idle_${this.trackUuid});
      `),await this.engine.query(`
      create virtual table cpu_freq_${this.trackUuid}
      using __intrinsic_counter_mipmap((
        select ts, freqValue as value
        from raw_freq_idle_${this.trackUuid}
      ));

      create virtual table cpu_idle_${this.trackUuid}
      using __intrinsic_counter_mipmap((
        select ts, idleValue as value
        from raw_freq_idle_${this.trackUuid}
      ));
    `)}async onUpdate({visibleWindow:e,resolution:t}){await this.fetcher.requestData(e.toTimeSpan(),t)}async onDestroy(){await this.engine.tryQuery("drop table cpu_freq_"+this.trackUuid),await this.engine.tryQuery("drop table cpu_idle_"+this.trackUuid),await this.engine.tryQuery("drop table raw_freq_idle_"+this.trackUuid),await this.engine.tryQuery("drop view if exists raw_freq_"+this.trackUuid),await this.engine.tryQuery("drop view if exists raw_idle_"+this.trackUuid)}async onBoundsChange(e,t,r){(0,S.assertTrue)(1===u.BigintMath.popcount(r),r+" not pow of 2");var n=await this.engine.query(`
      SELECT
        min_value as minFreq,
        max_value as maxFreq,
        last_ts as ts,
        last_value as lastFreq
      FROM cpu_freq_${this.trackUuid}(
        ${e},
        ${t},
        ${r}
      );
    `),a=await this.engine.query(`
      SELECT last_value as lastIdle
      FROM cpu_idle_${this.trackUuid}(
        ${e},
        ${t},
        ${r}
      );
    `),i=n.numRows(),o=a.numRows(),s=((0,S.assertTrue)(i==o),{start:e,end:t,resolution:r,length:i,timestamps:new BigInt64Array(i),minFreqKHz:new Uint32Array(i),maxFreqKHz:new Uint32Array(i),lastFreqKHz:new Uint32Array(i),lastIdleValues:new Int8Array(i)}),l=n.iter({ts:d.LONG,minFreq:d.NUM,maxFreq:d.NUM,lastFreq:d.NUM}),c=a.iter({lastIdle:d.NUM});for(let e=0;l.valid();++e,l.next(),c.next())s.timestamps[e]=l.ts,s.minFreqKHz[e]=l.minFreq,s.maxFreqKHz[e]=l.maxFreq,s.lastFreqKHz[e]=l.lastFreq,s.lastIdleValues[e]=c.lastIdle;return s}getHeight(){return 24.5}render({ctx:r,size:n,timescale:a,visibleWindow:i}){var o=this.fetcher.data;if(void 0!==o&&0!==o.timestamps.length){(0,S.assertTrue)(o.timestamps.length===o.lastFreqKHz.length),(0,S.assertTrue)(o.timestamps.length===o.minFreqKHz.length),(0,S.assertTrue)(o.timestamps.length===o.maxFreqKHz.length),(0,S.assertTrue)(o.timestamps.length===o.lastIdleValues.length);var s=n.width;const v=24.5;let t=this.config.maximumValue;var l=Math.ceil(Math.log10(Math.max(t,1))),c=Math.pow(10,l),c=(t=Math.ceil(t/(c/4))*(c/4),Math.floor(l/3)),l=t/Math.pow(10,3*c)+` ${["","K","M","G","T","E"][c+1]}Hz`,c=(0,C.colorForCpu)(this.config.cpu);let e=45;-1!==w.globals.state.hoveredUtid&&(e=0),r.fillStyle=c.setHSL({s:e,l:70}).cssString,r.strokeStyle=c.setHSL({s:e,l:55}).cssString;var u,d,f,p=e=>Math.floor(a.timeToPx(e)),h=e=>v-Math.round(e/t*20),i=i.toTimeSpan(),g=i.start,i=i.end,[g]=(0,E.searchSegment)(o.timestamps,g),g=-1===g?0:g,[,i]=(0,E.searchSegment)(o.timestamps,i),m=-1===i?o.timestamps.length:i;{r.beginPath();i=A.Time.fromRaw(o.timestamps[g]);r.moveTo(Math.max(p(i),0),v);let t=v;for(let e=g;e<m;e++){var _=A.Time.fromRaw(o.timestamps[e]),_=Math.max(0,p(_)),y=h(o.minFreqKHz[e]),T=h(o.maxFreqKHz[e]),b=h(o.lastFreqKHz[e]);r.lineTo(_,t),y===T?(0,S.assertTrue)(b===y):(r.lineTo(_,y),r.lineTo(_,T)),r.lineTo(_,b),t=b}r.lineTo(s,t),r.lineTo(s,v),r.closePath(),r.fill(),r.stroke()}r.fillStyle="rgba(240, 240, 240, 1)";for(let e=g;e<m;e++)o.lastIdleValues[e]<0||(u=A.Time.fromRaw(o.timestamps[e]),u=a.timeToPx(u),d=(e===o.lastIdleValues.length-1?s:a.timeToPx(A.Time.fromRaw(o.timestamps[e+1])))-u,f=h(o.lastFreqKHz[e])-v,r.fillRect(u,v,d,f));if(r.font="10px Roboto Condensed",void 0!==this.hoveredValue&&void 0!==this.hoveredTs){let e=this.hoveredValue.toLocaleString()+"kHz";r.fillStyle=c.setHSL({s:45,l:75}).cssString,r.strokeStyle=c.setHSL({s:45,l:45}).cssString;i=Math.floor(a.timeToPx(this.hoveredTs)),g=void 0===this.hoveredTsEnd?s:Math.floor(a.timeToPx(this.hoveredTsEnd)),c=v-Math.round(this.hoveredValue/t*20);r.beginPath(),r.moveTo(i,c),r.lineTo(g,c),r.lineWidth=3,r.stroke(),r.lineWidth=1,r.beginPath(),r.arc(i,c,3,0,2*Math.PI),r.fill(),r.stroke(),void 0!==this.hoveredIdle&&-1!==this.hoveredIdle&&(e+=` (Idle: ${(this.hoveredIdle+1).toLocaleString()})`),(0,O.drawTrackHoverTooltip)(r,this.mousePos,n,e)}r.textBaseline="alphabetic",r.fillStyle="rgba(255, 255, 255, 0.6)",r.fillRect(0,0,42,18),r.fillStyle="#666",r.textAlign="left",r.fillText(l,4,14),(0,k.checkerboardExcept)(r,this.getHeight(),0,n.width,a.timeToPx(o.start),a.timeToPx(o.end))}}onMouseMove({x:e,y:t,timescale:r}){var n=this.fetcher.data;void 0!==n&&(this.mousePos={x:e,y:t},t=r.pxToHpTime(e),[r,e]=(0,E.searchSegment)(n.timestamps,t.toTime()),this.hoveredTs=-1===r?void 0:A.Time.fromRaw(n.timestamps[r]),this.hoveredTsEnd=-1===e?void 0:A.Time.fromRaw(n.timestamps[e]),this.hoveredValue=-1===r?void 0:n.lastFreqKHz[r],this.hoveredIdle=-1===r?void 0:n.lastIdleValues[r])}onMouseOut(){this.hoveredValue=void 0,this.hoveredTs=void 0,this.hoveredTsEnd=void 0,this.hoveredIdle=void 0}}l.plugin={pluginId:"perfetto.CpuFreq",plugin:class{async onTraceLoad(e){var t=e["engine"],r=e.trace.cpus,n=(await t.query(`
      select ifnull(max(value), 0) as freq
      from counter c
      join cpu_counter_track t on c.track_id = t.id
      join _counter_track_summary s on t.id = s.id
      where name = 'cpufreq';
    `)).firstRow({freq:d.NUM}).freq;for(const o of r){var a=await t.query(`
        select
          id as cpuFreqId,
          (
            select id
            from cpu_counter_track
            where name = 'cpuidle'
            and cpu = ${o}
            limit 1
          ) as cpuIdleId
        from cpu_counter_track
        join _counter_track_summary using (id)
        where name = 'cpufreq' and cpu = ${o}
        limit 1;
      `);if(0<a.numRows()){var a=a.firstRow({cpuFreqId:d.NUM,cpuIdleId:d.NUM_NULL}),i=a.cpuFreqId,a=null===a.cpuIdleId?void 0:a.cpuIdleId;const s={cpu:o,maximumValue:n,freqTrackId:i,idleTrackId:a};e.registerTrack({uri:"/cpu_freq_cpu"+o,title:`Cpu ${o} Frequency`,tags:{kind:l.CPU_FREQ_TRACK_KIND,cpu:o},trackFactory:()=>new c(s,e.engine)})}}}}}}(G_)),c=G_,u=Y_(),d=function(){if(!ny){ny=1,Object.defineProperty(Q_,"__esModule",{value:!0}),Q_.plugin=void 0;const o=or.__importDefault(ae()),s=ue(),l=ty(),a=Z(),c=iy();Q_.plugin={pluginId:"perfetto.CpuSlices",plugin:class{async onTraceLoad(t){var e=t.trace.cpus,r=await this.getAndroidCpuClusterTypes(t.engine);for(const i of e){var n=r.get(i),a="/sched_cpu"+i,n=void 0===n?"Cpu "+i:`Cpu ${i} (${n})`;t.registerTrack({uri:a,title:n,tags:{kind:s.CPU_SLICE_TRACK_KIND,cpu:i},trackFactory:({trackKey:e})=>new c.CpuSliceTrack(t.engine,e,i)})}t.registerDetailsPanel({render:e=>{if("SCHED_SLICE"===e.kind)return(0,o.default)(l.SliceDetailsPanel)}})}async getAndroidCpuClusterTypes(e){var t=new Map;await e.query(`
      include perfetto module android.cpu.cluster_type;
    `);for(var r=(await e.query(`
      select cpu, cluster_type as clusterType
      from android_cpu_cluster_mapping
    `)).iter({cpu:a.NUM,clusterType:a.STR_NULL});r.valid();r.next()){var n=r.clusterType;null!==n&&t.set(r.cpu,n)}return t}}}}return Q_}(),f=function(){if(!oy){oy=1,Object.defineProperty(sy,"__esModule",{value:!0}),sy.plugin=void 0;const n=P(),a=$f(),e=ue(),i=xf(),o=z();async function r(e,t){if("string"==typeof t)return t;try{return await e.prompt("Enter a query...")}catch{}}sy.plugin={pluginId:"perfetto.DebugTracks",plugin:class{async onTraceLoad(t){t.registerCommand({id:"perfetto.DebugTracks#addDebugSliceTrack",name:"Add debug slice track",callback:async e=>{e=await r(t,e);(0,o.exists)(e)&&await(0,a.addDebugSliceTrack)(t,{sqlSource:e},"Debug slice track",{ts:"ts",dur:"dur",name:"name"},[])}}),t.registerCommand({id:"perfetto.DebugTracks#addDebugCounterTrack",name:"Add debug counter track",callback:async e=>{e=await r(t,e);(0,o.exists)(e)&&await(0,a.addDebugCounterTrack)(t,{sqlSource:e},"Debug slice track",{ts:"ts",value:"value"})}}),t.registerDetailsPanel(new e.BottomTabToSCSAdapter({tabFactory:e=>{if("GENERIC_SLICE"===e.kind&&e.detailsPanelConfig.kind===i.DebugSliceDetailsTab.kind)return e=e.detailsPanelConfig.config,new i.DebugSliceDetailsTab({config:e,engine:t.engine,uuid:(0,n.uuidv4)()})}}))}}}}return sy}(),p=function(){if(!ly){ly=1,Object.defineProperty(cy,"__esModule",{value:!0}),cy.plugin=void 0;const t=ne(),n=oe();function r(e){n.globals.logging.logEvent("Trace Actions","Open example trace"),n.globals.dispatch(t.Actions.openTraceFromUrl({url:e}))}cy.plugin={pluginId:"perfetto.ExampleTraces",plugin:class{onActivate(e){var t="perfetto.CoreCommands#openExampleAndroidTrace",t=(e.registerCommand({id:t,name:"Open Android example",callback:()=>{r("https://storage.googleapis.com/perfetto-misc/example_android_trace_15s")}}),e.addSidebarMenuItem({commandId:t,group:"example_traces",icon:"description"}),"perfetto.CoreCommands#openExampleChromeTrace");e.registerCommand({id:t,name:"Open Chrome example",callback:()=>{r("https://storage.googleapis.com/perfetto-misc/chrome_example_wikipedia.perfetto_trace.gz")}}),e.addSidebarMenuItem({commandId:t,group:"example_traces",icon:"description"})}}}}return cy}(),h=_y(),g=Dy(),m=VT(),_=KT(),y=tb(),T=db(),b=Tb(),v=function(){if(!wb){wb=1,Object.defineProperty(vb,"__esModule",{value:!0}),vb.plugin=void 0;const p=P(),h=ue(),g=Ib(),m=ue(),_=ms(),y=Z(),T=Zl(),b=sc();vb.plugin={pluginId:"perfetto.ThreadSlices",plugin:class{async onTraceLoad(t){for(var e=t["engine"],r=(await e.query(`
      include perfetto module viz.summary.slices;
      include perfetto module viz.summary.threads;
      include perfetto module viz.threads;

      select
        thread_track.utid as utid,
        thread_track.id as trackId,
        thread_track.name as trackName,
        EXTRACT_ARG(thread_track.source_arg_set_id,
                    'is_root_in_scope') as isDefaultTrackForScope,
        tid,
        t.name as threadName,
        max_depth as maxDepth,
        t.upid as upid,
        is_main_thread as isMainThread,
        is_kernel_thread AS isKernelThread
      from thread_track
      join _threads_with_kernel_flag t using(utid)
      join _slice_track_summary sts on sts.id = thread_track.id
  `)).iter({utid:y.NUM,trackId:y.NUM,trackName:y.STR_NULL,isDefaultTrackForScope:y.NUM_NULL,tid:y.NUM_NULL,threadName:y.STR_NULL,maxDepth:y.NUM,upid:y.NUM_NULL,isMainThread:y.NUM_NULL,isKernelThread:y.NUM});r.valid();r.next()){const{upid:a,utid:i,trackId:o,trackName:s,tid:l,threadName:c,maxDepth:u,isMainThread:d,isKernelThread:f}=r;var n=(0,_.getTrackName)({name:s,utid:i,tid:l,threadName:c,kind:"Slices"});t.registerTrack({uri:(0,_.getThreadUriPrefix)(a,i)+"_slice_"+o,title:n,tags:{trackIds:[o],kind:h.THREAD_SLICE_TRACK_KIND},chips:(0,b.removeFalsyValues)([0===f&&1===d&&"main thread"]),trackFactory:({trackKey:e})=>{e={engine:t.engine,trackKey:e};return new T.ThreadSliceTrack(e,o,u)}})}t.registerDetailsPanel(new m.BottomTabToSCSAdapter({tabFactory:e=>{if("SLICE"===e.kind)return new g.ThreadSliceDetailsTab({config:{table:e.table??"slice",id:e.id},engine:t.engine,uuid:(0,p.uuidv4)()})}}))}}}}return vb}(),E=Fb(),S=function(){if(!Ub){Ub=1,Object.defineProperty(Bb,"__esModule",{value:!0}),Bb.plugin=void 0;const o=ne(),s=oe(),t=Uo(),l=Bc();Bb.plugin={pluginId:"perfetto.TrackUtils",plugin:class{async onTraceLoad(i){i.registerCommand({id:"perfetto.RunQueryInSelectedTimeWindow",name:"Run query in selected time window",callback:async()=>{var e=await(0,s.getTimeSpanOfSelectionOrVisibleWindow)();s.globals.omnibox.setMode(t.OmniboxMode.Query),s.globals.omnibox.setText(`select  where ts >= ${e.start} and ts < `+e.end),s.globals.omnibox.focusOmnibox(7)}}),i.registerCommand({id:"perfetto.FindTrack",name:"Find track by URI",callback:async()=>{var e=s.globals.trackManager.getAllTracks().map(({uri:e})=>({key:e,displayName:e}));const r=new Intl.Collator("en",{numeric:!0,sensitivity:"base"});e=e.sort((e,t)=>r.compare(e.displayName,t.displayName));try{const a=await i.prompt("Choose a track...",e);var t,n=Object.values(s.globals.state.tracks).find(({uri:e})=>e===a);n?(console.log(n),(0,l.verticalScrollToTrack)(n.key,!0),t=s.globals.traceContext,s.globals.makeSelection(o.Actions.selectArea({start:t.start,end:t.end,tracks:[n.key]}))):alert(`No tracks with uri ${a} on the timeline`)}catch{}}})}}}}return Bb}(),A=function(){if(Hb)return Vb;Hb=1,Object.defineProperty(Vb,"__esModule",{value:!0}),Vb.plugin=void 0;const n=oe();var e=qf();const a=Q(),i=qb();class o extends e.BaseCounterTrack{engine;queryKey;constructor(e,t,r){super({engine:e,trackKey:t}),this.engine=e,this.queryKey=r}getDefaultCounterOptions(){var e=super.getDefaultCounterOptions();return e.yRangeSharingKey="CpuSubsystem",e.unit="mW",e}getSqlSource(){return this.queryKey.startsWith("cpu")?`select ts, ${this.queryKey} as value from _system_state_curves`:`
        select
          ts,
          -- L3 values are scaled by 1000 because it's divided by ns and L3 LUTs
          -- are scaled by 10^6. This brings to same units as static_curve (mW)
          ((IFNULL(l3_hit_value, 0) + IFNULL(l3_miss_value, 0)) * 1000 / dur)
            + static_curve  as value
        from _system_state_curves
      `}}return Vb.plugin={pluginId:"org.kernel.Wattson",plugin:class{async onTraceLoad(t){if(await(0,i.hasWattsonSupport)(t.engine)){t.engine.query("INCLUDE PERFETTO MODULE wattson.curves.ungrouped;");for(const e of n.globals.traceContext.cpus){const r=`cpu${e}_curve`;t.registerStaticTrack({uri:"/wattson/cpu_subsystem_estimate_cpu"+e,title:`Cpu${e} Estimate`,trackFactory:({trackKey:e})=>new o(t.engine,e,r),groupName:"Wattson",tags:{kind:a.CPUSS_ESTIMATE_TRACK_KIND,wattson:"CPU"+e}})}t.registerStaticTrack({uri:"/wattson/cpu_subsystem_estimate_dsu_scu",title:"DSU/SCU Estimate",trackFactory:({trackKey:e})=>new o(t.engine,e,"dsu_scu"),groupName:"Wattson",tags:{kind:a.CPUSS_ESTIMATE_TRACK_KIND,wattson:"Dsu_Scu"}})}}}},Vb}(),e.pluginRegistry.register(t.plugin),e.pluginRegistry.register(r.plugin),e.pluginRegistry.register(n.plugin),e.pluginRegistry.register(a.plugin),e.pluginRegistry.register(i.plugin),e.pluginRegistry.register(o.plugin),e.pluginRegistry.register(s.plugin),e.pluginRegistry.register(l.plugin),e.pluginRegistry.register(c.plugin),e.pluginRegistry.register(u.plugin),e.pluginRegistry.register(d.plugin),e.pluginRegistry.register(f.plugin),e.pluginRegistry.register(p.plugin),e.pluginRegistry.register(h.plugin),e.pluginRegistry.register(g.plugin),e.pluginRegistry.register(m.plugin),e.pluginRegistry.register(_.plugin),e.pluginRegistry.register(y.plugin),e.pluginRegistry.register(T.plugin),e.pluginRegistry.register(b.plugin),e.pluginRegistry.register(v.plugin),e.pluginRegistry.register(E.plugin),e.pluginRegistry.register(S.plugin),e.pluginRegistry.register(A.plugin))}var zb,Kb={},Yb={},Jb={},Zb={},Qb={},Xb={exports:{}};function ev(){var L;return zb||(zb=1,L=Xb,function(){var e,t="undefined"!=typeof navigator&&"undefined"!=typeof window;function _(e,t,r){null!=e&&("number"==typeof e?this.fromNumber(e,t,r):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function y(){return new _(null)}e=t&&"Microsoft Internet Explorer"==navigator.appName?(_.prototype.am=function(e,t,r,n,a,i){for(var o=32767&t,s=t>>15;0<=--i;){var l=32767&this[e],c=this[e++]>>15,u=s*l+c*o;a=((l=o*l+((32767&u)<<15)+r[n]+(1073741823&a))>>>30)+(u>>>15)+s*c+(a>>>30),r[n++]=1073741823&l}return a},30):t&&"Netscape"!=navigator.appName?(_.prototype.am=function(e,t,r,n,a,i){for(;0<=--i;){var o=t*this[e++]+r[n]+a;a=Math.floor(o/67108864),r[n++]=67108863&o}return a},26):(_.prototype.am=function(e,t,r,n,a,i){for(var o=16383&t,s=t>>14;0<=--i;){var l=16383&this[e],c=this[e++]>>14,u=s*l+c*o;a=((l=o*l+((16383&u)<<14)+r[n]+a)>>28)+(u>>14)+s*c,r[n++]=268435455&l}return a},28),_.prototype.DB=e,_.prototype.DM=(1<<e)-1,_.prototype.DV=1<<e;_.prototype.FV=Math.pow(2,52),_.prototype.F1=52-e,_.prototype.F2=2*e-52;for(var r="0123456789abcdefghijklmnopqrstuvwxyz",n=new Array,a="0".charCodeAt(0),i=0;i<=9;++i)n[a++]=i;for(a="a".charCodeAt(0),i=10;i<36;++i)n[a++]=i;for(a="A".charCodeAt(0),i=10;i<36;++i)n[a++]=i;function l(e){return r.charAt(e)}function c(e,t){e=n[e.charCodeAt(t)];return null==e?-1:e}function m(e){var t=y();return t.fromInt(e),t}function T(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function b(e){this.m=e}function v(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}b.prototype.convert=function(e){return e.s<0||0<=e.compareTo(this.m)?e.mod(this.m):e},b.prototype.revert=function(e){return e},b.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},b.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},b.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},v.prototype.convert=function(e){var t=y();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&0<t.compareTo(_.ZERO)&&this.m.subTo(t,t),t},v.prototype.revert=function(e){var t=y();return e.copyTo(t),this.reduce(t),t},v.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e[t],n=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(e[r=t+this.m.t]+=this.m.am(0,n,e,t,0,this.m.t);e[r]>=e.DV;)e[r]-=e.DV,e[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),0<=e.compareTo(this.m)&&e.subTo(this.m,e)},v.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},v.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},_.prototype.copyTo=function(e){for(var t=this.t-1;0<=t;--t)e[t]=this[t];e.t=this.t,e.s=this.s},_.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,0<e?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0},_.prototype.fromString=function(e,t){var r;if(16==t)r=4;else if(8==t)r=3;else if(256==t)r=8;else if(2==t)r=1;else if(32==t)r=5;else{if(4!=t)return void this.fromRadix(e,t);r=2}this.t=0,this.s=0;for(var n=e.length,a=!1,i=0;0<=--n;){var o=8==r?255&e[n]:c(e,n);o<0?"-"==e.charAt(n)&&(a=!0):(a=!1,0==i?this[this.t++]=o:i+r>this.DB?(this[this.t-1]|=(o&(1<<this.DB-i)-1)<<i,this[this.t++]=o>>this.DB-i):this[this.t-1]|=o<<i,(i+=r)>=this.DB&&(i-=this.DB))}8==r&&0!=(128&e[0])&&(this.s=-1,0<i)&&(this[this.t-1]|=(1<<this.DB-i)-1<<i),this.clamp(),a&&_.ZERO.subTo(this,this)},_.prototype.clamp=function(){for(var e=this.s&this.DM;0<this.t&&this[this.t-1]==e;)--this.t},_.prototype.dlShiftTo=function(e,t){for(var r=this.t-1;0<=r;--r)t[r+e]=this[r];for(r=e-1;0<=r;--r)t[r]=0;t.t=this.t+e,t.s=this.s},_.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0),t.s=this.s},_.prototype.lShiftTo=function(e,t){for(var r=e%this.DB,n=this.DB-r,a=(1<<n)-1,i=Math.floor(e/this.DB),o=this.s<<r&this.DM,s=this.t-1;0<=s;--s)t[s+i+1]=this[s]>>n|o,o=(this[s]&a)<<r;for(s=i-1;0<=s;--s)t[s]=0;t[i]=o,t.t=this.t+i+1,t.s=this.s,t.clamp()},_.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var n=e%this.DB,a=this.DB-n,i=(1<<n)-1;t[0]=this[r]>>n;for(var o=r+1;o<this.t;++o)t[o-r-1]|=(this[o]&i)<<a,t[o-r]=this[o]>>n;0<n&&(t[this.t-r-1]|=(this.s&i)<<a),t.t=this.t-r,t.clamp()}},_.prototype.subTo=function(e,t){for(var r=0,n=0,a=Math.min(e.t,this.t);r<a;)n+=this[r]-e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e[r],t[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t[r++]=this.DV+n:0<n&&(t[r++]=n),t.t=r,t.clamp()},_.prototype.multiplyTo=function(e,t){var r=this.abs(),n=e.abs(),a=r.t;for(t.t=a+n.t;0<=--a;)t[a]=0;for(a=0;a<n.t;++a)t[a+r.t]=r.am(0,n[a],t,a,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&_.ZERO.subTo(t,t)},_.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;0<=--r;)e[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t[r],e,2*r,0,1);(e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e[r+t.t]-=t.DV,e[r+t.t+1]=1)}0<e.t&&(e[e.t-1]+=t.am(r,t[r],e,2*r,0,1)),e.s=0,e.clamp()},_.prototype.divRemTo=function(e,t,r){var n=e.abs();if(!(n.t<=0)){var a=this.abs();if(a.t<n.t)null!=t&&t.fromInt(0),null!=r&&this.copyTo(r);else{null==r&&(r=y());var i=y(),o=this.s,e=e.s,s=this.DB-T(n[n.t-1]),l=(0<s?(n.lShiftTo(s,i),a.lShiftTo(s,r)):(n.copyTo(i),a.copyTo(r)),i.t),c=i[l-1];if(0!=c){var n=c*(1<<this.F1)+(1<l?i[l-2]>>this.F2:0),u=this.FV/n,d=(1<<this.F1)/n,f=1<<this.F2,p=r.t,h=p-l,g=null==t?y():t;for(i.dlShiftTo(h,g),0<=r.compareTo(g)&&(r[r.t++]=1,r.subTo(g,r)),_.ONE.dlShiftTo(l,g),g.subTo(i,i);i.t<l;)i[i.t++]=0;for(;0<=--h;){var m=r[--p]==c?this.DM:Math.floor(r[p]*u+(r[p-1]+f)*d);if((r[p]+=i.am(0,m,r,h,0,l))<m)for(i.dlShiftTo(h,g),r.subTo(g,r);r[p]<--m;)r.subTo(g,r)}null!=t&&(r.drShiftTo(l,t),o!=e)&&_.ZERO.subTo(t,t),r.t=l,r.clamp(),0<s&&r.rShiftTo(s,r),o<0&&_.ZERO.subTo(r,r)}}}},_.prototype.invDigit=function(){var e,t;return this.t<1||0==(1&(e=this[0]))?0:0<(t=(t=(t=(t=(t=3&e)*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)?this.DV-t:-t},_.prototype.isEven=function(){return 0==(0<this.t?1&this[0]:this.s)},_.prototype.exp=function(e,t){if(4294967295<e||e<1)return _.ONE;var r,n=y(),a=y(),i=t.convert(this),o=T(e)-1;for(i.copyTo(n);0<=--o;)t.sqrTo(n,a),0<(e&1<<o)?t.mulTo(a,i,n):(r=n,n=a,a=r);return t.revert(n)},_.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,n=(1<<t)-1,a=!1,i="",o=this.t,s=this.DB-o*this.DB%t;if(0<o--)for(s<this.DB&&0<(r=this[o]>>s)&&(a=!0,i=l(r));0<=o;)s<t?(r=(this[o]&(1<<s)-1)<<t-s,r|=this[--o]>>(s+=this.DB-t)):(r=this[o]>>(s-=t)&n,s<=0&&(s+=this.DB,--o)),(a=0<r?!0:a)&&(i+=l(r));return a?i:"0"},_.prototype.negate=function(){var e=y();return _.ZERO.subTo(this,e),e},_.prototype.abs=function(){return this.s<0?this.negate():this},_.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;0<=--r;)if(0!=(t=this[r]-e[r]))return t;return 0},_.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+T(this[this.t-1]^this.s&this.DM)},_.prototype.mod=function(e){var t=y();return this.abs().divRemTo(e,null,t),this.s<0&&0<t.compareTo(_.ZERO)&&e.subTo(t,t),t},_.prototype.modPowInt=function(e,t){return t=new(e<256||t.isEven()?b:v)(t),this.exp(e,t)},_.ZERO=m(0),_.ONE=m(1);var o=256;function s(e,t){return e&t}function u(e,t){return e|t}function d(e,t){return e^t}function f(e,t){return e&~t}function p(){}function h(e){return e}function E(e){this.r2=y(),this.q3=y(),_.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}L.exports={default:_,BigInteger:_},p.prototype.convert=h,p.prototype.revert=h,p.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},p.prototype.sqrTo=function(e,t){e.squareTo(t)},E.prototype.convert=function(e){var t;return e.s<0||e.t>2*this.m.t?e.mod(this.m):e.compareTo(this.m)<0?e:(t=y(),e.copyTo(t),this.reduce(t),t)},E.prototype.revert=function(e){return e},E.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);0<=e.compareTo(this.m);)e.subTo(this.m,e)},E.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},E.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var g,S=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],A=(1<<26)/S[S.length-1];function O(e,t){return new _(e,t)}function C(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function k(){var e;e=(new Date).getTime(),w[R++]^=255&e,w[R++]^=e>>8&255,w[R++]^=e>>16&255,w[R++]^=e>>24&255,o<=R&&(R-=o)}if(_.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},_.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||36<e)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=m(r),a=y(),i=y(),o="";for(this.divRemTo(n,a,i);0<a.signum();)o=(r+i.intValue()).toString(e).substr(1)+o,a.divRemTo(n,a,i);return i.intValue().toString(e)+o},_.prototype.fromRadix=function(e,t){this.fromInt(0);for(var r=this.chunkSize(t=null==t?10:t),n=Math.pow(t,r),a=!1,i=0,o=0,s=0;s<e.length;++s){var l=c(e,s);l<0?"-"==e.charAt(s)&&0==this.signum()&&(a=!0):(o=t*o+l,++i>=r&&(this.dMultiply(n),this.dAddOffset(o,0),o=i=0))}0<i&&(this.dMultiply(Math.pow(t,i)),this.dAddOffset(o,0)),a&&_.ZERO.subTo(this,this)},_.prototype.fromNumber=function(e,t,r){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(_.ONE.shiftLeft(e-1),u,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(_.ONE.shiftLeft(e-1),this);else{var r=new Array,n=7&e;r.length=1+(e>>3),t.nextBytes(r),0<n?r[0]&=(1<<n)-1:r[0]=0,this.fromString(r,256)}},_.prototype.bitwiseTo=function(e,t,r){for(var n,a=Math.min(e.t,this.t),i=0;i<a;++i)r[i]=t(this[i],e[i]);if(e.t<this.t){for(n=e.s&this.DM,i=a;i<this.t;++i)r[i]=t(this[i],n);r.t=this.t}else{for(n=this.s&this.DM,i=a;i<e.t;++i)r[i]=t(n,e[i]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},_.prototype.changeBit=function(e,t){return e=_.ONE.shiftLeft(e),this.bitwiseTo(e,t,e),e},_.prototype.addTo=function(e,t){for(var r=0,n=0,a=Math.min(e.t,this.t);r<a;)n+=this[r]+e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e[r],t[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,0<n?t[r++]=n:n<-1&&(t[r++]=this.DV+n),t.t=r,t.clamp()},_.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},_.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}},_.prototype.multiplyLowerTo=function(e,t,r){var n,a=Math.min(this.t+e.t,t);for(r.s=0,r.t=a;0<a;)r[--a]=0;for(n=r.t-this.t;a<n;++a)r[a+this.t]=this.am(0,e[a],r,a,0,this.t);for(n=Math.min(e.t,t);a<n;++a)this.am(0,e[a],r,a,0,t-a);r.clamp()},_.prototype.multiplyUpperTo=function(e,t,r){var n=r.t=this.t+e.t- --t;for(r.s=0;0<=--n;)r[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r[this.t+n-t]=this.am(t-n,e[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)},_.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(0<this.t)if(0==t)r=this[0]%e;else for(var n=this.t-1;0<=n;--n)r=(t*r+this[n])%e;return r},_.prototype.millerRabin=function(e){var t=this.subtract(_.ONE),r=t.getLowestSetBit();if(r<=0)return!1;for(var n=t.shiftRight(r),a=((e=e+1>>1)>S.length&&(e=S.length),y()),i=0;i<e;++i){a.fromInt(S[Math.floor(Math.random()*S.length)]);var o=a.modPow(n,this);if(0!=o.compareTo(_.ONE)&&0!=o.compareTo(t)){for(var s=1;s++<r&&0!=o.compareTo(t);)if(0==(o=o.modPowInt(2,this)).compareTo(_.ONE))return!1;if(0!=o.compareTo(t))return!1}}return!0},_.prototype.clone=function(){var e=y();return this.copyTo(e),e},_.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},_.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},_.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},_.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},_.prototype.toByteArray=function(){var e,t=this.t,r=new Array,n=(r[0]=this.s,this.DB-t*this.DB%8),a=0;if(0<t--)for(n<this.DB&&(e=this[t]>>n)!=(this.s&this.DM)>>n&&(r[a++]=e|this.s<<this.DB-n);0<=t;)n<8?(e=(this[t]&(1<<n)-1)<<8-n,e|=this[--t]>>(n+=this.DB-8)):(e=this[t]>>(n-=8)&255,n<=0&&(n+=this.DB,--t)),0!=(128&e)&&(e|=-256),0==a&&(128&this.s)!=(128&e)&&++a,(0<a||e!=this.s)&&(r[a++]=e);return r},_.prototype.equals=function(e){return 0==this.compareTo(e)},_.prototype.min=function(e){return this.compareTo(e)<0?this:e},_.prototype.max=function(e){return 0<this.compareTo(e)?this:e},_.prototype.and=function(e){var t=y();return this.bitwiseTo(e,s,t),t},_.prototype.or=function(e){var t=y();return this.bitwiseTo(e,u,t),t},_.prototype.xor=function(e){var t=y();return this.bitwiseTo(e,d,t),t},_.prototype.andNot=function(e){var t=y();return this.bitwiseTo(e,f,t),t},_.prototype.not=function(){for(var e=y(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e},_.prototype.shiftLeft=function(e){var t=y();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},_.prototype.shiftRight=function(e){var t=y();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},_.prototype.getLowestSetBit=function(){for(var e,t,r=0;r<this.t;++r)if(0!=this[r])return r*this.DB+(e=this[r],t=void 0,0==e?-1:((t=0)==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t));return this.s<0?this.t*this.DB:-1},_.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=function(e){for(var t=0;0!=e;)e&=e-1,++t;return t}(this[r]^t);return e},_.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this[t]&1<<e%this.DB)},_.prototype.setBit=function(e){return this.changeBit(e,u)},_.prototype.clearBit=function(e){return this.changeBit(e,f)},_.prototype.flipBit=function(e){return this.changeBit(e,d)},_.prototype.add=function(e){var t=y();return this.addTo(e,t),t},_.prototype.subtract=function(e){var t=y();return this.subTo(e,t),t},_.prototype.multiply=function(e){var t=y();return this.multiplyTo(e,t),t},_.prototype.divide=function(e){var t=y();return this.divRemTo(e,t,null),t},_.prototype.remainder=function(e){var t=y();return this.divRemTo(e,null,t),t},_.prototype.divideAndRemainder=function(e){var t=y(),r=y();return this.divRemTo(e,t,r),new Array(t,r)},_.prototype.modPow=function(e,t){var r=e.bitLength(),n=m(1);if(r<=0)return n;var a=r<18?1:r<48?3:r<144?4:r<768?5:6,i=new(r<8?b:t.isEven()?E:v)(t),o=new Array,s=3,l=a-1,c=(1<<a)-1;if(o[1]=i.convert(this),1<a){var u=y();for(i.sqrTo(o[1],u);s<=c;)o[s]=y(),i.mulTo(u,o[s-2],o[s]),s+=2}for(var d,f,p=e.t-1,h=!0,g=y(),r=T(e[p])-1;0<=p;){for(l<=r?d=e[p]>>r-l&c:(d=(e[p]&(1<<r+1)-1)<<l-r,0<p&&(d|=e[p-1]>>this.DB+r-l)),s=a;0==(1&d);)d>>=1,--s;if((r-=s)<0&&(r+=this.DB,--p),h)o[d].copyTo(n),h=!1;else{for(;1<s;)i.sqrTo(n,g),i.sqrTo(g,n),s-=2;0<s?i.sqrTo(n,g):(f=n,n=g,g=f),i.mulTo(g,o[d],n)}for(;0<=p&&0==(e[p]&1<<r);)i.sqrTo(n,g),f=n,n=g,g=f,--r<0&&(r=this.DB-1,--p)}return i.revert(n)},_.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return _.ZERO;for(var r=e.clone(),n=this.clone(),a=m(1),i=m(0),o=m(0),s=m(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),t?(a.isEven()&&i.isEven()||(a.addTo(this,a),i.subTo(e,i)),a.rShiftTo(1,a)):i.isEven()||i.subTo(e,i),i.rShiftTo(1,i);for(;n.isEven();)n.rShiftTo(1,n),t?(o.isEven()&&s.isEven()||(o.addTo(this,o),s.subTo(e,s)),o.rShiftTo(1,o)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);0<=r.compareTo(n)?(r.subTo(n,r),t&&a.subTo(o,a),i.subTo(s,i)):(n.subTo(r,n),t&&o.subTo(a,o),s.subTo(i,s))}return 0!=n.compareTo(_.ONE)?_.ZERO:0<=s.compareTo(e)?s.subtract(e):s.signum()<0&&(s.addTo(e,s),s.signum()<0)?s.add(e):s},_.prototype.pow=function(e){return this.exp(e,new p)},_.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone(),n=(t.compareTo(r)<0&&(e=t,t=r,r=e),t.getLowestSetBit());if((e=r.getLowestSetBit())<0)return t;for(0<(e=n<e?n:e)&&(t.rShiftTo(e,t),r.rShiftTo(e,r));0<t.signum();)0<(n=t.getLowestSetBit())&&t.rShiftTo(n,t),0<(n=r.getLowestSetBit())&&r.rShiftTo(n,r),0<=t.compareTo(r)?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return 0<e&&r.lShiftTo(e,r),r},_.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r[0]<=S[S.length-1]){for(t=0;t<S.length;++t)if(r[0]==S[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<S.length;){for(var n=S[t],a=t+1;a<S.length&&n<A;)n*=S[a++];for(n=r.modInt(n);t<a;)if(n%S[t++]==0)return!1}return r.millerRabin(e)},_.prototype.square=function(){var e=y();return this.squareTo(e),e},C.prototype.doPublic=function(e){return e.modPowInt(this.e,this.n)},C.prototype.doPrivate=function(e){if(null==this.p||null==this.q)return e.modPow(this.d,this.n);for(var t=e.mod(this.p).modPow(this.dmp1,this.p),r=e.mod(this.q).modPow(this.dmq1,this.q);t.compareTo(r)<0;)t=t.add(this.p);return t.subtract(r).multiply(this.coeff).mod(this.p).multiply(this.q).add(r)},C.prototype.setPublic=function(e,t){null!=e&&null!=t&&0<e.length&&0<t.length?(this.n=O(e,16),this.e=parseInt(t,16)):alert("Invalid RSA public key")},C.prototype.setPrivateEx=function(e,t,r,n,a,i,o,s){null!=e&&null!=t&&0<e.length&&0<t.length?(this.n=O(e,16),this.e=parseInt(t,16),this.d=O(r,16),this.p=O(n,16),this.q=O(a,16),this.dmp1=O(i,16),this.dmq1=O(o,16),this.coeff=O(s,16)):alert("Invalid RSA private key")},C.prototype.encrypt=function(e){return null==(e=function(e,t){if(t<e.length+11)return alert("Message too long for RSA"),null;for(var r=new Array,n=e.length-1;0<=n&&0<t;){var a=e.charCodeAt(n--);a<128?r[--t]=a:127<a&&a<2048?(r[--t]=63&a|128,r[--t]=a>>6|192):(r[--t]=63&a|128,r[--t]=a>>6&63|128,r[--t]=a>>12|224)}r[--t]=0;for(var i=new D,o=new Array;2<t;){for(o[0]=0;0==o[0];)i.nextBytes(o);r[--t]=o[0]}return r[--t]=2,r[--t]=0,new _(r)}(e,this.n.bitLength()+7>>3))||null==(e=this.doPublic(e))?null:0==(1&(e=e.toString(16)).length)?e:"0"+e},null==w){var w=new Array,R=0;if(t&&window.crypto&&window.crypto.getRandomValues){var I=new Uint8Array(32);for(window.crypto.getRandomValues(I),P=0;P<32;++P)w[R++]=I[P]}if(t&&"Netscape"==navigator.appName&&navigator.appVersion<"5"&&window.crypto)for(var M=window.crypto.random(32),P=0;P<M.length;++P)w[R++]=255&M.charCodeAt(P);for(;R<o;)P=Math.floor(65536*Math.random()),w[R++]=P>>>8,w[R++]=255&P;R=0,k()}function N(){if(null==g){for(k(),(g=new x).init(w),R=0;R<w.length;++R)w[R]=0;R=0}return g.next()}function D(){}function x(){this.i=0,this.j=0,this.S=new Array}D.prototype.nextBytes=function(e){for(var t=0;t<e.length;++t)e[t]=N()},x.prototype.init=function(e){for(var t,r,n=0;n<256;++n)this.S[n]=n;for(n=t=0;n<256;++n)t=t+this.S[n]+e[n%e.length]&255,r=this.S[n],this.S[n]=this.S[t],this.S[t]=r;this.i=0,this.j=0},x.prototype.next=function(){var e;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[e+this.S[this.i]&255]};o=256;L.exports={default:_,BigInteger:_,RSAKey:C}}.call(be)),Xb.exports}var tv,rv,nv,av={};function iv(){if(!tv){tv=1,Object.defineProperty(av,"__esModule",{value:!0}),av.RecordingError=void 0,av.wrapRecordingError=async function(t,r){try{return await t}catch(e){t=(0,n.getErrorMessage)(e);r(t)}},av.showRecordingModal=function(t){if(["Unable to claim interface.","The specified endpoint is not part of a claimed and selected alternate interface.","Unable to reset the device."].some(e=>t.includes(e)))(0,r.showWebUSBErrorV2)();else if(["A transfer error has occurred.","The device was disconnected.","The transfer was cancelled."].some(e=>t.includes(e))||function(e){return e.includes("Device with serial")&&e.includes("was disconnected.")}(t))(0,r.showConnectionLostError)();else if(t===a.ALLOW_USB_DEBUGGING)(0,r.showAllowUSBDebugging)();else if(e(t,[a.BINARY_PUSH_FAILURE,a.BINARY_PUSH_UNKNOWN_RESPONSE]))(0,r.showFailedToPushBinary)(t.substring(t.indexOf(":")+1));else if(t===a.NO_DEVICE_SELECTED)(0,r.showNoDeviceSelected)();else if(a.WEBSOCKET_UNABLE_TO_CONNECT===t)(0,r.showWebsocketConnectionIssue)(t);else if(t===a.EXTENSION_NOT_INSTALLED)(0,r.showExtensionNotInstalled)();else{if(!e(t,[a.PARSING_UNKNWON_REQUEST_ID,a.PARSING_UNABLE_TO_DECODE_METHOD,a.PARSING_UNRECOGNIZED_PORT,a.PARSING_UNRECOGNIZED_MESSAGE]))throw new Error(""+t);(0,r.showIssueParsingTheTracedResponse)(t)}};const n=Id(),r=M_(),a=b_();class t extends Error{}function e(e,t){for(const r of t)if(e.includes(r))return 1}av.RecordingError=t}return av}function ov(){if(!rv){rv=1,Object.defineProperty(Qb,"__esModule",{value:!0}),Qb.AdbKey=void 0;const i=ev(),o=ee(),s=J(),r=iv(),n={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"},publicExponent:new Uint8Array([1,0,1]),modulusLength:2048},l=["sign"],c=[0,48,33,48,9,6,5,43,14,3,2,26,5,0,4,20],u=i.BigInteger.ONE.shiftLeft(32);function a(e,t){var r=e.toByteArray();let n=0;for(;n<r.length&&0===r[n];)n++;e=Uint8Array.from(r.slice(n)),t=new Uint8Array(t);return(0,o.assertTrue)(e.length<=t.length),t.set(e,t.length-e.length),t}Qb.AdbKey=class d{jwkPrivate;constructor(e){this.jwkPrivate=e}static async GenerateNewKeyPair(){var e,t=await crypto.subtle.generateKey(n,!0,l),t=await crypto.subtle.exportKey("jwk",t.privateKey);if(void 0===(e=t).n||void 0===e.e||void 0===e.d||void 0===e.p||void 0===e.q||void 0===e.dp||void 0===e.dq||void 0===e.qi)throw new r.RecordingError("Could not generate a valid private key.");return new d(t)}static DeserializeKey(e){return new d(JSON.parse(e))}sign(e){var t=new i.RSAKey;t.setPrivateEx((0,s.hexEncode)((0,s.base64Decode)(this.jwkPrivate.n)),(0,s.hexEncode)((0,s.base64Decode)(this.jwkPrivate.e)),(0,s.hexEncode)((0,s.base64Decode)(this.jwkPrivate.d)),(0,s.hexEncode)((0,s.base64Decode)(this.jwkPrivate.p)),(0,s.hexEncode)((0,s.base64Decode)(this.jwkPrivate.q)),(0,s.hexEncode)((0,s.base64Decode)(this.jwkPrivate.dp)),(0,s.hexEncode)((0,s.base64Decode)(this.jwkPrivate.dq)),(0,s.hexEncode)((0,s.base64Decode)(this.jwkPrivate.qi))),(0,o.assertTrue)(2048===t.n.bitLength());(r=new Uint8Array(256)).fill(255),r[0]=0,r[1]=1,r.set(c,r.length-c.length-e.length),r.set(e,r.length-e.length);var e=new i.BigInteger(Array.from(r)),r=t.doPrivate(e);return new Uint8Array(a(r,256))}getPublicKey(){var e=new i.RSAKey,t=(e.setPublic((0,s.hexEncode)((0,s.base64Decode)((0,o.assertExists)(this.jwkPrivate.n))),(0,s.hexEncode)((0,s.base64Decode)((0,o.assertExists)(this.jwkPrivate.e)))),u.subtract(e.n.modInverse(u)).intValue()),r=(r=i.BigInteger.ONE.shiftLeft(1).pow(2048)).multiply(r).mod(e.n),n=new ArrayBuffer(524);return(n=new DataView(n)).setUint32(0,64,!0),n.setUint32(4,t,!0),(t=new Uint8Array(n.buffer,n.byteOffset,n.byteLength)).set(a(e.n,256).reverse(),8),t.set(a(r,256).reverse(),264),n.setUint32(520,e.e,!0),(0,s.base64Encode)(t)+" ui.perfetto.dev"}serializeKey(){return JSON.stringify(this.jwkPrivate)}}}return Qb}function sv(){if(!nv){nv=1,Object.defineProperty(Zb,"__esModule",{value:!0}),Zb.AdbKeyManager=void 0,Zb.maybeStoreKey=async function(e){r()&&(e=new PasswordCredential({id:"webusb-adb-key",password:e.serializeKey(),name:"WebUSB ADB Key",iconURL:t.globals.root+"assets/favicon.png"}),await navigator.credentials.store(e),await navigator.credentials.preventSilentAccess())};const t=oe(),n=ov();function r(){return"PasswordCredential"in window}Zb.AdbKeyManager=class{key;keyInMemoryTimerId;async getKey(){if(this.key)return this.key;if(r()){var e=await navigator.credentials.get({password:!0,mediation:"optional"});if(null!==(t=e)&&"password"===t.type)return this.assignKey(n.AdbKey.DeserializeKey(e.password))}var t;return this.assignKey(await n.AdbKey.GenerateNewKeyPair())}assignKey(e){return this.key=e,this.keyInMemoryTimerId&&clearTimeout(this.keyInMemoryTimerId),this.keyInMemoryTimerId=setTimeout(()=>this.key=void 0,18e5),e}}}return Zb}var lv,cv={};function uv(){if(!lv){lv=1,Object.defineProperty(cv,"__esModule",{value:!0}),cv.targetFactoryRegistry=cv.TargetFactoryRegistry=void 0;class e extends Or().Registry{listTargets(){var e=[];for(const t of this.registry.values())for(const r of t.listTargets())e.push(r);return e}listTargetFactories(){return Array.from(this.registry.values())}listRecordingProblems(){var e=[];for(const t of this.registry.values())for(const r of t.listRecordingProblems())e.push(r);return e}}cv.TargetFactoryRegistry=e,cv.targetFactoryRegistry=new e(e=>e.kind)}return cv}var dv,fv={},pv={},hv={},gv={};function mv(){if(!dv){dv=1,Object.defineProperty(gv,"__esModule",{value:!0}),gv.ArrayBufferBuilder=void 0;const p=Je(),h=ee(),g=te();function f(e){return(0,g.isString)(e)?(0,p.length)(e):e instanceof Uint8Array?e.byteLength:((0,h.assertTrue)(0<=e&&e<=4294967295),4)}gv.ArrayBufferBuilder=class{tokens=[];toArrayBuffer(){let e=0;for(const u of this.tokens)e+=f(u);var t,r,n,a,i,o=new ArrayBuffer(e),s=new DataView(o),l=new Uint8Array(o);let c=0;for(const d of this.tokens)t=s,r=l,n=c,a=d,(i=void 0,g.isString)(a)?(i=(0,p.write)(a,r,n),(0,h.assertTrue)(i===(0,p.length)(a))):a instanceof Uint8Array?r.set(a,n):((0,h.assertTrue)(0<=a&&a<=4294967295),t.setUint32(n,a,!0)),c+=f(d);return(0,h.assertTrue)(c===e),o}append(e){this.tokens.push(e)}}}return gv}var _v,yv,Tv,bv={};function vv(){if(!yv){yv=1,Object.defineProperty(hv,"__esModule",{value:!0}),hv.AdbConnectionImpl=void 0;const n=Wa(),a=mv(),i=function(){if(!_v){_v=1,Object.defineProperty(bv,"__esModule",{value:!0}),bv.AdbFileHandler=void 0;const a=Wa(),i=ee(),o=mv(),n=iv(),s=b_(),l=J();bv.AdbFileHandler=class{byteStream;sentByteCount=0;isPushOngoing=!1;constructor(e){this.byteStream=e}async pushBinary(e,t){(0,i.assertFalse)(this.isPushOngoing),this.isPushOngoing=!0;const r=(0,a.defer)();this.byteStream.addOnStreamDataCallback(e=>this.onStreamData(e,r)),this.byteStream.addOnStreamCloseCallback(()=>this.isPushOngoing=!1);var n=new o.ArrayBufferBuilder;for(n.append("SEND"),n.append(t.length+6),n.append(t),n.append(","),n.append(33188..toString()),this.byteStream.write(new Uint8Array(n.toArrayBuffer()));!await this.sendNextDataChunk(e););return r}onStreamData(e,t){var r=(this.sentByteCount=0,l.utf8Decode)(e);if(r.split("\n")[0].includes("FAIL"))t.reject(new n.RecordingError(s.BINARY_PUSH_FAILURE+": "+r));else{if("OKAY"!==(0,l.utf8Decode)(e).substring(0,4))throw new n.RecordingError(s.BINARY_PUSH_UNKNOWN_RESPONSE+": "+r);t.resolve()}}async sendNextDataChunk(e){var t=Math.min(this.sentByteCount+65536,e.byteLength),t=await e.slice(this.sentByteCount,t),r=t.byteLength,n=new o.ArrayBufferBuilder,t=(n.append("DATA"),n.append(r),n.append(new Uint8Array(t.buffer,t.byteOffset,r)),this.sentByteCount+=r,this.sentByteCount===e.byteLength);return t&&(n.append("DONE"),n.append(Math.floor(Date.now()/1e3))),this.byteStream.write(new Uint8Array(n.toArrayBuffer())),t}}}return bv}(),o=J();hv.AdbConnectionImpl=class{onStatus=()=>{};onDisconnect=e=>{};async shellAndWaitCompletion(e){e=await this.shell(e);const t=(0,n.defer)();return e.addOnStreamCloseCallback(()=>{t.resolve()}),t}async shellAndGetOutput(e){e=await this.shell(e);const t=new a.ArrayBufferBuilder,r=(0,n.defer)();return e.addOnStreamDataCallback(e=>{t.append(e)}),e.addOnStreamCloseCallback(()=>{r.resolve((0,o.utf8Decode)(t.toArrayBuffer()))}),r}async push(e,t){var r=await this.openStream("sync:");await new i.AdbFileHandler(r).pushBinary(e,t),await r.closeAndWaitForTeardown()}}}return hv}var Ev,Sv,Av,Ov,Cv={},kv={};function wv(){if(Ev)return kv;Ev=1,Object.defineProperty(kv,"__esModule",{value:!0}),kv.TracedTracingSession=void 0;var e=or.__importDefault(lr());const t=Wa(),f=ee(),p=Sa(),a=iv(),h=b_(),g=z();function n(e){return new DataView(e.buffer,e.byteOffset,e.length).getUint32(0,!0)}kv.TracedTracingSession=class{byteStream;tracingSessionListener;incomingBuffer=new Uint8Array(131072);bufferedPartLength=0;currentFrameLength;availableMethods=[];serviceId=-1;resolveBindingPromise;requestMethods=new Map;partialPacket=[];traceProtoWriter=e.default.Writer.create();pendingDataSources=[];pendingQssMessage;requestId=1;pendingStatsMessages=new Array;constructor(e,t){this.byteStream=e,this.tracingSessionListener=t,this.byteStream.addOnStreamDataCallback(e=>this.handleReceivedData(e)),this.byteStream.addOnStreamCloseCallback(()=>this.clearState())}queryServiceState(){var e;return this.pendingQssMessage||(e=p.QueryServiceStateRequest.encode(new p.QueryServiceStateRequest).finish(),this.rpcInvoke("QueryServiceState",e),this.pendingQssMessage=(0,t.defer)())}start(e){var t=e.durationMs,t=(this.tracingSessionListener.onStatus(`${h.RECORDING_IN_PROGRESS}${t?" for "+t.toString()+" ms":""}...`),new p.EnableTracingRequest),e=(t.traceConfig=e,p.EnableTracingRequest.encode(t).finish());this.rpcInvoke("EnableTracing",e)}cancel(){this.terminateConnection()}stop(){var e=p.DisableTracingRequest.encode(new p.DisableTracingRequest).finish();this.rpcInvoke("DisableTracing",e)}async getTraceBufferUsage(){if(!this.byteStream.isConnected())return 0;var e,t;let r=-1;for(const n of await this.getBufferStats())Number.isFinite(n.bytesWritten)&&Number.isFinite(n.bufferSize)&&(e=(0,f.assertExists)(n.bytesWritten),0<=(t=(0,f.assertExists)(n.bufferSize)))&&(r=Math.max(r,e/t));return-1===r?Promise.reject(new a.RecordingError(h.BUFFER_USAGE_INCORRECT_FORMAT)):r}initConnection(){var e=this.requestId++,e=new p.IPCFrame({requestId:e,msgBindService:new p.IPCFrame.BindService({serviceName:"ConsumerPort"})});return this.writeFrame(e),(0,f.assertFalse)(!!this.resolveBindingPromise),this.resolveBindingPromise=(0,t.defer)(),this.resolveBindingPromise}getBufferStats(){var e=p.GetTraceStatsRequest.encode(new p.GetTraceStatsRequest).finish();try{this.rpcInvoke("GetTraceStats",e)}catch(e){this.raiseError(e)}e=(0,t.defer)();return this.pendingStatsMessages.push(e),e}terminateConnection(){this.clearState();var e=p.FreeBuffersRequest.encode(new p.FreeBuffersRequest).finish();this.rpcInvoke("FreeBuffers",e),this.byteStream.close()}clearState(){for(const e of this.pendingStatsMessages)e.reject(new a.RecordingError(h.BUFFER_USAGE_NOT_ACCESSIBLE));this.pendingStatsMessages=[],this.pendingDataSources=[],this.pendingQssMessage=void 0}rpcInvoke(t,e){if(this.byteStream.isConnected()){var r=this.availableMethods.find(e=>e.name===t);if(!(0,g.exists)(r)||!(0,g.exists)(r.id))throw new a.RecordingError(`Method ${t} not supported by the target`);var n=this.requestId++,r=new p.IPCFrame({requestId:n,msgInvokeMethod:new p.IPCFrame.InvokeMethod({serviceId:this.serviceId,methodId:r.id,argsProto:e})});this.requestMethods.set(n,t),this.writeFrame(r)}}writeFrame(e){var t=p.IPCFrame.encode(e).finish(),r=t.length,e=new Uint8Array(4+r),n=new DataView(e.buffer);n.setUint32(0,t.length,!0);for(let e=0;e<r;e++)n.setUint8(4+e,t[e]);this.byteStream.write(e)}handleReceivedData(e){var t;for(void 0===this.currentFrameLength&&this.canCompleteLengthHeader(e)&&(t=4-this.bufferedPartLength,this.appendToIncomingBuffer(e.subarray(0,t)),e=e.subarray(t),this.currentFrameLength=n(this.incomingBuffer),this.bufferedPartLength=0);void 0!==this.currentFrameLength&&this.bufferedPartLength+e.length>=this.currentFrameLength;){var r=this.currentFrameLength-this.bufferedPartLength;if(this.appendToIncomingBuffer(e.subarray(0,r)),this.parseFrame(this.incomingBuffer.subarray(0,this.currentFrameLength)),this.bufferedPartLength=0,e=e.subarray(r),!this.canCompleteLengthHeader(e)){this.currentFrameLength=void 0;break}this.currentFrameLength=n(e),e=e.subarray(4)}this.appendToIncomingBuffer(e)}canCompleteLengthHeader(e){return 4<e.length+this.bufferedPartLength}appendToIncomingBuffer(e){this.incomingBuffer.set(e,this.bufferedPartLength),this.bufferedPartLength+=e.length}parseFrame(e){e=p.IPCFrame.decode(e.slice());if("msgBindServiceReply"===e.msg){var t=e.msgBindServiceReply;(0,g.exists)(t)&&(0,g.exists)(t.methods)&&(0,g.exists)(t.serviceId)&&((0,f.assertTrue)(!0===t.success),this.availableMethods=t.methods,this.serviceId=t.serviceId,this.resolveBindingPromise.resolve())}else if("msgInvokeMethodReply"===e.msg){t=e.msgInvokeMethodReply;if(!0===t?.success){var r=this.requestMethods.get(e.requestId);if(r){var n=m.get(r);if(void 0===n)this.raiseError(h.PARSING_UNABLE_TO_DECODE_METHOD+": "+r);else{n={...n(t.replyProto)};if("ReadBuffers"===r){for(const l of n.slices??[])if(this.partialPacket.push(l),!0===l.lastSliceForPacket){let e=0;for(const c of this.partialPacket)e+=c.data.length;var a=new Uint8Array(e);let t=0;for(const u of this.partialPacket){var i=u.data;a.set(i,t),t+=i.length}this.traceProtoWriter.uint32(10),this.traceProtoWriter.bytes(a),this.partialPacket=[]}!1===t.hasMore&&(this.tracingSessionListener.onTraceData(this.traceProtoWriter.finish()),this.terminateConnection())}else if("EnableTracing"===r){var o=p.ReadBuffersRequest.encode(new p.ReadBuffersRequest).finish();this.rpcInvoke("ReadBuffers",o)}else if("GetTraceStats"===r){o=this.pendingStatsMessages.shift();o&&o.resolve(n.traceStats?.bufferStats??[])}else if("FreeBuffers"!==r&&"DisableTracing"!==r)if("QueryServiceState"===r){for(const d of n.serviceState?.dataSources||[]){var s=d?.dsDescriptor?.name;s&&this.pendingDataSources.push({name:s,descriptor:d.dsDescriptor})}!1===t.hasMore&&((0,f.assertExists)(this.pendingQssMessage).resolve(this.pendingDataSources),this.pendingDataSources=[],this.pendingQssMessage=void 0)}else this.raiseError(h.PARSING_UNRECOGNIZED_PORT+": "+r)}}else this.raiseError(h.PARSING_UNKNWON_REQUEST_ID+": "+e.requestId)}}else this.raiseError(h.PARSING_UNRECOGNIZED_MESSAGE+": "+e.msg)}raiseError(e){this.terminateConnection(),this.tracingSessionListener.onError(e)}};const m=(new Map).set("EnableTracing",p.EnableTracingResponse.decode).set("FreeBuffers",p.FreeBuffersResponse.decode).set("ReadBuffers",p.ReadBuffersResponse.decode).set("DisableTracing",p.DisableTracingResponse.decode).set("GetTraceStats",p.GetTraceStatsResponse.decode).set("QueryServiceState",p.QueryServiceStateResponse.decode);return kv}function Rv(){if(!Sv){Sv=1,Object.defineProperty(Cv,"__esModule",{value:!0}),Cv.AndroidTarget=void 0;const t=qo(),r=z(),n=Nr(),a=b_(),i=wv();Cv.AndroidTarget=class{adbConnection;onTargetChange;consumerSocketPath=a.DEFAULT_TRACED_CONSUMER_SOCKET_PATH;androidApiLevel;dataSources;constructor(e,t){this.adbConnection=e,this.onTargetChange=t}async disconnect(e){await this.adbConnection.disconnect(e)}async fetchTargetInfo(e){(await this.createTracingSession(e)).cancel()}canCreateTracingSession(e){return"LONG_TRACE"!==e}async createTracingSession(e){this.adbConnection.onStatus=e.onStatus,this.adbConnection.onDisconnect=e.onDisconnect,(0,r.exists)(this.androidApiLevel)||(t=await this.adbConnection.shellAndGetOutput("getprop ro.build.version.sdk"),this.androidApiLevel=Number(t),this.onTargetChange(),this.androidApiLevel<29&&(await this.pushTracebox(),this.consumerSocketPath=a.CUSTOM_TRACED_CONSUMER_SOCKET_PATH,await this.adbConnection.shellAndWaitCompletion(this.composeTraceboxCommand("traced")),await this.adbConnection.shellAndWaitCompletion(this.composeTraceboxCommand("traced_probes"))));var t=await this.adbConnection.connectSocket(this.consumerSocketPath),t=new i.TracedTracingSession(t,e);return await t.initConnection(),this.dataSources||(this.dataSources=await t.queryServiceState(),this.onTargetChange()),t}async pushTracebox(){var e=await this.fetchArchitecture(),e=`https://commondatastorage.googleapis.com/perfetto-luci-artifacts/${n.VERSION.split("-")[0]}/${e}/tracebox`,e=await(await(0,t.fetchWithTimeout)(e,{method:"get"},a.TRACEBOX_FETCH_TIMEOUT)).arrayBuffer();await this.adbConnection.push(new Uint8Array(e),a.TRACEBOX_DEVICE_PATH),await this.adbConnection.shellAndWaitCompletion("chmod 755 "+a.TRACEBOX_DEVICE_PATH)}async fetchArchitecture(){var e=await this.adbConnection.shellAndGetOutput("getprop ro.vendor.product.cpu.abilist");return e.includes("arm64-v8a")?"android-arm64":e.includes("x86")?"android-x86":e.includes("armeabi-v7a")||e.includes("armeabi")?"android-arm":e.includes("x86_64")?"android-x64":"android-arm64"}canConnectWithoutContention(){return this.adbConnection.canConnectWithoutContention()}composeTraceboxCommand(e){return"PERFETTO_CONSUMER_SOCK_NAME=@traced_consumer PERFETTO_PRODUCER_SOCK_NAME=@traced_producer "+`/data/local/tmp/tracebox ${e} --background`}}}return Cv}function Iv(){if(!Av){Av=1,Object.defineProperty(fv,"__esModule",{value:!0}),fv.AndroidWebusbTarget=void 0;const t=ee(),n=function(){if(!Tv){Tv=1;{var o=pv;Object.defineProperty(o,"__esModule",{value:!0}),o.AdbOverWebusbStream=o.AdbConnectionOverWebusb=o.AdbState=o.DEFAULT_MAX_PAYLOAD_BYTES=o.VERSION_NO_CHECKSUM=o.VERSION_WITH_CHECKSUM=void 0;const n=Wa(),u=ee(),r=te(),d=J();var s,l,e,t=vv();const f=sv(),p=iv(),h=b_();function c(t){let r=0;for(let e=0;e<t.byteLength;e++)r+=t[e];return 4294967295&r}o.VERSION_WITH_CHECKSUM=16777216,o.VERSION_NO_CHECKSUM=16777217,o.DEFAULT_MAX_PAYLOAD_BYTES=262144,(e=s||(o.AdbState=s={}))[e.DISCONNECTED=0]="DISCONNECTED",e[e.AUTH_STARTED=1]="AUTH_STARTED",e[e.AUTH_WITH_PRIVATE=2]="AUTH_WITH_PRIVATE",e[e.AUTH_WITH_PUBLIC=3]="AUTH_WITH_PUBLIC",e[e.CONNECTED=4]="CONNECTED",(e=l=l||{})[e.TOKEN=1]="TOKEN",e[e.SIGNATURE=2]="SIGNATURE",e[e.RSAPUBLICKEY=3]="RSAPUBLICKEY";class a extends t.AdbConnectionImpl{device;keyManager;state=s.DISCONNECTED;connectingStreams=new Map;streams=new Set;maxPayload=o.DEFAULT_MAX_PAYLOAD_BYTES;writeInProgress=!1;writeQueue=[];useChecksum=!0;lastStreamId=0;usbInterfaceNumber;usbReadEndpoint=-1;usbWriteEpEndpoint=-1;isUsbReceiveLoopRunning=!1;pendingConnPromises=[];constructor(e,t){super(),this.device=e,this.keyManager=t}shell(e){return this.openStream("shell:"+e)}connectSocket(e){return this.openStream(e)}async canConnectWithoutContention(){await this.device.open();var e=await this.setupUsbInterface();try{return await this.device.claimInterface(e),await this.device.releaseInterface(e),!0}catch(e){return!1}}async openStream(e){var t=++this.lastStreamId,r=(0,n.defer)();return this.connectingStreams.set(t,r),await this.ensureConnectionEstablished(),await this.sendMessage("OPEN",t,0,e),r}async ensureConnectionEstablished(){var e;this.state!==s.CONNECTED&&(this.state===s.DISCONNECTED&&(await this.device.open(),await this.canConnectWithoutContention()||await this.device.reset(),e=await this.setupUsbInterface(),await this.device.claimInterface(e)),await this.startAdbAuth(),this.isUsbReceiveLoopRunning||this.usbReceiveLoop(),e=(0,n.defer)(),this.pendingConnPromises.push(e),await e)}async setupUsbInterface(){var e=(0,h.findInterfaceAndEndpoint)(this.device),{configurationValue:e,usbInterfaceNumber:t,endpoints:r}=(0,u.assertExists)(e);return this.usbInterfaceNumber=t,this.usbReadEndpoint=this.findEndpointNumber(r,"in"),this.usbWriteEpEndpoint=this.findEndpointNumber(r,"out"),(0,u.assertTrue)(0<=this.usbReadEndpoint&&0<=this.usbWriteEpEndpoint),await this.device.selectConfiguration(e),t}async streamClose(t){var e=this.writeQueue.filter(e=>e.localStreamId!==t.localStreamId),r=this.writeQueue.length-e.length;0<r&&(console.debug(`Dropping ${r} queued messages due to stream closing.`),this.writeQueue=e),this.streams.delete(t),0===this.streams.size&&await this.disconnect(),t.signalStreamClosed()}streamWrite(e,t){e=(0,r.isString)(e)?(0,d.utf8Encode)(e):e;this.writeInProgress?this.writeQueue.push({message:e,localStreamId:t.localStreamId}):(this.writeInProgress=!0,this.sendMessage("WRTE",t.localStreamId,t.remoteStreamId,e))}async disconnect(e){this.state!==s.DISCONNECTED&&(this.reachDisconnectState(e),await(0,p.wrapRecordingError)(this.device.releaseInterface((0,u.assertExists)(this.usbInterfaceNumber)),()=>{}),this.usbInterfaceNumber=void 0)}reachDisconnectState(e){var t,r,n=this.connectingStreams.entries();this.connectingStreams.clear();for([t,r]of n)r.reject(`Failed to open stream with id ${t} because adb was disconnected.`);this.state!==s.DISCONNECTED&&(this.state=s.DISCONNECTED,this.writeInProgress=!1,this.writeQueue=[],this.streams.forEach(e=>e.close()),this.onDisconnect(e))}async startAdbAuth(){var e=this.useChecksum?o.VERSION_WITH_CHECKSUM:o.VERSION_NO_CHECKSUM;this.state=s.AUTH_STARTED,await this.sendMessage("CNXN",e,this.maxPayload,"host:1:UsbADB")}findEndpointNumber(e,t,r="bulk"){e=e.find(e=>e.type===r&&e.direction===t);if(e)return e.endpointNumber;throw new p.RecordingError(`Cannot find ${t} endpoint`)}async usbReceiveLoop(){for((0,u.assertFalse)(this.isUsbReceiveLoopRunning),this.isUsbReceiveLoopRunning=!0;this.state!==s.DISCONNECTED;){var e=await this.wrapUsb(this.device.transferIn(this.usbReadEndpoint,m));if(!e)return void(this.isUsbReceiveLoopRunning=!1);if("ok"!==e.status)console.error(`Received message with unexpected status '${e.status}'`);else{e=_.decodeHeader(e.data);if(0<e.dataLen){var t=await this.wrapUsb(this.device.transferIn(this.usbReadEndpoint,e.dataLen));if(!t)return void(this.isUsbReceiveLoopRunning=!1);e.data=new Uint8Array(t.data.buffer,t.data.byteOffset,t.data.byteLength)}if((!this.useChecksum||c(e.data)===e.dataChecksum)&&("CLSE"!==e.cmd&&"WRTE"!==e.cmd||this.getStreamForLocalStreamId(e.arg1))&&("OKAY"!==e.cmd||this.connectingStreams.has(e.arg1)||this.getStreamForLocalStreamId(e.arg1))&&("AUTH"!==e.cmd||e.arg0!==l.TOKEN||this.state!==s.AUTH_WITH_PUBLIC))if("CLSE"===e.cmd)(0,u.assertExists)(this.getStreamForLocalStreamId(e.arg1)).close();else if("AUTH"===e.cmd&&e.arg0===l.TOKEN){t=await this.keyManager.getKey();this.state===s.AUTH_STARTED?(this.state=s.AUTH_WITH_PRIVATE,await this.sendMessage("AUTH",l.SIGNATURE,0,t.sign(e.data))):(this.state=s.AUTH_WITH_PUBLIC,await this.sendMessage("AUTH",l.RSAPUBLICKEY,0,t.getPublicKey()+"\0"),this.onStatus(h.ALLOW_USB_DEBUGGING),await(0,f.maybeStoreKey)(t))}else if("CNXN"===e.cmd){(0,u.assertTrue)([s.AUTH_WITH_PRIVATE,s.AUTH_WITH_PUBLIC].includes(this.state)),this.state=s.CONNECTED,this.maxPayload=e.arg1;var r=e.arg0;if(![o.VERSION_WITH_CHECKSUM,o.VERSION_NO_CHECKSUM].includes(r))throw new p.RecordingError(`Version ${e.arg0} not supported.`);this.useChecksum=r===o.VERSION_WITH_CHECKSUM,this.state=s.CONNECTED,this.pendingConnPromises.forEach(e=>e.resolve()),this.pendingConnPromises=[]}else if("OKAY"===e.cmd)if(this.connectingStreams.has(e.arg1)){var r=(0,u.assertExists)(this.connectingStreams.get(e.arg1)),n=new g(this,e.arg1,e.arg0);this.streams.add(n),this.connectingStreams.delete(e.arg1),r.resolve(n)}else for((0,u.assertTrue)(this.writeInProgress),this.writeInProgress=!1;this.writeQueue.length;){var a=(0,u.assertExists)(this.writeQueue.shift()),i=this.getStreamForLocalStreamId(a.localStreamId);if(i){i.write(a.message);break}}else{if("WRTE"!==e.cmd)throw this.isUsbReceiveLoopRunning=!1,new p.RecordingError(`Unexpected message ${e} in state `+this.state);n=(0,u.assertExists)(this.getStreamForLocalStreamId(e.arg1));await this.sendMessage("OKAY",n.localStreamId,n.remoteStreamId),n.signalStreamData(e.data)}}}this.isUsbReceiveLoopRunning=!1}getStreamForLocalStreamId(e){for(const t of this.streams)if(t.localStreamId===e)return t}async sendMessage(e,t,r,n){e=_.create({cmd:e,arg0:t,arg1:r,data:n,useChecksum:this.useChecksum}),t=e.encodeHeader(),r=e.data,(0,u.assertTrue)(t.length<=this.maxPayload&&r.length<=this.maxPayload),n=[this.wrapUsb(this.device.transferOut(this.usbWriteEpEndpoint,t.buffer))];0<e.data.length&&n.push(this.wrapUsb(this.device.transferOut(this.usbWriteEpEndpoint,r.buffer))),await Promise.all(n)}wrapUsb(e){return(0,p.wrapRecordingError)(e,this.reachDisconnectState.bind(this))}}o.AdbConnectionOverWebusb=a;class g{adbConnection;_isConnected;onStreamDataCallbacks=[];onStreamCloseCallbacks=[];localStreamId;remoteStreamId=-1;constructor(e,t,r){this.adbConnection=e,this.localStreamId=t,this.remoteStreamId=r,this._isConnected=!0}addOnStreamDataCallback(e){this.onStreamDataCallbacks.push(e)}addOnStreamCloseCallback(e){this.onStreamCloseCallbacks.push(e)}signalStreamData(e){for(const t of this.onStreamDataCallbacks)t(e)}signalStreamClosed(){for(const e of this.onStreamCloseCallbacks)e();this.onStreamDataCallbacks=[],this.onStreamCloseCallbacks=[]}close(){this.closeAndWaitForTeardown()}async closeAndWaitForTeardown(){this._isConnected=!1,await this.adbConnection.streamClose(this)}write(e){this.adbConnection.streamWrite(e,this)}isConnected(){return this._isConnected}}o.AdbOverWebusbStream=g;const m=24;class _{data;cmd;arg0;arg1;dataLen;dataChecksum;useChecksum;constructor(e,t,r,n,a,i=!1){(0,u.assertTrue)(4===e.length),this.cmd=e,this.arg0=t,this.arg1=r,this.dataLen=n,this.data=new Uint8Array(n),this.dataChecksum=a,this.useChecksum=i}static create({cmd:e,arg0:t,arg1:r,data:n,useChecksum:a=!0}){n=this.encodeData(n),e=new _(e,t,r,n.length,0,a);return e.data=n,e}get dataStr(){return(0,d.utf8Decode)(this.data)}toString(){return`${this.cmd} [${this.arg0},${this.arg1}] `+this.dataStr}static decodeHeader(e){(0,u.assertTrue)(e.byteLength===m);var t=(0,d.utf8Decode)(e.buffer.slice(0,4)),r=e.getUint32(0,!0),n=e.getUint32(4,!0),a=e.getUint32(8,!0),i=e.getUint32(12,!0),o=e.getUint32(16,!0),e=e.getUint32(20,!0);return(0,u.assertTrue)(r===(4294967295^e)),new _(t,n,a,i,o)}encodeHeader(){var e=new Uint8Array(m),t=new DataView(e.buffer),r=(0,d.utf8Encode)(this.cmd),n=_.encodeData(this.data),a=this.useChecksum?c(n):0;for(let e=0;e<4;e++)t.setUint8(e,r[e]);return t.setUint32(4,this.arg0,!0),t.setUint32(8,this.arg1,!0),t.setUint32(12,n.byteLength,!0),t.setUint32(16,a,!0),t.setUint32(20,4294967295^t.getUint32(0,!0),!0),e}static encodeData(e){return void 0===e?new Uint8Array([]):(0,r.isString)(e)?(0,d.utf8Encode)(e+"\0"):e}}}}return pv}();class e extends Rv().AndroidTarget{device;constructor(e,t,r){super(new n.AdbConnectionOverWebusb(e,t),r),this.device=e}getInfo(){var e=(0,t.assertExists)(this.device.productName)+" "+(0,t.assertExists)(this.device.serialNumber)+" WebUsb";return{targetType:"ANDROID",androidApiLevel:this.androidApiLevel,dataSources:this.dataSources||[],name:e}}}fv.AndroidWebusbTarget=e}return fv}function Mv(){if(!Ov){Ov=1;{var e=Jb;Object.defineProperty(e,"__esModule",{value:!0}),e.AndroidWebusbTargetFactory=e.ANDROID_WEBUSB_TARGET_FACTORY=void 0;const i=Id(),o=ee();var t=re(),r=sv();const s=iv(),l=b_();var n=uv();const c=Iv();e.ANDROID_WEBUSB_TARGET_FACTORY="AndroidWebusbTargetFactory";function a(e,t){e=e.productName;return`USB device${e?" "+e:""} has `+t}class u{usb;kind=e.ANDROID_WEBUSB_TARGET_FACTORY;onTargetChange=()=>{};recordingProblems=[];targets=new Map;keyManager=new r.AdbKeyManager;constructor(e){this.usb=e,this.init()}getName(){return"Android WebUsb"}listTargets(){return Array.from(this.targets.values())}listRecordingProblems(){return this.recordingProblems}async connectNewTarget(){let e;try{e=await this.usb.requestDevice({filters:[l.ADB_DEVICE_FILTER]})}catch(e){throw new s.RecordingError((0,i.getErrorMessage)(e))}var t,r=this.checkDeviceValidity(e);if(r.isValid)return t=new c.AndroidWebusbTarget(e,this.keyManager,this.onTargetChange),this.targets.set((0,o.assertExists)(e.serialNumber),t),t;throw new s.RecordingError(r.issues.join("\n"))}setOnTargetChange(e){this.onTargetChange=e}async init(){let e=[];try{e=await this.usb.getDevices()}catch(e){return}for(const t of e)this.checkDeviceValidity(t).isValid&&this.targets.set((0,o.assertExists)(t.serialNumber),new c.AndroidWebusbTarget(t,this.keyManager,this.onTargetChange));this.usb.addEventListener("connect",e=>{this.checkDeviceValidity(e.device).isValid&&(this.targets.set((0,o.assertExists)(e.device.serialNumber),new c.AndroidWebusbTarget(e.device,this.keyManager,this.onTargetChange)),this.onTargetChange())}),this.usb.addEventListener("disconnect",async e=>{e=(0,o.assertExists)(e.device.serialNumber);await(0,o.assertExists)(this.targets.get(e)).disconnect(`Device with serial ${e} was disconnected.`),this.targets.delete(e),this.onTargetChange()})}checkDeviceValidity(e){var t={isValid:!0,issues:[]};return e.serialNumber||(t.issues.push(a(e,"an invalid serial number")),t.isValid=!1),(0,l.findInterfaceAndEndpoint)(e)||(t.issues.push(a(e,"an incompatible adb interface")),t.isValid=!1),this.recordingProblems.push(...t.issues),t}}e.AndroidWebusbTargetFactory=u,navigator.usb&&t.RECORDING_V2_FLAG.get()&&n.targetFactoryRegistry.register(new u(navigator.usb))}}return Jb}var Pv,Nv,Dv,xv={},Lv={},Fv={};function Uv(){if(!Nv){Nv=1,Object.defineProperty(Lv,"__esModule",{value:!0}),Lv.AndroidWebsocketTarget=void 0;const n=function(){if(Pv)return Fv;Pv=1,Object.defineProperty(Fv,"__esModule",{value:!0}),Fv.AdbOverWebsocketStream=Fv.AdbConnectionOverWebsocket=void 0;const o=Wa(),s=J();var e=vv();const l=iv(),c=b_();class t extends e.AdbConnectionImpl{deviceSerialNumber;websocketUrl;streams=new Set;onDisconnect=e=>{};constructor(e,t){super(),this.deviceSerialNumber=e,this.websocketUrl=t}shell(e){return this.openStream("shell:"+e)}connectSocket(e){return this.openStream(e)}async openStream(e){return a.create(this.websocketUrl,e,this.deviceSerialNumber,this.closeStream.bind(this))}async disconnect(e){for(const t of this.streams)t.close();this.onDisconnect(e)}closeStream(e){this.streams.has(e)&&this.streams.delete(e)}canConnectWithoutContention(){return Promise.resolve(!0)}}Fv.AdbConnectionOverWebsocket=t;class a{removeFromConnection;websocket;commandSentSignal=(0,o.defer)();messageProcessedSignals=new Set;_isConnected=!1;onStreamDataCallbacks=[];onStreamCloseCallbacks=[];constructor(e,t,r,n){this.removeFromConnection=n,this.websocket=new WebSocket(e),this.websocket.onopen=this.onOpen.bind(this,r),this.websocket.onmessage=this.onMessage.bind(this,t),this.websocket.onclose=this.onClose.bind(this)}addOnStreamDataCallback(e){this.onStreamDataCallbacks.push(e)}addOnStreamCloseCallback(e){this.onStreamCloseCallbacks.push(e)}signalStreamData(e){for(const t of this.onStreamDataCallbacks)t(e)}signalStreamClosed(){for(const e of this.onStreamCloseCallbacks)e();this.onStreamDataCallbacks=[],this.onStreamCloseCallbacks=[]}close(){this.websocket.readyState===this.websocket.OPEN&&(this.websocket.close(),this.websocket.onclose=null),this._isConnected=!1,this.removeFromConnection(this),this.signalStreamClosed()}async closeAndWaitForTeardown(){this.close()}write(e){this.websocket.send(e)}isConnected(){return this._isConnected}async onOpen(e){this.websocket.send((0,c.buildAbdWebsocketCommand)("host:transport:"+e))}async onMessage(e,t){var r,n,a,i=(0,o.defer)();this.messageProcessedSignals.add(i);try{this._isConnected?(r=await t.data.arrayBuffer(),"OKAY"!==(0,s.utf8Decode)(r)&&this.signalStreamData(new Uint8Array(r))):"OKAY"===(a=(n=await t.data.text()).substring(0,4))?(this._isConnected=!0,this.websocket.send((0,c.buildAbdWebsocketCommand)(e)),this.commandSentSignal.resolve(this)):("FAIL"===a&&n.includes("device unauthorized")?this.commandSentSignal.reject(new l.RecordingError(c.ALLOW_USB_DEBUGGING)):this.commandSentSignal.reject(new l.RecordingError(c.WEBSOCKET_UNABLE_TO_CONNECT)),this.close()),i.resolve()}finally{this.messageProcessedSignals.delete(i)}}async onClose(){await Promise.allSettled(this.messageProcessedSignals),this.close()}static create(e,t,r,n){return new a(e,t,r,n).commandSentSignal}}return Fv.AdbOverWebsocketStream=a,Fv}();class e extends Rv().AndroidTarget{serialNumber;constructor(e,t,r){super(new n.AdbConnectionOverWebsocket(e,t),r),this.serialNumber=e}getInfo(){return{targetType:"ANDROID",androidApiLevel:this.androidApiLevel,dataSources:this.dataSources||[],name:this.serialNumber+" WebSocket"}}}Lv.AndroidWebsocketTarget=e}return Lv}function Bv(){if(!Dv){Dv=1;{var e=xv;Object.defineProperty(e,"__esModule",{value:!0}),e.AndroidWebsocketTargetFactory=e.WebsocketConnection=e.ANDROID_WEBSOCKET_TARGET_FACTORY=void 0,e.parseWebsocketResponse=n;var t=re();const a=b_();var r=uv();const i=Uv(),l=(e.ANDROID_WEBSOCKET_TARGET_FACTORY="AndroidWebsocketTargetFactory",4);function n(e){for(var t=new Map;e.length>=l;){var r=parseInt(e.substring(0,l),16),r=l+r;if(e.length<r)break;for(const s of e.substring(l,r).split("\n")){var n=function(e){if(2===(e=e.split("\t")).length)return{serialNumber:e[0],connectionState:e[1]}}(s);n&&t.set(n.serialNumber,n.connectionState)}e=e.substring(r)}var a,i,o=[];for([a,i]of t.entries())o.push({serialNumber:a,connectionState:i});return{listedDevices:o,messageRemainder:e}}class o{websocket;maybeClearConnection;onTargetChange;targets=new Map;pendingData="";constructor(e,t,r){this.websocket=e,this.maybeClearConnection=t,this.onTargetChange=r,this.initWebsocket()}listTargets(){return Array.from(this.targets.values())}initWebsocket(){this.websocket.onclose=e=>{e.code===a.WEBSOCKET_CLOSED_ABNORMALLY_CODE&&console.info(`It's safe to ignore the 'WebSocket connection to ${this.websocket.url} error above, if present. It occurs when `+"checking the connection to the local Websocket server."),this.maybeClearConnection(this),this.close()},this.websocket.onopen=()=>{this.websocket.send((0,a.buildAbdWebsocketCommand)("host:track-devices"))},this.websocket.onmessage=async e=>{let t=await e.data.text();"OKAY"===t.substr(0,4)&&(t=t.substr(4));e=n(this.pendingData+t);this.pendingData=e.messageRemainder,this.trackDevices(e.listedDevices)}}close(){this.websocket.readyState===this.websocket.OPEN&&this.websocket.close();for(const e of this.targets.values())e.disconnect();this.targets.clear(),this.onTargetChange&&this.onTargetChange()}getUrl(){return this.websocket.url}trackDevices(e){let t=!1;for(const n of e){var r;["offline","unknown"].includes(n.connectionState)?void 0!==(r=this.targets.get(n.serialNumber))&&(r.disconnect(),this.targets.delete(n.serialNumber),t=!0):this.targets.has(n.serialNumber)||(this.targets.set(n.serialNumber,new i.AndroidWebsocketTarget(n.serialNumber,this.websocket.url,this.onTargetChange)),t=!0)}t&&this.onTargetChange()}}e.WebsocketConnection=o;class s{kind=e.ANDROID_WEBSOCKET_TARGET_FACTORY;onTargetChange=()=>{};websocketConnection;getName(){return"Android Websocket"}listTargets(){return this.websocketConnection?this.websocketConnection.listTargets():[]}listRecordingProblems(){return[]}connectNewTarget(){return Promise.reject(new Error("The websocket can only automatically connect targets when they become available."))}tryEstablishWebsocket(e){if(this.websocketConnection){if(this.websocketConnection.getUrl()===e)return;this.websocketConnection.close()}e=new WebSocket(e);this.websocketConnection=new o(e,this.maybeClearConnection,this.onTargetChange)}maybeClearConnection(e){this.websocketConnection===e&&(this.websocketConnection=void 0)}setOnTargetChange(e){this.onTargetChange=e}}e.AndroidWebsocketTargetFactory=s,t.RECORDING_V2_FLAG.get()&&r.targetFactoryRegistry.register(new s)}}return xv}var jv,Hv={},Gv={},Vv={},Wv={},qv={};function $v(){return jv||(jv=1,Object.defineProperty(qv,"__esModule",{value:!0}),qv.hasProperty=function(e,t){return e.hasOwnProperty(t)},qv.isTyped=function(e){return e.hasOwnProperty("type")},qv.isReadBuffersResponse=function(e){return"ReadBuffersResponse"===e.type},qv.isEnableTracingResponse=function(e){return"EnableTracingResponse"===e.type},qv.isGetTraceStatsResponse=function(e){return"GetTraceStatsResponse"===e.type},qv.isFreeBuffersResponse=function(e){return"FreeBuffersResponse"===e.type},qv.isDisableTracingResponse=function(e){return"DisableTracingResponse"===e.type}),qv}var zv,Kv,Yv,Jv,Zv,Qv={};function Xv(){if(!zv){zv=1,Object.defineProperty(Qv,"__esModule",{value:!0}),Qv.RpcConsumerPort=void 0;const e=$y();Qv.RpcConsumerPort=class{consumerPortListener;constructor(e){this.consumerPortListener=e}sendMessage(e){this.consumerPortListener.onConsumerPortResponse(e)}sendErrorMessage(e){this.consumerPortListener.onError(e)}sendStatus(e){this.consumerPortListener.onStatus(e)}getRecordedTraceSuffix(){return e.TRACE_SUFFIX}}}return Qv}function eE(){if(!Kv){Kv=1,Object.defineProperty(Wv,"__esModule",{value:!0}),Wv.ChromeExtensionConsumerPort=void 0,Wv.isChromeExtensionError=r,Wv.isChromeExtensionStatus=n,Wv.isGetCategoriesResponse=function(e){return!(!function(e){return"object"==typeof e&&null!==e}(e)||!(0,i.hasProperty)(e,"type")||"GetCategoriesResponse"!==e.type)&&(0,i.hasProperty)(e,"categories")&&Array.isArray(e.categories)};const a=J(),e=$y(),i=$v();class t extends Xv().RpcConsumerPort{extensionPort;constructor(e,t){super(t),this.extensionPort=e,this.extensionPort.onmessage=this.onExtensionMessage.bind(this)}onExtensionMessage(e){var t;r(e.data)?this.sendErrorMessage(e.data.error):n(e.data)?this.sendStatus(e.data.status):((0,i.isReadBuffersResponse)(e.data)&&e.data.slices&&(t=e.data.slices[0].data,e.data.slices[0].data=(0,a.binaryDecode)(t)),this.sendMessage(e.data))}handleCommand(e,t){t=(0,a.binaryEncode)(t);this.extensionPort.postMessage({method:e,requestData:t})}getRecordedTraceSuffix(){return e.TRACE_SUFFIX+".gz"}}function r(e){return"ChromeExtensionError"===e.type}function n(e){return"ChromeExtensionStatus"===e.type}Wv.ChromeExtensionConsumerPort=t}return Wv}function tE(){if(!Jv){Jv=1,Object.defineProperty(Gv,"__esModule",{value:!0}),Gv.ChromeTarget=void 0;const t=function(){if(!Yv){Yv=1,Object.defineProperty(Vv,"__esModule",{value:!0}),Vv.ChromeTracedTracingSession=void 0;const t=Wa(),l=ee(),c=J(),u=eE(),d=$v(),r=Sa(),f=iv(),p=b_();Vv.ChromeTracedTracingSession=class{tracingSessionListener;partialPacket=[];pendingGetCategoriesMessage;pendingStatsMessages=new Array;chromePort;isPortConnected;constructor(e){this.tracingSessionListener=e,this.chromePort=chrome.runtime.connect(p.EXTENSION_ID),this.isPortConnected=!0}start(e){var t;this.isPortConnected&&(t=e.durationMs,this.tracingSessionListener.onStatus(`Recording in progress${t?" for "+t.toString()+" ms":""}...`),(t=new r.EnableTracingRequest).traceConfig=e,e=(0,c.binaryEncode)(r.EnableTracingRequest.encode(t).finish()),this.chromePort.postMessage({method:"EnableTracing",requestData:e}))}cancel(){this.isPortConnected&&this.terminateConnection()}stop(){this.isPortConnected&&this.chromePort.postMessage({method:"DisableTracing"})}getCategories(){if(this.isPortConnected)return this.pendingGetCategoriesMessage||(this.chromePort.postMessage({method:"GetCategories"}),this.pendingGetCategoriesMessage=(0,t.defer)());throw new f.RecordingError("Attempting to get categories from a disconnected tracing session.")}async getTraceBufferUsage(){if(!this.isPortConnected)return 0;let e=-1;for(const n of await this.getBufferStats()){var t=(0,l.assertExists)(n.bytesWritten),r=(0,l.assertExists)(n.bufferSize);0<=r&&(e=Math.max(e,t/r))}if(-1===e)throw new f.RecordingError(p.BUFFER_USAGE_INCORRECT_FORMAT);return e}initConnection(){this.chromePort.onMessage.addListener(e=>{this.handleExtensionMessage(e)})}getBufferStats(){this.chromePort.postMessage({method:"GetTraceStats"});var e=(0,t.defer)();return this.pendingStatsMessages.push(e),e}terminateConnection(){this.chromePort.postMessage({method:"FreeBuffers"}),this.clearState()}clearState(){this.chromePort.disconnect(),this.isPortConnected=!1;for(const e of this.pendingStatsMessages)e.reject(new f.RecordingError(p.BUFFER_USAGE_NOT_ACCESSIBLE));this.pendingStatsMessages=[],this.pendingGetCategoriesMessage=void 0}handleExtensionMessage(e){if((0,u.isChromeExtensionError)(e))this.terminateConnection(),this.tracingSessionListener.onError(e.error);else if((0,u.isChromeExtensionStatus)(e))this.tracingSessionListener.onStatus(e.status);else if((0,d.isReadBuffersResponse)(e)){if(e.slices)for(const i of e.slices){if("string"!=typeof i.data)throw new f.RecordingError(p.MALFORMED_EXTENSION_MESSAGE);var t={data:(0,c.binaryDecode)(i.data)};if(this.partialPacket.push(t),i.lastSliceForPacket){let e=0;for(const o of this.partialPacket)e+=o.data.length;var r=new Uint8Array(e);let t=0;for(const s of this.partialPacket){var n=s.data;r.set(n,t),t+=n.length}this.tracingSessionListener.onTraceData(r),this.terminateConnection()}}}else{var a;(0,u.isGetCategoriesResponse)(e)?((0,l.assertExists)(this.pendingGetCategoriesMessage).resolve(e.categories),this.pendingGetCategoriesMessage=void 0):(0,d.isEnableTracingResponse)(e)?this.chromePort.postMessage({method:"ReadBuffers"}):(0,d.isGetTraceStatsResponse)(e)?(a=this.pendingStatsMessages.shift())&&a.resolve(e?.traceStats?.bufferStats||[]):(0,d.isFreeBuffersResponse)(e)||(0,l.assertTrue)((0,d.isDisableTracingResponse)(e))}}}}return Vv}();Gv.ChromeTarget=class{name;targetType;onTargetChange;chromeCategories;constructor(e,t){this.name=e,this.targetType=t}getInfo(){return{targetType:this.targetType,name:this.name,dataSources:[{name:"chromeCategories",descriptor:this.chromeCategories}]}}canCreateTracingSession(){return!0}async createTracingSession(e){e=new t.ChromeTracedTracingSession(e);return e.initConnection(),this.chromeCategories||(this.chromeCategories=await e.getCategories(),this.onTargetChange&&this.onTargetChange()),e}async fetchTargetInfo(e){(await this.createTracingSession(e)).cancel()}disconnect(e){return Promise.resolve(void 0)}async canConnectWithoutContention(){return!0}}}return Gv}function rE(){if(!Zv){Zv=1;{var e=Hv;Object.defineProperty(e,"__esModule",{value:!0}),e.ChromeTargetFactory=e.CHROME_TARGET_FACTORY=void 0;const r=iv(),n=b_();var t=uv();const a=tE();e.CHROME_TARGET_FACTORY="ChromeTargetFactory";class i{kind=e.CHROME_TARGET_FACTORY;isExtensionInstalled=!1;targets=[];constructor(){this.init()}init(){var e=chrome.runtime.connect(n.EXTENSION_ID);this.isExtensionInstalled=!!e,e.disconnect(),this.isExtensionInstalled&&(this.targets.push(new a.ChromeTarget("Chrome","CHROME")),(0,n.isCrOS)(navigator.userAgent)&&this.targets.push(new a.ChromeTarget("ChromeOS","CHROME_OS")),(0,n.isWindows)(navigator.userAgent))&&this.targets.push(new a.ChromeTarget("Windows Desktop","WINDOWS"))}connectNewTarget(){throw new r.RecordingError("Can not create a new Chrome target.All Chrome targets are created at factory initialisation.")}getName(){return"Chrome"}listRecordingProblems(){var e=[];return this.isExtensionInstalled||e.push(n.EXTENSION_NOT_INSTALLED),e}listTargets(){return this.targets}setOnTargetChange(e){for(const t of this.targets)t.onTargetChange=e}}e.ChromeTargetFactory=i,globalThis.chrome&&chrome.runtime&&t.targetFactoryRegistry.register(new i)}}return Hv}var nE,aE,iE,oE={},sE={},lE={};function cE(){if(!nE){nE=1,Object.defineProperty(lE,"__esModule",{value:!0}),lE.HostOsByteStream=void 0;var e=Wa();lE.HostOsByteStream=class t{handshakeSignal=(0,e.defer)();_isConnected=!1;websocket;onStreamDataCallbacks=[];onStreamCloseCallbacks=[];constructor(e){this.websocket=new WebSocket(e),this.websocket.onmessage=this.onMessage.bind(this),this.websocket.onopen=this.onOpen.bind(this)}addOnStreamDataCallback(e){this.onStreamDataCallbacks.push(e)}addOnStreamCloseCallback(e){this.onStreamCloseCallbacks.push(e)}close(){this.websocket.close();for(const e of this.onStreamCloseCallbacks)e();this.onStreamDataCallbacks=[],this.onStreamCloseCallbacks=[]}async closeAndWaitForTeardown(){this.close()}isConnected(){return this._isConnected}write(e){this.websocket.send(e)}async onMessage(e){for(const r of this.onStreamDataCallbacks){var t=await e.data.arrayBuffer();r(new Uint8Array(t))}}onOpen(){this._isConnected=!0,this.handshakeSignal.resolve(this)}static create(e){return new t(e).handshakeSignal}}}return lE}function uE(){if(!iE){iE=1;{var e=oE;Object.defineProperty(e,"__esModule",{value:!0}),e.HostOsTargetFactory=e.HOST_OS_TARGET_FACTORY=void 0;const n=iv();var t=b_(),r=uv();const a=function(){if(!aE){aE=1,Object.defineProperty(sE,"__esModule",{value:!0}),sE.HostOsTarget=void 0;const r=cE(),n=iv(),a=b_(),i=wv();sE.HostOsTarget=class{maybeClearTarget;onTargetChange;targetType;name;websocket;streams=new Set;dataSources;onDisconnect=e=>{};constructor(e,t,r){if(this.maybeClearTarget=t,this.onTargetChange=r,(0,a.isMacOs)(navigator.userAgent))this.name="MacOS",this.targetType="MACOS";else{if(!(0,a.isLinux)(navigator.userAgent))throw new n.RecordingError("Host OS target created on an unsupported operating system.");this.name="Linux",this.targetType="LINUX"}this.websocket=new WebSocket(e),this.websocket.onclose=this.onClose.bind(this),this.websocket.onerror=this.disconnect.bind(this)}getInfo(){return{targetType:this.targetType,name:this.name,dataSources:this.dataSources||[]}}canCreateTracingSession(){return!0}async createTracingSession(e){this.onDisconnect=e.onDisconnect;var t=await r.HostOsByteStream.create(this.getUrl()),t=(this.streams.add(t),new i.TracedTracingSession(t,e));return await t.initConnection(),this.dataSources||(this.dataSources=await t.queryServiceState(),this.onTargetChange()),t}async fetchTargetInfo(e){(await this.createTracingSession(e)).cancel()}async disconnect(){this.websocket.readyState===this.websocket.OPEN&&(this.websocket.close(),this.websocket.onclose=null);for(const e of this.streams)e.close();this.maybeClearTarget(this),this.onDisconnect()}async canConnectWithoutContention(){return!0}getUrl(){return this.websocket.url}onClose(e){e.code===a.WEBSOCKET_CLOSED_ABNORMALLY_CODE&&console.info(`It's safe to ignore the 'WebSocket connection to ${this.getUrl()} error above, if present. It occurs when `+"checking the connection to the local Websocket server."),this.disconnect()}}}return sE}();e.HOST_OS_TARGET_FACTORY="HostOsTargetFactory";class i{kind=e.HOST_OS_TARGET_FACTORY;target;onTargetChange=()=>{};connectNewTarget(){throw new n.RecordingError("Can not create a new Host OS target.The Host OS target is created at factory initialisation.")}getName(){return"HostOs"}listRecordingProblems(){return[]}listTargets(){return this.target?[this.target]:[]}tryEstablishWebsocket(e){if(this.target){if(this.target.getUrl()===e)return;this.target.disconnect()}this.target=new a.HostOsTarget(e,this.maybeClearTarget.bind(this),this.onTargetChange),this.onTargetChange()}maybeClearTarget(e){this.target===e&&(this.target=void 0,this.onTargetChange())}setOnTargetChange(e){this.onTargetChange=e}}e.HostOsTargetFactory=i,((0,t.isMacOs)(navigator.userAgent)||(0,t.isLinux)(navigator.userAgent))&&r.targetFactoryRegistry.register(new i)}}return oE}var dE,fE,pE,hE={},gE={};function mE(){if(!fE){fE=1,Object.defineProperty(hE,"__esModule",{value:!0}),hE.VirtualTargetFactory=void 0;const t=iv();var e=uv();const r=function(){if(!dE){dE=1,Object.defineProperty(gE,"__esModule",{value:!0}),gE.AndroidVirtualTarget=void 0;const t=iv();gE.AndroidVirtualTarget=class{name;androidApiLevel;constructor(e,t){this.name=e,this.androidApiLevel=t}canConnectWithoutContention(){return Promise.resolve(!0)}canCreateTracingSession(){return!1}createTracingSession(e){throw new t.RecordingError("Can not create tracing session for a virtual target")}disconnect(e){throw new t.RecordingError("Can not disconnect from a virtual target")}fetchTargetInfo(e){return Promise.resolve()}getInfo(){return{name:this.name,androidApiLevel:this.androidApiLevel,targetType:"ANDROID",dataSources:[]}}}}return gE}();class n{kind="VirtualTargetFactory";targets;constructor(){this.targets=[],this.targets.push(new r.AndroidVirtualTarget("Android Q",29)),this.targets.push(new r.AndroidVirtualTarget("Android P",28)),this.targets.push(new r.AndroidVirtualTarget("Android O-",27))}connectNewTarget(){throw new t.RecordingError("Can not create a new virtual target.All virtual targets are created at factory initialisation.")}getName(){return"Virtual"}listRecordingProblems(){return[]}listTargets(){return this.targets}setOnTargetChange(e){}}hE.VirtualTargetFactory=n,e.targetFactoryRegistry.register(new n)}}var _E,yE={},TE={};function bE(){if(!_E){_E=1,Object.defineProperty(TE,"__esModule",{value:!0}),TE.Controller=void 0,TE.Child=function(e,t,r){return{id:e,factory:t,args:r}};TE.Controller=class{_stateChanged=!1;_inRunner=!1;_state;_children=new Map;constructor(e){this._state=e}onDestroy(){}invoke(){if(this._inRunner)throw new Error("Reentrancy in Controller");this._stateChanged=!1,this._inRunner=!0;var e=this.run();let t=this._stateChanged;this._stateChanged=!1;var r=new Map;if(void 0!==e)for(const s of e){if(r.has(s.id))throw new Error("Duplicate children controller "+s.id);r.set(s.id,s)}var n,a=new Array,i=new Array;for(const l of this._children.keys())if(!r.has(l)){const c=this._children.get(l);this._children.delete(l),a.push(()=>c.onDestroy())}for(const u of r.values()){this._children.has(u.id)||(n=new u.factory(u.args),this._children.set(u.id,n));const d=this._children.get(u.id);i.push(()=>d.invoke())}for(const f of a)f();for(const p of i){var o=p();t=t||o}return this._inRunner=!1,t}setState(e){if(!this._inRunner)throw new Error("Cannot setState() outside of the run() method");this._stateChanged=e!==this._state,this._state=e}get state(){return this._state}}}return TE}var vE,EE={},SE={};function AE(){if(!vE){vE=1,Object.defineProperty(SE,"__esModule",{value:!0}),SE.RecordingConfigUtils=void 0,SE.genTraceConfig=r;const c=te(),n=J(),D=z(),x=Sa();var I=x.PerfEvents.PerfClock,M=x.PerfEvents.Timebase,P=x.PerfEventConfig.CallstackSampling,N=x.PerfEventConfig.Scope;function r(t,r){var n="ANDROID"===r.targetType,a="LINUX"===r.targetType,i=n?r.androidApiLevel:void 0,o=new x.TraceConfig,s=(o.durationMs=t.durationMs,128*t.bufferSizeMb),s=Math.min(s,2048),l=(s=Math.max(s,256),1024*t.bufferSizeMb-s),c=(o.buffers.push(new x.BufferConfig),o.buffers.push(new x.BufferConfig),o.buffers[0].sizeKb=l,o.buffers[1].sizeKb=s,"STOP_WHEN_FULL"===t.mode?(o.buffers[0].fillPolicy=x.BufferConfig.FillPolicy.DISCARD,o.buffers[1].fillPolicy=x.BufferConfig.FillPolicy.DISCARD):(o.buffers[0].fillPolicy=x.BufferConfig.FillPolicy.RING_BUFFER,o.buffers[1].fillPolicy=x.BufferConfig.FillPolicy.RING_BUFFER,o.flushPeriodMs=3e4,"LONG_TRACE"===t.mode&&(o.writeIntoFile=!0,o.fileWritePeriodMs=t.fileWritePeriodMs,o.maxFileSizeBytes=1e6*t.maxFileSizeMb),(l=new x.TraceConfig.IncrementalStateConfig).clearPeriodMs=5e3,o.incrementalStateConfig=l),new Set(t.ftrace?t.ftraceEvents:[])),s=new Set(t.atrace?t.atraceCats:[]),u=new Set;const d=new Set;t.chromeCategoriesSelected.forEach(e=>d.add(e)),t.chromeHighOverheadCategoriesSelected.forEach(e=>d.add(e));let e=!1,f=!1,p=!1,h=(n&&((l=new x.TraceConfig.DataSource).config=new x.DataSourceConfig,l.config.targetBuffer=1,l.config.name="android.packages_list",o.dataSources.push(l)),(n||a)&&((l=new x.TraceConfig.DataSource).config=new x.DataSourceConfig,l.config.targetBuffer=1,l.config.name="linux.system_info",o.dataSources.push(l)),!1),g=!1,m=(t.cpuSched&&(e=!0,f=!0,h=!0,void 0!==(n=i)&&31<=n&&(g=!0),c.add("sched/sched_switch"),c.add("power/suspend_resume"),c.add("sched/sched_wakeup"),c.add("sched/sched_wakeup_new"),c.add("sched/sched_waking"),c.add("power/suspend_resume")),void 0),_=(t.cpuFreq&&(c.add("power/cpu_frequency"),c.add("power/cpu_idle"),c.add("power/suspend_resume"),(m=new x.SysStatsConfig).cpufreqPeriodMs=t.cpuFreqPollMs),t.gpuFreq&&c.add("power/gpu_frequency"),t.gpuMemTotal&&(c.add("gpu_mem/gpu_mem_total"),"CHROME"!==r.targetType)&&((a=new x.TraceConfig.DataSource).config=new x.DataSourceConfig,a.config.name="android.gpu.memory",o.dataSources.push(a)),t.gpuWorkPeriod&&c.add("power/gpu_work_period"),t.cpuSyscall&&(c.add("raw_syscalls/sys_enter"),c.add("raw_syscalls/sys_exit")),t.batteryDrain&&((l=new x.TraceConfig.DataSource).config=new x.DataSourceConfig,"CHROME_OS"===r.targetType||"LINUX"===r.targetType?l.config.name="linux.sysfs_power":(l.config.name="android.power",l.config.androidPowerConfig=new x.AndroidPowerConfig,l.config.androidPowerConfig.batteryPollMs=t.batteryDrainPollMs,l.config.androidPowerConfig.batteryCounters=[x.AndroidPowerConfig.BatteryCounters.BATTERY_COUNTER_CAPACITY_PERCENT,x.AndroidPowerConfig.BatteryCounters.BATTERY_COUNTER_CHARGE,x.AndroidPowerConfig.BatteryCounters.BATTERY_COUNTER_CURRENT],l.config.androidPowerConfig.collectPowerRails=!0),"CHROME"!==r.targetType)&&o.dataSources.push(l),t.boardSensors&&(c.add("regulator/regulator_set_voltage"),c.add("regulator/regulator_set_voltage_complete"),c.add("power/clock_enable"),c.add("power/clock_disable"),c.add("power/clock_set_rate"),c.add("power/suspend_resume")),t.cpuCoarse&&((m=void 0===m?new x.SysStatsConfig:m).statPeriodMs=t.cpuCoarsePollMs,m.statCounters=[x.SysStatsConfig.StatCounters.STAT_CPU_TIMES,x.SysStatsConfig.StatCounters.STAT_FORK_COUNT]),t.memHiFreq&&(e=!0,f=!0,c.add("mm_event/mm_event_record"),c.add("kmem/rss_stat"),c.add("ion/ion_stat"),c.add("dmabuf_heap/dma_heap_stat"),c.add("kmem/ion_heap_grow"),c.add("kmem/ion_heap_shrink")),f&&(c.add("sched/sched_process_exit"),c.add("sched/sched_process_free"),c.add("task/task_newtask"),c.add("task/task_rename")),t.linuxDeviceRpm&&c.add("rpm/rpm_status"),t.meminfo&&((m=void 0===m?new x.SysStatsConfig:m).meminfoPeriodMs=t.meminfoPeriodMs,m.meminfoCounters=t.meminfoCounters.map(e=>x.MeminfoCounters[e])),t.vmstat&&((m=void 0===m?new x.SysStatsConfig:m).vmstatPeriodMs=t.vmstatPeriodMs,m.vmstatCounters=t.vmstatCounters.map(e=>x.VmstatCounters[e])),t.memLmk&&(c.add("lowmemorykiller/lowmemory_kill"),u.add("lmkd"),c.add("oom/oom_score_adj_update"),e=!0,p=!0),void 0);if(t.heapProfiling){var y=new x.HeapprofdConfig;y.samplingIntervalBytes=t.hpSamplingIntervalBytes,8192<=t.hpSharedMemoryBuffer&&t.hpSharedMemoryBuffer%4096==0&&(y.shmemSizeBytes=t.hpSharedMemoryBuffer);for(const A of t.hpProcesses.split("\n"))""!==A&&(isNaN(+A)?y.processCmdline.push(A):y.pid.push(+A));0<t.hpContinuousDumpsInterval&&((n=y.continuousDumpConfig=new x.NativeContinuousDumpConfig).dumpIntervalMs=t.hpContinuousDumpsInterval,0<t.hpContinuousDumpsPhase)&&(n.dumpPhaseMs=t.hpContinuousDumpsPhase),y.blockClient=t.hpBlockClient,t.hpAllHeaps&&(y.allHeaps=!0),_=y}let T=void 0;if(t.javaHeapDump){var b=new x.JavaHprofConfig;for(const O of t.jpProcesses.split("\n"))""!==O&&(isNaN(+O)?b.processCmdline.push(O):b.pid.push(+O));0<t.jpContinuousDumpsInterval&&((a=b.continuousDumpConfig=new x.JavaContinuousDumpConfig).dumpIntervalMs=t.jpContinuousDumpsInterval,0<t.hpContinuousDumpsPhase)&&(a.dumpPhaseMs=t.jpContinuousDumpsPhase),T=b}function v(e){d.add(e),d.add("disabled-by-default-"+e)}if((t.procStats||e||p)&&((l=new x.TraceConfig.DataSource).config=new x.DataSourceConfig,l.config.targetBuffer=1,l.config.name="linux.process_stats",l.config.processStatsConfig=new x.ProcessStatsConfig,t.procStats&&(l.config.processStatsConfig.procStatsPollMs=t.procStatsPeriodMs),(e||p)&&(l.config.processStatsConfig.scanAllProcessesOnStart=!0),"CHROME"!==r.targetType)&&o.dataSources.push(l),t.androidLogs&&((n=new x.TraceConfig.DataSource).config=new x.DataSourceConfig,n.config.name="android.log",n.config.androidLogConfig=new x.AndroidLogConfig,n.config.androidLogConfig.logIds=t.androidLogBuffers.map(e=>x.AndroidLogId[e]),"CHROME"!==r.targetType)&&o.dataSources.push(n),t.androidFrameTimeline&&((a=new x.TraceConfig.DataSource).config=new x.DataSourceConfig,a.config.name="android.surfaceflinger.frametimeline","CHROME"!==r.targetType)&&o.dataSources.push(a),t.androidGameInterventionList&&((l=new x.TraceConfig.DataSource).config=new x.DataSourceConfig,l.config.name="android.game_interventions","CHROME"!==r.targetType)&&o.dataSources.push(l),t.androidNetworkTracing&&"CHROME"!==r.targetType&&((n=new x.TraceConfig.DataSource).config=new x.DataSourceConfig,n.config.name="android.network_packets",n.config.networkPacketTraceConfig=new x.NetworkPacketTraceConfig,n.config.networkPacketTraceConfig.pollMs=t.androidNetworkTracingPollMs,o.dataSources.push(n),(a=new x.TraceConfig.DataSource).config=new x.DataSourceConfig,a.config.name="android.packages_list",o.dataSources.push(a)),t.chromeLogs&&d.add("log"),t.taskScheduling&&(d.add("toplevel"),d.add("toplevel.flow"),d.add("scheduler"),d.add("sequence_manager"),d.add("disabled-by-default-toplevel.flow")),t.ipcFlows&&(d.add("toplevel"),d.add("toplevel.flow"),d.add("disabled-by-default-ipc.flow"),d.add("mojom")),t.jsExecution&&(d.add("toplevel"),d.add("v8")),t.webContentRendering&&(d.add("toplevel"),d.add("blink"),d.add("cc"),d.add("gpu")),t.uiRendering&&(d.add("toplevel"),d.add("cc"),d.add("gpu"),d.add("viz"),d.add("ui"),d.add("views")),t.inputEvents&&(d.add("toplevel"),d.add("benchmark"),d.add("evdev"),d.add("input"),d.add("disabled-by-default-toplevel.flow")),t.navigationAndLoading&&(d.add("loading"),d.add("net"),d.add("netlog"),d.add("navigation"),d.add("browser")),t.audio&&(v("audio"),v("webaudio"),v("webaudio.audionode"),v("webrtc"),v("audio-worklet"),v("mediastream"),v("v8.gc"),v("toplevel"),v("toplevel.flow"),v("wakeup.flow"),v("cpu_profiler"),v("scheduler"),v("p2p"),v("net"),d.add("base")),t.video&&(d.add("base"),d.add("gpu"),d.add("gpu.capture"),d.add("media"),d.add("toplevel"),d.add("toplevel.flow"),d.add("scheduler"),d.add("wakeup.flow"),d.add("webrtc"),d.add("disabled-by-default-video_and_image_capture"),d.add("disabled-by-default-webrtc")),t.tracePerf){var l=new x.TraceConfig.DataSource,n=(l.config=new x.DataSourceConfig,l.config.name="linux.perf",new x.PerfEventConfig),a=(n.timebase=new M,n.timebase.frequency=t.timebaseFrequency,n.timebase.timestampClock=I.PERF_CLOCK_BOOTTIME,new P);if(0<t.targetCmdLine.length){var E=new N;for(const C of t.targetCmdLine)""!=C&&E.targetCmdline?.push(C.trim());a.scope=E}n.callstackSampling=a,l.config.perfEventConfig=n,o.dataSources.push(l)}if(0!==d.size){let e;var a={record_mode:e="STOP_WHEN_FULL"===t.mode?"record-until-full":"record-continuously",included_categories:[...d.values()],excluded_categories:["*"],memory_dump_config:{}},n=(d.has("disabled-by-default-memory-infra")&&(a.memory_dump_config={allowed_dump_modes:["background","light","detailed"],triggers:[{min_time_between_dumps_ms:1e4,mode:"detailed",type:"periodic_interval"}]}),new x.ChromeConfig),l=(n.clientPriority=x.ChromeConfig.ClientPriority.USER_INITIATED,n.privacyFilteringEnabled=t.chromePrivacyFiltering,n.traceConfig=JSON.stringify(a),new x.TraceConfig.DataSource),a=(l.config=new x.DataSourceConfig,l.config.name="org.chromium.trace_event",l.config.chromeConfig=n,o.dataSources.push(l),new x.TraceConfig.DataSource),l=(a.config=new x.DataSourceConfig,a.config.name="track_event",a.config.chromeConfig=n,a.config.trackEventConfig=new x.TrackEventConfig,a.config.trackEventConfig.disabledCategories=["*"],a.config.trackEventConfig.enabledCategories=[...d.values(),"__metadata"],a.config.trackEventConfig.enableThreadTimeSampling=!0,a.config.trackEventConfig.timestampUnitMultiplier=1e3,a.config.trackEventConfig.filterDynamicEventNames=t.chromePrivacyFiltering,a.config.trackEventConfig.filterDebugAnnotations=t.chromePrivacyFiltering,o.dataSources.push(a),new x.TraceConfig.DataSource);l.config=new x.DataSourceConfig,l.config.name="org.chromium.trace_metadata",l.config.chromeConfig=n,o.dataSources.push(l),d.has("disabled-by-default-memory-infra")&&((a=new x.TraceConfig.DataSource).config=new x.DataSourceConfig,a.config.name="org.chromium.memory_instrumentation",a.config.chromeConfig=n,o.dataSources.push(a),(l=new x.TraceConfig.DataSource).config=new x.DataSourceConfig,l.config.name="org.chromium.native_heap_profiler",l.config.chromeConfig=n,o.dataSources.push(l)),(d.has("disabled-by-default-cpu_profiler")||d.has("disabled-by-default-cpu_profiler.debug"))&&((a=new x.TraceConfig.DataSource).config=new x.DataSourceConfig,a.config.name="org.chromium.sampler_profiler",a.config.chromeConfig=n,o.dataSources.push(a))}if("WINDOWS"!==r.targetType&&"CHROME"!==r.targetType&&(void 0!==m&&((l=new x.TraceConfig.DataSource).config=new x.DataSourceConfig,l.config.name="linux.sys_stats",l.config.sysStatsConfig=m,o.dataSources.push(l)),void 0!==_&&((n=new x.TraceConfig.DataSource).config=new x.DataSourceConfig,n.config.targetBuffer=0,n.config.name="android.heapprofd",n.config.heapprofdConfig=_,o.dataSources.push(n)),void 0!==T)&&((a=new x.TraceConfig.DataSource).config=new x.DataSourceConfig,a.config.targetBuffer=0,a.config.name="android.java_hprof",a.config.javaHprofConfig=T,o.dataSources.push(a)),t.ftrace||h||t.atrace||0<c.size||0<s.size||0<u.size){l=new x.TraceConfig.DataSource;if(l.config=new x.DataSourceConfig,l.config.name="linux.ftrace",l.config.ftraceConfig=new x.FtraceConfig,t.ftrace||h){t.ftraceBufferSizeKb&&(l.config.ftraceConfig.bufferSizeKb=t.ftraceBufferSizeKb),t.ftraceDrainPeriodMs&&(l.config.ftraceConfig.drainPeriodMs=t.ftraceDrainPeriodMs),(t.symbolizeKsyms||g)&&(l.config.ftraceConfig.symbolizeKsyms=!0,c.add("sched/sched_blocked_reason"));for(const k of t.ftraceExtraEvents.split("\n"))0<k.trim().length&&c.add(k.trim())}if(t.atrace)if(t.allAtraceApps)u.clear(),u.add("*");else for(const w of t.atraceApps.split("\n"))0<w.trim().length&&u.add(w.trim());(0<s.size||0<u.size)&&c.add("ftrace/print");let e=[];if((0,D.exists)(i)&&28===i)for(const R of c){var S=R.split("/");2!==S.length?e.push(R):"*"!==S[1]&&e.push(S[1])}else e=Array.from(c);l.config.ftraceConfig.ftraceEvents=e,l.config.ftraceConfig.atraceCategories=Array.from(s),l.config.ftraceConfig.atraceApps=Array.from(u),void 0!==(n=i)&&31<=n&&((a=new x.FtraceConfig.CompactSchedConfig).enabled=!0,l.config.ftraceConfig.compactSched=a),"CHROME"!==r.targetType&&o.dataSources.push(l)}return("WINDOWS"===r.targetType||t.etwCSwitch||t.etwThreadState)&&((s=new x.TraceConfig.DataSource).config=new x.DataSourceConfig,s.config.name="org.chromium.etw_system",s.config.etwConfig=new x.EtwConfig,i=[],t.etwCSwitch&&i.push(x.EtwConfig.KernelFlag.CSWITCH),t.etwThreadState&&i.push(x.EtwConfig.KernelFlag.DISPATCHER),s.config.etwConfig.kernelFlags=i,o.dataSources.push(s)),o}SE.RecordingConfigUtils=class{lastConfig;lastTargetInfo;configProtoText;configProtoBase64;hasDataSources=!1;fetchLatestRecordCommand(e,t){return e===this.lastConfig&&t===this.lastTargetInfo||(e=r(this.lastConfig=e,this.lastTargetInfo=t),t=x.TraceConfig.encode(e).finish(),this.configProtoText=function(e){e=x.TraceConfig.decode(e),e=e.toJSON();return[...function*e(t,r){for(const[o,s]of Object.entries(t)){var n=Array.isArray(s),a="object"==typeof s&&!n;for(const l of n?s:[s]){if(yield" ".repeat(r)+(o.replace(/[A-Z]/g,e=>"_"+e.toLowerCase())+(a?"":":"))+" ",(0,c.isString)(l))(i=l).startsWith("MEMINFO_")||i.startsWith("VMSTAT_")||i.startsWith("STAT_")||i.startsWith("LID_")||i.startsWith("BATTERY_COUNTER_")||"DISCARD"===i||"RING_BUFFER"===i||i.startsWith("PERF_CLOCK_")||["maxFileSizeBytes","samplingIntervalBytes","shmemSizeBytes","pid","frequency"].includes(o)?yield l:yield`"${l.replace(new RegExp('"',"g"),'\\"')}"`;else if("number"==typeof l)yield l.toString();else if("boolean"==typeof l)yield l.toString();else{if("object"!=typeof l||null===l)throw new Error(`Record proto entry "${l}" with unexpected type `+typeof l);yield"{\n",yield*e(l,r+4),yield" ".repeat(r)+"}"}yield"\n"}}var i}(e,0)].join("")}(t),this.configProtoBase64=(0,n.base64Encode)(t),this.hasDataSources=0<e.dataSources.length),{configProtoText:this.configProtoText,configProtoBase64:this.configProtoBase64,hasDataSources:this.hasDataSources}}}}return SE}var OE,CE={};function kE(){if(!OE){OE=1;{var r=CE;Object.defineProperty(r,"__esModule",{value:!0}),r.AdbMsgImpl=r.AdbStreamImpl=r.AdbOverWebUsb=r.AdbState=r.DEFAULT_MAX_PAYLOAD_BYTES=r.VERSION_NO_CHECKSUM=r.VERSION_WITH_CHECKSUM=void 0;const t=ee(),s=te(),l=J();var n,a,i,e;r.VERSION_WITH_CHECKSUM=16777216,r.VERSION_NO_CHECKSUM=16777217,r.DEFAULT_MAX_PAYLOAD_BYTES=262144,(e=n||(r.AdbState=n={}))[e.DISCONNECTED=0]="DISCONNECTED",e[e.AUTH_STEP1=1]="AUTH_STEP1",e[e.AUTH_STEP2=2]="AUTH_STEP2",e[e.AUTH_STEP3=3]="AUTH_STEP3",e[e.CONNECTED=2]="CONNECTED",(e=a=a||{})[e.TOKEN=1]="TOKEN",e[e.SIGNATURE=2]="SIGNATURE",e[e.RSAPUBLICKEY=3]="RSAPUBLICKEY";const c="Device not set.";class u{state=n.DISCONNECTED;streams=new Map;devProps="";maxPayload=r.DEFAULT_MAX_PAYLOAD_BYTES;key;onConnected=()=>{};useChecksum=!0;lastStreamId=0;dev;usbInterfaceNumber;usbReadEndpoint=-1;usbWriteEpEndpoint=-1;filter={classCode:255,subclassCode:66,protocolCode:1};async findDevice(){if("usb"in navigator)return navigator.usb.requestDevice({filters:[this.filter]});throw new Error("WebUSB not supported by the browser (requires HTTPS)")}async getPairedDevices(){try{return await navigator.usb.getDevices()}catch(e){return Promise.resolve([])}}async connect(e){if(this.state===n.CONNECTED){if(this.dev===e&&e.opened)return this.onConnected(),void(this.onConnected=()=>{});await this.disconnect()}this.dev=e,this.useChecksum=!0,this.key=await u.initKey(),await this.dev.open();var{configValue:e,usbInterfaceNumber:t,endpoints:r}=this.findInterfaceAndEndpoint();return this.usbInterfaceNumber=t,this.usbReadEndpoint=this.findEndpointNumber(r,"in"),this.usbWriteEpEndpoint=this.findEndpointNumber(r,"out"),console.assert(0<=this.usbReadEndpoint&&0<=this.usbWriteEpEndpoint),await this.dev.selectConfiguration(e),await this.dev.claimInterface(t),await this.startAuthentication(),this.receiveDeviceMessages(),new Promise((e,t)=>this.onConnected=e)}async disconnect(){this.state!==n.DISCONNECTED&&(this.state=n.DISCONNECTED,this.dev)&&(new Map(this.streams).forEach((e,t)=>e.setClosed()),console.assert(0===this.streams.size),await this.dev.releaseInterface((0,t.assertExists)(this.usbInterfaceNumber)),this.dev=void 0,this.usbInterfaceNumber=void 0)}async startAuthentication(){var e=this.useChecksum?r.VERSION_WITH_CHECKSUM:r.VERSION_NO_CHECKSUM;this.state=n.AUTH_STEP1,await this.send("CNXN",e,this.maxPayload,"host:1:UsbADB")}findInterfaceAndEndpoint(){if(!this.dev)throw Error(c);for(const e of this.dev.configurations)for(const t of e.interfaces)for(const r of t.alternates)if(r.interfaceClass===this.filter.classCode&&r.interfaceSubclass===this.filter.subclassCode&&r.interfaceProtocol===this.filter.protocolCode)return{configValue:e.configurationValue,usbInterfaceNumber:t.interfaceNumber,endpoints:r.endpoints};throw Error("Cannot find interfaces and endpoints")}findEndpointNumber(e,t,r="bulk"){e=e.find(e=>e.type===r&&e.direction===t);if(e)return e.endpointNumber;throw Error(`Cannot find ${t} endpoint`)}receiveDeviceMessages(){this.recv().then(e=>{this.onMessage(e),this.receiveDeviceMessages()}).catch(e=>{e.message!==c&&console.error(`Exception in recv: ${e.name}. error: `+e.message),this.disconnect()})}async onMessage(e){if(!this.key)throw Error("ADB key not initialized");var t;"AUTH"===e.cmd&&e.arg0===a.TOKEN?this.handleAuthentication(e):"CNXN"===e.cmd?(console.assert([n.AUTH_STEP2,n.AUTH_STEP3].includes(this.state)),this.state=n.CONNECTED,this.handleConnectedMessage(e)):this.state===n.CONNECTED&&0<=["OKAY","WRTE","CLSE"].indexOf(e.cmd)?(t=this.streams.get(e.arg1))?t.onMessage(e):console.warn(`Received message ${e} for unknown stream `+e.arg1):console.error("Unexpected message ",e," in state "+this.state)}async handleAuthentication(e){if(!this.key)throw Error("ADB key not initialized");console.assert("AUTH"===e.cmd&&e.arg0===a.TOKEN);var e=e.data;this.state===n.AUTH_STEP1?(this.state=n.AUTH_STEP2,this.key.privateKey,e=await e.buffer,this.send("AUTH",a.SIGNATURE,0,new Uint8Array(e))):(console.assert(this.state===n.AUTH_STEP2),this.state=n.AUTH_STEP3,e=await async function(e){var e=await crypto.subtle.exportKey("jwk",e),t=o(e.n).reverse(),r=o(e.e).reverse(),e=new Uint8Array(12+2*h),n=new DataView(e.buffer);n.setUint32(0,h/4,!0),n.setUint32(4,0,!0);for(let e=0;e<h;e++)n.setUint8(8+e,t[e]);for(let e=0;e<h;e++)n.setUint8(8+h+e,0);for(let e=0;e<4;e++)n.setUint8(8+2*h+e,r[e]);return btoa(String.fromCharCode(...new Uint8Array(n.buffer)))+" perfetto@webusb"}(this.key.publicKey),this.send("AUTH",a.RSAPUBLICKEY,0,e))}handleConnectedMessage(e){console.assert("CNXN"===e.cmd),this.maxPayload=e.arg1,this.devProps=(0,l.utf8Decode)(e.data);var t=e.arg0;[r.VERSION_WITH_CHECKSUM,r.VERSION_NO_CHECKSUM].includes(t)||console.error("Version ",e.arg0," not really supported!"),this.useChecksum=t===r.VERSION_WITH_CHECKSUM,this.state=n.CONNECTED,this.onConnected(),this.onConnected=()=>{}}shell(e){return this.openStream("shell:"+e)}socket(e){return this.openStream("localfilesystem:"+e)}openStream(r){const n=new d(this,++this.lastStreamId);return this.streams.set(n.localStreamId,n),this.send("OPEN",n.localStreamId,0,r),new Promise((e,t)=>{n.onConnect=()=>{n.onClose=()=>{},e(n)},n.onClose=()=>t(new Error("Failed to openStream svc="+r))})}async shellOutputAsString(e){const n=await this.shell(e);return new Promise((e,t)=>{const r=[];n.onData=e=>r.push((0,l.utf8Decode)(e)),n.onClose=()=>e(r.join())})}async send(e,t,r,n){await this.sendMsg(p.create({cmd:e,arg0:t,arg1:r,data:n,useChecksum:this.useChecksum}))}async sendMsg(e){var t=[this.sendRaw(e.encodeHeader())];0<e.data.length&&t.push(this.sendRaw(e.data)),await Promise.all(t)}async recv(){var e,t=await this.recvRaw(f),t=(console.assert("ok"===t.status),p.decodeHeader(t.data));return 0<t.dataLen&&(e=await this.recvRaw(t.dataLen),t.data=new Uint8Array(e.data.buffer,e.data.byteOffset,e.data.byteLength)),this.useChecksum&&console.assert(u.checksum(t.data)===t.dataChecksum),t}static async initKey(){var e={name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-1"}};return await crypto.subtle.generateKey(e,!0,["sign","verify"])}static checksum(t){let r=0;for(let e=0;e<t.byteLength;e++)r+=t[e];return 4294967295&r}sendRaw(e){if(console.assert(e.length<=this.maxPayload),this.dev)return this.dev.transferOut(this.usbWriteEpEndpoint,e.buffer);throw Error(c)}recvRaw(e){if(this.dev)return this.dev.transferIn(this.usbReadEndpoint,e);throw Error(c)}}r.AdbOverWebUsb=u,(e=i=i||{})[e.WAITING_INITIAL_OKAY=0]="WAITING_INITIAL_OKAY",e[e.CONNECTED=1]="CONNECTED",e[e.CLOSED=2]="CLOSED";class d{adb;localStreamId;remoteStreamId=-1;state=i.WAITING_INITIAL_OKAY;writeQueue=[];sendInProgress=!1;onData=e=>{};onConnect=()=>{};onClose=()=>{};constructor(e,t){this.adb=e,this.localStreamId=t}close(){console.assert(this.state===i.CONNECTED),0<this.writeQueue.length&&(console.error(`Dropping ${this.writeQueue.length} queued messages due to stream closing.`),this.writeQueue=[]),this.adb.send("CLSE",this.localStreamId,this.remoteStreamId)}async write(e){e=(0,s.isString)(e)?(0,l.utf8Encode)(e):e;this.sendInProgress||this.state===i.WAITING_INITIAL_OKAY?this.writeQueue.push(e):(console.assert(this.state===i.CONNECTED),this.sendInProgress=!0,await this.adb.send("WRTE",this.localStreamId,this.remoteStreamId,e))}setClosed(){this.state=i.CLOSED,this.adb.streams.delete(this.localStreamId),this.onClose()}onMessage(e){var t;console.assert(e.arg1===this.localStreamId),this.state===i.WAITING_INITIAL_OKAY&&"OKAY"===e.cmd?(this.remoteStreamId=e.arg0,this.state=i.CONNECTED,this.onConnect()):"WRTE"===e.cmd?(this.adb.send("OKAY",this.localStreamId,this.remoteStreamId),this.onData(e.data)):"OKAY"===e.cmd?(console.assert(this.sendInProgress),this.sendInProgress=!1,void 0!==(t=this.writeQueue.shift())&&this.write(t)):"CLSE"===e.cmd?this.setClosed():console.error(`Unexpected stream msg ${e.toString()} in state `+this.state)}}r.AdbStreamImpl=d;const f=24;class p{cmd;arg0;arg1;data;dataLen;dataChecksum;useChecksum;constructor(e,t,r,n,a,i=!1){console.assert(4===e.length),this.cmd=e,this.arg0=t,this.arg1=r,this.dataLen=n,this.data=new Uint8Array(n),this.dataChecksum=a,this.useChecksum=i}static create({cmd:e,arg0:t,arg1:r,data:n,useChecksum:a=!0}){n=this.encodeData(n),e=new p(e,t,r,n.length,0,a);return e.data=n,e}get dataStr(){return(0,l.utf8Decode)(this.data)}toString(){return`${this.cmd} [${this.arg0},${this.arg1}] `+this.dataStr}static decodeHeader(e){console.assert(e.byteLength===f);var t=(0,l.utf8Decode)(e.buffer.slice(0,4)),r=e.getUint32(0,!0),n=e.getUint32(4,!0),a=e.getUint32(8,!0),i=e.getUint32(12,!0),o=e.getUint32(16,!0),e=e.getUint32(20,!0);return console.assert(r===(4294967295^e)),new p(t,n,a,i,o)}encodeHeader(){var e=new Uint8Array(f),t=new DataView(e.buffer),r=(0,l.utf8Encode)(this.cmd),n=p.encodeData(this.data),a=this.useChecksum?u.checksum(n):0;for(let e=0;e<4;e++)t.setUint8(e,r[e]);return t.setUint32(4,this.arg0,!0),t.setUint32(8,this.arg1,!0),t.setUint32(12,n.byteLength,!0),t.setUint32(16,a,!0),t.setUint32(20,4294967295^t.getUint32(0,!0),!0),e}static encodeData(e){return void 0===e?new Uint8Array([]):(0,s.isString)(e)?(0,l.utf8Encode)(e+"\0"):e}}function o(e){return[...atob(e.replaceAll("-","+").replaceAll("_","/"))].map(e=>e.charCodeAt(0))}r.AdbMsgImpl=p;const h=256}}return CE}var wE,RE,IE={},ME={};function PE(){if(!wE){wE=1,Object.defineProperty(ME,"__esModule",{value:!0}),ME.AdbBaseConsumerPort=ME.AdbConnectionState=void 0;const r=z(),i=Y(),n=qb(),o=oe();var a,e,t=Xv();(e=a||(ME.AdbConnectionState=a={}))[e.READY_TO_CONNECT=0]="READY_TO_CONNECT",e[e.AUTH_IN_PROGRESS=1]="AUTH_IN_PROGRESS",e[e.CONNECTED=2]="CONNECTED",e[e.CLOSED=3]="CLOSED";class s extends t.RpcConsumerPort{commandQueue=[];adb;state=a.READY_TO_CONNECT;device;constructor(e,t){super(t),this.adb=e}async handleCommand(e,t){try{if("FreeBuffers"===e?(this.state=a.CLOSED,await this.adb.disconnect()):"EnableTracing"===e&&(this.state=a.READY_TO_CONNECT),this.state!==a.CLOSED){if(this.commandQueue.push({method:e,params:t}),this.state===a.READY_TO_CONNECT||this.deviceDisconnected()){var r;if(this.state=a.AUTH_IN_PROGRESS,this.device=await this.findDevice(),!this.device)throw this.state=a.READY_TO_CONNECT,r=o.globals.state.recordingTarget,Error(`Device with serial ${(0,i.isAdbTarget)(r)?r.serial:"n/a"} not found.`);if(this.sendStatus(`Please allow USB debugging on device.
          If you press cancel, reload the page.`),await this.adb.connect(this.device),!o.globals.state.recordingInProgress||this.deviceDisconnected())throw Error("Recording not in progress after adb authorization.");this.state=a.CONNECTED,this.sendStatus("Device connected.")}if(this.state!==a.AUTH_IN_PROGRESS){console.assert(this.state===a.CONNECTED);for(const n of this.commandQueue)this.invoke(n.method,n.params);this.commandQueue=[]}}}catch(e){this.commandQueue=[],this.state=a.READY_TO_CONNECT,this.sendErrorMessage(e.message)}}deviceDisconnected(){return!this.device||!this.device.opened}setDurationStatus(e){var e=(0,n.extractTraceConfig)(e);e&&(e=(0,n.extractDurationFromTraceConfig)(e),this.sendStatus(`Recording in progress${(0,r.exists)(e)?" for "+e.toString()+" ms":""}...`))}generateChunkReadResponse(e,t=!1){return{type:"ReadBuffersResponse",slices:[{data:e,lastSliceForPacket:t}]}}async findDevice(){if("usb"in navigator){const t=o.globals.state.recordingTarget;if((0,i.isAdbTarget)(t))return(await navigator.usb.getDevices()).find(e=>e.serialNumber===t.serial)}}}ME.AdbBaseConsumerPort=s}return ME}var NE,DE,xE={};function LE(){if(!DE){DE=1,Object.defineProperty(EE,"__esModule",{value:!0}),EE.RecordController=void 0,EE.genConfigProto=a,EE.toPbtxt=o;const c=te(),s=J(),l=ne();var e=$y();const u=AE(),d=Y(),f=oe(),p=CT(),r=Sa();var t=kE();const h=function(){if(!RE){RE=1,Object.defineProperty(IE,"__esModule",{value:!0}),IE.AdbConsumerPort=void 0;const n=J(),a=qb(),i=PE();var r,e;(e=r=r||{})[e.READY=0]="READY",e[e.RECORDING=1]="RECORDING",e[e.FETCHING=2]="FETCHING";class t extends i.AdbBaseConsumerPort{traceDestFile="/data/misc/perfetto-traces/trace-by-ui";shellState=r.READY;recordShell;constructor(e,t){super(e,t),this.adb=e}async invoke(e,t){switch(console.assert(this.state===i.AdbConnectionState.CONNECTED),e){case"EnableTracing":this.enableTracing(t);break;case"ReadBuffers":this.readBuffers();break;case"DisableTracing":this.disableTracing();break;case"FreeBuffers":this.freeBuffers();break;case"GetTraceStats":break;default:this.sendErrorMessage("Method not recognized: "+e)}}async enableTracing(e){try{var t=(0,a.extractTraceConfig)(e);t?(await this.startRecording(t),this.setDurationStatus(e)):this.sendErrorMessage("Invalid config.")}catch(e){this.sendErrorMessage(e.message)}}async startRecording(e){this.shellState=r.RECORDING;e=this.generateStartTracingCommand(e);this.recordShell=await this.adb.shell(e);const t=[];this.recordShell.onData=e=>t.push((0,n.utf8Decode)(e)),this.recordShell.onClose=()=>{var e=t.join();this.tracingEndedSuccessfully(e)?(this.sendStatus("Recording ended successfully. Fetching the trace.."),this.sendMessage({type:"EnableTracingResponse"}),this.recordShell=void 0):(this.sendErrorMessage(e),this.shellState=r.READY)}}tracingEndedSuccessfully(e){return!e.includes(" 0 ms")&&e.includes("Wrote ")}async readBuffers(){console.assert(this.shellState===r.RECORDING),this.shellState=r.FETCHING;var e=await this.adb.shell(this.generateReadTraceCommand());e.onData=e=>this.sendMessage(this.generateChunkReadResponse(e)),e.onClose=()=>{this.sendMessage(this.generateChunkReadResponse(new Uint8Array,!0))}}async getPidFromShellAsString(){var e=await this.adb.shellOutputAsString("ps -u shell | grep perfetto"),t=e.split(" ").filter(e=>""!==e);if(t.length<1)throw Error(`Unabled to find perfetto pid in string "${e}"`);return t[1]}async disableTracing(){if(this.recordShell)try{var e=await this.getPidFromShellAsString();if(0===e.length||isNaN(Number(e)))throw Error(`Perfetto pid not found. Impossible to stop/cancel the
     recording. Command output: `+e);var t=await this.adb.shellOutputAsString("kill -SIGINT "+e);if(0!==t.length)throw Error("Unable to kill perfetto: "+t)}catch(e){this.sendErrorMessage(e.message)}}freeBuffers(){this.shellState=r.READY,this.recordShell&&(this.recordShell.close(),this.recordShell=void 0)}generateChunkReadResponse(e,t=!1){return{type:"ReadBuffersResponse",slices:[{data:e,lastSliceForPacket:t}]}}generateReadTraceCommand(){return`gzip -c ${this.traceDestFile} && rm -f `+this.traceDestFile}generateStartTracingCommand(e){return`echo '${(0,n.base64Encode)(e)}' | base64 -d | `+("perfetto -c - -o "+this.traceDestFile)}}IE.AdbConsumerPort=t}return IE}(),g=function(){if(NE)return xE;var a,e;NE=1,Object.defineProperty(xE,"__esModule",{value:!0}),xE.AdbSocketConsumerPort=void 0;const n=or.__importDefault(lr()),i=Sa(),o=PE(),s=$v(),l=z(),c=ee(),r=((e=a=a||{})[e.DISCONNECTED=0]="DISCONNECTED",e[e.BINDING_IN_PROGRESS=1]="BINDING_IN_PROGRESS",e[e.BOUND=2]="BOUND","/dev/socket/traced_consumer");class t extends o.AdbBaseConsumerPort{socketState=a.DISCONNECTED;socket;requestId=1;incomingBuffer=new Uint8Array(131072);incomingBufferLen=0;frameToParseLen=0;availableMethods=[];serviceId=-1;resolveBindingPromise;requestMethods=new Map;partialPacket=[];traceProtoWriter=n.default.Writer.create();socketCommandQueue=[];constructor(e,t){super(e,t)}async invoke(e,t){if(console.assert(this.state===o.AdbConnectionState.CONNECTED),this.socketCommandQueue.push({method:e,params:t}),this.socketState!==a.BINDING_IN_PROGRESS){this.socketState===a.DISCONNECTED&&(this.socketState=a.BINDING_IN_PROGRESS,await this.listenForMessages(),await this.bind(),this.traceProtoWriter=n.default.Writer.create(),this.socketState=a.BOUND),console.assert(this.socketState===a.BOUND);for(const r of this.socketCommandQueue)this.invokeInternal(r.method,r.params);this.socketCommandQueue=[]}}invokeInternal(e,t){console.assert(this.socketState===a.BOUND);var r=this.requestId++,n=this.findMethodId(e);void 0===n?console.error(`Method ${e} not supported by the target`):(n=new i.IPCFrame({requestId:r,msgInvokeMethod:new i.IPCFrame.InvokeMethod({serviceId:this.serviceId,methodId:n,argsProto:t})}),this.requestMethods.set(r,e),this.sendFrame(n),"EnableTracing"===e&&this.setDurationStatus(t))}static generateFrameBufferToSend(e){var t=i.IPCFrame.encode(e).finish(),r=t.length,e=new Uint8Array(4+r),n=new DataView(e.buffer);n.setUint32(0,t.length,!0);for(let e=0;e<r;e++)n.setUint8(4+e,t[e]);return e}async sendFrame(e){console.assert(void 0!==this.socket),this.socket&&(e=t.generateFrameBufferToSend(e),await this.socket.write(e))}async listenForMessages(){this.socket=await this.adb.socket(r),this.socket.onData=e=>this.handleReceivedData(e),this.socket.onClose=()=>{this.socketState=a.DISCONNECTED,this.socketCommandQueue=[]}}parseMessageSize(e){return new DataView(e.buffer,e.byteOffset,e.length).getUint32(0,!0)}parseMessage(e){var t=new ArrayBuffer(e.byteLength),t=new Uint8Array(t),e=(t.set(e),i.IPCFrame.decode(t));this.handleIncomingFrame(e)}incompleteSizeHeader(){return!this.frameToParseLen&&(console.assert(this.incomingBufferLen<4),!0)}canCompleteSizeHeader(e){return 4<e.length+this.incomingBufferLen}canParseFullMessage(e){return this.frameToParseLen&&this.incomingBufferLen+e.length>=this.frameToParseLen}appendToIncomingBuffer(e){this.incomingBuffer.set(e,this.incomingBufferLen),this.incomingBufferLen+=e.length}handleReceivedData(e){var t,r;for(this.incompleteSizeHeader()&&this.canCompleteSizeHeader(e)&&(t=4-this.incomingBufferLen,this.appendToIncomingBuffer(e.subarray(0,t)),e=e.subarray(t),this.frameToParseLen=this.parseMessageSize(this.incomingBuffer),this.incomingBufferLen=0);this.canParseFullMessage(e);){if(e=0===this.incomingBufferLen?(this.parseMessage(e.subarray(0,this.frameToParseLen)),e.subarray(this.frameToParseLen)):(r=this.frameToParseLen-this.incomingBufferLen,this.appendToIncomingBuffer(e.subarray(0,r)),this.parseMessage(this.incomingBuffer.subarray(0,this.frameToParseLen)),this.incomingBufferLen=0,e.subarray(r)),this.frameToParseLen=0,!this.canCompleteSizeHeader(e))break;this.frameToParseLen=this.parseMessageSize(e.subarray(0,4)),e=e.subarray(4)}this.appendToIncomingBuffer(e)}decodeResponse(e,t,r=!1){var n,a=this.requestMethods.get(e);a?void 0===(n=u.get(a))?console.error("Unable to decode method: "+a):(a={type:a+"Response",...n(t)},(0,s.isReadBuffersResponse)(a)?(a.slices&&this.handleSlices(a.slices),r||this.sendReadBufferResponse()):this.sendMessage(a)):(console.error("Unknown request id: "+e),this.sendErrorMessage("Wire protocol error."))}handleSlices(e){for(const r of e){var t;this.partialPacket.push(r),r.lastSliceForPacket&&(t=this.generateTracePacket(this.partialPacket),this.traceProtoWriter.uint32(10),this.traceProtoWriter.bytes(t),this.partialPacket=[])}}generateTracePacket(e){let t=0;for(const i of e)t+=i.data.length;var r=new Uint8Array(t);let n=0;for(const o of e){var a=o.data;r.set(a,n),n+=a.length}return r}sendReadBufferResponse(){this.sendMessage(this.generateChunkReadResponse(this.traceProtoWriter.finish(),!0)),this.traceProtoWriter=n.default.Writer.create()}bind(){console.assert(void 0!==this.socket);var e=this.requestId++;const r=new i.IPCFrame({requestId:e,msgBindService:new i.IPCFrame.BindService({serviceName:"ConsumerPort"})});return new Promise((e,t)=>{this.resolveBindingPromise=e,this.sendFrame(r)})}findMethodId(t){return this.availableMethods.find(e=>e.name===t)?.id??void 0}static async hasSocketAccess(e,t){await t.connect(e);try{return(await t.socket(r)).close(),!0}catch(e){return!1}}handleIncomingFrame(e){var t=e.requestId;switch(e.msg){case"msgBindServiceReply":var r=e.msgBindServiceReply;return void((0,l.exists)(r)&&(0,l.exists)(r.methods)&&(0,l.exists)(r.serviceId)&&((0,c.assertTrue)(!0===r.success),this.availableMethods=r.methods,this.serviceId=r.serviceId,this.resolveBindingPromise(),this.resolveBindingPromise=()=>{}));case"msgInvokeMethodReply":r=e.msgInvokeMethodReply;if(r&&r.replyProto){if(!r.success)return void console.error("Unsuccessful method invocation: ",r);this.decodeResponse(t,r.replyProto,!0===r.hasMore)}return;default:console.error("not recognized frame message: "+e.msg)}}}xE.AdbSocketConsumerPort=t;const u=(new Map).set("EnableTracing",i.EnableTracingResponse.decode).set("FreeBuffers",i.FreeBuffersResponse.decode).set("ReadBuffers",i.ReadBuffersResponse.decode).set("DisableTracing",i.DisableTracingResponse.decode).set("GetTraceStats",i.GetTraceStatsResponse.decode);return xE}(),m=eE(),n=$v();class _ extends bE().Controller{config=null;extensionPort;recordingInProgress=!1;consumerPort;traceBuffer=[];bufferUpdateInterval;adb=new t.AdbOverWebUsb;recordedTraceSuffix=e.TRACE_SUFFIX;fetchedCategories=!1;controllerPromises=new Map;constructor(e){super("main"),this.consumerPort=r.ConsumerPort.create(this.rpcImpl.bind(this)),this.extensionPort=e.extensionPort}run(){var e,t,r,n;f.globals.state.fetchChromeCategories&&!this.fetchedCategories&&(this.fetchedCategories=!0,f.globals.state.extensionInstalled&&this.extensionPort.postMessage({method:"GetCategories"}),f.globals.dispatch(l.Actions.setFetchChromeCategories({fetch:!1}))),f.globals.state.recordConfig===this.config&&f.globals.state.recordingInProgress===this.recordingInProgress||(this.config=f.globals.state.recordConfig,e=o(t=a(this.config,f.globals.state.recordingTarget)),r=`
      echo '${t=(0,s.base64Encode)(t)}' |
      base64 --decode |
      adb shell "perfetto -c - -o /data/misc/perfetto-traces/trace" &&
      adb pull /data/misc/perfetto-traces/trace /tmp/trace
    `,n=i(this.config,f.globals.state.recordingTarget),(0,p.publishTrackData)({id:"config",data:{commandline:r,pbBase64:t,pbtxt:e,traceConfig:n}}),f.globals.state.recordingInProgress!==this.recordingInProgress&&(this.recordingInProgress=f.globals.state.recordingInProgress,this.recordingInProgress?this.startRecordTrace(n):this.stopRecordTrace()))}startRecordTrace(e){this.scheduleBufferUpdateRequests(),this.traceBuffer=[],this.consumerPort.enableTracing({traceConfig:e})}stopRecordTrace(){this.bufferUpdateInterval&&clearInterval(this.bufferUpdateInterval),this.consumerPort.disableTracing({})}scheduleBufferUpdateRequests(){this.bufferUpdateInterval&&clearInterval(this.bufferUpdateInterval),this.bufferUpdateInterval=setInterval(()=>{this.consumerPort.getTraceStats({})},200)}readBuffers(){this.consumerPort.readBuffers({})}onConsumerPortResponse(e){var t;void 0!==e&&((0,n.isReadBuffersResponse)(e)?e.slices&&0!==e.slices.length&&(console.assert(1===e.slices.length),e.slices[0].data&&this.traceBuffer.push(e.slices[0].data),e.slices[0].lastSliceForPacket)&&this.onTraceComplete():(0,n.isEnableTracingResponse)(e)?this.readBuffers():(0,n.isGetTraceStatsResponse)(e)?(t=this.getBufferUsagePercentage(e))&&(0,p.publishBufferUsage)({percentage:t}):(0,n.isFreeBuffersResponse)(e)||(0,n.isDisableTracingResponse)(e)||console.error("Unrecognized consumer port response:",e))}onTraceComplete(){var e;this.consumerPort.freeBuffers({}),f.globals.dispatch(l.Actions.setRecordingStatus({status:void 0})),f.globals.state.recordingCancelled?f.globals.dispatch(l.Actions.setLastRecordingError({error:"Recording cancelled."})):(e=this.generateTrace(),f.globals.dispatch(l.Actions.openTraceFromBuffer({title:"Recorded trace",buffer:e.buffer,fileName:"recorded_trace"+this.recordedTraceSuffix}))),this.traceBuffer=[]}generateTrace(){let e=0;for(const n of this.traceBuffer)e+=n.length;var t=new Uint8Array(e);let r=0;for(const a of this.traceBuffer)t.set(a,r),r+=a.length;return t}getBufferUsagePercentage(e){if(!e.traceStats||!e.traceStats.bufferStats)return 0;let t=0;for(const a of e.traceStats.bufferStats){var r=a.bytesWritten,n=a.bufferSize;t=Math.max(t,r/n)}return t}onError(e){console.error("Error in record controller: ",e),f.globals.dispatch(l.Actions.setLastRecordingError({error:e.substr(0,150)})),f.globals.dispatch(l.Actions.stopRecording({}))}onStatus(e){f.globals.dispatch(l.Actions.setRecordingStatus({status:e}))}async getTargetController(a){var e=_.getTargetIdentifier(a),t=this.controllerPromises.get(e);return t||(t=new Promise(async(e,t)=>{let r=void 0;if((0,d.isChromeTarget)(a)||(0,d.isWindowsTarget)(a))r=new m.ChromeExtensionConsumerPort(this.extensionPort,this);else{if(!(0,d.isAdbTarget)(a))throw Error("No device connected");this.onStatus(`Please allow USB debugging on device.
                 If you press cancel, reload the page.`);var n=await this.hasSocketAccess(a);r=new(n?g.AdbSocketConsumerPort:h.AdbConsumerPort)(this.adb,this)}if(!r)throw Error("Unknown target: "+a);e(r)}),this.controllerPromises.set(e,t),t)}static getTargetIdentifier(e){return(0,d.isAdbTarget)(e)?e.serial:e.os}async hasSocketAccess(t){var e=(await navigator.usb.getDevices()).find(e=>e.serialNumber===t.serial);return console.assert(e),e?g.AdbSocketConsumerPort.hasSocketAccess(e,this.adb):Promise.resolve(!1)}async rpcImpl(t,e,r){try{var n=f.globals.state,a=await this.getTargetController(n.recordingTarget);this.recordedTraceSuffix=a.getRecordedTraceSuffix(),a.handleCommand(t.name,e)}catch(e){console.error(`error invoking ${t}: `+e.message)}}}function a(e,t){return r.TraceConfig.encode(i(e,t)).finish()}function i(e,t){let r,n;switch(t.os){case"L":r="LINUX";break;case"C":r="CHROME";break;case"CrOS":r="CHROME_OS";break;case"Win":r="WINDOWS";break;case"S":n=31,r="ANDROID";break;case"R":n=30,r="ANDROID";break;case"Q":n=29,r="ANDROID";break;case"P":n=28,r="ANDROID";break;default:n=26,r="ANDROID"}let a;return a="ANDROID"===r?{targetType:r,androidApiLevel:n,dataSources:[],name:""}:{targetType:r,dataSources:[],name:""},(0,u.genTraceConfig)(e,a)}function o(e){return[...function*e(t,r){for(const[o,s]of Object.entries(t)){var n=Array.isArray(s),a="object"==typeof s&&!n;for(const l of n?s:[s]){if(yield" ".repeat(r)+(o.replace(/[A-Z]/g,e=>"_"+e.toLowerCase())+(a?"":":"))+" ",(0,c.isString)(l))(i=l).startsWith("MEMINFO_")||i.startsWith("VMSTAT_")||i.startsWith("STAT_")||i.startsWith("LID_")||i.startsWith("BATTERY_COUNTER_")||"DISCARD"===i||"RING_BUFFER"===i||"BACKGROUND"===i||"USER_INITIATED"===i||i.startsWith("PERF_CLOCK_")||["maxFileSizeBytes","pid","samplingIntervalBytes","shmemSizeBytes","timestampUnitMultiplier","frequency"].includes(o)?yield l:yield`"${l.replace(new RegExp('"',"g"),'\\"')}"`;else if("number"==typeof l)yield l.toString();else if("boolean"==typeof l)yield l.toString();else{if("object"!=typeof l||null===l)throw new Error(`Record proto entry "${l}" with unexpected type `+typeof l);yield"{\n",yield*e(l,r+4),yield" ".repeat(r)+"}"}yield"\n"}}var i}(r.TraceConfig.decode(e).toJSON(),0)].join("")}EE.RecordController=_}return EE}var FE,UE={},BE={};function jE(){if(!FE){FE=1,Object.defineProperty(BE,"__esModule",{value:!0}),BE.cacheTrace=async function(e,t){let r,n="",a="",i="",o=0,s=!1;switch(e.type){case"ARRAY_BUFFER":r=e.buffer,n=e.title,a=e.fileName??"",i=e.url??"",o=e.buffer.byteLength,s=e.localOnly||!1;break;case"FILE":r=await e.file.arrayBuffer(),n=e.file.name,o=e.file.size;break;default:return!1}var l=new Headers([["x-trace-title",encodeURI(n)],["x-trace-url",i],["x-trace-filename",a],["x-trace-local-only",""+s],["content-type","application/octet-stream"],["content-length",""+o],["expires",new Date((new Date).getTime()+6048e5).toUTCString()]]);return await u(),await async function(e,t){try{var r=await c();void 0!==r&&await r.put(e,t)}catch(e){}}(`/_${d}/`+t,new Response(r,{headers:l})),!0},BE.tryGetTrace=async function(e){await u();var t=await l(`/_${d}/`+e);if(t)return{type:"ARRAY_BUFFER",buffer:await t.arrayBuffer(),title:decodeURI(t.headers.get("x-trace-title")??""),fileName:t.headers.get("x-trace-filename")??void 0,url:t.headers.get("x-trace-url")??void 0,uuid:e,localOnly:"true"===t.headers.get("x-trace-local-only")}};const d="cached_traces",f=10;let e=void 0;async function c(){if(void 0!==self.caches)return e=void 0===e?await caches.open(d):e}async function s(e){try{var t=await c();return void 0===t?!1:await t.delete(e)}catch(e){return!1}}async function l(e){try{var t=await c();if(void 0!==t)return await t.match(e)}catch(e){}}async function u(){var e=await async function(){try{var e=await c();return void 0===e?[]:await e.keys()}catch(e){return[]}}(),t=[],r=new Date,n=[];for(const i of e){var a=await l(i);void 0!==a&&(null==(a=a.headers.get("expires"))||(a=new Date(a))<r?n.push(s(i)):t.push({key:i,date:a}))}for(const o of t.sort((e,t)=>t.date.getTime()-e.date.getTime()).slice(f))n.push(s(o.key));await Promise.all(n)}}return BE}var HE,GE,VE,WE={},qE={},$E={};function zE(){if(GE)return qE;GE=1,Object.defineProperty(qE,"__esModule",{value:!0}),qE.EngineProxy=qE.EngineBase=qE.NullLoadingTracker=void 0;const s=Wa(),o=ee(),l=Sa();var e=function(){if(!HE){HE=1,Object.defineProperty($E,"__esModule",{value:!0}),$E.ProtoRingBuffer=void 0;const o=ee(),s=1073741824;class n{buf=new Uint8Array(131072);fastpath;rd=0;wr=0;append(e){(0,o.assertTrue)(this.wr<=this.buf.length),(0,o.assertTrue)(this.rd<=this.wr),this.rd===this.wr&&(this.rd=this.wr=0);var t=e.length;if(0!==t){if((0,o.assertTrue)(void 0===this.fastpath),this.rd===this.wr){var r=n.tryReadMessage(e,0,t);if(void 0!==r&&r.byteOffset+r.length===e.byteOffset+t)return void(this.fastpath=r)}r=this.buf.length-this.wr;if(r<t&&(this.buf.copyWithin(0,this.rd,this.wr),r+=this.rd,this.wr-=this.rd,this.rd=0,r<t)){let e=this.buf.length;for(;t>e-this.wr;)e+=131072;(0,o.assertTrue)(e<=2*s);r=new Uint8Array(e);r.set(this.buf),this.buf=r}this.buf.set(e,this.wr),this.wr+=t}}readMessage(){if(void 0!==this.fastpath){(0,o.assertTrue)(this.rd===this.wr);const e=this.fastpath;return this.fastpath=void 0,e}if((0,o.assertTrue)(this.rd<=this.wr),!(this.rd>=this.wr)){const e=n.tryReadMessage(this.buf,this.rd,this.wr);if(void 0!==e)return(0,o.assertTrue)(e.buffer===this.buf.buffer),(0,o.assertTrue)(0===this.buf.byteOffset),this.rd=e.byteOffset+e.length,e.slice()}}static tryReadMessage(r,e,n){(0,o.assertTrue)(n<=r.length);let a=e;if(!(a>=n)){e=r[a++];if(128<=e||2!=(7&e))throw new Error(`RPC framing error, unexpected tag ${e} @ offset `+(a-1));let t=0;for(let e=0;;e+=7){if(a>=n)return;var i=r[a++];if(t|=(127&i)<<e>>>0,i<128)break}if(t>=s)throw new Error(`RPC framing error, message too large (${t} > `+s);e=a+t;if(!(n<e))return r.subarray(a,e)}}}$E.ProtoRingBuffer=n}return $E}();const c=Z();var u=l.TraceProcessorRpc.TraceProcessorMethod;class t{beginLoading(){}endLoading(){}}qE.NullLoadingTracker=t;qE.EngineBase=class{loadingTracker;txSeqId=0;rxSeqId=0;rxBuf=new e.ProtoRingBuffer;pendingParses=new Array;pendingEOFs=new Array;pendingResetTraceProcessors=new Array;pendingQueries=new Array;pendingRestoreTables=new Array;pendingComputeMetrics=new Array;pendingReadMetatrace;_isMetatracingEnabled=!1;constructor(e){this.loadingTracker=e||new t}onRpcResponseBytes(e){for(this.rxBuf.append(e);;){var t=this.rxBuf.readMessage();if(void 0===t)break;this.onRpcResponseMessage(t)}}onRpcResponseMessage(n){l.QueryResult.decode=(e,t)=>{var r=l.QueryResult.create();return r.rawQueryResult=e.buf.subarray(e.pos,e.pos+t),(0,o.assertTrue)(r.rawQueryResult.buffer===n.buffer),e.pos+=t,r};var e=l.TraceProcessorRpc.decode(n);if(void 0!==e.fatalError&&0<e.fatalError.length)throw new Error(""+e.fatalError);if(e.seq!==this.rxSeqId+1&&0!==this.rxSeqId&&0!==e.seq)throw new Error(`RPC sequence id mismatch cur=${e.seq} last=${this.rxSeqId} (ERR:rpc_seq)`);this.rxSeqId=e.seq;let t=!0;switch(e.response){case u.TPM_APPEND_TRACE_DATA:var r=(0,o.assertExists)(e.appendResult),a=(0,o.assertExists)(this.pendingParses.shift());r.error&&0<r.error.length?a.reject(r.error):a.resolve();break;case u.TPM_FINALIZE_TRACE_DATA:(0,o.assertExists)(this.pendingEOFs.shift()).resolve();break;case u.TPM_RESET_TRACE_PROCESSOR:(0,o.assertExists)(this.pendingResetTraceProcessors.shift()).resolve();break;case u.TPM_RESTORE_INITIAL_TABLES:(0,o.assertExists)(this.pendingRestoreTables.shift()).resolve();break;case u.TPM_QUERY_STREAMING:r=(0,o.assertExists)(e.queryResult),a=(0,o.assertExists)(this.pendingQueries[0]);a.appendResultBatch(r.rawQueryResult),a.isComplete()?this.pendingQueries.shift():t=!1;break;case u.TPM_COMPUTE_METRIC:var i,r=(0,o.assertExists)(e.metricResult),a=(0,o.assertExists)(this.pendingComputeMetrics.shift());r.error&&0<r.error.length?(i=new c.QueryError("ComputeMetric() error: "+r.error,{query:"COMPUTE_METRIC"}),a.reject(i)):(i=r.metricsAsPrototext??r.metricsAsJson??r.metrics??"",a.resolve(i));break;case u.TPM_DISABLE_AND_READ_METATRACE:r=(0,o.assertExists)(e.metatrace);(0,o.assertExists)(this.pendingReadMetatrace).resolve(r),this.pendingReadMetatrace=void 0;break;default:console.log("Unexpected TraceProcessor response received: ",e.response)}t&&this.loadingTracker.endLoading()}parse(e){var t=(0,s.defer)(),r=(this.pendingParses.push(t),l.TraceProcessorRpc.create());return r.request=u.TPM_APPEND_TRACE_DATA,r.appendTraceData=e,this.rpcSendRequest(r),t}notifyEof(){var e=(0,s.defer)(),t=(this.pendingEOFs.push(e),l.TraceProcessorRpc.create());return t.request=u.TPM_FINALIZE_TRACE_DATA,this.rpcSendRequest(t),e}resetTraceProcessor({cropTrackEvents:e,ingestFtraceInRawTable:t,analyzeTraceProtoContent:r,ftraceDropUntilAllCpusValid:n}){var a=(0,s.defer)(),i=(this.pendingResetTraceProcessors.push(a),l.TraceProcessorRpc.create()),o=(i.request=u.TPM_RESET_TRACE_PROCESSOR,i.resetTraceProcessorArgs=new l.ResetTraceProcessorArgs);return o.dropTrackEventDataBefore=e?l.ResetTraceProcessorArgs.DropTrackEventDataBefore.TRACK_EVENT_RANGE_OF_INTEREST:l.ResetTraceProcessorArgs.DropTrackEventDataBefore.NO_DROP,o.ingestFtraceInRawTable=t,o.analyzeTraceProtoContent=r,o.ftraceDropUntilAllCpusValid=n,this.rpcSendRequest(i),a}restoreInitialTables(){var e=(0,s.defer)(),t=(this.pendingRestoreTables.push(e),l.TraceProcessorRpc.create());return t.request=u.TPM_RESTORE_INITIAL_TABLES,this.rpcSendRequest(t),e}async computeMetric(e,t){var r=(0,s.defer)(),n=(this.pendingComputeMetrics.push(r),l.TraceProcessorRpc.create()),a=(n.request=u.TPM_COMPUTE_METRIC,n.computeMetricArgs=new l.ComputeMetricArgs);if(a.metricNames=e,"json"===t)a.format=l.ComputeMetricArgs.ResultFormat.JSON;else if("prototext"===t)a.format=l.ComputeMetricArgs.ResultFormat.TEXTPROTO;else{if("proto"!==t)throw new Error("Unknown compute metric format "+t);a.format=l.ComputeMetricArgs.ResultFormat.BINARY_PROTOBUF}return this.rpcSendRequest(n),r}streamingQuery(e,t){var r=l.TraceProcessorRpc.create(),t=(r.request=u.TPM_QUERY_STREAMING,r.queryArgs=new l.QueryArgs,r.queryArgs.sqlQuery=e,t&&(r.queryArgs.tag=t),(0,c.createQueryResult)({query:e}));return this.pendingQueries.push(t),this.rpcSendRequest(r),t}async query(e,t){try{return await this.streamingQuery(e,t)}catch(e){throw n(e),e}}async tryQuery(e,t){try{return{success:!0,result:await this.query(e,t)}}catch(e){return{success:!1,error:e}}}isMetatracingEnabled(){return this._isMetatracingEnabled}enableMetatrace(e){var t=l.TraceProcessorRpc.create();t.request=u.TPM_ENABLE_METATRACE,void 0!==e&&e!==l.MetatraceCategories.NONE&&(t.enableMetatraceArgs=new l.EnableMetatraceArgs,t.enableMetatraceArgs.categories=e),this._isMetatracingEnabled=!0,this.rpcSendRequest(t)}stopAndGetMetatrace(){var e,t;return this.pendingReadMetatrace?Promise.reject(new Error("Already finalising a metatrace")):(e=(0,s.defer)(),(t=l.TraceProcessorRpc.create()).request=u.TPM_DISABLE_AND_READ_METATRACE,this._isMetatracingEnabled=!1,this.pendingReadMetatrace=e,this.rpcSendRequest(t),e)}rpcSendRequest(e){e.seq=this.txSeqId++;var t=l.TraceProcessorRpcStream.create(),e=(t.msg.push(e),l.TraceProcessorRpcStream.encode(t).finish());this.loadingTracker.beginLoading(),this.rpcSendRequestBytes(e)}getProxy(e){return new r(this,e)}};class r{engine;tag;_isAlive;constructor(e,t){this.engine=e,this.tag=t,this._isAlive=!0}async query(e,t){if(this._isAlive)return this.engine.query(e,t);throw new Error(`EngineProxy ${this.tag} was disposed.`)}async tryQuery(e,t){return this._isAlive?this.engine.tryQuery(e,t):{success:!1,error:new Error(`EngineProxy ${this.tag} was disposed.`)}}async computeMetric(e,t){return this._isAlive?this.engine.computeMetric(e,t):Promise.reject(new Error(`EngineProxy ${this.tag} was disposed.`))}get engineId(){return this.engine.id}[Symbol.dispose](){this._isAlive=!1}}function n(e){var t=(new Error).stack;"captureStackTrace"in Error?Error.captureStackTrace(e,n):Object.defineProperty(e,"stack",{value:t,writable:!0,configurable:!0})}return qE.EngineProxy=r,qE}function KE(){if(!VE){VE=1,Object.defineProperty(WE,"__esModule",{value:!0}),WE.HttpRpcEngine=void 0;const a=qo(),t=ee(),i=Sa();var e=zE();class o extends e.EngineBase{id;errorHandler=()=>{};requestQueue=new Array;websocket;connected=!1;static rpcPort="9001";constructor(e,t){super(t),this.id=e}rpcSendRequestBytes(e){var t;void 0===this.websocket&&(t=`ws://${o.hostAndPort}/websocket`,this.websocket=new WebSocket(t),this.websocket.onopen=()=>this.onWebsocketConnected(),this.websocket.onmessage=e=>this.onWebsocketMessage(e),this.websocket.onclose=e=>this.onWebsocketClosed(e),this.websocket.onerror=e=>this.errorHandler(`WebSocket error (state=${e.target?.readyState})`)),this.connected?this.websocket.send(e):this.requestQueue.push(e)}onWebsocketConnected(){for(;;){var e=this.requestQueue.shift();if(void 0===e)break;(0,t.assertExists)(this.websocket).send(e)}this.connected=!0}onWebsocketClosed(e){1006===e.code&&this.connected?(console.log("Websocket closed, reconnecting"),this.websocket=void 0,this.connected=!1,this.rpcSendRequestBytes(new Uint8Array)):this.errorHandler(`Websocket closed (${e.code}: ${e.reason})`)}onWebsocketMessage(e){(0,t.assertExists)(e.data).arrayBuffer().then(e=>{super.onRpcResponseBytes(new Uint8Array(e))})}static async checkConnection(){var e=`http://${o.hostAndPort}/`,t={connected:!1};console.info(`It's safe to ignore the ERR_CONNECTION_REFUSED on ${e} below. `+"That might happen while probing the external native accelerator. The error is non-fatal and unlikely to be the culprit for any UI bug.");try{var r,n=await(0,a.fetchWithTimeout)(e+"status",{method:"post",cache:"no-cache"},2e3);200!==n.status?t.failure=n.status+" - "+n.statusText:(r=new Uint8Array(await n.arrayBuffer()),t.connected=!0,t.status=i.StatusResult.decode(r))}catch(e){t.failure=""+e}return t}static get hostAndPort(){return"127.0.0.1:"+o.rpcPort}}WE.HttpRpcEngine=o}return WE}var YE,JE={};function ZE(){if(!YE){YE=1,Object.defineProperty(JE,"__esModule",{value:!0}),JE.WasmEngineProxy=void 0,JE.initWasm=function(e){r=e+"engine_bundle.js",n=new Worker(r)},JE.resetEngineWorker=function(){var e=new MessageChannel,t=e.port1;void 0!==a&&a.terminate();return(a=(0,i.assertExists)(n)).postMessage(t,[t]),n=new Worker(r),e.port2};const i=ee();var e=zE();let r,n,a;class t extends e.EngineBase{id;port;constructor(e,t,r){super(r),this.id=e,this.port=t,this.port.onmessage=this.onMessage.bind(this)}onMessage(e){(0,i.assertTrue)(e.data instanceof Uint8Array),super.onRpcResponseBytes(e.data)}rpcSendRequestBytes(e){this.port.postMessage(e)}}JE.WasmEngineProxy=t}return JE}var QE,XE,eS={},tS={};function rS(){if(!QE){QE=1,Object.defineProperty(tS,"__esModule",{value:!0}),tS.AggregationController=void 0;var e=qa();const t=Qh(),p=te(),h=oe(),r=CT(),n=Z();class a extends bE().Controller{args;kind;monitor;limiter=new e.AsyncLimiter;constructor(e){super("main"),this.args=e,this.kind=this.args.kind,this.monitor=new t.Monitor([()=>h.globals.state.selection,()=>h.globals.state.aggregatePreferences[this.args.kind]])}run(){if(this.monitor.ifStateChanged()){const t=h.globals.state.selection;"area"!==t.kind?(0,r.publishAggregateData)({data:{tabName:this.getTabName(),columns:[],strings:[],columnSums:[]},kind:this.args.kind}):this.limiter.schedule(async()=>{var e=await this.getAggregateData(t,!0);(0,r.publishAggregateData)({data:e,kind:this.args.kind})})}}async getAggregateData(e,t){if(t&&!await this.createAggregateView(this.args.engine,e))return{tabName:this.getTabName(),columns:[],strings:[],columnSums:[]};var t=this.getColumnDefinitions(),r=t.map(e=>e.columnId),n=h.globals.state.aggregatePreferences[this.kind];let a=this.getDefaultSorting().column+" "+this.getDefaultSorting().direction;n&&n.sorting&&(a=n.sorting.column+" "+n.sorting.direction);n=`select ${r} from ${this.kind} order by `+a,r=await this.args.engine.query(n);const i=r.numRows();n=t.map(e=>this.columnFromColumnDef(e,i)),t=await Promise.all(t.map(e=>this.getSum(e))),e=await this.getExtra(this.args.engine,e),e=e||void 0;const o={tabName:this.getTabName(),columns:n,columnSums:t,strings:[],extra:e},s=new Map;function l(e){var t=s.get(e);return void 0===t&&(t=o.strings.length,o.strings.push(e),s.set(e,t)),t}var c,u=r.iter({});for(let e=0;u.valid();u.next(),++e)for(const f of o.columns){var d=u.get(f.columnId);null===d?f.data[e]="STRING"===(c=f).kind||"STATE"===c.kind?l("NULL"):0:(0,p.isString)(d)?f.data[e]=l(d):d instanceof Uint8Array?f.data[e]=l("<Binary blob>"):f.data[e]="bigint"==typeof d?Number(d):d}return o}async getSum(e){if(!e.sum)return"";let t=(await this.args.engine.query(`select ifnull(sum(${e.columnId}), 0) as s from `+this.kind)).firstRow({s:n.NUM}).s;return"TIMESTAMP_NS"===e.kind&&(t/=1e6),""+t}columnFromColumnDef(e,t){return{title:e.title,kind:e.kind,data:new e.columnConstructor(t),columnId:e.columnId}}}tS.AggregationController=a}return tS}var nS,aS={};var iS,oS={};var sS,lS={};var cS,uS={};function dS(){if(!cS){cS=1,Object.defineProperty(uS,"__esModule",{value:!0}),uS.SliceAggregationController=void 0,uS.getSelectedTrackKeys=n;const a=oe();var e=rS();const i=Q();class t extends e.AggregationController{async createAggregateView(e,t){var r=n(t);return 0!==r.length&&(await e.query(`
      create or replace perfetto table ${this.kind} as
      select
        name,
        sum(dur) AS total_dur,
        sum(dur)/count() as avg_dur,
        count() as occurrences
        from slices
      where track_id in (${r})
        and ts + dur > ${t.start}
        and ts < ${t.end}
      group by name
    `),!0)}getTabName(){return"Slices"}async getExtra(){}getDefaultSorting(){return{column:"total_dur",direction:"DESC"}}getColumnDefinitions(){return[{title:"Name",kind:"STRING",columnConstructor:Uint32Array,columnId:"name"},{title:"Wall duration (ms)",kind:"TIMESTAMP_NS",columnConstructor:Float64Array,columnId:"total_dur",sum:!0},{title:"Avg Wall duration (ms)",kind:"TIMESTAMP_NS",columnConstructor:Float64Array,columnId:"avg_dur"},{title:"Occurrences",kind:"NUMBER",columnConstructor:Uint32Array,columnId:"occurrences",sum:!0}]}}function n(e){var t=[];for(const n of e.tracks){var r=a.globals.state.tracks[n];void 0!==r?.uri&&((r=a.globals.trackManager.resolveTrackInfo(r.uri))?.tags?.kind===i.THREAD_SLICE_TRACK_KIND&&r.tags.trackIds&&t.push(...r.tags.trackIds),r?.tags?.kind===i.ASYNC_SLICE_TRACK_KIND)&&r.tags.trackIds&&t.push(...r.tags.trackIds)}return t}uS.SliceAggregationController=t}return uS}var fS,pS={};var hS,gS={};var mS,_S={};var yS,TS={};var bS,vS={};var ES,SS={};var AS,OS={};function CS(){if(!AS){AS=1,Object.defineProperty(OS,"__esModule",{value:!0}),OS.FlowEventsController=void 0;const O=K(),n=Y();var e=re();const C=oe(),l=CT(),k=Nc(),w=Z();var t=bE(),r=Qh();const c=Q(),a=e.featureFlags.register({id:"showIndirectPrecedingFlows",name:"Show indirect preceding flows",description:"Show indirect preceding flows (connected through ancestor slices) when a slice is selected.",defaultValue:!1});class i extends t.Controller{args;monitor=new r.Monitor([()=>C.globals.state.selection]);constructor(e){super("main"),this.args=e,this.args.engine.query(`
      SELECT CREATE_FUNCTION(
        'CHROME_CUSTOM_SLICE_NAME(slice_id LONG)',
        'STRING',
        'select case
           when name="Receive mojo message" then
            printf("Receive mojo message (interface=%s, hash=%s)",
              EXTRACT_ARG(arg_set_id,
                          "chrome_mojo_event_info.mojo_interface_tag"),
              EXTRACT_ARG(arg_set_id, "chrome_mojo_event_info.ipc_hash"))
           when name="ThreadControllerImpl::RunTask" or
                name="ThreadPool_RunTask" then
            printf("RunTask(posted_from=%s:%s)",
             EXTRACT_ARG(arg_set_id, "task.posted_from.file_name"),
             EXTRACT_ARG(arg_set_id, "task.posted_from.function_name"))
         end
         from slice where id=$slice_id'
    );`)}async queryFlowEvents(e,t){var r=[];const n=(await this.args.engine.query(e)).iter({beginSliceId:w.NUM,beginTrackId:w.NUM,beginSliceName:w.STR_NULL,beginSliceChromeCustomName:w.STR_NULL,beginSliceCategory:w.STR_NULL,beginSliceStartTs:w.LONG,beginSliceEndTs:w.LONG,beginDepth:w.NUM,beginThreadName:w.STR_NULL,beginProcessName:w.STR_NULL,endSliceId:w.NUM,endTrackId:w.NUM,endSliceName:w.STR_NULL,endSliceChromeCustomName:w.STR_NULL,endSliceCategory:w.STR_NULL,endSliceStartTs:w.LONG,endSliceEndTs:w.LONG,endDepth:w.NUM,endThreadName:w.STR_NULL,endProcessName:w.STR_NULL,name:w.STR_NULL,category:w.STR_NULL,id:w.NUM,flowToDescendant:w.NUM});for(var a=e=>null===e?"NULL":e,i=e=>null===e?void 0:e,o=[];n.valid();n.next()){var s=i(n.category),l=i(n.name),c=n.id,u={trackId:n.beginTrackId,sliceId:(0,k.asSliceSqlId)(n.beginSliceId),sliceName:a(n.beginSliceName),sliceChromeCustomName:i(n.beginSliceChromeCustomName),sliceCategory:a(n.beginSliceCategory),sliceStartTs:O.Time.fromRaw(n.beginSliceStartTs),sliceEndTs:O.Time.fromRaw(n.beginSliceEndTs),depth:n.beginDepth,threadName:a(n.beginThreadName),processName:a(n.beginProcessName)},d={trackId:n.endTrackId,sliceId:(0,k.asSliceSqlId)(n.endSliceId),sliceName:a(n.endSliceName),sliceChromeCustomName:i(n.endSliceChromeCustomName),sliceCategory:a(n.endSliceCategory),sliceStartTs:O.Time.fromRaw(n.endSliceStartTs),sliceEndTs:O.Time.fromRaw(n.endSliceEndTs),depth:n.endDepth,threadName:a(n.endThreadName),processName:a(n.endProcessName)};o.push(u),o.push(d),r.push({id:c,begin:u,end:d,dur:n.endSliceStartTs-n.beginSliceEndTs,category:s,name:l,flowToDescendant:!!n.flowToDescendant})}const f=new Map,p=new Map,h=C.globals.trackManager.trackKeyByTrackId,g=C.globals.state.tracks;var m,_,y;for(const E of o){m=E.trackId;var T=(T=y=_=void 0)!==(T=p.get(m))?T:void 0===(_=h.get(m))||void 0===(y=g[_])?(p.set(m,null),null):void 0!==(T=f.get(_))?T:void 0===(T=C.globals.trackManager.resolveTrackInfo(y.uri)?.tags?.trackIds)||T.length<=1?(f.set(_,null),p.set(m,null),null):(y={uiTrackId:_,siblingTrackIds:[...T],sliceIds:[],nodes:[]},f.set(_,y),p.set(m,y),y);null!==T&&(T.sliceIds.push(E.sliceId),T.nodes.push(E))}for(const S of f.values())if(null!==S){const n=(await this.args.engine.query(`
        SELECT
          id,
          layout_depth as depth
        FROM
          experimental_slice_layout
        WHERE
          filter_track_ids = '${S.siblingTrackIds.join(",")}'
          AND id in (${S.sliceIds.join(", ")})
      `)).iter({id:w.NUM,depth:w.NUM});for(var b=new Map;n.valid();n.next())b.set(n.id,n.depth);for(const A of S.nodes){var v=b.get(A.sliceId);void 0!==v&&(A.depth=v)}}t(r)}sliceSelected(e){e=a.get()?`(
           select * from directly_connected_flow(${e})
           union
           select * from preceding_flow(${e})
         )`:`directly_connected_flow(${e})`;this.queryFlowEvents(`
    select
      f.slice_out as beginSliceId,
      t1.track_id as beginTrackId,
      t1.name as beginSliceName,
      CHROME_CUSTOM_SLICE_NAME(t1.slice_id) as beginSliceChromeCustomName,
      t1.category as beginSliceCategory,
      t1.ts as beginSliceStartTs,
      (t1.ts+t1.dur) as beginSliceEndTs,
      t1.depth as beginDepth,
      (thread_out.name || ' ' || thread_out.tid) as beginThreadName,
      (process_out.name || ' ' || process_out.pid) as beginProcessName,
      f.slice_in as endSliceId,
      t2.track_id as endTrackId,
      t2.name as endSliceName,
      CHROME_CUSTOM_SLICE_NAME(t2.slice_id) as endSliceChromeCustomName,
      t2.category as endSliceCategory,
      t2.ts as endSliceStartTs,
      (t2.ts+t2.dur) as endSliceEndTs,
      t2.depth as endDepth,
      (thread_in.name || ' ' || thread_in.tid) as endThreadName,
      (process_in.name || ' ' || process_in.pid) as endProcessName,
      extract_arg(f.arg_set_id, 'cat') as category,
      extract_arg(f.arg_set_id, 'name') as name,
      f.id as id,
      slice_is_ancestor(t1.slice_id, t2.slice_id) as flowToDescendant
    from ${e} f
    join slice t1 on f.slice_out = t1.slice_id
    join slice t2 on f.slice_in = t2.slice_id
    left join thread_track track_out on track_out.id = t1.track_id
    left join thread thread_out on thread_out.utid = track_out.utid
    left join thread_track track_in on track_in.id = t2.track_id
    left join thread thread_in on thread_in.utid = track_in.utid
    left join process process_out on process_out.upid = thread_out.upid
    left join process process_in on process_in.upid = thread_in.upid
    `,e=>(0,l.publishConnectedFlows)(e))}areaSelected(e){var t=[];for(const o of e.tracks){var r=C.globals.state.tracks[o];if(void 0!==r?.uri){var r=C.globals.trackManager.resolveTrackInfo(r.uri),n=r?.tags?.kind;if((n===c.THREAD_SLICE_TRACK_KIND||n===c.ACTUAL_FRAMES_SLICE_TRACK_KIND)&&r?.tags?.trackIds)for(const s of r.tags.trackIds)t.push(s)}}var a=`(${t.join(",")})`,i=e.start,e=e.end;this.queryFlowEvents(`
    select
      f.slice_out as beginSliceId,
      t1.track_id as beginTrackId,
      t1.name as beginSliceName,
      CHROME_CUSTOM_SLICE_NAME(t1.slice_id) as beginSliceChromeCustomName,
      t1.category as beginSliceCategory,
      t1.ts as beginSliceStartTs,
      (t1.ts+t1.dur) as beginSliceEndTs,
      t1.depth as beginDepth,
      NULL as beginThreadName,
      NULL as beginProcessName,
      f.slice_in as endSliceId,
      t2.track_id as endTrackId,
      t2.name as endSliceName,
      CHROME_CUSTOM_SLICE_NAME(t2.slice_id) as endSliceChromeCustomName,
      t2.category as endSliceCategory,
      t2.ts as endSliceStartTs,
      (t2.ts+t2.dur) as endSliceEndTs,
      t2.depth as endDepth,
      NULL as endThreadName,
      NULL as endProcessName,
      extract_arg(f.arg_set_id, 'cat') as category,
      extract_arg(f.arg_set_id, 'name') as name,
      f.id as id,
      slice_is_ancestor(t1.slice_id, t2.slice_id) as flowToDescendant
    from flow f
    join slice t1 on f.slice_out = t1.slice_id
    join slice t2 on f.slice_in = t2.slice_id
    where
      (t1.track_id in ${a}
        and (t1.ts+t1.dur <= ${e} and t1.ts+t1.dur >= ${i}))
      or
      (t2.track_id in ${a}
        and (t2.ts <= ${e} and t2.ts >= ${i}))
    `,e=>(0,l.publishSelectedFlows)(e))}refreshVisibleFlows(){var e,t;this.monitor.ifStateChanged()&&("empty"===(e=C.globals.state.selection).kind?((0,l.publishConnectedFlows)([]),(0,l.publishSelectedFlows)([])):((t=(0,n.getLegacySelection)(C.globals.state))&&"SLICE"===t.kind&&"annotation"!==t.table?this.sliceSelected(t.id):(0,l.publishConnectedFlows)([]),"area"===e.kind?this.areaSelected(e):(0,l.publishSelectedFlows)([])))}run(){this.refreshVisibleFlows()}}OS.FlowEventsController=i}return OS}var kS,wS={};var RS,IS,MS={},PS={};function NS(){if(!RS){RS=1;{var e=PS;Object.defineProperty(e,"__esModule",{value:!0}),e.QueryGeneratorError=e.tables=e.sliceAggregationColumns=e.sliceTable=void 0,e.areaFilters=c,e.expression=u,e.extractArgumentExpression=t,e.aggregationIndex=function(e,t){return e+t},e.generateQueryFromState=function(e){if(void 0===e.selectionArea)throw new f("Should not be called without area");var t=[...e.selectedAggregations.values()];if(0===t.length)throw new f("No aggregations selected");var r=e.selectedPivots,n=t.map((e,t)=>{return`${e=e,"COUNT"!==e.aggregationFunction?`${e.aggregationFunction}(${u(e.column)})`:"COUNT()"} as `+l(t)}),a=n.length,i=(n.push("COUNT() as hidden_count"),r.map(u)),o=[];for(let e=0;e<t.length;e++){var s=t[e].sortDirection;void 0!==s&&o.push(l(e)+" "+s)}e=e.constrainToArea?"where "+c(e.selectionArea).join(" and\n"):"",n=`
    INCLUDE PERFETTO MODULE slices.slices;

    select
      ${i.concat(n).join(",\n")}
    from ${d.SqlTables.slice.name}
    ${e}
    group by ${i.join(", ")}
    ${0<o.length?"order by "+o.join(", "):""}
  `;return{text:n,metadata:{pivotColumns:r,aggregationColumns:t,countIndex:a}}};const r=J(),n=dS(),d=ga();e.sliceTable={name:d.SqlTables.slice.name,displayName:"slice",columns:["type","ts","dur","category","name","depth","pid","process_name","tid","thread_name"]},e.sliceAggregationColumns=["ts","dur","depth","thread_ts","thread_dur","thread_instruction_count","thread_instruction_delta"],e.tables=[e.sliceTable];class f extends Error{}function l(e){return"agg_"+e}function c(e){return["ts + dur > "+e.start,"ts < "+e.end,`track_id in (${(0,n.getSelectedTrackKeys)(e).join(", ")})`]}function u(e){switch(e.kind){case"regular":return e.table+"."+e.column;case"argument":return t(e.argument,d.SqlTables.slice.name)}}function t(e,t){return`extract_arg(${void 0===t?"":t+"."}arg_set_id, ${(0,r.sqliteString)(e)})`}e.QueryGeneratorError=f}}return PS}function DS(){if(!IS){IS=1;{var n=MS;Object.defineProperty(n,"__esModule",{value:!0}),n.PivotTableController=n.PivotTableTreeBuilder=n.PIVOT_TABLE_REDUX_FLAG=void 0;const a=sc(),o=ne();var e=re();const s=oe(),c=NS();var t=bE();function l(e){if("number"==typeof e)return e;if("bigint"==typeof e)return Number(e);throw new Error("number or bigint was expected, got "+typeof e)}n.PIVOT_TABLE_REDUX_FLAG=e.featureFlags.register({id:"pivotTable",name:"Pivot tables V2",description:"Second version of pivot table",defaultValue:!0});class u{root;queryMetadata;get pivotColumnsCount(){return this.queryMetadata.pivotColumns.length}get aggregateColumns(){return this.queryMetadata.aggregationColumns}constructor(e,t){this.queryMetadata=e,this.root=this.createNode(t);let r=this.root;for(let e=0;e+1<this.pivotColumnsCount;e++){var n=t[e];r=this.insertChild(r,n,this.createNode(t))}r.rows.push(t)}ingestRow(t){let r=this.root;this.updateAggregates(r,t);for(let e=0;e+1<this.pivotColumnsCount;e++){var n=r.children.get(t[e]);r=void 0===n?this.insertChild(r,t[e],this.createNode(t)):(this.updateAggregates(n,t),n)}r.rows.push(t)}build(){return this.root}updateAggregates(t,r){var e=this.queryMetadata.countIndex,n=0<=e?l(t.aggregates[e]):0,a=0<=e?l(r[(0,c.aggregationIndex)(this.pivotColumnsCount,e)]):0;for(let e=0;e<this.aggregateColumns.length;e++){var i=this.aggregateColumns[e],o=t.aggregates[e],s=r[(0,c.aggregationIndex)(this.pivotColumnsCount,e)];if("number"==typeof o&&"number"==typeof s)switch(i.aggregationFunction){case"SUM":case"COUNT":t.aggregates[e]=o+s;break;case"MAX":t.aggregates[e]=Math.max(o,s);break;case"MIN":t.aggregates[e]=Math.min(o,s);break;case"AVG":t.aggregates[e]=(o*n+s*a)/(n+a)}}t.aggregates[this.aggregateColumns.length]=n+a}insertChild(e,t,r){return e.children.set(t,r),r}createNode(t){var r=[];for(let e=0;e<this.aggregateColumns.length;e++)r.push(t[(0,c.aggregationIndex)(this.pivotColumnsCount,e)]);return r.push(t[(0,c.aggregationIndex)(this.pivotColumnsCount,this.aggregateColumns.length)]),{isCollapsed:!1,children:new Map,aggregates:r,rows:[]}}}n.PivotTableTreeBuilder=u;class r extends t.Controller{static detailsCount=0;engine;lastQueryArea;lastQueryAreaTracks=new Set;constructor(e){super({}),this.engine=e.engine}sameTracks(e){if(this.lastQueryAreaTracks.size!==e.size)return!1;for(const t of e)if(!this.lastQueryAreaTracks.has(t))return!1;return!0}shouldRerun(e,t){return void 0!==e.selectionArea&&(t=new Set(t.tracks),!(this.lastQueryArea===e.selectionArea&&this.sameTracks(t)||(this.lastQueryArea=e.selectionArea,this.lastQueryAreaTracks=t,0)))}async processQuery(e){var t=await this.engine.query(e.text);try{await t.waitAllRows()}catch{}const r=t.columns(),n=t.iter({});function a(){var e=[];for(const t of r)e.push(n.get(t));return n.next(),e}if(n.valid()){for(var i=new u(e.metadata,a());n.valid();)i.ingestRow(a());s.globals.dispatch(o.Actions.setPivotStateQueryResult({queryResult:{tree:i.build(),metadata:e.metadata}}))}else s.globals.dispatch(o.Actions.setPivotStateQueryResult({queryResult:(t=e.metadata,{tree:{aggregates:[],isCollapsed:!1,children:new Map,rows:[]},metadata:t})}))}run(){var e,t,r;n.PIVOT_TABLE_REDUX_FLAG.get()&&(t=s.globals.state.nonSerializableState.pivotTable,e=s.globals.state.selection,(t.queryRequested||"area"===e.kind&&this.shouldRerun(t,e))&&(s.globals.dispatch(o.Actions.setPivotTableQueryRequested({queryRequested:!1})),s.globals.dispatch(o.Actions.setPivotStateQueryResult({queryResult:null})),this.processQuery((0,c.generateQueryFromState)(t))),"area"!==e.kind||void 0!==t.selectionArea&&(t=t.selectionArea,r=e,t.start===r.start)&&t.end===r.end&&(0,a.arrayEquals)(t.tracks,r.tracks)||s.globals.dispatch(o.Actions.togglePivotTable({area:e})))}}n.PivotTableController=r}}return MS}var xS,LS={};var FS,US={};function BS(){if(!FS){FS=1,Object.defineProperty(US,"__esModule",{value:!0}),US.SelectionController=void 0;const y=ee(),l=K(),T=Y(),i=Q(),b=oe(),v=CT(),E=Z(),t=D();class e extends bE().Controller{args;lastSelectedId;lastSelectedKind;constructor(e){super("main"),this.args=e}run(){var e,t,r=(0,T.getLegacySelection)(b.globals.state);!r||!(e=["SLICE","SCHED_SLICE","HEAP_PROFILE","THREAD_STATE"]).includes(r.kind)||e.includes(r.kind)&&r.id===this.lastSelectedId&&r.kind===this.lastSelectedKind||(e=r.id,t=r.kind,this.lastSelectedId=e,this.lastSelectedKind=t,void 0!==e&&("SCHED_SLICE"===r.kind?this.schedSliceDetails(e):"THREAD_STATE"===r.kind?this.threadStateDetails(r.id):"SLICE"===r.kind&&this.sliceDetails(r)))}async sliceDetails(l){var c=l.id;let e,t;if("annotation"===l.table)e="annotation_slice",t=Promise.resolve(new Map);else{var u=await this.args.engine.query(`
        SELECT
          type as leafTable,
          arg_set_id as argSetId
        FROM slice WHERE id = `+c);if(0===u.numRows())return;u=u.firstRow({leafTable:E.STR,argSetId:E.NUM}),u=(e=u.leafTable,u.argSetId);t=this.getArgs(u)}var u=this.args.engine.query(`
      SELECT *, ABS_TIME_STR(ts) as absTime FROM ${e} WHERE id = ${c};
    `),[u,d]=await Promise.all([u,t]);if(!(u.numRows()<=0)){var f=u.iter({});(0,y.assertTrue)(f.valid());let e=void 0,t=void 0,r=void 0,n=void 0,a=void 0,i=void 0,o=void 0,s=void 0;var p=["type","depth","parent_id","stack_id","parent_stack_id","arg_set_id","thread_instruction_count","thread_instruction_delta"];for(const _ of u.columns()){var h=f.get(_);switch(_){case"id":break;case"ts":e=(0,E.timeFromSql)(h);break;case"thread_ts":o=(0,E.timeFromSql)(h);break;case"absTime":h&&(t=""+h);break;case"name":n=""+h;break;case"dur":r=(0,E.durationFromSql)(h);break;case"thread_dur":i=(0,E.durationFromSql)(h);break;case"category":case"cat":a=""+h;break;case"track_id":s=Number(h);break;default:p.includes(_)||d.set(_,""+h)}}var g,m,u={id:c,ts:e,threadTs:o,absTime:t,dur:r,threadDur:i,name:n,category:a,args:d};void 0!==s&&(g=0!==(c=(await this.args.engine.query(`
        WITH
           leafTrackTable AS (SELECT type FROM track WHERE id = ${s}),
           cols AS (
                SELECT name
                FROM pragma_table_info((SELECT type FROM leafTrackTable))
            )
        SELECT
           type as leafTrackTable,
          'upid' in cols AS hasUpid,
          'utid' in cols AS hasUtid
        FROM leafTrackTable
      `)).firstRow({hasUpid:E.NUM,hasUtid:E.NUM,leafTrackTable:E.STR})).hasUpid,0!==c.hasUtid?(m=(await this.args.engine.query(`
            SELECT utid
            FROM ${c.leafTrackTable}
            WHERE id = ${s};
        `)).firstRow({utid:E.NUM}).utid,Object.assign(u,await this.computeThreadDetails(m))):g&&(m=(await this.args.engine.query(`
            SELECT upid
            FROM ${c.leafTrackTable}
            WHERE id = ${s};
        `)).firstRow({upid:E.NUM}).upid,Object.assign(u,await this.computeProcessDetails(m)))),l===(0,T.getLegacySelection)(b.globals.state)&&(0,v.publishSliceDetails)(u)}}async getArgs(e){for(var t=new Map,r=(await this.args.engine.query(`
      select
        key AS name,
        display_value AS value
      FROM args
      WHERE arg_set_id = ${e}
    `)).iter({name:E.STR,value:E.STR_NULL});r.valid();r.next()){var n=r.name,a=r.value??"NULL";"destination slice id"!==n||isNaN(Number(a))?t.set(n,a):(n=await this.getDestTrackId(a),t.set("Destination Slice",{kind:"SCHED_SLICE",trackId:n,sliceId:Number(a),rawValue:a}))}return t}async getDestTrackId(e){var t=(await this.args.engine.query(`select track_id as trackId from slice
    where slice_id = `+e)).firstRow({trackId:E.NUM}).trackId;let r="";for(const a of Object.values(b.globals.state.tracks)){var n=b.globals.trackManager.resolveTrackInfo(a.uri);if(n?.tags?.kind===i.THREAD_SLICE_TRACK_KIND){n=n?.tags?.trackIds;if(n&&0<n.length&&n[0]===t){r=a.key;break}}}return r}async threadStateDetails(e){var e=await this.args.engine.query(`
      SELECT
        ts,
        thread_state.dur as dur
      from thread_state
      where thread_state.id = ${e}
    `),t=(0,T.getLegacySelection)(b.globals.state);0<e.numRows()&&t&&(t=e.firstRow({ts:E.LONG,dur:E.LONG}),e={ts:l.Time.fromRaw(t.ts),dur:t.dur},(0,v.publishThreadStateDetails)(e))}async schedSliceDetails(e){var t=await this.args.engine.query(`
      SELECT
        ts,
        dur,
        priority,
        end_state as endState,
        utid,
        cpu
      FROM sched
      WHERE sched.id = ${e}
    `),r=(0,T.getLegacySelection)(b.globals.state);if(0<t.numRows()&&r){var r=t.firstRow({ts:E.LONG,dur:E.LONG,priority:E.NUM,endState:E.STR_NULL,utid:E.NUM,cpu:E.NUM}),t=l.Time.fromRaw(r.ts),n=r.dur,a=r.priority,i=r.endState,o=r.utid;const s={ts:t,dur:n,priority:a,endState:i,cpu:r.cpu,id:e,utid:o};s.threadStateId=await async function(e,t){t=`
    SELECT
      thread_state.id as threadStateId
    FROM sched
    JOIN thread_state USING(ts, utid, cpu)
    WHERE sched.id = ${t}
  `,e=await e.query(t);if(1===e.numRows())return e.firstRow({threadStateId:E.NUM}).threadStateId}(this.args.engine,e),Object.assign(s,await this.computeThreadDetails(o)),this.schedulingDetails(t,o).then(e=>{Object.assign(s,e)}).finally(()=>{(0,v.publishSliceDetails)(s)})}}async schedulingDetails(e,t){var r=await this.args.engine.query(`
      select ts, waker_utid as wakerUtid
      from thread_state
      where utid = ${t} and ts < ${e} and state = 'R'
      order by ts desc
      limit 1
    `);if(0!==r.numRows()){var r=r.firstRow({ts:E.LONG,wakerUtid:E.NUM_NULL}),n=r.ts,r=r.wakerUtid;if(null!==r){t=await this.args.engine.query(`
      select ts
      from sched
      where utid = ${t} and ts < ${e}
      order by ts desc
      limit 1
    `);if(!(0!==t.numRows()&&n<t.firstRow({ts:E.LONG}).ts)){e=await this.args.engine.query(`
      select cpu
      from sched
      where
        utid = ${r} and
        ts < ${n} and
        ts + dur >= ${n};
    `);if(0!==e.numRows())return{wakeupTs:n,wakerUtid:r,wakerCpu:e.firstRow({cpu:E.NUM}).cpu}}}}}async computeThreadDetails(e){var e=(await this.args.engine.query(`
      SELECT tid, name, upid
      FROM thread
      WHERE utid = ${e};
    `)).firstRow({tid:E.NUM,name:E.STR_NULL,upid:E.NUM_NULL}),t={tid:e.tid,threadName:e.name??void 0};return e.upid?Object.assign({},t,await this.computeProcessDetails(e.upid)):t}async computeProcessDetails(e){e=(await this.args.engine.query(`
      include perfetto module android.process_metadata;
      select
        p.pid,
        p.name,
        p.uid,
        m.package_name as packageName,
        m.version_code as versionCode
      from process p
      left join android_process_metadata m using (upid)
      where p.upid = ${e};
    `)).firstRow({pid:E.NUM,uid:E.NUM_NULL,packageName:E.STR_NULL,versionCode:E.NUM_NULL});return{pid:e.pid,uid:(0,t.fromNumNull)(e.uid),packageName:e.packageName??void 0,versionCode:(0,t.fromNumNull)(e.versionCode)}}}US.SelectionController=e}return US}var jS,HS={};var GS,VS,WS,qS,$S={};function zS(){if(GS)return $S;GS=1,Object.defineProperty($S,"__esModule",{value:!0}),$S.decideTracks=async function(e){return new O(e).decideTracks()};const h=Er(),r=ee(),n=J(),g=ne(),m=Y(),i=oe(),_=ue(),f=ms(),y=Z(),t=p0(),a=hm(),o=Tb(),d=Q(),p="mem.dma_heap",T="mem.ion",s=new RegExp("^io.ufs.command.tag.*$"),l=new RegExp("^Wakelock.*$"),c=new RegExp("^.* (Received|Transmitted)( KB)?$"),u=new RegExp("^Entity residency:"),b=new RegExp("^UCLAMP_"),v=new RegExp("^power."),E=new RegExp("^.* Temperature$"),S=new RegExp("^(Irq|SoftIrq) Cpu.*"),A=new RegExp("^Chrome.*|^InputLatency::.*");class O{engine;upidToUuid=new Map;utidToUuid=new Map;tracksToAdd=[];tracksToPin=[];addTrackGroupActions=[];constructor(e){this.engine=e}async getAndroidCpuClusterTypes(){var e=new Map;await this.engine.query(`
      include perfetto module android.cpu.cluster_type;
    `);for(var t=(await this.engine.query(`
      select cpu, cluster_type as clusterType
      from android_cpu_cluster_mapping
    `)).iter({cpu:y.NUM,clusterType:y.STR_NULL});t.valid();t.next()){var r=t.clusterType;null!==r&&e.set(t.cpu,r)}return e}async addCpuSchedulingTracks(){var e=i.globals.traceContext.cpus,t=await this.getAndroidCpuClusterTypes();for(const n of e){var r=t.get(n),r=void 0===r?"Cpu "+n:`Cpu ${n} (${r})`;this.tracksToAdd.push({uri:"/sched_cpu"+n,trackSortKey:_.PrimaryTrackSortKey.ORDINARY_TRACK,name:r,trackGroup:m.SCROLLING_TRACK_GROUP})}}async addCpuFreqTracks(e){for(const t of i.globals.traceContext.cpus)0<(await e.query(`
        select
          id as cpuFreqId,
          (
            select id
            from cpu_counter_track
            where name = 'cpuidle'
            and cpu = ${t}
            limit 1
          ) as cpuIdleId
        from cpu_counter_track
        join _counter_track_summary using (id)
        where name = 'cpufreq' and cpu = ${t}
        limit 1;
      `)).numRows()&&this.tracksToAdd.push({uri:"/cpu_freq_cpu"+t,trackSortKey:_.PrimaryTrackSortKey.ORDINARY_TRACK,name:`Cpu ${t} Frequency`,trackGroup:m.SCROLLING_TRACK_GROUP})}async addGlobalAsyncTracks(e){for(var t=(await e.query(`
      with global_tracks_grouped as (
        select distinct t.parent_id, t.name
        from track t
        join _slice_track_summary using (id)
        where t.type in ('track', 'gpu_track', 'cpu_track')
      )
      select
        t.name as name,
        t.parent_id as parentId,
        p.name as parentName
      from global_tracks_grouped AS t
      left join track p on (t.parent_id = p.id)
      order by p.name, t.name
    `)).iter({name:y.STR_NULL,parentId:y.NUM_NULL,parentName:y.STR_NULL}),r=new Map;t.valid();t.next()){var n,a=d.ASYNC_SLICE_TRACK_KIND,i=null===t.name?void 0:t.name,o=null===t.parentName?void 0:t.parentName,s=(0,f.getTrackName)({name:i,kind:a}),l=t.parentId;let e=m.SCROLLING_TRACK_GROUP;null!==l&&(void 0===(n=r.get(l))?(e=(0,h.v4)(),r.set(l,e),l=(0,f.getTrackName)({name:o,kind:a}),this.addTrackGroupActions.push(g.Actions.addTrackGroup({name:l,key:e,collapsed:!0}))):e=n);o={uri:`/async_slices_${i}_`+t.parentId,trackSortKey:_.PrimaryTrackSortKey.ASYNC_SLICE_TRACK,trackGroup:e,name:s};this.tracksToAdd.push(o)}}async addGpuFreqTracks(t){var r=i.globals.traceContext.gpuCount;for(let e=0;e<r;e++)0<(await t.query(`
        select *
        from gpu_counter_track
        join _counter_track_summary using (id)
        where name = 'gpufreq' and gpu_id = ${e}
        limit 1;
      `)).numRows()&&this.tracksToAdd.push({uri:"/gpu_frequency_"+e,name:`Gpu ${e} Frequency`,trackSortKey:_.PrimaryTrackSortKey.COUNTER_TRACK,trackGroup:m.SCROLLING_TRACK_GROUP})}async addCpuFreqLimitCounterTracks(e){this.addCpuCounterTracks(e,`
      select name, id
      from cpu_counter_track
      join _counter_track_summary using (id)
      where name glob "Cpu * Freq Limit"
      order by name asc
    `)}async addCpuPerfCounterTracks(e){this.addCpuCounterTracks(e,`
      select printf("Cpu %u %s", cpu, name) as name, id
      from perf_counter_track as pct
      join _counter_track_summary using (id)
      order by perf_session_id asc, pct.name asc, cpu asc
    `)}async addCpuCounterTracks(e,t){for(var r=(await e.query(t)).iter({name:y.STR,id:y.NUM});r.valid();r.next()){var n=r.name,a=r.id;this.tracksToAdd.push({uri:"/cpu_counter_"+a,name:n,trackSortKey:_.PrimaryTrackSortKey.COUNTER_TRACK,trackGroup:m.SCROLLING_TRACK_GROUP})}}async groupGlobalIonTracks(){var t=[];let e=!1;for(const c of this.tracksToAdd){var r=c.name.startsWith(T),n=c.name===T,a=c.name===p,i="mem.dma_buffer"===c.name;(r||n||a||i)&&t.push(c),e=(e=e||n)||a}if(0!==t.length&&e){var o=(0,h.v4)(),s=(0,h.v4)();let e=!1;for(const u of t)!e&&[p,T].includes(u.name)?(e=!0,u.key=s,u.trackGroup=void 0):u.trackGroup=o;var l=g.Actions.addTrackGroup({summaryTrackKey:s,name:p,key:o,collapsed:!0});this.addTrackGroupActions.push(l)}}async groupGlobalIostatTracks(e,t){var r=[],n=new Map;for(const s of this.tracksToAdd)s.name.startsWith(e)&&r.push(s);if(0!==r.length){for(const l of r){var a=l.name.split(".",3);n.has(a[1])||n.set(a[1],(0,h.v4)()),l.name=a[2],l.trackGroup=n.get(a[1])}for(var[i,o]of n){i=t+i,i=g.Actions.addTrackGroup({name:i,key:o,collapsed:!0});this.addTrackGroupActions.push(i)}}}async groupGlobalBuddyInfoTracks(){var e=[],t=new Map;for(const s of this.tracksToAdd)s.name.startsWith("mem.buddyinfo")&&e.push(s);if(0!==e.length){for(const l of e){var r=l.name.split("["),n=r[1].slice(0,-1),a=r[2].slice(0,-1),r=r[3].slice(0,-1),n="Buddyinfo:  Node: "+n+" Zone: "+a;t.has(n)||t.set(n,(0,h.v4)()),l.name="Chunk size: "+r,l.trackGroup=t.get(n)}for(var[i,o]of t){i=g.Actions.addTrackGroup({name:i,key:o,collapsed:!0});this.addTrackGroupActions.push(i)}}}async groupFrequencyTracks(e){let t=void 0;for(const r of this.tracksToAdd)!r.name.endsWith("Frequency")||r.name.startsWith("Cpu")||r.name.startsWith("Gpu")||void 0!==r.trackGroup&&r.trackGroup!==m.SCROLLING_TRACK_GROUP||(void 0===t&&(t=(0,h.v4)()),r.trackGroup=t);void 0!==t&&(e=g.Actions.addTrackGroup({name:e,key:t,collapsed:!0}),this.addTrackGroupActions.push(e))}async groupMiscNonAllowlistedTracks(e){var t=[new RegExp("^Cpu .*$","i"),new RegExp("^Gpu .*$","i"),new RegExp("^Trace Triggers$"),new RegExp("^Android App Startups$"),new RegExp("^Device State.*$"),new RegExp("^Android logs$")];let r=void 0;for(const n of this.tracksToAdd)if(void 0===n.trackGroup||n.trackGroup===m.SCROLLING_TRACK_GROUP){let e=!1;for(const a of t)e=e||a.test(n.name);e||(void 0===r&&(r=(0,h.v4)()),n.trackGroup=r)}void 0!==r&&(e=g.Actions.addTrackGroup({name:e,key:r,collapsed:!0}),this.addTrackGroupActions.push(e))}async groupTracksByRegex(e,t){let r=void 0;for(const n of this.tracksToAdd)!e.test(n.name)||void 0!==n.trackGroup&&n.trackGroup!==m.SCROLLING_TRACK_GROUP||(void 0===r&&(r=(0,h.v4)()),n.trackGroup=r);void 0!==r&&(t=g.Actions.addTrackGroup({name:t,key:r,collapsed:!0}),this.addTrackGroupActions.push(t))}async addAnnotationTracks(e){for(var t,r,n=(await e.query(`
      select id, name, upid, group_name
      from annotation_slice_track
      order by name
    `)).iter({id:y.NUM,name:y.STR,upid:y.NUM,group_name:y.STR_NULL}),a=new Map;n.valid();n.next()){var i=n.id,o=n.name,s=n.upid,l=n.group_name;let e=void 0,t=0===s?m.SCROLLING_TRACK_GROUP:this.upidToUuid.get(s);l&&((s=a.get(l))?t=s.id:(t=(0,h.v4)(),e=(0,h.v4)(),a.set(l,{id:t,summaryTrackKey:e}))),this.tracksToAdd.push({uri:"/annotation_"+i,key:e,name:o,trackSortKey:_.PrimaryTrackSortKey.ORDINARY_TRACK,trackGroup:t})}for([t,r]of a){var c=g.Actions.addTrackGroup({summaryTrackKey:r.summaryTrackKey,name:t,key:r.id,collapsed:!0});this.addTrackGroupActions.push(c)}for(var u=(await e.query(`
      SELECT id, name, upid FROM annotation_counter_track
    `)).iter({id:y.NUM,name:y.STR,upid:y.NUM});u.valid();u.next()){var d=u.id,f=u.name,p=u.upid;this.tracksToAdd.push({uri:"/annotation_counter_"+d,name:f,trackSortKey:_.PrimaryTrackSortKey.COUNTER_TRACK,trackGroup:0===p?m.SCROLLING_TRACK_GROUP:this.upidToUuid.get(p)})}}async addThreadStateTracks(e){for(var t=(await e.query(`
      select
        utid,
        upid,
        tid,
        thread.name as threadName
      from thread
      join _sched_summary using (utid)
    `)).iter({utid:y.NUM,upid:y.NUM_NULL,tid:y.NUM_NULL,threadName:y.STR_NULL});t.valid();t.next()){var r,n=t.utid,a=t.tid,i=t.upid,o=t.threadName,s=this.getUuidUnchecked(n,i);void 0!==s&&(r=m.InThreadTrackSortKey.THREAD_SCHEDULING_STATE_TRACK,a=(0,f.getTrackName)({utid:n,tid:a,threadName:o,kind:d.THREAD_STATE_TRACK_KIND}),this.tracksToAdd.push({uri:(0,f.getThreadUriPrefix)(i,n)+"_state",name:a,trackGroup:s,trackSortKey:{utid:n,priority:r}}))}}async addThreadCpuSampleTracks(e){for(var t=(await e.query(`
      with thread_cpu_sample as (
        select distinct utid
        from cpu_profile_stack_sample
        where utid != 0
      )
      select
        utid,
        tid,
        upid,
        thread.name as threadName
      from thread_cpu_sample
      join thread using(utid)`)).iter({utid:y.NUM,upid:y.NUM_NULL,tid:y.NUM_NULL,threadName:y.STR_NULL});t.valid();t.next()){var r=t.utid,n=t.upid,a=t.threadName,i=this.getUuid(r,n);this.tracksToAdd.push({uri:(0,f.getThreadUriPrefix)(n,r)+"_cpu_samples",trackSortKey:{utid:r,priority:m.InThreadTrackSortKey.CPU_STACK_SAMPLES_TRACK},name:a+" (CPU Stack Samples)",trackGroup:i})}}async addThreadCounterTracks(e){for(var t=(await e.query(`
      select
        thread_counter_track.name as trackName,
        utid,
        upid,
        tid,
        thread.name as threadName,
        thread_counter_track.id as trackId
      from thread_counter_track
      join _counter_track_summary using (id)
      join thread using (utid)
      where thread_counter_track.name != 'thread_time'
  `)).iter({trackName:y.STR_NULL,utid:y.NUM,upid:y.NUM_NULL,tid:y.NUM_NULL,threadName:y.STR_NULL,trackId:y.NUM});t.valid();t.next()){var r=t.utid,n=t.tid,a=t.upid,i=t.trackId,o=t.trackName,s=t.threadName,l=this.getUuid(r,a),o=(0,f.getTrackName)({name:o,utid:r,tid:n,kind:d.COUNTER_TRACK_KIND,threadName:s,threadTrack:!0});this.tracksToAdd.push({uri:(0,f.getThreadUriPrefix)(a,r)+"_counter_"+i,name:o,trackSortKey:{utid:r,priority:m.InThreadTrackSortKey.ORDINARY},trackGroup:l})}}async addProcessAsyncSliceTracks(e){for(var t=(await e.query(`
      select
        upid,
        t.name as trackName,
        t.track_ids as trackIds,
        process.name as processName,
        process.pid as pid
      from _process_track_summary_by_upid_and_name t
      join process using(upid)
      where t.name is null or t.name not glob "* Timeline"
    `)).iter({upid:y.NUM,trackName:y.STR_NULL,trackIds:y.STR,processName:y.STR_NULL,pid:y.NUM_NULL});t.valid();t.next()){var r=t.upid,n=t.trackName,a=t.trackIds,i=t.processName,o=t.pid,s=this.getUuid(null,r),n=(0,f.getTrackName)({name:n,upid:r,pid:o,processName:i,kind:d.ASYNC_SLICE_TRACK_KIND});this.tracksToAdd.push({uri:`/process_${r}/async_slices_`+a,name:n,trackSortKey:_.PrimaryTrackSortKey.ASYNC_SLICE_TRACK,trackGroup:s})}}async addUserAsyncSliceTracks(e){for(var t,r,n,a,i,o,s=(await e.query(`
      with grouped_packages as materialized (
        select
          uid,
          group_concat(package_name, ',') as package_name,
          count() as cnt
        from package_list
        group by uid
      )
      select
        t.name as name,
        t.uid as uid,
        iif(g.cnt = 1, g.package_name, 'UID ' || g.uid) as packageName
      from _uid_track_track_summary_by_uid_and_name t
      left join grouped_packages g using (uid)
    `)).iter({name:y.STR_NULL,uid:y.NUM_NULL,packageName:y.STR_NULL}),l=new Map;s.valid();s.next())null!=s.name&&null!=s.uid&&(t=s.name,r=null===s.uid?void 0:s.uid,n=null===s.packageName?"UID "+r:s.packageName,a="uid-track-group"+t,void 0===l.get(t)&&l.set(t,a),this.tracksToAdd.push({uri:`/async_slices_${t}_`+r,name:n,trackSortKey:_.PrimaryTrackSortKey.ASYNC_SLICE_TRACK,trackGroup:a}));for([i,o]of l){var c=g.Actions.addTrackGroup({name:i,key:o,collapsed:!0});this.addTrackGroupActions.push(c)}}async addActualFramesTracks(e){for(var t=(await e.query(`
      select
        upid,
        t.name as trackName,
        process.name as processName,
        process.pid as pid
      from _process_track_summary_by_upid_and_name t
      join process using(upid)
      where t.name = "Actual Timeline"
    `)).iter({upid:y.NUM,trackName:y.STR_NULL,processName:y.STR_NULL,pid:y.NUM_NULL});t.valid();t.next()){var r=t.upid,n=t.trackName,a=t.processName,i=t.pid,o=this.getUuid(null,r),s=d.ACTUAL_FRAMES_SLICE_TRACK_KIND,n=(0,f.getTrackName)({name:n,upid:r,pid:i,processName:a,kind:s});this.tracksToAdd.push({uri:`/process_${r}/actual_frames`,name:n,trackSortKey:_.PrimaryTrackSortKey.ACTUAL_FRAMES_SLICE_TRACK,trackGroup:o})}}async addExpectedFramesTracks(e){for(var t=(await e.query(`
      select
        upid,
        t.name as trackName,
        process.name as processName,
        process.pid as pid
      from _process_track_summary_by_upid_and_name t
      join process using(upid)
      where t.name = "Expected Timeline"
    `)).iter({upid:y.NUM,trackName:y.STR_NULL,processName:y.STR_NULL,pid:y.NUM_NULL});t.valid();t.next()){var r=t.upid,n=t.trackName,a=t.processName,i=t.pid,o=this.getUuid(null,r),s=d.EXPECTED_FRAMES_SLICE_TRACK_KIND,n=(0,f.getTrackName)({name:n,upid:r,pid:i,processName:a,kind:s});this.tracksToAdd.push({uri:`/process_${r}/expected_frames`,name:n,trackSortKey:_.PrimaryTrackSortKey.EXPECTED_FRAMES_SLICE_TRACK,trackGroup:o})}}async addThreadSliceTracks(e){for(var t=(await e.query(`
      select
        thread_track.utid as utid,
        thread_track.id as trackId,
        thread_track.name as trackName,
        EXTRACT_ARG(thread_track.source_arg_set_id,
                    'is_root_in_scope') as isDefaultTrackForScope,
        tid,
        thread.name as threadName,
        thread.upid as upid
      from thread_track
      join _slice_track_summary using (id)
      join thread using(utid)
  `)).iter({utid:y.NUM,trackId:y.NUM,trackName:y.STR_NULL,isDefaultTrackForScope:y.NUM_NULL,tid:y.NUM_NULL,threadName:y.STR_NULL,upid:y.NUM_NULL});t.valid();t.next()){var{utid:r,trackId:n,trackName:a,tid:i,threadName:o,upid:s}=t,l=!!t.isDefaultTrackForScope,c=this.getUuid(r,s),u=d.THREAD_SLICE_TRACK_KIND,a=(0,f.getTrackName)({name:a,utid:r,tid:i,threadName:o,kind:u});this.tracksToAdd.push({uri:(0,f.getThreadUriPrefix)(s,r)+"_slice_"+n,name:a,trackGroup:c,trackSortKey:{utid:r,priority:l?m.InThreadTrackSortKey.DEFAULT_TRACK:m.InThreadTrackSortKey.ORDINARY}})}}async addProcessCounterTracks(e){var t=(await e.query(`
      select
        process_counter_track.id as trackId,
        process_counter_track.name as trackName,
        upid,
        process.pid,
        process.name as processName
      from process_counter_track
      join _counter_track_summary using (id)
      join process using(upid);
  `)).iter({trackId:y.NUM,trackName:y.STR_NULL,upid:y.NUM,pid:y.NUM_NULL,processName:y.STR_NULL});for(let e=0;t.valid();++e,t.next()){var r=t.pid,n=t.upid,a=t.trackId,i=t.trackName,o=t.processName,s=this.getUuid(null,n),r=(0,f.getTrackName)({name:i,upid:n,pid:r,kind:d.COUNTER_TRACK_KIND,processName:o});this.tracksToAdd.push({uri:`/process_${n}/counter_`+a,name:r,trackSortKey:await this.resolveTrackSortKeyForProcessCounterTrack(n,i??void 0),trackGroup:s})}}async addProcessHeapProfileTracks(e){for(var t=(await e.query(`
      select upid
      from _process_available_info_summary
      where allocation_count > 0 or graph_object_count > 0
  `)).iter({upid:y.NUM});t.valid();t.next()){var r=t.upid,n=this.getUuid(null,r);this.tracksToAdd.push({uri:`/process_${r}/heap_profile`,trackSortKey:_.PrimaryTrackSortKey.HEAP_PROFILE_TRACK,name:"Heap Profile",trackGroup:n})}}async addProcessPerfSamplesTracks(e){for(var t=(await e.query(`
      select upid
      from _process_available_info_summary
      where perf_sample_count > 0
    `)).iter({upid:y.NUM});t.valid();t.next()){var r=t.upid,n=this.getUuid(null,r);this.tracksToAdd.push({uri:`/process_${r}/perf_samples_profile`,trackSortKey:_.PrimaryTrackSortKey.PERF_SAMPLES_PROFILE_TRACK,name:"Process Callstacks",trackGroup:n})}}async addThreadPerfSamplesTracks(e){for(var t=(await e.query(`
      select
        thread.upid,
        thread.utid,
        thread.tid,
        thread.name as threadName
      from _thread_available_info_summary s
      join thread using (utid)
      where s.perf_sample_count > 0
    `)).iter({upid:y.NUM_NULL,utid:y.NUM,tid:y.NUM,threadName:y.STR_NULL});t.valid();t.next()){var{threadName:r,upid:n,utid:a,tid:i}=t,r=null===r?"Thread Callstacks "+i:r+" Callstacks "+i,i=this.getUuid(a,n);this.tracksToAdd.push({uri:(0,f.getThreadUriPrefix)(n,a)+"_perf_samples_profile",trackSortKey:_.PrimaryTrackSortKey.PERF_SAMPLES_PROFILE_TRACK,name:r,trackGroup:i})}}getUuidUnchecked(e,t){return null===t?this.utidToUuid.get(e):this.upidToUuid.get(t)}getUuid(e,t){return(0,r.assertExists)(this.getUuidUnchecked(e,t))}getOrCreateUuid(e,t){let r=this.getUuidUnchecked(e,t);return void 0===r&&(r=(0,h.v4)(),null===t?this.utidToUuid.set(e,r):this.upidToUuid.set(t,r)),r}setUuidForUpid(e,t){this.upidToUuid.set(e,t)}async addKernelThreadGrouping(e){var t=(await e.query(`
      select
        t.utid, p.upid, (case p.pid when 2 then 1 else 0 end) isKthreadd
      from
        thread t
        join process p using (upid)
        left join process parent on (p.parent_upid = parent.upid)
        join
          (select true from metadata m
             where (m.name = 'system_name' and m.str_value = 'Linux')
           union
           select 1 from (select true from sched limit 1))
      where
        p.pid = 2 or parent.pid = 2
      order by isKthreadd desc
    `)).iter({utid:y.NUM,upid:y.NUM});if(t.valid()){var r=(0,h.v4)(),e=(0,h.v4)(),e=(this.tracksToAdd.push({uri:"/kernel",key:e,trackSortKey:_.PrimaryTrackSortKey.PROCESS_SUMMARY_TRACK,name:"Kernel thread summary"}),g.Actions.addTrackGroup({summaryTrackKey:e,name:"Kernel threads",key:r,collapsed:!0}));for(this.addTrackGroupActions.push(e);t.valid();t.next())this.setUuidForUpid(t.upid,r)}}async addProcessTrackGroups(e){for(var t=(await e.query(`
      with processGroups as (
        select
          upid,
          process.pid as pid,
          process.name as processName,
          sum_running_dur as sumRunningDur,
          thread_slice_count + process_slice_count as sliceCount,
          perf_sample_count as perfSampleCount,
          allocation_count as heapProfileAllocationCount,
          graph_object_count as heapGraphObjectCount,
          (
            select group_concat(string_value)
            from args
            where
              process.arg_set_id is not null and
              arg_set_id = process.arg_set_id and
              flat_key = 'chrome.process_label'
          ) chromeProcessLabels,
          case process.name
            when 'Browser' then 3
            when 'Gpu' then 2
            when 'Renderer' then 1
            else 0
          end as chromeProcessRank
        from _process_available_info_summary
        join process using(upid)
      ),
      threadGroups as (
        select
          utid,
          tid,
          thread.name as threadName,
          sum_running_dur as sumRunningDur,
          slice_count as sliceCount,
          perf_sample_count as perfSampleCount
        from _thread_available_info_summary
        join thread using (utid)
        where upid is null
      )
      select *
      from (
        select
          upid,
          null as utid,
          pid,
          null as tid,
          processName,
          null as threadName,
          sumRunningDur > 0 as hasSched,
          heapProfileAllocationCount > 0
            or heapGraphObjectCount > 0 as hasHeapInfo,
          ifnull(chromeProcessLabels, '') as chromeProcessLabels
        from processGroups
        order by
          chromeProcessRank desc,
          heapProfileAllocationCount desc,
          heapGraphObjectCount desc,
          perfSampleCount desc,
          sumRunningDur desc,
          sliceCount desc,
          processName asc,
          upid asc
      )
      union all
      select *
      from (
        select
          null,
          utid,
          null as pid,
          tid,
          null as processName,
          threadName,
          sumRunningDur > 0 as hasSched,
          0 as hasHeapInfo,
          '' as chromeProcessLabels
        from threadGroups
        order by
          perfSampleCount desc,
          sumRunningDur desc,
          sliceCount desc,
          threadName asc,
          utid asc
      )
  `)).iter({upid:y.NUM_NULL,utid:y.NUM_NULL,pid:y.NUM_NULL,tid:y.NUM_NULL,processName:y.STR_NULL,threadName:y.STR_NULL,hasSched:y.NUM_NULL,hasHeapInfo:y.NUM_NULL});t.valid();t.next()){var r=t.utid,n=t.upid,a=t.pid,i=t.tid,o=t.threadName,s=t.processName,l=!!t.hasSched,c=!!t.hasHeapInfo,u=(0,h.v4)(),d=(0,f.getThreadOrProcUri)(n,r);void 0===(null===n?this.utidToUuid.get(r):this.upidToUuid.get(n))&&(this.tracksToAdd.push({uri:d,key:u,trackSortKey:l?_.PrimaryTrackSortKey.PROCESS_SCHEDULING_TRACK:_.PrimaryTrackSortKey.PROCESS_SUMMARY_TRACK,name:`${null===n?i:a} summary`}),d=(0,f.getTrackName)({utid:r,processName:s,pid:a,threadName:o,tid:i,upid:n}),s=g.Actions.addTrackGroup({summaryTrackKey:u,name:"/"===(l=d)[0]?l.split("/").slice(-1)[0]:l,key:this.getOrCreateUuid(r,n),collapsed:!c}),this.addTrackGroupActions.push(s))}}async computeThreadOrderingMetadata(){for(var e=(await this.engine.query(`
      select
        utid,
        tid,
        (select pid from process p where t.upid = p.upid) as pid,
        t.name as threadName
      from thread t
    `)).iter({utid:y.NUM,tid:y.NUM_NULL,pid:y.NUM_NULL,threadName:y.STR_NULL}),t={};e.valid();e.next())t[e.utid]={tid:null===e.tid?void 0:e.tid,sortKey:O.getThreadSortKey(e.threadName,e.tid,e.pid)};return t}addPluginTracks(){var t=new Map;for(const a of i.globals.trackManager.findPotentialTracks()){var r=a.groupName;let e=m.SCROLLING_TRACK_GROUP;r&&((n=t.get(r))?e=n:(e=(0,h.v4)(),n=g.Actions.addTrackGroup({name:r,key:e,collapsed:!0,fixedOrdering:!0}),this.addTrackGroupActions.push(n),t.set(r,e)));var n=(0,h.v4)();this.tracksToAdd.push({uri:a.uri,name:a.title,key:n,trackSortKey:a.sortKey??_.PrimaryTrackSortKey.ORDINARY_TRACK,trackGroup:e}),a.isPinned&&this.tracksToPin.push(n)}}async addScrollJankPluginTracks(){var e;t.ENABLE_SCROLL_JANK_PLUGIN_V2.get()&&(e=await(0,t.getScrollJankTracks)(this.engine),this.tracksToAdd=this.tracksToAdd.concat(e.tracks.tracksToAdd),this.addTrackGroupActions.push(e.addTrackGroup))}async decideTracks(){var e=(0,o.decideTracks)(this.engine),e=(null!==e&&(e=(await e)["tracksToAdd"],this.tracksToAdd.push(...e)),await this.addScrollJankPluginTracks(),await this.addCpuSchedulingTracks(),await this.addCpuFreqTracks(this.engine.getProxy("TrackDecider::addCpuFreqTracks")),await this.addGlobalAsyncTracks(this.engine.getProxy("TrackDecider::addGlobalAsyncTracks")),await this.addGpuFreqTracks(this.engine.getProxy("TrackDecider::addGpuFreqTracks")),await this.addCpuFreqLimitCounterTracks(this.engine.getProxy("TrackDecider::addCpuFreqLimitCounterTracks")),await this.addCpuPerfCounterTracks(this.engine.getProxy("TrackDecider::addCpuPerfCounterTracks")),this.addPluginTracks(),await this.addAnnotationTracks(this.engine.getProxy("TrackDecider::addAnnotationTracks")),await this.groupGlobalIonTracks(),await this.groupGlobalIostatTracks("f2fs_iostat.","f2fs_iostat"),await this.groupGlobalIostatTracks("f2fs_iostat_latency.","f2fs_iostat_latency"),await this.groupGlobalIostatTracks("diskstat.","diskstat"),await this.groupTracksByRegex(s,"io.ufs.command.tags"),await this.groupGlobalBuddyInfoTracks(),await this.groupTracksByRegex(l,"Kernel wakelocks"),await this.groupTracksByRegex(c,"Networking"),await this.groupTracksByRegex(u,"Entity residency"),await this.groupTracksByRegex(b,"Scheduler Utilization Clamping"),await this.groupFrequencyTracks("Frequency Scaling"),await this.groupTracksByRegex(v,"Power Rails"),await this.groupTracksByRegex(E,"Temperature"),await this.groupTracksByRegex(S,"IRQs"),await this.groupTracksByRegex(A,"Chrome Global Tracks"),await this.groupMiscNonAllowlistedTracks("Misc Global Tracks"),await this.addUserAsyncSliceTracks(this.engine.getProxy("TrackDecider::addUserAsyncSliceTracks")),await this.addKernelThreadGrouping(this.engine.getProxy("TrackDecider::addKernelThreadGrouping")),await this.addProcessTrackGroups(this.engine.getProxy("TrackDecider::addProcessTrackGroups")),await this.addProcessHeapProfileTracks(this.engine.getProxy("TrackDecider::addProcessHeapProfileTracks")),await this.addProcessPerfSamplesTracks(this.engine.getProxy("TrackDecider::addProcessPerfSamplesTracks")),await this.addThreadPerfSamplesTracks(this.engine.getProxy("TrackDecider::addThreadPerfSamplesTracks")),await this.addProcessCounterTracks(this.engine.getProxy("TrackDecider::addProcessCounterTracks")),await this.addProcessAsyncSliceTracks(this.engine.getProxy("TrackDecider::addProcessAsyncSliceTracks")),await this.addActualFramesTracks(this.engine.getProxy("TrackDecider::addActualFramesTracks")),await this.addExpectedFramesTracks(this.engine.getProxy("TrackDecider::addExpectedFramesTracks")),await this.addThreadCounterTracks(this.engine.getProxy("TrackDecider::addThreadCounterTracks")),await this.addThreadStateTracks(this.engine.getProxy("TrackDecider::addThreadStateTracks")),await this.addThreadSliceTracks(this.engine.getProxy("TrackDecider::addThreadSliceTracks")),await this.addThreadCpuSampleTracks(this.engine.getProxy("TrackDecider::addThreadCpuSampleTracks")),(0,a.decideTracks)(this.engine,(e,t)=>this.getUuid(e,t)));null!==e&&(e=(await e)["tracksToAdd"],this.tracksToAdd.push(...e)),this.addTrackGroupActions.push(g.Actions.addTracks({tracks:this.tracksToAdd}));for(const t of this.tracksToPin)this.addTrackGroupActions.push(g.Actions.toggleTrackPinned({trackKey:t}));e=await this.computeThreadOrderingMetadata();return this.addTrackGroupActions.push(g.Actions.setUtidToTrackSortKey({threadOrderingMetadata:e})),this.addTrackGroupActions}async resolveTrackSortKeyForProcessCounterTrack(e,t){return"GPU completion"===t&&(e=(await this.engine.query(`
      select utid
      from thread
      where upid=${e} and name=${(0,n.sqliteString)(t)}
    `)).iter({utid:y.NUM}))?{utid:e.utid,priority:m.InThreadTrackSortKey.THREAD_COUNTER_TRACK}:_.PrimaryTrackSortKey.COUNTER_TRACK}static getThreadSortKey(e,t,r){if(null!=r&&r===t)return _.PrimaryTrackSortKey.MAIN_THREAD;if(null==e)return _.PrimaryTrackSortKey.ORDINARY_THREAD;if("CrBrowserMain"===e||"CrRendererMain"===e||"CrGpuMain"===e)return _.PrimaryTrackSortKey.MAIN_THREAD;if("Chrome_ChildIOThread"===e||"Chrome_IOThread"===e)return _.PrimaryTrackSortKey.CHROME_IO_THREAD;if("Compositor"===e||"VizCompositorThread"===e)return _.PrimaryTrackSortKey.CHROME_COMPOSITOR_THREAD;switch(!0){case/.*RenderThread.*/.test(e):return _.PrimaryTrackSortKey.RENDER_THREAD;case/.*GPU completion.*/.test(e):return _.PrimaryTrackSortKey.GPU_COMPLETION_THREAD;default:return _.PrimaryTrackSortKey.ORDINARY_THREAD}}}return $S}function KS(){if(!VS){VS=1,Object.defineProperty(UE,"__esModule",{value:!0}),UE.TraceController=void 0,or.__importDefault(ae());const g=ee(),m=K(),_=ne(),r=jE(),y=Aa(),T=gp(),n=Y(),a=re(),b=oe(),v=CT(),E=up(),S=So(),A=KE(),O=Z(),C=ZE(),i=(de(),function(){if(!XE){XE=1,Object.defineProperty(eS,"__esModule",{value:!0}),eS.CounterAggregationController=void 0;const l=K(),c=oe(),u=ue();class e extends rS().AggregationController{async createAggregateView(e,t){var r=[];for(const s of t.tracks){var n=c.globals.state.tracks[s];n?.uri&&(n=c.globals.trackManager.resolveTrackInfo(n.uri))?.tags?.kind===u.COUNTER_TRACK_KIND&&n.tags?.trackIds&&r.push(...n.tags.trackIds)}if(0===r.length)return!1;var a=t.end-t.start,i=l.Duration.toSeconds(a);let o;return o=1===r.length?`CREATE OR REPLACE PERFETTO TABLE ${this.kind} AS
      WITH aggregated AS (
        SELECT
          COUNT(1) AS count,
          ROUND(SUM(
            (MIN(ts + dur, ${t.end}) - MAX(ts,${t.start}))*value)/${a},
            2
          ) AS avg_value,
          (SELECT value FROM experimental_counter_dur WHERE track_id = ${r[0]}
            AND ts + dur >= ${t.start}
            AND ts <= ${t.end} ORDER BY ts DESC LIMIT 1)
            AS last_value,
          (SELECT value FROM experimental_counter_dur WHERE track_id = ${r[0]}
            AND ts + dur >= ${t.start}
            AND ts <= ${t.end} ORDER BY ts ASC LIMIT 1)
            AS first_value,
          MIN(value) AS min_value,
          MAX(value) AS max_value
        FROM experimental_counter_dur
          WHERE track_id = ${r[0]}
          AND ts + dur >= ${t.start}
          AND ts <= ${t.end})
      SELECT
        (SELECT name FROM counter_track WHERE id = ${r[0]}) AS name,
        *,
        MAX(last_value) - MIN(first_value) AS delta_value,
        ROUND((MAX(last_value) - MIN(first_value))/${i}, 2) AS rate
      FROM aggregated`:`CREATE OR REPLACE PERFETTO TABLE ${this.kind} AS
      WITH aggregated AS (
        SELECT track_id,
          COUNT(1) AS count,
          ROUND(SUM(
            (MIN(ts + dur, ${t.end}) - MAX(ts,${t.start}))*value)/${a},
            2
          ) AS avg_value,
          value_at_max_ts(-ts, value) AS first,
          value_at_max_ts(ts, value) AS last,
          MIN(value) AS min_value,
          MAX(value) AS max_value
        FROM experimental_counter_dur
          WHERE track_id IN (${r})
          AND ts + dur >= ${t.start} AND
          ts <= ${t.end}
        GROUP BY track_id
      )
      SELECT
        name,
        count,
        avg_value,
        last AS last_value,
        first AS first_value,
        last - first AS delta_value,
        ROUND((last - first)/${i}, 2) AS rate,
        min_value,
        max_value
      FROM aggregated JOIN counter_track ON
        track_id = counter_track.id
      GROUP BY track_id`,await e.query(o),!0}getColumnDefinitions(){return[{title:"Name",kind:"STRING",columnConstructor:Uint16Array,columnId:"name"},{title:"Delta value",kind:"NUMBER",columnConstructor:Float64Array,columnId:"delta_value"},{title:"Rate /s",kind:"Number",columnConstructor:Float64Array,columnId:"rate"},{title:"Weighted avg value",kind:"Number",columnConstructor:Float64Array,columnId:"avg_value"},{title:"Count",kind:"Number",columnConstructor:Float64Array,columnId:"count",sum:!0},{title:"First value",kind:"NUMBER",columnConstructor:Float64Array,columnId:"first_value"},{title:"Last value",kind:"NUMBER",columnConstructor:Float64Array,columnId:"last_value"},{title:"Min value",kind:"NUMBER",columnConstructor:Float64Array,columnId:"min_value"},{title:"Max value",kind:"NUMBER",columnConstructor:Float64Array,columnId:"max_value"}]}async getExtra(){}getTabName(){return"Counters"}getDefaultSorting(){return{column:"name",direction:"DESC"}}}eS.CounterAggregationController=e}return eS}()),o=function(){if(!nS){nS=1,Object.defineProperty(aS,"__esModule",{value:!0}),aS.CpuAggregationController=void 0;const i=z(),o=Q(),s=oe();class e extends rS().AggregationController{async createAggregateView(e,t){var r=[];for(const a of t.tracks){var n=s.globals.state.tracks[a];n?.uri&&(n=s.globals.trackManager.resolveTrackInfo(n.uri))?.tags?.kind===o.CPU_SLICE_TRACK_KIND&&(0,i.exists)(n.tags.cpu)&&r.push(n.tags.cpu)}return 0!==r.length&&(await e.query(`
      create or replace perfetto table ${this.kind} as
      select
        process.name as process_name,
        pid,
        thread.name as thread_name,
        tid,
        sum(dur) AS total_dur,
        sum(dur) / count() as avg_dur,
        count() as occurrences
      from process
      join thread using (upid)
      join sched using (utid)
      where cpu in (${r})
        and sched.ts + sched.dur > ${t.start}
        and sched.ts < ${t.end}
        and utid != 0
      group by utid
    `),!0)}getTabName(){return"CPU by thread"}async getExtra(){}getDefaultSorting(){return{column:"total_dur",direction:"DESC"}}getColumnDefinitions(){return[{title:"Process",kind:"STRING",columnConstructor:Uint16Array,columnId:"process_name"},{title:"PID",kind:"NUMBER",columnConstructor:Uint16Array,columnId:"pid"},{title:"Thread",kind:"STRING",columnConstructor:Uint16Array,columnId:"thread_name"},{title:"TID",kind:"NUMBER",columnConstructor:Uint16Array,columnId:"tid"},{title:"Wall duration (ms)",kind:"TIMESTAMP_NS",columnConstructor:Float64Array,columnId:"total_dur",sum:!0},{title:"Avg Wall duration (ms)",kind:"TIMESTAMP_NS",columnConstructor:Float64Array,columnId:"avg_dur"},{title:"Occurrences",kind:"NUMBER",columnConstructor:Uint16Array,columnId:"occurrences",sum:!0}]}}aS.CpuAggregationController=e}return aS}(),s=function(){if(!iS){iS=1,Object.defineProperty(oS,"__esModule",{value:!0}),oS.CpuByProcessAggregationController=void 0;const i=z(),o=oe(),s=Q();class e extends rS().AggregationController{async createAggregateView(e,t){var r=[];for(const a of t.tracks){var n=o.globals.state.tracks[a];n?.uri&&(n=o.globals.trackManager.resolveTrackInfo(n.uri))?.tags?.kind===s.CPU_SLICE_TRACK_KIND&&(0,i.exists)(n.tags.cpu)&&r.push(n.tags.cpu)}return 0!==r.length&&(await e.query(`
      create or replace perfetto table ${this.kind} as
      select
        process.name as process_name,
        process.pid,
        sum(dur) AS total_dur,
        sum(dur) / count() as avg_dur,
        count() as occurrences
      from sched
      join thread USING (utid)
      join process USING (upid)
      where
        cpu in (${r})
        and ts + dur > ${t.start}
        and ts < ${t.end}
        and utid != 0
      group by upid
    `),!0)}getTabName(){return"CPU by process"}async getExtra(){}getDefaultSorting(){return{column:"total_dur",direction:"DESC"}}getColumnDefinitions(){return[{title:"Process",kind:"STRING",columnConstructor:Uint16Array,columnId:"process_name"},{title:"PID",kind:"NUMBER",columnConstructor:Uint16Array,columnId:"pid"},{title:"Wall duration (ms)",kind:"TIMESTAMP_NS",columnConstructor:Float64Array,columnId:"total_dur",sum:!0},{title:"Avg Wall duration (ms)",kind:"TIMESTAMP_NS",columnConstructor:Float64Array,columnId:"avg_dur"},{title:"Occurrences",kind:"NUMBER",columnConstructor:Uint16Array,columnId:"occurrences",sum:!0}]}}oS.CpuByProcessAggregationController=e}return oS}(),l=function(){if(!sS){sS=1,Object.defineProperty(lS,"__esModule",{value:!0}),lS.FrameAggregationController=void 0;const i=Q(),o=oe();class e extends rS().AggregationController{async createAggregateView(e,t){var r=[];for(const a of t.tracks){var n=o.globals.state.tracks[a];void 0!==n?.uri&&(n=o.globals.trackManager.resolveTrackInfo(n.uri))?.tags?.kind===i.ACTUAL_FRAMES_SLICE_TRACK_KIND&&n.tags.trackIds&&r.push(...n.tags.trackIds)}return 0!==r.length&&(await e.query(`
      create or replace perfetto table ${this.kind} as
      select
        jank_type,
        count(1) as occurrences,
        min(dur) as minDur,
        avg(dur) as meanDur,
        max(dur) as maxDur
      from actual_frame_timeline_slice
      where track_id in (${r})
        AND ts + dur > ${t.start}
        AND ts < ${t.end}
      group by jank_type
    `),!0)}getTabName(){return"Frames"}async getExtra(){}getDefaultSorting(){return{column:"occurrences",direction:"DESC"}}getColumnDefinitions(){return[{title:"Jank Type",kind:"STRING",columnConstructor:Uint16Array,columnId:"jank_type"},{title:"Min duration",kind:"NUMBER",columnConstructor:Uint16Array,columnId:"minDur"},{title:"Max duration",kind:"NUMBER",columnConstructor:Uint16Array,columnId:"maxDur"},{title:"Mean duration",kind:"NUMBER",columnConstructor:Uint16Array,columnId:"meanDur"},{title:"Occurrences",kind:"NUMBER",columnConstructor:Uint16Array,columnId:"occurrences",sum:!0}]}}lS.FrameAggregationController=e}return lS}(),c=dS(),u=function(){if(!fS){fS=1,Object.defineProperty(pS,"__esModule",{value:!0}),pS.WattsonEstimateAggregationController=void 0;const i=oe(),o=Q();var e=rS();const s=qb(),l=z();class t extends e.AggregationController{async createAggregateView(e,t){if(await e.query(`drop view if exists ${this.kind};`),!await(0,s.hasWattsonSupport)(e))return!1;var r=[];for(const a of t.tracks){var n=i.globals.state.tracks[a];n?.uri&&(n=i.globals.trackManager.resolveTrackInfo(n.uri))?.tags?.kind===o.CPUSS_ESTIMATE_TRACK_KIND&&(0,l.exists)(n.tags?.wattson)&&r.push(""+n.tags.wattson)}return 0!==r.length&&(t=this.getEstimateTracksQuery(t,r),e.query(t),!0)}getEstimateTracksQuery(e,t){const r=e.end-e.start;let n=`
      INCLUDE PERFETTO MODULE wattson.curves.ungrouped;

      CREATE OR REPLACE PERFETTO TABLE _ui_selection_window AS
      SELECT
        ${e.start} as ts,
        ${r} as dur;

      DROP TABLE IF EXISTS _windowed_cpuss_estimate;
      CREATE VIRTUAL TABLE _windowed_cpuss_estimate
      USING
        SPAN_JOIN(_ui_selection_window, _system_state_mw);

      CREATE VIEW ${this.kind} AS
    `;return t.forEach((e,t)=>{0!=t&&(n+="UNION ALL "),n+=`
        SELECT
        '${e}' as name,
        ROUND(SUM(${e}_mw * dur) / ${r}, 2) as power,
        ROUND(SUM(${e}_mw * dur) / 1000000000, 2) as energy
        FROM _windowed_cpuss_estimate
      `}),n+=";"}getColumnDefinitions(){return[{title:"Name",kind:"STRING",columnConstructor:Uint16Array,columnId:"name"},{title:"Average estimated power (mW)",kind:"NUMBER",columnConstructor:Float64Array,columnId:"power",sum:!0},{title:"Total estimated energy (mWs)",kind:"NUMBER",columnConstructor:Float64Array,columnId:"energy",sum:!0}]}async getExtra(){}getTabName(){return"Wattson estimates"}getDefaultSorting(){return{column:"name",direction:"ASC"}}}pS.WattsonEstimateAggregationController=t}return pS}(),d=function(){if(!hS){hS=1,Object.defineProperty(gS,"__esModule",{value:!0}),gS.WattsonThreadAggregationController=void 0;const o=z(),s=oe(),l=Q();var e=rS();const c=qb();class t extends e.AggregationController{async createAggregateView(e,t){if(await e.query(`drop view if exists ${this.kind};`),!await(0,c.hasWattsonSupport)(e))return!1;var r,n=[];for(const i of t.tracks){var a=s.globals.state.tracks[i];a?.uri&&(a=s.globals.trackManager.resolveTrackInfo(a.uri))?.tags?.kind===l.CPU_SLICE_TRACK_KIND&&(0,o.exists)(a.tags.cpu)&&n.push(a.tags.cpu)}return 0!==n.length&&(r=t.end-t.start,e.query(`
      INCLUDE PERFETTO MODULE viz.summary.threads_w_processes;
      INCLUDE PERFETTO MODULE wattson.curves.ungrouped;

      CREATE OR REPLACE PERFETTO TABLE _ui_selection_window AS
      SELECT
        ${t.start} as ts,
        ${r} as dur;

      -- Processes filtered by CPU within the UI defined time window
      DROP TABLE IF EXISTS _windowed_summary;
      CREATE VIRTUAL TABLE _windowed_summary
      USING
        SPAN_JOIN(_ui_selection_window, _sched_w_thread_process_package_summary);
    `),this.runEstimateThreadsQuery(e,n,r),!0)}runEstimateThreadsQuery(t,e,r){e.forEach(e=>{t.query(`
        -- Packages filtered by CPU
        CREATE OR REPLACE PERFETTO VIEW _windowed_summary_per_cpu${e} AS
        SELECT *
        FROM _windowed_summary WHERE cpu = ${e};

        -- CPU specific track with slices for curves
        CREATE OR REPLACE PERFETTO VIEW _per_cpu${e}_curve AS
        SELECT ts, dur, cpu${e}_curve
        FROM _system_state_curves;

        -- Filter out track when threads are available
        DROP TABLE IF EXISTS _windowed_thread_curve${e};
        CREATE VIRTUAL TABLE _windowed_thread_curve${e}
        USING
          SPAN_JOIN(_per_cpu${e}_curve, _windowed_summary_per_cpu${e});

        -- Total estimate per UTID per CPU
        CREATE OR REPLACE PERFETTO VIEW _total_per_cpu${e} AS
        SELECT
          SUM(cpu${e}_curve * dur) as total_pws,
          SUM(dur) as dur,
          tid,
          pid,
          uid,
          utid,
          upid,
          thread_name,
          process_name,
          package_name
        FROM _windowed_thread_curve${e}
        GROUP BY utid;
      `)});let n="CREATE OR REPLACE PERFETTO TABLE _unioned_per_cpu_total AS ";e.forEach((e,t)=>{n=n+(0!=t?`UNION ALL
`:"")+`SELECT * from _total_per_cpu${e}
`}),n+=`
      ;

      -- Grouped again by UTID, but this time to make it CPU agnostic
      CREATE VIEW ${this.kind} AS
      SELECT
        ROUND(SUM(total_pws) / ${r}, 2) as avg_mw,
        ROUND(SUM(total_pws) / 1000000000, 2) as total_mws,
        thread_name,
        tid,
        pid
      FROM _unioned_per_cpu_total
      GROUP BY utid;
    `,t.query(n)}getColumnDefinitions(){return[{title:"Thread Name",kind:"STRING",columnConstructor:Uint16Array,columnId:"thread_name"},{title:"TID",kind:"NUMBER",columnConstructor:Uint16Array,columnId:"tid"},{title:"PID",kind:"NUMBER",columnConstructor:Uint16Array,columnId:"pid"},{title:"Average estimated power (mW)",kind:"NUMBER",columnConstructor:Float64Array,columnId:"avg_mw",sum:!0},{title:"Total estimated energy (mWs)",kind:"NUMBER",columnConstructor:Float64Array,columnId:"total_mws",sum:!0}]}async getExtra(){}getTabName(){return"Wattson by thread"}getDefaultSorting(){return{column:"total_mws",direction:"DESC"}}}gS.WattsonThreadAggregationController=t}return gS}(),f=function(){if(!mS){mS=1,Object.defineProperty(_S,"__esModule",{value:!0}),_S.WattsonProcessAggregationController=void 0;const i=z(),o=oe(),s=Q();var e=rS();const l=qb();class t extends e.AggregationController{async createAggregateView(e,t){if(await e.query(`drop view if exists ${this.kind};`),!await(0,l.hasWattsonSupport)(e))return!1;var r=[];for(const a of t.tracks){var n=o.globals.state.tracks[a];n?.uri&&(n=o.globals.trackManager.resolveTrackInfo(n.uri))?.tags?.kind===s.CPU_SLICE_TRACK_KIND&&(0,i.exists)(n.tags.cpu)&&r.push(n.tags.cpu)}return 0!==r.length&&(t=t.end-t.start,e.query(`
      -- Grouped by UPID and made CPU agnostic
      CREATE VIEW ${this.kind} AS
      SELECT
        ROUND(SUM(total_pws) / ${t}, 2) as avg_mw,
        ROUND(SUM(total_pws) / 1000000000, 2) as total_mws,
        pid,
        process_name
      FROM _unioned_per_cpu_total
      GROUP BY upid;
    `),!0)}getColumnDefinitions(){return[{title:"Process Name",kind:"STRING",columnConstructor:Uint16Array,columnId:"process_name"},{title:"PID",kind:"NUMBER",columnConstructor:Uint16Array,columnId:"pid"},{title:"Average estimated power (mW)",kind:"NUMBER",columnConstructor:Float64Array,columnId:"avg_mw",sum:!0},{title:"Total estimated energy (mWs)",kind:"NUMBER",columnConstructor:Float64Array,columnId:"total_mws",sum:!0}]}async getExtra(){}getTabName(){return"Wattson by process"}getDefaultSorting(){return{column:"total_mws",direction:"DESC"}}}_S.WattsonProcessAggregationController=t}return _S}(),p=function(){if(!yS){yS=1,Object.defineProperty(TS,"__esModule",{value:!0}),TS.WattsonPackageAggregationController=void 0;const i=z(),o=oe(),s=Z(),l=Q();var e=rS();const c=qb();class t extends e.AggregationController{async createAggregateView(e,t){if(await e.query(`drop view if exists ${this.kind};`),!await(0,c.hasWattsonSupport)(e))return!1;if(0===(await e.query(`
      INCLUDE PERFETTO MODULE android.process_metadata;
      SELECT COUNT(*) as isValid FROM android_process_metadata
      WHERE package_name IS NOT NULL
    `)).firstRow({isValid:s.NUM}).isValid)return!1;var r=[];for(const a of t.tracks){var n=o.globals.state.tracks[a];n?.uri&&(n=o.globals.trackManager.resolveTrackInfo(n.uri))?.tags?.kind===l.CPU_SLICE_TRACK_KIND&&(0,i.exists)(n.tags.cpu)&&r.push(n.tags.cpu)}return 0!==r.length&&(t=t.end-t.start,e.query(`
      -- Grouped by UID and made CPU agnostic
      CREATE VIEW ${this.kind} AS
      SELECT
        ROUND(SUM(total_pws) / ${t}, 2) as avg_mw,
        ROUND(SUM(total_pws) / 1000000000, 2) as total_mws,
        ROUND(SUM(dur) / 1000000.0, 2) as dur_ms,
        uid,
        package_name
      FROM _unioned_per_cpu_total
      GROUP BY uid;
    `),!0)}getColumnDefinitions(){return[{title:"Package Name",kind:"STRING",columnConstructor:Uint16Array,columnId:"package_name"},{title:"Android app UID",kind:"NUMBER",columnConstructor:Uint16Array,columnId:"uid"},{title:"Total Duration (ms)",kind:"NUMBER",columnConstructor:Float64Array,columnId:"dur_ms"},{title:"Average estimated power (mW)",kind:"NUMBER",columnConstructor:Float64Array,columnId:"avg_mw",sum:!0},{title:"Total estimated energy (mWs)",kind:"NUMBER",columnConstructor:Float64Array,columnId:"total_mws",sum:!0}]}async getExtra(){}getTabName(){return"Wattson by package"}getDefaultSorting(){return{column:"total_mws",direction:"DESC"}}}TS.WattsonPackageAggregationController=t}return TS}(),k=function(){if(!bS){bS=1,Object.defineProperty(vS,"__esModule",{value:!0}),vS.ThreadAggregationController=void 0;const n=z(),o=bf(),a=Q(),i=oe(),s=Z();class e extends rS().AggregationController{utids;setThreadStateUtids(e){this.utids=[];for(const r of e){var t=i.globals.state.tracks[r];t?.uri&&(t=i.globals.trackManager.resolveTrackInfo(t.uri))?.tags?.kind===a.THREAD_STATE_TRACK_KIND&&(0,n.exists)(t.tags.utid)&&this.utids.push(t.tags.utid)}}async createAggregateView(e,t){return this.setThreadStateUtids(t.tracks),void 0!==this.utids&&0!==this.utids.length&&(await e.query(`
      create or replace perfetto table ${this.kind} as
      select
        process.name as process_name,
        process.pid,
        thread.name as thread_name,
        thread.tid,
        tstate.state || ',' || ifnull(tstate.io_wait, 'NULL') as concat_state,
        sum(tstate.dur) AS total_dur,
        sum(tstate.dur) / count() as avg_dur,
        count() as occurrences
      from thread_state tstate
      join thread using (utid)
      left join process using (upid)
      where
        utid in (${this.utids})
        and ts + dur > ${t.start}
        and ts < ${t.end}
      group by utid, concat_state
    `),!0)}async getExtra(e,t){if(this.setThreadStateUtids(t.tracks),void 0!==this.utids&&0!==this.utids.length){var t=`
      select
        state,
        io_wait as ioWait,
        sum(dur) as totalDur
      from thread
      join thread_state using (utid)
      where utid in (${this.utids})
        and thread_state.ts + thread_state.dur > ${t.start}
        and thread_state.ts < ${t.end}
      group by state, io_wait
    `,e=await e.query(t),r=e.iter({state:s.STR_NULL,ioWait:s.NUM_NULL,totalDur:s.NUM}),n={kind:"THREAD_STATE",states:[],values:new Float64Array(e.numRows()),totalMs:0};for(let e=n.totalMs=0;r.valid();++e,r.next()){var a=null==r.state?void 0:r.state,i=null===r.ioWait?void 0:0<r.ioWait,a=(n.states.push((0,o.translateState)(a,i)),r.totalDur/1e6);n.values[e]=a,n.totalMs+=a}return n}}getColumnDefinitions(){return[{title:"Process",kind:"STRING",columnConstructor:Uint16Array,columnId:"process_name"},{title:"PID",kind:"NUMBER",columnConstructor:Uint16Array,columnId:"pid"},{title:"Thread",kind:"STRING",columnConstructor:Uint16Array,columnId:"thread_name"},{title:"TID",kind:"NUMBER",columnConstructor:Uint16Array,columnId:"tid"},{title:"State",kind:"STATE",columnConstructor:Uint16Array,columnId:"concat_state"},{title:"Wall duration (ms)",kind:"TIMESTAMP_NS",columnConstructor:Float64Array,columnId:"total_dur",sum:!0},{title:"Avg Wall duration (ms)",kind:"TIMESTAMP_NS",columnConstructor:Float64Array,columnId:"avg_dur"},{title:"Occurrences",kind:"NUMBER",columnConstructor:Uint16Array,columnId:"occurrences",sum:!0}]}getTabName(){return"Thread States"}getDefaultSorting(){return{column:"total_dur",direction:"DESC"}}}vS.ThreadAggregationController=e}return vS}(),w=bE(),R=function(){if(!ES){ES=1,Object.defineProperty(SS,"__esModule",{value:!0}),SS.CpuProfileController=void 0;const r=Y(),n=oe(),a=CT(),i=Z();class e extends bE().Controller{args;lastSelectedSample;requestingData=!1;queuedRunRequest=!1;constructor(e){super("main"),this.args=e}run(){var e=(0,r.getLegacySelection)(n.globals.state);if(e&&"CPU_PROFILE_SAMPLE"===e.kind){const t=e;this.shouldRequestData(t)&&(this.requestingData?this.queuedRunRequest=!0:(this.requestingData=!0,(0,a.publishCpuProfileDetails)({}),this.lastSelectedSample=this.copyCpuProfileSample(e),this.getSampleData(t.id).then(e=>{void 0!==e&&t&&this.lastSelectedSample&&this.lastSelectedSample.id===t.id&&(e={id:t.id,ts:t.ts,utid:t.utid,stack:e},(0,a.publishCpuProfileDetails)(e))}).finally(()=>{this.requestingData=!1,this.queuedRunRequest&&(this.queuedRunRequest=!1,this.run())})))}}copyCpuProfileSample(e){return{kind:e.kind,id:e.id,utid:e.utid,ts:e.ts}}shouldRequestData(e){return void 0===this.lastSelectedSample||void 0!==this.lastSelectedSample&&this.lastSelectedSample.id!==e.id}async getSampleData(e){e=await this.args.engine.query(`
      SELECT
        samples.id as id,
        IFNULL(
          (
            SELECT name
            FROM stack_profile_symbol symbol
            WHERE symbol.symbol_set_id = spf.symbol_set_id
            LIMIT 1
          ),
          COALESCE(spf.deobfuscated_name, spf.name, "")
        ) AS name,
        spm.name AS mapping
      FROM cpu_profile_stack_sample AS samples
      LEFT JOIN (
        SELECT
          id,
          frame_id,
          depth
        FROM stack_profile_callsite
        UNION ALL
        SELECT
          leaf.id AS id,
          callsite.frame_id AS frame_id,
          callsite.depth AS depth
        FROM stack_profile_callsite leaf
        JOIN experimental_ancestor_stack_profile_callsite(leaf.id) AS callsite
      ) AS callsites
        ON samples.callsite_id = callsites.id
      LEFT JOIN stack_profile_frame AS spf
        ON callsites.frame_id = spf.id
      LEFT JOIN stack_profile_mapping AS spm
        ON spf.mapping = spm.id
      WHERE samples.id = ${e}
      ORDER BY callsites.depth;
    `);if(0!==e.numRows()){for(var t=e.iter({id:i.NUM,name:i.STR,mapping:i.STR}),r=[];t.valid();t.next())r.push({id:t.id,totalSize:0,depth:0,parentId:0,name:t.name,selfSize:0,mapping:t.mapping,merged:!1,highlighted:!1});return r}}}SS.CpuProfileController=e}return SS}(),I=CS(),M=function(){if(!kS){kS=1,Object.defineProperty(wS,"__esModule",{value:!0}),wS.LoadingManager=void 0;const t=CT();wS.LoadingManager=class{static _instance;numQueuedQueries=0;numLastUpdate=0;static get getInstance(){return this._instance||(this._instance=new this)}beginLoading(){this.update(1)}endLoading(){this.update(-1)}update(e){this.numQueuedQueries+=e,(0===this.numQueuedQueries||2<Math.abs(this.numLastUpdate-this.numQueuedQueries))&&(this.numLastUpdate=this.numQueuedQueries,(0,t.publishLoading)(this.numQueuedQueries))}}}return wS}(),P=DS(),N=function(){if(!xS){xS=1,Object.defineProperty(LS,"__esModule",{value:!0}),LS.SearchController=void 0;const d=J(),f=z(),p=Q(),h=oe(),r=CT(),g=Z(),m=os();class e extends bE().Controller{engine;previousOmniboxState;updateInProgress;constructor(e){super("main"),this.engine=e.engine,this.updateInProgress=!1}run(){var e,t;this.updateInProgress||void 0!==(t=h.globals.state.omniboxState)&&"COMMAND"!==t.mode&&this.previousOmniboxState!==(t=t)&&(""===(e=(this.previousOmniboxState=t).omnibox)||e.length<4&&!t.force?(0,r.publishSearchResult)({eventIds:new Float64Array(0),tses:new BigInt64Array(0),utids:new Float64Array(0),sources:[],trackKeys:[],totalResults:0}):(t=this.specificSearch(e).then(e=>{(0,r.publishSearchResult)(e)}),Promise.all([t]).finally(()=>{this.updateInProgress=!1,this.run()})))}onDestroy(){}async specificSearch(e){var t=(0,m.escapeSearchQuery)(e),r=new Map;for(const c of Object.values(h.globals.state.tracks)){var n=h.globals.trackManager.resolveTrackInfo(c.uri);n?.tags?.kind===p.CPU_SLICE_TRACK_KIND&&(0,f.exists)(n.tags.cpu)&&r.set(n.tags.cpu,c.key)}var a=[];for(const l=(await this.query(`select utid from thread join process
    using(upid) where
      thread.name glob ${t} or
      process.name glob `+t)).iter({utid:g.NUM});l.valid();l.next())a.push(l.utid);var t=await this.query(`
      select
        id as sliceId,
        ts,
        'cpu' as source,
        cpu as sourceId,
        utid
      from sched where utid in (${a.join(",")})
      union all
      select *
      from (
        select
          slice_id as sliceId,
          ts,
          'slice' as source,
          track_id as sourceId,
          0 as utid
          from slice
          where slice.name glob ${t}
            or (
              0 != CAST(${(0,d.sqliteString)(e)} AS INT) and
              sliceId = CAST(${(0,d.sqliteString)(e)} AS INT)
            )
        union
        select
          slice_id as sliceId,
          ts,
          'slice' as source,
          track_id as sourceId,
          0 as utid
        from slice
        join args using(arg_set_id)
        where string_value glob ${t} or key glob ${t}
      )
      union all
      select
        id as sliceId,
        ts,
        'log' as source,
        0 as sourceId,
        utid
      from android_logs where msg glob ${t}
      order by ts
    `),i={eventIds:new Float64Array(0),tses:new BigInt64Array(0),utids:new Float64Array(0),sources:[],trackKeys:[],totalResults:0},o=e.toLowerCase();for(const u of Object.values(h.globals.state.tracks))-1!==u.name.toLowerCase().indexOf(o)&&(i.totalResults++,i.sources.push("track"),i.trackKeys.push(u.key));var s,e=t.numRows();i.eventIds=new Float64Array(i.totalResults+e),i.tses=new BigInt64Array(i.totalResults+e),i.utids=new Float64Array(i.totalResults+e);for(let e=0;e<i.totalResults;++e)i.eventIds[e]=-1,i.tses[e]=-1n,i.utids[e]=-1;const l=t.iter({sliceId:g.NUM,ts:g.LONG,source:g.STR,sourceId:g.NUM,utid:g.NUM});for(;l.valid();l.next()){let e=void 0;"cpu"===l.source?e=r.get(l.sourceId):"slice"===l.source?e=h.globals.trackManager.trackKeyByTrackId.get(l.sourceId):"log"===l.source&&0<(s=Object.values(h.globals.state.tracks).filter(e=>{e=h.globals.trackManager.resolveTrackInfo(e.uri);return e&&"AndroidLogTrack"===e.tags?.kind})).length&&(e=s[0].key),void 0!==e&&(s=i.totalResults++,i.trackKeys.push(e),i.sources.push(l.source),i.eventIds[s]=l.sliceId,i.tses[s]=l.ts,i.utids[s]=l.utid)}return i}async query(e){return await this.engine.query(e)}}LS.SearchController=e}return LS}(),D=BS(),x=function(){if(!jS){jS=1,Object.defineProperty(HS,"__esModule",{value:!0}),HS.TraceErrorController=void 0;const t=CT(),r=Z();class e extends bE().Controller{args;hasRun=!1;constructor(e){super("main"),this.args=e}run(){this.hasRun||(this.hasRun=!0,this.args.engine.query("SELECT sum(value) as sumValue FROM stats WHERE severity != 'info'").then(e=>{e=e.firstRow({sumValue:r.NUM}).sumValue;(0,t.publishTraceErrors)(e)}))}}HS.TraceErrorController=e}return HS}(),L=R_(),t=zS(),U=IT(),e=Go(),F=bT();const B=["android_ion","android_lmk","android_surfaceflinger","android_batt","android_other_traces","chrome_dropped_frames","android_trusty_workqueues"].map(e=>{var t="forceMetric"+e;let r=e.split("_").join(" ");return r="Metric: "+(r=r[0].toUpperCase()+r.slice(1)),[a.featureFlags.register({id:t,name:r,description:`Overrides running the '${e}' metric at import time.`,defaultValue:!0}),e]}),j=a.featureFlags.register({id:"enableChromeReliableRangeZoom",name:"Enable Chrome reliable range zoom",description:"Automatically zoom into the reliable range for Chrome traces",defaultValue:!1}),H=a.featureFlags.register({id:"enableChromeReliableRangeAnnotation",name:"Enable Chrome reliable range annotation",description:"Automatically adds an annotation for the reliable range start",defaultValue:!1}),G=a.featureFlags.register({id:"cropTrackEvents",name:"Crop track events",description:"Ignores track events outside of the range of interest",defaultValue:!1}),V=a.featureFlags.register({id:"ingestFtraceInRawTable",name:"Ingest ftrace in raw table",description:"Enables ingestion of typed ftrace events into the raw table",defaultValue:!0}),W=a.featureFlags.register({id:"analyzeTraceProtoContent",name:"Analyze trace proto content",description:"Enables trace proto content analysis (experimental_proto_content table)",defaultValue:!1}),q=a.featureFlags.register({id:"ftraceDropUntilAllCpusValid",name:"Crop ftrace events",description:"Drop ftrace events until all per-cpu data streams are known to be valid",defaultValue:!0});class $ extends w.Controller{engineId;engine;constructor(e){super("init"),this.engineId=e}run(){var e=(0,g.assertExists)(b.globals.state.engine);switch(this.state){case"init":this.loadTrace().then(e=>{b.globals.dispatch(_.Actions.setEngineReady({engineId:this.engineId,ready:!0,mode:e}))}).catch(e=>{throw this.updateStatus(""+e),e}),this.updateStatus("Opening trace"),this.setState("loading_trace");break;case"loading_trace":if(void 0===this.engine||!e.ready)return;this.setState("ready");break;case"ready":var t=(0,g.assertExists)(this.engine),r=[],n={engine:t},n=(r.push((0,w.Child)("selection",D.SelectionController,n)),{engine:t}),n=(r.push((0,w.Child)("flowEvents",I.FlowEventsController,n)),{engine:t});return r.push((0,w.Child)("cpuProfile",R.CpuProfileController,n)),r.push((0,w.Child)("cpu_aggregation",o.CpuAggregationController,{engine:t,kind:"cpu_aggregation"})),r.push((0,w.Child)("thread_aggregation",k.ThreadAggregationController,{engine:t,kind:"thread_state_aggregation"})),r.push((0,w.Child)("cpu_process_aggregation",s.CpuByProcessAggregationController,{engine:t,kind:"cpu_by_process_aggregation"})),P.PIVOT_TABLE_REDUX_FLAG.get()||r.push((0,w.Child)("slice_aggregation",c.SliceAggregationController,{engine:t,kind:"slice_aggregation"})),r.push((0,w.Child)("counter_aggregation",i.CounterAggregationController,{engine:t,kind:"counter_aggregation"})),T.pluginManager.isActive("org.kernel.Wattson")&&(r.push((0,w.Child)("wattson_estimate_aggregation",u.WattsonEstimateAggregationController,{engine:t,kind:"wattson_estimate_aggregation"})),r.push((0,w.Child)("wattson_thread_aggregation",d.WattsonThreadAggregationController,{engine:t,kind:"wattson_thread_aggregation"})),r.push((0,w.Child)("wattson_process_aggregation",f.WattsonProcessAggregationController,{engine:t,kind:"wattson_process_aggregation"})),r.push((0,w.Child)("wattson_package_aggregation",p.WattsonPackageAggregationController,{engine:t,kind:"wattson_package_aggregation"}))),r.push((0,w.Child)("frame_aggregation",l.FrameAggregationController,{engine:t,kind:"frame_aggregation"})),r.push((0,w.Child)("search",N.SearchController,{engine:t,app:b.globals})),r.push((0,w.Child)("pivot_table",P.PivotTableController,{engine:t})),r.push((0,w.Child)("traceError",x.TraceErrorController,{engine:t})),r;default:throw new Error("unknown state "+this.state)}}onDestroy(){T.pluginManager.onTraceClose(),b.globals.engines.delete(this.engineId),b.globals.areaFlamegraphCache=new e.LegacyFlamegraphCache("area")}async loadTrace(){this.updateStatus("Creating trace processor");let e,t=!1,r;(t="USE_HTTP_RPC_IF_AVAILABLE"===b.globals.state.newEngineMode?(await A.HttpRpcEngine.checkConnection()).connected:t)?(console.log("Opening trace using native accelerator over HTTP+RPC"),e="HTTP_RPC",(r=new A.HttpRpcEngine(this.engineId,M.LoadingManager.getInstance)).errorHandler=e=>{throw b.globals.dispatch(_.Actions.setEngineFailed({mode:"HTTP_RPC",failure:""+e})),e}):(console.log("Opening trace using built-in WASM engine"),e="WASM",n=(0,C.resetEngineWorker)(),(r=new C.WasmEngineProxy(this.engineId,n,M.LoadingManager.getInstance)).resetTraceProcessor({cropTrackEvents:G.get(),ingestFtraceInRawTable:V.get(),analyzeTraceProtoContent:W.get(),ftraceDropUntilAllCpusValid:q.get()})),this.engine=r,(0,y.isMetatracingEnabled)()&&this.engine.enableMetatrace((0,g.assertExists)((0,y.getEnabledMetatracingCategories)())),b.globals.engines.set(this.engineId,r),b.globals.dispatch(_.Actions.setEngineReady({engineId:this.engineId,ready:!1,mode:e}));var n=(0,g.assertExists)(b.globals.state.engine);(0,g.assertTrue)(n.id===this.engineId);let a;if("FILE"===n.source.type)a=new L.TraceFileStream(n.source.file);else if("ARRAY_BUFFER"===n.source.type)a=new L.TraceBufferStream(n.source.buffer);else if("URL"===n.source.type)a=new L.TraceHttpStream(n.source.url);else{if("HTTP_RPC"!==n.source.type)throw new Error("Unknown source: "+JSON.stringify(n.source));a=void 0}if(void 0!==a){for(var i=performance.now();;){var o,s=await a.readChunk(),l=(await this.engine.parse(s.data),(performance.now()-i)/1e3);let e="Loading trace ";if(0<s.bytesTotal?(o=Math.round(s.bytesRead/s.bytesTotal*100),e+=o+"%"):e+=Math.round(s.bytesRead/1e6)+" MB",e+=` - ${Math.ceil(s.bytesRead/l/1e6)} MB/s`,this.updateStatus(e),s.eof)break}await this.engine.notifyEof()}else(0,g.assertTrue)(this.engine instanceof A.HttpRpcEngine),await this.engine.restoreInitialTables();var c=await this.cacheCurrentTrace(),n=await async function(e,t){var r=await async function(e){e=await e.query("select start_ts as startTs, end_ts as endTs from trace_bounds"),e=e.firstRow({startTs:O.LONG,endTs:O.LONG});return new m.TimeSpan(m.Time.fromRaw(e.startTs),m.Time.fromRaw(e.endTs))}(e),n=await e.query(`select
          ts,
          clock_value as clockValue,
          clock_name as clockName
        from clock_snapshot
        where
          snapshot_id = 0 AND
          clock_name in ('REALTIME', 'REALTIME_COARSE')
        `),a=n.iter({ts:O.LONG,clockValue:O.LONG,clockName:O.STR});let i={clockName:"",ts:m.Time.ZERO,clockValue:m.Time.ZERO};for(let e=0;a.valid();a.next(),e++){if("REALTIME"===a.clockName){i={clockName:a.clockName,ts:m.Time.fromRaw(a.ts),clockValue:m.Time.fromRaw(a.clockValue)};break}"REALTIME_COARSE"===a.clockName&&"REALTIME"!==i.clockName&&(i={clockName:a.clockName,ts:m.Time.fromRaw(a.ts),clockValue:m.Time.fromRaw(a.clockValue)})}var n=await(0,g.assertExists)(e).query(`select max(int_value) as tzOffMin from metadata
        where name = 'timezone_off_mins'`),n=n.firstRow({tzOffMin:O.NUM_NULL}).tzOffMin??0,o=m.Time.sub(i.ts,i.clockValue),s=m.Time.getLatestMidnight(r.start,o),n=m.Time.getLatestMidnight(r.start,m.Time.sub(o,m.Time.fromSeconds(60*n)));let l="",c="";switch(t.source.type){case"FILE":l=t.source.file.name.split(/[/\\]/).pop();var u=Math.ceil(t.source.file.size/1e6);l+=` (${u} MB)`;break;case"URL":c=t.source.url,l=c.split("/").pop();break;case"ARRAY_BUFFER":l=t.source.title,c=t.source.url??"";u=Math.ceil(t.source.buffer.byteLength/1e6);l+=` (${u} MB)`;break;case"HTTP_RPC":l="RPC @ "+A.HttpRpcEngine.hostAndPort}return{...r,traceTitle:l,traceUrl:c,realtimeOffset:o,utcOffset:s,traceTzOffset:n,cpus:await async function(e){var t=[],e=await e.query("select distinct(cpu) as cpu from sched order by cpu;");for(var r=e.iter({cpu:O.NUM});r.valid();r.next())t.push(r.cpu);return t}(e),gpuCount:await async function(e){e=await e.query(`
    select count(distinct(gpu_id)) as gpuCount
    from gpu_counter_track
    where name = 'gpufreq';
  `);return e.firstRow({gpuCount:O.NUM}).gpuCount}(e)}}(this.engine,n);n.traceTitle&&(document.title=n.traceTitle+" - Perfetto UI"),await b.globals.onTraceLoad(this.engine,n);const u="select str_value from metadata where name = 'trace_type'";var d="json"==(await(0,g.assertExists)(this.engine).query(u)).firstRow({str_value:O.STR}).str_value,f={omnibox:"",mode:b.globals.state.omniboxState.mode||"SEARCH"},f=[_.Actions.setOmnibox(f),_.Actions.setTraceUuid({traceUuid:c})],p=await async function(e,t,r,n){let a=e,i=t;e=await async function(e){e=await e.query(`select
       name,
       int_value as intValue
       from metadata
       where name = 'tracing_started_ns' or name = 'tracing_disabled_ns'
       or name = 'all_data_source_started_ns'`);let t=m.Time.MIN,r=m.Time.MAX;var n=e.iter({name:O.STR,intValue:O.LONG_NULL});for(;n.valid();n.next()){var a=n.name,i=n.intValue;null!==i&&("tracing_disabled_ns"===a?r=m.Time.min(r,m.Time.fromRaw(i)):t=m.Time.max(t,m.Time.fromRaw(i)))}return new m.TimeSpan(t,r)}(n);m.Time.max(a,e.start)<m.Time.min(i,e.end)&&(a=m.Time.max(a,e.start),i=m.Time.min(i,e.end));!r&&j.get()&&(t=await h(n),a=m.Time.max(a,t));e=await async function(e){var e=await e.query(`
    SELECT min(ts) as start, max(ts) as end FROM ftrace_event;
  `),{start:e,end:t}=e.firstRow({start:O.LONG_NULL,end:O.LONG_NULL});return null===e||null===t?null:new m.TimeSpan(m.Time.fromRaw(e),m.Time.fromRaw(t))}(n);null!==e&&(a=m.Time.min(e.start,i));return new m.TimeSpan(a,i)}(n.start,n.end,d,this.engine),{pinnedTracks:p,tracks:f}=(b.globals.timeline.updateVisibleTime(p),b.globals.dispatchMultiple(f),S.Router.navigate("#!/viewer?local_cache_key="+c),await this.initialiseHelperViews(),await this.includeSummaryTables(),await r.query(`
    create perfetto function __max_layout_depth(track_count INT, track_ids STRING)
    returns INT AS
    select iif(
      $track_count = 1,
      (
        select max_depth
        from _slice_track_summary
        where id = cast($track_ids AS int)
      ),
      (
        select max(layout_depth)
        from experimental_slice_layout($track_ids)
      )
    );
  `),b.globals.restoreAppStateAfterTraceLoad&&(0,F.deserializeAppStatePhase1)(b.globals.restoreAppStateAfterTraceLoad),await T.pluginManager.onTraceLoad(r,e=>{this.updateStatus("Running plugin: "+e)}),b.globals.state);p.length||Object.keys(f).length||await this.listTracks(),this.decideTabs(),await this.listThreads(),await this.loadTimelineOverview(new m.TimeSpan(n.start,n.end));{const u=`
        select
          *
        from ftrace_event
        limit 1`;c=await r.query(`
        select
          *
        from ftrace_event
        limit 1`);(0,v.publishHasFtrace)(0<c.numRows())}b.globals.dispatch(_.Actions.sortThreadTracks({})),b.globals.dispatch(_.Actions.maybeExpandOnlyTrackGroup({})),await this.selectFirstHeapProfile(),await this.selectPerfSample(n);p=b.globals.state.pendingDeeplink;return void 0!==p&&(b.globals.dispatch(_.Actions.clearPendingDeeplink({})),await this.selectPendingDeeplink(p),void 0!==p.visStart&&void 0!==p.visEnd&&this.zoomPendingDeeplink(p.visStart,p.visEnd),void 0!==p.query)&&(0,E.addQueryResultsTab)({query:p.query,title:"Deeplink Query"}),b.globals.dispatch(_.Actions.maybeExpandOnlyTrackGroup({})),!d&&H.get()&&0<(f=await h(r))&&b.globals.dispatch(_.Actions.addNote({timestamp:f,color:"#ff0000",text:"Reliable Range Start"})),b.globals.restoreAppStateAfterTraceLoad&&((0,F.deserializeAppStatePhase2)(b.globals.restoreAppStateAfterTraceLoad),b.globals.restoreAppStateAfterTraceLoad=void 0),e}async selectPerfSample(e){var t,r=await(0,g.assertExists)(this.engine).query(`select upid
        from perf_sample
        join thread using (utid)
        where callsite_id is not null
        order by ts desc limit 1`);1===r.numRows()&&(r=r.firstRow({upid:O.NUM}).upid,t=e.start,e=e.end,b.globals.dispatch(_.Actions.selectPerfSamples({id:0,upid:r,leftTs:t,rightTs:e,type:n.ProfileType.PERF_SAMPLE})))}async selectFirstHeapProfile(){var t=await(0,g.assertExists)(this.engine).query(`select * from (
      select
        min(ts) AS ts,
        'heap_profile:' || group_concat(distinct heap_name) AS type,
        upid
      from heap_profile_allocation
      group by upid
      union
      select distinct graph_sample_ts as ts, 'graph' as type, upid
      from heap_graph_object)
      order by ts limit 1`);if(1===t.numRows()){var t=t.firstRow({ts:O.LONG,type:O.STR,upid:O.NUM}),r=m.Time.fromRaw(t.ts);let e=t.type;"heap_profile:libc.malloc,com.android.art"==e&&(e="heap_profile:com.android.art,libc.malloc");var n=(0,U.profileType)(e),t=t.upid;b.globals.dispatch(_.Actions.selectHeapProfile({id:0,upid:t,ts:r,type:n}))}}async selectPendingDeeplink(e){var t,r,n=[],{ts:e,dur:a}=e;void 0!==e&&n.push("ts = "+e),void 0!==a&&n.push("dur = "+a),0!==n.length&&(e=`
      select
        id,
        track_id as traceProcessorTrackId,
        type
      from slice
      where ${n.join(" and ")}
    ;`,0<(a=await(0,g.assertExists)(this.engine).query(e)).numRows())&&(n=(t=a.firstRow({id:O.NUM,traceProcessorTrackId:O.NUM,type:O.STR})).traceProcessorTrackId,void 0!==(r=b.globals.trackManager.trackKeyByTrackId.get(n)))&&b.globals.setLegacySelection({kind:"SLICE",id:t.id,trackKey:r,table:"slice"},{clearSearch:!0,pendingScrollId:t.id,switchToCurrentSelectionTab:!1})}async listTracks(){this.updateStatus("Loading tracks");var e=(0,g.assertExists)(this.engine),e=await(0,t.decideTracks)(e);b.globals.dispatchMultiple(e)}decideTabs(){for(const e of b.globals.tabManager.defaultTabs)b.globals.dispatch(_.Actions.showTab({uri:e}))}async listThreads(){this.updateStatus("Reading thread list");for(var e=[],t=(await(0,g.assertExists)(this.engine).query(`select
        utid,
        tid,
        pid,
        ifnull(thread.name, '') as threadName,
        ifnull(
          case when length(process.name) > 0 then process.name else null end,
          thread.name) as procName,
        process.cmdline as cmdline
        from (select * from thread order by upid) as thread
        left join (select * from process order by upid) as process
        using(upid)`)).iter({utid:O.NUM,tid:O.NUM,pid:O.NUM_NULL,threadName:O.STR,procName:O.STR_NULL,cmdline:O.STR_NULL});t.valid();t.next()){var r=t.utid,n=t.tid,a=null===t.pid?void 0:t.pid,i=t.threadName,o=null===t.procName?void 0:t.procName,s=null===t.cmdline?void 0:t.cmdline;e.push({utid:r,tid:n,threadName:i,pid:a,procName:o,cmdline:s})}(0,v.publishThreads)(e)}async loadTimelineOverview(t){(0,v.clearOverviewData)();const a=(0,g.assertExists)(this.engine),i=m.Duration.max(1n,t.duration/100n);if(0<(await a.query("select ts from sched limit 1")).numRows()){var e=[];for(let n=t.start;n<t.end;n=m.Time.add(n,i)){var r=n-t.start,r=Number(r)/Number(t.duration);this.updateStatus("Loading overview "+Math.round(100*r)+"%");const d=m.Time.add(n,i);e.push((async()=>{for(var e={},t=(await a.query(`select cast(sum(dur) as float)/${i} as load, cpu from sched `+`where ts >= ${n} and ts < ${d} and utid != 0 `+"group by cpu order by cpu")).iter({load:O.NUM,cpu:O.NUM});t.valid();t.next()){var r=t.load;e[t.cpu]={start:n,end:d,load:r}}(0,v.publishOverviewData)(e)})())}await Promise.all(e)}else{for(var n={},o=(await a.query(`select
           bucket,
           upid,
           ifnull(sum(utid_sum) / cast(${i} as float), 0) as load
         from thread
         inner join (
           select
             ifnull(cast((ts - ${t.start})/${i} as int), 0) as bucket,
             sum(dur) as utid_sum,
             utid
           from slice
           inner join thread_track on slice.track_id = thread_track.id
           group by bucket, utid
         ) using(utid)
         where upid is not null
         group by bucket, upid`)).iter({bucket:O.LONG,upid:O.NUM,load:O.NUM});o.valid();o.next()){var s=o.bucket,l=o.upid,c=o.load,s=m.Time.add(t.start,i*s),u=m.Time.add(s,i),l=l.toString();let e=n[l];(e=void 0===e?n[l]=[]:e).push({start:s,end:u,load:c})}(0,v.publishOverviewData)(n)}}async cacheCurrentTrace(){var e,t=await(0,g.assertExists)(this.engine).query(`select str_value as uuid from metadata
                  where name = 'trace_uuid'`);return 0!==t.numRows()&&(t=t.firstRow({uuid:O.STR}).uuid,e=(0,g.assertExists)(b.globals.state.engine),(0,g.assertTrue)(e.id===this.engineId),await(0,r.cacheTrace)(e.source,t))?t:""}async initialiseHelperViews(){for(var i=(0,g.assertExists)(this.engine),e=(this.updateStatus("Creating annotation counter track table"),await i.query(`
      CREATE TABLE annotation_counter_track(
        id INTEGER PRIMARY KEY,
        name STRING,
        __metric_name STRING,
        upid INTEGER,
        min_value DOUBLE,
        max_value DOUBLE
      );
    `),this.updateStatus("Creating annotation slice track table"),await i.query(`
      CREATE TABLE annotation_slice_track(
        id INTEGER PRIMARY KEY,
        name STRING,
        __metric_name STRING,
        upid INTEGER,
        group_name STRING
      );
    `),this.updateStatus("Creating annotation counter table"),await i.query(`
      CREATE TABLE annotation_counter(
        id BIGINT,
        track_id INT,
        ts BIGINT,
        value DOUBLE,
        PRIMARY KEY (track_id, ts)
      ) WITHOUT ROWID;
    `),this.updateStatus("Creating annotation slice table"),await i.query(`
      CREATE TABLE annotation_slice(
        id INTEGER PRIMARY KEY,
        track_id INT,
        ts BIGINT,
        dur BIGINT,
        thread_dur BIGINT,
        depth INT,
        cat STRING,
        name STRING,
        UNIQUE(track_id, ts)
      );
    `),[]),t=(await i.query("select name from trace_metrics")).iter({name:O.STR});t.valid();t.next())e.push(t.name);var r,o,n=new Set(e);for([r,o]of B)if(r.get()&&n.has(o)){this.updateStatus(`Computing ${o} metric`);try{await i.computeMetric([o],"proto")}catch(e){if(e instanceof O.QueryError){(0,v.publishMetricError)("MetricError: "+e.message);continue}throw e}this.updateStatus(`Inserting data for ${o} metric`);try{var s=await i.query(`pragma table_info(${o}_event)`);let e=!1,t=!1,r=!1,n=!1,a=!1;for(var l=s.iter({name:O.STR});l.valid();l.next()){var c=l.name;e=e||"slice_name"===c,t=t||"dur"===c,r=r||"upid"===c,n=n||"value"===c,a=a||"group_name"===c}var u,d=r?"upid":"0 AS upid",f=r?"upid":"0",p=a?"group_name":"NULL AS group_name";e&&t&&(await i.query(`
            INSERT INTO annotation_slice_track(
              name, __metric_name, upid, group_name)
            SELECT DISTINCT
              track_name,
              '${o}' as metric_name,
              ${d},
              ${p}
            FROM ${o}_event
            WHERE track_type = 'slice'
          `),await i.query(`
            INSERT INTO annotation_slice(
              track_id, ts, dur, thread_dur, depth, cat, name
            )
            SELECT
              t.id AS track_id,
              ts,
              dur,
              NULL as thread_dur,
              0 AS depth,
              a.track_name as cat,
              slice_name AS name
            FROM ${o}_event a
            JOIN annotation_slice_track t
            ON a.track_name = t.name AND t.__metric_name = '${o}'
            ORDER BY t.id, ts
          `)),n&&(u=(await i.query(`
            SELECT
              IFNULL(MIN(value), 0) as minValue,
              IFNULL(MAX(value), 0) as maxValue
            FROM ${o}_event
            WHERE ${f} != 0`)).firstRow({minValue:O.NUM,maxValue:O.NUM}),await i.query(`
            INSERT INTO annotation_counter_track(
              name, __metric_name, min_value, max_value, upid)
            SELECT DISTINCT
              track_name,
              '${o}' as metric_name,
              CASE ${f} WHEN 0 THEN NULL ELSE ${u.minValue} END,
              CASE ${f} WHEN 0 THEN NULL ELSE ${u.maxValue} END,
              ${d}
            FROM ${o}_event
            WHERE track_type = 'counter'
          `),await i.query(`
            INSERT INTO annotation_counter(id, track_id, ts, value)
            SELECT
              -1 as id,
              t.id AS track_id,
              ts,
              value
            FROM ${o}_event a
            JOIN annotation_counter_track t
            ON a.track_name = t.name AND t.__metric_name = '${o}'
            ORDER BY t.id, ts
          `))}catch(e){if(!(e instanceof O.QueryError))throw e;(0,v.publishMetricError)("MetricError: "+e.message)}}}async includeSummaryTables(){var e=(0,g.assertExists)(this.engine);this.updateStatus("Creating slice summaries"),await e.query("include perfetto module viz.summary.slices;"),this.updateStatus("Creating counter summaries"),await e.query("include perfetto module viz.summary.counters;"),this.updateStatus("Creating thread summaries"),await e.query("include perfetto module viz.summary.threads;"),this.updateStatus("Creating processes summaries"),await e.query("include perfetto module viz.summary.processes;"),this.updateStatus("Creating track summaries"),await e.query("include perfetto module viz.summary.tracks;")}updateStatus(e){b.globals.dispatch(_.Actions.updateStatus({msg:e,timestamp:Date.now()/1e3}))}zoomPendingDeeplink(e,t){var e=m.Time.fromRaw(BigInt(e)),t=m.Time.fromRaw(BigInt(t)),r=b.globals.traceContext;e<t&&r.start<=e&&t<=r.end&&b.globals.timeline.updateVisibleTime(new m.TimeSpan(e,t))}}async function h(e){e=(await e.query(`SELECT RUN_METRIC('chrome/chrome_reliable_range.sql');
       SELECT start FROM chrome_reliable_range`)).firstRow({start:O.LONG});return m.Time.fromRaw(e.start)}UE.TraceController=$}return UE}function YS(){if(!qS){qS=1,Object.defineProperty(Kb,"__esModule",{value:!0}),Kb.initController=function(e){(0,a.assertTrue)(void 0===r),r=new t.AppController(e)},Kb.runControllers=function(){if(n)throw new Error("Re-entrant call detected");let t=!0;for(let e=0;t;e++){if(100<e)throw new Error("Controllers are stuck in a livelock");n=!0;try{t=(0,a.assertExists)(r).invoke()}finally{n=!1}}},pE||(pE=1,Object.defineProperty(Yb,"__esModule",{value:!0}),Mv(),Bv(),rE(),uE(),mE());const a=ee(),t=function(){if(!WS){WS=1,Object.defineProperty(yE,"__esModule",{value:!0}),yE.AppController=void 0;const r=re(),n=oe(),a=bE(),i=LE(),o=KS();class e extends a.Controller{extensionPort;constructor(e){super("main"),this.extensionPort=e}run(){var e,t=[];return r.RECORDING_V2_FLAG.get()||t.push((0,a.Child)("record",i.RecordController,{extensionPort:this.extensionPort})),void 0!==n.globals.state.engine&&(e=n.globals.state.engine,t.push((0,a.Child)(e.id,o.TraceController,e.id))),t}}yE.AppController=e}return yE}();let r,n=!1}return Kb}var JS,ZS={};function QS(){if(!JS){JS=1,Object.defineProperty(ZS,"__esModule",{value:!0}),ZS.initLiveReload=function(){var e=new EventSource("/live_reload");e.onmessage=e=>{var t,r,e=String(e.data);console.log("Live reload:",e),i.add(e),e.endsWith(".css")?(t=document.querySelector("link[rel=stylesheet]"))&&((r=t.parentElement).removeChild(t),r.appendChild(t)):(e.endsWith(".html")||e.endsWith(".js"))&&setTimeout(()=>{let e="";for(const r of i)e+=r+"\n";var t;i.clear(),Date.now()-n<a||(t=o.get()||confirm(e+"changed, click to reload"),n=Date.now(),t&&window.location.reload())},o.get()?0:1e3)},e.onerror=e=>{setTimeout(()=>console.error("LiveReload SSE error",e),1e3)}};var e=re();let n=0;const a=1e4,i=new Set,o=e.featureFlags.register({id:"rapidReload",name:"Development: rapid live reload",defaultValue:!1,description:"During development, instantly reload the page on change. Enables lower latency of live reload at the cost of potential multiple re-reloads.",devOnly:!0})}return ZS}var XS,eA={},tA={};var rA,nA={};var aA,iA={},oA={};var sA,lA={},cA={};function uA(){var e;return sA||(sA=1,e=cA,Object.defineProperty(e,"__esModule",{value:!0}),e.EXPANDED_BACKGROUND=e.COLLAPSED_BACKGROUND=e.FOREGROUND_COLOR=e.BACKGROUND_COLOR=e.DEFAULT_DETAILS_CONTENT_HEIGHT=e.OVERVIEW_TIMELINE_NON_VISIBLE_COLOR=e.SELECTION_FILL_COLOR=e.SELECTION_STROKE_COLOR=e.TOPBAR_HEIGHT=e.TRACK_BORDER_COLOR=e.SIDEBAR_WIDTH=e.TRACK_SHELL_WIDTH=void 0,e.initCssConstants=function(){e.TRACK_SHELL_WIDTH=t("--track-shell-width")??e.TRACK_SHELL_WIDTH,e.SIDEBAR_WIDTH=t("--sidebar-width")??e.SIDEBAR_WIDTH,e.TRACK_BORDER_COLOR=r("--track-border-color")??e.TRACK_BORDER_COLOR,e.TOPBAR_HEIGHT=t("--topbar-height")??e.TOPBAR_HEIGHT,e.SELECTION_STROKE_COLOR=r("--selection-stroke-color")??e.SELECTION_STROKE_COLOR,e.SELECTION_FILL_COLOR=r("--selection-fill-color")??e.SELECTION_FILL_COLOR,e.OVERVIEW_TIMELINE_NON_VISIBLE_COLOR=r("--overview-timeline-non-visible-color")??e.OVERVIEW_TIMELINE_NON_VISIBLE_COLOR,e.DEFAULT_DETAILS_CONTENT_HEIGHT=t("--details-content-height")??e.DEFAULT_DETAILS_CONTENT_HEIGHT,e.BACKGROUND_COLOR=r("--main-background-color")??e.BACKGROUND_COLOR,e.FOREGROUND_COLOR=r("--main-foreground-color")??e.FOREGROUND_COLOR,e.COLLAPSED_BACKGROUND=r("--collapsed-background")??e.COLLAPSED_BACKGROUND,e.EXPANDED_BACKGROUND=r("--expanded-background")??e.EXPANDED_BACKGROUND},e.TRACK_SHELL_WIDTH=100,e.SIDEBAR_WIDTH=100,e.TRACK_BORDER_COLOR="#ffc0cb",e.TOPBAR_HEIGHT=48,e.SELECTION_STROKE_COLOR="#00344596",e.SELECTION_FILL_COLOR="#8398e64d",e.OVERVIEW_TIMELINE_NON_VISIBLE_COLOR="#c8c8c8cc",e.DEFAULT_DETAILS_CONTENT_HEIGHT=280,e.BACKGROUND_COLOR="#ffffff",e.FOREGROUND_COLOR="#222",e.COLLAPSED_BACKGROUND="#ffffff",e.EXPANDED_BACKGROUND="#ffffff"),cA;function r(e){var t;if("undefined"!=typeof window)return t=window.document.body,""===(t=window.getComputedStyle(t).getPropertyValue(e))?void 0:t}function t(e){e=r(e);if(void 0!==e){var t=e.match(/^\W*(\d+)px(|\!important')$/);if(t)return Number(t[1]);throw Error(`Could not parse CSS property "${e}" as a number`)}}}var dA,fA,pA,hA={};function gA(){if(!dA){dA=1;{var t=hA;Object.defineProperty(t,"__esModule",{value:!0}),t.MIN_PX_PER_STEP=t.TickType=void 0,t.getPattern=c,t.getMaxMajorTicks=function(e){return Math.max(1,Math.floor(e/t.MIN_PX_PER_STEP))},t.generateTicks=function*(t,e,r=d.Time.ZERO){(0,u.assertTrue)(0n<t.duration,"timeSpan.duration cannot be lte 0"),(0,u.assertTrue)(0<e,"maxMajorTicks cannot be lte 0"),t=t.translate(-r);var e=BigInt(Math.floor(Number(t.duration)/e)),[e,n]=c(e),a=function(t){var e=Array.from(t);return e.map(e=>{switch(e){case"|":return l.MAJOR;case":":return l.MEDIUM;case".":return l.MINOR;default:throw Error(`Invalid char "${e}" in pattern "${t}"`)}})}(n),i=e/BigInt(a.length),n=d.Time.quantFloor(t.start,e),o=t.end;let s=0;for(let e=n;e<o;e=d.Time.add(e,i),s++)e>=t.start&&(s%=a.length,yield{type:a[s],time:d.Time.add(e,r)})};const u=ee(),d=K();var l,e=1000n,r=1000n*e,n=1000n*r,a=60n*n,i=60n*a,o=24n*i;const s=[[1n,"|"],[2n,"|:"],[5n,"|...."],[10n,"|....:...."],[20n,"|.:."],[50n,"|...."],[100n,"|....:...."],[200n,"|.:."],[500n,"|...."],[1n*e,"|....:...."],[2n*e,"|.:."],[5n*e,"|...."],[10n*e,"|....:...."],[20n*e,"|.:."],[50n*e,"|...."],[100n*e,"|....:...."],[200n*e,"|.:."],[500n*e,"|...."],[1n*r,"|....:...."],[2n*r,"|.:."],[5n*r,"|...."],[10n*r,"|....:...."],[20n*r,"|.:."],[50n*r,"|...."],[100n*r,"|....:...."],[200n*r,"|.:."],[500n*r,"|...."],[1n*n,"|....:...."],[2n*n,"|.:."],[5n*n,"|...."],[10n*n,"|....:...."],[30n*n,"|.:.:."],[1n*a,"|....."],[2n*a,"|.:."],[5n*a,"|....."],[10n*a,"|....:...."],[30n*a,"|.:.:."],[1n*i,"|....."],[2n*i,"|.:."],[6n*i,"|....."],[12n*i,"|.....:....."],[1n*o,"|.:."],[2n*o,"|.:."],[5n*o,"|...."],[10n*o,"|....:...."],[20n*o,"|.:."],[50n*o,"|...."],[100n*o,"|....:...."],[200n*o,"|.:."],[500n*o,"|...."],[1000n*o,"|....:...."],[2000n*o,"|.:."],[5000n*o,"|...."],[10000n*o,"|....:...."],[20000n*o,"|.:."],[50000n*o,"|...."],[100000n*o,"|....:...."],[200000n*o,"|.:."]];function c(e){for(var[t,r]of s)if(t>=e)return[t,r];throw new Error("Pattern not defined for this minsize")}(e=l||(t.TickType=l={}))[e.MAJOR=0]="MAJOR",e[e.MEDIUM=1]="MEDIUM",e[e.MINOR=2]="MINOR",t.MIN_PX_PER_STEP=120}}return hA}function mA(){if(!fA){fA=1,Object.defineProperty(lA,"__esModule",{value:!0}),lA.NotesEditorTab=lA.NotesPanel=void 0;const n=or.__importDefault(ae()),a=hl(),i=X(),m=K(),_=ne(),o=M(),s=ie(),l=le(),e=Oc(),c=uA(),y=oe(),T=gA(),r=RT(),u=x(),d=P(),f=ee(),b=Yo(),p=Rs();lA.NotesPanel=class{kind="panel";selectable=!1;timescale;hoveredX=null;render(){const t=Object.values(y.globals.state.trackGroups).every(e=>e.collapsed);return(0,n.default)(".notes-panel",{onclick:e=>{var{x:t,y:r}=(0,a.currentTargetOffset)(e);this.onClick(t-c.TRACK_SHELL_WIDTH,r),e.stopPropagation()},onmousemove:e=>{this.hoveredX=(0,a.currentTargetOffset)(e).x-c.TRACK_SHELL_WIDTH,s.raf.scheduleRedraw()},onmouseenter:e=>{this.hoveredX=(0,a.currentTargetOffset)(e).x-c.TRACK_SHELL_WIDTH,s.raf.scheduleRedraw()},onmouseout:()=>{this.hoveredX=null,y.globals.dispatch(_.Actions.setHoveredNoteTimestamp({ts:m.Time.INVALID}))}},(0,r.isTraceLoaded)()&&(0,n.default)(l.ButtonBar,{className:"pf-toolbar"},(0,n.default)(l.Button,{onclick:e=>{e.preventDefault(),t?y.globals.commandManager.runCommand("perfetto.CoreCommands#ExpandAllGroups"):y.globals.commandManager.runCommand("perfetto.CoreCommands#CollapseAllGroups")},title:t?"Expand all":"Collapse all",icon:t?"unfold_more":"unfold_less",compact:!0}),(0,n.default)(l.Button,{onclick:e=>{e.preventDefault(),y.globals.dispatch(_.Actions.clearAllPinnedTracks({}))},title:"Clear all pinned tracks",icon:"clear_all",compact:!0}),(0,n.default)(e.TextInput,{placeholder:"Filter tracks...",title:"Track filter - enter one or more comma-separated search terms",value:y.globals.state.trackFilterTerm,oninput:e=>{e=e.target.value;y.globals.dispatch(_.Actions.setTrackFilterTerm({filterTerm:e}))}}),(0,n.default)(l.Button,{type:"reset",icon:"backspace",onclick:()=>{y.globals.dispatch(_.Actions.setTrackFilterTerm({filterTerm:void 0}))},title:"Clear track filter"})))}renderCanvas(e,t){e.fillStyle="#999",e.fillRect(c.TRACK_SHELL_WIDTH-2,0,2,t.height);t={...t,width:t.width-c.TRACK_SHELL_WIDTH};e.save(),e.translate(c.TRACK_SHELL_WIDTH,0),(0,p.canvasClip)(e,0,0,t.width,t.height),this.renderPanel(e,t),e.restore()}renderPanel(e,t){let r=!1;var n=y.globals.timeline.visibleWindow,a=new b.TimeScale(n,new b.PxSpan(0,t.width)),i=n.toTimeSpan();if(this.timescale=a,0<t.width&&0n<i.duration){var o,s,l=(0,T.getMaxMajorTicks)(t.width),c=y.globals.timestampOffset();for({type:o,time:s}of(0,T.generateTicks)(i,l,c)){var u=Math.floor(a.timeToPx(s));o===T.TickType.MAJOR&&e.fillRect(u,0,1,t.height)}}e.textBaseline="bottom",e.font="10px Helvetica";for(const h of Object.values(y.globals.state.notes)){var d,f,p=g(h);"DEFAULT"===h.noteType&&!n.contains(h.timestamp)||"SPAN"===h.noteType&&!n.overlaps(h.start,h.end)||(null!==this.hoveredX&&this.hitTestNote(this.hoveredX,h)&&(r=!0),f="note"===(f=y.globals.state.selection).kind&&f.id===h.id,p=a.timeToPx(p),p=Math.floor(p),"SPAN"===h.noteType?this.drawAreaMarker(e,p,Math.floor(a.timeToPx(h.end)),h.color,f):this.drawFlag(e,p,t.height,h.color,f),h.text&&(f=h.text,d=void 0,d=0<f.indexOf("\n")?f.indexOf("\n"):f.length,d=f.slice(0,Math.min(d,f.length,16)),f=e.measureText(d),e.fillStyle="rgba(255, 255, 255, 0.8)",e.fillRect(p+16+2,t.height+2,f.width+2,-12),e.fillStyle="#3c4b5d",e.fillText(d,p+16+3,t.height+1)))}r&&y.globals.dispatch(_.Actions.setHoveredNoteTimestamp({ts:m.Time.INVALID})),r||null===this.hoveredX||(i=a.pxToHpTime(this.hoveredX).toTime(),n.contains(i)&&(y.globals.dispatch(_.Actions.setHoveredNoteTimestamp({ts:i})),l=a.timeToPx(i),c=Math.floor(l),this.drawFlag(e,c,t.height,"#aaa",!0))),e.restore()}drawAreaMarker(e,t,r,n,a){e.fillStyle=n,e.strokeStyle=n;0<=t&&(e.beginPath(),e.moveTo(t,10),e.lineTo(t,20),e.lineTo(t+10,10),e.lineTo(t,10),a&&e.fill(),e.stroke()),e.beginPath(),e.moveTo(r,10),e.lineTo(r,20),e.lineTo(r-10,10),e.lineTo(r,10),a&&e.fill(),e.stroke();n=Math.max(t,0);e.beginPath(),e.moveTo(n,10),e.lineTo(r,10),e.stroke()}drawFlag(e,t,r,n,a){var i=e.font,o=e.textBaseline;e.textBaseline="alphabetic",e.font="24px Material Symbols Sharp",e.fillStyle=n,e.strokeStyle=n;a?e.fillText("",t-6,r+2):e.strokeText("",t-6,r+2.5),e.font=i,e.textBaseline=o}onClick(e,t){if(this.timescale&&!(e<0)){for(const a of Object.values(y.globals.state.notes))if(null!==this.hoveredX&&this.hitTestNote(this.hoveredX,a))return void y.globals.makeSelection(_.Actions.selectNote({id:a.id}));var e=this.timescale.pxToHpTime(e).toTime(),r=(0,d.uuidv4)(),n=(0,o.randomColor)();y.globals.dispatchMultiple([_.Actions.addNote({id:r,timestamp:e,color:n}),_.Actions.selectNote({id:r})])}}hitTestNote(e,t){var r,n;return!!this.timescale&&(n=(r=this.timescale).timeToPx(g(t)),"SPAN"===t.noteType?n<=e&&e<n+10||r.timeToPx(t.end)>e&&e>r.timeToPx(t.end)-10:n<=e&&e<n+16)}};function g(e){var t=e.noteType;switch(t){case"SPAN":return e.start;case"DEFAULT":return e.timestamp;default:(0,f.assertUnreachable)(t)}}lA.NotesEditorTab=class{render(e){if("note"===e.kind){const r=e.id;var t,e=y.globals.state.notes[r];return void 0===e?(0,n.default)(".","No Note with id "+r):(t=g(e),(0,n.default)(".notes-editor-panel",(0,n.default)(".notes-editor-panel-heading-bar",(0,n.default)(".notes-editor-panel-heading","Annotation at ",(0,n.default)(u.Timestamp,{ts:t})),(0,n.default)("input[type=text]",{value:e.text,onchange:e=>{e=e.target.value;y.globals.dispatch(_.Actions.changeNoteText({id:r,newText:e}))}}),(0,n.default)("span.color-change","Change color: ",(0,n.default)("input[type=color]",{value:e.color,onchange:e=>{e=e.target.value;y.globals.dispatch(_.Actions.changeNoteColor({id:r,newColor:e}))}})),(0,n.default)(l.Button,{label:"Remove",icon:i.Icons.Delete,onclick:()=>{y.globals.dispatch(_.Actions.removeNote({id:r})),s.raf.scheduleFullRedraw()}}))))}}}}return lA}function _A(){if(!pA){pA=1,Object.defineProperty(iA,"__esModule",{value:!0}),iA.Notes=void 0;const t=or.__importDefault(ae()),r=oe(),n=function(){if(!aA){aA=1,Object.defineProperty(oA,"__esModule",{value:!0}),oA.NotesManager=void 0;const r=or.__importDefault(ae()),n=oe(),a=ne(),i=le(),o=X();oA.NotesManager=class{view(e){var t=Object.entries(n.globals.state.notes);return 0===t.length?"No notes found":(0,r.default)("table",(0,r.default)("thead",(0,r.default)("tr",(0,r.default)("td","ID"),(0,r.default)("td","Color"),(0,r.default)("td","Type"),(0,r.default)("td","Text"),(0,r.default)("td","Delete"))),(0,r.default)("tbody",t.map(([e,t])=>(0,r.default)("tr",(0,r.default)("td",e),(0,r.default)("td",t.color),(0,r.default)("td",t.noteType),(0,r.default)("td",t.text),(0,r.default)("td",(0,r.default)(i.Button,{icon:o.Icons.Delete,onclick:()=>{n.globals.dispatch(a.Actions.removeNote({id:e}))}}))))))}}}return oA}(),a=mA();var e=V();class i{trash=new e.DisposableStack;constructor(){this.trash.use(r.globals.tabManager.registerDetailsPanel(new a.NotesEditorTab)),this.trash.use(r.globals.tabManager.registerTab({uri:"notes.manager",isEphemeral:!1,content:{getTitle:()=>"Notes & markers",render:()=>(0,t.default)(n.NotesManager)}}))}[Symbol.dispose](){this.trash.dispose()}}iA.Notes=i}return iA}var yA,TA={};var bA,vA={};function EA(){if(!bA){bA=1,Object.defineProperty(vA,"__esModule",{value:!0}),vA.executeSearch=function(e=!1){var t=p.globals.state.searchIndex,r=p.globals.timeline.visibleWindow.toTimeSpan(),n=r.start,r=r.end,a=p.globals.currentSearchResults.tses[t];if(0!==p.globals.currentSearchResults.totalResults){-1===t||-1n!==a&&(a<n||r<a)?e?([a]=(0,u.searchSegment)(p.globals.currentSearchResults.tses,r),-1===a?l(t):p.globals.dispatch(f.Actions.setSearchIndex({index:a}))):([,r]=(0,u.searchSegment)(p.globals.currentSearchResults.tses,n),-1===r?c(t):p.globals.dispatch(f.Actions.setSearchIndex({index:r}))):(e?l:c)(t);var a=p.globals.state.searchIndex,i=p.globals.currentSearchResults.sources[a],o=p.globals.currentSearchResults.eventIds[a],s=p.globals.currentSearchResults.trackKeys[a];if(void 0!==o)switch(i){case"track":(0,h.verticalScrollToTrack)(s,!0);break;case"cpu":p.globals.setLegacySelection({kind:"SCHED_SLICE",id:o,trackKey:s},{clearSearch:!1,pendingScrollId:o,switchToCurrentSelectionTab:!0});break;case"log":p.globals.setLegacySelection({kind:"LOG",id:o,trackKey:s},{clearSearch:!1,pendingScrollId:o,switchToCurrentSelectionTab:!0});break;case"slice":p.globals.setLegacySelection({kind:"SLICE",id:o,trackKey:s,table:"slice"},{clearSearch:!1,pendingScrollId:o,switchToCurrentSelectionTab:!0});break;default:(0,d.assertUnreachable)(i)}}};const u=Wf(),d=ee(),f=ne(),p=oe(),h=Bc();function l(e){let t=e-1;t<0&&(t=p.globals.currentSearchResults.totalResults-1),p.globals.dispatch(f.Actions.setSearchIndex({index:t}))}function c(e){e=(e+1)%p.globals.currentSearchResults.totalResults;p.globals.dispatch(f.Actions.setSearchIndex({index:e}))}}return vA}var SA,AA,OA={},CA={};function kA(){if(!SA){SA=1,Object.defineProperty(CA,"__esModule",{value:!0}),CA.taskTracker=CA.TaskTracker=void 0;class e{promisesSeen;promisesRejected;promisesFulfilled;promiseInfo;constructor(){this.promisesSeen=0,this.promisesRejected=0,this.promisesFulfilled=0,this.promiseInfo=new Map}trackPromise(e,t){this.promiseInfo.set(e,{startTimeMs:(new Date).getMilliseconds(),message:t}),this.promisesSeen+=1,e.then(()=>{this.promisesFulfilled+=1}).catch(()=>{this.promisesRejected+=1}).finally(()=>{this.promiseInfo.delete(e)})}hasPendingTasks(){return this.promisesSeen>this.promisesFulfilled+this.promisesRejected}progressMessage(){var e,t=this.promiseInfo.values().next()["value"];return void 0===t?t:(e=(new Date).getMilliseconds(),e=Math.round((e-t.startTimeMs)/1e3),t.message+` (${e}s)`)}}CA.TaskTracker=e,CA.taskTracker=new e}return CA}function wA(){if(!AA){AA=1;{var t=OA;Object.defineProperty(t,"__esModule",{value:!0}),t.Topbar=t.DISMISSED_PANNING_HINT_KEY=void 0;const r=or.__importDefault(ae()),n=Qs(),a=ie(),i=oe(),o=kA(),s=bl(),l=ee(),e=So();t.DISMISSED_PANNING_HINT_KEY="dismissedPanningHint";class c{view(e){var t=(0,n.classNames)(this.isLoading()&&"progress-anim");return(0,r.default)(".progress",{class:t})}isLoading(){var e=i.globals.getCurrentEngine();return e&&!e.ready||0<i.globals.numQueuedQueries||o.taskTracker.hasPendingTasks()}}class u{view(){var e=localStorage.getItem(t.DISMISSED_PANNING_HINT_KEY);if(!i.globals.embeddedMode&&"true"!==e&&i.globals.showPanningHint)return(0,r.default)(".helpful-hint",(0,r.default)(".hint-text","Are you trying to pan? Use the WASD keys or hold shift to click and drag. Press '?' for more help."),(0,r.default)("button.hint-dismiss-button",{onclick:()=>{i.globals.showPanningHint=!1,localStorage.setItem(t.DISMISSED_PANNING_HINT_KEY,"true"),a.raf.scheduleFullRedraw()}},"Dismiss"))}}class d{view(){if(!i.globals.embeddedMode){var e=i.globals.state.omniboxState.mode,t=i.globals.traceErrors;if((Boolean(t)||i.globals.metricError)&&"COMMAND"!==e)return e=Boolean(t)?t+" import or data loss errors detected.":"Metric error detected.",(0,r.default)(".error-box",(0,r.default)(s.Popup,{trigger:(0,r.default)(".popup-trigger"),isOpen:i.globals.showTraceErrorPopup,position:s.PopupPosition.Left,onChange:e=>{(0,l.assertFalse)(e),i.globals.showTraceErrorPopup=!1}},(0,r.default)(".error-popup","Data-loss/import error. Click for more info.")),(0,r.default)("a.error",{href:"#!/info"},(0,r.default)("i.material-icons",{title:e+" Click for more info."},"announcement")))}}}class f{view(){return(0,r.default)("button.topbar-button",{onclick:()=>{window.clearAllCaches(),e.Router.navigate("#!/")}},(0,r.default)("i.material-icons","refresh"))}}t.Topbar=class{view({attrs:e}){e=e.omnibox;return(0,r.default)(".topbar",{class:i.globals.state.sidebarVisible?"":"hide-sidebar"},e,(0,r.default)(c),(0,r.default)(u),(0,r.default)(d),(0,r.default)(f))}}}}return OA}var RA,IA,MA={},PA={},NA={};function DA(){return RA||(RA=1,Object.defineProperty(NA,"__esModule",{value:!0}),NA.isEmptyData=function(e){return 0===e.columns.length||0===e.columns[0].data.length}),NA}var xA,LA={};function FA(){if(!xA){xA=1;{var a=LA;Object.defineProperty(a,"__esModule",{value:!0}),a.FlowEventsAreaSelectedPanel=a.FlowEventsPanel=a.ALL_CATEGORIES=void 0,a.getFlowCategories=i;const s=or.__importDefault(ae()),o=X(),l=ne(),t=Y(),c=ie(),u=oe(),d=L(),r=wy();function i(e){var t,r=[];return e.category?r.push(...e.category.split(",")):(t=e.begin.sliceCategory.split(","),e=e.end.sliceCategory.split(","),r.push(...new Set([...t,...e]))),r}a.ALL_CATEGORIES="_all_";a.FlowEventsPanel=class{view(){const a=(0,t.getLegacySelection)(u.globals.state);if(!a)return(0,s.default)(r.EmptyState,{className:"pf-noselection",title:"Nothing selected"},"Flow data will appear here");if("SLICE"!==a.kind)return(0,s.default)(r.EmptyState,{className:"pf-noselection",title:"No flow data",icon:"warning"},`Flows are not applicable to the selection kind: '${a.kind}'`);const i=0<u.globals.connectedFlows.filter(e=>e.category).length;var e=[(0,s.default)("th","Direction"),(0,s.default)("th","Duration"),(0,s.default)("th","Connected Slice ID"),(0,s.default)("th","Connected Slice Name"),(0,s.default)("th","Thread Out"),(0,s.default)("th","Thread In"),(0,s.default)("th","Process Out"),(0,s.default)("th","Process In")];i&&(e.push((0,s.default)("th","Flow Category")),e.push((0,s.default)("th","Flow Name")));const o=[(0,s.default)("tr",e)];return u.globals.connectedFlows.forEach(e=>{if(a.id===e.begin.sliceId||a.id===e.end.sliceId){var t=a.id===e.begin.sliceId;const n=t?e.end:e.begin;var r={onclick:()=>{var e=n.sliceId,t=n.trackId;(t=u.globals.trackManager.trackKeyByTrackId.get(t))&&u.globals.setLegacySelection({kind:"SLICE",id:e,trackKey:t,table:"slice"},{clearSearch:!0,pendingScrollId:void 0,switchToCurrentSelectionTab:!1})},onmousemove:()=>u.globals.dispatch(l.Actions.setHighlightedSliceId({sliceId:n.sliceId})),onmouseleave:()=>u.globals.dispatch(l.Actions.setHighlightedSliceId({sliceId:-1}))},t=[(0,s.default)("td.flow-link",r,t?"Outgoing":"Incoming"),(0,s.default)("td.flow-link",r,(0,s.default)(d.DurationWidget,{dur:e.dur})),(0,s.default)("td.flow-link",r,n.sliceId.toString()),(0,s.default)("td.flow-link",r,n.sliceName),(0,s.default)("td.flow-link",r,e.begin.threadName),(0,s.default)("td.flow-link",r,e.end.threadName),(0,s.default)("td.flow-link",r,e.begin.processName),(0,s.default)("td.flow-link",r,e.end.processName)];i&&(t.push((0,s.default)("td.flow-info",e.category??"-")),t.push((0,s.default)("td.flow-info",e.name??"-"))),o.push((0,s.default)("tr",t))}}),(0,s.default)(".details-panel",[(0,s.default)(".details-panel-heading",(0,s.default)("h2","Flow events")),(0,s.default)(".flow-events-table",(0,s.default)("table",o))])}};a.FlowEventsAreaSelectedPanel=class{view(){var e=u.globals.state.selection;if("area"===e.kind){e=[(0,s.default)("th","Flow Category"),(0,s.default)("th","Number of flows"),(0,s.default)("th","Show",(0,s.default)("a.warning",(0,s.default)("i.material-icons","warning"),(0,s.default)(".tooltip","Showing a large number of flows may impact performance.")))];const n=[(0,s.default)("tr",e)],t=new Map,r=(u.globals.selectedFlows.forEach(e=>{i(e).forEach(e=>{t.has(e)||t.set(e,0),t.set(e,t.get(e)+1)})}),u.globals.visibleFlowCategories.get(a.ALL_CATEGORIES));return n.push((0,s.default)("tr.sum",[(0,s.default)("td.sum-data","All"),(0,s.default)("td.sum-data",u.globals.selectedFlows.length),(0,s.default)("td.sum-data",(0,s.default)("i.material-icons",{onclick:()=>{r?u.globals.visibleFlowCategories.clear():t.forEach((e,t)=>{u.globals.visibleFlowCategories.set(t,!0)}),u.globals.visibleFlowCategories.set(a.ALL_CATEGORIES,!r),c.raf.scheduleFullRedraw()}},r?o.Icons.Checkbox:o.Icons.BlankCheckbox))])),t.forEach((e,t)=>{const r=u.globals.visibleFlowCategories.get(t)||u.globals.visibleFlowCategories.get(a.ALL_CATEGORIES);e=[(0,s.default)("td.flow-info",t),(0,s.default)("td.flow-info",e),(0,s.default)("td.flow-info",(0,s.default)("i.material-icons",{onclick:()=>{r&&u.globals.visibleFlowCategories.set(a.ALL_CATEGORIES,!1),u.globals.visibleFlowCategories.set(t,!r),c.raf.scheduleFullRedraw()}},r?o.Icons.Checkbox:o.Icons.BlankCheckbox))];n.push((0,s.default)("tr",e))}),(0,s.default)(".details-panel",[(0,s.default)(".details-panel-heading",(0,s.default)("h2","Selected flow events")),(0,s.default)(".flow-events-table",(0,s.default)("table",n))])}}}}}return LA}var UA,BA={},jA={};var HA,GA,VA,WA,qA,$A={},zA={};function KA(){if(!GA){GA=1,Object.defineProperty($A,"__esModule",{value:!0}),$A.AttributeModalHolder=void 0;const e=or.__importDefault(ae()),t=de(),r=function(){if(!HA){HA=1,Object.defineProperty(zA,"__esModule",{value:!0}),zA.ArgumentPopup=void 0;const e=or.__importDefault(ae()),r=ie();zA.ArgumentPopup=class{argument="";setArgument(e,t){this.argument=t,e.onArgumentChange(t),r.raf.scheduleFullRedraw()}view({attrs:t}){return(0,e.default)(".name-completion",(0,e.default)("input",{oncreate:e=>e.dom.focus(),oninput:e=>{e=e.target;this.setArgument(t,e.value)},value:this.argument}))}}}return zA}();$A.AttributeModalHolder=class{typedArgument="";callback;constructor(e){this.callback=e}start(){(0,t.showModal)({title:"Enter argument name",content:()=>this.renderModalContents(),buttons:[{text:"Add",action:()=>{this.callback(this.typedArgument),this.typedArgument=""}}]})}renderModalContents(){return(0,e.default)(r.ArgumentPopup,{onArgumentChange:e=>{this.typedArgument=e}})}}}return $A}function YA(){if(!VA){VA=1,Object.defineProperty(BA,"__esModule",{value:!0}),BA.PivotTable=void 0,BA.markFirst=p;const h=or.__importDefault(ae()),r=J(),c=ne(),u=ma(),d=ie(),f=oe(),g=NS(),m=En(),_=Rm(),s=function(){if(!UA){UA=1,Object.defineProperty(jA,"__esModule",{value:!0}),jA.ReorderableCellGroup=void 0;const r=or.__importDefault(ae()),a=ie(),i=document.createElement("span");jA.ReorderableCellGroup=class{draggingFrom=-1;draggingTo=-1;dropDirection="left";enterCounters=[];getClassForIndex(e){return this.draggingFrom===e?"dragged":this.draggingTo===e?"left"===this.dropDirection?"highlight-left":"highlight-right":""}view(t){return t.attrs.cells.map((e,n)=>(0,r.default)("td.reorderable-cell"+(e.extraClass??""),{draggable:"draggable",class:this.getClassForIndex(n),ondragstart:e=>{this.draggingFrom=n,null!==e.dataTransfer&&e.dataTransfer.setDragImage(i,0,0),a.raf.scheduleFullRedraw()},ondragover:e=>{let t=e.target;if(this.draggingFrom!==n&&-1!==this.draggingFrom){for(;"td"!==t.tagName.toLowerCase()&&null!==t.parentElement;)t=t.parentElement;var e=e.clientX-t.getBoundingClientRect().x>t.clientWidth/2?"right":"left",r=e!==this.dropDirection||n!==this.draggingTo;this.dropDirection=e,this.draggingTo=n,r&&a.raf.scheduleFullRedraw()}},ondragenter:e=>{this.enterCounters[n]++,1===this.enterCounters[n]&&null!==e.dataTransfer&&(e.dataTransfer.dropEffect="move")},ondragleave:e=>{this.enterCounters[n]--,-1===this.draggingFrom||0<this.enterCounters[n]||(null!==e.dataTransfer&&(e.dataTransfer.dropEffect="none"),this.draggingTo=-1,a.raf.scheduleFullRedraw())},ondragend:()=>{this.draggingTo!==this.draggingFrom&&-1!==this.draggingTo&&t.attrs.onReorder(this.draggingFrom,this.draggingTo,this.dropDirection),this.draggingFrom=-1,this.draggingTo=-1,a.raf.scheduleFullRedraw()}},e.content))}oncreate(e){this.enterCounters=Array(e.attrs.cells.length).fill(0)}onupdate(e){this.enterCounters.length!==e.attrs.cells.length&&(this.enterCounters=Array(e.attrs.cells.length).fill(0))}}}return jA}(),e=KA(),a=L(),i=rf(),y=ga();function n(e){var t=function(e){switch(e.kind){case"argument":return(0,g.extractArgumentExpression)(e.argument,y.SqlTables.slice.name);case"regular":return""+e.column}}(e.column);if(null===e.value)return t+" IS NULL";if("number"==typeof e.value)return t+" = "+e.value;if(e.value instanceof Uint8Array)throw new Error("BLOB as DrillFilter not implemented");return"bigint"==typeof e.value?t+" = "+e.value:t+" = "+(0,r.sqliteString)(e.value)}function l(e){switch(e.kind){case"argument":return"Argument "+e.argument;case"regular":return""+e.column}}function p(e){return 0===e?".first":""}BA.PivotTable=class{constructor(){this.attributeModalHolder=new e.AttributeModalHolder(e=>{f.globals.dispatch(c.Actions.setPivotTablePivotSelected({column:{kind:"argument",argument:e},selected:!0})),f.globals.dispatch(c.Actions.setPivotTableQueryRequested({queryRequested:!0}))})}get pivotState(){return f.globals.state.nonSerializableState.pivotTable}get constrainToArea(){return f.globals.state.nonSerializableState.pivotTable.constrainToArea}renderDrillDownCell(t,r){return(0,h.default)("td",(0,h.default)("button",{title:"All corresponding slices",onclick:()=>{var e=r.map(n);this.constrainToArea&&e.push(...(0,g.areaFilters)(t)),(0,i.addSqlTableTab)({table:y.SqlTables.slice,filters:e})}},(0,h.default)("i.material-icons","arrow_right")))}renderSectionRow(e,t,r,n){var a=[];for(let e=0;e+1<t.length;e++)a.push((0,h.default)("td",(0,h.default)("span.indent"," "),""+t[e].nextKey));var i=n.metadata.pivotColumns.length-t.length+1,o=(0,h.default)("button",{onclick:()=>{r.isCollapsed=!r.isCollapsed,d.raf.scheduleFullRedraw()}},(0,h.default)("i.material-icons",r.isCollapsed?"expand_more":"expand_less"));a.push((0,h.default)("td",{colspan:i},o,""+t[t.length-1].nextKey));for(let e=0;e<n.metadata.aggregationColumns.length;e++){var s=this.renderCell(n.metadata.aggregationColumns[e].column,r.aggregates[e]);a.push((0,h.default)("td"+p(e),s))}var l=[];for(let e=0;e<t.length;e++)l.push({value:""+t[e].nextKey,column:n.metadata.pivotColumns[e]});return a.push(this.renderDrillDownCell(e,l)),(0,h.default)("tr",a)}renderCell(e,t){return"regular"!==e.kind||"dur"!==e.column&&"thread_dur"!==e.column||"bigint"!=typeof t?""+t:(0,h.default)(a.DurationWidget,{dur:t})}renderTree(e,t,r,n,a){if(r.isCollapsed)a.push(this.renderSectionRow(e,t,r,n));else if(0<r.children.size){!r.isCollapsed&&0<t.length&&1!==r.children.size&&a.push(this.renderSectionRow(e,t,r,n));for(var[i,o]of r.children.entries())t.push({tree:o,nextKey:i}),this.renderTree(e,t,o,n,a),t.pop()}else{!r.isCollapsed&&0<t.length&&1<r.rows.length&&a.push(this.renderSectionRow(e,t,r,n));for(const f of r.rows){var s=[],l=[],c=n.metadata.pivotColumns.length;for(let e=0;e<c;e++){var u=this.renderCell(n.metadata.pivotColumns[e],f[e]);e<t.length?s.push((0,h.default)("td",(0,h.default)("span.indent"," "),u)):s.push((0,h.default)("td",u)),l.push({column:n.metadata.pivotColumns[e],value:f[e]})}for(let e=0;e<n.metadata.aggregationColumns.length;e++){var d=f[(0,g.aggregationIndex)(c,e)],d=this.renderCell(n.metadata.aggregationColumns[e].column,d);s.push((0,h.default)("td.aggregation"+p(e),d))}s.push(this.renderDrillDownCell(e,l)),a.push((0,h.default)("tr",s))}}}renderTotalsRow(t){var r=[(0,h.default)("td.total-values",{colspan:t.metadata.pivotColumns.length},(0,h.default)("strong","Total values:"))];for(let e=0;e<t.metadata.aggregationColumns.length;e++)r.push((0,h.default)("td"+p(e),this.renderCell(t.metadata.aggregationColumns[e].column,t.tree.aggregates[e])));return r.push((0,h.default)("td")),(0,h.default)("tr",r)}sortingItem(e,t){return{itemType:"regular",text:"DESC"===t?"Highest first":"Lowest first",callback(){f.globals.dispatch(c.Actions.setPivotTableSortColumn({aggregationIndex:e,order:t})),f.globals.dispatch(c.Actions.setPivotTableQueryRequested({queryRequested:!0}))}}}readableAggregationName(e){return"COUNT"===e.aggregationFunction?"Count":`${e.aggregationFunction}(${l(e.column)})`}aggregationPopupItem(e,t,r){return{itemType:"regular",text:r??l(e.column),callback:()=>{f.globals.dispatch(c.Actions.addPivotTableAggregation({aggregation:e,after:t})),f.globals.dispatch(c.Actions.setPivotTableQueryRequested({queryRequested:!0}))}}}aggregationPopupTableGroup(e,t,r){var n=[];for(const i of t){var a={kind:"regular",table:e,column:i};n.push(this.aggregationPopupItem({aggregationFunction:"SUM",column:a},r))}if(0!==n.length)return{itemType:"group",itemId:"aggregations-"+e,text:`Add ${e} aggregation`,children:n}}renderAggregationHeaderCell(e,t,r){var n=[],a=f.globals.state.nonSerializableState.pivotTable;void 0===e.sortDirection?n.push(this.sortingItem(t,"DESC"),this.sortingItem(t,"ASC")):n.push(this.sortingItem(t,"DESC"===e.sortDirection?"ASC":"DESC"));if("COUNT"!==e.aggregationFunction)for(const o of["SUM","MAX","MIN","AVG"])e.aggregationFunction!==o&&n.push({itemType:"regular",text:o,callback(){f.globals.dispatch(c.Actions.setPivotTableAggregationFunction({index:t,function:o})),f.globals.dispatch(c.Actions.setPivotTableQueryRequested({queryRequested:!0}))}});r&&n.push({itemType:"regular",text:"Remove",callback:()=>{f.globals.dispatch(c.Actions.removePivotTableAggregation({index:t})),f.globals.dispatch(c.Actions.setPivotTableQueryRequested({queryRequested:!0}))}});let i=!1;for(const s of a.selectedAggregations.values())"COUNT"===s.aggregationFunction&&(i=!0);i||n.push(this.aggregationPopupItem(u.COUNT_AGGREGATION,t,"Add count aggregation"));r=this.aggregationPopupTableGroup(y.SqlTables.slice.name,g.sliceAggregationColumns,t);return void 0!==r&&n.push(r),{extraClass:".aggregation"+p(t),content:[this.readableAggregationName(e),(0,h.default)(_.PopupMenuButton,{icon:(0,_.popupMenuIcon)(e.sortDirection),items:n})]}}attributeModalHolder;renderPivotColumnHeader(e,t,r){var n=[{itemType:"regular",text:"Add argument pivot",callback:()=>{this.attributeModalHolder.start()}}];1<e.metadata.pivotColumns.length&&n.push({itemType:"regular",text:"Remove",callback(){f.globals.dispatch(c.Actions.setPivotTablePivotSelected({column:t,selected:!1})),f.globals.dispatch(c.Actions.setPivotTableQueryRequested({queryRequested:!0}))}});for(const i of g.tables){var a=[];for(const o of i.columns){const s={kind:"regular",table:i.name,column:o};r.has((0,m.columnKey)(s))||a.push({itemType:"regular",text:o,callback(){f.globals.dispatch(c.Actions.setPivotTablePivotSelected({column:s,selected:!0})),f.globals.dispatch(c.Actions.setPivotTableQueryRequested({queryRequested:!0}))}})}n.push({itemType:"group",itemId:"pivot-"+i.name,text:`Add ${i.displayName} pivot`,children:a})}return{content:[l(t),(0,h.default)(_.PopupMenuButton,{icon:"more_horiz",items:n})]}}renderResultsTable(e){const t=f.globals.state.nonSerializableState.pivotTable;if(null===t.queryResult)return(0,h.default)("div","Loading...");const r=t.queryResult;var n=[],a=t.queryResult.tree;if(0===a.children.size&&0===a.rows.length)return(0,h.default)(".empty-result","No slices in the current selection.");this.renderTree(e.selectionArea,[],a,t.queryResult,n);const i=new Set(this.pivotState.selectedPivots.map(m.columnKey));e=t.selectedPivots.map(e=>this.renderPivotColumnHeader(r,e,i));const o=1<t.queryResult.metadata.aggregationColumns.length;a=t.queryResult.metadata.aggregationColumns.map((e,t)=>this.renderAggregationHeaderCell(e,t,o));return(0,h.default)("table.pivot-table",(0,h.default)("thead",(0,h.default)("tr.header",(0,h.default)(s.ReorderableCellGroup,{cells:e,onReorder:(e,t,r)=>{f.globals.dispatch(c.Actions.changePivotTablePivotOrder({from:e,to:t,direction:r})),f.globals.dispatch(c.Actions.setPivotTableQueryRequested({queryRequested:!0}))}}),(0,h.default)(s.ReorderableCellGroup,{cells:a,onReorder:(e,t,r)=>{f.globals.dispatch(c.Actions.changePivotTableAggregationOrder({from:e,to:t,direction:r})),f.globals.dispatch(c.Actions.setPivotTableQueryRequested({queryRequested:!0}))}}),(0,h.default)("td.menu",(0,h.default)(_.PopupMenuButton,{icon:"menu",items:[{itemType:"regular",text:t.constrainToArea?"Query data for the whole timeline":"Constrain to selected area",callback:()=>{f.globals.dispatch(c.Actions.setPivotTableConstrainToArea({constrain:!t.constrainToArea})),f.globals.dispatch(c.Actions.setPivotTableQueryRequested({queryRequested:!0}))}}]})))),(0,h.default)("tbody",this.renderTotalsRow(t.queryResult),n))}view({attrs:e}){return(0,h.default)(".pivot-table",this.renderResultsTable(e))}}}return BA}function JA(){if(!WA){WA=1,Object.defineProperty(MA,"__esModule",{value:!0}),MA.AggregationsTabs=void 0;const a=or.__importDefault(ae()),i=function(){if(!IA){IA=1,Object.defineProperty(PA,"__esModule",{value:!0}),PA.AggregationPanel=void 0;const i=or.__importDefault(ae()),a=ne(),e=DA(),o=M(),s=bf(),l=oe(),t=L(),r=wy(),n=se(),c=X();PA.AggregationPanel=class{view({attrs:t}){return!t.data||(0,e.isEmptyData)(t.data)?(0,i.default)(r.EmptyState,{className:"pf-noselection",title:"No relevant tracks in selection"},(0,i.default)(n.Anchor,{icon:c.Icons.ChangeTab,onclick:()=>{l.globals.dispatch(a.Actions.showTab({uri:"current_selection"}))}},"Go to current selection tab")):(0,i.default)(".details-panel",(0,i.default)(".details-panel-heading.aggregation",void 0!==t.data.extra&&"THREAD_STATE"===t.data.extra.kind?this.showStateSummary(t.data.extra):null,this.showTimeRange(),(0,i.default)("table",(0,i.default)("tr",t.data.columns.map(e=>this.formatColumnHeading(e,t.kind))),(0,i.default)("tr.sum",t.data.columnSums.map(e=>{var t=""===e?"td":"td.sum-data";return(0,i.default)(t,e)})))),(0,i.default)(".details-table.aggregation",(0,i.default)("table",this.getRows(t.data))))}formatColumnHeading(e,t){var r=l.globals.state.aggregatePreferences[t];let n="";return r&&r.sorting&&r.sorting.column===e.columnId&&(n="DESC"===r.sorting.direction?"arrow_drop_down":"arrow_drop_up"),(0,i.default)("th",{onclick:()=>{l.globals.dispatch(a.Actions.updateAggregateSorting({id:t,column:e.columnId}))}},e.title,(0,i.default)("i.material-icons",n))}getRows(r){if(0!==r.columns.length){var e=[];for(let t=0;t<r.columns[0].data.length;t++){var n=[];for(let e=0;e<r.columns.length;e++)n.push((0,i.default)("td",this.getFormattedData(r,t,e)));e.push((0,i.default)("tr",n))}return e}}getFormattedData(e,t,r){switch(e.columns[r].kind){case"STRING":return e.strings[e.columns[r].data[t]];case"TIMESTAMP_NS":return""+e.columns[r].data[t]/1e6;case"STATE":var n=e.strings[e.columns[r].data[t]].split(","),a="NULL"===n[1]?void 0:!!Number.parseInt(n[1],10);return(0,s.translateState)(n[0],a);default:return e.columns[r].data[t]}}showTimeRange(){var e=l.globals.state.selection;if("area"===e.kind)return e=e.end-e.start,(0,i.default)(".time-range","Selected range: ",(0,i.default)(t.DurationWidget,{dur:e}))}showStateSummary(t){if(void 0!==t){var r=[];for(let e=0;e<t.states.length;e++){var n=(0,o.colorForState)(t.states[e]),a=t.values[e]/t.totalMs*100;r.push((0,i.default)(".state",{style:{background:n.base.cssString,color:n.textBase.cssString,width:a+"%"}},`${t.states[e]}: ${t.values[e]} ms`))}return(0,i.default)(".states",r)}}}}return PA}(),o=oe(),s=DA(),l=F(),c=le(),u=ie(),r=wy(),d=FA(),f=YA(),p=IT(),h=Y(),g=ee();var e=Qh();const m=Q(),_=GT();var t=V();class y{monitor=new e.Monitor([()=>o.globals.state.selection]);currentTab=void 0;perfSampleFlamegraphAttrs;sliceFlamegraphAttrs;legacyFlamegraphSelection;getCurrentView(){var e=this.getViews().map(({key:e})=>e);if(0!==e.length)return void 0!==this.currentTab&&e.includes(this.currentTab)?this.currentTab:e[0]}getViews(){var e,t,r=[];for([e,t]of o.globals.aggregateDataStore.entries())(0,s.isEmptyData)(t)||r.push({key:t.tabName,name:t.tabName,content:(0,a.default)(i.AggregationPanel,{kind:e,key:e,data:t})});var n=o.globals.state.nonSerializableState.pivotTable,n=(void 0!==n.selectionArea&&r.push({key:"pivot_table",name:"Pivot Table",content:(0,a.default)(f.PivotTable,{selectionArea:n.selectionArea})}),this.monitor.ifStateChanged());return _.USE_NEW_FLAMEGRAPH_IMPL.get()?this.addFlamegraphView(n,r):this.addLegacyFlamegraphView(n,r),0<o.globals.selectedFlows.length&&r.push({key:"selected_flows",name:"Flow Events",content:(0,a.default)(d.FlowEventsAreaSelectedPanel)}),r}view(e){var t=this.getViews();const r=this.getCurrentView();var n=t.map(({key:e,name:t})=>(0,a.default)(c.Button,{onclick:()=>{this.currentTab=e,u.raf.scheduleFullRedraw()},key:e,label:t,active:r===e}));return void 0===r||void 0===(t=t.find(({key:e})=>e===r)?.content)?this.renderEmptyState():(0,a.default)(l.DetailsShell,{title:"Area Selection",description:(0,a.default)(c.ButtonBar,n)},t)}renderEmptyState(){return(0,a.default)(r.EmptyState,{className:"pf-noselection",title:"Unsupported area selection"},"No details available for this area selection")}addFlamegraphView(e,t){this.perfSampleFlamegraphAttrs=this.computePerfSampleFlamegraphAttrs(e),void 0!==this.perfSampleFlamegraphAttrs&&t.push({key:"perf_sample_flamegraph_selection",name:"Perf Sample Flamegraph",content:(0,a.default)(_.QueryFlamegraph,this.perfSampleFlamegraphAttrs)}),this.sliceFlamegraphAttrs=this.computeSliceFlamegraphAttrs(e),void 0!==this.sliceFlamegraphAttrs&&t.push({key:"slice_flamegraph_selection",name:"Slice Flamegraph",content:(0,a.default)(_.QueryFlamegraph,this.sliceFlamegraphAttrs)})}computePerfSampleFlamegraphAttrs(e){var t,r=o.globals.state.selection;if("area"===r.kind)return e?0===(e=n(r)).length?0===(t=function(e){var t=[];for(const n of e.tracks){var r=o.globals.state.tracks[n],r=o.globals.trackManager.resolveTrackInfo(r?.uri);r?.tags?.kind===m.PERF_SAMPLES_PROFILE_TRACK_KIND&&void 0!==r.tags?.utid&&t.push(r.tags?.utid)}return t}(r)).length?void 0:{engine:(0,g.assertExists)(this.getCurrentEngine()),metrics:[...(0,_.metricsFromTableOrSubquery)(`
              (
                select id, parent_id as parentId, name, self_count
                from _linux_perf_callstacks_for_samples!((
                  select p.callsite_id
                  from perf_sample p
                  where p.ts >= ${r.start}
                    and p.ts <= ${r.end}
                    and p.utid in (${t.join(",")})
                ))
              )
            `,[{name:"Perf Samples",unit:"",columnName:"self_count"}],"include perfetto module linux.perf.samples")]}:{engine:(0,g.assertExists)(this.getCurrentEngine()),metrics:[...(0,_.metricsFromTableOrSubquery)(`
            (
              select id, parent_id as parentId, name, self_count
              from _linux_perf_callstacks_for_samples!((
                select p.callsite_id
                from perf_sample p
                join thread t using (utid)
                where p.ts >= ${r.start}
                  and p.ts <= ${r.end}
                  and t.upid in (${e.join(",")})
              ))
            )
          `,[{name:"Perf Samples",unit:"",columnName:"self_count"}],"include perfetto module linux.perf.samples")]}:this.perfSampleFlamegraphAttrs}computeSliceFlamegraphAttrs(e){var t=o.globals.state.selection;if("area"===t.kind){if(!e)return this.sliceFlamegraphAttrs;var r=[];for(const a of t.tracks){var n=o.globals.state.tracks[a],n=o.globals.trackManager.resolveTrackInfo(n?.uri);n?.tags?.kind===m.THREAD_SLICE_TRACK_KIND&&void 0!==n.tags?.trackIds&&r.push(...n.tags.trackIds)}return 0!==r.length?{engine:(0,g.assertExists)(this.getCurrentEngine()),metrics:[...(0,_.metricsFromTableOrSubquery)(`(
            select *
            from _viz_slice_ancestor_agg!((
              select s.id, s.dur
              from slice s
              left join slice t on t.parent_id = s.id
              where s.ts >= ${t.start}
                and s.ts <= ${t.end}
                and s.track_id in (${r.join(",")})
                and t.id is null
            ))
          )`,[{name:"Duration",unit:"ns",columnName:"self_dur"},{name:"Samples",unit:"",columnName:"self_count"}],"include perfetto module viz.slices;")]}:void 0}}addLegacyFlamegraphView(e,t){this.legacyFlamegraphSelection=this.computeLegacyFlamegraphSelection(e),void 0!==this.legacyFlamegraphSelection&&t.push({key:"flamegraph_selection",name:"Flamegraph Selection",content:(0,a.default)(p.LegacyFlamegraphDetailsPanel,{cache:o.globals.areaFlamegraphCache,selection:this.legacyFlamegraphSelection})})}computeLegacyFlamegraphSelection(e){var t=o.globals.state.selection;if("area"===t.kind)return e?0!==(e=n(t)).length?{profileType:h.ProfileType.PERF_SAMPLE,start:t.start,end:t.end,upids:e}:void 0:this.legacyFlamegraphSelection}getCurrentEngine(){var e=o.globals.getCurrentEngine()?.id;if(void 0!==e)return o.globals.engines.get(e)}}class T{trash=new t.DisposableStack;constructor(){var e=o.globals.tabManager.registerDetailsPanel({render(e){if("area"===e.kind)return(0,a.default)(y)}});this.trash.use(e)}[Symbol.dispose](){this.trash.dispose()}}function n(e){var t=[];for(const n of e.tracks){var r=o.globals.state.tracks[n],r=o.globals.trackManager.resolveTrackInfo(r?.uri);r?.tags?.kind===m.PERF_SAMPLES_PROFILE_TRACK_KIND&&void 0!==r.tags?.upid&&t.push(r.tags?.upid)}return t}MA.AggregationsTabs=T}return MA}function ZA(){if(!qA){qA=1,Object.defineProperty(eA,"__esModule",{value:!0}),eA.App=void 0;const a=or.__importDefault(ae()),t=Ws(),r=hl(),n=Ra(),i=ee(),o=J(),s=ne(),l=Fa(),c=ie(),u=ue(),d=function(){if(!XS){XS=1,Object.defineProperty(tA,"__esModule",{value:!0}),tA.HotkeyContext=void 0;const n=uT();tA.HotkeyContext=class{hotkeys;view(e){return e.children}oncreate(e){document.addEventListener("keydown",this.onKeyDown),this.hotkeys=e.attrs.hotkeys}onupdate(e){this.hotkeys=e.attrs.hotkeys}onremove(e){document.removeEventListener("keydown",this.onKeyDown),this.hotkeys=void 0}onKeyDown=r=>{r.defaultPrevented||r instanceof KeyboardEvent&&this.hotkeys?.forEach(({callback:e,hotkey:t})=>{(0,n.checkHotkey)(t,r)&&(r.preventDefault(),e())})}}}return tA}(),f=dT(),p=de(),h=np(),g=function(){if(!rA){rA=1,Object.defineProperty(nA,"__esModule",{value:!0}),nA.CookieConsent=void 0;const e=or.__importDefault(ae()),t=ie(),r=oe();nA.CookieConsent=class{showCookieConsent=!0;oninit(){this.showCookieConsent=!0,r.globals.logging.isEnabled()&&"true"!==localStorage.getItem("cookieAck")||(this.showCookieConsent=!1)}view(){if(this.showCookieConsent)return(0,e.default)(".cookie-consent",(0,e.default)(".cookie-text",`This site uses cookies from Google to deliver its services and to
          analyze traffic.`),(0,e.default)(".buttons",(0,e.default)("button",(0,e.default)("a",{href:"https://policies.google.com/technologies/cookies",target:"_blank"},"More details")),(0,e.default)("button",{onclick:()=>{this.showCookieConsent=!1,localStorage.setItem("cookieAck","true"),t.raf.scheduleFullRedraw()}},"OK")))}}}return nA}(),m=oe(),e=fT(),_=_A(),y=function(){if(!yA){yA=1,Object.defineProperty(TA,"__esModule",{value:!0}),TA.Omnibox=void 0;const f=or.__importDefault(ae()),p=Qs(),t=te(),h=z(),r=ie(),n=wy(),e=dT(),g=bl();class c{highlightedBefore=!1;view({attrs:e}){const{displayName:t,highlighted:r,rightContent:n,label:a,...i}=e;return(0,f.default)("li",{class:(0,p.classNames)(r&&"pf-highlighted"),...i},(0,f.default)("span.pf-title",this.renderTitle(t)),a&&(0,f.default)("span.pf-tag",a),n)}renderTitle(e){return(0,t.isString)(e)?e:e.map(({matching:e,value:t})=>e?(0,f.default)("b",t):t)}onupdate({attrs:e,dom:t}){this.highlightedBefore!==e.highlighted&&(e.highlighted&&t.scrollIntoView({block:"nearest"}),this.highlightedBefore=e.highlighted)}}TA.Omnibox=class{popupElement;dom;attrs;view({attrs:a}){const{value:i,placeholder:e,extraClasses:t,onInput:r=()=>{},onSubmit:o=()=>{},onGoBack:s=()=>{},inputRef:n="omnibox",options:l,closeOnSubmit:c=!1,rightContent:u,selectedOptionIndex:d=0}=a;return(0,f.default)(g.Popup,{onPopupMount:e=>this.popupElement=e,onPopupUnMount:e=>this.popupElement=void 0,isOpen:(0,h.exists)(l),showArrow:!1,matchWidth:!0,offset:2,trigger:(0,f.default)(".omnibox",{class:(0,p.classNames)(t)},(0,f.default)("input",{ref:n,value:i,placeholder:e,oninput:e=>{r(e.target.value,i)},onkeydown:e=>{var t,r,n;"Backspace"===e.key&&""===i?s():"Escape"===e.key&&(e.preventDefault(),this.close(a)),l?"ArrowUp"===e.key?(e.preventDefault(),this.highlightPreviousOption(a)):"ArrowDown"===e.key?(e.preventDefault(),this.highlightNextOption(a)):"Enter"===e.key&&(e.preventDefault(),r=l[d])&&(c&&this.close(a),n=e.metaKey||e.ctrlKey,t=e.shiftKey,o(r.key,n,t)):"Enter"===e.key&&(e.preventDefault(),c&&this.close(a),r=e.metaKey||e.ctrlKey,n=e.shiftKey,o(i,r,n))}}),u)},l&&this.renderDropdown(a))}renderDropdown(e){var t=e["options"];return t?0===t.length?(0,f.default)(n.EmptyState,{title:"No matching options..."}):(0,f.default)(".pf-omnibox-dropdown",this.renderOptionsContainer(e,t),this.renderFooter()):null}renderFooter(){return(0,f.default)(".pf-omnibox-dropdown-footer",(0,f.default)("section",(0,f.default)(e.KeycapGlyph,{keyValue:"ArrowUp"}),(0,f.default)(e.KeycapGlyph,{keyValue:"ArrowDown"}),"to navigate"),(0,f.default)("section",(0,f.default)(e.KeycapGlyph,{keyValue:"Enter"}),"to use"),(0,f.default)("section",(0,f.default)(e.KeycapGlyph,{keyValue:"Escape"}),"to dismiss"))}renderOptionsContainer(e,t){const{onClose:i=()=>{},onSubmit:o=()=>{},closeOnSubmit:s=!1,selectedOptionIndex:l}=e;e=t.map(({displayName:e,key:t,rightContent:r,tag:n},a)=>(0,f.default)(c,{key:t,label:n,displayName:e,highlighted:a===l,onclick:()=>{s&&i(),o(t,!1,!1)},rightContent:r}));return(0,f.default)("ul.pf-omnibox-options-container",e)}oncreate({attrs:e,dom:t}){this.attrs=e,this.dom=t;t=e.closeOnOutsideClick;t&&document.addEventListener("mousedown",this.onMouseDown)}onupdate({attrs:e,dom:t}){this.attrs=e,this.dom=t;t=e.closeOnOutsideClick;t?document.addEventListener("mousedown",this.onMouseDown):document.removeEventListener("mousedown",this.onMouseDown)}onremove(e){this.attrs=void 0,this.dom=void 0,document.removeEventListener("mousedown",this.onMouseDown)}onMouseDown=e=>{if(e.target instanceof Node){if(this.popupElement&&this.popupElement.contains(e.target))return;if(this.dom&&this.dom.contains(e.target))return}this.attrs&&this.close(this.attrs)};close(e){var{onClose:e=()=>{}}=e;r.raf.scheduleFullRedraw(),e()}highlightPreviousOption(e){var{selectedOptionIndex:e=0,onSelectedOptionChanged:t=()=>{}}=e;t(Math.max(0,e-1))}highlightNextOption(e){var{selectedOptionIndex:e=0,onSelectedOptionChanged:t=()=>{},options:r=[]}=e,r=r.length-1;t(Math.min(r,e+1))}}}return TA}(),T=up(),b=EA(),v=RT(),E=wA();var L=wT();const S=JA(),A=Up(),O=CT(),C=Uo(),k=Q();var F=V();const w=rf(),R=ga(),I=gf();class M{view(){return(0,a.default)(".alerts",(t=m.globals.permalinkHash)?(t=self.location.origin+"/#!/?s="+t,e={title:"Click to copy the URL",onclick:(0,h.onClickCopy)(t)},(0,a.default)(".alert-permalink",[(0,a.default)("div","Permalink: ",(0,a.default)(`a[href=${t}]`,e,t)),(0,a.default)("button",{onclick:()=>(0,O.publishPermalinkHash)(void 0)},(0,a.default)("i.material-icons.disallow-selection","close"))])):null);var e,t}}const P={ts:"ts",dur:"dur",name:"name"},N=["id","utid","ts","dur","name","table_name"],U={ts:"ts",dur:"dur",name:"thread_name"},D=["id","utid","ts","dur","thread_name","process_name","table_name"];eA.App=class x{trash=new F.DisposableStack;static OMNIBOX_INPUT_REF="omnibox";omniboxInputEl;recentCommands=[];constructor(){this.trash.use(new _.Notes),this.trash.use(new S.AggregationsTabs)}getEngine(){var e=m.globals.getCurrentEngine()?.id;if(void 0!==e)return m.globals.engines.get(e)?.getProxy("QueryPage")}getFirstUtidOfSelectionOrVisibleWindow(){var e=m.globals.state.selection;return"area"===e.kind&&(e=e.tracks.find(e=>m.globals.state.tracks[e]))&&(e=m.globals.state.tracks[e],(e=m.globals.trackManager.resolveTrackInfo(e.uri))?.tags?.kind===k.THREAD_STATE_TRACK_KIND)&&void 0!==e?.tags?.utid?e.tags.utid:0}cmds=[{id:"perfetto.SetTimestampFormat",name:"Set timestamp and duration format",callback:async()=>{var e=[{key:l.TimestampFormat.Timecode,displayName:"Timecode"},{key:l.TimestampFormat.UTC,displayName:"Realtime (UTC)"},{key:l.TimestampFormat.TraceTz,displayName:"Realtime (Trace TZ)"},{key:l.TimestampFormat.Seconds,displayName:"Seconds"},{key:l.TimestampFormat.Raw,displayName:"Raw"},{key:l.TimestampFormat.RawLocale,displayName:"Raw (with locale-specific formatting)"}];try{var t=await m.globals.omnibox.prompt("Select format...",e);(0,l.setTimestampFormat)(t),c.raf.scheduleFullRedraw()}catch{}}},{id:"perfetto.SetDurationPrecision",name:"Set duration precision",callback:async()=>{var e=[{key:l.DurationPrecision.Full,displayName:"Full"},{key:l.DurationPrecision.HumanReadable,displayName:"Human readable"}];try{var t=await m.globals.omnibox.prompt("Select duration precision mode...",e);(0,l.setDurationPrecision)(t),c.raf.scheduleFullRedraw()}catch{}}},{id:"perfetto.CriticalPathLite",name:"Critical path lite",callback:async()=>{var e=this.getFirstUtidOfSelectionOrVisibleWindow(),t=await(0,m.getTimeSpanOfSelectionOrVisibleWindow)(),r=this.getEngine();void 0!==r&&0!=e&&(await r.query("INCLUDE PERFETTO MODULE sched.thread_executing_span;"),await(0,u.addDebugSliceTrack)({engine:r,registerTrack:e=>m.globals.trackManager.registerTrack(e)},{sqlSource:`
                   SELECT
                      cr.id,
                      cr.utid,
                      cr.ts,
                      cr.dur,
                      thread.name AS thread_name,
                      process.name AS process_name,
                      'thread_state' AS table_name
                    FROM
                      _thread_executing_span_critical_path(
                          ${e},
                          ${t.start},
                          ${t.end} - ${t.start}) cr
                    JOIN thread USING(utid)
                    JOIN process USING(upid)
                  `,columns:D},(await(0,I.getThreadInfo)(r,e)).name??"<thread name>",U,D))}},{id:"perfetto.CriticalPath",name:"Critical path",callback:async()=>{var e=this.getFirstUtidOfSelectionOrVisibleWindow(),t=await(0,m.getTimeSpanOfSelectionOrVisibleWindow)(),r=this.getEngine();void 0!==r&&0!=e&&(await r.query("INCLUDE PERFETTO MODULE sched.thread_executing_span_with_slice;"),await(0,u.addDebugSliceTrack)({engine:r,registerTrack:e=>m.globals.trackManager.registerTrack(e)},{sqlSource:`
                        SELECT cr.id, cr.utid, cr.ts, cr.dur, cr.name, cr.table_name
                        FROM
                        _critical_path_stack(
                          ${e},
                          ${t.start},
                          ${t.end} - ${t.start}, 1, 1, 1, 1) cr WHERE name IS NOT NULL
                  `,columns:N},(await(0,I.getThreadInfo)(r,e)).name??"<thread name>",P,N))}},{id:"perfetto.CriticalPathPprof",name:"Critical path pprof",callback:async()=>{var e=this.getFirstUtidOfSelectionOrVisibleWindow(),t=await(0,m.getTimeSpanOfSelectionOrVisibleWindow)();void 0!==this.getEngine()&&0!=e&&(0,T.addQueryResultsTab)({query:`INCLUDE PERFETTO MODULE sched.thread_executing_span_with_slice;
                   SELECT *
                      FROM
                        _thread_executing_span_critical_path_graph(
                        "criical_path",
                         ${e},
                         ${t.start},
                         ${t.end} - ${t.start}) cr`,title:"Critical path"})}},{id:"perfetto.ShowSliceTable",name:"Open new slice table tab",callback:()=>{(0,w.addSqlTableTab)({table:R.SqlTables.slice,displayName:"slice"})}},{id:"perfetto.TogglePerformanceMetrics",name:"Toggle performance metrics",callback:()=>{m.globals.dispatch(s.Actions.togglePerfDebug({}))}},{id:"perfetto.ShareTrace",name:"Share trace",callback:L.shareTrace},{id:"perfetto.SearchNext",name:"Go to next search result",callback:()=>{(0,b.executeSearch)()},defaultHotkey:"Enter"},{id:"perfetto.SearchPrev",name:"Go to previous search result",callback:()=>{(0,b.executeSearch)(!0)},defaultHotkey:"Shift+Enter"},{id:"perfetto.OpenCommandPalette",name:"Open command palette",callback:()=>m.globals.omnibox.setMode(C.OmniboxMode.Command),defaultHotkey:"!Mod+Shift+P"},{id:"perfetto.RunQuery",name:"Run query",callback:()=>m.globals.omnibox.setMode(C.OmniboxMode.Query)},{id:"perfetto.Search",name:"Search",callback:()=>m.globals.omnibox.setMode(C.OmniboxMode.Search),defaultHotkey:"/"},{id:"perfetto.ShowHelp",name:"Show help",callback:()=>(0,e.toggleHelp)(),defaultHotkey:"?"},{id:"perfetto.CopyTimeWindow",name:"Copy selected time window to clipboard",callback:async()=>{var e=`ts >= ${(e=await(0,m.getTimeSpanOfSelectionOrVisibleWindow)()).start} and ts < `+e.end;(0,t.copyToClipboard)(e)}},{id:"perfetto.FocusSelection",name:"Focus current selection",callback:()=>(0,A.findCurrentSelection)(),defaultHotkey:"F"},{id:"perfetto.Deselect",name:"Deselect",callback:()=>{m.globals.timeline.deselectArea(),m.globals.clearSelection(),m.globals.dispatch(s.Actions.removeNote({id:"0"}))},defaultHotkey:"Escape"},{id:"perfetto.SetTemporarySpanNote",name:"Set the temporary span note based on the current selection",callback:async()=>{var e=await m.globals.findTimeRangeOfSelection();e&&m.globals.dispatch(s.Actions.addSpanNote({start:e.start,end:e.end,id:"__temp__"}))},defaultHotkey:"M"},{id:"perfetto.AddSpanNote",name:"Add a new span note based on the current selection",callback:async()=>{var e=await m.globals.findTimeRangeOfSelection();e&&m.globals.dispatch(s.Actions.addSpanNote({start:e.start,end:e.end}))},defaultHotkey:"Shift+M"},{id:"perfetto.RemoveSelectedNote",name:"Remove selected note",callback:()=>{var e=m.globals.state.selection;"note"===e.kind&&m.globals.dispatch(s.Actions.removeNote({id:e.id}))},defaultHotkey:"Delete"},{id:"perfetto.NextFlow",name:"Next flow",callback:()=>(0,A.focusOtherFlow)("Forward"),defaultHotkey:"Mod+]"},{id:"perfetto.PrevFlow",name:"Prev flow",callback:()=>(0,A.focusOtherFlow)("Backward"),defaultHotkey:"Mod+["},{id:"perfetto.MoveNextFlow",name:"Move next flow",callback:()=>(0,A.moveByFocusedFlow)("Forward"),defaultHotkey:"]"},{id:"perfetto.MovePrevFlow",name:"Move prev flow",callback:()=>(0,A.moveByFocusedFlow)("Backward"),defaultHotkey:"["},{id:"perfetto.SelectAll",name:"Select all",callback:()=>{let e=[];var t=m.globals.state.selection,{start:t,end:r}=(e="area"!==t.kind||m.globals.traceContext.start===t.start&&m.globals.traceContext.end===t.end?Object.keys(m.globals.state.tracks):t.tracks,m.globals.traceContext);m.globals.dispatch(s.Actions.selectArea({start:t,end:r,tracks:e}))},defaultHotkey:"Mod+A"}];commands(){return this.cmds}renderOmnibox(){var e=m.globals.state.status.timestamp+1-Date.now()/1e3,t=void 0!==m.globals.state.engine&&!m.globals.state.engine.ready;return 0<e||t?(setTimeout(()=>c.raf.scheduleFullRedraw(),1e3*e),(0,a.default)(".omnibox.message-mode",(0,a.default)("input[readonly][disabled][ref=omnibox]",{value:"",placeholder:m.globals.state.status.msg}))):(t=m.globals.omnibox.omniboxMode)===C.OmniboxMode.Command?this.renderCommandOmnibox():t===C.OmniboxMode.Prompt?this.renderPromptOmnibox():t===C.OmniboxMode.Query?this.renderQueryOmnibox():t===C.OmniboxMode.Search?this.renderSearchOmnibox():void(0,i.assertUnreachable)(t)}renderPromptOmnibox(){var e,t=(0,i.assertExists)(m.globals.omnibox.pendingPrompt);let r=void 0;return t.options&&(e=new n.FuzzyFinder(t.options,({displayName:e})=>e).find(m.globals.omnibox.text),r=e.map(e=>({key:e.item.key,displayName:e.segments}))),(0,a.default)(y.Omnibox,{value:m.globals.omnibox.text,placeholder:t.text,inputRef:x.OMNIBOX_INPUT_REF,extraClasses:"prompt-mode",closeOnOutsideClick:!0,options:r,selectedOptionIndex:m.globals.omnibox.omniboxSelectionIndex,onSelectedOptionChanged:e=>{m.globals.omnibox.setOmniboxSelectionIndex(e),c.raf.scheduleFullRedraw()},onInput:e=>{m.globals.omnibox.setText(e),m.globals.omnibox.setOmniboxSelectionIndex(0),c.raf.scheduleFullRedraw()},onSubmit:(e,t)=>{m.globals.omnibox.resolvePrompt(e)},onClose:()=>{m.globals.omnibox.rejectPrompt()}})}renderCommandOmnibox(){const t=m.globals.commandManager;var e=t.fuzzyFilterCommands(m.globals.omnibox.text).map(t=>({recentsIndex:this.recentCommands.findIndex(e=>e===t.id),cmd:t})).sort((e,t)=>t.recentsIndex===e.recentsIndex?e.cmd.name.localeCompare(t.cmd.name):t.recentsIndex-e.recentsIndex).map(({recentsIndex:e,cmd:t})=>{var{segments:t,id:r,defaultHotkey:n}=t;return{key:r,displayName:t,tag:-1!==e?"recently used":void 0,rightContent:n&&(0,a.default)(f.HotkeyGlyphs,{hotkey:n})}});return(0,a.default)(y.Omnibox,{value:m.globals.omnibox.text,placeholder:"Filter commands...",inputRef:x.OMNIBOX_INPUT_REF,extraClasses:"command-mode",options:e,closeOnSubmit:!0,closeOnOutsideClick:!0,selectedOptionIndex:m.globals.omnibox.omniboxSelectionIndex,onSelectedOptionChanged:e=>{m.globals.omnibox.setOmniboxSelectionIndex(e),c.raf.scheduleFullRedraw()},onInput:e=>{m.globals.omnibox.setText(e),m.globals.omnibox.setOmniboxSelectionIndex(0),c.raf.scheduleFullRedraw()},onClose:()=>{this.omniboxInputEl&&this.omniboxInputEl.blur(),m.globals.omnibox.reset()},onSubmit:e=>{this.addRecentCommand(e),t.runCommand(e)},onGoBack:()=>{m.globals.omnibox.reset()}})}addRecentCommand(t){for(this.recentCommands=this.recentCommands.filter(e=>e!==t),this.recentCommands.push(t);6<this.recentCommands.length;)this.recentCommands.shift()}renderQueryOmnibox(){return(0,a.default)(y.Omnibox,{value:m.globals.omnibox.text,placeholder:"e.g. select * from sched left join thread using(utid) limit 10",inputRef:x.OMNIBOX_INPUT_REF,extraClasses:"query-mode",onInput:e=>{m.globals.omnibox.setText(e),c.raf.scheduleFullRedraw()},onSubmit:(e,t)=>{e={query:(0,o.undoCommonChatAppReplacements)(e),title:t?"Pinned query":"Omnibox query"},t=t?void 0:"omnibox_query",(0,T.addQueryResultsTab)(e,t)},onClose:()=>{m.globals.omnibox.setText(""),this.omniboxInputEl&&this.omniboxInputEl.blur(),m.globals.omnibox.reset(),c.raf.scheduleFullRedraw()},onGoBack:()=>{m.globals.omnibox.reset()}})}renderSearchOmnibox(){var e=4<=(e=m.globals.state.omniboxState).omnibox.length||e.force;return(0,a.default)(y.Omnibox,{value:m.globals.state.omniboxState.omnibox,placeholder:"Search or type '>' for commands or ':' for SQL mode",inputRef:x.OMNIBOX_INPUT_REF,onInput:(e,t)=>{if(""===t){if(">"===e)return void m.globals.omnibox.setMode(C.OmniboxMode.Command);if(":"===e)return void m.globals.omnibox.setMode(C.OmniboxMode.Query)}m.globals.dispatch(s.Actions.setOmnibox({omnibox:e,mode:"SEARCH"}))},onClose:()=>{this.omniboxInputEl&&this.omniboxInputEl.blur()},onSubmit:(e,t,r)=>{(0,b.executeSearch)(r),m.globals.dispatch(s.Actions.setOmnibox({omnibox:e,mode:"SEARCH",force:!0})),this.omniboxInputEl&&this.omniboxInputEl.blur()},rightContent:e&&this.renderStepThrough()})}renderStepThrough(){return(0,a.default)(".stepthrough",(0,a.default)(".current",0===m.globals.currentSearchResults.totalResults?"0 / 0":m.globals.state.searchIndex+1+" / "+m.globals.currentSearchResults.totalResults),(0,a.default)("button",{onclick:()=>{(0,b.executeSearch)(!0)}},(0,a.default)("i.material-icons.left","keyboard_arrow_left")),(0,a.default)("button",{onclick:()=>{(0,b.executeSearch)()}},(0,a.default)("i.material-icons.right","keyboard_arrow_right")))}view({children:e}){var t=[];for(const{id:r,defaultHotkey:n}of m.globals.commandManager.commands)n&&t.push({callback:()=>{m.globals.commandManager.runCommand(r)},hotkey:n});return(0,a.default)(d.HotkeyContext,{hotkeys:t},(0,a.default)("main",(0,a.default)(v.Sidebar),(0,a.default)(E.Topbar,{omnibox:this.renderOmnibox()}),(0,a.default)(M),e,(0,a.default)(g.CookieConsent),(0,p.maybeRenderFullscreenModalDialog)(),m.globals.state.perfDebug&&(0,a.default)(".perf-stats")))}oncreate({dom:e}){this.updateOmniboxInputRef(e),this.maybeFocusOmnibar(),this.cmds.forEach(e=>{e=m.globals.commandManager.registerCommand(e),this.trash.use(e)})}onupdate({dom:e}){this.updateOmniboxInputRef(e),this.maybeFocusOmnibar()}onremove(e){this.trash.dispose(),this.omniboxInputEl=void 0}updateOmniboxInputRef(e){(e=(0,r.findRef)(e,x.OMNIBOX_INPUT_REF))&&e instanceof HTMLInputElement&&(this.omniboxInputEl=e)}maybeFocusOmnibar(){var e;m.globals.omnibox.focusOmniboxNextRender&&((e=this.omniboxInputEl)&&(e.focus(),void 0===m.globals.omnibox.pendingCursorPlacement?e.select():e.setSelectionRange(m.globals.omnibox.pendingCursorPlacement,m.globals.omnibox.pendingCursorPlacement)),m.globals.omnibox.clearOmniboxFocusFlag())}}}return eA}var QA,XA,e1={},t1={};function r1(){if(!QA){QA=1,Object.defineProperty(t1,"__esModule",{value:!0}),t1.DatabaseSchema=t1.SchemaError=void 0,t1.getSchema=async function(e){var t=r.get(e);if(void 0!==t)return t;{t=await async function(e){var t=[],r=await e.query("SELECT name from perfetto_tables;"),n=r.iter({name:i.STR});for(;n.valid();n.next()){var a=n.name;t.push({name:a,columns:await async function(e,t){var e=await e.query(`PRAGMA table_info(${t});`),r=e.iter({name:i.STR}),n=[];for(;r.valid();r.next())n.push({name:r.name});return n}(e,a)})}r={tables:t};return new o(r)}(e);return r.set(e,t),t}};const i=Z(),r=new WeakMap;class n extends Error{constructor(e){super(e)}}t1.SchemaError=n;class o{tableToKeys;constructor(e){this.tableToKeys=new Map;for(const r of e.tables){var t=new Set(r.columns.map(e=>e.name));this.tableToKeys.set(r.name,t)}}getKeys(e){var t=this.tableToKeys.get(e);if(void 0===t)throw new n(`Unknown table '${e}'`);return t}}t1.DatabaseSchema=o}return t1}var n1,a1={};var i1,o1,s1={},l1={};function c1(){return i1||(i1=1,Object.defineProperty(l1,"__esModule",{value:!0}),l1.createPage=function(e){return e}),l1}var u1,d1={};var f1,p1={};var h1,g1,m1={},_1={};function y1(){var t,e;return h1||(h1=1,Object.defineProperty(_1,"__esModule",{value:!0}),_1.ResultStatus=void 0,_1.isError=function(e){return e.status===t.ERROR},_1.isPending=function(e){return e.status===t.PENDING},_1.isSuccess=function(e){return e.status===t.SUCCESS},_1.pending=function(){return{status:t.PENDING}},_1.error=function(e){return{status:t.ERROR,error:e}},_1.success=function(e){return{status:t.SUCCESS,data:e}},(e=t||(_1.ResultStatus=t={})).PENDING="pending",e.SUCCESS="success",e.ERROR="error"),_1}function T1(){if(!g1){g1=1,Object.defineProperty(m1,"__esModule",{value:!0}),m1.MetricsPage=void 0;const a=or.__importDefault(ae()),n=y1(),t=gp(),i=ie(),o=Z(),r=Cc(),s=$l(),l=xd(),c=oe();var e=c1();const u=["json","prototext","proto"];class d{engine;plugins;_metrics;_selected;_result;_format;_json;constructor(e,t){this.plugins=e,this.engine=t,this._metrics=[],this._result=(0,n.success)(""),this._json={},this._format="json",async function(e){for(var t=[],r=(await e.query("select name from trace_metrics")).iter({name:o.STR});r.valid();r.next())t.push(r.name);return t}(this.engine).then(e=>{this._metrics=e})}get metrics(){return this._metrics}get visualisations(){return this.plugins.metricVisualisations().filter(e=>e.metric===this.selected)}set selected(e){this._selected!==e&&(this._selected=e,this.update())}get selected(){return this._selected}set format(e){this._format!==e&&(this._format=e,this.update())}get format(){return this._format}get result(){return this._result}get resultAsJson(){return this._json}update(){const t=this._selected,r=this._format;void 0===t?(this._result=(0,n.success)(""),this._json={}):(this._result=(0,n.pending)(),this._json={},async function(e,t,r){return(e=await e.computeMetric([t],r))instanceof Uint8Array?`Uint8Array<len=${e.length}>`:e}(this.engine,t,r).then(e=>{this._selected===t&&this._format===r&&(this._result=(0,n.success)(e),"json"===r)&&(this._json=JSON.parse(e))}).catch(e=>{this._selected===t&&this._format===r&&(this._result=(0,n.error)(e),this._json={})}).finally(()=>{i.raf.scheduleFullRedraw()})),i.raf.scheduleFullRedraw()}}class f{view({attrs:e}){e=e.result;return(0,n.isPending)(e)?(0,a.default)(s.Spinner):(0,n.isError)(e)?(0,a.default)("pre.metric-error",e.error):(0,a.default)("pre",e.data)}}class p{view({attrs:e}){const t=e["controller"];return(0,a.default)(".metrics-page-picker",(0,a.default)(r.Select,{value:t.selected,oninput:e=>{e.target&&(t.selected=e.target.value)}},t.metrics.map(e=>(0,a.default)("option",{value:e,key:e},e))),(0,a.default)(r.Select,{oninput:e=>{e.target&&(t.format=e.target.value)}},u.map(e=>(0,a.default)("option",{selected:t.format===e,key:e,value:e,label:e}))))}}class h{view({attrs:e}){return(0,a.default)("",(0,a.default)(l.VegaView,{spec:e.visualisation.spec,data:{metric:e.data}}))}}class g{controller;oncreate(){var e=function(){var e=c.globals.getCurrentEngine()?.id;if(void 0!==e)return c.globals.engines.get(e)?.getProxy("MetricsPage")}();void 0!==e&&(this.controller=new d(t.pluginManager,e))}view(){var e=this.controller;if(void 0===e)return(0,a.default)("");const n=e.resultAsJson;return[(0,a.default)(p,{controller:e}),"json"===e.format&&e.visualisations.map(e=>{let t=n;for(const r of e.path)t=t[r]??[];return(0,a.default)(h,{visualisation:e,data:t})}),(0,a.default)(f,{result:e.result})]}}m1.MetricsPage=(0,e.createPage)({view(){return(0,a.default)(".metrics-page",(0,a.default)(g))}})}return m1}var b1,v1={};function E1(){if(!b1){b1=1,Object.defineProperty(v1,"__esModule",{value:!0}),v1.PluginsPage=void 0;const s=or.__importDefault(ae()),l=gp(),c=ie(),u=le(),d=z();var e=c1();const f=hp(),p=Gl();v1.PluginsPage=(0,e.createPage)({view(){return(0,s.default)(".pf-plugins-page",(0,s.default)("h1","Plugins"),(0,s.default)(".pf-plugins-topbar",(0,s.default)(u.Button,{intent:p.Intent.Primary,label:"Disable All",onclick:async()=>{for(const e of l.pluginRegistry.values())await l.pluginManager.disablePlugin(e.pluginId,!0),c.raf.scheduleFullRedraw()}}),(0,s.default)(u.Button,{intent:p.Intent.Primary,label:"Enable All",onclick:async()=>{for(const e of l.pluginRegistry.values())await l.pluginManager.enablePlugin(e.pluginId,!0),c.raf.scheduleFullRedraw()}}),(0,s.default)(u.Button,{intent:p.Intent.Primary,label:"Restore Defaults",onclick:async()=>{await l.pluginManager.restoreDefaults(!0),c.raf.scheduleFullRedraw()}})),(0,s.default)(".pf-plugins-grid",[(0,s.default)("span","Plugin"),(0,s.default)("span","Default?"),(0,s.default)("span","Enabled?"),(0,s.default)("span","Active?"),(0,s.default)("span","Control"),(0,s.default)("span","Load Time")],Array.from(l.pluginRegistry.values()).map(e=>{{const t=e.pluginId,r=f.defaultPlugins.includes(t),n=l.pluginManager.plugins.get(t),a=l.pluginManager.isActive(t),i=l.pluginManager.isEnabled(t),o=n?.previousOnTraceLoadTimeMillis;return[(0,s.default)("span",t),(0,s.default)("span",r?"Yes":"No"),i?(0,s.default)(".pf-tag.pf-active","Enabled"):(0,s.default)(".pf-tag.pf-inactive","Disabled"),a?(0,s.default)(".pf-tag.pf-active","Active"):(0,s.default)(".pf-tag.pf-inactive","Inactive"),(0,s.default)(u.Button,{label:a?"Disable":"Enable",intent:p.Intent.Primary,onclick:async()=>{a?await l.pluginManager.disablePlugin(t,!0):await l.pluginManager.enablePlugin(t,!0),c.raf.scheduleFullRedraw()}}),(0,d.exists)(o)?(0,s.default)("span",o.toFixed(1)+" ms"):(0,s.default)("span","-")]}})))}})}return v1}var S1,A1={};function O1(){if(!S1){S1=1,Object.defineProperty(A1,"__esModule",{value:!0}),A1.isTrustedOrigin=p,A1.postMessageHandler=function e(t){if(g(t))return;if(t.origin.startsWith("vscode-webview://"))return A.globals.inVscode=!0,void t.source?.postMessage({type:"viztracer"},{targetOrigin:t.origin});if("https://tagassistant.google.com"===t.origin)return;if("complete"!==document.readyState)return void console.error("Ignoring message - document not ready yet.");const r=t.source===window.opener;const n=t.source===window.parent;const a=t.source.opener===window;if(null===t.source||!(r||n||a))return;if(!("data"in t))throw new Error("Incoming message has no data property");if("PING"===t.data){const f=t.source;return void f.postMessage("PONG","*")}if("SHOW-HELP"===t.data)return void(0,O.toggleHelp)();if("RELOAD-CSS-CONSTANTS"===t.data)return void(0,S.initCssConstants)();let i;if(y(t.data))return void _(i=t.data.perfetto);let o;let s=!1;if(T(t.data))(o=m(t.data.perfetto)).keepApiOpen&&(s=!0);else{if(!(t.data instanceof ArrayBuffer))return console.warn("Unknown postMessage() event received. If you are trying to open a trace via postMessage(), this is a bug in your code. If not, this could be due to some Chrome extension."),void console.log("origin:",t.origin,"data:",t.data);o={title:"External trace",buffer:t.data}}if(0===o.buffer.byteLength)throw new Error("Incoming message trace buffer is empty");s||window.removeEventListener("message",e);const l=()=>{o.localOnly=!0,A.globals.dispatch(v.Actions.openTraceFromBuffer(o))};const c=()=>{h(t.origin),l()};if(p(t.origin))return void l();let u=t.origin;let d=!1;"null"===u&&(u="An unknown origin",d=!0);(0,E.showModal)({title:"Open trace?",content:(0,b.default)("div",(0,b.default)("div",u+" is trying to open a trace file."),(0,b.default)("div","Do you trust the origin and want to proceed?")),buttons:[{text:"No",primary:!0},{text:"Yes",primary:!1,action:l}].concat(d?[]:{text:"Always trust",primary:!1,action:c})})};const b=or.__importDefault(ae()),a=K(),v=ne(),E=de(),S=uA(),A=oe(),O=fT(),i=Bc(),n="trustedOrigins",o=20;function p(e){return e===window.origin||"null"!==e&&!!(["https://chrometto.googleplex.com","https://uma.googleplex.com","https://android-build.googleplex.com"].includes(e)||function(e){var t=window.localStorage.getItem(n);if(null===t)return;try{return JSON.parse(t).includes(e)}catch{}}(e)||(e=new URL(e).hostname).endsWith(".corp.google.com")||e.endsWith(".c.googlers.com")||"localhost"===e||"127.0.0.1"===e||"[::1]"===e)}function h(e){var t,r=window.localStorage.getItem(n);try{(t=JSON.parse(r??"[]")).includes(e)||(t.push(e),window.localStorage.setItem(n,JSON.stringify(t)))}catch(e){console.warn("unable to save trusted origins to localStorage",e)}}function g(e){return!0===e.data.perfettoIgnore}function m(e){var t={title:r(e.title),buffer:e.buffer,keepApiOpen:e.keepApiOpen};return void 0!==e.url&&(t.url=r(e.url)),t.pluginArgs=e.pluginArgs,t}function r(e){return e.replace(/[^A-Za-z0-9.\-_#:/?=&;%+$ ]/g," ")}async function _(e,t){var r,n;!!A.globals.getCurrentEngine()?.ready?(r=a.Time.fromSeconds(e.timeStart),n=a.Time.fromSeconds(e.timeEnd),(0,i.focusHorizontalRange)(r,n,e.viewPercentage)):(t=void 0===t?0:t)>o?console.warn("Could not scroll to time range. Trace viewer not ready."):setTimeout(_,200,e,t+1)}function y(e){return void 0!==e.perfetto&&(void 0!==e.perfetto.timeStart||void 0!==e.perfetto.timeEnd)}function T(e){return void 0!==e.perfetto&&void 0!==e.perfetto.buffer&&void 0!==e.perfetto.title}}return A1}var C1,k1={},w1={},Rt={},R1={};function I1(){if(!C1){C1=1;{var c=R1;class m{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length `+this.length);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,r){[e,t]=l(this,e,t);var n=[];return this.decompose(0,e,n,2),r.length&&r.decompose(0,r.length,n,3),this.decompose(t,this.length,n,1),y.from(n,this.length-(t-e)+r.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=l(this,e,t);var r=[];return this.decompose(e,t,r,0),y.from(r,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;var r=this.scanIdentical(e,1),n=this.length-this.scanIdentical(e,-1),a=new f(this),i=new f(e);for(let e=r,t=r;;){if(a.next(e),i.next(e),e=0,a.lineBreak!=i.lineBreak||a.done!=i.done||a.value!=i.value)return!1;if(t+=a.value.length,a.done||t>=n)return!0}}iter(e=1){return new f(this,e)}iterRange(e,t=this.length){return new fe(this,e,t)}iterLines(e,t){let r;return r=null==e?this.iter():(null==t&&(t=this.lines+1),e=this.line(e).from,this.iterRange(e,Math.max(e,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))),new pe(r)}toString(){return this.sliceString(0)}toJSON(){var e=[];return this.flatten(e),e}constructor(){}static of(e){if(0==e.length)throw new RangeError("A document must have at least one line");return 1!=e.length||e[0]?e.length<=32?new _(e):y.from(_.split(e,[])):m.empty}}class _ extends m{constructor(e,t=function(e){let t=-1;for(var r of e)t+=r.length+1;return t}(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(t,r,n,a){for(let e=0;;e++){var i=this.text[e],o=a+i.length;if(t<=(r?n:o))return new he(a,o,n,i);a=o+1,n++}}decompose(e,t,r,n){t=e<=0&&t>=this.length?this:new _(B(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));1&n?(e=r.pop(),(n=a(t.text,e.text.slice(),0,t.length)).length<=32?r.push(new _(n,e.length+t.length)):(e=n.length>>1,r.push(new _(n.slice(0,e)),new _(n.slice(e))))):r.push(t)}replace(e,t,r){if(!(r instanceof _))return super.replace(e,t,r);[e,t]=l(this,e,t);var n=a(this.text,a(r.text,B(this.text,0,e)),t),r=this.length+r.length-(t-e);return n.length<=32?new _(n,r):y.from(_.split(n,[]),r)}sliceString(r,n=this.length,a="\n"){[r,n]=l(this,r,n);let i="";for(let e=0,t=0;e<=n&&t<this.text.length;t++){var o=this.text[t],s=e+o.length;e>r&&t&&(i+=a),r<s&&n>e&&(i+=o.slice(Math.max(0,r-e),n-e)),e=s+1}return i}flatten(e){for(var t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let r=[],n=-1;for(var a of e)r.push(a),n+=a.length+1,32==r.length&&(t.push(new _(r,n)),r=[],n=-1);return-1<n&&t.push(new _(r,n)),t}}class y extends m{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(var r of e)this.lines+=r.lines}lineInner(t,r,n,a){for(let e=0;;e++){var i=this.children[e],o=a+i.length,s=n+i.lines-1;if(t<=(r?s:o))return i.lineInner(t,r,n,a);a=o+1,n=1+s}}decompose(r,n,a,i){for(let e=0,t=0;t<=n&&e<this.children.length;e++){var o,s=this.children[e],l=t+s.length;r<=l&&n>=t&&(o=i&((t<=r?1:0)|(n<=l?2:0)),t>=r&&l<=n&&!o?a.push(s):s.decompose(r-t,n-t,a,o)),t=l+1}}replace(r,n,a){if([r,n]=l(this,r,n),a.lines<this.lines)for(let e=0,t=0;e<this.children.length;e++){var i,o=this.children[e],s=t+o.length;if(r>=t&&n<=s)return i=o.replace(r-t,n-t,a),o=this.lines-o.lines+i.lines,i.lines<o>>4&&i.lines>o>>6?((o=this.children.slice())[e]=i,new y(o,this.length-(n-r)+a.length)):super.replace(t,s,i);t=s+1}return super.replace(r,n,a)}sliceString(r,n=this.length,a="\n"){[r,n]=l(this,r,n);let i="";for(let e=0,t=0;e<this.children.length&&t<=n;e++){var o=this.children[e],s=t+o.length;t>r&&e&&(i+=a),r<s&&n>t&&(i+=o.sliceString(r-t,n-t,a)),t=s+1}return i}flatten(e){for(var t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof y))return 0;let r=0,[n,a,i,o]=0<t?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;n+=t,a+=t){if(n==i||a==o)return r;var s=this.children[n],l=e.children[a];if(s!=l)return r+s.scanIdentical(l,t);r+=s.length+1}}static from(e,t=e.reduce((e,t)=>e+t.length+1,-1)){let r=0;for(var n of e)r+=n.lines;if(r<32){var a,i=[];for(a of e)a.flatten(i);return new _(i,t)}let o=Math.max(32,r>>5),s=o<<1,l=o>>1,c=[],u=0,d=-1,f=[];function p(){0!=u&&(c.push(1==f.length?f[0]:y.from(f,d)),d=-1,u=f.length=0)}for(var h of e)!function e(t){let r;if(t.lines>s&&t instanceof y)for(var n of t.children)e(n);else t.lines>l&&(u>l||!u)?(p(),c.push(t)):t instanceof _&&u&&(r=f[f.length-1])instanceof _&&t.lines+r.lines<=32?(u+=t.lines,d+=t.length+1,f[f.length-1]=new _(r.text.concat(t.text),r.length+1+t.length)):(u+t.lines>o&&p(),u+=t.lines,d+=t.length+1,f.push(t))}(h);return p(),1==c.length?c[0]:new y(c,t)}}function a(i,o,s=0,l=1e9){for(let r=0,n=0,a=!0;n<i.length&&r<=l;n++){let e=i[n],t=r+e.length;s<=t&&(l<t&&(e=e.slice(0,l-r)),r<s&&(e=e.slice(s-r)),a?(o[o.length-1]+=e,a=!1):o.push(e)),r=t+1}return o}function B(e,t,r){return a(e,[""],t,r)}m.empty=new _([""],0);class f{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[0<t?1:(e instanceof _?e.text:e.children).length<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){var r=this.nodes.length-1,n=this.nodes[r],a=this.offsets[r],i=a>>1,o=(n instanceof _?n.text:n.children).length;if(i==(0<t?o:0)){if(0==r)return this.done=!0,this.value="",this;0<t&&this.offsets[r-1]++,this.nodes.pop(),this.offsets.pop()}else if((1&a)==(0<t?0:1)){if(this.offsets[r]+=t,0==e)return this.lineBreak=!0,this.value="\n",this;e--}else if(n instanceof _){o=n.text[i+(t<0?-1:0)];if(this.offsets[r]+=t,o.length>Math.max(0,e))return this.value=0==e?o:0<t?o.slice(e):o.slice(0,o.length-e),this;e-=o.length}else{a=n.children[i+(t<0?-1:0)];e>a.length?(e-=a.length,this.offsets[r]+=t):(t<0&&this.offsets[r]--,this.nodes.push(a),this.offsets.push(0<t?1:(a instanceof _?a.text:a.children).length<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class fe{constructor(e,t,r){this.value="",this.done=!1,this.cursor=new f(e,r<t?-1:1),this.pos=r<t?e.length:0,this.from=Math.min(t,r),this.to=Math.max(t,r)}nextInner(e,t){var r,n;return(t<0?this.pos<=this.from:this.pos>=this.to)?(this.value="",this.done=!0):(e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos),r=t<0?this.pos-this.from:this.to-this.pos,n=(r-=e=r<e?r:e,this.cursor.next(e))["value"],this.pos+=(n.length+e)*t,this.value=n.length<=r?n:t<0?n.slice(n.length-r):n.slice(0,r),this.done=!this.value),this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):0<e&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&""!=this.value}}class pe{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){var{done:e,lineBreak:t,value:r}=this.inner.next(e);return e&&this.afterBreak?(this.value="",this.afterBreak=!1):e?(this.done=!0,this.value=""):t?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=r,this.afterBreak=!1),this}get lineBreak(){return!1}}"undefined"!=typeof Symbol&&(m.prototype[Symbol.iterator]=function(){return this.iter()},f.prototype[Symbol.iterator]=fe.prototype[Symbol.iterator]=pe.prototype[Symbol.iterator]=function(){return this});class he{constructor(e,t,r,n){this.from=e,this.to=t,this.number=r,this.text=n}get length(){return this.to-this.from}}function l(e,t,r){return[t=Math.max(0,Math.min(e.length,t)),Math.max(t,Math.min(e.length,r))]}let i="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=1;e<i.length;e++)i[e]+=i[e-1];function j(e){return 127462<=e&&e<=127487}const ge=8205;function u(e,t,r=!0,n=!0){return(r?H:G)(e,t,n)}function H(r,n,t){if(n!=r.length){n&&V(r.charCodeAt(n))&&W(r.charCodeAt(n-1))&&n--;let e=s(r,n);for(n+=q(e);n<r.length;){var a=s(r,n);if(e==ge||a==ge||t&&function(t){for(let e=1;e<i.length;e+=2)if(i[e]>t)return i[e-1]<=t}(a))n+=q(a),e=a;else{if(!j(a))break;{let e=0,t=n-2;for(;0<=t&&j(s(r,t));)e++,t-=2;if(e%2==0)break;n+=2}}}}return n}function G(e,t,r){for(;0<t;){var n=H(e,t-2,r);if(n<t)return n;t--}return 0}function V(e){return 56320<=e&&e<57344}function W(e){return 55296<=e&&e<56320}function s(e,t){var r=e.charCodeAt(t);return W(r)&&t+1!=e.length&&V(e=e.charCodeAt(t+1))?e-56320+(r-55296<<10)+65536:r}function q(e){return e<65536?1:2}const me=/\r\n?|\n/;c.MapMode=void 0,(n=c.MapMode||(c.MapMode={}))[n.Simple=0]="Simple",n[n.TrackDel=1]="TrackDel",n[n.TrackBefore=2]="TrackBefore",n[n.TrackAfter=3]="TrackAfter";class T{constructor(e){this.sections=e}get length(){let t=0;for(let e=0;e<this.sections.length;e+=2)t+=this.sections[e];return t}get newLength(){let t=0;for(let e=0;e<this.sections.length;e+=2){var r=this.sections[e+1];t+=r<0?this.sections[e]:r}return t}get empty(){return 0==this.sections.length||2==this.sections.length&&this.sections[1]<0}iterGaps(n){for(let e=0,t=0,r=0;e<this.sections.length;){var a=this.sections[e++],i=this.sections[e++];i<0?(n(t,r,a),r+=a):r+=i,t+=a}}iterChangedRanges(e,t=!1){$(this,e,t)}get invertedDesc(){var t=[];for(let e=0;e<this.sections.length;){var r=this.sections[e++],n=this.sections[e++];n<0?t.push(r,n):t.push(n,r)}return new T(t)}composeDesc(e){return this.empty?e:e.empty?this:K(this,e)}mapDesc(e,t=!1){return e.empty?this:z(this,e,t)}mapPos(t,r=-1,n=c.MapMode.Simple){let a=0,i=0;for(let e=0;e<this.sections.length;){var o=this.sections[e++],s=this.sections[e++],l=a+o;if(s<0){if(t<l)return i+(t-a);i+=o}else{if(n!=c.MapMode.Simple&&t<=l&&(n==c.MapMode.TrackDel&&a<t&&t<l||n==c.MapMode.TrackBefore&&a<t||n==c.MapMode.TrackAfter&&t<l))return null;if(t<l||l==t&&r<0&&!o)return t==a||r<0?i:i+s;i+=s}a=l}if(t>a)throw new RangeError(`Position ${t} is out of range for changeset of length `+a);return i}touchesRange(r,n=r){for(let e=0,t=0;e<this.sections.length&&t<=n;){var a=this.sections[e++],i=this.sections[e++],a=t+a;if(0<=i&&t<=n&&r<=a)return!(t<r&&n<a)||"cover";t=a}return!1}toString(){let t="";for(let e=0;e<this.sections.length;){var r=this.sections[e++],n=this.sections[e++];t+=(t?" ":"")+r+(0<=n?":"+n:"")}return t}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(e=>"number"!=typeof e))throw new RangeError("Invalid JSON representation of ChangeDesc");return new T(e)}static create(e){return new T(e)}}class b extends T{constructor(e,t){super(e),this.inserted=t}apply(i){if(this.length!=i.length)throw new RangeError("Applying change set to a document with the wrong length");return $(this,(e,t,r,n,a)=>i=i.replace(r,r+(t-e),a),!1),i}mapDesc(e,t=!1){return z(this,e,t,!0)}invert(r){var n=this.sections.slice(),a=[];for(let e=0,t=0;e<n.length;e+=2){var i=n[e],o=n[e+1];if(0<=o){n[e]=o,n[e+1]=i;for(var s=e>>1;a.length<s;)a.push(m.empty);a.push(i?r.slice(t,t+i):m.empty)}t+=i}return new b(n,a)}compose(e){return this.empty?e:e.empty?this:K(this,e,!0)}map(e,t=!1){return e.empty?this:z(this,e,t,!0)}iterChanges(e,t=!1){$(this,e,t)}get desc(){return T.create(this.sections)}filter(r){var n=[],a=[],i=[],o=new v(this);e:for(let e=0,t=0;;){for(var s=e==r.length?1e9:r[e++];t<s||t==s&&0==o.len;){if(o.done)break e;var l=Math.min(o.len,s-t),c=(p(i,l,-1),-1==o.ins?-1:0==o.off?o.ins:0);p(n,l,c),0<c&&h(a,n,o.text),o.forward(l),t+=l}for(var u=r[e++];t<u;){if(o.done)break e;var d=Math.min(o.len,u-t);p(n,d,-1),p(i,d,-1==o.ins?-1:0==o.off?o.ins:0),o.forward(d),t+=d}}return{changes:new b(n,a),filtered:T.create(i)}}toJSON(){var t=[];for(let e=0;e<this.sections.length;e+=2){var r=this.sections[e],n=this.sections[e+1];t.push(n<0?r:0==n?[r]:[r].concat(this.inserted[e>>1].toJSON()))}return t}static of(e,o,s){let l=[],c=[],u=0,d=null;function f(e=!1){(e||l.length)&&(u<o&&p(l,o-u,-1),e=new b(l,c),d=d?d.compose(e.map(d)):e,l=[],c=[],u=0)}return function e(t){if(Array.isArray(t))for(var r of t)e(r);else if(t instanceof b){if(t.length!=o)throw new RangeError(`Mismatched change set length (got ${t.length}, expected ${o})`);f(),d=d?d.compose(t.map(d)):t}else{var{from:t,to:n=t,insert:a}=t;if(n<t||t<0||o<n)throw new RangeError(`Invalid change range ${t} to ${n} (in doc of length ${o})`);var i=(a=a?"string"==typeof a?m.of(a.split(s||me)):a:m.empty).length;t==n&&0==i||(t<u&&f(),t>u&&p(l,t-u,-1),p(l,n-t,i),h(c,l,a),u=n)}}(e),f(!d),d}static empty(e){return new b(e?[e,-1]:[],[])}static fromJSON(t){if(!Array.isArray(t))throw new RangeError("Invalid JSON representation of ChangeSet");var r=[],n=[];for(let e=0;e<t.length;e++){var a=t[e];if("number"==typeof a)r.push(a,-1);else{if(!Array.isArray(a)||"number"!=typeof a[0]||a.some((e,t)=>t&&"string"!=typeof e))throw new RangeError("Invalid JSON representation of ChangeSet");if(1==a.length)r.push(a[0],0);else{for(;n.length<e;)n.push(m.empty);n[e]=m.of(a.slice(1)),r.push(a[0],n[e].length)}}}return new b(r,n)}static createSet(e,t){return new b(e,t)}}function p(e,t,r,n=!1){var a;0==t&&r<=0||(0<=(a=e.length-2)&&r<=0&&r==e[1+a]?e[a]+=t:0==t&&0==e[a]?e[1+a]+=r:n?(e[a]+=t,e[1+a]+=r):e.push(t,r))}function h(e,t,r){if(0!=r.length){var n=t.length-2>>1;if(n<e.length)e[e.length-1]=e[e.length-1].append(r);else{for(;e.length<n;)e.push(m.empty);e.push(r)}}}function $(l,c,u){var d=l.inserted;for(let i=0,o=0,s=0;s<l.sections.length;){let n=l.sections[s++],a=l.sections[s++];if(a<0)i+=n,o+=n;else{let e=i,t=o,r=m.empty;for(;e+=n,t+=a,a&&d&&(r=r.append(d[s-2>>1])),!(u||s==l.sections.length||l.sections[s+1]<0);)n=l.sections[s++],a=l.sections[s++];c(i,e,o,t,r),i=e,o=t}}}function z(e,t,n,r=!1){var a=[],i=r?[]:null,o=new v(e),s=new v(t);for(let r=-1;;)if(-1==o.ins&&-1==s.ins){var l=Math.min(o.len,s.len);p(a,l,-1),o.forward(l),s.forward(l)}else if(0<=s.ins&&(o.ins<0||r==o.i||0==o.off&&(s.len<o.len||s.len==o.len&&!n))){let e=s.len;for(p(a,s.ins,-1);e;){var c=Math.min(o.len,e);0<=o.ins&&r<o.i&&o.len<=c&&(p(a,0,o.ins),i&&h(i,a,o.text),r=o.i),o.forward(c),e-=c}s.next()}else{if(!(0<=o.ins)){if(o.done&&s.done)return i?b.createSet(a,i):T.create(a);throw new Error("Mismatched change set lengths")}{let e=0,t=o.len;for(;t;)if(-1==s.ins){var u=Math.min(t,s.len);e+=u,t-=u,s.forward(u)}else{if(!(0==s.ins&&s.len<t))break;t-=s.len,s.next()}p(a,e,r<o.i?o.ins:0),i&&r<o.i&&h(i,a,o.text),r=o.i,o.forward(o.len-t)}}}function K(e,t,r=!1){var n=[],a=r?[]:null,i=new v(e),o=new v(t);for(let e=!1;;){if(i.done&&o.done)return a?b.createSet(n,a):T.create(n);if(0==i.ins)p(n,i.len,0,e),i.next();else if(0!=o.len||o.done){if(i.done||o.done)throw new Error("Mismatched change set lengths");var s,l=Math.min(i.len2,o.len),c=n.length;-1==i.ins?(p(n,l,s=-1==o.ins?-1:o.off?0:o.ins,e),a&&s&&h(a,n,o.text)):-1==o.ins?(p(n,i.off?0:i.len,l,e),a&&h(a,n,i.textBit(l))):(p(n,i.off?0:i.len,o.off?0:o.ins,e),a&&!o.off&&h(a,n,o.text)),e=(i.ins>l||0<=o.ins&&o.len>l)&&(e||c<n.length),i.forward2(l),o.forward(l)}else p(n,0,o.ins,e),a&&h(a,n,o.text),o.next()}}class v{constructor(e){this.set=e,this.i=0,this.next()}next(){var e=this.set["sections"];this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return-2==this.ins}get len2(){return this.ins<0?this.len:this.ins}get text(){var e=this.set["inserted"],t=this.i-2>>1;return t>=e.length?m.empty:e[t]}textBit(e){var t=this.set["inserted"],r=this.i-2>>1;return r>=t.length&&!e?m.empty:t[r].slice(this.off,null==e?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){-1==this.ins?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class E{constructor(e,t,r){this.from=e,this.to=t,this.flags=r}get anchor(){return 32&this.flags?this.to:this.from}get head(){return 32&this.flags?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return 8&this.flags?-1:16&this.flags?1:0}get bidiLevel(){var e=7&this.flags;return 7==e?null:e}get goalColumn(){var e=this.flags>>6;return 16777215==e?void 0:e}map(e,t=-1){let r,n;return this.empty?r=n=e.mapPos(this.from,t):(r=e.mapPos(this.from,1),n=e.mapPos(this.to,-1)),r==this.from&&n==this.to?this:new E(r,n,this.flags)}extend(e,t=e){return e<=this.anchor&&t>=this.anchor?S.range(e,t):(t=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t,S.range(this.anchor,t))}eq(e,t=!1){return!(this.anchor!=e.anchor||this.head!=e.head||t&&this.empty&&this.assoc!=e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(e&&"number"==typeof e.anchor&&"number"==typeof e.head)return S.range(e.anchor,e.head);throw new RangeError("Invalid JSON representation for SelectionRange")}static create(e,t,r){return new E(e,t,r)}}class S{constructor(e,t){this.ranges=e,this.mainIndex=t}map(t,r=-1){return t.empty?this:S.create(this.ranges.map(e=>e.map(t,r)),this.mainIndex)}eq(t,r=!1){if(this.ranges.length!=t.ranges.length||this.mainIndex!=t.mainIndex)return!1;for(let e=0;e<this.ranges.length;e++)if(!this.ranges[e].eq(t.ranges[e],r))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return 1==this.ranges.length?this:new S([this.main],0)}addRange(e,t=!0){return S.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){var r=this.ranges.slice();return r[t]=e,S.create(r,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||"number"!=typeof e.main||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new S(e.ranges.map(e=>E.fromJSON(e)),e.main)}static single(e,t=e){return new S([S.range(e,t)],0)}static create(r,n=0){if(0==r.length)throw new RangeError("A selection needs at least one range");for(let e=0,t=0;t<r.length;t++){var a=r[t];if(a.empty?a.from<=e:a.from<e)return S.normalized(r.slice(),n);e=a.to}return new S(r,n)}static cursor(e,t=0,r,n){return E.create(e,e,(0==t?0:t<0?8:16)|(null==r?7:Math.min(6,r))|(null!=n?n:16777215)<<6)}static range(e,t,r,n){r=(null!=r?r:16777215)<<6|(null==n?7:Math.min(6,n));return t<e?E.create(t,e,48|r):E.create(e,t,(e<t?8:0)|r)}static normalized(t,r=0){var e=t[r];t.sort((e,t)=>e.from-t.from),r=t.indexOf(e);for(let e=1;e<t.length;e++){var n,a=t[e],i=t[e-1];(a.empty?a.from<=i.to:a.from<i.to)&&(n=i.from,i=Math.max(a.to,i.to),e<=r&&r--,t.splice(--e,2,a.anchor>a.head?S.range(i,n):S.range(n,i)))}return new S(t,r)}}function Y(e,t){for(var r of e.ranges)if(r.to>t)throw new RangeError("Selection points outside of document")}let o=0;class A{constructor(e,t,r,n,a){this.combine=e,this.compareInput=t,this.compare=r,this.isStatic=n,this.id=o++,this.default=e([]),this.extensions="function"==typeof a?a(this):a}get reader(){return this}static define(e={}){return new A(e.combine||(e=>e),e.compareInput||((e,t)=>e===t),e.compare||(e.combine?(e,t)=>e===t:J),!!e.static,e.enables)}of(e){return new O([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new O(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new O(e,this,2,t)}from(t,r){return r=r||(e=>e),this.compute([t],e=>r(e.field(t)))}}function J(e,r){return e==r||e.length==r.length&&e.every((e,t)=>e===r[t])}class O{constructor(e,t,r,n){this.dependencies=e,this.facet=t,this.type=r,this.value=n,this.id=o++}dynamicSlot(e){var t,r;let i=this.value,o=this.facet.compareInput,s=this.id,l=e[s]>>1,c=2==this.type,n=!1,a=!1,u=[];for(r of this.dependencies)"doc"==r?n=!0:"selection"==r?a=!0:0==(1&(null!=(t=e[r.id])?t:1))&&u.push(e[r.id]);return{create(e){return e.values[l]=i(e),1},update(e,t){if(n&&t.docChanged||a&&(t.docChanged||t.selection)||Q(e,u)){t=i(e);if(c?!Z(t,e.values[l],o):!o(t,e.values[l]))return e.values[l]=t,1}return 0},reconfigure:(t,r)=>{let e,n=r.config.address[s];if(null!=n){var a=X(r,n);if(this.dependencies.every(e=>e instanceof A?r.facet(e)===t.facet(e):!(e instanceof C)||r.field(e,!1)==t.field(e,!1))||(c?Z(e=i(t),a,o):o(e=i(t),a)))return t.values[l]=a,0}else e=i(t);return t.values[l]=e,1}}}}function Z(t,r,n){if(t.length==r.length){for(let e=0;e<t.length;e++)if(!n(t[e],r[e]))return;return 1}}function Q(e,t){let r=!1;for(var n of t)1&g(e,n)&&(r=!0);return r}const _e=A.define({static:!0});class C{constructor(e,t,r,n,a){this.id=e,this.createF=t,this.updateF=r,this.compareF=n,this.spec=a,this.provides=void 0}static define(e){var t=new C(o++,e.create,e.update,e.compare||((e,t)=>e===t),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){var t=e.facet(_e).find(e=>e.field==this);return((null==t?void 0:t.create)||this.createF)(e)}slot(e){let n=e[this.id]>>1;return{create:e=>(e.values[n]=this.create(e),1),update:(e,t)=>{var r=e.values[n],t=this.updateF(r,t);return this.compareF(r,t)?0:(e.values[n]=t,1)},reconfigure:(e,t)=>null!=t.config.address[this.id]?(e.values[n]=t.field(this),0):(e.values[n]=this.create(e),1)}}init(e){return[this,_e.of({field:this,create:e})]}get extension(){return this}}const k={lowest:4,low:3,default:2,high:1,highest:0};function t(t){return e=>new ye(e,t)}var r,n={highest:t(k.highest),high:t(k.high),default:t(k.default),low:t(k.low),lowest:t(k.lowest)};class ye{constructor(e,t){this.inner=e,this.prec=t}}class w{of(e){return new Te(this,e)}reconfigure(e){return w.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class Te{constructor(e,t){this.compartment=e,this.inner=t}}class be{constructor(e,t,r,n,a,i){for(this.base=e,this.compartments=t,this.dynamicSlots=r,this.address=n,this.staticValues=a,this.facets=i,this.statusTemplate=[];this.statusTemplate.length<r.length;)this.statusTemplate.push(0)}staticFacet(e){var t=this.address[e.id];return null==t?e.default:this.staticValues[t>>1]}static resolve(e,t,n){var r,a=[],i=Object.create(null),o=new Map;for(r of function(e,o,s){let l=[[],[],[],[],[]],c=new Map;return function e(t,r){var n=c.get(t);if(null!=n){if(n<=r)return;var a=l[n].indexOf(t);-1<a&&l[n].splice(a,1),t instanceof Te&&s.delete(t.compartment)}if(c.set(t,r),Array.isArray(t))for(var i of t)e(i,r);else if(t instanceof Te){if(s.has(t.compartment))throw new RangeError("Duplicate use of compartment in extensions");n=o.get(t.compartment)||t.inner,s.set(t.compartment,n),e(n,r)}else if(t instanceof ye)e(t.inner,t.prec);else if(t instanceof C)l[r].push(t),t.provides&&e(t.provides,r);else if(t instanceof O)l[r].push(t),t.facet.extensions&&e(t.facet.extensions,k.default);else{if(!(a=t.extension))throw new Error(`Unrecognized extension value in extension set (${t}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);e(a,r)}}(e,k.default),l.reduce((e,t)=>e.concat(t))}(e,t,o))(r instanceof C?a:i[r.facet.id]||(i[r.facet.id]=[])).push(r);let s=Object.create(null);var l=[],c=[];for(let t of a)s[t.id]=c.length<<1,c.push(e=>t.slot(e));var d,f=null==n?void 0:n.config.facets;for(d in i){let r=i[d],u=r[0].facet;var p=f&&f[d]||[];if(r.every(e=>0==e.type))s[u.id]=l.length<<1|1,J(p,r)?l.push(n.facet(u)):(p=u.combine(r.map(e=>e.value)),l.push(n&&u.compare(p,n.facet(u))?n.facet(u):p));else{for(let t of r)0==t.type?(s[t.id]=l.length<<1|1,l.push(t.value)):(s[t.id]=c.length<<1,c.push(e=>t.dynamicSlot(e)));s[u.id]=c.length<<1,c.push(e=>{{var t=e,s=u,l=r;let i=l.map(e=>t[e.id]),o=l.map(e=>e.type),n=i.filter(e=>!(1&e)),a=t[s.id]>>1;function c(t){var r=[];for(let e=0;e<i.length;e++){var n=X(t,i[e]);if(2==o[e])for(var a of n)r.push(a);else r.push(n)}return s.combine(r)}return{create(e){for(var t of i)g(e,t);return e.values[a]=c(e),1},update(e,t){var r;return!Q(e,n)||(r=c(e),s.compare(r,e.values[a]))?0:(e.values[a]=r,1)},reconfigure(e,t){var r=Q(e,i),n=t.config.facets[s.id],t=t.facet(s);return n&&!r&&J(l,n)||(r=c(e),s.compare(r,t))?(e.values[a]=t,0):(e.values[a]=r,1)}}}})}}t=c.map(e=>e(s));return new be(e,o,t,s,l,i)}}function g(e,t){if(1&t)return 2;var t=t>>1,r=e.status[t];if(4==r)throw new Error("Cyclic dependency between fields and/or facets");if(2&r)return r;e.status[t]=4;r=e.computeSlot(e,e.config.dynamicSlots[t]);return e.status[t]=2|r}function X(e,t){return(1&t?e.config.staticValues:e.values)[t>>1]}const ve=A.define(),Ee=A.define({combine:e=>e.some(e=>e),static:!0}),Se=A.define({combine:e=>e.length?e[0]:void 0,static:!0}),Ae=A.define(),Oe=A.define(),Ce=A.define(),ke=A.define({combine:e=>!!e.length&&e[0]});class R{constructor(e,t){this.type=e,this.value=t}static define(){return new we}}class we{of(e){return new R(this,e)}}class Re{constructor(e){this.map=e}of(e){return new I(this,e)}}class I{constructor(e,t){this.type=e,this.value=t}map(e){e=this.type.map(this.value,e);return void 0===e?void 0:e==this.value?this:new I(this.type,e)}is(e){return this.type==e}static define(e={}){return new Re(e.map||(e=>e))}static mapEffects(e,t){if(!e.length)return e;var r,n=[];for(r of e){var a=r.map(t);a&&n.push(a)}return n}}I.reconfigure=I.define(),I.appendConfig=I.define();class M{constructor(e,t,r,n,a,i){this.startState=e,this.changes=t,this.selection=r,this.effects=n,this.annotations=a,this.scrollIntoView=i,this._doc=null,this._state=null,r&&Y(r,t.newLength),a.some(e=>e.type==M.time)||(this.annotations=a.concat(M.time.of(Date.now())))}static create(e,t,r,n,a,i){return new M(e,t,r,n,a,i)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(var t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){var t=this.annotation(M.userEvent);return!(!t||!(t==e||t.length>e.length&&t.slice(0,e.length)==e&&"."==t[e.length]))}}function ee(e,t,r){let n,a,i;return{changes:i=r?(n=t.changes,a=b.empty(t.changes.length),e.changes.compose(t.changes)):(n=t.changes.map(e.changes),a=e.changes.mapDesc(t.changes,!0),e.changes.compose(n)),selection:t.selection?t.selection.map(a):null==(r=e.selection)?void 0:r.map(n),effects:I.mapEffects(e.effects,n).concat(I.mapEffects(t.effects,a)),annotations:e.annotations.length?e.annotations.concat(t.annotations):t.annotations,scrollIntoView:e.scrollIntoView||t.scrollIntoView}}function te(e,t,r){let n=t.selection,a=d(t.annotations);return t.userEvent&&(a=a.concat(M.userEvent.of(t.userEvent))),{changes:t.changes instanceof b?t.changes:b.of(t.changes||[],r,e.facet(Se)),selection:n&&(n instanceof S?n:S.single(n.anchor,n.head)),effects:d(t.effects),annotations:a,scrollIntoView:!!t.scrollIntoView}}function re(t,r,a){let n=te(t,r.length?r[0]:{},t.doc.length);r.length&&!1===r[0].filter&&(a=!1);for(let e=1;e<r.length;e++){!1===r[e].filter&&(a=!1);var i=!!r[e].sequential;n=ee(n,te(t,r[e],i?n.changes.newLength:t.doc.length),i)}var e=M.create(t,n.changes,n.selection,n.effects,n.annotations,n.scrollIntoView);{var o=a?function(r){let n=r.startState,a=!0;for(var e of n.facet(Ae)){e=e(r);if(!1===e){a=!1;break}Array.isArray(e)&&(a=!0===a?e:function(a,i){var o=[];for(let r=0,n=0;;){let e,t;if(r<a.length&&(n==i.length||i[n]>=a[r]))e=a[r++],t=a[r++];else{if(!(n<i.length))return o;e=i[n++],t=i[n++]}!o.length||o[o.length-1]<e?o.push(e,t):o[o.length-1]<t&&(o[o.length-1]=t)}}(a,e))}if(!0!==a){let e,t;var i;!1===a?(t=r.changes.invertedDesc,e=b.empty(n.doc.length)):(i=r.changes.filter(a),e=i.changes,t=i.filtered.mapDesc(i.changes).invertedDesc),r=M.create(n,e,r.selection&&r.selection.map(t),I.mapEffects(r.effects,t),r.annotations,r.scrollIntoView)}var t=n.facet(Oe);for(let e=t.length-1;0<=e;e--){var o=t[e](r);r=o instanceof M?o:Array.isArray(o)&&1==o.length&&o[0]instanceof M?o[0]:re(n,d(o),!1)}return r}(e):e;let t=o.startState,r=t.facet(Ce),n=o;for(let e=r.length-1;0<=e;e--){var s=r[e](o);s&&Object.keys(s).length&&(n=ee(n,te(t,s,o.changes.newLength),!0))}return n==o?o:M.create(t,o.changes,o.selection,n.effects,n.annotations,n.scrollIntoView)}}M.time=R.define(),M.userEvent=R.define(),M.addToHistory=R.define(),M.remote=R.define();const Ie=[];function d(e){return null==e?Ie:Array.isArray(e)?e:[e]}c.CharCategory=void 0,(r=c.CharCategory||(c.CharCategory={}))[r.Word=0]="Word",r[r.Space=1]="Space",r[r.Other=2]="Other";const Me=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let e;try{e=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(e){}function ne(r){return t=>{if(!/\S/.test(t))return c.CharCategory.Space;if(function(t){if(e)return e.test(t);for(let e=0;e<t.length;e++){var r=t[e];if(/\w/.test(r)||""<r&&(r.toUpperCase()!=r.toLowerCase()||Me.test(r)))return 1}}(t))return c.CharCategory.Word;for(let e=0;e<r.length;e++)if(-1<t.indexOf(r[e]))return c.CharCategory.Word;return c.CharCategory.Other}}class P{constructor(e,t,r,n,a,i){this.config=e,this.doc=t,this.selection=r,this.values=n,this.status=e.statusTemplate.slice(),this.computeSlot=a,i&&(i._state=this);for(let e=0;e<this.config.dynamicSlots.length;e++)g(this,e<<1);this.computeSlot=null}field(e,t=!0){e=this.config.address[e.id];if(null!=e)return g(this,e),X(this,e);if(t)throw new RangeError("Field is not present in this state")}update(...e){return re(this,e,!0)}applyTransaction(r){let e=this.config,{base:t,compartments:n}=e;for(var a of r.effects)a.is(w.reconfigure)?(e&&(n=new Map,e.compartments.forEach((e,t)=>n.set(t,e)),e=null),n.set(a.value.compartment,a.value.extension)):a.is(I.reconfigure)?(e=null,t=a.value):a.is(I.appendConfig)&&(e=null,t=d(t).concat(a.value));let i;i=e?r.startState.values.slice():(e=be.resolve(t,n,this),new P(e,this.doc,this.selection,e.dynamicSlots.map(()=>null),(e,t)=>t.reconfigure(e,this),null).values);var o=r.startState.facet(Ee)?r.newSelection:r.newSelection.asSingle();new P(e,r.newDoc,o,i,(e,t)=>t.update(e,r),r)}replaceSelection(t){return"string"==typeof t&&(t=this.toText(t)),this.changeByRange(e=>({changes:{from:e.from,to:e.to,insert:t},range:S.cursor(e.from+t.length)}))}changeByRange(e){var r=this.selection,t=e(r.ranges[0]);let n=this.changes(t.changes),a=[t.range],i=d(t.effects);for(let t=1;t<r.ranges.length;t++){var o=e(r.ranges[t]),s=this.changes(o.changes),l=s.map(n);for(let e=0;e<t;e++)a[e]=a[e].map(l);s=n.mapDesc(s,!0);a.push(o.range.map(s)),n=n.compose(l),i=I.mapEffects(i,l).concat(I.mapEffects(d(o.effects),s))}return{changes:n,selection:S.create(a,r.mainIndex),effects:i}}changes(e=[]){return e instanceof b?e:b.of(e,this.doc.length,this.facet(P.lineSeparator))}toText(e){return m.of(e.split(this.facet(P.lineSeparator)||me))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){var t=this.config.address[e.id];return null==t?e.default:(g(this,t),X(this,t))}toJSON(e){var t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(var r in e){var n=e[r];n instanceof C&&null!=this.config.address[n.id]&&(t[r]=n.spec.toJSON(this.field(e[r]),this))}return t}static fromJSON(e,t={},n){if(!e||"string"!=typeof e.doc)throw new RangeError("Invalid JSON representation for EditorState");var a=[];if(n)for(var i in n)if(Object.prototype.hasOwnProperty.call(e,i)){let t=n[i],r=e[i];a.push(t.init(e=>t.spec.fromJSON(r,e)))}return P.create({doc:e.doc,selection:S.fromJSON(e.selection),extensions:t.extensions?a.concat([t.extensions]):a})}static create(e={}){var t=be.resolve(e.extensions||[],new Map),r=e.doc instanceof m?e.doc:m.of((e.doc||"").split(t.staticFacet(P.lineSeparator)||me));let n=e.selection?e.selection instanceof S?e.selection:S.single(e.selection.anchor,e.selection.head):S.single(0);return Y(n,r.length),t.staticFacet(Ee)||(n=n.asSingle()),new P(t,r,n,t.dynamicSlots.map(()=>null),(e,t)=>t.create(e),null)}get tabSize(){return this.facet(P.tabSize)}get lineBreak(){return this.facet(P.lineSeparator)||"\n"}get readOnly(){return this.facet(ke)}phrase(e,...r){for(var t of this.facet(P.phrases))if(Object.prototype.hasOwnProperty.call(t,e)){e=t[e];break}return e=r.length?e.replace(/\$(\$|\d*)/g,(e,t)=>{return"$"==t?"$":!(t=+(t||1))||t>r.length?e:r[t-1]}):e}languageDataAt(e,t,r=-1){var n,a=[];for(n of this.facet(ve))for(var i of n(this,t,r))Object.prototype.hasOwnProperty.call(i,e)&&a.push(i[e]);return a}charCategorizer(e){return ne(this.languageDataAt("wordChars",e).join(""))}wordAt(e){var{text:t,from:r,length:n}=this.doc.lineAt(e),a=this.charCategorizer(e);let i=e-r,o=e-r;for(;0<i;){var s=u(t,i,!1);if(a(t.slice(s,i))!=c.CharCategory.Word)break;i=s}for(;o<n;){var l=u(t,o);if(a(t.slice(o,l))!=c.CharCategory.Word)break;o=l}return i==o?null:S.range(i+r,o+r)}}P.allowMultipleSelections=Ee,P.tabSize=A.define({combine:e=>e.length?e[0]:4}),P.lineSeparator=Se,P.readOnly=ke,P.phrases=A.define({compare(t,r){var e=Object.keys(t),n=Object.keys(r);return e.length==n.length&&e.every(e=>t[e]==r[e])}}),P.languageData=ve,P.changeFilter=Ae,P.transactionFilter=Oe,P.transactionExtender=Ce,w.reconfigure=I.define();class N{eq(e){return this==e}range(e,t=e){return D.create(e,t,this)}}N.prototype.startSide=N.prototype.endSide=0,N.prototype.point=!1,N.prototype.mapMode=c.MapMode.TrackDel;class D{constructor(e,t,r){this.from=e,this.to=t,this.value=r}static create(e,t,r){return new D(e,t,r)}}function ae(e,t){return e.from-t.from||e.value.startSide-t.value.startSide}class Pe{constructor(e,t,r,n){this.from=e,this.to=t,this.value=r,this.maxPoint=n}get length(){return this.to[this.to.length-1]}findIndex(r,n,a,i=0){var o=a?this.to:this.from;for(let e=i,t=o.length;;){if(e==t)return e;var s=e+t>>1,l=o[s]-r||(a?this.value[s].endSide:this.value[s].startSide)-n;if(s==e)return 0<=l?e:t;0<=l?t=s:e=1+s}}between(r,n,a,i){for(let e=this.findIndex(n,-1e9,!0),t=this.findIndex(a,1e9,!1,e);e<t;e++)if(!1===i(this.from[e]+r,this.to[e]+r,this.value[e]))return!1}map(o,s){let l=[],c=[],u=[],d=-1,f=-1;for(let i=0;i<this.value.length;i++){let e=this.value[i],t=this.from[i]+o,r=this.to[i]+o,n,a;if(t==r){var p=s.mapPos(t,e.startSide,e.mapMode);if(null==p)continue;if(n=a=p,e.startSide!=e.endSide&&(a=s.mapPos(t,e.endSide))<n)continue}else if(n=s.mapPos(t,e.startSide),a=s.mapPos(r,e.endSide),n>a||n==a&&0<e.startSide&&e.endSide<=0)continue;(a-n||e.endSide-e.startSide)<0||(d<0&&(d=n),e.point&&(f=Math.max(f,a-n)),l.push(e),c.push(n-d),u.push(a-d))}return{mapped:l.length?new Pe(c,u,l,f):null,pos:d}}}class x{constructor(e,t,r,n){this.chunkPos=e,this.chunk=t,this.nextLayer=r,this.maxPoint=n}static create(e,t,r,n){return new x(e,t,r,n)}get length(){var e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(var t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:r=!1,filterFrom:n=0,filterTo:a=this.length}=e;var i=e.filter;if(0==t.length&&!i)return this;if(r&&(t=t.slice().sort(ae)),this.isEmpty)return t.length?x.of(t):this;let o=new Ne(this,null,-1).goto(0),s=0,l=[];for(var c,u=new L;o.value||s<t.length;)s<t.length&&0<=(o.from-t[s].from||o.startSide-t[s].value.startSide)?(c=t[s++],u.addInner(c.from,c.to,c.value)||l.push(c)):1==o.rangeIndex&&o.chunkIndex<this.chunk.length&&(s==t.length||this.chunkEnd(o.chunkIndex)<t[s].from)&&(!i||n>this.chunkEnd(o.chunkIndex)||a<this.chunkPos[o.chunkIndex])&&u.addChunk(this.chunkPos[o.chunkIndex],this.chunk[o.chunkIndex])?o.nextChunk():((!i||n>o.to||a<o.from||i(o.from,o.to,o.value))&&!u.addInner(o.from,o.to,o.value)&&l.push(D.create(o.from,o.to,o.value)),o.next());return u.finishInner(this.nextLayer.isEmpty&&!l.length?x.empty:this.nextLayer.update({add:l,filter:i,filterFrom:n,filterTo:a}))}map(t){if(t.empty||this.isEmpty)return this;let r=[],n=[],a=-1;for(let e=0;e<this.chunk.length;e++){var i=this.chunkPos[e],o=this.chunk[e],s=t.touchesRange(i,i+o.length);!1===s?(a=Math.max(a,o.maxPoint),r.push(o),n.push(t.mapPos(i))):!0===s&&({mapped:s,pos:o}=o.map(i,t),s)&&(a=Math.max(a,s.maxPoint),r.push(s),n.push(o))}var e=this.nextLayer.map(t);return 0==r.length?e:new x(n,r,e||x.empty,a)}between(t,r,n){if(!this.isEmpty){for(let e=0;e<this.chunk.length;e++){var a=this.chunkPos[e],i=this.chunk[e];if(a<=r&&t<=a+i.length&&!1===i.between(a,t-a,r-a,n))return}this.nextLayer.between(t,r,n)}}iter(e=0){return F.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return F.from(e).goto(t)}static compare(e,t,r,n,a=-1){var e=e.filter(e=>0<e.maxPoint||!e.isEmpty&&e.maxPoint>=a),t=t.filter(e=>0<e.maxPoint||!e.isEmpty&&e.maxPoint>=a),i=ie(e,t,r);let o=new U(e,i,a),s=new U(t,i,a);r.iterGaps((e,t,r)=>se(o,e,s,t,r,n)),r.empty&&0==r.length&&se(o,0,s,0,0,n)}static eq(t,r,e=0,n){null==n&&(n=1e9-1);var a=t.filter(e=>!e.isEmpty&&r.indexOf(e)<0),i=r.filter(e=>!e.isEmpty&&t.indexOf(e)<0);if(a.length!=i.length)return!1;if(!a.length)return!0;for(var o=ie(a,i),s=new U(a,o,0).goto(e),l=new U(i,o,0).goto(e);;){if(s.to!=l.to||!le(s.active,l.active)||s.point&&(!l.point||!s.point.eq(l.point)))return!1;if(s.to>n)return!0;s.next(),l.next()}}static spans(e,t,r,n,a=-1){let i=new U(e,null,a).goto(t),o=t,s=i.openStart;for(;;){var l,c,u=Math.min(i.to,r);if(i.point?(l=i.activeForPoint(i.to),c=i.pointFrom<t?l.length+1:i.point.startSide<0?l.length:Math.min(l.length,s),n.point(o,u,i.point,l,c,i.pointRank),s=Math.min(i.openEnd(u),l.length)):u>o&&(n.span(o,u,i.active,s),s=i.openEnd(u)),i.to>r)return s+(i.point&&i.to>r?1:0);o=i.to,i.next()}}static of(e,t=!1){var r,n=new L;for(r of e instanceof D?[e]:t?function(r){if(1<r.length)for(let e=r[0],t=1;t<r.length;t++){var n=r[t];if(0<ae(e,n))return r.slice().sort(ae);e=n}return r}(e):e)n.add(r.from,r.to,r.value);return n.finish()}static join(r){if(!r.length)return x.empty;let n=r[r.length-1];for(let t=r.length-2;0<=t;t--)for(let e=r[t];e!=x.empty;e=e.nextLayer)n=new x(e.chunkPos,e.chunk,n,Math.max(e.maxPoint,n.maxPoint));return n}}x.empty=new x([],[],null,-1),x.empty.nextLayer=x.empty;class L{finishChunk(e){this.chunks.push(new Pe(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,r){this.addInner(e,t,r)||(this.nextLayer||(this.nextLayer=new L)).add(e,t,r)}addInner(e,t,r){var n=e-this.lastTo||r.startSide-this.last.endSide;if(n<=0&&(e-this.lastFrom||r.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return!(n<0||(250==this.from.length&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=r,this.lastFrom=e,this.lastTo=t,this.value.push(r),r.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),0))}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);var r=t.value.length-1;return this.last=t.value[r],this.lastFrom=t.from[r]+e,this.lastTo=t.to[r]+e,!0}finish(){return this.finishInner(x.empty)}finishInner(e){return this.from.length&&this.finishChunk(!1),0==this.chunks.length||(e=x.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint),this.from=null),e}}function ie(e,t,r){var n,a=new Map;for(n of e)for(let e=0;e<n.chunk.length;e++)n.chunk[e].maxPoint<=0&&a.set(n.chunk[e],n.chunkPos[e]);var i,o=new Set;for(i of t)for(let e=0;e<i.chunk.length;e++){var s=a.get(i.chunk[e]);null==s||(r?r.mapPos(s):s)!=i.chunkPos[e]||null!=r&&r.touchesRange(s,s+i.chunk[e].length)||o.add(i.chunk[e])}return o}class Ne{constructor(e,t,r,n=0){this.layer=e,this.skip=t,this.minPoint=r,this.rank=n}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,r){for(;this.chunkIndex<this.layer.chunk.length;){var n=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(n)||this.layer.chunkEnd(this.chunkIndex)<e||n.maxPoint<this.minPoint))break;this.chunkIndex++,r=!1}this.chunkIndex<this.layer.chunk.length&&(t=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0),!r||this.rangeIndex<t)&&this.setRangeIndex(t),this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;){if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}var e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],r=e+t.from[this.rangeIndex];if(this.from=r,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class F{constructor(e){this.heap=e}static from(r,n=null,a=-1){var i=[];for(let t=0;t<r.length;t++)for(let e=r[t];!e.isEmpty;e=e.nextLayer)e.maxPoint>=a&&i.push(new Ne(e,n,a,t));return 1==i.length?i[0]:new F(i)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(var r of this.heap)r.goto(e,t);for(let e=this.heap.length>>1;0<=e;e--)oe(this.heap,e);return this.next(),this}forward(e,t){for(var r of this.heap)r.forward(e,t);for(let e=this.heap.length>>1;0<=e;e--)oe(this.heap,e);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){var e;0==this.heap.length?(this.from=this.to=1e9,this.value=null,this.rank=-1):(e=this.heap[0],this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),oe(this.heap,0))}}function oe(r,n){for(var a=r[n];;){let e=1+(n<<1);if(e>=r.length)break;let t=r[e];if(e+1<r.length&&0<=t.compare(r[e+1])&&(t=r[e+1],e++),a.compare(t)<0)break;r[e]=a,r[n]=t,n=e}}class U{constructor(e,t,r){this.minPoint=r,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=F.from(e,t,r)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;-1<this.minActive&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){ce(this.active,e),ce(this.activeTo,e),ce(this.activeRank,e),this.minActive=de(this.active,this.activeTo)}addActive(e){let t=0,{value:r,to:n,rank:a}=this.cursor;for(;t<this.activeRank.length&&0<(a-this.activeRank[t]||n-this.activeTo[t]);)t++;ue(this.active,t,r),ue(this.activeTo,t,n),ue(this.activeRank,t,a),e&&ue(e,t,this.cursor.from),this.minActive=de(this.active,this.activeTo)}next(){for(var t=this.to,e=this.point,r=(this.point=null,this.openStart<0?[]:null);;){var n=this.minActive;if(-1<n&&(this.activeTo[n]-this.cursor.from||this.active[n].endSide-this.cursor.startSide)<0){if(this.activeTo[n]>t){this.to=this.activeTo[n],this.endSide=this.active[n].endSide;break}this.removeActive(n),r&&ce(r,n)}else{if(!this.cursor.value){this.to=this.endSide=1e9;break}if(this.cursor.from>t){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}n=this.cursor.value;if(n.point){if(!(e&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)){this.point=n,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=n.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else this.addActive(r);this.cursor.next()}}if(r){this.openStart=0;for(let e=r.length-1;0<=e&&r[e]<t;e--)this.openStart++}}activeForPoint(t){if(!this.active.length)return this.active;var r=[];for(let e=this.active.length-1;0<=e&&!(this.activeRank[e]<this.pointRank);e--)(this.activeTo[e]>t||this.activeTo[e]==t&&this.active[e].endSide>=this.point.endSide)&&r.push(this.active[e]);return r.reverse()}openEnd(t){let r=0;for(let e=this.activeTo.length-1;0<=e&&this.activeTo[e]>t;e--)r++;return r}}function se(e,t,r,n,a,i){e.goto(t),r.goto(n);var o=n+a;let s=n,l=n-t;for(;;){var c=e.to+l-r.to||e.endSide-r.endSide,u=c<0?e.to+l:r.to,d=Math.min(u,o);if(e.point||r.point?e.point&&r.point&&(e.point==r.point||e.point.eq(r.point))&&le(e.activeForPoint(e.to),r.activeForPoint(r.to))||i.comparePoint(s,d,e.point,r.point):d>s&&!le(e.active,r.active)&&i.compareRange(s,d,e.active,r.active),o<u)break;s=u,c<=0&&e.next(),0<=c&&r.next()}}function le(t,r){if(t.length==r.length){for(let e=0;e<t.length;e++)if(t[e]!=r[e]&&!t[e].eq(r[e]))return;return 1}}function ce(r,n){for(let e=n,t=r.length-1;e<t;e++)r[e]=r[e+1];r.pop()}function ue(t,r,e){for(let e=t.length-1;e>=r;e--)t[e+1]=t[e];t[r]=e}function de(t,r){let n=-1,a=1e9;for(let e=0;e<r.length;e++)(r[e]-a||t[e].endSide-t[n].endSide)<0&&(n=e,a=r[e]);return n}c.Annotation=R,c.AnnotationType=we,c.ChangeDesc=T,c.ChangeSet=b,c.Compartment=w,c.EditorSelection=S,c.EditorState=P,c.Facet=A,c.Line=he,c.Prec=n,c.Range=D,c.RangeSet=x,c.RangeSetBuilder=L,c.RangeValue=N,c.SelectionRange=E,c.StateEffect=I,c.StateEffectType=Re,c.StateField=C,c.Text=m,c.Transaction=M,c.codePointAt=s,c.codePointSize=q,c.combineConfig=function(e,t,r={}){var n,a,i={};for(n of e)for(var o of Object.keys(n)){var s=n[o],l=i[o];if(void 0===l)i[o]=s;else if(l!==s&&void 0!==s){if(!Object.hasOwnProperty.call(r,o))throw new Error("Config merge conflict for field "+o);i[o]=r[o](l,s)}}for(a in t)void 0===i[a]&&(i[a]=t[a]);return i},c.countColumn=function(t,r,n=t.length){let a=0;for(let e=0;e<n;)9==t.charCodeAt(e)?(a+=r-a%r,e++):(a++,e=u(t,e));return a},c.findClusterBreak=u,c.findColumn=function(r,n,a,e){for(let e=0,t=0;;){if(t>=n)return e;if(e==r.length)break;t+=9==r.charCodeAt(e)?a-t%a:1,e=u(r,e)}return!0===e?-1:r.length},c.fromCodePoint=function(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}}}return R1}var M1,P1={},N1={};function D1(){var t,i,r,e,o,a;return M1||(M1=1,t="undefined"==typeof Symbol?"__ͼ":Symbol.for("ͼ"),i="undefined"==typeof Symbol?"__styleSet"+Math.floor(1e8*Math.random()):Symbol("styleSet"),r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:{},(e=N1.StyleModule=function(e,t){this.rules=[];var r,u=(t||{}).finish;function d(e){return/^@/.test(e)?[e]:e.split(/,\s*/)}for(r in e)!function e(r,t,n,a){var i,o=[],s=/^@(\w+)\b/.exec(r[0]),l=s&&"keyframes"==s[1];if(s&&null==t)return n.push(r[0]+";");for(i in t){var c=t[i];if(/&/.test(i))e(i.split(/,\s*/).map(function(t){return r.map(function(e){return t.replace(/&/,e)})}).reduce(function(e,t){return e.concat(t)}),c,n);else if(c&&"object"==typeof c){if(!s)throw new RangeError("The value of a property ("+i+") should be a primitive value.");e(d(i),c,o,l)}else null!=c&&o.push(i.replace(/_.*/,"").replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()})+": "+c+";")}(o.length||l)&&n.push((!u||s||a?r:r.map(u)).join(", ")+" {"+o.join(" ")+"}")}(d(r),e[r],this.rules)}).prototype.getRules=function(){return this.rules.join("\n")},e.newName=function(){var e=r[t]||1;return r[t]=e+1,"ͼ"+e.toString(36)},e.mount=function(e,t,r){var n=e[i],r=r&&r.nonce;n?r&&n.setNonce(r):n=new a(e,r),n.mount(Array.isArray(t)?t:[t])},o=new Map,(a=function(e,t){var r=e.ownerDocument||e,n=r.defaultView;if(!e.head&&e.adoptedStyleSheets&&n.CSSStyleSheet){var a=o.get(r);if(a)return e.adoptedStyleSheets=[a.sheet].concat(e.adoptedStyleSheets),e[i]=a;this.sheet=new n.CSSStyleSheet,e.adoptedStyleSheets=[this.sheet].concat(e.adoptedStyleSheets),o.set(r,this)}else{this.styleTag=r.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);a=e.head||e;a.insertBefore(this.styleTag,a.firstChild)}this.modules=[],e[i]=this}).prototype.mount=function(e){for(var t=this.sheet,r=0,n=0,a=0;a<e.length;a++){var i=e[a],o=this.modules.indexOf(i);if(o<n&&-1<o&&(this.modules.splice(o,1),n--,o=-1),-1==o){if(this.modules.splice(n++,0,i),t)for(var s=0;s<i.rules.length;s++)t.insertRule(i.rules[s],r++)}else{for(;n<o;)r+=this.modules[n++].rules.length;r+=i.rules.length,n++}}if(!t){for(var l="",c=0;c<this.modules.length;c++)l+=this.modules[c].getRules()+"\n";this.styleTag.textContent=l}},a.prototype.setNonce=function(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}),N1}var x1,L1,F1={};function U1(){if(!x1){x1=1,Object.defineProperty(F1,"__esModule",{value:!0});for(var t={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},r={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},n="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),a="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),e=0;e<10;e++)t[48+e]=t[96+e]=String(e);for(e=1;e<=24;e++)t[e+111]="F"+e;for(var i,e=65;e<=90;e++)t[e]=String.fromCharCode(e+32),r[e]=String.fromCharCode(e);for(i in t)r.hasOwnProperty(i)||(r[i]=t[i]);F1.base=t,F1.keyName=function(e){return e="Down"==(e="Right"==(e="Up"==(e="Left"==(e="Del"==(e="Esc"==(e=!(n&&e.metaKey&&e.shiftKey&&!e.ctrlKey&&!e.altKey||a&&e.shiftKey&&e.key&&1==e.key.length||"Unidentified"==e.key)&&e.key||(e.shiftKey?r:t)[e.keyCode]||e.key||"Unidentified")?"Escape":e)?"Delete":e)?"ArrowLeft":e)?"ArrowUp":e)?"ArrowRight":e)?"ArrowDown":e},F1.shift=r}return F1}function B1(){if(!L1){L1=1;{var O=P1;var _=I1(),Z=D1(),Q=U1();function X(e){let t;return(t=11!=e.nodeType||e.getSelection?e:e.ownerDocument).getSelection()}function ee(e,t){return!!t&&(e==t||e.contains(1!=t.nodeType?t.parentNode:t))}function te(e,t){if(!t.anchorNode)return!1;try{return ee(e,t.anchorNode)}catch(e){return!1}}function re(e){return 3==e.nodeType?T(e,0,e.nodeValue.length).getClientRects():1==e.nodeType?e.getClientRects():[]}function ne(e,t,r,n){return!!r&&(ie(e,t,r,n,-1)||ie(e,t,r,n,1))}function h(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t}function ae(e){return 1==e.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(e.nodeName)}function ie(e,t,r,n,a){for(;;){if(e==r&&t==n)return!0;if(t==(a<0?0:y(e))){if("DIV"==e.nodeName)return!1;var i=e.parentNode;if(!i||1!=i.nodeType)return!1;t=h(e)+(a<0?0:1),e=i}else{if(1!=e.nodeType)return!1;if(1==(e=e.childNodes[t+(a<0?-1:0)]).nodeType&&"false"==e.contentEditable)return!1;t=a<0?y(e):0}}}function y(e){return(3==e.nodeType?e.nodeValue:e.childNodes).length}function oe(e,t){t=t?e.left:e.right;return{left:t,right:t,top:e.top,bottom:e.bottom}}function se(e,t){let r=t.width/e.offsetWidth,n=t.height/e.offsetHeight;return(.995<r&&r<1.005||!isFinite(r)||Math.abs(t.width-e.offsetWidth)<1)&&(r=1),(.995<n&&n<1.005||!isFinite(n)||Math.abs(t.height-e.offsetHeight)<1)&&(n=1),{scaleX:r,scaleY:n}}class jt{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){var{anchorNode:t,focusNode:r}=e;this.set(t,Math.min(e.anchorOffset,t?y(t):0),r,Math.min(e.focusOffset,r?y(r):0))}set(e,t,r,n){this.anchorNode=e,this.anchorOffset=t,this.focusNode=r,this.focusOffset=n}}let e=null;function le(t){if(t.setActive)return t.setActive();if(e)return t.focus(e);var r=[];for(let e=t;e&&(r.push(e,e.scrollTop,e.scrollLeft),e!=e.ownerDocument);e=e.parentNode);if(t.focus(null==e?{get preventScroll(){return e={preventScroll:!0},!0}}:void 0),!e){e=!1;for(let e=0;e<r.length;){var n=r[e++],a=r[e++],i=r[e++];n.scrollTop!=a&&(n.scrollTop=a),n.scrollLeft!=i&&(n.scrollLeft=i)}}}let a;function T(e,t,r=t){var n=a=a||document.createRange();return n.setEnd(e,r),n.setStart(e,t),n}function ce(e,t,r,n){t={key:t,code:t,keyCode:r,which:r,cancelable:!0},n&&({altKey:t.altKey,ctrlKey:t.ctrlKey,shiftKey:t.shiftKey,metaKey:t.metaKey}=n),r=new KeyboardEvent("keydown",t),r.synthetic=!0,e.dispatchEvent(r),n=new KeyboardEvent("keyup",t);return n.synthetic=!0,e.dispatchEvent(n),r.defaultPrevented||n.defaultPrevented}function ue(e){for(;e.attributes.length;)e.removeAttributeNode(e.attributes[0])}function de(e){return e.scrollTop>Math.max(1,e.scrollHeight-e.clientHeight-4)}function fe(r,n){for(let e=r,t=n;;){if(3==e.nodeType&&0<t)return{node:e,offset:t};if(1==e.nodeType&&0<t){if("false"==e.contentEditable)return null;e=e.childNodes[t-1],t=y(e)}else{if(!e.parentNode||ae(e))return null;t=h(e),e=e.parentNode}}}function pe(r,n){for(let e=r,t=n;;){if(3==e.nodeType&&t<e.nodeValue.length)return{node:e,offset:t};if(1==e.nodeType&&t<e.childNodes.length){if("false"==e.contentEditable)return null;e=e.childNodes[t],t=0}else{if(!e.parentNode||ae(e))return null;t=h(e)+1,e=e.parentNode}}}class C{constructor(e,t,r=!0){this.node=e,this.offset=t,this.precise=r}static before(e,t){return new C(e.parentNode,h(e),t)}static after(e,t){return new C(e.parentNode,h(e)+1,t)}}const Ht=[];class k{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(var r of this.children){if(r==e)return t;t+=r.length+r.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(r,n){if(2&this.flags){var a,i,o=this.dom;let e=null,t;for(a of this.children){if(7&a.flags&&(a.dom||!(t=e?e.nextSibling:o.firstChild)||(i=k.get(t))&&(i.parent||!i.canReuseDOM(a))||a.reuseDOM(t),a.sync(r,n),a.flags&=-8),t=e?e.nextSibling:o.firstChild,n&&!n.written&&n.node==o&&t!=a.dom&&(n.written=!0),a.dom.parentNode==o)for(;t&&t!=a.dom;)t=he(t);else o.insertBefore(a.dom,t);e=a.dom}for((t=e?e.nextSibling:o.firstChild)&&n&&n.node==o&&(n.written=!0);t;)t=he(t)}else if(1&this.flags)for(var e of this.children)7&e.flags&&(e.sync(r,n),e.flags&=-8)}reuseDOM(e){}localPosFromDOM(t,r){let n;if(t==this.dom)n=this.dom.childNodes[r];else{let e=0==y(t)?0:0==r?-1:1;for(;;){var a=t.parentNode;if(a==this.dom)break;0==e&&a.firstChild!=a.lastChild&&(e=t==a.firstChild?-1:1),t=a}n=e<0?t:t.nextSibling}if(n==this.dom.firstChild)return 0;for(;n&&!k.get(n);)n=n.nextSibling;if(!n)return this.length;for(let e=0,t=0;;e++){var i=this.children[e];if(i.dom==n)return t;t+=i.length+i.breakAfter}}domBoundsAround(n,a,i=0){let o=-1,s=-1,l=-1,c=-1;for(let e=0,t=i,r=i;e<this.children.length;e++){var u=this.children[e],d=t+u.length;if(t<n&&a<d)return u.domBoundsAround(n,a,t);if(n<=d&&-1==o&&(o=e,s=t),t>a&&u.dom.parentNode==this.dom){l=e,c=r;break}r=d,t=d+u.breakAfter}return{from:s,to:c<0?i+this.length:c,startDOM:(o?this.children[o-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:l<this.children.length&&0<=l?this.children[l].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.flags|=2),1&e.flags)return;e.flags|=1,t=!1}}setParent(e){this.parent!=e&&(this.parent=e,7&this.flags)&&this.markParentsDirty(!0)}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),(this.dom=e).cmView=this)}get rootView(){for(let e=this;;){var t=e.parent;if(!t)return e;e=t}}replaceChildren(t,r,n=Ht){this.markDirty();for(let e=t;e<r;e++){var a=this.children[e];a.parent==this&&n.indexOf(a)<0&&a.destroy()}this.children.splice(t,r-t,...n);for(let e=0;e<n.length;e++)n[e].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new Gt(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){var e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==e?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,r,n,a,i){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!(8&(this.flags|e.flags))}getSide(){return 0}destroy(){for(var e of this.children)e.parent==this&&e.destroy();this.parent=null}}function he(e){var t=e.nextSibling;return e.parentNode.removeChild(e),t}k.prototype.breakAfter=0;class Gt{constructor(e,t,r){this.children=e,this.pos=t,this.i=r,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(0<t||0==this.i||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;var r=this.children[--this.i];this.pos-=r.length+r.breakAfter}}}function ge(e,t,r,n,a,i,o,s,l){var c=e["children"],u=c.length?c[t]:null,d=i.length?i[i.length-1]:null,f=d?d.breakAfter:o;if(!(t==n&&u&&!o&&!f&&i.length<2&&u.merge(r,a,i.length?d:null,0==r,s,l))){if(n<c.length){let e=c[n];e&&(a<e.length||e.breakAfter&&null!=d&&d.breakAfter)?(t==n&&(e=e.split(a),a=0),!f&&d&&e.merge(0,a,d,!0,0,l)?i[i.length-1]=e:((a||e.children.length&&!e.children[0].length)&&e.merge(0,a,null,!1,0,l),i.push(e))):null!==e&&void 0!==e&&e.breakAfter&&(d?d.breakAfter=1:o=1),n++}for(u&&(u.breakAfter=o,0<r)&&(!o&&i.length&&u.merge(r,u.length,i[0],!1,s,0)?u.breakAfter=i.shift().breakAfter:(r<u.length||u.children.length&&0==u.children[u.children.length-1].length)&&u.merge(r,u.length,null,!1,s,0),t++);t<n&&i.length;)if(c[n-1].become(i[i.length-1]))n--,i.pop(),l=i.length?0:s;else{if(!c[t].become(i[0]))break;t++,i.shift(),s=i.length?0:l}!i.length&&t&&n<c.length&&!c[t-1].breakAfter&&c[n].merge(0,0,c[t-1],!1,s,l)&&t--,(t<n||i.length)&&e.replaceChildren(t,n,i)}}function me(e,t,r,n,a,i){var o,s=e.childCursor(),{i:l,off:c}=s.findPos(r,1),{i:s,off:u}=s.findPos(t,-1);let d=t-r;for(o of n)d+=o.length;e.length+=d,ge(e,s,u,l,c,n,0,a,i)}var _e,b,r="undefined"!=typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},ye="undefined"!=typeof document?document:{documentElement:{style:{}}},Te=/Edge\/(\d+)/.exec(r.userAgent),be=/MSIE \d/.test(r.userAgent),v=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(r.userAgent),E=!!(be||v||Te),ve=!E&&/gecko\/(\d+)/i.test(r.userAgent),Ee=!E&&/Chrome\/(\d+)/.exec(r.userAgent),Se="webkitFontSmoothing"in ye.documentElement.style,Ae=!E&&/Apple Computer/.test(r.vendor),Oe=Ae&&(/Mobile\/\w+/.test(r.userAgent)||2<r.maxTouchPoints),S={mac:Oe||/Mac/.test(r.platform),windows:/Win/.test(r.platform),linux:/Linux|X11/.test(r.platform),ie:E,ie_version:be?ye.documentMode||6:v?+v[1]:Te?+Te[1]:0,gecko:ve,gecko_version:ve?+(/Firefox\/(\d+)/.exec(r.userAgent)||[0,0])[1]:0,chrome:!!Ee,chrome_version:Ee?+Ee[1]:0,ios:Oe,android:/Android\b/.test(r.userAgent),webkit:Se,safari:Ae,webkit_version:Se?+(/\bAppleWebKit\/(\d+)/.exec(r.userAgent)||[0,0])[1]:0,tabSize:null!=ye.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};class w extends k{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){3==e.nodeType&&this.createDOM(e)}merge(e,t,r){return!(8&this.flags||r&&(!(r instanceof w)||256<this.length-(t-e)+r.length||8&r.flags)||(this.text=this.text.slice(0,e)+(r?r.text:"")+this.text.slice(t),this.markDirty(),0))}split(e){var t=new w(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t.flags|=8&this.flags,t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new C(this.dom,e)}domBoundsAround(e,t,r){return{from:r,to:r+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(a,i){{var o=this.dom,s=o.nodeValue.length;let e=a=s<a?s:a,t=a,r=0;if(0==a&&i<0||a==s&&0<=i?S.chrome||S.gecko||(a?(e--,r=1):t<s&&(t++,r=-1)):i<0?e--:t<s&&t++,!(a=T(o,e,t).getClientRects()).length)return null;let n=a[(r?r<0:0<=i)?0:a.length-1];return S.safari&&!r&&0==n.width&&(n=Array.prototype.find.call(a,e=>e.width)||n),r?oe(n,r<0):n||null}}}class R extends k{constructor(e,t=[],r=0){super(),this.mark=e,this.children=t,this.length=r;for(var n of t)n.setParent(this)}setAttrs(e){if(ue(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(var t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!(8&(this.flags|e.flags))}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?4&this.flags&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,r,n,a,i){return!(r&&(!(r instanceof R&&r.mark.eq(this.mark))||e&&a<=0||t<this.length&&i<=0)||(me(this,e,t,r?r.children.slice():[],a-1,i-1),this.markDirty(),0))}split(e){let t=[],r=0,n=-1,a=0;for(var i of this.children){var o=r+i.length;e<o&&t.push(r<e?i.split(e-r):i),n<0&&r>=e&&(n=a),r=o,a++}var s=this.length-e;return this.length=e,-1<n&&(this.children.length=n,this.markDirty()),new R(this.mark,t,s)}domAtPos(e){return Ce(this,e)}coordsAt(e,t){return ke(this,e,t)}}class I extends k{static create(e,t,r){return new I(e,t,r)}constructor(e,t,r){super(),this.widget=e,this.length=t,this.side=r,this.prevWidget=null}split(e){var t=I.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){this.dom&&this.widget.updateDOM(this.dom,e)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable)||(this.dom.contentEditable="false")}getSide(){return this.side}merge(e,t,r,n,a,i){return!(r&&(!(r instanceof I&&this.widget.compare(r.widget))||0<e&&a<=0||t<this.length&&i<=0)||(this.length=e+(r?r.length:0)+(this.length-t),0))}become(e){return e instanceof I&&e.side==this.side&&this.widget.constructor==e.widget.constructor&&(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0)}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(0==this.length)return _.Text.empty;let e=this;for(;e.parent;)e=e.parent;var t=e["view"],t=t&&t.state.doc,r=this.posAtStart;return t?t.slice(r,r+this.length):_.Text.empty}domAtPos(e){return(this.length?0==e:0<this.side)?C.before(this.dom):C.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(t,e){e=this.widget.coordsAt(this.dom,t,e);if(e)return e;let r=this.dom.getClientRects(),n=null;if(!r.length)return null;var a=this.side?this.side<0:0<t;for(let e=a?r.length-1:0;n=r[e],!(0<t?0==e:e==r.length-1||n.top<n.bottom);e+=a?-1:1);return oe(n,!a)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Vt extends k{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof Vt&&e.side==this.side}split(){return new Vt(this.side)}sync(){var e;this.dom||((e=document.createElement("img")).className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e))}getSide(){return this.side}domAtPos(e){return 0<this.side?C.before(this.dom):C.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return _.Text.empty}get isHidden(){return!0}}function Ce(e,t){let r=e.dom,n=e["children"],a=0;for(let e=0;a<n.length;a++){var i=n[a],o=e+i.length;if(!(o==e&&i.getSide()<=0)){if(t>e&&t<o&&i.dom.parentNode==r)return i.domAtPos(t-e);if(t<=e)break;e=o}}for(let e=a;0<e;e--){var s=n[e-1];if(s.dom.parentNode==r)return s.domAtPos(s.length)}for(let e=a;e<n.length;e++){var l=n[e];if(l.dom.parentNode==r)return l.domAtPos(0)}return new C(r,0)}function ke(e,t,s){let l=null,c=-1,u=null,d=-1;!function r(n,a){for(let e=0,t=0;e<n.children.length&&t<=a;e++){var i=n.children[e],o=t+i.length;a<=o&&(i.children.length?r(i,a-t):(!u||u.isHidden&&0<s)&&(a<o||t==o&&0<i.getSide())?(u=i,d=a-t):(t<a||t==o&&i.getSide()<0&&!i.isHidden)&&(l=i,c=a-t)),t=o}}(e,t);var t=(s<0?l:u)||l||u;return t?t.coordsAt(Math.max(0,t==l?c:d),s):(e=(t=e).dom.lastChild)?(t=re(e))[t.length-1]||null:t.dom.getBoundingClientRect()}function we(e,t){for(var r in e)"class"==r&&t.class?t.class+=" "+e.class:"style"==r&&t.style?t.style+=";"+e.style:t[r]=e[r];return t}w.prototype.children=I.prototype.children=Vt.prototype.children=Ht;const Wt=Object.create(null);function Re(e,t,r){if(e!=t){e=e||Wt,t=t||Wt;var n,a=Object.keys(e),i=Object.keys(t);if(a.length-(r&&-1<a.indexOf(r)?1:0)!=i.length-(r&&-1<i.indexOf(r)?1:0))return!1;for(n of a)if(n!=r&&(-1==i.indexOf(n)||e[n]!==t[n]))return!1}return!0}function Ie(e,t,r){let n=!1;if(t)for(var a in t)r&&a in r||(n=!0,"style"==a?e.style.cssText="":e.removeAttribute(a));if(r)for(var i in r)t&&t[i]==r[i]||(n=!0,"style"==i?e.style.cssText=r[i]:e.setAttribute(i,r[i]));return n}class M extends k{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,r,n,a,i){if(r){if(!(r instanceof M))return!1;this.dom||r.transferDOM(this)}return n&&this.setDeco(r?r.attrs:null),me(this,e,t,r?r.children.slice():[],a,i),!0}split(r){var n=new M;if(n.breakAfter=this.breakAfter,0!=this.length){let{i:t,off:e}=this.childPos(r);e&&(n.append(this.children[t].split(e),0),this.children[t].merge(e,this.children[t].length,null,!1,0,0),t++);for(let e=t;e<this.children.length;e++)n.append(this.children[e],0);for(;0<t&&0==this.children[t-1].length;)this.children[--t].destroy();this.children.length=t,this.markDirty(),this.length=r}return n}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){Re(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){!function e(t,r,n){let a,i=t.children;0<n&&r instanceof R&&i.length&&(a=i[i.length-1])instanceof R&&a.mark.eq(r.mark)?e(a,r.children[0],n-1):(i.push(r),r.setParent(t)),t.length+=r.length}(this,e,t)}addLineDeco(e){var t=e.spec.attributes,e=e.spec.class;t&&(this.attrs=we(t,this.attrs||{})),e&&(this.attrs=we({class:e},this.attrs||{}))}domAtPos(e){return Ce(this,e)}reuseDOM(e){"DIV"==e.nodeName&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?4&this.flags&&(ue(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(Ie(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let r=this.dom.lastChild;for(;r&&k.get(r)instanceof R;)r=r.lastChild;r&&this.length&&("BR"==r.nodeName||0!=(null==(e=k.get(r))?void 0:e.isEditable)||S.ios&&this.children.some(e=>e instanceof w))||((t=document.createElement("BR")).cmIgnore=!0,this.dom.appendChild(t))}measureTextSize(){if(0==this.children.length||20<this.length)return null;let e=0,t;for(var r of this.children){if(!(r instanceof w)||/[^ -~]/.test(r.text))return null;r=re(r.dom);if(1!=r.length)return null;e+=r[0].width,t=r[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){e=ke(this,e,t);if(!this.children.length&&e&&this.parent){var t=this.parent.view.viewState["heightOracle"],r=e.bottom-e.top;if(Math.abs(r-t.lineHeight)<2&&t.textHeight<r)return r=(r-t.textHeight)/2,{top:e.top+r,bottom:e.bottom-r,left:e.left,right:e.left}}return e}become(e){return e instanceof M&&0==this.children.length&&0==e.children.length&&Re(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(r,n){for(let e=0,t=0;e<r.children.length;e++){var a=r.children[e],i=t+a.length;if(n<=i){if(a instanceof M)return a;if(n<i)break}t=i+a.breakAfter}return null}}class P extends k{constructor(e,t,r){super(),this.widget=e,this.length=t,this.deco=r,this.breakAfter=0,this.prevWidget=null}merge(e,t,r,n,a,i){return!(r&&(!(r instanceof P&&this.widget.compare(r.widget))||0<e&&a<=0||t<this.length&&i<=0)||(this.length=e+(r?r.length:0)+(this.length-t),0))}domAtPos(e){return 0==e?C.before(this.dom):C.after(this.dom,e==this.length)}split(e){var t=this.length-e,e=(this.length=e,new P(this.widget,t,this.deco));return e.breakAfter=this.breakAfter,e}get children(){return Ht}sync(e){this.dom&&this.widget.updateDOM(this.dom,e)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable)||(this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):_.Text.empty}domBoundsAround(){return null}become(e){return e instanceof P&&e.widget.constructor==this.widget.constructor&&(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0)}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){return this.widget.coordsAt(this.dom,e,t)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){var{startSide:t,endSide:r}=this.deco;return t!=r&&(e<0?t<0:0<r)}}class N{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,r){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}O.BlockType=void 0,(E=O.BlockType||(O.BlockType={}))[E.Text=0]="Text",E[E.WidgetBefore=1]="WidgetBefore",E[E.WidgetAfter=2]="WidgetAfter",E[E.WidgetRange=3]="WidgetRange";class D extends _.RangeValue{constructor(e,t,r,n){super(),this.startSide=e,this.endSide=t,this.widget=r,this.spec=n}get heightRelevant(){return!1}static mark(e){return new qt(e)}static widget(e){var t=Math.max(-1e4,Math.min(1e4,e.side||0)),r=!!e.block;return t+=r&&!e.inlineOrder?0<t?3e8:-4e8:0<t?1e8:-1e8,new x(e,t,t,r,e.widget||null,!1)}static replace(e){let t=!!e.block,r,n;var a,i;return n=e.isBlockGap?(r=-5e8,4e8):({start:a,end:i}=Me(e,t),r=(a?t?-3e8:-1:5e8)-1,1+(i?t?2e8:1:-6e8)),new x(e,r,n,t,e.widget||null,!0)}static line(e){return new $t(e)}static set(e,t=!1){return _.RangeSet.of(e,t)}hasHeight(){return!!this.widget&&-1<this.widget.estimatedHeight}}D.none=_.RangeSet.empty;class qt extends D{constructor(e){var{start:t,end:r}=Me(e);super(t?-1:5e8,r?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var t;return this==e||e instanceof qt&&this.tagName==e.tagName&&(this.class||(null==(t=this.attrs)?void 0:t.class))==(e.class||(null==(t=e.attrs)?void 0:t.class))&&Re(this.attrs,e.attrs,"class")}range(e,t=e){if(t<=e)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}qt.prototype.point=!1;class $t extends D{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof $t&&this.spec.class==e.spec.class&&Re(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}$t.prototype.mapMode=_.MapMode.TrackBefore,$t.prototype.point=!0;class x extends D{constructor(e,t,r,n,a,i){super(t,r,a,e),this.block=n,this.isReplace=i,this.mapMode=n?t<=0?_.MapMode.TrackBefore:_.MapMode.TrackAfter:_.MapMode.TrackDel}get type(){return this.startSide!=this.endSide?O.BlockType.WidgetRange:this.startSide<=0?O.BlockType.WidgetBefore:O.BlockType.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(5<=this.widget.estimatedHeight||0<this.widget.lineBreaks)}eq(e){return e instanceof x&&(t=this.widget,r=e.widget,t==r||!!(t&&r&&t.compare(r)))&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide;var t,r}range(e,t=e){if(this.isReplace&&(t<e||e==t&&0<this.startSide&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(this.isReplace||t==e)return super.range(e,t);throw new RangeError("Widget decorations can only have zero-length ranges")}}function Me(e,t=!1){let{inclusiveStart:r,inclusiveEnd:n}=e;return null==r&&(r=e.inclusive),null==n&&(n=e.inclusive),{start:null!==r&&void 0!==r?r:t,end:null!==n&&void 0!==n?n:t}}function Pe(e,t,r,n=0){var a=r.length-1;0<=a&&r[a]+n>=e?r[a]=Math.max(r[a],t):r.push(e,t)}x.prototype.point=!0;class zt{constructor(e,t,r,n){this.doc=e,this.pos=t,this.end=r,this.disallowBlockEffectsFor=n,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){var e;return 0==this.content.length?!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos:!((e=this.content[this.content.length-1]).breakAfter||e instanceof P&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new M),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(Ne(new Vt(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||e&&this.content.length&&this.content[this.content.length-1]instanceof P||this.getLine()}buildText(e,t,r){for(;0<e;){if(this.textOff==this.text.length){var{value:n,lineBreak:a,done:i}=this.cursor.next(this.skip);if(this.skip=0,i)throw new Error("Ran out of text content when drawing inline views");if(a){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}this.text=n,this.textOff=0}i=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(t.length-r)),this.getLine().append(Ne(new w(this.text.slice(this.textOff,this.textOff+i)),t),r),this.atCursorPos=!0,this.textOff+=i,e-=i,r=0}}span(e,t,r,n){this.buildText(t-e,r,n),this.pos=t,this.openStart<0&&(this.openStart=n)}point(e,t,r,n,a,i){if(this.disallowBlockEffectsFor[i]&&r instanceof x){if(r.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}var o,s,l,c,i=t-e;r instanceof x?r.block?(0<r.startSide&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new P(r.widget||Kt.block,i,r))):(o=I.create(r.widget||Kt.inline,i,i?0:r.startSide),s=this.atCursorPos&&!o.isEditable&&a<=n.length&&(e<t||0<r.startSide),l=!o.isEditable&&(e<t||a>n.length||r.startSide<=0),c=this.getLine(),2!=this.pendingBuffer||s||o.isEditable||(this.pendingBuffer=0),this.flushBuffer(n),s&&(c.append(Ne(new Vt(1),n),a),a=n.length+Math.max(0,a-n.length)),c.append(Ne(o,n),a),this.atCursorPos=l,this.pendingBuffer=l?e<t||a>n.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=n.slice())):this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(r),i&&(this.textOff+i<=this.text.length?this.textOff+=i:(this.skip+=i-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=a)}static build(e,t,r,n,a){e=new zt(e,t,r,a);return e.openEnd=_.RangeSet.spans(n,t,r,e),e.openStart<0&&(e.openStart=e.openEnd),e.finish(e.openEnd),e}}function Ne(e,t){for(var r of t)e=new R(r,[e],e.length);return e}class Kt extends N{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}Kt.inline=new Kt("span"),Kt.block=new Kt("div"),O.Direction=void 0,(be=O.Direction||(O.Direction={}))[be.LTR=0]="LTR",be[be.RTL=1]="RTL";const L=O.Direction.LTR,Yt=O.Direction.RTL;function De(t){var r=[];for(let e=0;e<t.length;e++)r.push(1<<+t[e]);return r}const Jt=De("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),Zt=De("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Qt=Object.create(null),F=[];for(_e of["()","[]","{}"]){var xe=_e.charCodeAt(0),Le=_e.charCodeAt(1);Qt[xe]=Le,Qt[Le]=-xe}function Fe(e){return e<=247?Jt[e]:1424<=e&&e<=1524?2:1536<=e&&e<=1785?Zt[e-1536]:1774<=e&&e<=2220?4:8192<=e&&e<=8204?256:64336<=e&&e<=65023?4:1}const Xt=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class U{get dir(){return this.level%2?Yt:L}constructor(e,t,r){this.from=e,this.to=t,this.level=r}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(t,r,n,a){let i=-1;for(let e=0;e<t.length;e++){var o=t[e];if(o.from<=r&&o.to>=r){if(o.level==n)return e;(i<0||(0!=a?a<0?o.from<r:o.to>r:t[i].level>o.level))&&(i=e)}}if(i<0)throw new RangeError("Index out of range");return i}}const B=[];function Ue(e,t,r,n,a,i,o){var s=t%2?2:1,l=e,c=a,u=i,d=n,f=s;for(let e=0;e<=d.length;e++){var p=e?d[e-1].to:c,h=e<d.length?d[e].from:u,g=e?256:f;for(let t=p,r=g,n=g;t<h;t++){let e=Fe(l.charCodeAt(t));512==e?e=r:8==e&&4==n&&(e=16),B[t]=4==e?2:e,7&e&&(n=e),r=e}for(let r=p,n=g,a=g;r<h;r++){let e=B[r];if(128==e)r<h-1&&n==B[r+1]&&24&n?e=B[r]=n:B[r]=256;else if(64==e){let t=r+1;for(;t<h&&64==B[t];)t++;var m=r&&8==n||t<u&&8==B[t]?1==a?1:8:256;for(let e=r;e<t;e++)B[e]=m;r=t-1}else 8==e&&1==a&&(B[r]=1);7&(n=e)&&(a=e)}}var _=e,y=a,T=i,b=n,v=s,E=1==v?2:1;for(let e=0,a=0,i=0;e<=b.length;e++){var S=e?b[e-1].to:y,A=e<b.length?b[e].from:T;for(let t=S,e,r,n;t<A;t++)if(r=Qt[e=_.charCodeAt(t)])if(r<0){for(let e=a-3;0<=e;e-=3)if(F[e+1]==-r){var O=F[e+2],O=2&O?v:4&O?1&O?E:v:0;O&&(B[t]=B[F[e]]=O),a=e;break}}else{if(189==F.length)break;F[a++]=t,F[a++]=e,F[a++]=i}else if(2==(n=B[t])||1==n){var C=n==v;i=C?0:1;for(let e=a-3;0<=e;e-=3){var k=F[e+2];if(2&k)break;if(C)F[e+2]|=2;else{if(4&k)break;F[e+2]|=4}}}}var w=a,R=i,I=n,M=s;for(let i=0,r=M;i<=I.length;i++){let e=i?I[i-1].to:w,t=i<I.length?I[i].from:R;for(let a=e;a<t;){var P=B[a];if(256==P){let n=a+1;for(;;)if(n==t){if(i==I.length)break;n=I[i++].to,t=i<I.length?I[i].from:R}else{if(256!=B[n])break;n++}var N=1==r,D=N==(1==(n<R?B[n]:M))?N?1:2:M;for(let e=n,t=i,r=t?I[t-1].to:w;e>a;)e==r&&(e=I[--t].from,r=t?I[t-1].to:w),B[--e]=D;a=n}else r=P,a++}}!function i(o,s,l,c,u,d,f){var p=c%2?2:1;if(c%2==u%2)for(let n=s,a=0;n<l;){let e=!0,t=!1;(a==d.length||n<d[a].from)&&(h=B[n])!=p&&(e=!1,t=16==h);var h,g=e||1!=p?null:[],m=e?c:c+1;let r=n;e:for(;;)if(a<d.length&&r==d[a].from){if(t)break;var _=d[a];if(!e)for(let e=_.to,t=a+1;;){if(e==l)break e;if(!(t<d.length&&d[t].from==e)){if(B[e]==p)break e;break}e=d[t++].to}a++,g?g.push(_):(_.from>n&&f.push(new U(n,_.from,m)),Ue(o,_.direction==L!=!(m%2)?c+1:c,u,_.inner,_.from,_.to,f),n=_.to),r=_.to}else{if(r==l||(e?B[r]!=p:B[r]==p))break;r++}g?i(o,n,r,c+1,u,g,f):n<r&&f.push(new U(n,r,m)),n=r}else for(let n=l,a=d.length;n>s;){let e=!0,t=!1;(!a||n>d[a-1].to)&&(y=B[n-1])!=p&&(e=!1,t=16==y);var y,T=e||1!=p?null:[],b=e?c:c+1;let r=n;e:for(;;)if(a&&r==d[a-1].to){if(t)break;var v=d[--a];if(!e)for(let e=v.from,t=a;;){if(e==s)break e;if(!t||d[t-1].to!=e){if(B[e-1]==p)break e;break}e=d[--t].from}T?T.push(v):(v.to<n&&f.push(new U(v.to,n,b)),Ue(o,v.direction==L!=!(b%2)?c+1:c,u,v.inner,v.from,v.to,f),n=v.from),r=v.from}else{if(r==s||(e?B[r-1]!=p:B[r-1]==p))break;r--}T?i(o,r,n,c+1,u,T,f):r<n&&f.push(new U(r,n,b)),n=r}}(e,a,i,t,r,n,o)}function Be(e,t,r){if(!e)return[new U(0,0,t==Yt?1:0)];if(t==L&&!r.length&&!Xt.test(e))return je(e.length);if(r.length)for(;e.length>B.length;)B[B.length]=256;var n=[],t=t==L?0:1;return Ue(e,t,t,r,0,e.length,n),n}function je(e){return[new U(0,e,0)]}let d="";function He(e,t,r,n,a){let i=n.head-e.from,o=U.find(t,i,null!=(c=n.bidiLevel)?c:-1,n.assoc),s=t[o],l=s.side(a,r);if(i==l){var c=o+=a?1:-1;if(c<0||c>=t.length)return null;s=t[o=c],i=s.side(!a,r),l=s.side(a,r)}let u=_.findClusterBreak(e.text,i,s.forward(a,r));(u<s.from||u>s.to)&&(u=l),d=e.text.slice(Math.min(i,u),Math.max(i,u));n=o==(a?t.length-1:0)?null:t[o+(a?1:-1)];return n&&u==l&&n.level+(a?0:1)<s.level?_.EditorSelection.cursor(n.side(!a,r)+e.from,n.forward(a,r)?1:-1,n.level):_.EditorSelection.cursor(u+e.from,s.forward(a,r)?-1:1,s.level)}const er=_.Facet.define(),tr=_.Facet.define(),rr=_.Facet.define(),nr=_.Facet.define(),ar=_.Facet.define(),ir=_.Facet.define(),or=_.Facet.define(),sr=_.Facet.define({combine:e=>e.some(e=>e)}),lr=_.Facet.define({combine:e=>e.some(e=>e)}),cr=_.Facet.define();class ur{constructor(e,t="nearest",r="nearest",n=5,a=5,i=!1){this.range=e,this.y=t,this.x=r,this.yMargin=n,this.xMargin=a,this.isSnapshot=i}map(e){return e.empty?this:new ur(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new ur(_.EditorSelection.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const dr=_.StateEffect.define({map:(e,t)=>e.map(t)}),fr=_.StateEffect.define();function A(e,t,r){e=e.facet(nr);e.length?e[0](t):window.onerror?window.onerror(String(t),r,void 0,void 0,t):r?console.error(r+":",t):console.error(t)}const j=_.Facet.define({combine:e=>!e.length||e[0]});let o=0;const pr=_.Facet.define();class H{constructor(e,t,r,n,a){this.id=e,this.create=t,this.domEventHandlers=r,this.domEventObservers=n,this.extension=a(this)}static define(e,t){const{eventHandlers:r,eventObservers:n,provide:a,decorations:i}=t||{};return new H(o++,e,r,n,t=>{var e=[pr.of(t)];return i&&e.push(_r.of(e=>{e=e.plugin(t);return e?i(e):D.none})),a&&e.push(a(t)),e})}static fromClass(t,e){return H.define(e=>new t(e),e)}}class hr{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(t){if(this.value){if(this.mustUpdate){var r=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(r)}catch(e){if(A(r.state,e,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(e){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(t)}catch(e){A(t.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var e;if(null!=(e=this.value)&&e.destroy)try{this.value.destroy()}catch(e){A(t.state,e,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const gr=_.Facet.define(),mr=_.Facet.define(),_r=_.Facet.define(),yr=_.Facet.define(),Tr=_.Facet.define(),br=_.Facet.define();function Ge(t,c){var e=t.state.facet(br);if(!e.length)return e;e=e.map(e=>e instanceof Function?e(t):e);let r=[];return _.RangeSet.spans(e,c.from,c.to,{point(){},span(e,t,n,a){var i,o=e-c.from,s=t-c.from;let l=r;for(let r=n.length-1;0<=r;r--,a--){let e=n[r].spec.bidiIsolate,t;null==e&&(e=function(t,r,n){for(let e=r;e<n;e++){var a=Fe(t.charCodeAt(e));if(1==a)return L;if(2==a||4==a)return Yt}return L}(c.text,o,s)),l=(0<a&&l.length&&(t=l[l.length-1]).to==o&&t.direction==e?(t.to=s,t):(i={from:o,to:s,direction:e,inner:[]},l.push(i),i)).inner}}}),r}const vr=_.Facet.define();function Ve(e){let t=0,r=0,n=0,a=0;for(var i of e.state.facet(vr)){i=i(e);i&&(null!=i.left&&(t=Math.max(t,i.left)),null!=i.right&&(r=Math.max(r,i.right)),null!=i.top&&(n=Math.max(n,i.top)),null!=i.bottom)&&(a=Math.max(a,i.bottom))}return{left:t,right:r,top:n,bottom:a}}const Er=_.Facet.define();class G{constructor(e,t,r,n){this.fromA=e,this.toA=t,this.fromB=r,this.toB=n}join(e){return new G(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,r=this;for(;0<t;t--){var n=e[t-1];if(!(n.fromA>r.toA)){if(n.toA<r.fromA)break;r=r.join(n),e.splice(t-1,1)}}return e.splice(t,0,r),e}static extendWithRanges(a,i){if(0==i.length)return a;var o=[];for(let e=0,t=0,r=0,n=0;;e++){for(var s=e==a.length?null:a[e],l=r-n,c=s?s.fromB:1e9;t<i.length&&i[t]<c;){var u=i[t],d=i[t+1],u=Math.max(n,u),f=Math.min(c,d);if(u<=f&&new G(u+l,f+l,u,f).addToSet(o),c<d)break;t+=2}if(!s)return o;new G(s.fromA,s.toA,s.fromB,s.toB).addToSet(o),r=s.toA,n=s.toB}}}class Sr{constructor(e,t,r){this.view=e,this.state=t,this.transactions=r,this.flags=0,this.startState=e.state,this.changes=_.ChangeSet.empty(this.startState.doc.length);for(var n of r)this.changes=this.changes.compose(n.changes);let a=[];this.changes.iterChangedRanges((e,t,r,n)=>a.push(new G(e,t,r,n))),this.changedRanges=a}static create(e,t,r){return new Sr(e,t,r)}get viewportChanged(){return 0<(4&this.flags)}get heightChanged(){return 0<(2&this.flags)}get geometryChanged(){return this.docChanged||0<(10&this.flags)}get focusChanged(){return 0<(1&this.flags)}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return 0==this.flags&&0==this.transactions.length}}class Ar extends k{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=D.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new M],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new G(0,0,0,e.state.doc.length)],0,null)}update(e){let t=e.changedRanges,r=(0<this.minWidth&&t.length&&(t.every(({fromA:e,toA:t})=>t<this.minWidthFrom||e>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e),-1);0<=this.view.inputState.composing&&!this.view.observer.editContext&&(null!=(a=this.domChanged)&&a.newSel?r=this.domChanged.newSel.head:function(e,r){let n=!1;r&&e.iterChangedRanges((e,t)=>{e<r.to&&t>r.from&&(n=!0)});return n}(e.changes,this.hasComposition)||e.selectionSet||(r=e.state.selection.main.head));var n,a=-1<r?function(t,e,r){r=We(t,r);if(!r)return null;var{node:n,from:a,to:i}=r,o=n.nodeValue;if(/[\n\r]/.test(o))return null;if(t.state.doc.sliceString(r.from,r.to)!=o)return null;var r=e.invertedDesc,s=new G(r.mapPos(a),r.mapPos(i),a,i),l=[];for(let e=n.parentNode;;e=e.parentNode){var c=k.get(e);if(c instanceof R)l.push({node:e,deco:c.mark});else{if(c instanceof M||"DIV"==e.nodeName&&e.parentNode==t.contentDOM)return{range:s,text:n,marks:l,line:e};if(e==t.contentDOM)return null;l.push({node:e,deco:new qt({inclusive:!0,attributes:function(t){var r=Object.create(null);for(let e=0;e<t.attributes.length;e++){var n=t.attributes[e];r[n.name]=n.value}return r}(e),tagName:e.tagName.toLowerCase()})})}}}(this.view,e.changes,r):null,i=(this.domChanged=null,this.hasComposition&&(this.markedForComposition.clear(),{from:i,to:o}=this.hasComposition,t=new G(i,o,e.changes.mapPos(i,-1),e.changes.mapPos(o,1)).addToSet(t.slice())),this.hasComposition=a?{from:a.range.fromB,to:a.range.toB}:null,(S.ie||S.chrome)&&!a&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0),this.decorations),o=this.updateDeco(),s=(i=i,o=o,s=e.changes,n=new l,_.RangeSet.compare(i,o,s,n),n.changes);return t=G.extendWithRanges(t,s),!!(7&this.flags||0!=t.length)&&(this.updateInner(t,e.startState.doc.length,a),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,r){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,r);let n=this.view["observer"];n.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";var e=S.chrome||S.ios?{node:n.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,e),this.flags&=-8,e&&(e.written||n.selectionRange.focusNode!=e.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(e=>e.flags&=-9);var a=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(var i of this.children)i instanceof P&&i.widget instanceof Or&&a.push(i.dom);n.updateGaps(a)}updateChildren(e,t,c){var u=c?c.range.addToSet(e.slice()):e,d=this.childCursor(t);for(let l=u.length-1;;l--){var f=0<=l?u[l]:null;if(!f)break;let{fromA:e,toA:t,fromB:r,toB:n}=f,a,i,o,s;c&&c.range.fromB<n&&c.range.toB>r?(f=zt.build(this.view.state.doc,r,c.range.fromB,this.decorations,this.dynamicDecorationMap),h=zt.build(this.view.state.doc,c.range.toB,n,this.decorations,this.dynamicDecorationMap),i=f.breakAtStart,o=f.openStart,s=h.openEnd,p=this.compositionView(c),h.breakAtStart?p.breakAfter=1:h.content.length&&p.merge(p.length,p.length,h.content[0],!1,h.openStart,0)&&(p.breakAfter=h.content[0].breakAfter,h.content.shift()),f.content.length&&p.merge(0,0,f.content[f.content.length-1],!0,0,f.openEnd)&&f.content.pop(),a=f.content.concat(p).concat(h.content)):{content:a,breakAtStart:i,openStart:o,openEnd:s}=zt.build(this.view.state.doc,r,n,this.decorations,this.dynamicDecorationMap);var{i:f,off:p}=d.findPos(t,1),{i:h,off:g}=d.findPos(e,-1);ge(this,h,g,f,p,a,i,o,s)}c&&this.fixCompositionDOM(c)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(var t of e.transactions)for(var r of t.effects)r.is(fr)&&(this.editContextFormatting=r.value)}compositionView(e){let t=new w(e.text.nodeValue);t.flags|=8;for(var{deco:r}of e.marks)t=new R(r,[t],t.length);e=new M;return e.append(t,0),e}fixCompositionDOM(t){var r=(e,t)=>{t.flags|=8|(t.children.some(e=>7&e.flags)?1:0),this.markedForComposition.add(t);var r=k.get(e);r&&r!=t&&(r.dom=null),t.setDOM(e)};let n=this.childPos(t.range.fromB,1),a=this.children[n.i];r(t.line,a);for(let e=t.marks.length-1;-1<=e;e--)n=a.childPos(n.off,1),a=a.children[n.i],r(0<=e?t.marks[e].node:t.text,a)}updateSelection(e=!1,t=!1){!e&&this.view.observer.selectionRange.focusNode||this.view.observer.readSelectionRange();let s=this.view.root.activeElement,r=s==this.dom,l=!r&&te(this.dom,this.view.observer.selectionRange)&&!(s&&this.dom.contains(s));if(r||t||l){let t=this.forceSelection,n=(this.forceSelection=!1,this.view.state.selection.main),a=this.moveToLine(this.domAtPos(n.anchor)),i=n.empty?a:this.moveToLine(this.domAtPos(n.head));if(S.gecko&&n.empty&&!this.hasComposition&&1==(e=a).node.nodeType&&e.node.firstChild&&(0==e.offset||"false"==e.node.childNodes[e.offset-1].contentEditable)&&(e.offset==e.node.childNodes.length||"false"==e.node.childNodes[e.offset].contentEditable)){let e=document.createTextNode("");this.view.observer.ignore(()=>a.node.insertBefore(e,a.node.childNodes[a.offset]||null)),a=i=new C(e,0),t=!0}let o=this.view.observer.selectionRange;!t&&o.focusNode&&(ne(a.node,a.offset,o.anchorNode,o.anchorOffset)&&ne(i.node,i.offset,o.focusNode,o.focusOffset)||this.suppressWidgetCursorChange(o,n))||(this.view.observer.ignore(()=>{S.android&&S.chrome&&this.dom.contains(o.focusNode)&&function(t,r){for(let e=t;e&&e!=r;e=e.assignedSlot||e.parentNode)if(1==e.nodeType&&"false"==e.contentEditable)return 1;return}(o.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));var e,t=X(this.view.root);if(t)if(n.empty)S.gecko&&(r=a.node,e=a.offset,r=1!=r.nodeType?0:(e&&"false"==r.childNodes[e-1].contentEditable?1:0)|(e<r.childNodes.length&&"false"==r.childNodes[e].contentEditable?2:0))&&3!=r&&(e=(1==r?fe:pe)(a.node,a.offset))&&(a=new C(e.node,e.offset)),t.collapse(a.node,a.offset),null!=n.bidiLevel&&void 0!==t.caretBidiLevel&&(t.caretBidiLevel=n.bidiLevel);else if(t.extend){t.collapse(a.node,a.offset);try{t.extend(i.node,i.offset)}catch(e){}}else{var r=document.createRange();n.anchor>n.head&&([a,i]=[i,a]),r.setEnd(i.node,i.offset),r.setStart(a.node,a.offset),t.removeAllRanges(),t.addRange(r)}l&&this.view.root.activeElement==this.dom&&(this.dom.blur(),s)&&s.focus()}),this.view.observer.setSelectionRange(a,i)),this.impreciseAnchor=a.precise?null:new C(o.anchorNode,o.anchorOffset),this.impreciseHead=i.precise?null:new C(o.focusNode,o.focusOffset)}}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&ne(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){var e,t,r,n,a,i,o;this.hasComposition||(e=this["view"],t=e.state.selection.main,r=X(e.root),{anchorNode:n,anchorOffset:a}=e.observer.selectionRange,r&&t.empty&&t.assoc&&r.modify&&(o=M.find(this,t.head))&&(i=o.posAtStart,t.head==i||t.head==i+o.length||(i=this.coordsAt(t.head,-1),o=this.coordsAt(t.head,1),!i)||!o||i.bottom>o.top||(i=this.domAtPos(t.head+t.assoc),r.collapse(i.node,i.offset),r.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange(),o=e.observer.selectionRange,e.docView.posFromDOM(o.anchorNode,o.anchorOffset)!=t.from&&r.collapse(n,a))))}moveToLine(t){let r=this.dom,n;if(t.node!=r)return t;for(let e=t.offset;!n&&e<r.childNodes.length;e++){var a=k.get(r.childNodes[e]);a instanceof M&&(n=a.domAtPos(0))}for(let e=t.offset-1;!n&&0<=e;e--){var i=k.get(r.childNodes[e]);i instanceof M&&(n=i.domAtPos(i.length))}return n?new C(n.node,n.offset,!0):t}nearest(t){for(let e=t;e;){var r=k.get(e);if(r&&r.rootView==this)return r;e=e.parentNode}return null}posFromDOM(e,t){var r=this.nearest(e);if(r)return r.localPosFromDOM(e,t)+r.posAtStart;throw new RangeError("Trying to find position for a DOM position outside of the document")}domAtPos(e){let{i:t,off:r}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){var n=this.children[t];if(r<n.length||n instanceof M)break;t++,r=0}return this.children[t].domAtPos(r)}coordsAt(r,n){let a=null,i=0;for(let e=this.length,t=this.children.length-1;0<=t;t--){var o=this.children[t],s=e-o.breakAfter,l=s-o.length;if(s<r)break;if(l<=r&&(l<r||o.covers(-1))&&(r<s||o.covers(1))&&(!a||o instanceof M&&!(a instanceof M&&0<=n)))a=o,i=l;else if(a&&l==r&&s==r&&o instanceof P&&Math.abs(n)<2){if(o.deco.startSide<0)break;t&&(a=null)}e=l}return a?a.coordsAt(r-i,n):null}coordsForChar(e){let{i:t,off:r}=this.childPos(e,1),n=this.children[t];if(n instanceof M){for(;n.children.length;){let{i:e,off:t}=n.childPos(r,1);for(;;e++){if(e==n.children.length)return null;if((n=n.children[e]).length)break}r=t}if(n instanceof w){e=_.findClusterBreak(n.text,r);if(e!=r){var a=T(n.dom,r,e).getClientRects();for(let e=0;e<a.length;e++){var i=a[e];if(e==a.length-1||i.top<i.bottom&&i.left<i.right)return i}}}}return null}measureVisibleLineHeights(e){var r=[],{from:n,to:a}=e,i=this.view.contentDOM.clientWidth,o=i>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1;let s=-1,l=this.view.textDirection==O.Direction.LTR;for(let e=0,t=0;t<this.children.length;t++){var c,u,d=this.children[t],f=e+d.length;if(a<f)break;e>=n&&(u=d.dom.getBoundingClientRect(),r.push(u.height),o)&&(c=(c=d.dom.lastChild)?re(c):[]).length&&(c=c[c.length-1],(u=l?c.right-u.left:u.right-c.left)>s)&&(s=u,this.minWidth=i,this.minWidthFrom=e,this.minWidthTo=f),e=f+d.breakAfter}return r}textDirectionAt(e){e=this.childPos(e,1).i;return"rtl"==getComputedStyle(this.children[e].dom).direction?O.Direction.RTL:O.Direction.LTR}measureTextSize(){for(var e of this.children)if(e instanceof M){e=e.measureTextSize();if(e)return e}let t=document.createElement("div"),r,n,a;return t.className="cm-line",t.style.width="99999px",t.style.position="absolute",t.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(t);var e=re(t.firstChild)[0];r=t.getBoundingClientRect().height,n=e?e.width/27:7,a=e?e.height:r,t.remove()}),{lineHeight:r,charWidth:n,textHeight:a}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new Gt(this.children,e,t)}computeBlockGapDeco(){var r=[],n=this.view.viewState;for(let e=0,t=0;;t++){var a,i=t==n.viewports.length?null:n.viewports[t],o=i?i.from-1:this.length;if(o>e&&(a=(n.lineBlockAt(o).bottom-n.lineBlockAt(e).top)/this.view.scaleY,r.push(D.replace({widget:new Or(a),block:!0,inclusive:!0,isBlockGap:!0}).range(e,o))),!i)break;e=i.to+1}return D.set(r)}updateDeco(){let t=1;var e=this.view.state.facet(_r).map(e=>{return(this.dynamicDecorationMap[t++]="function"==typeof e)?e(this.view):e});let n=!1,r=this.view.state.facet(yr).map((e,t)=>{var r="function"==typeof e;return r&&(n=!0),r?e(this.view):e});for(r.length&&(this.dynamicDecorationMap[t++]=n,e.push(_.RangeSet.join(r))),this.decorations=[this.editContextFormatting,...e,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];t<this.decorations.length;)this.dynamicDecorationMap[t++]=!1;return this.decorations}scrollIntoView(r){if(r.isSnapshot)a=this.view.viewState.lineBlockAt(r.range.head),this.view.scrollDOM.scrollTop=a.top-r.yMargin,this.view.scrollDOM.scrollLeft=r.xMargin;else{for(var n of this.view.state.facet(cr))try{if(n(this.view,r.range,r))return!0}catch(e){A(this.view.state,e,"scroll handler")}var a=r["range"];let e=this.coordsAt(a.head,a.empty?a.assoc:a.head>a.anchor?-1:1),t;if(e){!a.empty&&(t=this.coordsAt(a.anchor,a.anchor>a.head?-1:1))&&(e={left:Math.min(e.left,t.left),top:Math.min(e.top,t.top),right:Math.max(e.right,t.right),bottom:Math.max(e.bottom,t.bottom)});var l,c,u,i=Ve(this.view),i={left:e.left-i.left,top:e.top-i.top,right:e.right+i.right,bottom:e.bottom+i.bottom},{offsetWidth:o,offsetHeight:s}=this.view.scrollDOM,d=this.view.scrollDOM,f=i,p=a.head<a.anchor?-1:1,h=r.x,g=r.y,m=Math.max(Math.min(r.xMargin,o),-o),_=Math.max(Math.min(r.yMargin,s),-s),y=this.view.textDirection==O.Direction.LTR,T=d.ownerDocument,b=T.defaultView||window;for(let o=d,s=!1;o&&!s;)if(1==o.nodeType){let e,t=o==T.body,r=1,n=1;if(t)e=(v=void 0,(v=(u=b).visualViewport)?{left:0,right:v.width,top:0,bottom:v.height}:{left:0,right:u.innerWidth,top:0,bottom:u.innerHeight});else{if(/^(fixed|sticky)$/.test(getComputedStyle(o).position)&&(s=!0),o.scrollHeight<=o.clientHeight&&o.scrollWidth<=o.clientWidth){o=o.assignedSlot||o.parentNode;continue}var v=o.getBoundingClientRect();({scaleX:r,scaleY:n}=se(o,v)),e={left:v.left,right:v.left+o.clientWidth*r,top:v.top,bottom:v.top+o.clientHeight*n}}let a=0,i=0;if("nearest"==g?f.top<e.top?(i=-(e.top-f.top+_),0<p&&f.bottom>e.bottom+i&&(i=f.bottom-e.bottom+i+_)):f.bottom>e.bottom&&(i=f.bottom-e.bottom+_,p<0)&&f.top-i<e.top&&(i=-(e.top+i-f.top+_)):(u=f.bottom-f.top,l=e.bottom-e.top,l="center"==g&&u<=l?f.top+u/2-l/2:"start"==g||"center"==g&&p<0?f.top-_:f.bottom-l+_,i=l-e.top),"nearest"==h?f.left<e.left?(a=-(e.left-f.left+m),0<p&&f.right>e.right+a&&(a=f.right-e.right+a+m)):f.right>e.right&&(a=f.right-e.right+m,p<0)&&f.left<e.left+a&&(a=-(e.left+a-f.left+m)):(l="center"==h?f.left+(f.right-f.left)/2-(e.right-e.left)/2:"start"==h==y?f.left-m:f.right-(e.right-e.left)+m,a=l-e.left),a||i)if(t)b.scrollBy(a,i);else{let e=0,t=0;i&&(c=o.scrollTop,o.scrollTop+=i/n,t=(o.scrollTop-c)*n),a&&(c=o.scrollLeft,o.scrollLeft+=a/r,e=(o.scrollLeft-c)*r),f={left:f.left-e,top:f.top-t,right:f.right-e,bottom:f.bottom-t},e&&Math.abs(e-a)<1&&(h="nearest"),t&&Math.abs(t-i)<1&&(g="nearest")}if(t)break;o=o.assignedSlot||o.parentNode}else{if(11!=o.nodeType)break;o=o.host}}}}}class Or extends N{constructor(e){super(),this.height=e}toDOM(){var e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}function We(e,t){var r=e.observer.selectionRange;if(!r.focusNode)return null;var n,a=fe(r.focusNode,r.focusOffset),r=pe(r.focusNode,r.focusOffset);let i=a||r;return r&&a&&r.node!=a.node&&(!(n=k.get(r.node))||n instanceof w&&n.text!=r.node.nodeValue||e.docView.lastCompositionAfterCursor&&(n=k.get(a.node))&&!(n instanceof w&&n.text!=a.node.nodeValue))&&(i=r),e.docView.lastCompositionAfterCursor=i!=a,i?{from:n=t-i.offset,to:n+i.node.nodeValue.length,node:i.node}:null}let l=class{constructor(){this.changes=[]}compareRange(e,t){Pe(e,t,this.changes)}comparePoint(e,t){Pe(e,t,this.changes)}};function qe(e,t){return e.top<t.bottom-1&&e.bottom>t.top+1}function $e(e,t){return t<e.top?{top:t,left:e.left,right:e.right,bottom:e.bottom}:e}function ze(e,t){return t>e.bottom?{top:e.top,left:e.left,right:e.right,bottom:t}:e}function Ke(e,n,a){let i,o,s,l,c=!1,u,d,f,p;for(let r=e.firstChild;r;r=r.nextSibling){var h=re(r);for(let t=0;t<h.length;t++){let e=h[t];o&&qe(o,e)&&(e=$e(ze(e,o.bottom),o.top));m=n;m=(_=e).left>m?_.left-m:Math.max(0,m-_.right),_=(_=a,(g=e).top>_?g.top-_:Math.max(0,_-g.bottom));if(0==m&&0==_)return(3==r.nodeType?Ye:Ke)(r,n,a);(!i||l>_||l==_&&s>m)&&(i=r,o=e,s=m,g=(l=_)?a<e.top?-1:1:m?n<e.left?-1:1:0,c=!g||(0<g?t<h.length-1:0<t)),0==m?a>e.bottom&&(!f||f.bottom<e.bottom)?(u=r,f=e):a<e.top&&(!p||p.top>e.top)&&(d=r,p=e):f&&qe(f,e)?f=ze(f,e.bottom):p&&qe(p,e)&&(p=$e(p,e.top))}}var g,m,_,t;return f&&f.bottom>=a?(i=u,o=f):p&&p.top<=a&&(i=d,o=p),i?(t=Math.max(o.left,Math.min(o.right,n)),3==i.nodeType?Ye(i,t,a):c&&"false"!=i.contentEditable?Ke(i,t,a):{node:e,offset:Array.prototype.indexOf.call(e.childNodes,i)+(n>=(o.left+o.right)/2?1:0)}):{node:e,offset:0}}function Ye(n,a,t){var e=n.nodeValue.length;let i=-1,o=1e9,s=0;for(let r=0;r<e;r++){var l=T(n,r,r+1).getClientRects();for(let e=0;e<l.length;e++){var c=l[e];if(c.top!=c.bottom){s=s||a-c.left;var u=(c.top>t?c.top-t:t-c.bottom)-1;if(c.left-1<=a&&c.right+1>=a&&u<o){let e=a>=(c.left+c.right)/2,t=e;if((S.chrome||S.gecko)&&T(n,r).getBoundingClientRect().left==c.right&&(t=!e),u<=0)return{node:n,offset:r+(t?1:0)};i=r+(t?1:0),o=u}}}}return{node:n,offset:-1<i?i:0<s?n.nodeValue.length:0}}function Je(r,e,n,a=-1){var t=r.contentDOM.getBoundingClientRect(),i=t.top+r.viewState.paddingTop;let o,s=r.viewState["docHeight"],{x:l,y:c}=e,u=c-i;if(u<0)return 0;if(u>s)return r.state.doc.length;for(let e=r.viewState.heightOracle.textHeight/2,t=!1;(o=r.elementAtHeight(u)).type!=O.BlockType.Text;)for(;!(0<=(u=0<a?o.bottom+e:o.top-e)&&u<=s);){if(t)return n?null:0;t=!0,a=-a}c=i+u;i=o.from;if(i<r.viewport.from)return 0==r.viewport.from?0:n?null:Ze(r,t,o,l,c);if(i>r.viewport.to)return r.viewport.to==r.state.doc.length?r.state.doc.length:n?null:Ze(r,t,o,l,c);var d=r.dom.ownerDocument,f=r.root.elementFromPoint?r.root:d;let p=f.elementFromPoint(l,c);(p=p&&!r.contentDOM.contains(p)?null:p)||(l=Math.max(t.left+1,Math.min(t.right-1,l)),(p=f.elementFromPoint(l,c))&&!r.contentDOM.contains(p)&&(p=null));let h,g=-1;if(p&&0!=(null==(t=r.docView.nearest(p))?void 0:t.isEditable)&&(d.caretPositionFromPoint?(f=d.caretPositionFromPoint(l,c))&&({offsetNode:h,offset:g}=f):d.caretRangeFromPoint&&(t=d.caretRangeFromPoint(l,c))&&({startContainer:h,startOffset:g}=t,!r.contentDOM.contains(h)||S.safari&&function(t,e,r){let n;if(3!=t.nodeType||e!=(n=t.nodeValue.length))return;for(let e=t.nextSibling;e;e=e.nextSibling)if(1!=e.nodeType||"BR"!=e.nodeName)return;return T(t,n-1,n).getBoundingClientRect().left>r}(h,g,l)||S.chrome&&function(t,e,r){if(0!=e)return;for(let e=t;;){var n=e.parentNode;if(!n||1!=n.nodeType||n.firstChild!=e)return;if(n.classList.contains("cm-line"))break;e=n}e=(1==t.nodeType?t:T(t,0,Math.max(t.nodeValue.length,1))).getBoundingClientRect();return 5<r-e.left}(h,g,l))&&(h=void 0)),!h||!r.docView.dom.contains(h)){f=M.find(r.docView,i);if(!f)return u>o.top+o.height/2?o.to:o.from;({node:h,offset:g}=Ke(f.dom,l,c))}d=r.docView.nearest(h);return d?d.isWidget&&1==(null==(t=d.dom)?void 0:t.nodeType)?(i=d.dom.getBoundingClientRect(),e.y<i.top||e.y<=i.bottom&&e.x<=(i.left+i.right)/2?d.posAtStart:d.posAtEnd):d.localPosFromDOM(h,g)+d.posAtStart:null}function Ze(e,t,r,n,a){let i=Math.round((n-t.left)*e.defaultCharacterWidth);e.lineWrapping&&r.height>1.5*e.defaultLineHeight&&(n=e.viewState.heightOracle.textHeight,t=Math.floor((a-r.top-.5*(e.defaultLineHeight-n))/n),i+=t*e.viewState.heightOracle.lineLength);a=e.state.sliceDoc(r.from,r.to);return r.from+_.findColumn(a,i,e.state.tabSize)}function Qe(e,t){var r=e.lineBlockAt(t);if(Array.isArray(r.type))for(var n of r.type)if(n.to>t||n.to==t&&(n.to==r.to||n.type==O.BlockType.Text))return n;return r}function Xe(a,e,i,o){let s=a.state.doc.lineAt(e.head),l=a.bidiSpans(s);var c=a.textDirectionAt(s.from);for(let r=e,n=null;;){let e=He(s,l,c,r,i),t=d;if(!e){if(s.number==(i?a.state.doc.lines:1))return r;t="\n",s=a.state.doc.line(s.number+(i?1:-1)),l=a.bidiSpans(s),e=a.visualLineSide(s,!i)}if(n){if(!n(t))return r}else{if(!o)return e;n=o(t)}r=e}}function et(e,i,o){for(;;){let a=0;for(var t of e)t.between(i-1,i+1,(e,t,r)=>{var n;e<i&&i<t&&(n=a||o||(i-e<t-i?-1:1),i=n<0?e:t,a=n)});if(!a)return i}}function tt(t,e,r){e=et(t.state.facet(Tr).map(e=>e(t)),r.from,e.head>r.from?-1:1);return e==r.from?r:_.EditorSelection.cursor(e,e<r.from?1:-1)}class Cr{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,S.safari&&e.contentDOM.addEventListener("input",()=>null),S.gecko&&(e=e.contentDOM.ownerDocument,Dr.has(e)||(Dr.add(e),e.addEventListener("copy",()=>{}),e.addEventListener("cut",()=>{})))}handleEvent(e){!function(r,n){if(n.bubbles){if(n.defaultPrevented)return;for(let e=n.target,t;e!=r.contentDOM;e=e.parentNode)if(!e||11==e.nodeType||(t=k.get(e))&&t.ignoreEvent(n))return}return 1}(this.view,e)||this.ignoreDuringComposition(e)||"keydown"==e.type&&this.keydown(e)||this.runHandlers(e.type,e)}runHandlers(e,t){e=this.handlers[e];if(e){for(var r of e.observers)r(this.view,t);for(var n of e.handlers){if(t.defaultPrevented)break;if(n(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){var t,r,n=function(e){let t=Object.create(null);function r(e){return t[e]||(t[e]={observers:[],handlers:[]})}for(var n of e){var a=n.spec;if(a&&a.domEventHandlers)for(var i in a.domEventHandlers){var o=a.domEventHandlers[i];o&&r(i).handlers.push(rt(n.value,o))}if(a&&a.domEventObservers)for(var s in a.domEventObservers){var l=a.domEventObservers[s];l&&r(s).observers.push(rt(n.value,l))}}for(var c in V)r(c).handlers.push(V[c]);for(var u in W)r(u).observers.push(W[u]);return t}(e),a=this.handlers,i=this.view.contentDOM;for(t in n)if("scroll"!=t){var o=!n[t].handlers.length;let e=a[t];e&&o!=!e.handlers.length&&(i.removeEventListener(t,this.handleEvent),e=null),e||i.addEventListener(t,this.handleEvent,{passive:o})}for(r in a)"scroll"==r||n[r]||i.removeEventListener(r,this.handleEvent);this.handlers=n}keydown(t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),9==t.keyCode&&-1<this.tabFocusMode&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(0<this.tabFocusMode&&27!=t.keyCode&&Rr.indexOf(t.keyCode)<0&&(this.tabFocusMode=-1),S.android&&S.chrome&&!t.synthetic&&(13==t.keyCode||8==t.keyCode))return this.view.observer.delayAndroidKey(t.key,t.keyCode),!0;let e;return!S.ios||t.synthetic||t.altKey||t.metaKey||!((e=kr.find(e=>e.keyCode==t.keyCode))&&!t.ctrlKey||-1<wr.indexOf(t.key)&&t.ctrlKey&&!t.shiftKey)?(229!=t.keyCode&&this.view.observer.forceFlush(),!1):(this.pendingIOSKey=e||t,setTimeout(()=>this.flushIOSKey(),250),!0)}flushIOSKey(e){var t=this.pendingIOSKey;return!(!t||"Enter"==t.key&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString()))&&(this.pendingIOSKey=void 0,ce(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return!!/^key/.test(e.type)&&(0<this.composing||!!(S.safari&&!S.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100)&&!(this.compositionPendingKey=!1))}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function rt(r,n){return(t,e)=>{try{return n.call(r,e,t)}catch(e){A(t.state,e)}}}const kr=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],wr="dthko",Rr=[16,17,18,20,91,92,224,225];function nt(e){return.7*Math.max(0,e)+8}class Ir{constructor(t,e,r,n){this.view=t,this.startEvent=e,this.style=r,this.mustSelect=n,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=e,this.scrollParent=function(t){var r=t.ownerDocument;for(let e=t.parentNode;e&&e!=r.body;)if(1==e.nodeType){if(e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth)return e;e=e.assignedSlot||e.parentNode}else{if(11!=e.nodeType)break;e=e.host}return null}(t.contentDOM),this.atoms=t.state.facet(Tr).map(e=>e(t));r=t.contentDOM.ownerDocument;r.addEventListener("mousemove",this.move=this.move.bind(this)),r.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=e.shiftKey,this.multiple=t.state.facet(_.EditorState.allowMultipleSelections)&&function(e,t){e=e.state.facet(er);return e.length?e[0](t):S.mac?t.metaKey:t.ctrlKey}(t,e),this.dragging=!(!function(e,t){var r=e.state.selection["main"];if(!r.empty){r=X(e.root);if(!r||0==r.rangeCount)return 1;var n=r.getRangeAt(0).getClientRects();for(let e=0;e<n.length;e++){var a=n[e];if(a.left<=t.clientX&&a.right>=t.clientX&&a.top<=t.clientY&&a.bottom>=t.clientY)return 1}}return}(t,e)||1!=st(e))&&null}start(e){!1===this.dragging&&this.select(e)}move(r){var n;if(0==r.buttons)return this.destroy();if(!(this.dragging||null==this.dragging&&(n=this.startEvent,a=r,Math.max(Math.abs(n.clientX-a.clientX),Math.abs(n.clientY-a.clientY))<10))){this.select(this.lastEvent=r);let e=0,t=0;var a=(null==(n=this.scrollParent)?void 0:n.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight},i=Ve(this.view);r.clientX-i.left<=a.left+6?e=-nt(a.left-r.clientX):r.clientX+i.right>=a.right-6&&(e=nt(r.clientX-a.right)),r.clientY-i.top<=a.top+6?t=-nt(a.top-r.clientY):r.clientY+i.bottom>=a.bottom-6&&(t=nt(r.clientY-a.bottom)),this.setScrollSpeed(e,t)}}up(e){null==this.dragging&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);var e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):-1<this.scrolling&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),!1===this.dragging&&this.select(this.lastEvent)}skipAtoms(n){let a=null;for(let r=0;r<n.ranges.length;r++){let e=n.ranges[r],t=null;var i,o;e.empty?(i=et(this.atoms,e.from,0))!=e.from&&(t=_.EditorSelection.cursor(i,-1)):(i=et(this.atoms,e.from,-1),o=et(this.atoms,e.to,1),i==e.from&&o==e.to||(t=_.EditorSelection.range(e.from==e.anchor?i:o,e.from==e.head?i:o))),t&&((a=a||n.ranges.slice())[r]=t)}return a?_.EditorSelection.create(a,n.mainIndex):n}select(e){var t=this["view"],e=this.skipAtoms(this.style.get(e,this.extend,this.multiple));!this.mustSelect&&e.eq(t.state.selection,!1===this.dragging)||this.view.dispatch({selection:e,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(e=>e.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}const V=Object.create(null),W=Object.create(null),Mr=S.ie&&S.ie_version<15||S.ios&&S.webkit_version<604;function at(e,a){let i=e["state"],t,o=1,s=i.toText(a),l=s.lines==i.selection.ranges.length;if(null!=f&&i.selection.ranges.every(e=>e.empty)&&f==s.toString()){let n=-1;t=i.changeByRange(e=>{var t=i.doc.lineAt(e.from);if(t.from==n)return{range:e};n=t.from;var r=i.toText((l?s.line(o++).text:a)+i.lineBreak);return{changes:{from:t.from,insert:r},range:_.EditorSelection.cursor(e.from+r.length)}})}else t=l?i.changeByRange(e=>{var t=s.line(o++);return{changes:{from:e.from,to:e.to,insert:t.text},range:_.EditorSelection.cursor(e.from+t.length)}}):i.replaceSelection(s);e.dispatch(t,{userEvent:"input.paste",scrollIntoView:!0})}function it(r,n,a,i){if(1==i)return _.EditorSelection.cursor(n,a);if(2==i){var[i,a,o=1]=[r.state,n,a];var s=i.charCategorizer(a),l=i.doc.lineAt(a),i=a-l.from;if(0==l.length)return _.EditorSelection.cursor(a);0==i?o=1:i==l.length&&(o=-1);let e=i,t=i;o<0?e=_.findClusterBreak(l.text,i,!1):t=_.findClusterBreak(l.text,i);for(var c=s(l.text.slice(e,t));0<e;){var u=_.findClusterBreak(l.text,e,!1);if(s(l.text.slice(u,e))!=c)break;e=u}for(;t<l.length;){var d=_.findClusterBreak(l.text,t);if(s(l.text.slice(t,d))!=c)break;t=d}return _.EditorSelection.range(e+l.from,t+l.from)}{a=M.find(r.docView,n),o=r.state.doc.lineAt(a?a.posAtEnd:n);let e=a?a.posAtStart:o.from,t=a?a.posAtEnd:o.to;return t<r.state.doc.length&&t==o.to&&t++,_.EditorSelection.range(e,t)}}W.scroll=e=>{e.inputState.lastScrollTop=e.scrollDOM.scrollTop,e.inputState.lastScrollLeft=e.scrollDOM.scrollLeft},V.keydown=(e,t)=>(e.inputState.setSelectionOrigin("select"),27==t.keyCode&&0!=e.inputState.tabFocusMode&&(e.inputState.tabFocusMode=Date.now()+2e3),!1),W.touchstart=(e,t)=>{e.inputState.lastTouchTime=Date.now(),e.inputState.setSelectionOrigin("select.pointer")},W.touchmove=e=>{e.inputState.setSelectionOrigin("select.pointer")},V.mousedown=(t,r)=>{if(t.observer.flush(),!(t.inputState.lastTouchTime>Date.now()-2e3)){let e=null;for(var n of t.state.facet(rr))if(e=n(t,r))break;if(e=e||0!=r.button?e:function(s,e){let l=ot(s,e),c=st(e),u=s.state.selection;return{update(e){e.docChanged&&(l.pos=e.changes.mapPos(l.pos),u=u.map(e.changes))},get(e,t,r){let n=ot(s,e),a,i=it(s,n.pos,n.bias,c);var o;return l.pos==n.pos||t||(e=it(s,l.pos,l.bias,c),o=Math.min(e.from,i.from),e=Math.max(e.to,i.to),i=o<i.from?_.EditorSelection.range(o,e):_.EditorSelection.range(e,o)),t?u.replaceRange(u.main.extend(i.from,i.to)):r&&1==c&&1<u.ranges.length&&(a=function(t,r){for(let e=0;e<t.ranges.length;e++){var{from:n,to:a}=t.ranges[e];if(n<=r&&r<=a)return _.EditorSelection.create(t.ranges.slice(0,e).concat(t.ranges.slice(e+1)),t.mainIndex==e?0:t.mainIndex-(t.mainIndex>e?1:0))}return null}(u,n.pos))?a:r?u.addRange(i):_.EditorSelection.create([i])}}}(t,r)){var a=!t.hasFocus,a=(t.inputState.startMouseSelection(new Ir(t,r,e,a)),a&&t.observer.ignore(()=>{le(t.contentDOM);var e=t.root.activeElement;e&&!e.contains(t.contentDOM)&&e.blur()}),t.inputState.mouseSelection);if(a)return a.start(r),!1===a.dragging}}return!1};let i=(e,t)=>e>=t.top&&e<=t.bottom,s=(e,t,r)=>i(t,r)&&e>=r.left&&e<=r.right;function ot(e,t){var r,n,a=e.posAtCoords({x:t.clientX,y:t.clientY},!1);return{pos:a,bias:(e=e,a=a,r=t.clientX,t=t.clientY,(e=M.find(e.docView,a))&&0!=(a=a-e.posAtStart)&&(a==e.length||(n=e.coordsAt(a,-1))&&s(r,t,n)||(!(e=e.coordsAt(a,1))||!s(r,t,e))&&n&&i(t,n))?-1:1)}}const Pr=S.ie&&S.ie_version<=11;let n=null,c=0,u=0;function st(e){var t,r;return Pr?(t=n,r=u,n=e,u=Date.now(),c=!t||r>Date.now()-400&&Math.abs(t.clientX-e.clientX)<2&&Math.abs(t.clientY-e.clientY)<2?(c+1)%3:1):e.detail}function lt(e,t,r,n){var a,i;r&&(a=e.posAtCoords({x:t.clientX,y:t.clientY},!1),i=e.inputState["draggedContent"],t=n&&i&&(n=t,(t=(t=e).state.facet(tr)).length?t[0](n):S.mac?!n.altKey:!n.ctrlKey)?{from:i.from,to:i.to}:null,n={from:a,insert:r},i=e.state.changes(t?[t,n]:n),e.focus(),e.dispatch({changes:i,selection:{anchor:i.mapPos(a,-1),head:i.mapPos(a,1)},userEvent:t?"move.drop":"input.drop"}),e.inputState.draggedContent=null)}V.dragstart=(e,t)=>{let r=e.state["selection"]["main"];var n,a=(t.target.draggable&&(n=e.docView.nearest(t.target))&&n.isWidget&&(n=(a=n.posAtStart)+n.length,a>=r.to||n<=r.from)&&(r=_.EditorSelection.range(a,n)),e)["inputState"];return a.mouseSelection&&(a.mouseSelection.dragging=!0),a.draggedContent=r,t.dataTransfer&&(t.dataTransfer.setData("Text",e.state.sliceDoc(r.from,r.to)),t.dataTransfer.effectAllowed="copyMove"),!1},V.dragend=e=>(e.inputState.draggedContent=null,!1),V.drop=(t,a)=>{if(!a.dataTransfer)return!1;if(t.state.readOnly)return!0;let i=a.dataTransfer.files;if(i&&i.length){let r=Array(i.length),e=0,n=()=>{++e==i.length&&lt(t,a,r.filter(e=>null!=e).join(t.state.lineBreak),!1)};for(let t=0;t<i.length;t++){let e=new FileReader;e.onerror=n,e.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(e.result)||(r[t]=e.result),n()},e.readAsText(i[t])}return!0}var e=a.dataTransfer.getData("Text");return!!e&&(lt(t,a,e,!0),!0)},V.paste=(e,t)=>{if(e.state.readOnly)return!0;e.observer.flush();t=Mr?null:t.clipboardData;if(t)return at(e,t.getData("text/plain")||t.getData("text/uri-list")),!0;var r=e,t=r.dom.parentNode;if(t){let e=t.appendChild(document.createElement("textarea"));e.style.cssText="position: fixed; left: -10000px; top: 10px",e.focus(),setTimeout(()=>{r.focus(),e.remove(),at(r,e.value)},50)}return!1};let f=null;V.copy=V.cut=(e,t)=>{var{text:r,ranges:n,linewise:a}=function(t){let r=[],n=[],a=!1;for(var e of t.selection.ranges)e.empty||(r.push(t.sliceDoc(e.from,e.to)),n.push(e));if(!r.length){let e=-1;for(var{from:i}of t.selection.ranges){i=t.doc.lineAt(i);i.number>e&&(r.push(i.text),n.push({from:i.from,to:Math.min(t.doc.length,i.to+1)})),e=i.number}a=!0}return{text:r.join(t.lineBreak),ranges:n,linewise:a}}(e.state);if(r||a){f=a?r:null,"cut"!=t.type||e.state.readOnly||e.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"});a=Mr?null:t.clipboardData;if(a)return a.clearData(),a.setData("text/plain",r),!0;var i=e,n=r,t=i.dom.parentNode;if(t){let e=t.appendChild(document.createElement("textarea"));e.style.cssText="position: fixed; left: -10000px; top: 10px",e.value=n,e.focus(),e.selectionEnd=n.length,e.selectionStart=0,setTimeout(()=>{e.remove(),i.focus()},50)}}return!1};const Nr=_.Annotation.define();function ct(e,t){var r,n=[];for(r of e.facet(or)){var a=r(e,t);a&&n.push(a)}return n?e.update({effects:n,annotations:Nr.of(!0)}):null}function ut(t){setTimeout(()=>{var e=t.hasFocus;e!=t.inputState.notifiedFocused&&((e=ct(t.state,e))?t.dispatch(e):t.update([]))},10)}W.focus=e=>{e.inputState.lastFocusTime=Date.now(),e.scrollDOM.scrollTop||!e.inputState.lastScrollTop&&!e.inputState.lastScrollLeft||(e.scrollDOM.scrollTop=e.inputState.lastScrollTop,e.scrollDOM.scrollLeft=e.inputState.lastScrollLeft),ut(e)},W.blur=e=>{e.observer.clearSelectionRange(),ut(e)},W.compositionstart=W.compositionupdate=e=>{e.observer.editContext||(null==e.inputState.compositionFirstChange&&(e.inputState.compositionFirstChange=!0),e.inputState.composing<0&&(e.inputState.composing=0))},W.compositionend=e=>{e.observer.editContext||(e.inputState.composing=-1,e.inputState.compositionEndedAt=Date.now(),e.inputState.compositionPendingKey=!0,e.inputState.compositionPendingChange=0<e.observer.pendingRecords().length,e.inputState.compositionFirstChange=null,S.chrome&&S.android?e.observer.flushSoon():e.inputState.compositionPendingChange?Promise.resolve().then(()=>e.observer.flush()):setTimeout(()=>{e.inputState.composing<0&&e.docView.hasComposition&&e.update([])},50))},W.contextmenu=e=>{e.inputState.lastContextMenu=Date.now()},V.beforeinput=(r,t)=>{var e;let n;if(S.chrome&&S.android&&(n=kr.find(e=>e.inputType==t.inputType))&&(r.observer.delayAndroidKey(n.key,n.keyCode),"Backspace"==n.key||"Delete"==n.key)){let t=(null==(e=window.visualViewport)?void 0:e.height)||0;setTimeout(()=>{var e;((null==(e=window.visualViewport)?void 0:e.height)||0)>t+10&&r.hasFocus&&(r.contentDOM.blur(),r.focus())},100)}return S.ios&&"deleteContentForward"==t.inputType&&r.observer.flushSoon(),S.safari&&"insertText"==t.inputType&&0<=r.inputState.composing&&setTimeout(()=>W.compositionend(r,t),20),!1};const Dr=new Set;const xr=["pre-wrap","normal","pre-line","break-spaces"];class Lr{constructor(e){this.lineWrapping=e,this.doc=_.Text.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}heightForGap(e,t){let r=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(r+=Math.max(0,Math.ceil((t-e-r*this.lineLength*.5)/this.lineLength))),this.lineHeight*r}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return-1<xr.indexOf(e)!=this.lineWrapping}mustRefreshForHeights(t){let r=!1;for(let e=0;e<t.length;e++){var n=t[e];n<0?e++:this.heightSamples[Math.floor(10*n)]||(r=!0,this.heightSamples[Math.floor(10*n)]=!0)}return r}refresh(e,t,r,n,a,i){var e=-1<xr.indexOf(e),o=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=e;if(this.lineWrapping=e,this.lineHeight=t,this.charWidth=r,this.textHeight=n,this.lineLength=a,o){this.heightSamples={};for(let e=0;e<i.length;e++){var s=i[e];s<0?e++:this.heightSamples[Math.floor(10*s)]=!0}}return o}}class Fr{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class q{constructor(e,t,r,n,a){this.from=e,this.length=t,this.top=r,this.height=n,this._content=a}get type(){return"number"==typeof this._content?O.BlockType.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof x?this._content.widget:null}get widgetLineBreaks(){return"number"==typeof this._content?this._content:0}join(e){var t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new q(this.from,this.length+e.length,this.top,this.height+e.height,t)}}(v=b=b||{})[v.ByPos=0]="ByPos",v[v.ByHeight=1]="ByHeight",v[v.ByPosNoHeight=2]="ByPosNoHeight";class ${constructor(e,t,r=2){this.length=e,this.height=t,this.flags=r}get outdated(){return 0<(2&this.flags)}set outdated(e){this.flags=(e?2:0)|-3&this.flags}setHeight(e,t){this.height!=t&&(.001<Math.abs(this.height-t)&&(e.heightChanged=!0),this.height=t)}replace(e,t,r){return $.of(r)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(o,s,l,c){let u=this,d=l.doc;for(let i=c.length-1;0<=i;i--){let{fromA:e,toA:t,fromB:r,toB:n}=c[i],a=u.lineAt(e,b.ByPosNoHeight,l.setDoc(s),0,0);var f=a.to>=t?a:u.lineAt(t,b.ByPosNoHeight,l,0,0);for(n+=f.to-t,t=f.to;0<i&&a.from<=c[i-1].toA;)e=c[i-1].fromA,r=c[i-1].fromB,i--,e<a.from&&(a=u.lineAt(e,b.ByPosNoHeight,l,0,0));r+=a.from-e,e=a.from;f=jr.build(l.setDoc(d),o,r,n);u=u.replace(e,t,f)}return u.updateHeight(l,0)}static empty(){return new z(0,0)}static of(e){if(1==e.length)return e[0];let t=0,r=e.length,n=0,a=0;for(;;){var i;if(t==r)if(n>2*a){var o=e[t-1];o.break?e.splice(--t,1,o.left,null,o.right):e.splice(--t,1,o.left,o.right),r+=1+o.break,n-=o.size}else{if(!(a>2*n))break;o=e[r];o.break?e.splice(r,1,o.left,null,o.right):e.splice(r,1,o.left,o.right),r+=2+o.break,a-=o.size}else n<a?(i=e[t++])&&(n+=i.size):(i=e[--r])&&(a+=i.size)}let s=0;return null==e[t-1]?(s=1,t--):null==e[t]&&(s=1,r++),new Br($.of(e.slice(0,t)),s,$.of(e.slice(r)))}}$.prototype.size=1;class Ur extends ${constructor(e,t,r){super(e,t),this.deco=r}blockAt(e,t,r,n){return new q(n,this.length,r,this.height,this.deco||0)}lineAt(e,t,r,n,a){return this.blockAt(0,r,n,a)}forEachLine(e,t,r,n,a,i){e<=a+this.length&&a<=t&&i(this.blockAt(0,r,n,a))}updateHeight(e,t=0,r,n){return n&&n.from<=t&&n.more&&this.setHeight(e,n.heights[n.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class z extends Ur{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,t,r,n){return new q(n,this.length,r,this.height,this.breaks)}replace(e,t,r){let n=r[0];return 1==r.length&&(n instanceof z||n instanceof K&&4&n.flags)&&Math.abs(this.length-n.length)<10?(n instanceof K?n=new z(n.length,this.height):n.height=this.height,this.outdated||(n.outdated=!1),n):$.of(r)}updateHeight(e,t=0,r=!1,n){return n&&n.from<=t&&n.more?this.setHeight(e,n.heights[n.index++]):(r||this.outdated)&&this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class K extends ${constructor(e){super(e,0)}heightMetrics(e,t){var r=e.doc.lineAt(t).number,t=e.doc.lineAt(t+this.length).number,n=t-r+1;let a,i=0;return e.lineWrapping?(e=Math.min(this.height,e.lineHeight*n),a=e/n,this.length>1+n&&(i=(this.height-e)/(this.length-n-1))):a=this.height/n,{firstLine:r,lastLine:t,perLine:a,perChar:i}}blockAt(e,t,r,n){var a,{firstLine:i,lastLine:o,perLine:s,perChar:l}=this.heightMetrics(t,n);return t.lineWrapping?(n=n+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-r)/this.height))*this.length)),l=s+(n=t.doc.lineAt(n)).length*l,a=Math.max(r,e-l/2),new q(n.from,n.length,a,l,0)):(n=Math.max(0,Math.min(o-i,Math.floor((e-r)/s))),{from:a,length:l}=t.doc.line(i+n),new q(a,l,r+s*n,s,0))}lineAt(e,t,r,n,a){var i,o;return t==b.ByHeight?this.blockAt(e,r,n,a):t==b.ByPosNoHeight?({from:t,to:o}=r.doc.lineAt(e),new q(t,o-t,0,0,0)):({firstLine:o,perLine:t,perChar:i}=this.heightMetrics(r,a),e=t+(r=r.doc.lineAt(e)).length*i,o=n+t*(t=r.number-o)+i*(r.from-a-t),new q(r.from,r.length,Math.max(n,Math.min(o,n+this.height-e)),e,0))}forEachLine(r,n,a,i,o,s){r=Math.max(r,o),n=Math.min(n,o+this.length);var{firstLine:l,perLine:c,perChar:u}=this.heightMetrics(a,o);for(let e=r,t=i;e<=n;){var d=a.doc.lineAt(e),f=(e==r&&(f=d.number-l,t+=c*f+u*(r-o-f)),c+u*d.length);s(new q(d.from,d.length,t,f,0)),t+=f,e=d.to+1}}replace(e,t,r){var n,t=this.length-t;return 0<t&&((n=r[r.length-1])instanceof K?r[r.length-1]=new K(n.length+t):r.push(null,new K(t-1))),0<e&&((n=r[0])instanceof K?r[0]=new K(e+n.length):r.unshift(new K(e-1),null)),$.of(r)}decomposeLeft(e,t){t.push(new K(e-1),null)}decomposeRight(e,t){t.push(null,new K(this.length-e-1))}updateHeight(n,a=0,e=!1,i){var o=a+this.length;if(i&&i.from<=a+this.length&&i.more){let e=[],t=Math.max(a,i.from),r=-1;for(i.from>a&&e.push(new K(i.from-a-1).updateHeight(n,a));t<=o&&i.more;){var s=n.doc.lineAt(t).length,l=(e.length&&e.push(null),i.heights[i.index++]),l=(-1==r?r=l:.001<=Math.abs(l-r)&&(r=-2),new z(s,l));l.outdated=!1,e.push(l),t+=s+1}t<=o&&e.push(null,new K(o-t).updateHeight(n,t));var c=$.of(e);return(r<0||.001<=Math.abs(c.height-this.height)||.001<=Math.abs(r-this.heightMetrics(n,a).perLine))&&(n.heightChanged=!0),c}return(e||this.outdated)&&(this.setHeight(n,n.heightForGap(a,a+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}}class Br extends ${constructor(e,t,r){super(e.length+t+r.length,e.height+r.height,t|(e.outdated||r.outdated?2:0)),this.left=e,this.right=r,this.size=e.size+r.size}get break(){return 1&this.flags}blockAt(e,t,r,n){var a=r+this.left.height;return e<a?this.left.blockAt(e,t,r,n):this.right.blockAt(e,t,a,n+this.left.length+this.break)}lineAt(e,t,r,n,a){var i=n+this.left.height,o=a+this.left.length+this.break,s=t==b.ByHeight?e<i:e<o,e=s?this.left.lineAt(e,t,r,n,a):this.right.lineAt(e,t,r,i,o);return this.break||(s?e.to<o:e.from>o)?e:(t=t==b.ByPosNoHeight?b.ByPosNoHeight:b.ByPos,s?e.join(this.right.lineAt(o,t,r,i,o)):this.left.lineAt(o,t,r,n,a).join(e))}forEachLine(e,t,r,n,a,i){var o,s=n+this.left.height,l=a+this.left.length+this.break;this.break?(e<l&&this.left.forEachLine(e,t,r,n,a,i),l<=t&&this.right.forEachLine(e,t,r,s,l,i)):(e<(o=this.lineAt(l,b.ByPos,r,n,a)).from&&this.left.forEachLine(e,o.from-1,r,n,a,i),o.to>=e&&o.from<=t&&i(o),t>o.to&&this.right.forEachLine(o.to+1,t,r,s,l,i))}replace(e,t,r){var n=this.left.length+this.break;if(t<n)return this.balanced(this.left.replace(e,t,r),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-n,t-n,r));var a,i=[],n=(0<e&&this.decomposeLeft(e,i),i.length);for(a of r)i.push(a);return 0<e&&dt(i,n-1),t<this.length&&(r=i.length,this.decomposeRight(t,i),dt(i,r)),$.of(i)}decomposeLeft(e,t){let r=this.left.length;if(e<=r)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&e>=++r&&t.push(null),e>r&&this.right.decomposeLeft(e-r,t)}decomposeRight(e,t){var r=this.left.length,n=r+this.break;if(n<=e)return this.right.decomposeRight(e-n,t);e<r&&this.left.decomposeRight(e,t),this.break&&e<n&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?$.of(this.break?[e,null,t]:[e,t]):(this.left=e,this.right=t,this.height=e.height+t.height,this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,r=!1,n){let{left:a,right:i}=this,o=t+a.length+this.break,s=null;return n&&n.from<=t+a.length&&n.more?s=a=a.updateHeight(e,t,r,n):a.updateHeight(e,t,r),n&&n.from<=o+i.length&&n.more?s=i=i.updateHeight(e,o,r,n):i.updateHeight(e,o,r),s?this.balanced(a,i):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function dt(e,t){let r,n;null==e[t]&&(r=e[t-1])instanceof K&&(n=e[t+1])instanceof K&&e.splice(t-1,3,new K(r.length+1+n.length))}class jr{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){var r,n;-1<this.lineStart&&(r=Math.min(t,this.lineEnd),(n=this.nodes[this.nodes.length-1])instanceof z?n.length+=r-this.pos:(r>this.pos||!this.isCovered)&&this.nodes.push(new z(r-this.pos,-1)),(this.writtenTo=r)<t)&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1),this.pos=t}point(t,r,n){if(t<r||n.heightRelevant){let e=n.widget?n.widget.estimatedHeight:0;var a=n.widget?n.widget.lineBreaks:0,i=(e<0&&(e=this.oracle.lineHeight),r-t);n.block?this.addBlock(new Ur(i,e,n)):(i||a||5<=e)&&this.addLineDeco(e,a,i)}else t<r&&this.span(t,r);-1<this.lineEnd&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){var e,t;-1<this.lineStart||({from:e,to:t}=this.oracle.doc.lineAt(this.pos),this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new z(this.pos-e,-1)),this.writtenTo=this.pos)}blankContent(e,t){var r=new K(t-e);return this.oracle.doc.lineAt(e).to==t&&(r.flags|=4),r}ensureLine(){this.enterLine();var e=this.nodes.length?this.nodes[this.nodes.length-1]:null;return e instanceof z||(e=new z(0,-1),this.nodes.push(e)),e}addBlock(e){this.enterLine();var t=e.deco;t&&0<t.startSide&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&0<t.endSide&&(this.covering=e)}addLineDeco(e,t,r){var n=this.ensureLine();n.length+=r,n.collapsed+=r,n.widgetHeight=Math.max(n.widgetHeight,e),n.breaks+=t,this.writtenTo=this.pos=this.pos+r}finish(e){var t,r=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(-1<this.lineStart)||r instanceof z||this.isCovered?(this.writtenTo<this.pos||null==r)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new z(0,-1));let n=e;for(t of this.nodes)t instanceof z&&t.updateHeight(this.oracle,n),n+=t?t.length:1;return this.nodes}static build(e,t,r,n){e=new jr(r,e);return _.RangeSet.spans(t,r,n,e,0),e.finish(r)}}class Hr{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,r,n){(e<t||r&&r.heightRelevant||n&&n.heightRelevant)&&Pe(e,t,this.changes,5)}}class Gr{constructor(e,t,r){this.from=e,this.to=t,this.size=r}static same(t,r){if(t.length!=r.length)return!1;for(let e=0;e<t.length;e++){var n=t[e],a=r[e];if(n.from!=a.from||n.to!=a.to||n.size!=a.size)return!1}return!0}draw(e,t){return D.replace({widget:new Vr(this.size*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class Vr extends N{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){var e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class Wr{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=$r,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=O.Direction.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;var t=e.facet(mr).some(e=>"function"!=typeof e&&"cm-lineWrapping"==e.class);this.heightOracle=new Lr(t),this.stateDeco=e.facet(_r).filter(e=>"function"!=typeof e),this.heightMap=$.empty().applyChanges(this.stateDeco,_.Text.empty,this.heightOracle.setDoc(e.doc),[new G(0,0,0,e.doc.length)]);for(let e=0;e<2&&(this.viewport=this.getViewport(0,null),this.updateForViewport());e++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=D.set(this.lineGaps.map(e=>e.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){var t,n,a=[this.viewport],i=this.state.selection["main"];for(let e=0;e<=1;e++){let r=e?i.head:i.anchor;a.some(({from:e,to:t})=>r>=e&&r<=t)||({from:t,to:n}=this.lineBlockAt(r),a.push(new qr(t,n)))}return this.viewports=a.sort((e,t)=>e.from-t.from),this.updateScaler()}updateScaler(){var e=this.scaler;return this.scaler=this.heightMap.height<=7e6?$r:new zr(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(ht(e,this.scaler))})}update(e,t=null){this.state=e.state;var r=this.stateDeco,n=(this.stateDeco=this.state.facet(_r).filter(e=>"function"!=typeof e),e.changedRanges),n=G.extendWithRanges(n,(n=r,r=this.stateDeco,a=e?e.changes:_.ChangeSet.empty(this.state.doc.length),o=new Hr,_.RangeSet.compare(n,r,a,o,0),o.changes)),r=this.heightMap.height,a=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),n),this.heightMap.height!=r&&(e.flags|=2),a?(this.scrollAnchorPos=e.changes.mapPos(a.from,-1),this.scrollAnchorHeight=a.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let i=n.length?this.mapViewport(this.viewport,e.changes):this.viewport;var o=(i=t&&(t.range.head<i.from||t.range.head>i.to)||!this.viewportIsAppropriate(i)?this.getViewport(0,t):i).from!=this.viewport.from||i.to!=this.viewport.to;this.viewport=i,e.flags|=this.updateForViewport(),(o||!e.changes.empty||2&e.flags)&&this.updateViewportLines(),(this.lineGaps.length||4e3<this.viewport.to-this.viewport.from)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(lr)&&(this.mustEnforceCursorAssoc=!0)}measure(e){var t=e.contentDOM,r=window.getComputedStyle(t),n=this.heightOracle,a=r.whiteSpace;this.defaultTextDirection="rtl"==r.direction?O.Direction.RTL:O.Direction.LTR;let i=this.heightOracle.mustRefreshForWrapping(a);var o=t.getBoundingClientRect();let s=i||this.mustMeasureContent||this.contentDOMHeight!=o.height,l=(this.contentDOMHeight=o.height,this.mustMeasureContent=!1,0),c=0;o.width&&o.height&&({scaleX:u,scaleY:d}=se(t,o),.005<u&&.005<Math.abs(this.scaleX-u)||.005<d&&.005<Math.abs(this.scaleY-d))&&(this.scaleX=u,this.scaleY=d,l|=8,i=s=!0);var u=(parseInt(r.paddingTop)||0)*this.scaleY,d=(parseInt(r.paddingBottom)||0)*this.scaleY,r=(this.paddingTop==u&&this.paddingBottom==d||(this.paddingTop=u,this.paddingBottom=d,l|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(n.lineWrapping&&(s=!0),this.editorWidth=e.scrollDOM.clientWidth,l|=8),e.scrollDOM.scrollTop*this.scaleY),u=(this.scrollTop!=r&&(this.scrollAnchorHeight=-1,this.scrollTop=r),this.scrolledToBottom=de(e.scrollDOM),(this.printing?function(e,t){return{left:0,right:(e=e.getBoundingClientRect()).right-e.left,top:t,bottom:e.bottom-(e.top+t)}}:function(t,e){var r=t.getBoundingClientRect(),n=t.ownerDocument,a=n.defaultView||window;let i=Math.max(0,r.left),o=Math.min(a.innerWidth,r.right),s=Math.max(0,r.top),l=Math.min(a.innerHeight,r.bottom);for(let e=t.parentNode;e&&e!=n.body;)if(1==e.nodeType){var c,u=e,d=window.getComputedStyle(u);(u.scrollHeight>u.clientHeight||u.scrollWidth>u.clientWidth)&&"visible"!=d.overflow&&(c=u.getBoundingClientRect(),i=Math.max(i,c.left),o=Math.min(o,c.right),s=Math.max(s,c.top),l=e==t.parentNode?c.bottom:Math.min(l,c.bottom)),e="absolute"==d.position||"fixed"==d.position?u.offsetParent:u.parentNode}else{if(11!=e.nodeType)break;e=e.host}return{left:i-r.left,right:Math.max(i,o)-r.left,top:s-(r.top+e),bottom:Math.max(s,l)-(r.top+e)}})(t,this.paddingTop)),d=u.top-this.pixelViewport.top,r=u.bottom-this.pixelViewport.bottom,t=(this.pixelViewport=u,this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left);if(t!=this.inView&&(this.inView=t)&&(s=!0),!this.inView&&!this.scrollTarget)return 0;u=o.width;if(this.contentDOMWidth==u&&this.editorHeight==e.scrollDOM.clientHeight||(this.contentDOMWidth=o.width,this.editorHeight=e.scrollDOM.clientHeight,l|=8),s){var f,p,h=e.docView.measureVisibleLineHeights(this.viewport);((i=n.mustRefreshForHeights(h)?!0:i)||n.lineWrapping&&Math.abs(u-this.contentDOMWidth)>n.charWidth)&&({lineHeight:t,charWidth:o,textHeight:f}=e.docView.measureTextSize(),i=0<t&&n.refresh(a,t,o,f,u/o,h))&&(e.docView.minWidth=0,l|=8),0<d&&0<r?c=Math.max(d,r):d<0&&r<0&&(c=Math.min(d,r)),n.heightChanged=!1;for(p of this.viewports){var g=p.from==this.viewport.from?h:e.docView.measureVisibleLineHeights(p);this.heightMap=(i?$.empty().applyChanges(this.stateDeco,_.Text.empty,this.heightOracle,[new G(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(n,0,i,new Fr(p.from,g))}n.heightChanged&&(l|=2)}a=!this.viewportIsAppropriate(this.viewport,c)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return a&&(2&l&&(l|=this.updateScaler()),this.viewport=this.getViewport(c,this.scrollTarget),l|=this.updateForViewport()),(2&l||a)&&this.updateViewportLines(),(this.lineGaps.length||4e3<this.viewport.to-this.viewport.from)&&this.updateLineGaps(this.ensureLineGaps(i?[]:this.lineGaps,e)),l|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),l}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,r){var e=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),n=this.heightMap,a=this.heightOracle,{visibleTop:i,visibleBottom:o}=this;let s=new qr(n.lineAt(i-1e3*e,b.ByHeight,a,0,0).from,n.lineAt(o+1e3*(1-e),b.ByHeight,a,0,0).to);if(r){i=r.range["head"];if(i<s.from||i>s.to){o=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top);let e=n.lineAt(i,b.ByPos,a,0,0),t;t="center"==r.y?(e.top+e.bottom)/2-o/2:"start"==r.y||"nearest"==r.y&&i<s.from?e.top:e.bottom-o,s=new qr(n.lineAt(t-500,b.ByHeight,a,0,0).from,n.lineAt(t+o+500,b.ByHeight,a,0,0).to)}}return s}mapViewport(e,t){var r=t.mapPos(e.from,-1),t=t.mapPos(e.to,1);return new qr(this.heightMap.lineAt(r,b.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(t,b.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},r=0){var n,a,i,o;return!this.inView||(n=this.heightMap.lineAt(e,b.ByPos,this.heightOracle,0,0)["top"],a=this.heightMap.lineAt(t,b.ByPos,this.heightOracle,0,0)["bottom"],{visibleTop:i,visibleBottom:o}=this,(0==e||n<=i-Math.max(10,Math.min(-r,250)))&&(t==this.state.doc.length||a>=o+Math.max(10,Math.min(r,250)))&&i-2e3<n&&a<o+2e3)}mapLineGaps(e,t){if(!e.length||t.empty)return e;var r,n=[];for(r of e)t.touchesRange(r.from,r.to)||n.push(new Gr(t.mapPos(r.from),t.mapPos(r.to),r.size));return n}ensureLineGaps(c,u){let d=this.heightOracle.lineWrapping,f=d?1e4:2e3,p=f>>1,e=f<<1;if(this.defaultTextDirection!=O.Direction.LTR&&!d)return[];let h=[],g=(n,a,i,o)=>{if(!(a-n<p)){let e=this.state.selection.main,r=[e.from];e.empty||r.push(e.to);for(var s of r)if(s>n&&s<a)return g(n,s-10,i,o),void g(s+10,a,i,o);let t=function(e,t){for(var r of e)if(t(r))return r;return}(c,t=>t.from>=i.from&&t.to<=i.to&&Math.abs(t.from-n)<p&&Math.abs(t.to-a)<p&&!r.some(e=>t.from<e&&t.to>e));var l;t||(a<i.to&&u&&d&&u.visibleRanges.some(e=>e.from<=a&&e.to>=a)&&(l=u.moveToLineBoundary(_.EditorSelection.cursor(a),!1,!0).head,n<l)&&(a=l),t=new Gr(n,a,this.gapSize(i,n,a,o))),h.push(t)}};var t,r=a=>{if(!(a.length<e||a.type!=O.BlockType.Text)){var i=function(e,t,r){let n=[],a=e,i=0;_.RangeSet.spans(r,e,t,{span(){},point(e,t){e>a&&(n.push({from:a,to:e}),i+=e-a),a=t}},20),a<t&&(n.push({from:a,to:t}),i+=t-a);return{total:i,ranges:n}}(a.from,a.to,this.stateDeco);if(!(i.total<e)){var o=this.scrollTarget?this.scrollTarget.range.head:null;let r,n;if(d){var s=f/this.heightOracle.lineLength*this.heightOracle.lineHeight;let e,t;t=null!=o?(l=pt(i,o),c=((this.visibleBottom-this.visibleTop)/2+s)/a.height,e=l-c,l+c):(e=(this.visibleTop-a.top-s)/a.height,(this.visibleBottom-a.top+s)/a.height),r=ft(i,e),n=ft(i,t)}else{var l=i.total*this.heightOracle.charWidth,c=f*this.heightOracle.charWidth;let e,t;t=null!=o?(s=pt(i,o),o=((this.pixelViewport.right-this.pixelViewport.left)/2+c)/l,e=s-o,s+o):(e=(this.pixelViewport.left-c)/l,(this.pixelViewport.right+c)/l),r=ft(i,e),n=ft(i,t)}r>a.from&&g(a.from,r,a,i),n<a.to&&g(n,a.to,a,i)}}};for(t of this.viewportLines)Array.isArray(t.type)?t.type.forEach(r):r(t);return h}gapSize(e,t,r,n){r=pt(n,r)-pt(n,t);return this.heightOracle.lineWrapping?e.height*r:n.total*this.heightOracle.charWidth*r}updateLineGaps(e){Gr.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=D.set(e.map(e=>e.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.stateDeco,r=(this.lineGaps.length&&(e=e.concat(this.lineGapDeco)),[]);_.RangeSet.spans(e,this.viewport.from,this.viewport.to,{span(e,t){r.push({from:e,to:t})},point(){}},20);var t=r.length!=this.visibleRanges.length||this.visibleRanges.some((e,t)=>e.from!=r[t].from||e.to!=r[t].to);return this.visibleRanges=r,t?4:0}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find(e=>e.from<=t&&e.to>=t)||ht(this.heightMap.lineAt(t,b.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(t){return t>=this.viewportLines[0].top&&t<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(e=>e.top<=t&&e.bottom>=t)||ht(this.heightMap.lineAt(this.scaler.fromDOM(t),b.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){var t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||200<this.viewportLines[0].top-e?t:this.viewportLines[0]}elementAtHeight(e){return ht(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class qr{constructor(e,t){this.from=e,this.to=t}}function ft({total:e,ranges:t},r){if(r<=0)return t[0].from;if(1<=r)return t[t.length-1].to;let n=Math.floor(e*r);for(let e=0;;e++){var{from:a,to:i}=t[e],i=i-a;if(n<=i)return a+n;n-=i}}function pt(e,t){let r=0;for(var{from:n,to:a}of e.ranges){if(t<=a){r+=t-n;break}r+=a-n}return r/e.total}const $r={toDOM(e){return e},fromDOM(e){return e},scale:1,eq(e){return e==this}};class zr{constructor(a,i,e){let o=0,t=0,r=0;this.viewports=e.map(({from:e,to:t})=>{var r=i.lineAt(e,b.ByPos,a,0,0).top,n=i.lineAt(t,b.ByPos,a,0,0).bottom;return o+=n-r,{from:e,to:t,top:r,bottom:n,domTop:0,domBottom:0}}),this.scale=(7e6-o)/(i.height-o);for(var n of this.viewports)n.domTop=r+(n.top-t)*this.scale,r=n.domBottom=n.domTop+(n.bottom-n.top),t=n.bottom}toDOM(n){for(let e=0,t=0,r=0;;e++){var a=e<this.viewports.length?this.viewports[e]:null;if(!a||n<a.top)return r+(n-t)*this.scale;if(n<=a.bottom)return a.domTop+(n-a.top);t=a.bottom,r=a.domBottom}}fromDOM(n){for(let e=0,t=0,r=0;;e++){var a=e<this.viewports.length?this.viewports[e]:null;if(!a||n<a.domTop)return t+(n-r)/this.scale;if(n<=a.domBottom)return a.top+(n-a.domTop);t=a.bottom,r=a.domBottom}}eq(r){return r instanceof zr&&this.scale==r.scale&&this.viewports.length==r.viewports.length&&this.viewports.every((e,t)=>e.from==r.viewports[t].from&&e.to==r.viewports[t].to)}}function ht(e,t){var r,n;return 1==t.scale?e:(r=t.toDOM(e.top),n=t.toDOM(e.bottom),new q(e.from,e.length,r,n-r,Array.isArray(e._content)?e._content.map(e=>ht(e,t)):e._content))}const Kr=_.Facet.define({combine:e=>e.join(" ")}),Yr=_.Facet.define({combine:e=>-1<e.indexOf(!0)}),Jr=Z.StyleModule.newName(),Zr=Z.StyleModule.newName(),Qr=Z.StyleModule.newName(),Xr={"&light":"."+Zr,"&dark":"."+Qr};function gt(t,e,r){return new Z.StyleModule(e,{finish(e){return/&/.test(e)?e.replace(/&\w*/,e=>{if("&"==e)return t;if(r&&r[e])return r[e];throw new RangeError("Unsupported selector: "+e)}):t+" "+e}})}const en=gt("."+Jr,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Xr),tn="￿";class rn{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(_.EditorState.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=tn}readRange(t,r){if(t){var n=t.parentNode;for(let e=t;;){this.findPointBefore(n,e);var a=this.text.length,i=(this.readNode(e),e.nextSibling);if(i==r)break;var o=k.get(e),s=k.get(i);(o&&s?o.breakAfter:(o?o.breakAfter:ae(e))||ae(i)&&("BR"!=e.nodeName||e.cmIgnore)&&this.text.length>a)&&this.lineBreak(),e=i}this.findPointBefore(n,r)}return this}readTextNode(i){var e,o=i.nodeValue;for(e of this.points)e.node==i&&(e.pos=this.text.length+Math.min(e.offset,o.length));for(let n=0,a=this.lineSeparator?null:/\r\n?|\n/g;;){let e=-1,t=1,r;if(this.lineSeparator?(e=o.indexOf(this.lineSeparator,n),t=this.lineSeparator.length):(r=a.exec(o))&&(e=r.index,t=r[0].length),this.append(o.slice(n,e<0?o.length:e)),e<0)break;if(this.lineBreak(),1<t)for(var s of this.points)s.node==i&&s.pos>this.text.length&&(s.pos-=t-1);n=e+t}}readNode(e){if(!e.cmIgnore){var t=k.get(e),t=t&&t.overrideDOMText;if(null!=t){this.findPointInside(e,t.length);for(var r=t.iter();!r.next().done;)r.lineBreak?this.lineBreak():this.append(r.value)}else 3==e.nodeType?this.readTextNode(e):"BR"==e.nodeName?e.nextSibling&&this.lineBreak():1==e.nodeType&&this.readRange(e.firstChild,null)}}findPointBefore(e,t){for(var r of this.points)r.node==e&&e.childNodes[r.offset]==t&&(r.pos=this.text.length)}findPointInside(e,t){for(var r of this.points)(3==e.nodeType?r.node==e:e.contains(r.node))&&(r.pos=this.text.length+(function(e,t,r){for(;;){if(!t||r<y(t))return;if(t==e)return 1;r=h(t)+1,t=t.parentNode}}(e,r.node,r.offset)?t:0))}}class nn{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class an{constructor(r,n,a,i){this.typeOver=i,this.bounds=null,this.text="",this.domChanged=-1<n;var{impreciseHead:i,impreciseAnchor:o}=r.docView;if(r.state.readOnly&&-1<n)this.newSel=null;else if(-1<n&&(this.bounds=r.docView.domBoundsAround(n,a,0))){var a=i||o?[]:(n=[],(a=r).root.activeElement==a.contentDOM&&({anchorNode:a,anchorOffset:e,focusNode:s,focusOffset:l}=a.observer.selectionRange,a)&&(n.push(new nn(a,e)),s==a&&l==e||n.push(new nn(s,l))),n),e=new rn(a,r.state);e.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=e.text,this.newSel=function(e,t){if(0==e.length)return null;var r=e[0].pos,e=2==e.length?e[1].pos:r;return-1<r&&-1<e?_.EditorSelection.single(r+t,e+t):null}(a,this.bounds.from)}else{var s=r.observer.selectionRange;let e=i&&i.node==s.focusNode&&i.offset==s.focusOffset||!ee(r.contentDOM,s.focusNode)?r.state.selection.main.head:r.docView.posFromDOM(s.focusNode,s.focusOffset),t=o&&o.node==s.anchorNode&&o.offset==s.anchorOffset||!ee(r.contentDOM,s.anchorNode)?r.state.selection.main.anchor:r.docView.posFromDOM(s.anchorNode,s.anchorOffset);var l=r.viewport;(S.ios||S.chrome)&&r.state.selection.main.empty&&e!=t&&(0<l.from||l.to<r.state.doc.length)&&(n=Math.min(e,t),a=Math.max(e,t),i=l.from-n,o=l.to-a,0!=i&&1!=i&&0!=n||0!=o&&-1!=o&&a!=r.state.doc.length||(e=0,t=r.state.doc.length)),this.newSel=_.EditorSelection.single(t,e)}}}function mt(r,n){let a,i=n["newSel"],o=r.state.selection.main;var s=r.inputState.lastKeyTime>Date.now()-100?r.inputState.lastKeyCode:-1;if(n.bounds){var{from:l,to:c}=n.bounds;let e=o.from,t=null;(8===s||S.android&&n.text.length<c-l)&&(e=o.to,t="end");c=function(e,t,r,n){let a=Math.min(e.length,t.length),i=0;for(;i<a&&e.charCodeAt(i)==t.charCodeAt(i);)i++;if(i==a&&e.length==t.length)return null;let o=e.length,s=t.length;for(;0<o&&0<s&&e.charCodeAt(o-1)==t.charCodeAt(s-1);)o--,s--;"end"==n&&(n=Math.max(0,i-Math.min(o,s)),r-=o+n-i);o<i&&e.length<t.length?(n=r<=i&&r>=o?i-r:0,i-=n,s=i+(s-o),o=i):s<i&&(n=r<=i&&r>=s?i-r:0,i-=n,o=i+(o-s),s=i);return{from:i,toA:o,toB:s}}(r.state.doc.sliceString(l,c,tn),n.text,e-l,t);c&&(S.chrome&&13==s&&c.toB==c.from+2&&n.text.slice(c.from,c.toB)==tn+tn&&c.toB--,a={from:l+c.from,to:l+c.toA,insert:_.Text.of(n.text.slice(c.from,c.toB).split(tn))})}else i&&(!r.hasFocus&&r.state.facet(j)||i.main.eq(o))&&(i=null);if(!a&&!i)return!1;if(!a&&n.typeOver&&!o.empty&&i&&i.main.empty?a={from:o.from,to:o.to,insert:r.state.doc.slice(o.from,o.to)}:a&&a.from>=o.from&&a.to<=o.to&&(a.from!=o.from||a.to!=o.to)&&o.to-o.from-(a.to-a.from)<=4?a={from:o.from,to:o.to,insert:r.state.doc.slice(o.from,a.from).append(a.insert).append(r.state.doc.slice(a.to,o.to))}:(S.mac||S.android)&&a&&a.from==a.to&&a.from==o.head-1&&/^\. ?$/.test(a.insert.toString())&&"off"==r.contentDOM.getAttribute("autocorrect")?(i&&2==a.insert.length&&(i=_.EditorSelection.single(i.main.anchor-1,i.main.head-1)),a={from:o.from,to:o.to,insert:_.Text.of([" "])}):S.chrome&&a&&a.from==a.to&&a.from==o.head&&"\n "==a.insert.toString()&&r.lineWrapping&&(i=i&&_.EditorSelection.single(i.main.anchor-1,i.main.head-1),a={from:o.from,to:o.to,insert:_.Text.of([" "])}),a)return _t(r,a,i,s);if(!i||i.main.eq(o))return!1;{let e=!1,t="select";return r.inputState.lastSelectionTime>Date.now()-50&&("select"==r.inputState.lastSelectionOrigin&&(e=!0),t=r.inputState.lastSelectionOrigin),r.dispatch({selection:i,scrollIntoView:e,userEvent:t}),!0}}function _t(n,a,i,e=-1){if(!S.ios||!n.inputState.flushIOSKey(a)){var t=n.state.selection.main;if(!S.android||!(a.to==t.to&&(a.from==t.from||a.from==t.from-1&&" "==n.state.sliceDoc(a.from,t.from))&&1==a.insert.length&&2==a.insert.lines&&ce(n.contentDOM,"Enter",13)||(a.from==t.from-1&&a.to==t.to&&0==a.insert.length||8==e&&a.insert.length<a.to-a.from&&a.to>t.head)&&ce(n.contentDOM,"Backspace",8)||a.from==t.from&&a.to==t.to+1&&0==a.insert.length&&ce(n.contentDOM,"Delete",46))){let t=a.insert.toString();0<=n.inputState.composing&&n.inputState.composing++;let e,r=()=>e=e||function(c,u,t){let r,d=c.state,f=d.selection.main;if(u.from>=f.from&&u.to<=f.to&&u.to-u.from>=(f.to-f.from)/3&&(!t||t.main.empty&&t.main.from==u.from+u.insert.length)&&c.inputState.composing<0){var p=f.from<u.from?d.sliceDoc(f.from,u.from):"",e=f.to>u.to?d.sliceDoc(u.to,f.to):"";r=d.replaceSelection(c.state.toText(p+u.insert.sliceString(0,void 0,c.state.lineBreak)+e))}else{let s=d.changes(u),l=t&&t.main.to<=s.newLength?t.main:void 0;if(1<d.selection.ranges.length&&0<=c.inputState.composing&&u.to<=f.to&&u.to>=f.to-10){let n=c.state.sliceDoc(u.from,u.to),a,e=t&&We(c,t.main.head);a=e?(p=u.insert.length-(u.to-u.from),{from:e.from,to:e.to-p}):c.state.doc.lineAt(f.head);let i=f.to-u.to,o=f.to-f.from;r=d.changeByRange(e=>{var t,r;return e.from==f.from&&e.to==f.to?{changes:s,range:l||e.map(s)}:(t=(r=e.to-i)-n.length,e.to-e.from!=o||c.state.sliceDoc(t,r)!=n||e.to>=a.from&&e.from<=a.to?{range:e}:(t=d.changes({from:t,to:r,insert:u.insert}),r=e.to-f.to,{changes:t,range:l?_.EditorSelection.range(Math.max(0,l.anchor+r),Math.max(0,l.head+r)):e.map(t)}))})}else r={changes:s,selection:l&&d.selection.replaceRange(l)}}let n="input.type";(c.composing||c.inputState.compositionPendingChange&&c.inputState.compositionEndedAt>Date.now()-50)&&(c.inputState.compositionPendingChange=!1,n+=".compose",c.inputState.compositionFirstChange)&&(n+=".start",c.inputState.compositionFirstChange=!1);return d.update(r,{userEvent:n,scrollIntoView:!0})}(n,a,i);n.state.facet(ir).some(e=>e(n,a.from,a.to,t,r))||n.dispatch(r())}}return!0}const on={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},sn=S.ie&&S.ie_version<=11;class ln{constructor(r){this.view=r,this.active=!1,this.editContext=null,this.selectionRange=new jt,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=r.contentDOM,this.observer=new MutationObserver(e=>{for(var t of e)this.queue.push(t);(S.ie&&S.ie_version<=11||S.ios&&r.composing)&&e.some(e=>"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length)?this.flushSoon():this.flush()}),!window.EditContext||!1===r.constructor.EDIT_CONTEXT||S.chrome&&S.chrome_version<126||(this.editContext=new cn(r),r.state.facet(j)&&(r.contentDOM.editContext=this.editContext.editContext)),sn&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),"function"==typeof ResizeObserver&&(this.resizeScroll=new ResizeObserver(()=>{var e;(null==(e=this.view.docView)?void 0:e.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(r.scrollDOM)),this.addWindowListeners(this.win=r.win),this.start(),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver(e=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),0<e.length&&0<e[e.length-1].intersectionRatio!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView)&&this.onScrollChanged(document.createEvent("Event"))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(e=>{0<e.length&&0<e[e.length-1].intersectionRatio&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){"change"==e.type&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(r){if(this.gapIntersection&&(r.length!=this.gaps.length||this.gaps.some((e,t)=>e!=r[t]))){this.gapIntersection.disconnect();for(var e of r)this.gapIntersection.observe(e);this.gaps=r}}onSelectionChange(e){var t,r,n,a=this.selectionChanged;this.readSelectionRange()&&!this.delayedAndroidKey&&(t=this.view,r=this.selectionRange,t.state.facet(j)?t.root.activeElement==this.dom:te(t.dom,r))&&((n=r.anchorNode&&t.docView.nearest(r.anchorNode))&&n.ignoreEvent(e)?a||(this.selectionChanged=!1):(S.ie&&S.ie_version<=11||S.android&&S.chrome)&&!t.state.selection.main.empty&&r.focusNode&&ne(r.focusNode,r.focusOffset,r.anchorNode,r.anchorOffset)?this.flushSoon():this.flush(!1))}readSelectionRange(){var e,t=this["view"],r=X(t.root);return!!r&&!(!(r=S.safari&&11==t.root.nodeType&&function(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}(this.dom.ownerDocument)==this.dom&&function(e,t){if(t.getComposedRanges){t=t.getComposedRanges(e.root)[0];if(t)return Tt(e,t)}let r=null;function n(e){e.preventDefault(),e.stopImmediatePropagation(),r=e.getTargetRanges()[0]}return e.contentDOM.addEventListener("beforeinput",n,!0),e.dom.ownerDocument.execCommand("indent"),e.contentDOM.removeEventListener("beforeinput",n,!0),r?Tt(e,r):null}(this.view,r)||r)||this.selectionRange.eq(r)||((e=te(this.dom,r))&&!this.selectionChanged&&t.inputState.lastFocusTime>Date.now()-200&&t.inputState.lastTouchTime<Date.now()-300&&function(e,t){let r=t.focusNode,n=t.focusOffset;if(r&&t.anchorNode==r&&t.anchorOffset==n)for(n=Math.min(n,y(r));;)if(n){if(1!=r.nodeType)return;var a=r.childNodes[n-1];"false"==a.contentEditable?n--:(r=a,n=y(r))}else{if(r==e)return 1;n=h(r),r=r.parentNode}}(this.dom,r)?(this.view.inputState.lastFocusTime=0,t.docView.updateSelection(),1):(this.selectionRange.setRange(r),e&&(this.selectionChanged=!0),0)))}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,r=null;for(let e=this.dom;e;)if(1==e.nodeType)!r&&t<this.scrollTargets.length&&this.scrollTargets[t]==e?t++:r=r||this.scrollTargets.slice(0,t),r&&r.push(e),e=e.assignedSlot||e.parentNode;else{if(11!=e.nodeType)break;e=e.host}if(r=t<this.scrollTargets.length&&!r?this.scrollTargets.slice(0,t):r){for(var e of this.scrollTargets)e.removeEventListener("scroll",this.onScroll);for(var n of this.scrollTargets=r)n.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,on),sn&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),sn)&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData)}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){this.delayedAndroidKey||(this.flushingAndroidKey=this.view.win.requestAnimationFrame(()=>{var e=this.delayedAndroidKey;e&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=e.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush())&&e.force&&ce(this.dom,e.key,e.keyCode)})),this.delayedAndroidKey&&"Enter"!=e||(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!(null==(e=this.delayedAndroidKey)||!e.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){0<=this.delayedFlush&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(var e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){var e,t=this.pendingRecords();t.length&&(this.queue=[]);let r=-1,n=-1,a=!1;for(e of t){var i=this.readMutation(e);i&&(i.typeOver&&(a=!0),-1==r?{from:r,to:n}=i:(r=Math.min(i.from,r),n=Math.max(i.to,n)))}return{from:r,to:n,typeOver:a}}readChange(){var{from:e,to:t,typeOver:r}=this.processRecords(),n=this.selectionChanged&&te(this.dom,this.selectionRange);if(e<0&&!n)return null;-1<e&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;n=new an(this.view,e,t,r);return this.view.docView.domChanged={newSel:n.newSel?n.newSel.main:null},n}flush(e=!0){if(0<=this.delayedFlush||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();var t,r,e=this.readChange();return e?(t=this.view.state,r=mt(this.view,e),this.view.state==t&&(e.domChanged||e.newSel&&!e.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),r):(this.view.requestMeasure(),!1)}readMutation(e){var t,r,n=this.view.docView.nearest(e.target);return!n||n.ignoreMutation(e)?null:(n.markDirty("attributes"==e.type),"attributes"==e.type&&(n.flags|=4),"childList"==e.type?(t=yt(n,e.previousSibling||e.target.previousSibling,-1),r=yt(n,e.nextSibling||e.target.nextSibling,1),{from:t?n.posAfter(t):n.posAtStart,to:r?n.posBefore(r):n.posAtEnd,typeOver:!1}):"characterData"==e.type?{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null)}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener("change",this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener("change",this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(j)!=e.state.facet(j))&&(e.view.contentDOM.editContext=e.state.facet(j)?this.editContext.editContext:null)}destroy(){var e,t;this.stop(),null!=(e=this.intersection)&&e.disconnect(),null!=(e=this.gapIntersection)&&e.disconnect(),null!=(e=this.resizeScroll)&&e.disconnect();for(t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}}function yt(e,t,r){for(;t;){var n=k.get(t);if(n&&n.parent==e)return n;n=t.parentNode;t=n!=e.dom?n:0<r?t.nextSibling:t.previousSibling}return null}function Tt(e,t){let r=t.startContainer,n=t.startOffset,a=t.endContainer,i=t.endOffset;t=e.docView.domAtPos(e.state.selection.main.anchor);return ne(t.node,t.offset,a,i)&&([r,n,a,i]=[a,i,r,n]),{anchorNode:r,anchorOffset:n,focusNode:a,focusOffset:i}}class cn{constructor(o){this.from=0,this.to=0,this.pendingContextChange=null,this.resetRange(o.state);let e=this.editContext=new window.EditContext({text:o.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,o.state.selection.main.anchor))),selectionEnd:this.toContextPos(o.state.selection.main.head)});e.addEventListener("textupdate",e=>{var t=o.state.selection.main["anchor"],r={from:this.toEditorPos(e.updateRangeStart),to:this.toEditorPos(e.updateRangeEnd),insert:_.Text.of(e.text.split("\n"))};r.from==this.from&&t<this.from?r.from=t:r.to==this.to&&t>this.to&&(r.to=t),(r.from!=r.to||r.insert.length)&&(this.pendingContextChange=r,_t(o,r,_.EditorSelection.single(this.toEditorPos(e.selectionStart),this.toEditorPos(e.selectionEnd))),this.pendingContextChange)&&this.revertPending(o.state)}),e.addEventListener("characterboundsupdate",r=>{let n=[],a=null;for(let e=this.toEditorPos(r.rangeStart),t=this.toEditorPos(r.rangeEnd);e<t;e++){var i=o.coordsForChar(e);a=i&&new DOMRect(i.left,i.right,i.right-i.left,i.bottom-i.top)||a||new DOMRect,n.push(a)}e.updateCharacterBounds(r.rangeStart,n)}),e.addEventListener("textformatupdate",e=>{var t,r=[];for(t of e.getTextFormats()){var n=t.underlineStyle,a=t.underlineThickness;"None"!=n&&"None"!=a&&(n=`text-decoration: underline ${"Dashed"==n?"dashed ":"Squiggle"==n?"wavy ":""}${"Thin"==a?1:2}px`,r.push(D.mark({attributes:{style:n}}).range(this.toEditorPos(t.rangeStart),this.toEditorPos(t.rangeEnd))))}o.dispatch({effects:fr.of(D.set(r))})}),e.addEventListener("compositionstart",()=>{o.inputState.composing<0&&(o.inputState.composing=0,o.inputState.compositionFirstChange=!0)}),e.addEventListener("compositionend",()=>{o.inputState.composing=-1,o.inputState.compositionFirstChange=null}),this.measureReq={read:e=>{this.editContext.updateControlBounds(e.contentDOM.getBoundingClientRect());e=X(e.root);e&&e.rangeCount&&this.editContext.updateSelectionBounds(e.getRangeAt(0).getBoundingClientRect())}}}applyEdits(o){let s=0,l=!1,c=this.pendingContextChange;return o.changes.iterChanges((e,t,r,n,a)=>{if(!l){var i=a.length-(t-e);if(c&&t>=c.to){if(c.from==e&&c.to==t&&c.insert.eq(a))return c=this.pendingContextChange=null,void(s+=i);c=null,this.revertPending(o.state)}if(e+=s,(t+=s)<=this.from)this.from+=i,this.to+=i;else if(e<this.to){if(e<this.from||t>this.to||3e4<this.to-this.from+a.length)return void(l=!0);this.editContext.updateText(this.toContextPos(e),this.toContextPos(t),a.toString()),this.to+=i}s+=i}}),c&&!l&&this.revertPending(o.state),!l}update(e){this.applyEdits(e)&&this.rangeIsValid(e.state)?(e.docChanged||e.selectionSet)&&this.setSelection(e.state):(this.pendingContextChange=null,this.resetRange(e.state),this.editContext.updateText(0,this.editContext.text.length,e.state.doc.sliceString(this.from,this.to)),this.setSelection(e.state)),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){var t=e.selection.main["head"];this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}revertPending(e){var t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.to+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){var e=e.selection["main"],t=this.toContextPos(Math.max(this.from,Math.min(this.to,e.anchor))),e=this.toContextPos(e.head);this.editContext.selectionStart==t&&this.editContext.selectionEnd==e||this.editContext.updateSelection(t,e)}rangeIsValid(e){var t=e.selection.main["head"];return!(0<this.from&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||3e4<this.to-this.from)}toEditorPos(e){return e+this.from}toContextPos(e){return e-this.from}}class Y{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return 0<this.inputState.composing}get compositionStarted(){return 0<=this.inputState.composing}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let t=e["dispatch"];this.dispatchTransactions=e.dispatchTransactions||(t?e=>e.forEach(e=>t(e,this)):e=>this.update(e)),this.dispatch=this.dispatch.bind(this),this._root=e.root||function(e){for(;e;){if(e&&(9==e.nodeType||11==e.nodeType&&e.host))return e;e=e.assignedSlot||e.parentNode}return null}(e.parent)||document,this.viewState=new Wr(e.state||_.EditorState.create(e)),e.scrollTo&&e.scrollTo.is(dr)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(pr).map(e=>new hr(e));for(var r of this.plugins)r.update(this);this.observer=new ln(this),this.inputState=new Cr(this),this.inputState.ensureHandlers(this.plugins),this.docView=new Ar(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure()}dispatch(...e){e=1==e.length&&e[0]instanceof _.Transaction?e:1==e.length&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(e,this)}update(o){if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let s=!1,l=!1,c,u=this.state;for(var e of o){if(e.startState!=u)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");u=e.state}if(this.destroyed)this.viewState.state=u;else{let e=this.hasFocus,t=0,r=null,n=(o.some(e=>e.annotation(Nr))?(this.inputState.notifiedFocused=e,t=1):e==this.inputState.notifiedFocused||(this.inputState.notifiedFocused=e,r=ct(u,e))||(t=1),this.observer.delayedAndroidKey),a=null;if(n?(this.observer.clearDelayedAndroidKey(),(!(a=this.observer.readChange())||this.state.doc.eq(u.doc))&&this.state.selection.eq(u.selection)||(a=null)):this.observer.clear(),u.facet(_.EditorState.phrases)!=this.state.facet(_.EditorState.phrases))return this.setState(u);(c=Sr.create(this,u,o)).flags|=t;let i=this.viewState.scrollTarget;try{this.updateState=2;for(var d of o){var f,p;i=i&&i.map(d.changes),d.scrollIntoView&&(f=d.state.selection["main"],i=new ur(f.empty?f:_.EditorSelection.cursor(f.head,f.head>f.anchor?-1:1)));for(p of d.effects)p.is(dr)&&(i=p.value.clip(this.state))}this.viewState.update(c,i),this.bidiCache=fn.update(this.bidiCache,c.changes),c.empty||(this.updatePlugins(c),this.inputState.update(c)),s=this.docView.update(c),this.state.facet(Er)!=this.styleModules&&this.mountStyles(),l=this.updateAttrs(),this.showAnnouncements(o),this.docView.updateSelection(s,o.some(e=>e.isUserEvent("select.pointer")))}finally{this.updateState=0}if(c.startState.facet(Kr)!=c.state.facet(Kr)&&(this.viewState.mustMeasureContent=!0),(s||l||i||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),s&&this.docViewUpdate(),!c.empty)for(var h of this.state.facet(ar))try{h(c)}catch(e){A(this.state,e,"update listener")}(r||a)&&Promise.resolve().then(()=>{r&&this.state==r.startState&&this.dispatch(r),a&&!mt(this,a)&&n.force&&ce(this.contentDOM,n.key,n.keyCode)})}}setState(e){if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)this.viewState.state=e;else{this.updateState=2;var t=this.hasFocus;try{for(var r of this.plugins)r.destroy(this);this.viewState=new Wr(e),this.plugins=e.facet(pr).map(e=>new hr(e)),this.pluginMap.clear();for(var n of this.plugins)n.update(this);this.docView.destroy(),this.docView=new Ar(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}}updatePlugins(e){var t=e.startState.facet(pr),r=e.state.facet(pr);if(t!=r){var n,a,i=[];for(n of r){var o=t.indexOf(n);o<0?i.push(new hr(n)):((o=this.plugins[o]).mustUpdate=e,i.push(o))}for(a of this.plugins)a.mustUpdate!=e&&a.destroy(this);this.plugins=i,this.pluginMap.clear()}else for(var s of this.plugins)s.mustUpdate=e;for(let e=0;e<this.plugins.length;e++)this.plugins[e].update(this);t!=r&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(var e of this.plugins){e=e.value;if(e&&e.docViewUpdate)try{e.docViewUpdate(this)}catch(e){A(this.state,e,"doc view update listener")}}}measure(e=!0){if(!this.destroyed)if(-1<this.measureScheduled&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey)this.measureScheduled=-1,this.requestMeasure();else{this.measureScheduled=0,e&&this.observer.forceFlush();let a=null,i=this.scrollDOM,o=i.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:l}=this.viewState;1<Math.abs(o-this.viewState.scrollTop)&&(l=-1),this.viewState.scrollAnchorHeight=-1;try{for(let n=0;;n++){l<0&&(l=de(i)?(s=-1,this.viewState.heightMap.height):(c=this.viewState.scrollAnchorAt(o),s=c.from,c.top)),this.updateState=1;var c,u=this.viewState.measure(this);if(!u&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(5<n){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let t=[];4&u||([this.measureRequests,t]=[t,this.measureRequests]);var d=t.map(e=>{try{return e.read(this)}catch(e){return A(this.state,e),dn}});let e=Sr.create(this,this.state,[]),r=!1;e.flags|=u,a?a.flags|=u:a=e,this.updateState=2,!e.empty&&(this.updatePlugins(e),this.inputState.update(e),this.updateAttrs(),r=this.docView.update(e))&&this.docViewUpdate();for(let e=0;e<t.length;e++)if(d[e]!=dn)try{var f=t[e];f.write&&f.write(d[e],this)}catch(e){A(this.state,e)}if(r&&this.docView.updateSelection(!0),!e.viewportChanged&&0==this.measureRequests.length){if(this.viewState.editorHeight){if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,l=-1;continue}var p=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-l;if(1<p||p<-1){o+=p,i.scrollTop=o/this.scaleY,l=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(a&&!a.empty)for(var t of this.state.facet(ar))t(a)}}get themeClasses(){return Jr+" "+(this.state.facet(Yr)?Qr:Zr)+" "+this.state.facet(Kr)}updateAttrs(){let r=bt(this,gr,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),n={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(j)?"true":"false",class:"cm-content",style:S.tabSize+": "+this.state.tabSize,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(n["aria-readonly"]="true"),bt(this,mr,n);var e=this.observer.ignore(()=>{var e=Ie(this.contentDOM,this.contentAttrs,n),t=Ie(this.dom,this.editorAttrs,r);return e||t});return this.editorAttrs=r,this.contentAttrs=n,e}showAnnouncements(e){let t=!0;for(var r of e)for(var n of r.effects)n.is(Y.announce)&&(t&&(this.announceDOM.textContent=""),t=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=n.value)}mountStyles(){this.styleModules=this.state.facet(Er);var e=this.state.facet(Y.cspNonce);Z.StyleModule.mount(this.root,this.styleModules.concat(en).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&-1<this.measureScheduled&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),t&&!(-1<this.measureRequests.indexOf(t))){if(null!=t.key)for(let e=0;e<this.measureRequests.length;e++)if(this.measureRequests[e].key===t.key)return void(this.measureRequests[e]=t);this.measureRequests.push(t)}}plugin(t){let e=this.pluginMap.get(t);return(void 0===e||e&&e.spec!=t)&&this.pluginMap.set(t,e=this.plugins.find(e=>e.spec==t)||null),e&&e.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,r){return tt(this,e,Xe(this,e,t,r))}moveByGroup(i,e){return tt(this,i,Xe(this,i,e,e=>{{var n=this,a=i.head;let t=n.state.charCategorizer(a),r=t(e);return e=>{e=t(e);return(r=r==_.CharCategory.Space?e:r)==e}}}))}visualLineSide(e,t){var r=this.bidiSpans(e),n=this.textDirectionAt(e.from),r=r[t?r.length-1:0];return _.EditorSelection.cursor(r.side(t,n)+e.from,r.forward(!t,n)?1:-1)}moveToLineBoundary(e,t,r=!0){var n=Qe(i=this,(e=e).head);if(r=r&&n.type==O.BlockType.Text&&(i.lineWrapping||n.widgetLineBreaks)?i.coordsAtPos(e.assoc<0&&e.head>n.from?e.head-1:e.head):null){var e=i.dom.getBoundingClientRect(),a=i.textDirectionAt(n.from),i=i.posAtCoords({x:t==(a==O.Direction.LTR)?e.right-1:e.left+1,y:(r.top+r.bottom)/2});if(null!=i)return _.EditorSelection.cursor(i,t?-1:1)}return _.EditorSelection.cursor(t?n.to:n.from,t?-1:1)}moveVertically(e,t,r){return tt(this,e,function(t,e,r,n){var a=e.head,i=r?1:-1;if(a==(r?t.state.doc.length:0))return _.EditorSelection.cursor(a,e.assoc);let o=e.goalColumn,s;var l=t.contentDOM.getBoundingClientRect(),r=t.coordsAtPos(a,e.assoc||-1),e=t.documentTop,c=(s=r?(null==o&&(o=r.left-l.left),i<0?r.top:r.bottom):(r=t.viewState.lineBlockAt(a),null==o&&(o=Math.min(l.right-l.left,t.defaultCharacterWidth*(a-r.from))),(i<0?r.top:r.bottom)+e),l.left+o),u=null!=n?n:t.viewState.heightOracle.textHeight>>1;for(let e=0;;e+=10){var d,f=s+(u+e)*i,p=Je(t,{x:c,y:f},!1,i);if(f<l.top||f>l.bottom||(i<0?p<a:a<p))return f=!(d=t.docView.coordsForChar(p))||f<d.top?-1:1,_.EditorSelection.cursor(p,f,void 0,o)}}(this,e,t,r))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),Je(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();var r,n,a=this.docView.coordsAt(e,t);return a&&a.left!=a.right?(r=this.state.doc.lineAt(e),oe(a,(n=this.bidiSpans(r))[U.find(n,e-r.from,-1,t)].dir==O.Direction.LTR==0<t)):a}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(sr)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>un)return je(e.length);let t=this.textDirectionAt(e.from),r;for(var n of this.bidiCache)if(n.from==e.from&&n.dir==t&&(n.fresh||function t(r,n){if(r.length==n.length){for(let e=0;e<r.length;e++){var a=r[e],i=n[e];if(a.from!=i.from||a.to!=i.to||a.direction!=i.direction||!t(a.inner,i.inner))return}return 1}}(n.isolates,r=Ge(this,e))))return n.order;r=r||Ge(this,e);var a=Be(e.text,t,r);return this.bidiCache.push(new fn(e.from,e.to,t,r,!0,a)),a}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||S.safari&&(null==(e=this.inputState)?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{le(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((9==e.nodeType?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(var e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),-1<this.measureScheduled&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return dr.of(new ur("number"==typeof e?_.EditorSelection.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){var{scrollTop:e,scrollLeft:t}=this.scrollDOM,r=this.viewState.scrollAnchorAt(e);return dr.of(new ur(_.EditorSelection.cursor(r.from),"start","start",r.top-e,t,!0))}setTabFocusMode(e){null==e?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:"boolean"==typeof e?this.inputState.tabFocusMode=e?0:-1:0!=this.inputState.tabFocusMode&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return H.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return H.define(()=>({}),{eventObservers:e})}static theme(e,t){var r=Z.StyleModule.newName(),r=[Kr.of(r),Er.of(gt("."+r,e))];return t&&t.dark&&r.push(Yr.of(!0)),r}static baseTheme(e){return _.Prec.lowest(Er.of(gt("."+Jr,e,Xr)))}static findFromDOM(e){var t=e.querySelector(".cm-content"),t=t&&k.get(t)||k.get(e);return(null==(e=null==t?void 0:t.rootView)?void 0:e.view)||null}}Y.styleModule=Er,Y.inputHandler=ir,Y.scrollHandler=cr,Y.focusChangeEffect=or,Y.perLineTextDirection=sr,Y.exceptionSink=nr,Y.updateListener=ar,Y.editable=j,Y.mouseSelectionStyle=rr,Y.dragMovesSelection=tr,Y.clickAddsSelectionRange=er,Y.decorations=_r,Y.outerDecorations=yr,Y.atomicRanges=Tr,Y.bidiIsolatedRanges=br,Y.scrollMargins=vr,Y.darkTheme=Yr,Y.cspNonce=_.Facet.define({combine:e=>e.length?e[0]:""}),Y.contentAttributes=mr,Y.editorAttributes=gr,Y.lineWrapping=Y.contentAttributes.of({class:"cm-lineWrapping"}),Y.announce=_.StateEffect.define();const un=4096,dn={};class fn{constructor(e,t,r,n,a,i){this.from=e,this.to=t,this.dir=r,this.isolates=n,this.fresh=a,this.order=i}static update(t,r){if(r.empty&&!t.some(e=>e.fresh))return t;var n=[],a=t.length?t[t.length-1].dir:O.Direction.LTR;for(let e=Math.max(0,t.length-10);e<t.length;e++){var i=t[e];i.dir!=a||r.touchesRange(i.from,i.to)||n.push(new fn(r.mapPos(i.from,1),r.mapPos(i.to,-1),i.dir,i.isolates,!1,i.order))}return n}}function bt(r,n,a){for(let e=r.state.facet(n),t=e.length-1;0<=t;t--){var i=e[t],i="function"==typeof i?i(r):i;i&&we(i,a)}return a}const pn=S.mac?"mac":S.windows?"win":S.linux?"linux":"key";function vt(e,t,r){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),e=!1!==r&&t.shiftKey?"Shift-"+e:e}Te=_.Prec.default(Y.domEventHandlers({keydown(e,t){return St(Et(t.state),e,t,"editor")}}));const hn=_.Facet.define({enables:Te}),gn=new WeakMap;function Et(e){e=e.facet(hn);let t=gn.get(e);return t||gn.set(e,t=function(e,c=pn){let s=Object.create(null),n=Object.create(null),l=(e,t)=>{var r=n[e];if(null==r)n[e]=t;else if(r!=t)throw new Error("Key binding "+e+" is used both as a regular binding and as a multi-stroke prefix")},t=(n,e,t,r,a)=>{var i=s[n]||(s[n]=Object.create(null)),o=e.split(/ (?!$)/).map(i=>{{var o=c,s=i.split(/-(?!$)/);let e=s[s.length-1];"Space"==e&&(e=" ");let t,r,n,a;for(let e=0;e<s.length-1;++e){var l=s[e];if(/^(cmd|meta|m)$/i.test(l))a=!0;else if(/^a(lt)?$/i.test(l))t=!0;else if(/^(c|ctrl|control)$/i.test(l))r=!0;else if(/^s(hift)?$/i.test(l))n=!0;else{if(!/^mod$/i.test(l))throw new Error("Unrecognized modifier name: "+l);"mac"==o?a=!0:r=!0}}return t&&(e="Alt-"+e),r&&(e="Ctrl-"+e),a&&(e="Meta-"+e),e=n?"Shift-"+e:e}});for(let e=1;e<o.length;e++){let r=o.slice(0,e).join(" ");l(r,!0),i[r]||(i[r]={preventDefault:!0,stopPropagation:!1,run:[e=>{let t=g={view:e,prefix:r,scope:n};return setTimeout(()=>{g==t&&(g=null)},mn),!0}]})}var e=o.join(" "),e=(l(e,!1),i[e]||(i[e]={preventDefault:!1,stopPropagation:!1,run:(null==(e=null==(e=i._any)?void 0:e.run)?void 0:e.slice())||[]}));t&&e.run.push(t),r&&(e.preventDefault=!0),a&&(e.stopPropagation=!0)};for(var r of e){var a=r.scope?r.scope.split(" "):["editor"];if(r.any)for(var i of a){var o,u=s[i]||(s[i]=Object.create(null));u._any||(u._any={preventDefault:!1,stopPropagation:!1,run:[]});let t=r["any"];for(o in u)u[o].run.push(e=>t(e,m))}var d=r[c]||r.key;if(d)for(var f of a)t(f,d,r.run,r.preventDefault,r.stopPropagation),r.shift&&t(f,"Shift-"+d,r.shift,r.preventDefault,r.stopPropagation)}return s}(e.reduce((e,t)=>e.concat(t),[]))),t}let g=null;const mn=4e3;let m=null;function St(e,t,r,n){m=t;var a=Q.keyName(t),i=_.codePointAt(a,0),i=_.codePointSize(i)==a.length&&" "!=a;let o="",s=!1,l=!1,c=!1,u=(g&&g.view==r&&g.scope==n&&(o=g.prefix+" ",Rr.indexOf(t.keyCode)<0)&&(l=!0,g=null),new Set);var d=e=>{if(e){for(var t of e.run)if(!u.has(t)&&(u.add(t),t(r)))return e.stopPropagation&&(c=!0),!0;e.preventDefault&&(e.stopPropagation&&(c=!0),l=!0)}return!1};let f=e[n],p,h;return f&&(d(f[o+vt(a,t,!i)])?s=!0:i&&(t.altKey||t.metaKey||t.ctrlKey)&&!(S.windows&&t.ctrlKey&&t.altKey)&&(p=Q.base[t.keyCode])&&p!=a?(d(f[o+vt(p,t,!0)])||t.shiftKey&&(h=Q.shift[t.keyCode])!=a&&h!=p&&d(f[o+vt(h,t,!1)]))&&(s=!0):i&&t.shiftKey&&d(f[o+vt(a,t,!0)])&&(s=!0),!s)&&d(f._any)&&(s=!0),(s=l?!0:s)&&c&&t.stopPropagation(),m=null,s}class _n{constructor(e,t,r,n,a){this.className=e,this.left=t,this.top=r,this.width=n,this.height=a}draw(){var e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className==this.className&&(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",null!=this.width&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(d,f,p){var h;if(p.empty)return(h=d.coordsAtPos(p.head,p.assoc||1))?(b=At(d),[new _n(f,h.left-b.left,h.top-b.top,null,h.bottom-h.top)]):[];{var T=d;var g=f;var b=p;if(b.to<=T.viewport.from||b.from>=T.viewport.to)return[];let e=Math.max(b.from,T.viewport.from),t=Math.min(b.to,T.viewport.to),m=T.textDirection==O.Direction.LTR,r=T.contentDOM,n=r.getBoundingClientRect(),a=At(T),i=r.querySelector(".cm-line"),o=i&&window.getComputedStyle(i),_=n.left+(o?parseInt(o.paddingLeft)+Math.min(0,parseInt(o.textIndent)):0),y=n.right-(o?parseInt(o.paddingRight):0),s=Qe(T,e),l=Qe(T,t),c=s.type==O.BlockType.Text?s:null,u=l.type==O.BlockType.Text?l:null;c&&(T.lineWrapping||s.widgetLineBreaks)&&(c=Ot(T,e,1,c));u&&(T.lineWrapping||l.widgetLineBreaks)&&(u=Ot(T,t,-1,u));return c&&u&&c.from==u.from&&c.to==u.to?E(S(b.from,b.to,c)):(h=c?S(b.from,null,c):A(s,!1),b=u?S(null,b.to,u):A(l,!0),d=[],(c||s).to<(u||l).from-(c&&u?1:0)||1<s.widgetLineBreaks&&h.bottom+T.defaultLineHeight/2<b.top?d.push(v(_,h.bottom,y,b.top)):h.bottom<b.top&&T.elementAtHeight((h.bottom+b.top)/2).type==O.BlockType.Text&&(h.bottom=b.top=(h.bottom+b.top)/2),E(h).concat(d).concat(E(b)));function v(e,t,r,n){return new _n(g,e-a.left,t-a.top-.01,r-e,n-t+.01)}function E({top:t,bottom:r,horizontal:n}){var a=[];for(let e=0;e<n.length;e+=2)a.push(v(n[e],t,n[e+1],r));return a}function S(r,n,i){let o=1e9,s=-1e9,l=[];function a(e,t,r,n,a){e=T.coordsAtPos(e,e==i.to?-2:2),r=T.coordsAtPos(r,r==i.from?2:-2);e&&r&&(o=Math.min(e.top,r.top,o),s=Math.max(e.bottom,r.bottom,s),a==O.Direction.LTR?l.push(m&&t?_:e.left,m&&n?y:r.right):l.push(!m&&n?_:r.left,!m&&t?y:e.right))}var c,u=null!=r?r:i.from,d=null!=n?n:i.to;for(c of T.visibleRanges)if(c.to>u&&c.from<d)for(let e=Math.max(c.from,u),t=Math.min(c.to,d);;){var f,p=T.state.doc.lineAt(e);for(f of T.bidiSpans(p)){var h=f.from+p.from,g=f.to+p.from;if(t<=h)break;g>e&&a(Math.max(h,e),null==r&&h<=u,Math.min(g,t),null==n&&d<=g,f.dir)}if((e=p.to+1)>=t)break}return 0==l.length&&a(u,null==r,d,null==n,T.textDirection),{top:o,bottom:s,horizontal:l}}function A(e,t){t=n.top+(t?e.top:e.bottom);return{top:t,bottom:t,horizontal:[]}}return}}}function At(e){var t=e.scrollDOM.getBoundingClientRect();return{left:(e.textDirection==O.Direction.LTR?t.left:t.right-e.scrollDOM.clientWidth*e.scaleX)-e.scrollDOM.scrollLeft*e.scaleX,top:t.top-e.scrollDOM.scrollTop*e.scaleY}}function Ot(e,t,r,n){var a,t=e.coordsAtPos(t,2*r);return!t||(r=e.dom.getBoundingClientRect(),t=(t.top+t.bottom)/2,a=e.posAtCoords({x:r.left+1,y:t}),e=e.posAtCoords({x:r.right-1,y:t}),null==a)||null==e?n:{from:Math.max(n.from,Math.min(a,e)),to:Math.min(n.to,Math.max(a,e))}}class yn{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(Tn)!=e.state.facet(Tn)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){!1!==this.layer.updateOnDocViewUpdate&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,r=e.facet(Tn);for(;t<r.length&&r[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){var{scaleX:e,scaleY:t}=this.view;e==this.scaleX&&t==this.scaleY||(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(r){if(r.length!=this.drawn.length||r.some((e,t)=>{return e=e,t=this.drawn[t],!(e.constructor==t.constructor&&e.eq(t))})){let e=this.dom.firstChild,t=0;for(var n of r)n.update&&e&&n.constructor&&this.drawn[t].constructor&&n.update(e,this.drawn[t])?(e=e.nextSibling,t++):this.dom.insertBefore(n.draw(),e);for(;e;){var a=e.nextSibling;e.remove(),e=a}this.drawn=r}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const Tn=_.Facet.define();function Ct(t){return[H.define(e=>new yn(e,t)),Tn.of(t)]}const bn=!S.ios,vn=_.Facet.define({combine(e){return _.combineConfig(e,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function kt(e){return e.startState.facet(vn)!=e.state.facet(vn)}const En=Ct({above:!0,markers(e){var t,r=e["state"],n=r.facet(vn),a=[];for(t of r.selection.ranges){var i=t==r.selection.main;if(t.empty?!i||bn:n.drawRangeCursor){var o,i=i?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",s=t.empty?t:_.EditorSelection.cursor(t.head,t.head>t.anchor?-1:1);for(o of _n.forRange(e,i,s))a.push(o)}}return a},update(e,t){e.transactions.some(e=>e.selection)&&(t.style.animationName="cm-blink"==t.style.animationName?"cm-blink2":"cm-blink");var r=kt(e);return r&&wt(e.state,t),e.docChanged||e.selectionSet||r},mount(e,t){wt(t.state,e)},class:"cm-cursorLayer"});function wt(e,t){t.style.animationDuration=e.facet(vn).cursorBlinkRate+"ms"}const Sn=Ct({above:!1,markers(t){return t.state.selection.ranges.map(e=>e.empty?[]:_n.forRange(t,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(e,t){return e.docChanged||e.selectionSet||e.viewportChanged||kt(e)},class:"cm-selectionLayer"});ve={".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"}},".cm-content":{"& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}};bn&&(ve[".cm-line"].caretColor=ve[".cm-content"].caretColor="transparent !important");const An=_.Prec.highest(Y.theme(ve)),On=_.StateEffect.define({map(e,t){return null==e?null:t.mapPos(e)}}),Cn=_.StateField.define({create(){return null},update(e,t){return null!=e&&(e=t.changes.mapPos(e)),t.effects.reduce((e,t)=>t.is(On)?t.value:e,e)}}),kn=H.fromClass(class{constructor(e){this.view=e,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(e){var t,r=e.state.field(Cn);null==r?null!=this.cursor&&(null!=(t=this.cursor)&&t.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(e.startState.field(Cn)!=r||e.docChanged||e.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){var e,t=this["view"],r=t.state.field(Cn),r=null!=r&&t.coordsAtPos(r);return r?(e=t.scrollDOM.getBoundingClientRect(),{left:r.left-e.left+t.scrollDOM.scrollLeft*t.scaleX,top:r.top-e.top+t.scrollDOM.scrollTop*t.scaleY,height:r.bottom-r.top}):null}drawCursor(e){var t,r;this.cursor&&({scaleX:t,scaleY:r}=this.view,e?(this.cursor.style.left=e.left/t+"px",this.cursor.style.top=e.top/r+"px",this.cursor.style.height=e.height/r+"px"):this.cursor.style.left="-100000px")}destroy(){this.cursor&&this.cursor.remove()}setDropPos(e){this.view.state.field(Cn)!=e&&this.view.dispatch({effects:On.of(e)})}},{eventObservers:{dragover(e){this.setDropPos(this.view.posAtCoords({x:e.clientX,y:e.clientY}))},dragleave(e){e.target!=this.view.contentDOM&&this.view.contentDOM.contains(e.relatedTarget)||this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function Rt(n,a,i,o,s){a.lastIndex=0;for(let e=n.iterRange(i,o),t=i,r;!e.next().done;t+=e.value.length)if(!e.lineBreak)for(;r=a.exec(e.value);)s(t+r.index,r)}class wn{constructor(e){const{regexp:t,decoration:a,decorate:i,boundary:r,maxLength:n=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,i)this.addMatch=(e,t,r,n)=>i(n,r,r+e[0].length,e,t);else if("function"==typeof a)this.addMatch=(e,t,r,n)=>{t=a(e,t,r);t&&n(r,r+e[0].length,t)};else{if(!a)throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.addMatch=(e,t,r,n)=>n(r,r+e[0].length,a)}this.boundary=r,this.maxLength=n}createDeco(r){let e=new _.RangeSetBuilder,n=e.add.bind(e);for(var{from:t,to:a}of function(e,t){var r=e.visibleRanges;if(1==r.length&&r[0].from==e.viewport.from&&r[0].to==e.viewport.to)return r;var n,a,i=[];for({from:n,to:a}of r)n=Math.max(e.state.doc.lineAt(n).from,n-t),a=Math.min(e.state.doc.lineAt(a).to,a+t),i.length&&i[i.length-1].to>=n?i[i.length-1].to=a:i.push({from:n,to:a});return i}(r,this.maxLength))Rt(r.state.doc,this.regexp,t,a,(e,t)=>this.addMatch(t,r,e,n));return e.finish()}updateDeco(a,e){let i=1e9,o=-1;return a.docChanged&&a.changes.iterChanges((e,t,r,n)=>{n>a.view.viewport.from&&r<a.view.viewport.to&&(i=Math.min(r,i),o=Math.max(n,o))}),a.viewportChanged||1e3<o-i?this.createDeco(a.view):-1<o?this.updateRange(a.view,e.map(a.changes),i,o):e}updateRange(s,l,e,r){for(var c of s.visibleRanges){let t=Math.max(c.from,e),o=Math.min(c.to,r);if(o>t){var u=s.state.doc.lineAt(t),d=u.to<o?s.state.doc.lineAt(o):u;let r=Math.max(c.from,u.from),n=Math.min(c.to,d.to);if(this.boundary){for(;t>u.from;t--)if(this.boundary.test(u.text[t-1-u.from])){r=t;break}for(;o<d.to;o++)if(this.boundary.test(d.text[o-d.from])){n=o;break}}let a=[],e,i=(e,t,r)=>a.push(r.range(e,t));if(u==d)for(this.regexp.lastIndex=r-u.from;(e=this.regexp.exec(u.text))&&e.index<n-u.from;)this.addMatch(e,s,e.index+u.from,i);else Rt(s.state.doc,this.regexp,r,n,(e,t)=>this.addMatch(t,s,e,i));l=l.update({filterFrom:r,filterTo:n,filter:(e,t)=>e<r||t>n,add:a})}}return l}}const Rn=null!=/x/.unicode?"gu":"g",In=new RegExp("[\0-\b\n--­؜​‎‏\u2028\u2029‭‮⁦⁧⁩\ufeff￹-￼]",Rn),Mn={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let p=null;const Pn=_.Facet.define({combine(e){var t,r,e=_.combineConfig(e,{render:null,specialChars:In,addSpecialChars:null});return(e.replaceTabs=(null==p&&"undefined"!=typeof document&&document.body&&(r=document.body.style,p=null!=(null!=(t=r.tabSize)?t:r.MozTabSize)),!p))&&(e.specialChars=new RegExp("\t|"+e.specialChars.source,Rn)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,Rn)),e}});let t=null;const Nn="•";class Dn extends N{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){var t=32<=(t=this.code)?Nn:10==t?"␤":String.fromCharCode(9216+t),e=e.state.phrase("Control character")+" "+(Mn[this.code]||"0x"+this.code.toString(16)),r=this.options.render&&this.options.render(this.code,e,t);return r||((r=document.createElement("span")).textContent=t,r.title=e,r.setAttribute("aria-label",e),r.className="cm-specialChar",r)}ignoreEvent(){return!1}}class xn extends N{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){var e=document.createElement("span");return e.textContent="\t",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}const Ln=H.fromClass(class{constructor(){this.height=1e3,this.attrs={style:"padding-bottom: 1000px"}}update(e){e=e.view,e=e.viewState.editorHeight-e.defaultLineHeight-e.documentPadding.top-.5;0<=e&&e!=this.height&&(this.height=e,this.attrs={style:`padding-bottom: ${e}px`})}});const Fn=D.line({class:"cm-activeLine"}),Un=H.fromClass(class{constructor(e){this.decorations=this.getDeco(e)}update(e){(e.docChanged||e.selectionSet)&&(this.decorations=this.getDeco(e.view))}getDeco(e){let t=-1,r=[];for(var n of e.state.selection.ranges){n=e.lineBlockAt(n.head);n.from>t&&(r.push(Fn.range(n.from)),t=n.from)}return D.set(r)}},{decorations:e=>e.decorations});class Bn extends N{constructor(e){super(),this.content=e}toDOM(){var e=document.createElement("span");return e.className="cm-placeholder",e.style.pointerEvents="none",e.appendChild("string"==typeof this.content?document.createTextNode(this.content):this.content),"string"==typeof this.content?e.setAttribute("aria-label","placeholder "+this.content):e.setAttribute("aria-hidden","true"),e}coordsAt(e){var t=e.firstChild?re(e.firstChild):[];return t.length?(e=window.getComputedStyle(e.parentNode),t=oe(t[0],"rtl"!=e.direction),e=parseInt(e.lineHeight),t.bottom-t.top>1.5*e?{left:t.left,right:t.right,top:t.top,bottom:t.top+e}:t):null}ignoreEvent(){return!1}}function It(e,t){var r,n=e.posAtCoords({x:t.clientX,y:t.clientY},!1),a=e.state.doc.lineAt(n),i=n-a.from,o=2e3<i?-1:i==a.length?(r=e,t=t.clientX,(o=r.coordsAtPos(r.viewport.from))?Math.round(Math.abs((o.left-t)/r.defaultCharacterWidth)):-1):_.countColumn(a.text,e.state.tabSize,n-a.from);return{line:a.number,col:o,off:i}}function Mt(n,e){let a=It(n,e),i=n.state.selection;return a?{update(e){var t;e.docChanged&&(t=e.changes.mapPos(e.startState.doc.line(a.line).from),t=e.state.doc.lineAt(t),a={line:t.number,col:a.col,off:Math.min(a.off,t.length)},i=i.map(e.changes))},get(e,t,r){var e=It(n,e);return e&&(e=function(t,e,r){var n=Math.min(e.line,r.line),a=Math.max(e.line,r.line),i=[];if(2e3<e.off||2e3<r.off||e.col<0||r.col<0){var o=Math.min(e.off,r.off),s=Math.max(e.off,r.off);for(let e=n;e<=a;e++){var l=t.doc.line(e);l.length<=s&&i.push(_.EditorSelection.range(l.from+o,l.to+s))}}else{var c=Math.min(e.col,r.col),u=Math.max(e.col,r.col);for(let e=n;e<=a;e++){var d,f=t.doc.line(e),p=_.findColumn(f.text,c,t.tabSize,!0);p<0?i.push(_.EditorSelection.cursor(f.to)):(d=_.findColumn(f.text,u,t.tabSize),i.push(_.EditorSelection.range(f.from+p,f.from+d)))}}return i}(n.state,a,e)).length?r?_.EditorSelection.create(e.concat(i.ranges)):_.EditorSelection.create(e):i}}:null}const jn={Alt:[18,e=>!!e.altKey],Control:[17,e=>!!e.ctrlKey],Shift:[16,e=>!!e.shiftKey],Meta:[91,e=>!!e.metaKey]},Hn={style:"cursor: crosshair"};const Gn="-10000px";class Vn{constructor(e,t,r,n){this.facet=t,this.createTooltipView=r,this.removeTooltipView=n,this.input=e.state.facet(t),this.tooltips=this.input.filter(e=>e);let a=null;this.tooltipViews=this.tooltips.map(e=>a=r(e,a))}update(n,a){var e,t=n.state.facet(this.facet),i=t.filter(e=>e);if(t===this.input){for(var r of this.tooltipViews)r.update&&r.update(n);return!1}var o,s,l=[],c=a?[]:null;for(let e=0;e<i.length;e++){let t=i[e],r=-1;if(t){for(let e=0;e<this.tooltips.length;e++){var u=this.tooltips[e];u&&u.create==t.create&&(r=e)}r<0?(l[e]=this.createTooltipView(t,e?l[e-1]:null),c&&(c[e]=!!t.above)):(o=l[e]=this.tooltipViews[r],c&&(c[e]=a[r]),o.update&&o.update(n))}}for(s of this.tooltipViews)l.indexOf(s)<0&&(this.removeTooltipView(s),null!=(e=s.destroy))&&e.call(s);return a&&(c.forEach((e,t)=>a[t]=e),a.length=c.length),this.input=t,this.tooltips=i,this.tooltipViews=l,!0}}function Pt(e){e=e.win;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}const Wn=_.Facet.define({combine:e=>{var t;return{position:S.ios?"absolute":(null==(t=e.find(e=>e.position))?void 0:t.position)||"fixed",parent:(null==(t=e.find(e=>e.parent))?void 0:t.parent)||null,tooltipSpace:(null==(t=e.find(e=>e.tooltipSpace))?void 0:t.tooltipSpace)||Pt}}}),qn=new WeakMap,$n=H.fromClass(class{constructor(e){this.view=e,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;var t=e.state.facet(Wn);this.position=t.position,this.parent=t.parent,this.classes=e.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver="function"==typeof ResizeObserver?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new Vn(e,Kn,(e,t)=>this.createTooltip(e,t),e=>{this.resizeObserver&&this.resizeObserver.unobserve(e.dom),e.dom.remove()}),this.above=this.manager.tooltips.map(e=>!!e.above),this.intersectionObserver="function"==typeof IntersectionObserver?new IntersectionObserver(e=>{Date.now()>this.lastTransaction-50&&0<e.length&&e[e.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),e.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(var e of this.manager.tooltipViews)this.intersectionObserver.observe(e.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(e){e.transactions.length&&(this.lastTransaction=Date.now());var t=this.manager.update(e,this.above);t&&this.observeIntersection();let r=t||e.geometryChanged;t=e.state.facet(Wn);if(t.position!=this.position&&!this.madeAbsolute){this.position=t.position;for(var n of this.manager.tooltipViews)n.dom.style.position=this.position;r=!0}if(t.parent!=this.parent){this.parent&&this.container.remove(),this.parent=t.parent,this.createContainer();for(var a of this.manager.tooltipViews)this.container.appendChild(a.dom);r=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);r&&this.maybeMeasure()}createTooltip(e,t){var r=e.create(this.view),t=t?t.dom:null;return r.dom.classList.add("cm-tooltip"),e.arrow&&!r.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")&&((e=document.createElement("div")).className="cm-tooltip-arrow",r.dom.appendChild(e)),r.dom.style.position=this.position,r.dom.style.top=Gn,r.dom.style.left="0px",this.container.insertBefore(r.dom,t),r.mount&&r.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(r.dom),r}destroy(){var e,t,r;this.view.win.removeEventListener("resize",this.measureSoon);for(r of this.manager.tooltipViews)r.dom.remove(),null!=(e=r.destroy)&&e.call(r);this.parent&&this.container.remove(),null!=(t=this.resizeObserver)&&t.disconnect(),null!=(t=this.intersectionObserver)&&t.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){var e,t=this.view.dom.getBoundingClientRect();let r=1,n=1,a=!1;return"fixed"==this.position&&this.manager.tooltipViews.length&&(e=this.manager.tooltipViews[0]["dom"],S.gecko?a=e.offsetParent!=this.container.ownerDocument.body:e.style.top==Gn&&"0px"==e.style.left&&(e=e.getBoundingClientRect(),a=1<Math.abs(e.top+1e4)||1<Math.abs(e.left))),!a&&"absolute"!=this.position||(this.parent?(e=this.parent.getBoundingClientRect()).width&&e.height&&(r=e.width/this.parent.offsetWidth,n=e.height/this.parent.offsetHeight):{scaleX:r,scaleY:n}=this.view.viewState),{editor:t,parent:this.parent?this.container.getBoundingClientRect():t,pos:this.manager.tooltips.map((e,t)=>{t=this.manager.tooltipViews[t];return t.getCoords?t.getCoords(e.pos):this.view.coordsAtPos(e.pos)}),size:this.manager.tooltipViews.map(({dom:e})=>e.getBoundingClientRect()),space:this.view.state.facet(Wn).tooltipSpace(this.view),scaleX:r,scaleY:n,makeAbsolute:a}}writeMeasure(i){if(i.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(var e of this.manager.tooltipViews)e.dom.style.position="absolute"}var{editor:t,space:o,scaleX:s,scaleY:l}=i,c=[];for(let a=0;a<this.manager.tooltips.length;a++){var u=this.manager.tooltips[a],d=this.manager.tooltipViews[a],f=d["dom"],p=i.pos[a],h=i.size[a];if(!p||p.bottom<=Math.max(t.top,o.top)||p.top>=Math.min(t.bottom,o.bottom)||p.right<Math.max(t.left,o.left)-.1||p.left>Math.min(t.right,o.right)+.1)f.style.top=Gn;else{var g=u.arrow?d.dom.querySelector(".cm-tooltip-arrow"):null,m=g?7:0;let e=h.right-h.left,t=null!=(_=qn.get(d))?_:h.bottom-h.top;var _=d.offset||zn,y=this.view.textDirection==O.Direction.LTR,T=h.width>o.right-o.left?y?o.left:o.right-h.width:y?Math.min(p.left-(g?14:0)+_.x,o.right-e):Math.max(o.left,p.left-e+(g?14:0)-_.x);let r=this.above[a];u=((r=!u.strictSide&&(r?p.top-(h.bottom-h.top)-_.y<o.top:p.bottom+(h.bottom-h.top)+_.y>o.bottom)&&r==o.bottom-p.bottom>p.top-o.top?this.above[a]=!r:r)?p.top-o.top:o.bottom-p.bottom)-m;if(u<t&&!1!==d.resize){if(u<this.view.defaultLineHeight){f.style.top=Gn;continue}qn.set(d,t),f.style.height=(t=u)/l+"px"}else f.style.height&&(f.style.height="");let n=r?p.top-t-m-_.y:p.bottom+m+_.y;var b=T+e;if(!0!==d.overlap)for(var v of c)v.left<b&&v.right>T&&v.top<n+t&&v.bottom>n&&(n=r?v.top-t-2-m:v.bottom+m+2);"absolute"==this.position?(f.style.top=(n-i.parent.top)/l+"px",f.style.left=(T-i.parent.left)/s+"px"):(f.style.top=n/l+"px",f.style.left=T/s+"px"),g&&(h=p.left+(y?_.x:-_.x)-(T+14-7),g.style.left=h/s+"px"),!0!==d.overlap&&c.push({left:T,top:n,right:b,bottom:n+t}),f.classList.toggle("cm-tooltip-above",r),f.classList.toggle("cm-tooltip-below",!r),d.positioned&&d.positioned(i.space)}}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView)&&(this.inView=this.view.inView,!this.inView))for(var e of this.manager.tooltipViews)e.dom.style.top=Gn}},{eventObservers:{scroll(){this.maybeMeasure()}}});Ee=Y.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}});const zn={x:0,y:0},Kn=_.Facet.define({enables:[$n,Ee]}),Yn=_.Facet.define({combine:e=>e.reduce((e,t)=>e.concat(t),[])});class Jn{static create(e){return new Jn(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new Vn(e,Yn,(e,t)=>this.createHostedView(e,t),e=>e.dom.remove())}createHostedView(e,t){e=e.create(this.view);return e.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(e.dom,t?t.dom.nextSibling:this.dom.firstChild),this.mounted&&e.mount&&e.mount(this.view),e}mount(e){for(var t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(var t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e,t;for(t of this.manager.tooltipViews)null!=(e=t.destroy)&&e.call(t)}passProp(e){let t=void 0;for(var r of this.manager.tooltipViews){r=r[e];if(void 0!==r)if(void 0===t)t=r;else if(t!==r)return}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const Zn=Kn.compute([Yn],e=>{e=e.facet(Yn);return 0===e.length?null:{pos:Math.min(...e.map(e=>e.pos)),end:Math.max(...e.map(e=>{var t;return null!=(t=e.end)?t:e.pos})),create:Jn.create,above:e[0].above,arrow:e.some(e=>e.arrow)}});class Qn{constructor(e,t,r,n,a){this.view=e,this.source=t,this.field=r,this.setHover=n,this.hoverTime=a,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){var e;this.hoverTimeout=-1,this.active.length||((e=Date.now()-this.lastMove.time)<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover())}startHover(){clearTimeout(this.restartTimeout);let{view:n,lastMove:t}=this;var a=n.docView.nearest(t.target);if(a){let r,e=1;if(a instanceof I)r=a.posAtStart;else{if(null==(r=n.posAtCoords(t)))return;a=n.coordsAtPos(r);if(!a||t.y<a.top||t.y>a.bottom||t.x<a.left-n.defaultCharacterWidth||t.x>a.right+n.defaultCharacterWidth)return;var i=n.bidiSpans(n.state.doc.lineAt(r)).find(e=>e.from<=r&&e.to>=r),i=i&&i.dir==O.Direction.RTL?-1:1;e=t.x<a.left?-i:i}a=this.source(n,r,e);if(null!=a&&a.then){let t=this.pending={pos:r};a.then(e=>{this.pending==t&&(this.pending=null,!e||Array.isArray(e)&&!e.length||n.dispatch({effects:this.setHover.of(Array.isArray(e)?e:[e])}))},e=>A(n.state,e,"hover tooltip"))}else!a||Array.isArray(a)&&!a.length||n.dispatch({effects:this.setHover.of(Array.isArray(a)?a:[a])})}}get tooltip(){var e=this.view.plugin($n),t=e?e.manager.tooltips.findIndex(e=>e.create==Jn.create):-1;return-1<t?e.manager.tooltipViews[t]:null}mousemove(e){this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));var{active:t,tooltip:r}=this;(t.length&&r&&!function(e,t){e=e.getBoundingClientRect();return t.clientX>=e.left-Xn&&t.clientX<=e.right+Xn&&t.clientY>=e.top-Xn&&t.clientY<=e.bottom+Xn}(r.dom,e)||this.pending)&&(r=(t[0]||this.pending)["pos"],r==(t=null!=(t=null==(t=t[0])?void 0:t.end)?t:r)?this.view.posAtCoords(this.lastMove)!=r:!function(e,t,r,n,a){var i=e.scrollDOM.getBoundingClientRect(),o=e.documentTop+e.documentPadding.top+e.contentHeight;if(i.left>n||i.right<n||i.top>a||Math.min(i.bottom,o)<a)return;i=e.posAtCoords({x:n,y:a},!1);return t<=i&&i<=r}(this.view,r,t,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;var t=this["active"];t.length&&(t=this["tooltip"],t&&t.dom.contains(e.relatedTarget)?this.watchTooltipLeave(t.dom):this.view.dispatch({effects:this.setHover.of([])}))}watchTooltipLeave(t){let r=e=>{t.removeEventListener("mouseleave",r),this.active.length&&!this.view.dom.contains(e.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};t.addEventListener("mouseleave",r)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const Xn=4;const ea=_.StateEffect.define();Oe=ea.of(null);const ta=_.Facet.define({combine(e){let t,r;for(var n of e)t=t||n.topContainer,r=r||n.bottomContainer;return{topContainer:t,bottomContainer:r}}});const ra=H.fromClass(class{constructor(t){this.input=t.state.facet(aa),this.specs=this.input.filter(e=>e),this.panels=this.specs.map(e=>e(t));var e,r=t.state.facet(ta);this.top=new na(t,!0,r.topContainer),this.bottom=new na(t,!1,r.bottomContainer),this.top.sync(this.panels.filter(e=>e.top)),this.bottom.sync(this.panels.filter(e=>!e.top));for(e of this.panels)e.dom.classList.add("cm-panel"),e.mount&&e.mount()}update(r){var e=r.state.facet(ta),e=(this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new na(r.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new na(r.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses(),r.state.facet(aa));if(e!=this.input){var n,t,e=e.filter(e=>e),a=[],i=[],o=[],s=[];for(n of e){let e=this.specs.indexOf(n),t;e<0?(t=n(r.view),s.push(t)):(t=this.panels[e]).update&&t.update(r),a.push(t),(t.top?i:o).push(t)}this.specs=e,this.panels=a,this.top.sync(i),this.bottom.sync(o);for(t of s)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}else for(var l of this.panels)l.update&&l.update(r)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:t=>Y.scrollMargins.of(e=>{e=e.plugin(t);return e&&{top:e.top.scrollMargin(),bottom:e.bottom.scrollMargin()}})});class na{constructor(e,t,r){this.view=e,this.top=t,this.container=r,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(var t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(0==this.panels.length)this.dom&&(this.dom.remove(),this.dom=void 0);else{var t,r;this.dom||(this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0",(t=this.container||this.view.dom).insertBefore(this.dom,this.top?t.firstChild:null));let e=this.dom.firstChild;for(r of this.panels)if(r.dom.parentNode==this.dom){for(;e!=r.dom;)e=Nt(e);e=e.nextSibling}else this.dom.insertBefore(r.dom,e);for(;e;)e=Nt(e)}}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(this.container&&this.classes!=this.view.themeClasses){for(var e of this.classes.split(" "))e&&this.container.classList.remove(e);for(var t of(this.classes=this.view.themeClasses).split(" "))t&&this.container.classList.add(t)}}}function Nt(e){var t=e.nextSibling;return e.remove(),t}const aa=_.Facet.define({enables:ra});class J extends _.RangeValue{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}J.prototype.elementClass="",J.prototype.toDOM=void 0,J.prototype.mapMode=_.MapMode.TrackBefore,J.prototype.startSide=J.prototype.endSide=-1,J.prototype.point=!0;const ia=_.Facet.define(),oa={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>_.RangeSet.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},sa=_.Facet.define();const la=_.Facet.define({combine:e=>e.some(e=>e)});function Dt(e){var t=[ca];return e&&!1===e.fixed&&t.push(la.of(!0)),t}const ca=H.fromClass(class{constructor(t){this.view=t,this.prevViewport=t.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=t.state.facet(sa).map(e=>new da(t,e));for(var e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!t.state.facet(la),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),t.scrollDOM.insertBefore(this.dom,t.contentDOM)}update(e){var t,r;this.updateGutters(e)&&(r=this.prevViewport,t=e.view.viewport,r=Math.min(r.to,t.to)-Math.max(r.from,t.from),this.syncGutters(r<.8*(t.to-t.from))),e.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(la)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=e.view.viewport}syncGutters(e){var t=this.dom.nextSibling,r=(e&&this.dom.remove(),_.RangeSet.iter(this.view.state.facet(ia),this.view.viewport.from));let n=[];var a,i,o=this.gutters.map(e=>new ua(e,this.view.viewport,-this.view.documentPadding.top));for(a of this.view.viewportLineBlocks)if(n.length&&(n=[]),Array.isArray(a.type)){let e=!0;for(var s of a.type)if(s.type==O.BlockType.Text&&e){Lt(r,n,s.from);for(var l of o)l.line(this.view,s,n);e=!1}else if(s.widget)for(var c of o)c.widget(this.view,s)}else if(a.type==O.BlockType.Text){Lt(r,n,a.from);for(var u of o)u.line(this.view,a,n)}else if(a.widget)for(var d of o)d.widget(this.view,a);for(i of o)i.finish();e&&this.view.scrollDOM.insertBefore(this.dom,t)}updateGutters(e){var t=e.startState.facet(sa),r=e.state.facet(sa);let n=e.docChanged||e.heightChanged||e.viewportChanged||!_.RangeSet.eq(e.startState.facet(ia),e.state.facet(ia),e.view.viewport.from,e.view.viewport.to);if(t==r)for(var a of this.gutters)a.update(e)&&(n=!0);else{n=!0;var i,o,s,l=[];for(i of r){var c=t.indexOf(i);c<0?l.push(new da(this.view,i)):(this.gutters[c].update(e),l.push(this.gutters[c]))}for(o of this.gutters)o.dom.remove(),l.indexOf(o)<0&&o.destroy();for(s of l)this.dom.appendChild(s.dom);this.gutters=l}return n}destroy(){for(var e of this.gutters)e.destroy();this.dom.remove()}},{provide:r=>Y.scrollMargins.of(e=>{var t=e.plugin(r);return t&&0!=t.gutters.length&&t.fixed?e.textDirection==O.Direction.LTR?{left:t.dom.offsetWidth*e.scaleX}:{right:t.dom.offsetWidth*e.scaleX}:null})});function xt(e){return Array.isArray(e)?e:[e]}function Lt(e,t,r){for(;e.value&&e.from<=r;)e.from==r&&t.push(e.value),e.next()}class ua{constructor(e,t,r){this.gutter=e,this.height=r,this.i=0,this.cursor=_.RangeSet.iter(e.markers,t.from)}addElement(e,t,r){var n,a=this["gutter"],i=(t.top-this.height)/e.scaleY,o=t.height/e.scaleY;this.i==a.elements.length?(n=new fa(e,o,i,r),a.elements.push(n),a.dom.appendChild(n.dom)):a.elements[this.i].update(e,o,i,r),this.height=t.bottom,this.i++}line(e,t,r){let n=[];Lt(this.cursor,n,t.from),r.length&&(n=n.concat(r));r=this.gutter.config.lineMarker(e,t,n),r&&n.unshift(r),r=this.gutter;0==n.length&&!r.config.renderEmptyElements||this.addElement(e,t,n)}widget(e,t){var r=this.gutter.config.widgetMarker(e,t.widget,t);r&&this.addElement(e,t,[r])}finish(){for(var e=this.gutter;e.elements.length>this.i;){var t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class da{constructor(i,o){this.view=i,this.config=o,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let a in o.domEventHandlers)this.dom.addEventListener(a,e=>{let t=e.target,r;if(t!=this.dom&&this.dom.contains(t)){for(;t.parentNode!=this.dom;)t=t.parentNode;var n=t.getBoundingClientRect();r=(n.top+n.bottom)/2}else r=e.clientY;n=i.lineBlockAtHeight(r-i.documentTop);o.domEventHandlers[a](i,n,e)&&e.preventDefault()});this.markers=xt(o.markers(i)),o.initialSpacer&&(this.spacer=new fa(i,0,0,[o.initialSpacer(i)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){var t=this.markers,r=(this.markers=xt(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer&&(r=this.config.updateSpacer(this.spacer.markers[0],e))!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[r]),e.view.viewport);return!_.RangeSet.eq(this.markers,t,r.from,r.to)||!!this.config.lineMarkerChange&&this.config.lineMarkerChange(e)}destroy(){for(var e of this.elements)e.destroy()}}class fa{constructor(e,t,r,n){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,r,n)}update(e,t,r,n){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=r&&(this.dom.style.marginTop=(this.above=r)?r+"px":""),function(t,r){if(t.length!=r.length)return;for(let e=0;e<t.length;e++)if(!t[e].compare(r[e]))return;return 1}(this.markers,n)||this.setMarkers(e,n)}setMarkers(i,o){let s="cm-gutterElement",l=this.dom.firstChild;for(let e=0,a=0;;){let t=a,r=e<o.length?o[e++]:null,n=!1;if(r){var c=r.elementClass;c&&(s+=" "+c);for(let e=a;e<this.markers.length;e++)if(this.markers[e].compare(r)){t=e,n=!0;break}}else t=this.markers.length;for(;a<t;){var u=this.markers[a++];u.toDOM&&(u.destroy(l),u=l.nextSibling,l.remove(),l=u)}if(!r)break;r.toDOM&&(n?l=l.nextSibling:this.dom.insertBefore(r.toDOM(i),l)),n&&a++}this.dom.className=s,this.markers=o}destroy(){this.setMarkers(null,[])}}const pa=_.Facet.define(),ha=_.Facet.define({combine(e){return _.combineConfig(e,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){var r,i=Object.assign({},e);for(r in t){let n=i[r],a=t[r];i[r]=n?(e,t,r)=>n(e,t,r)||a(e,t,r):a}return i}})}});class ga extends J{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function Ft(e,t){return e.state.facet(ha).formatNumber(t,e.state)}const ma=sa.compute([ha],e=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(pa)},lineMarker(e,t,r){return r.some(e=>e.toDOM)?null:new ga(Ft(e,e.state.doc.lineAt(t.from).number))},widgetMarker:()=>null,lineMarkerChange:e=>e.startState.facet(ha)!=e.state.facet(ha),initialSpacer(e){return new ga(Ft(e,Ut(e.state.doc.lines)))},updateSpacer(e,t){t=Ft(t.view,Ut(t.view.state.doc.lines));return t==e.number?e:new ga(t)},domEventHandlers:e.facet(ha).domEventHandlers}));function Ut(e){let t=9;for(;t<e;)t=10*t+9;return t}const _a=new class extends J{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},ya=ia.compute(["selection"],e=>{let t=[],r=-1;for(var n of e.selection.ranges){n=e.doc.lineAt(n.head).from;n>r&&(r=n,t.push(_a.range(n)))}return _.RangeSet.of(t)});const Ta=new Map;function Bt(t){return H.define(e=>({decorations:t.createDeco(e),update(e){this.decorations=t.updateDeco(e,this.decorations)}}),{decorations:e=>e.decorations})}const ba=Bt(new wn({regexp:/\t| +/g,decoration:t=>{{t=t[0];let e=Ta.get(t);return e||Ta.set(t,e=D.mark({attributes:"\t"===t?{class:"cm-highlightTab"}:{class:"cm-highlightSpace","data-display":t.replace(/ /g,"·")}})),e}},boundary:/\S/}));const va=Bt(new wn({regexp:/\s+$/g,decoration:D.mark({class:"cm-trailingSpace"}),boundary:/\S/}));Ae={HeightMap:$,HeightOracle:Lr,MeasuredHeights:Fr,QueryType:b,ChangedRange:G,computeOrder:Be,moveVisually:He};O.BidiSpan=U,O.BlockInfo=q,O.Decoration=D,O.EditorView=Y,O.GutterMarker=J,O.MatchDecorator=wn,O.RectangleMarker=_n,O.ViewPlugin=H,O.ViewUpdate=Sr,O.WidgetType=N,O.__test=Ae,O.closeHoverTooltips=Oe,O.crosshairCursor=function(e={}){let[t,r]=jn[e.key||"Alt"],n=H.fromClass(class{constructor(e){this.view=e,this.isDown=!1}set(e){this.isDown!=e&&(this.isDown=e,this.view.update([]))}},{eventObservers:{keydown(e){this.set(e.keyCode==t||r(e))},keyup(e){e.keyCode!=t&&r(e)||this.set(!1)},mousemove(e){this.set(r(e))}}});return[n,Y.contentAttributes.of(e=>{return null!=(e=e.plugin(n))&&e.isDown?Hn:null})]},O.drawSelection=function(e={}){return[vn.of(e),En,Sn,An,lr.of(!0)]},O.dropCursor=function(){return[Cn,kn]},O.getDrawSelectionConfig=function(e){return e.facet(vn)},O.getPanel=function(e,t){return e=e.plugin(ra),-1<(t=e?e.specs.indexOf(t):-1)?e.panels[t]:null},O.getTooltip=function(e,t){return!(e=e.plugin($n))||(t=e.manager.tooltips.indexOf(t))<0?null:e.manager.tooltipViews[t]},O.gutter=function(e){return[Dt(),sa.of(Object.assign(Object.assign({},oa),e))]},O.gutterLineClass=ia,O.gutters=Dt,O.hasHoverTooltips=function(e){return e.facet(Yn).some(e=>e)},O.highlightActiveLine=function(){return Un},O.highlightActiveLineGutter=function(){return ya},O.highlightSpecialChars=function(e={}){return[Pn.of(e),t=t||H.fromClass(class{constructor(e){this.view=e,this.decorations=D.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(e.state.facet(Pn)),this.decorations=this.decorator.createDeco(e)}makeDecorator(a){return new wn({regexp:a.specialChars,decoration:(e,t,r)=>{var n=t.state["doc"],e=_.codePointAt(e[0],0);return 9==e?(n=n.lineAt(r),t=t.state.tabSize,r=_.countColumn(n.text,t,r-n.from),D.replace({widget:new xn((t-r%t)*this.view.defaultCharacterWidth/this.view.scaleX)})):this.decorationCache[e]||(this.decorationCache[e]=D.replace({widget:new Dn(a,e)}))},boundary:a.replaceTabs?void 0:/[^]/})}update(e){var t=e.state.facet(Pn);e.startState.facet(Pn)!=t?(this.decorator=this.makeDecorator(t),this.decorations=this.decorator.createDeco(e.view)):this.decorations=this.decorator.updateDeco(e,this.decorations)}},{decorations:e=>e.decorations})]},O.highlightTrailingWhitespace=function(){return va},O.highlightWhitespace=function(){return ba},O.hoverTooltip=function(t,s={}){let l=_.StateEffect.define(),r=_.StateField.define({create(){return[]},update(e,t){if(e.length&&(s.hideOnChange&&(t.docChanged||t.selection)?e=[]:s.hideOn&&(e=e.filter(e=>!s.hideOn(t,e))),t.docChanged)){var r,n=[];for(r of e){var a,i=t.changes.mapPos(r.pos,-1,_.MapMode.TrackDel);null!=i&&((a=Object.assign(Object.create(null),r)).pos=i,null!=a.end&&(a.end=t.changes.mapPos(a.end)),n.push(a))}e=n}for(var o of t.effects)o.is(l)&&(e=o.value),o.is(ea)&&(e=[]);return e},provide:e=>Yn.from(e)});return[r,H.define(e=>new Qn(e,t,r,l,s.hoverTime||300)),Zn]},O.keymap=hn,O.layer=Ct,O.lineNumberMarkers=pa,O.lineNumbers=function(e={}){return[ha.of(e),Dt(),ma]},O.logException=A,O.panels=function(e){return e?[ta.of(e)]:[]},O.placeholder=function(t){return H.fromClass(class{constructor(e){this.view=e,this.placeholder=t?D.set([D.widget({widget:new Bn(t),side:1}).range(0)]):D.none}get decorations(){return this.view.state.doc.length?D.none:this.placeholder}},{decorations:e=>e.decorations})},O.rectangularSelection=function(e){let r=(null==e?void 0:e.eventFilter)||(e=>e.altKey&&0==e.button);return Y.mouseSelectionStyle.of((e,t)=>r(t)?Mt(e,t):null)},O.repositionTooltips=function(e){(e=e.plugin($n))&&e.maybeMeasure()},O.runScopeHandlers=function(e,t,r){return St(Et(e.state),t,e,r)},O.scrollPastEnd=function(){return[Ln,mr.of(e=>{return(null==(e=e.plugin(Ln))?void 0:e.attrs)||null})]},O.showPanel=aa,O.showTooltip=Kn,O.tooltips=function(e={}){return Wn.of(e)}}}return P1}var j1,He={},H1={};function G1(){if(!j1){j1=1;{var p=H1;const i=1024;let t=0;class b{constructor(e,t){this.from=e,this.to=t}}class W{constructor(e={}){this.id=t++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof t&&(t=E.match(t)),e=>{e=t(e);return void 0===e?null:[this,e]}}}W.closedBy=new W({deserialize:e=>e.split(" ")}),W.openedBy=new W({deserialize:e=>e.split(" ")}),W.group=new W({deserialize:e=>e.split(" ")}),W.isolate=new W({deserialize:e=>{if(e&&"rtl"!=e&&"ltr"!=e&&"auto"!=e)throw new RangeError("Invalid value for isolate: "+e);return e||"auto"}}),W.contextHash=new W({perNode:!0}),W.lookAhead=new W({perNode:!0}),W.mounted=new W({perNode:!0});class v{constructor(e,t,r){this.tree=e,this.overlay=t,this.parser=r}static get(e){return e&&e.props&&e.props[W.mounted.id]}}const s=Object.create(null);class E{constructor(e,t,r,n=0){this.name=e,this.props=t,this.id=r,this.flags=n}static define(e){var t=e.props&&e.props.length?Object.create(null):s,r=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(null==e.name?8:0),n=new E(e.name||"",t,e.id,r);if(e.props)for(var a of e.props)if(a=Array.isArray(a)?a:a(n)){if(a[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[a[0].id]=a[1]}return n}prop(e){return this.props[e.id]}get isTop(){return 0<(1&this.flags)}get isSkipped(){return 0<(2&this.flags)}get isError(){return 0<(4&this.flags)}get isAnonymous(){return 0<(8&this.flags)}is(e){var t;return"string"==typeof e?this.name==e||!!(t=this.prop(W.group))&&-1<t.indexOf(e):this.id==e}static match(e){let a=Object.create(null);for(var t in e)for(var r of t.split(" "))a[r]=e[t];return r=>{for(let e=r.prop(W.group),t=-1;t<(e?e.length:0);t++){var n=a[t<0?r.name:e[t]];if(n)return n}}}}E.none=new E("",Object.create(null),0,8);const a=new WeakMap,r=new WeakMap;var e;p.IterMode=void 0,(e=p.IterMode||(p.IterMode={}))[e.ExcludeBuffers=1]="ExcludeBuffers",e[e.IncludeAnonymous=2]="IncludeAnonymous",e[e.IgnoreMounts=4]="IgnoreMounts",e[e.IgnoreOverlays=8]="IgnoreOverlays";class q{constructor(e,t,r,n,a){if(this.type=e,this.children=t,this.positions=r,this.length=n,this.props=null,a&&a.length){this.props=Object.create(null);for(var[i,o]of a)this.props["number"==typeof i?i:i.id]=o}}toString(){var e,t=v.get(this);if(t&&!t.overlay)return t.tree.toString();let r="";for(e of this.children){var n=e.toString();n&&(r&&(r+=","),r+=n)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(r.length?"("+r+")":""):r}cursor(e=0){return new k(this.topNode,e)}cursorAt(e,t=0,r){var n=a.get(this)||this.topNode,n=new k(n);return n.moveTo(e,t),a.set(this,n._tree),n}get topNode(){return new S(this,0,0,null)}resolve(e,t=0){e=c(a.get(this)||this.topNode,e,t,!1);return a.set(this,e),e}resolveInner(e,t=0){e=c(r.get(this)||this.topNode,e,t,!0);return r.set(this,e),e}resolveStack(e,n=0){{var a,i=e,o=n,s,l;let t=this.resolveInner(i,o),r=null;for(let e=t instanceof S?t:t.context.parent;e;e=e.parent)e.index<0?(s=e.parent,(r=r||[t]).push(s.resolve(i,o)),e=s):(s=v.get(e.tree))&&s.overlay&&s.overlay[0].from<=i&&s.overlay[s.overlay.length-1].to>=i&&(l=new S(s.tree,s.overlay[0].from+e.from,-1,e),(r=r||[t]).push(c(l,i,o,!1)));return r?u(r):t}}iterate(e){for(var{enter:t,leave:r,from:n=0,to:a=this.length}=e,e=e.mode||0,i=0<(e&p.IterMode.IncludeAnonymous),o=this.cursor(e|p.IterMode.IncludeAnonymous);;){let e=!1;if(o.from<=a&&o.to>=n&&(!i&&o.type.isAnonymous||!1!==t(o))){if(o.firstChild())continue;e=!0}for(;e&&r&&(i||!o.type.isAnonymous)&&r(o),!o.nextSibling();){if(!o.parent())return;e=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){var e=[];if(this.props)for(var t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:V(E.none,this.children,this.positions,0,this.children.length,0,this.length,(e,t,r)=>new q(this.type,e,t,r,this.propValues),e.makeTree||((e,t,r)=>new q(E.none,e,t,r)))}static build(t){{var r=t;let{buffer:e,nodeSet:P,maxBufferLength:N=i,reused:D=[],minRepeatType:x=P.types.length}=r,L=Array.isArray(e)?new l(e,e.length):e,F=P.types,U=0,B=0;function j(r,n,e,t,a,i){for(var o,s,{id:l,start:c,end:u,size:d}=L,f=B;d<0;){if(L.next(),-1==d)return o=D[l],e.push(o),void t.push(c-r);if(-3==d)return void(U=l);if(-4==d)return void(B=l);throw new RangeError("Unrecognized record size: "+d)}let p=F[l],h,g,m=c-r;if(u-c<=N&&(g=function(e,t){let r=L.fork(),n=0,a=0,i=0,o=r.end-N,s={size:0,start:0,skip:0};e:for(var l=r.pos-e;r.pos>l;){var c=r.size;if(r.id==t&&0<=c)s.size=n,s.start=a,s.skip=i,i+=4,n+=4,r.next();else{var u=r.pos-c;if(c<0||u<l||r.start<o)break;let e=r.id>=x?4:0;var d=r.start;for(r.next();r.pos>u;){if(r.size<0){if(-3!=r.size)break e;e+=4}else r.id>=x&&(e+=4);r.next()}a=d,n+=c,i+=e}}(t<0||n==e)&&(s.size=n,s.start=a,s.skip=i);return 4<s.size?s:void 0}(L.pos-n,a))){var _=new Uint16Array(g.size-g.skip);let e=L.pos-g.size,t=_.length;for(;L.pos>e;)t=function t(r,n,a){let{id:i,start:o,end:s,size:l}=L;L.next();if(0<=l&&i<x){let e=a;if(4<l){let e=L.pos-(l-4);for(;L.pos>e;)a=t(r,n,a)}n[--a]=e,n[--a]=s-r,n[--a]=o-r,n[--a]=i}else-3==l?U=i:-4==l&&(B=i);return a}(g.start,_,t);h=new $(_,u-g.start,P),m=g.start-r}else{var y=L.pos-d,T=(L.next(),[]),b=[],v=l>=x?l:-1;let e=0,t=u;for(;L.pos>y;)if(0<=v&&L.id==v&&0<=L.size)L.end<=t-N&&(H(T,b,c,e,L.end,t,v,f),e=T.length,t=L.end),L.next();else if(2500<i){E=void 0;S=void 0;A=void 0;O=void 0;C=void 0;k=void 0;w=void 0;R=void 0;I=void 0;M=void 0;var E=c;var S=y;var A=T;var O=b;let r=[],e=0,t=-1;for(;L.pos>S;){var{id:C,start:k,end:w,size:R}=L;if(!(4<R)){if(-1<t&&k<t)break;t<0&&(t=w-N),r.push(C,k,w),e++}L.next()}if(e){var I=new Uint16Array(4*e),M=r[r.length-2];for(let e=r.length-3,t=0;0<=e;e-=3)I[t++]=r[e],I[t++]=r[e+1]-M,I[t++]=r[e+2]-M,I[t++]=t;A.push(new $(I,r[2]-M,P)),O.push(M-E)}}else j(c,y,T,b,v,i+1);0<=v&&0<e&&e<T.length&&H(T,b,c,e,c,t,v,f),T.reverse(),b.reverse(),h=-1<v&&0<e?V(s=p,T,b,0,T.length,0,u-c,n=(e,t,r)=>{let n=0,a=e.length-1,i,o;if(0<=a&&(i=e[a])instanceof q){if(!a&&i.type==s&&i.length==r)return i;(o=i.prop(W.lookAhead))&&(n=t[a]+i.length+o)}return G(s,e,t,r,n)},n):G(p,T,b,u-c,f-u)}e.push(h),t.push(m)}function H(e,t,r,n,a,i,o,s){for(var l=[],c=[];e.length>n;)l.push(e.pop()),c.push(t.pop()+r-a);e.push(G(P.types[o],l,c,i-a,s-i)),t.push(a-r)}function G(e,t,r,n,a=0,i){var o;return U&&(o=[W.contextHash,U],i=i?[o].concat(i):[o]),25<a&&(o=[W.lookAhead,a],i=i?[o].concat(i):[o]),new q(e,t,r,n,i)}for(var n=[],a=[];0<L.pos;)j(r.start||0,r.bufferStart||0,n,a,-1,0);return t=null!=(t=r.length)?t:n.length?a[0]+n[0].length:0,new q(F[r.topID],n.reverse(),a.reverse(),t)}}}q.empty=new q(E.none,[],[],0);class l{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new l(this.buffer,this.index)}}class ${constructor(e,t,r){this.buffer=e,this.length=t,this.set=r}get type(){return E.none}toString(){var t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(e){var t=this.buffer[e],r=this.buffer[e+3];let n=this.set.types[t],a=n.name;if(/\W/.test(a)&&!n.isError&&(a=JSON.stringify(a)),r==(e+=4))return a;for(var i=[];e<r;)i.push(this.childString(e)),e=this.buffer[e+3];return a+"("+i.join(",")+")"}findChild(t,r,n,a,i){let o=this["buffer"],s=-1;for(let e=t;e!=r&&!(f(i,a,o[e+1],o[e+2])&&(s=e,0<n));e=o[e+3]);return s}slice(r,n,a){var i=this.buffer;let o=new Uint16Array(n-r),s=0;for(let e=r,t=0;e<n;){o[t++]=i[e++],o[t++]=i[e++]-a;var l=o[t++]=i[e++]-a;o[t++]=i[e++]-r,s=Math.max(s,l)}return new $(o,s,this.set)}}function f(e,t,r,n){switch(e){case-2:return r<t;case-1:return t<=n&&r<t;case 0:return r<t&&t<n;case 1:return r<=t&&t<n;case 2:return t<n;case 4:return 1}}function c(r,n,a,e){for(var i;r.from==r.to||(a<1?r.from>=n:r.from>n)||(-1<a?r.to<=n:r.to<n);){var t=!e&&r instanceof S&&r.index<0?null:r.parent;if(!t)return r;r=t}var o=e?0:p.IterMode.IgnoreOverlays;if(e)for(let e=r,t=e.parent;t;t=(e=t).parent)e instanceof S&&e.index<0&&(null==(i=t.enter(n,a,o))?void 0:i.from)!=e.from&&(r=t);for(;;){var s=r.enter(n,a,o);if(!s)return r;r=s}}class d{cursor(e=0){return new k(this,e)}getChild(e,t=null,r=null){e=n(this,e,t,r);return e.length?e[0]:null}getChildren(e,t=null,r=null){return n(this,e,t,r)}resolve(e,t=0){return c(this,e,t,!1)}resolveInner(e,t=0){return c(this,e,t,!0)}matchContext(e){return o(this,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),r=this;for(;t;){var n=t.lastChild;if(!n||n.to!=t.to)break;t=n.type.isError&&n.from==n.to?(r=t,n.prevSibling):n}return r}get node(){return this}get next(){return this.parent}}class S extends d{constructor(e,t,r,n){super(),this._tree=e,this.from=t,this.index=r,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(r,n,a,i,o=0){for(let t=this;;){for(var{children:e,positions:s}=t._tree,l=0<n?e.length:-1;r!=l;r+=n){var c=e[r],u=s[r]+t.from;if(f(i,a,u,u+c.length))if(c instanceof $){if(!(o&p.IterMode.ExcludeBuffers)){var d=c.findChild(0,c.buffer.length,n,a-u,i);if(-1<d)return new O(new A(t,c,r,u),null,d)}}else if(o&p.IterMode.IncludeAnonymous||!c.type.isAnonymous||h(c)){let e;return o&p.IterMode.IgnoreMounts||!(e=v.get(c))||e.overlay?(d=new S(c,u,r,t),o&p.IterMode.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(n<0?c.children.length-1:0,n,a,i)):new S(e.tree,u,r,t)}}if(o&p.IterMode.IncludeAnonymous||!t.type.isAnonymous)return null;if(r=0<=t.index?t.index+n:n<0?-1:t._parent._tree.children.length,!(t=t._parent))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,r=0){let n;if(!(r&p.IterMode.IgnoreOverlays)&&(n=v.get(this._tree))&&n.overlay){var a,i,o=e-this.from;for({from:a,to:i}of n.overlay)if((0<t?a<=o:a<o)&&(t<0?i>=o:i>o))return new S(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,r)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&0<=this.index?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&0<=this.index?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function n(e,t,r,n){var a=e.cursor(),i=[];if(!a.firstChild())return i;if(null!=r)for(let e=!1;!e;)if(e=a.type.is(r),!a.nextSibling())return i;for(;;){if(null!=n&&a.type.is(n))return i;if(a.type.is(t)&&i.push(a.node),!a.nextSibling())return null==n?i:[]}}function o(t,r,n=r.length-1){for(let e=t.parent;0<=n;e=e.parent){if(!e)return!1;if(!e.type.isAnonymous){if(r[n]&&r[n]!=e.name)return!1;n--}}return!0}class A{constructor(e,t,r,n){this.parent=e,this.buffer=t,this.index=r,this.start=n}}class O extends d{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,r){super(),this.context=e,this._parent=t,this.index=r,this.type=e.buffer.set.types[e.buffer.buffer[r]]}child(e,t,r){var n=this.context["buffer"],n=n.findChild(this.index+4,n.buffer[this.index+3],e,t-this.context.start,r);return n<0?null:new O(this.context,this,n)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,r=0){return r&p.IterMode.ExcludeBuffers||(r=this.context.buffer,(r=r.findChild(this.index+4,r.buffer[this.index+3],0<t?1:-1,e-this.context.start,t))<0)?null:new O(this.context,this,r)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){var e=this.context["buffer"],t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new O(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){var e=this.context["buffer"],t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new O(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){var e,t=[],r=[],n=this.context["buffer"],a=this.index+4,i=n.buffer[this.index+3];return a<i&&(e=n.buffer[this.index+1],t.push(n.slice(a,i,e)),r.push(0)),new q(this.type,t,r,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function u(t){if(!t.length)return null;let r=0,n=t[0];for(let e=1;e<t.length;e++){var a=t[e];(a.from>n.from||a.to<n.to)&&(n=a,r=e)}var e=n instanceof S&&n.index<0?null:n.parent,i=t.slice();return e?i[r]=e:i.splice(r,1),new C(i,n)}class C{constructor(e,t){this.heads=e,this.node=t}get next(){return u(this.heads)}}class k{get name(){return this.type.name}constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof S)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let e=t._parent;e;e=e._parent)this.stack.unshift(e.index);this.bufferNode=t,this.yieldBuf(t.index)}}yieldNode(e){return!!e&&(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0)}yieldBuf(e,t){this.index=e;var{start:r,buffer:n}=this.buffer;return this.type=t||n.set.types[n.buffer[e]],this.from=r+n.buffer[e+1],this.to=r+n.buffer[e+2],!0}yield(e){return!!e&&(e instanceof S?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,r){var n;return this.buffer?(n=this.buffer["buffer"],!((n=n.findChild(this.index+4,n.buffer[this.index+3],e,t-this.buffer.start,r))<0)&&(this.stack.push(this.index),this.yieldBuf(n))):this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,r,this.mode))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,r=this.mode){return this.buffer?!(r&p.IterMode.ExcludeBuffers)&&this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,r))}parent(){var e;return this.buffer?this.stack.length?this.yieldBuf(this.stack.pop()):(e=this.mode&p.IterMode.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent(),this.buffer=null,this.yieldNode(e)):this.yieldNode(this.mode&p.IterMode.IncludeAnonymous?this._tree._parent:this._tree.parent)}sibling(e){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode));var t=this.buffer["buffer"],r=this.stack.length-1;if(e<0){var n=r<0?0:this.stack[r]+4;if(this.index!=n)return this.yieldBuf(t.findChild(n,this.index,-1,0,4))}else{n=t.buffer[this.index+3];if(n<(r<0?t.buffer.length:t.buffer[this.stack[r]+3]))return this.yieldBuf(n)}return r<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(r){let n,a,t=this["buffer"];if(t){if(0<r){if(this.index<t.buffer.buffer.length)return!1}else for(let e=0;e<this.index;e++)if(t.buffer.buffer[e+3]<this.index)return!1;({index:n,parent:a}=t)}else({index:n,_parent:a}=this._tree);for(;a;{index:n,_parent:a}=a)if(-1<n)for(let e=n+r,t=r<0?-1:a._tree.children.length;e!=t;e+=r){var i=a._tree.children[e];if(this.mode&p.IterMode.IncludeAnonymous||i instanceof $||!i.type.isAnonymous||h(i))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(-1<t?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let n=this.bufferNode,a=null,i=0;if(n&&n.context==this.buffer)e:for(let t=this.index,r=this.stack.length;0<=r;){for(let e=n;e;e=e._parent)if(e.index==t){if(t==this.index)return e;a=e,i=r+1;break e}t=this.stack[--r]}for(let e=i;e<this.stack.length;e++)a=new O(this.buffer,a,this.stack[e]);return this.bufferNode=new O(this.buffer,a,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(r,n){for(let t=0;;){let e=!1;if(this.type.isAnonymous||!1!==r(this)){if(this.firstChild()){t++;continue}this.type.isAnonymous||(e=!0)}for(;e&&n&&n(this),e=this.type.isAnonymous,!this.nextSibling();){if(!t)return;this.parent(),t--,e=!0}}}matchContext(r){if(!this.buffer)return o(this.node,r);var n=this.buffer["buffer"],a=n.set["types"];for(let e=r.length-1,t=this.stack.length-1;0<=e;t--){if(t<0)return o(this.node,r,e);var i=a[n.buffer[this.stack[t]]];if(!i.isAnonymous){if(r[e]&&r[e]!=i.name)return!1;e--}}return!0}}function h(e){return e.children.some(e=>e instanceof $||!e.type.isAnonymous||h(e))}const w=new WeakMap;function _(e,t){if(!e.isAnonymous||t instanceof $||t.type!=e)return 1;let r=w.get(t);if(null==r){r=1;for(var n of t.children){if(n.type!=e||!(n instanceof q)){r=1;break}r+=_(e,n)}w.set(t,r)}return r}function V(d,t,e,r,n,f,a,i,p){let o=0;for(let e=r;e<n;e++)o+=_(d,t[e]);let h=Math.ceil(1.5*o/8),g=[],m=[];return function a(i,o,e,s,l){for(let n=e;n<s;){let e=n,t=o[n],r=_(d,i[n]);for(n++;n<s;n++){var c=_(d,i[n]);if(r+c>=h)break;r+=c}if(n==e+1){if(r>h){var u=i[e];a(u.children,u.positions,0,u.children.length,o[e]+l);continue}g.push(i[e])}else u=o[n-1]+i[n-1].length-t,g.push(V(d,i,o,e,n,t,u,null,p));m.push(t+l-f)}}(t,e,r,n,0),(i||p)(g,m,a)}class R{constructor(e,t,r,n,a=!1,i=!1){this.from=e,this.to=t,this.tree=r,this.offset=n,this.open=(a?1:0)|(i?2:0)}get openStart(){return 0<(1&this.open)}get openEnd(){return 0<(2&this.open)}static addTree(e,t=[],r=!1){var n,a=[new R(0,e.length,e,0,!1,r)];for(n of t)n.to>e.length&&a.push(n);return a}static applyChanges(a,e,i=128){if(!e.length)return a;var o=[];let s=1,l=a.length?a[0]:null;for(let t=0,r=0,n=0;;t++){var c,u,d=t<e.length?e[t]:null,f=d?d.fromA:1e9;if(f-r>=i)for(;l&&l.from<f;){let e=l;if((r>=e.from||f<=e.to||n)&&(c=Math.max(e.from,r)-n,u=Math.min(e.to,f)-n,e=u<=c?null:new R(c,u,e.tree,e.offset+n,0<t,!!d)),e&&o.push(e),l.to>f)break;l=s<a.length?a[s++]:null}if(!d)break;r=d.toA,n=d.toA-d.toB}return o}}class N{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}class I{constructor(e,t,r,n,a){this.parser=e,this.parse=t,this.overlay=r,this.target=n,this.from=a}}function g(e){if(!e.length||e.some(e=>e.from>=e.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(e))}class D{constructor(e,t,r,n,a,i,o){this.parser=e,this.predicate=t,this.mounts=r,this.index=n,this.start=a,this.target=i,this.prev=o,this.depth=0,this.ranges=[]}}const M=new W({perNode:!0});class x{constructor(e,t,r,n,a){this.nest=t,this.input=r,this.fragments=n,this.ranges=a,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=e}advance(){if(this.baseParse){var e=this.baseParse.advance();if(!e)return null;if(this.baseParse=null,this.baseTree=e,this.startInner(),null!=this.stoppedAt)for(var t of this.inner)t.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let e=this.baseTree;return e=null!=this.stoppedAt?new q(e.type,e.children,e.positions,e.length,e.propValues.concat([[M,this.stoppedAt]])):e}var r,e=this.inner[this.innerDone],n=e.parse.advance();return n&&(this.innerDone++,(r=Object.assign(Object.create(null),e.target.props))[W.mounted.id]=new v(n,e.overlay,e.parser),e.target.props=r),null}get parsedPos(){if(this.baseParse)return 0;let t=this.input.length;for(let e=this.innerDone;e<this.inner.length;e++)this.inner[e].from<t&&(t=Math.min(t,this.inner[e].parse.parsedPos));return t}stopAt(t){if(this.stoppedAt=t,this.baseParse)this.baseParse.stopAt(t);else for(let e=this.innerDone;e<this.inner.length;e++)this.inner[e].parse.stopAt(t)}startInner(){var a,i,o,s=new L(this.fragments);let l=null,c=null,u=new k(new S(this.baseTree,this.ranges[0].from,0,null),p.IterMode.IncludeAnonymous|p.IterMode.IgnoreMounts);e:for(let r,n;;){let e=!0,t;if(null!=this.stoppedAt&&u.from>=this.stoppedAt)e=!1;else if(s.hasNode(u)){if(l){var d=l.mounts.find(e=>e.frag.from<=u.from&&e.frag.to>=u.to&&e.mount.overlay);if(d)for(var f of d.mount.overlay){let t=f.from+d.pos,r=f.to+d.pos;t>=u.from&&r<=u.to&&!l.ranges.some(e=>e.from<r&&e.to>t)&&l.ranges.push({from:t,to:r})}}e=!1}else c&&(n=function(e,t,r){for(var n of e){if(n.from>=r)break;if(n.to>t)return n.from<=t&&n.to>=r?2:1}return 0}(c.ranges,u.from,u.to))?e=2!=n:!u.type.isAnonymous&&(r=this.nest(u,this.input))&&(u.from<u.to||!r.overlay)?(u.tree||function(e){let d=e["node"],f=[],t=d.context.buffer;for(;f.push(e.index),e.parent(),!e.tree;);let r=e.tree,n=r.children.indexOf(t),p=r.children[n],h=p.buffer,g=[n];r.children[n]=function e(t,r,n,a,i,o){var s=f[o],l=[],c=[],t=(m(p,t,s,l,c,a),h[s+1]),u=h[s+2],u=(g.push(l.length),o?e(s+4,h[s+3],p.set.types[h[s]],t,u-t,o-1):d.toTree());return l.push(u),c.push(t-a),m(p,h[s+3],r,l,c,a),new q(n,l,c,i)}(0,h.length,E.none,0,p.length,f.length-1);for(var a of g){var i=e.tree.children[a],o=e.tree.positions[a];e.yield(new S(i,o+e.from,a,e._tree))}}(u),a=s.findMounts(u.from,r.parser),"function"==typeof r.overlay?l=new D(r.parser,r.overlay,a,this.inner.length,u.from,u.tree,l):((i=y(this.ranges,r.overlay||(u.from<u.to?[new b(u.from,u.to)]:[]))).length&&g(i),!i.length&&r.overlay||this.inner.push(new I(r.parser,i.length?r.parser.startParse(this.input,T(a,i),i):r.parser.startParse(""),r.overlay?r.overlay.map(e=>new b(e.from-u.from,e.to-u.from)):null,u.tree,(i.length?i[0]:u).from)),r.overlay?i.length&&(c={ranges:i,depth:0,prev:c}):e=!1)):l&&(t=l.predicate(u))&&(t=!0===t?new b(u.from,u.to):t).from<t.to&&l.ranges.push(t);if(e&&u.firstChild())l&&l.depth++,c&&c.depth++;else for(;!u.nextSibling();){if(!u.parent())break e;l&&!--l.depth&&((o=y(this.ranges,l.ranges)).length&&(g(o),this.inner.splice(l.index,0,new I(l.parser,l.parser.startParse(this.input,T(l.mounts,o),o),l.ranges.map(e=>new b(e.from-l.start,e.to-l.start)),l.target,o[0].from))),l=l.prev),c&&!--c.depth&&(c=c.prev)}}}}function m(e,t,r,n,a,i){var o;t<r&&(o=e.buffer[t+1],n.push(e.slice(t,r,o)),a.push(o-i))}class P{constructor(e,t){this.offset=t,this.done=!1,this.cursor=e.cursor(p.IterMode.IncludeAnonymous|p.IterMode.IgnoreMounts)}moveTo(e){for(var t=this["cursor"],r=e-this.offset;!this.done&&t.from<r;)t.to>=e&&t.enter(r,1,p.IterMode.IgnoreOverlays|p.IterMode.ExcludeBuffers)||t.next(!1)||(this.done=!0)}hasNode(t){if(this.moveTo(t.from),!this.done&&this.cursor.from+this.offset==t.from&&this.cursor.tree)for(let e=this.cursor.tree;;){if(e==t.tree)return!0;if(!(e.children.length&&0==e.positions[0]&&e.children[0]instanceof q))break;e=e.children[0]}return!1}}class L{constructor(e){var t;this.fragments=e,this.curTo=0,this.fragI=0,e.length?(e=this.curFrag=e[0],this.curTo=null!=(t=e.tree.prop(M))?t:e.to,this.inner=new P(e.tree,-e.offset)):this.curFrag=this.inner=null}hasNode(e){for(;this.curFrag&&e.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=e.from&&this.curTo>=e.to&&this.inner.hasNode(e)}nextFrag(){var e,t;this.fragI++,this.fragI==this.fragments.length?this.curFrag=this.inner=null:(t=this.curFrag=this.fragments[this.fragI],this.curTo=null!=(e=t.tree.prop(M))?e:t.to,this.inner=new P(t.tree,-t.offset))}findMounts(e,r){var n,a=[];if(this.inner){this.inner.cursor.moveTo(e,1);for(let t=this.inner.cursor.node;t;t=t.parent){var i=null==(n=t.tree)?void 0:n.prop(W.mounted);if(i&&i.parser==r)for(let e=this.fragI;e<this.fragments.length;e++){var o=this.fragments[e];if(o.from>=t.to)break;o.tree==this.curFrag.tree&&a.push({frag:o,pos:t.from-o.offset,mount:i})}}}return a}}function y(r,n){let a=null,i=n;for(let e=1,t=0;e<r.length;e++)for(var o=r[e-1].to,s=r[e].from;t<i.length;t++){var l=i[t];if(l.from>=s)break;l.to<=o||(a||(i=a=n.slice()),l.from<o?(a[t]=new b(l.from,o),l.to>s&&a.splice(t+1,0,new b(s,l.to))):l.to>s?a[t--]=new b(s,l.to):a.splice(t--,1))}return i}function T(e,a){var i=[];for(let{pos:t,mount:r,frag:n}of e){var o=t+(r.overlay?r.overlay[0].from:0),s=o+r.tree.length,l=Math.max(n.from,o),c=Math.min(n.to,s);if(r.overlay){var u=function(e,t,r,n){let a=0,i=0,o=!1,s=!1,l=-1e9;for(var c=[];;){var u,d,f=a==e.length?1e9:o?e[a].to:e[a].from,p=i==t.length?1e9:s?t[i].to:t[i].from;if(o!=s&&(u=Math.max(l,r))<(d=Math.min(f,p,n))&&c.push(new b(u,d)),1e9==(l=Math.min(f,p)))break;f==l&&(o?(o=!1,a++):o=!0),p==l&&(s?(s=!1,i++):s=!0)}return c}(a,r.overlay.map(e=>new b(e.from+t,e.to+t)),l,c);for(let e=0,t=l;;e++){var d=e==u.length,f=d?c:u[e].from;if(f>t&&i.push(new R(t,f,r.tree,-o,n.from>=t||n.openStart,n.to<=f||n.openEnd)),d)break;t=u[e].to}}else i.push(new R(l,c,r.tree,-o,n.from>=o||n.openStart,n.to<=s||n.openEnd))}return i}p.DefaultBufferLength=i,p.MountedTree=v,p.NodeProp=W,p.NodeSet=class F{constructor(t){this.types=t;for(let e=0;e<t.length;e++)if(t[e].id!=e)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...t){var r,n=[];for(r of this.types){let e=null;for(var a of t)(a=a(r))&&((e=e||Object.assign({},r.props))[a[0].id]=a[1]);n.push(e?new E(r.name,e,r.id,r.flags):r)}return new F(n)}},p.NodeType=E,p.NodeWeakMap=class{constructor(){this.map=new WeakMap}setBuffer(e,t,r){let n=this.map.get(e);n||this.map.set(e,n=new Map),n.set(t,r)}getBuffer(e,t){e=this.map.get(e);return e&&e.get(t)}set(e,t){e instanceof O?this.setBuffer(e.context.buffer,e.index,t):e instanceof S&&this.map.set(e.tree,t)}get(e){return e instanceof O?this.getBuffer(e.context.buffer,e.index):e instanceof S?this.map.get(e.tree):void 0}cursorSet(e,t){e.buffer?this.setBuffer(e.buffer.buffer,e.index,t):this.map.set(e.tree,t)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}},p.Parser=class{startParse(e,t,r){return"string"==typeof e&&(e=new N(e)),r=r?r.length?r.map(e=>new b(e.from,e.to)):[new b(0,0)]:[new b(0,e.length)],this.createParse(e,t||[],r)}parse(e,t,r){for(var n=this.startParse(e,t,r);;){var a=n.advance();if(a)return a}}},p.Tree=q,p.TreeBuffer=$,p.TreeCursor=k,p.TreeFragment=R,p.parseMixed=function(a){return(e,t,r,n)=>new x(e,a,t,r,n)}}}return H1}var V1,W1,q1,$1={};function z1(){if(V1)return $1;V1=1,Object.defineProperty($1,"__esModule",{value:!0});var y=G1();let n=0;class c{constructor(e,t,r){this.set=e,this.base=t,this.modified=r,this.id=n++}static define(e){if(null!=e&&e.base)throw new Error("Can not derive from a modified tag");var t=new c([],null,[]);if(t.set.push(t),e)for(var r of e.set)t.set.push(r);return t}static defineModifier(){let t=new u;return e=>-1<e.modified.indexOf(t)?e:u.get(e.base||e,e.modified.concat(t).sort((e,t)=>e.id-t.id))}}let e=0;class u{constructor(){this.instances=[],this.id=e++}static get(n,a){if(!a.length)return n;var e=a[0].instances.find(e=>{return e.base==n&&(t=a,r=e.modified,t.length==r.length)&&t.every((e,t)=>e==r[t]);var t,r});if(e)return e;var t,r=[],i=new c(r,n,a);for(t of a)t.instances.push(i);var o,s=function(n){var a=[[]];for(let r=0;r<n.length;r++)for(let e=0,t=a.length;e<t;e++)a.push(a[e].concat(n[r]));return a.sort((e,t)=>t.length-e.length)}(a);for(o of n.set)if(!o.modified.length)for(var l of s)r.push(u.get(o,l));return i}}const d=new y.NodeProp;class T{constructor(e,t,r,n){this.tags=e,this.mode=t,this.context=r,this.next=n}get opaque(){return 0==this.mode}get inherit(){return 1==this.mode}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}function t(e,t){let a=Object.create(null);for(var r of e)if(Array.isArray(r.tag))for(var n of r.tag)a[n.id]=r.class;else a[r.tag.id]=r.class;let{scope:i,all:o=null}=t||{};return{style:e=>{let t=o;for(var r of e)for(var n of r.set){n=a[n.id];if(n){t=t?t+" "+n:n;break}}return t},scope:i}}T.empty=new T([],2,null);class i{constructor(e,t,r){this.at=e,this.highlighters=t,this.span=r,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(a,i,o,s,l){let{type:t,from:c,to:u}=a;if(!(o<=c||u<=i)){t.isTop&&(l=this.highlighters.filter(e=>!e.scope||e.scope(t)));let n=s;var e=b(a)||T.empty,r=function(e,t){let r=null;for(var n of e){n=n.style(t);n&&(r=r?r+" "+n:n)}return r}(l,e.tags);if(r&&(n&&(n+=" "),n+=r,1==e.mode)&&(s+=(s?" ":"")+r),this.startSpan(Math.max(i,c),n),!e.opaque){let r=a.tree&&a.tree.prop(y.NodeProp.mounted);if(r&&r.overlay){var d=a.node.enter(r.overlay[0].from+c,1),f=this.highlighters.filter(e=>!e.scope||e.scope(r.tree.type)),p=a.firstChild();for(let e=0,t=c;;e++){var h=e<r.overlay.length?r.overlay[e]:null,g=h?h.from+c:u,m=Math.max(i,t),_=Math.min(o,g);if(m<_&&p)for(;a.from<_&&(this.highlightRange(a,m,_,s,l),this.startSpan(Math.min(_,a.to),n),!(a.to>=g))&&a.nextSibling(););if(!h||o<g)break;(t=h.to+c)>i&&(this.highlightRange(d.cursor(),Math.max(i,h.from+c),Math.min(o,t),"",f),this.startSpan(Math.min(o,t),n))}p&&a.parent()}else if(a.firstChild()){r&&(s="");do{if(!(a.to<=i)){if(a.from>=o)break;this.highlightRange(a,i,o,s,l),this.startSpan(Math.min(o,a.to),n)}}while(a.nextSibling());a.parent()}}}}}function b(e){let t=e.type.prop(d);for(;t&&t.context&&!e.matchContext(t.context);)t=t.next;return t||null}var r=c.define,a=r(),o=r(),s=r(o),l=r(o),f=r(),p=r(f),h=r(f),g=r(),m=r(g),_=r(),v=r(),E=r(),S=r(E),A=r(),a={comment:a,lineComment:r(a),blockComment:r(a),docComment:r(a),name:o,variableName:r(o),typeName:s,tagName:r(s),propertyName:l,attributeName:r(l),className:r(o),labelName:r(o),namespace:r(o),macroName:r(o),literal:f,string:p,docString:r(p),character:r(p),attributeValue:r(p),number:h,integer:r(h),float:r(h),bool:r(f),regexp:r(f),escape:r(f),color:r(f),url:r(f),keyword:_,self:r(_),null:r(_),atom:r(_),unit:r(_),modifier:r(_),operatorKeyword:r(_),controlKeyword:r(_),definitionKeyword:r(_),moduleKeyword:r(_),operator:v,derefOperator:r(v),arithmeticOperator:r(v),logicOperator:r(v),bitwiseOperator:r(v),compareOperator:r(v),updateOperator:r(v),definitionOperator:r(v),typeOperator:r(v),controlOperator:r(v),punctuation:E,separator:r(E),bracket:S,angleBracket:r(S),squareBracket:r(S),paren:r(S),brace:r(S),content:g,heading:m,heading1:r(m),heading2:r(m),heading3:r(m),heading4:r(m),heading5:r(m),heading6:r(m),contentSeparator:r(g),list:r(g),quote:r(g),emphasis:r(g),strong:r(g),link:r(g),monospace:r(g),strikethrough:r(g),inserted:r(),deleted:r(),changed:r(),invalid:r(),meta:A,documentMeta:r(A),annotation:r(A),processingInstruction:r(A),definition:c.defineModifier(),constant:c.defineModifier(),function:c.defineModifier(),standard:c.defineModifier(),local:c.defineModifier(),special:c.defineModifier()},s=t([{tag:a.link,class:"tok-link"},{tag:a.heading,class:"tok-heading"},{tag:a.emphasis,class:"tok-emphasis"},{tag:a.strong,class:"tok-strong"},{tag:a.keyword,class:"tok-keyword"},{tag:a.atom,class:"tok-atom"},{tag:a.bool,class:"tok-bool"},{tag:a.url,class:"tok-url"},{tag:a.labelName,class:"tok-labelName"},{tag:a.inserted,class:"tok-inserted"},{tag:a.deleted,class:"tok-deleted"},{tag:a.literal,class:"tok-literal"},{tag:a.string,class:"tok-string"},{tag:a.number,class:"tok-number"},{tag:[a.regexp,a.escape,a.special(a.string)],class:"tok-string2"},{tag:a.variableName,class:"tok-variableName"},{tag:a.local(a.variableName),class:"tok-variableName tok-local"},{tag:a.definition(a.variableName),class:"tok-variableName tok-definition"},{tag:a.special(a.variableName),class:"tok-variableName2"},{tag:a.definition(a.propertyName),class:"tok-propertyName tok-definition"},{tag:a.typeName,class:"tok-typeName"},{tag:a.namespace,class:"tok-namespace"},{tag:a.className,class:"tok-className"},{tag:a.macroName,class:"tok-macroName"},{tag:a.propertyName,class:"tok-propertyName"},{tag:a.operator,class:"tok-operator"},{tag:a.comment,class:"tok-comment"},{tag:a.meta,class:"tok-meta"},{tag:a.invalid,class:"tok-invalid"},{tag:a.punctuation,class:"tok-punctuation"}]);return $1.Tag=c,$1.classHighlighter=s,$1.getStyleTags=b,$1.highlightTree=function(e,t,r,n=0,a=e.length){(t=new i(n,Array.isArray(t)?t:[t],r)).highlightRange(e.cursor(),n,a,"",t.highlighters),t.flush(a)},$1.styleTags=function(t){var r,a=Object.create(null);for(r in t){let e=t[r];Array.isArray(e)||(e=[e]);for(var i of r.split(" "))if(i){let t=[],r=2,n=i;for(let e=0;;){if("..."==n&&0<e&&e+3==i.length){r=1;break}var o=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(n);if(!o)throw new RangeError("Invalid path: "+i);if(t.push("*"==o[0]?"":'"'==o[0][0]?JSON.parse(o[0]):o[0]),(e+=o[0].length)==i.length)break;o=i[e++];if(e==i.length&&"!"==o){r=0;break}if("/"!=o)throw new RangeError("Invalid path: "+i);n=i.slice(e)}var s=t.length-1,l=t[s];if(!l)throw new RangeError("Invalid path: "+i);s=new T(e,r,0<s?t.slice(0,s):null);a[l]=s.sort(a[l])}}return d.add(a)},$1.tagHighlighter=t,$1.tags=a,$1}function K1(){if(W1)return He;W1=1,Object.defineProperty(He,"__esModule",{value:!0});var u=G1(),o=I1(),s=B1(),l=z1(),U=D1();const c=new u.NodeProp;function i(t){return o.Facet.define({combine:t?e=>e.concat(t):void 0})}const B=new u.NodeProp;class d{constructor(e,t,r=[],n=""){this.data=e,this.name=n,o.EditorState.prototype.hasOwnProperty("tree")||Object.defineProperty(o.EditorState.prototype,"tree",{get(){return k(this)}}),this.parser=t,this.extension=[m.of(this),o.EditorState.languageData.of((e,t,r)=>{var n=j(e,t,r),a=n.type.prop(c);if(!a)return[];var i=e.facet(a),a=n.type.prop(B);if(a){var o,s,l=n.resolve(t-n.from,r);for(o of a)if(o.test(l,e))return s=e.facet(o.facet),"replace"==o.type?s:s.concat(i)}return i})].concat(r)}isActiveAt(e,t,r=-1){return j(e,t,r).type.prop(c)==this.data}findRegions(e){var t=e.facet(m);if((null==t?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let o=[],s=(t,r)=>{if(t.prop(c)==this.data)o.push({from:r,to:r+t.length});else{var e=t.prop(u.NodeProp.mounted);if(e){if(e.tree.prop(c)==this.data){if(e.overlay)for(var n of e.overlay)o.push({from:n.from+r,to:n.to+r});else o.push({from:r,to:r+t.length});return}if(e.overlay){var a=o.length;if(s(e.tree,e.overlay[0].from+r),o.length>a)return}}for(let e=0;e<t.children.length;e++){var i=t.children[e];i instanceof u.Tree&&s(i,t.positions[e]+r)}}};return s(k(e),0),o}get allowsNesting(){return!0}}function j(e,t,r){let n=e.facet(m),a=k(e).topNode;if(!n||n.allowsNesting)for(let e=a;e;e=e.enter(t,r,u.IterMode.ExcludeBuffers))e.type.isTop&&(a=e);return a}d.setState=o.StateEffect.define();class r extends d{constructor(e,t,r){super(e,t,[],r),this.parser=t}static define(e){let t=i(e.languageData);return new r(t,e.parser.configure({props:[c.add(e=>e.isTop?t:void 0)]}),e.name)}configure(e,t){return new r(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function k(e){e=e.field(d.state,!1);return e?e.tree:u.Tree.empty}function n(e,t,r=50){var n,e=null==(e=e.field(d.state,!1))?void 0:e.context;return e?(n=e.viewport,e.updateViewport({from:0,to:t}),r=e.isDone(t)||e.work(r,t)?e.tree:null,e.updateViewport(n),r):null}class t{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){var r=this.cursorPos-this.string.length;return e<r||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-r,t-r)}}let f=null;class p{constructor(e,t,r=[],n,a,i,o,s){this.parser=e,this.state=t,this.fragments=r,this.tree=n,this.treeLen=a,this.viewport=i,this.skipped=o,this.scheduleOn=s,this.parse=null,this.tempSkipped=[]}static create(e,t,r){return new p(e,t,[],u.Tree.empty,0,r,[],null)}startParse(){return this.parser.startParse(new t(this.state.doc),this.fragments)}work(r,n){return null!=n&&n>=this.state.doc.length&&(n=void 0),this.tree!=u.Tree.empty&&this.isDone(null!=n?n:this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var e;if("number"==typeof r){let e=Date.now()+r;r=()=>Date.now()>e}for(this.parse||(this.parse=this.startParse()),null!=n&&(null==this.parse.stoppedAt||this.parse.stoppedAt>n)&&n<this.state.doc.length&&this.parse.stopAt(n);;){var t=this.parse.advance();if(t){if(this.fragments=this.withoutTempSkipped(u.TreeFragment.addTree(t,this.fragments,null!=this.parse.stoppedAt)),this.treeLen=null!=(e=this.parse.stoppedAt)?e:this.state.doc.length,this.tree=t,this.parse=null,!(this.treeLen<(null!=n?n:this.state.doc.length)))return!0;this.parse=this.startParse()}if(r())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(u.TreeFragment.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){var t=f;f=this;try{return e()}finally{f=t}}withoutTempSkipped(e){for(var t;t=this.tempSkipped.pop();)e=H(e,t.from,t.to);return e}changes(e,t){let{fragments:r,tree:n,treeLen:i,viewport:o,skipped:s}=this;if(this.takeTree(),!e.empty){let a=[];if(e.iterChangedRanges((e,t,r,n)=>a.push({fromA:e,toA:t,fromB:r,toB:n})),r=u.TreeFragment.applyChanges(r,a),n=u.Tree.empty,i=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){s=[];for(var l of this.skipped){var c=e.mapPos(l.from,1),l=e.mapPos(l.to,-1);c<l&&s.push({from:c,to:l})}}}return new p(this.parser,t,r,n,i,o,s,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;var e=this.skipped.length;for(let e=0;e<this.skipped.length;e++){var{from:r,to:n}=this.skipped[e];r<t.to&&n>t.from&&(this.fragments=H(this.fragments,r,n),this.skipped.splice(e--,1))}return!(this.skipped.length>=e||(this.reset(),0))}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(i){return new class extends u.Parser{createParse(e,t,r){let n=r[0].from,a=r[r.length-1].to;return{parsedPos:n,advance(){var e=f;if(e){for(var t of r)e.tempSkipped.push(t);i&&(e.scheduleOn=e.scheduleOn?Promise.all([e.scheduleOn,i]):i)}return this.parsedPos=a,new u.Tree(u.NodeType.none,[],[],a-n)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);var t=this.fragments;return this.treeLen>=e&&t.length&&0==t[0].from&&t[0].to>=e}static get(){return f}}function H(e,t,r){return u.TreeFragment.applyChanges(e,[{fromA:t,toA:r,fromB:t,toB:r}])}class h{constructor(e){this.context=e,this.tree=e.tree}apply(e){var t;return e.docChanged||this.tree!=this.context.tree?(t=this.context.changes(e.changes,e.state),e=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to),t.work(20,e)||t.takeTree(),new h(t)):this}static init(e){var t=Math.min(3e3,e.doc.length),e=p.create(e.facet(m).parser,e,{from:0,to:t});return e.work(20,t)||e.takeTree(),new h(e)}}d.state=o.StateField.define({create:h.init,update(e,t){for(var r of t.effects)if(r.is(d.setState))return r.value;return t.startState.facet(m)!=t.state.facet(m)?h.init(t.state):e.apply(t)}});let G=e=>{let t=setTimeout(()=>e(),500);return()=>clearTimeout(t)};"undefined"!=typeof requestIdleCallback&&(G=e=>{let t=-1,r=setTimeout(()=>{t=requestIdleCallback(e,{timeout:400})},100);return()=>t<0?clearTimeout(r):cancelIdleCallback(t)});const g="undefined"!=typeof navigator&&null!=(e=navigator.scheduling)&&e.isInputPending?()=>navigator.scheduling.isInputPending():null,V=s.ViewPlugin.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){var t=this.view.state.field(d.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),e.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){var e,t;this.working||(e=this.view["state"],(t=e.field(d.state)).tree==t.context.tree&&t.context.isDone(e.doc.length))||(this.working=G(this.work))}work(t){this.working=null;var r=Date.now();if(this.chunkEnd<r&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=r+3e4,this.chunkBudget=3e3),!(this.chunkBudget<=0)){var{state:n,viewport:{to:a}}=this.view,i=n.field(d.state);if(i.tree!=i.context.tree||!i.context.isDone(a+1e5)){let e=Date.now()+Math.min(this.chunkBudget,100,t&&!g?Math.max(25,t.timeRemaining()-5):1e9);t=i.context.treeLen<a&&n.doc.length>a+1e3,n=i.context.work(()=>g&&g()||Date.now()>e,a+(t?0:1e5));this.chunkBudget-=Date.now()-r,(n||this.chunkBudget<=0)&&(i.context.takeTree(),this.view.dispatch({effects:d.setState.of(new h(i.context))})),0<this.chunkBudget&&(!n||t)&&this.scheduleWork(),this.checkAsyncSchedule(i.context)}}}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(e=>s.logException(this.view.state,e)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||0<this.workScheduled)}},{eventHandlers:{focus(){this.scheduleWork()}}}),m=o.Facet.define({combine(e){return e.length?e[0]:null},enables:t=>[d.state,V,s.EditorView.contentAttributes.compute([t],e=>{e=e.facet(t);return e&&e.name?{"data-language":e.name}:{}})]});const _=o.Facet.define(),y=o.Facet.define({combine:e=>{if(!e.length)return"  ";let t=e[0];if(!t||/\S/.test(t)||Array.from(t).some(e=>e!=t[0]))throw new Error("Invalid indent unit: "+JSON.stringify(e[0]));return t}});function T(e){var t=e.facet(y);return 9==t.charCodeAt(0)?e.tabSize*t.length:t.length}function b(e,t){let r="",n=e.tabSize,a=e.facet(y)[0];if("\t"==a){for(;n<=t;)r+="\t",t-=n;a=" "}for(let e=0;e<t;e++)r+=a;return r}function v(e,t){for(var r of(e=e instanceof o.EditorState?new E(e):e).state.facet(_)){r=r(e,t);if(void 0!==r)return r}var n,a,i=k(e.state);return i.length>=t?(n=e,a=t,q(i.resolveInner(a).enterUnfinishedNodesBefore(a),a,n)):null}class E{constructor(e,t={}){this.state=e,this.options=t,this.unit=T(e)}lineAt(e,t=1){var r=this.state.doc.lineAt(e),{simulateBreak:n,simulateDoubleBreak:a}=this.options;return null!=n&&n>=r.from&&n<=r.to?a&&n==e?{text:"",from:e}:(t<0?n<e:n<=e)?{text:r.text.slice(n-r.from),from:n}:{text:r.text.slice(0,n-r.from),from:r.from}:r}textAfterPos(e,t=1){var r;return this.options.simulateDoubleBreak&&e==this.options.simulateBreak?"":({text:t,from:r}=this.lineAt(e,t),t.slice(e-r,Math.min(t.length,e+100-r)))}column(e,t=1){var{text:t,from:r}=this.lineAt(e,t);let n=this.countColumn(t,e-r);e=this.options.overrideIndentation?this.options.overrideIndentation(r):-1;return-1<e&&(n+=e-this.countColumn(t,t.search(/\S|$/))),n}countColumn(e,t=e.length){return o.countColumn(e,this.state.tabSize,t)}lineIndent(e,t=1){var{text:e,from:t}=this.lineAt(e,t),r=this.options.overrideIndentation;if(r){r=r(t);if(-1<r)return r}return this.countColumn(e,e.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const W=new u.NodeProp;function q(e,t,r){for(;e;e=e.parent){var n=function(e){var t=e.type.prop(W);if(t)return t;let r=e.firstChild,n;if(r&&(n=r.type.prop(u.NodeProp.closedBy))){let t=e.lastChild,r=t&&-1<n.indexOf(t.name);return e=>{return z(e,!0,1,void 0,r&&((e=e).pos!=e.options.simulateBreak||!e.options.simulateDoubleBreak)?t.from:void 0)}}return null==e.parent?$:null}(e);if(n)return n(a.create(r,t,e))}return null}function $(){return 0}class a extends E{constructor(e,t,r){super(e.state,e.options),this.base=e,this.pos=t,this.node=r}static create(e,t,r){return new a(e,t,r)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(t){let r=this.state.doc.lineAt(t.from);for(;;){let e=t.resolve(r.from);for(;e.parent&&e.parent.from==e.from;)e=e.parent;if(function(t,r){for(let e=r;e;e=e.parent)if(t==e)return 1;return}(e,t))break;r=this.state.doc.lineAt(e.from)}return this.lineIndent(r.from)}continue(){var e=this.node.parent;return e?q(e,this.pos,this.base):0}}function z(e,t,r,n,a){var i=e.textAfter,o=i.match(/^\s*/)[0].length,i=n&&i.slice(o,o+n.length)==n||a==e.pos+o,n=t?function(e){var t=e.node,r=t.childAfter(t.from),n=t.lastChild;if(!r)return null;var a=e.options.simulateBreak,e=e.state.doc.lineAt(r.from),i=null==a||a<=e.from?e.to:Math.min(e.to,a);for(let e=r.to;;){var o=t.childAfter(e);if(!o||o==n)return null;if(!o.type.isSkipped)return o.from<i?r:null;e=o.to}}(e):null;return n?i?e.column(n.from):e.column(n.to):e.baseIndent+(i?0:e.unit*r)}const K=o.Facet.define(),Y=new u.NodeProp;function S(e,r,n){for(var t of e.facet(K)){t=t(e,r,n);if(t)return t}{var a=e,i=r,o=n,s,l=k(a);if(l.length<o)return null;let t=null;for(let e=l.resolveInner(o,1);e;e=e.parent)if(!(e.to<=o||e.from>o)){if(t&&e.from<i)break;var c,u=e.type.prop(Y);u&&(e.to<l.length-50||l.length==a.doc.length||(c=e,s=void 0,!(s=c.lastChild))||s.to!=c.to||!s.type.isError)&&(c=u(e,a))&&c.from<=o&&c.from>=i&&c.to>o&&(t=c)}return t}}function J(e,t){var r=t.mapPos(e.from,1),t=t.mapPos(e.to,-1);return t<=r?void 0:{from:r,to:t}}const A=o.StateEffect.define({map:J}),O=o.StateEffect.define({map:J});function C(e){var r=[];for(let{head:t}of e.state.selection.ranges)r.some(e=>e.from<=t&&e.to>=t)||r.push(e.lineBlockAt(t));return r}const w=o.StateField.define({create(){return s.Decoration.none},update(e,t){e=e.map(t.changes);for(let r of t.effects){var n;r.is(A)&&!function(e,r,n){let a=!1;return e.between(r,r,(e,t)=>{e==r&&t==n&&(a=!0)}),a}(e,r.value.from,r.value.to)?(n=t.state.facet(P)["preparePlaceholder"],n=n?s.Decoration.replace({widget:new ae(n(t.state,r.value))}):ne,e=e.update({add:[n.range(r.value.from,r.value.to)]})):r.is(O)&&(e=e.update({filter:(e,t)=>r.value.from!=e||r.value.to!=t,filterFrom:r.value.from,filterTo:r.value.to}))}if(t.selection){let r=!1,n=t.selection.main["head"];e.between(n,n,(e,t)=>{e<n&&t>n&&(r=!0)}),r&&(e=e.update({filterFrom:n,filterTo:n,filter:(e,t)=>t<=n||e>=n}))}return e},provide:e=>s.EditorView.decorations.from(e),toJSON(e,t){let r=[];return e.between(0,t.doc.length,(e,t)=>{r.push(e,t)}),r},fromJSON(t){if(!Array.isArray(t)||t.length%2)throw new RangeError("Invalid JSON for fold state");var r=[];for(let e=0;e<t.length;){var n=t[e++],a=t[e++];if("number"!=typeof n||"number"!=typeof a)throw new RangeError("Invalid JSON for fold state");r.push(ne.range(n,a))}return s.Decoration.set(r,!0)}});function R(e,t,r){let n=null;return null!=(e=e.field(w,!1))&&e.between(t,r,(e,t)=>{(!n||n.from>e)&&(n={from:e,to:t})}),n}function I(e,t){return e.field(w,!1)?t:t.concat(o.StateEffect.appendConfig.of(N()))}var e=e=>{for(var t of C(e)){t=S(e.state,t.from,t.to);if(t)return e.dispatch({effects:I(e.state,[A.of(t),M(e,t)])}),!0}return!1},Z=e=>{if(!e.state.field(w,!1))return!1;var t,r=[];for(t of C(e)){var n=R(e.state,t.from,t.to);n&&r.push(O.of(n),M(e,n,!1))}return r.length&&e.dispatch({effects:r}),0<r.length};function M(e,t,r=!0){var n=e.state.doc.lineAt(t.from).number,t=e.state.doc.lineAt(t.to).number;return s.EditorView.announce.of(`${e.state.phrase(r?"Folded lines":"Unfolded lines")} ${n} ${e.state.phrase("to")} ${t}.`)}var Q=t=>{var r=t["state"],n=[];for(let e=0;e<r.doc.length;){var a=t.lineBlockAt(e),i=S(r,a.from,a.to);i&&n.push(A.of(i)),e=(i?t.lineBlockAt(i.to):a).to+1}return n.length&&t.dispatch({effects:I(t.state,n)}),!!n.length},X=e=>{var t=e.state.field(w,!1);if(!t||!t.size)return!1;let r=[];return t.between(0,e.state.doc.length,(e,t)=>{r.push(O.of({from:e,to:t}))}),e.dispatch({effects:r}),!0};var ee=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:e},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:Z},{key:"Ctrl-Alt-[",run:Q},{key:"Ctrl-Alt-]",run:X}];const te={placeholderDOM:null,preparePlaceholder:null,placeholderText:"…"},P=o.Facet.define({combine(e){return o.combineConfig(e,te)}});function N(e){var t=[w,se];return e&&t.push(P.of(e)),t}function re(r,e){var t=r["state"],n=t.facet(P),a=e=>{var t=r.lineBlockAt(r.posAtDOM(e.target)),t=R(r.state,t.from,t.to);t&&r.dispatch({effects:O.of(t)}),e.preventDefault()};return n.placeholderDOM?n.placeholderDOM(r,a,e):((e=document.createElement("span")).textContent=n.placeholderText,e.setAttribute("aria-label",t.phrase("folded code")),e.title=t.phrase("unfold"),e.className="cm-foldPlaceholder",e.onclick=a,e)}const ne=s.Decoration.replace({widget:new class extends s.WidgetType{toDOM(e){return re(e,null)}}});class ae extends s.WidgetType{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return re(e,this.value)}}const ie={openText:"⌄",closedText:"›",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class oe extends s.GutterMarker{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){var t;return this.config.markerDOM?this.config.markerDOM(this.open):((t=document.createElement("span")).textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t)}}const se=s.EditorView.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class D{constructor(e,t){this.specs=e;let r;function n(e){var t=U.StyleModule.newName();return(r=r||Object.create(null))["."+t]=e,t}var a="string"==typeof t.all?t.all:t.all?n(t.all):void 0;const i=t.scope;this.scope=i instanceof d?e=>e.prop(c)==i.data:i?e=>e==i:void 0,this.style=l.tagHighlighter(e.map(e=>({tag:e.tag,class:e.class||n(Object.assign({},e,{tag:null}))})),{all:a}).style,this.module=r?new U.StyleModule(r):null,this.themeType=t.themeType}static define(e,t){return new D(e,t||{})}}const le=o.Facet.define(),ce=o.Facet.define({combine(e){return e.length?[e[0]]:null}});function x(e){var t=e.facet(le);return t.length?t:e.facet(ce)}const ue=o.Prec.high(s.ViewPlugin.fromClass(class{constructor(e){this.markCache=Object.create(null),this.tree=k(e.state),this.decorations=this.buildDeco(e,x(e.state))}update(e){var t=k(e.state),r=x(e.state),n=r!=x(e.startState);t.length<e.view.viewport.to&&!n&&t.type==this.tree.type?this.decorations=this.decorations.map(e.changes):(t!=this.tree||e.viewportChanged||n)&&(this.tree=t,this.decorations=this.buildDeco(e.view,r))}buildDeco(e,t){if(!t||!this.tree.length)return s.Decoration.none;let n=new o.RangeSetBuilder;for(var{from:r,to:a}of e.visibleRanges)l.highlightTree(this.tree,t,(e,t,r)=>{n.add(e,t,this.markCache[r]||(this.markCache[r]=s.Decoration.mark({class:r})))},r,a);return n.finish()}},{decorations:e=>e.decorations}));var de,fe,pe=D.define([{tag:l.tags.meta,color:"#404740"},{tag:l.tags.link,textDecoration:"underline"},{tag:l.tags.heading,textDecoration:"underline",fontWeight:"bold"},{tag:l.tags.emphasis,fontStyle:"italic"},{tag:l.tags.strong,fontWeight:"bold"},{tag:l.tags.strikethrough,textDecoration:"line-through"},{tag:l.tags.keyword,color:"#708"},{tag:[l.tags.atom,l.tags.bool,l.tags.url,l.tags.contentSeparator,l.tags.labelName],color:"#219"},{tag:[l.tags.literal,l.tags.inserted],color:"#164"},{tag:[l.tags.string,l.tags.deleted],color:"#a11"},{tag:[l.tags.regexp,l.tags.escape,l.tags.special(l.tags.string)],color:"#e40"},{tag:l.tags.definition(l.tags.variableName),color:"#00f"},{tag:l.tags.local(l.tags.variableName),color:"#30a"},{tag:[l.tags.typeName,l.tags.namespace],color:"#085"},{tag:l.tags.className,color:"#167"},{tag:[l.tags.special(l.tags.variableName),l.tags.macroName],color:"#256"},{tag:l.tags.definition(l.tags.propertyName),color:"#00c"},{tag:l.tags.comment,color:"#940"},{tag:l.tags.invalid,color:"#f00"}]),he=s.EditorView.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}});const ge=o.Facet.define({combine(e){return o.combineConfig(e,{afterCursor:!0,brackets:"()[]{}",maxScanDistance:1e4,renderMatch:ye})}}),me=s.Decoration.mark({class:"cm-matchingBracket"}),_e=s.Decoration.mark({class:"cm-nonmatchingBracket"});function ye(e){var t=[],r=e.matched?me:_e;return t.push(r.range(e.start.from,e.start.to)),e.end&&t.push(r.range(e.end.from,e.end.to)),t}const Te=[o.StateField.define({create(){return s.Decoration.none},update(e,t){if(!t.docChanged&&!t.selection)return e;let r=[];var n,a,i=t.state.facet(ge);for(n of t.state.selection.ranges)n.empty&&(a=L(t.state,n.head,-1,i)||0<n.head&&L(t.state,n.head-1,1,i)||i.afterCursor&&(L(t.state,n.head,1,i)||n.head<t.state.doc.length&&L(t.state,n.head+1,-1,i)))&&(r=r.concat(i.renderMatch(a,t.state)));return s.Decoration.set(r,!0)},provide:e=>s.EditorView.decorations.from(e)}),he];const be=new u.NodeProp;function ve(e,t,r){var n=e.prop(t<0?u.NodeProp.openedBy:u.NodeProp.closedBy);if(n)return n;if(1==e.name.length){n=r.indexOf(e.name);if(-1<n&&n%2==(t<0?1:0))return[r[n+t]]}return null}function Ee(e){var t=e.type.prop(be);return t?t(e.node):e}function L(e,i,o,a={}){var s=a.maxScanDistance||1e4,l=a.brackets||"()[]{}",a=k(e),c=a.resolveInner(i,o);for(let a=c;a;a=a.parent){var u=ve(a.type,o,l);if(u&&a.from<a.to){var d,f=Ee(a);if(f&&(0<o?i>=f.from&&i<f.to:i>f.from&&i<=f.to)){var p=o;var h=a;var g=u;var m=l;let e=h.parent,t={from:f.from,to:f.to},r=0,n=null==e?void 0:e.cursor();if(n&&(p<0?n.childBefore(h.from):n.childAfter(h.to)))do{if(p<0?n.to<=h.from:n.from>=h.to){if(0==r&&-1<g.indexOf(n.type.name)&&n.from<n.to)return d=Ee(n),{start:t,end:d?{from:d.from,to:d.to}:void 0,matched:!0};if(ve(n.type,p,m))r++;else if(ve(n.type,-p,m)){if(0==r)return d=Ee(n),{start:t,end:d&&d.from<d.to?{from:d.from,to:d.to}:void 0,matched:!1};r--}}}while(p<0?n.prevSibling():n.nextSibling());return{start:t,matched:!1};return}}}{var _=i,y=o,T=a,b=c.type,v=s,E=l,a=y<0?e.sliceDoc(_-1,_):e.sliceDoc(_,_+1),S=E.indexOf(a);if(S<0||S%2==0!=0<y)return null;let r={from:y<0?_-1:_,to:0<y?_+1:_},t=e.doc.iterRange(_,0<y?e.doc.length:0),n=0;for(let e=0;!t.next().done&&e<=v;){var A=t.value,O=(y<0&&(e+=A.length),_+e*y);for(let e=0<y?0:A.length-1,t=0<y?A.length:-1;e!=t;e+=y){var C=E.indexOf(A[e]);if(!(C<0||T.resolveInner(O+e,1).type!=b))if(C%2==0==0<y)n++;else{if(1==n)return{start:r,end:{from:O+e,to:O+e+1},matched:C>>1==S>>1};n--}}0<y&&(e+=A.length)}return t.done?{start:r,matched:!1}:null}}function Se(t,r,n,a=0,e=0){null==r&&-1==(r=t.search(/[^\s\u00a0]/))&&(r=t.length);let i=e;for(let e=a;e<r;e++)9==t.charCodeAt(e)?i+=n-i%n:i++;return i}class Ae{constructor(e,t,r,n){this.string=e,this.tabSize=t,this.indentUnit=r,this.overrideIndent=n,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return 0==this.pos}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){var t=this.string.charAt(this.pos);let r;if(r="string"==typeof e?t==e:t&&(e instanceof RegExp?e.test(t):e(t)))return++this.pos,t}eatWhile(e){for(var t=this.pos;this.eat(e););return this.pos>t}eatSpace(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){e=this.string.indexOf(e,this.pos);if(-1<e)return this.pos=e,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Se(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var e;return null!=(e=this.overrideIndent)?e:Se(this.string,null,this.tabSize)}match(e,t,r){var n;return"string"==typeof e?(n=e=>r?e.toLowerCase():e)(this.string.substr(this.pos,e.length))==n(e)?(!1!==t&&(this.pos+=e.length),!0):null:(n=this.string.slice(this.pos).match(e))&&0<n.index?null:(n&&!1!==t&&(this.pos+=n[0].length),n)}current(){return this.string.slice(this.start,this.pos)}}function Oe(e){if("object"!=typeof e)return e;var t,r={};for(t in e){var n=e[t];r[t]=n instanceof Array?n.slice():n}return r}const Ce=new WeakMap;class ke extends d{constructor(e){var t,r=i(e.languageData);let n={name:e.name||"",token:e.token,blankLine:e.blankLine||(()=>{}),startState:e.startState||(()=>!0),copyState:e.copyState||Oe,indent:e.indent||(()=>null),languageData:e.languageData||{},tokenTable:e.tokenTable||Pe},a;super(r,new class extends u.Parser{createParse(e,t,r){return new Ie(a,e,t,r)}},[_.of((e,t)=>this.getIndent(e,t))],e.name),this.topNode=(t=r,r=u.NodeType.define({id:F.length,name:"Document",props:[c.add(()=>t)],top:!0}),F.push(r),r),(a=this).streamParser=n,this.stateAfter=new u.NodeProp({perNode:!0}),this.tokenTable=e.tokenTable?new Le(n.tokenTable):Fe}static define(e){return new ke(e)}getIndent(e,t){let r=k(e.state),n=r.resolve(t);for(;n&&n.type!=this.topNode;)n=n.parent;if(!n)return null;let a=void 0;var i=e.options["overrideIndentation"];i&&null!=(a=Ce.get(e.state))&&a<t-1e4&&(a=void 0);let o=we(this,r,0,n.from,null!==a&&void 0!==a?a:t),s,l;if(1e4<t-(s=o?(l=o.state,o.pos+1):(l=this.streamParser.startState(e.unit),0)))return null;for(;s<t;){var c=e.state.doc.lineAt(s),u=Math.min(t,c.to);if(c.length)for(var d=i?i(c.from):-1,f=new Ae(c.text,e.state.tabSize,e.unit,d<0?void 0:d);f.pos<u-c.from;)Me(this.streamParser.token,f,l);else this.streamParser.blankLine(l,e.unit);if(u==t)break;s=c.to+1}var p=e.lineAt(t);return i&&null==a&&Ce.set(e.state,p.from),this.streamParser.indent(l,/^\s*(.*)/.exec(p.text)[1],e)}get allowsNesting(){return!1}}function we(t,r,n,a,i){var e=a<=n&&n+r.length<=i&&r.prop(t.stateAfter);if(e)return{state:t.streamParser.copyState(e),pos:n+r.length};for(let e=r.children.length-1;0<=e;e--){var o=r.children[e],s=n+r.positions[e],o=o instanceof u.Tree&&s<i&&we(t,o,s,a,i);if(o)return o}return null}function Re(r,e,n,t){for(var a of e){var i=a.from+(a.openStart?25:0),o=a.to-(a.openEnd?25:0);let e=i<=n&&n<o&&we(r,a.tree,0-a.offset,n,o),t;if(e&&(t=function t(r,n,a,i,o){if(o&&a<=0&&i>=n.length)return n;o||n.type!=r.topNode||(o=!0);for(let e=n.children.length-1;0<=e;e--){var s=n.positions[e],l=n.children[e];if(s<i&&l instanceof u.Tree){if(l=t(r,l,a-s,i-s,o))return o?new u.Tree(n.type,n.children.slice(0,e).concat(l),n.positions.slice(0,e+1),s+l.length):l;break}}return null}(r,a.tree,n+a.offset,e.pos+a.offset,!1)))return{state:e.state,tree:t}}return{state:r.streamParser.startState(t?T(t):4),tree:u.Tree.empty}}class Ie{constructor(e,t,r,n){this.lang=e,this.input=t,this.fragments=r,this.ranges=n,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=n[n.length-1].to;var t=p.get(),n=n[0].from,{state:e,tree:a}=Re(e,r,n,null==t?void 0:t.state);this.state=e,this.parsedPos=this.chunkStart=n+a.length;for(let e=0;e<a.children.length;e++)this.chunks.push(a.children[e]),this.chunkPos.push(a.positions[e]);t&&this.parsedPos<t.viewport.from-1e5&&(this.state=this.lang.streamParser.startState(T(t.state)),t.skipUntilInView(this.parsedPos,t.viewport.from),this.parsedPos=t.viewport.from),this.moveRangeIndex()}advance(){var e=p.get(),t=null==this.stoppedAt?this.to:Math.min(this.to,this.stoppedAt);let r=Math.min(t,this.chunkStart+2048);for(e&&(r=Math.min(r,e.viewport.to));this.parsedPos<r;)this.parseLine(e);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=t?this.finish():e&&this.parsedPos>=e.viewport.to?(e.skipUntilInView(this.parsedPos,t),this.finish()):null}stopAt(e){this.stoppedAt=e}lineAfter(e){let t=this.input.chunk(e);var r;return this.input.lineChunks?"\n"==t&&(t=""):-1<(r=t.indexOf("\n"))&&(t=t.slice(0,r)),e+t.length<=this.to?t:t.slice(0,this.to-e)}nextLine(){let e=this.parsedPos,t=this.lineAfter(e),r=e+t.length;for(let e=this.rangeIndex;;){var n=this.ranges[e].to;if(n>=r)break;if(t=t.slice(0,n-(r-t.length)),++e==this.ranges.length)break;var n=this.ranges[e].from,a=this.lineAfter(n);t+=a,r=n+a.length}return{line:t,end:r}}skipGapsTo(e,t,r){for(;;){var n=this.ranges[this.rangeIndex].to,a=e+t;if(0<r?a<n:a<=n)break;t+=this.ranges[++this.rangeIndex].from-n}return t}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(e,t,r,n,a){var i;return 1<this.ranges.length&&(t+=a=this.skipGapsTo(t,a,1),i=this.chunk.length,r+=a=this.skipGapsTo(r,a,-1),n+=this.chunk.length-i),this.chunk.push(e,t,r,n),a}parseLine(e){let{line:t,end:r}=this.nextLine(),n=0,a=this.lang["streamParser"];var i=new Ae(t,e?e.state.tabSize:4,e?T(e.state):2);if(i.eol())a.blankLine(this.state,i.indentUnit);else for(;!i.eol();){var o=Me(a.token,i,this.state);if(o&&(n=this.emitToken(this.lang.tokenTable.resolve(o),this.parsedPos+i.start,this.parsedPos+i.pos,4,n)),1e4<i.start)break}this.parsedPos=r,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){var e=u.Tree.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:Ne,topID:0,maxBufferLength:2048,reused:this.chunkReused}),e=new u.Tree(e.type,e.children,e.positions,e.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]);this.chunks.push(e),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new u.Tree(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function Me(t,r,n){r.start=r.pos;for(let e=0;e<10;e++){var a=t(r,n);if(r.pos>r.start)return a}throw new Error("Stream parser failed to advance stream.")}const Pe=Object.create(null),F=[u.NodeType.none],Ne=new u.NodeSet(F),De=[],xe=Object.create(null);for([de,fe]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])xe[de]=Be(Pe,fe);class Le{constructor(e){this.extra=e,this.table=Object.assign(Object.create(null),xe)}resolve(e){return e?this.table[e]||(this.table[e]=Be(this.extra,e)):0}}const Fe=new Le(Pe);function Ue(e,t){-1<De.indexOf(e)||(De.push(e),console.warn(t))}function Be(e,t){let r=null;for(var n of t.split(".")){var a=e[n]||l.tags[n];a?"function"==typeof a?r?r=a(r):Ue(n,`Modifier ${n} used at start of tag`):r?Ue(n,`Tag ${n} used as modifier`):r=a:Ue(n,"Unknown highlighting tag "+n)}return r?(t=t.replace(/ /g,"_"),t=u.NodeType.define({id:F.length,name:t,props:[l.styleTags({[t]:r})]}),F.push(t),t.id):0}return He.DocInput=t,He.HighlightStyle=D,He.IndentContext=E,He.LRLanguage=r,He.Language=d,He.LanguageDescription=class je{constructor(e,t,r,n,a,i=void 0){this.name=e,this.alias=t,this.extensions=r,this.filename=n,this.loadFunc=a,this.support=i,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(e=>this.support=e,e=>{throw this.loading=null,e}))}static of(e){let{load:t,support:r}=e;if(!t){if(!r)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");t=()=>Promise.resolve(r)}return new je(e.name,(e.alias||[]).concat(e.name).map(e=>e.toLowerCase()),e.extensions||[],e.filename,t,r)}static matchFilename(e,t){for(var r of e)if(r.filename&&r.filename.test(t))return r;var n=/\.([^.]+)$/.exec(t);if(n)for(var a of e)if(-1<a.extensions.indexOf(n[1]))return a;return null}static matchLanguageName(e,t,r=!0){t=t.toLowerCase();for(var n of e)if(n.alias.some(e=>e==t))return n;if(r)for(var a of e)for(var i of a.alias){var o=t.indexOf(i);if(-1<o&&(2<i.length||!/\w/.test(t[o-1])&&!/\w/.test(t[o+i.length])))return a}return null}},He.LanguageSupport=class{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}},He.ParseContext=p,He.StreamLanguage=ke,He.StringStream=Ae,He.TreeIndentContext=a,He.bracketMatching=function(e={}){return[ge.of(e),Te]},He.bracketMatchingHandle=be,He.codeFolding=N,He.continuedIndent=function({except:r,units:n=1}={}){return e=>{var t=r&&r.test(e.textAfter);return e.baseIndent+(t?0:n*e.unit)}},He.defaultHighlightStyle=pe,He.defineLanguageFacet=i,He.delimitedIndent=function({closing:t,align:r=!0,units:n=1}){return e=>z(e,r,n,t)},He.ensureSyntaxTree=n,He.flatIndent=e=>e.baseIndent,He.foldAll=Q,He.foldCode=e,He.foldEffect=A,He.foldGutter=function(e={}){let t=Object.assign(Object.assign({},ie),e),a=new oe(t,!0),i=new oe(t,!1),r=s.ViewPlugin.fromClass(class{constructor(e){this.from=e.viewport.from,this.markers=this.buildMarkers(e)}update(e){(e.docChanged||e.viewportChanged||e.startState.facet(m)!=e.state.facet(m)||e.startState.field(w,!1)!=e.state.field(w,!1)||k(e.startState)!=k(e.state)||t.foldingChanged(e))&&(this.markers=this.buildMarkers(e.view))}buildMarkers(e){var t,r=new o.RangeSetBuilder;for(t of e.viewportLineBlocks){var n=R(e.state,t.from,t.to)?i:S(e.state,t.from,t.to)?a:null;n&&r.add(t.from,t.from,n)}return r.finish()}}),n=t["domEventHandlers"];return[r,s.gutter({class:"cm-foldGutter",markers(e){return(null==(e=e.plugin(r))?void 0:e.markers)||o.RangeSet.empty},initialSpacer(){return new oe(t,!1)},domEventHandlers:Object.assign(Object.assign({},n),{click:(e,t,r)=>{return!((!n.click||!n.click(e,t,r))&&((r=R(e.state,t.from,t.to))?(e.dispatch({effects:O.of(r)}),0):!(r=S(e.state,t.from,t.to))||(e.dispatch({effects:A.of(r)}),0)))}})}),N()]},He.foldInside=function(e){var t=e.firstChild,r=e.lastChild;return t&&t.to<r.from?{from:t.to,to:r.type.isError?e.to:r.from}:null},He.foldKeymap=ee,He.foldNodeProp=Y,He.foldService=K,He.foldState=w,He.foldable=S,He.foldedRanges=function(e){return e.field(w,!1)||o.RangeSet.empty},He.forceParsing=function(e,t=e.viewport.to,r=100){return(t=n(e.state,t,r))!=k(e.state)&&e.dispatch({}),!!t},He.getIndentUnit=T,He.getIndentation=v,He.highlightingFor=function(e,t,r){e=x(e);let n=null;if(e)for(var a of e)(!a.scope||r&&a.scope(r))&&(a=a.style(t))&&(n=n?n+" "+a:a);return n},He.indentNodeProp=W,He.indentOnInput=function(){return o.EditorState.transactionFilter.of(e=>{if(!e.docChanged||!e.isUserEvent("input.type")&&!e.isUserEvent("input.complete"))return e;var t=e.startState.languageDataAt("indentOnInput",e.startState.selection.main.head);if(!t.length)return e;var r,n=e.newDoc,a=e.newSelection.main["head"],i=n.lineAt(a);if(a>i.from+200)return e;let o=n.sliceString(i.from,a);if(!t.some(e=>e.test(o)))return e;let s=e["state"],l=-1,c=[];for({head:r}of s.selection.ranges){var u,d,f,p=s.doc.lineAt(r);p.from!=l&&(l=p.from,null!=(u=v(s,p.from))&&(d=/^\s*/.exec(p.text)[0])!=(f=b(s,u)))&&c.push({from:p.from,to:p.from+d.length,insert:f})}return c.length?[e,{changes:c,sequential:!0}]:e})},He.indentRange=function(r,e,n){let a=Object.create(null);var i=new E(r,{overrideIndentation:e=>{return null!=(e=a[e])?e:-1}}),o=[];for(let t=e;t<=n;){var s,l,c=r.doc.lineAt(t);t=c.to+1;let e=v(i,c.from);null!=e&&(/\S/.test(c.text)||(e=0),(s=/^\s*/.exec(c.text)[0])!=(l=b(r,e)))&&(a[c.from]=e,o.push({from:c.from,to:c.from+s.length,insert:l}))}return r.changes(o)},He.indentService=_,He.indentString=b,He.indentUnit=y,He.language=m,He.languageDataProp=c,He.matchBrackets=L,He.sublanguageProp=B,He.syntaxHighlighting=function(t,e){let r=[ue],n;return t instanceof D&&(t.module&&r.push(s.EditorView.styleModule.of(t.module)),n=t.themeType),null!=e&&e.fallback?r.push(ce.of(t)):n?r.push(le.computeN([s.EditorView.darkTheme],e=>e.facet(s.EditorView.darkTheme)==("dark"==n)?[t]:[])):r.push(le.of(t)),r},He.syntaxParserRunning=function(e){return(null==(e=e.plugin(V))?void 0:e.isWorking())||!1},He.syntaxTree=k,He.syntaxTreeAvailable=function(e,t=e.doc.length){var r;return(null==(r=e.field(d.state,!1))?void 0:r.context.isDone(t))||!1},He.toggleFold=e=>{var t,r=[];for(t of C(e)){var n=R(e.state,t.from,t.to);n?r.push(O.of(n),M(e,n,!1)):(n=function(t,r){for(let e=r;;){var n=S(t.state,e.from,e.to);if(n&&n.to>r.from)return n;if(!e.from)return null;e=t.lineBlockAt(e.from-1)}}(e,t))&&r.push(A.of(n),M(e,n))}return 0<r.length&&e.dispatch({effects:I(e.state,r)}),!!r.length},He.unfoldAll=X,He.unfoldCode=Z,He.unfoldEffect=O,He}function Y1(){if(q1)return Rt;q1=1;var h=I1(),c=B1(),f=K1(),p=G1(),L=e=>{var t=e["state"],t=t.doc.lineAt(t.selection.main.from),t=E(e.state,t.from);return t.line?F(e):!!t.block&&V(e)};function e(n,a){return({state:e,dispatch:t})=>{var r;return!e.readOnly&&!!(r=n(a,e))&&(t(e.update(r)),!0)}}const F=e(t,0);var U=e(t,1),B=e(t,2),j=e(r,0),H=e(r,1),G=e(r,2);const V=e((e,t)=>r(e,t,function(e){var t=[];for(var r of e.selection.ranges){var n=e.doc.lineAt(r.from),r=r.to<=n.to?n:e.doc.lineAt(r.to),a=t.length-1;0<=a&&t[a].to>n.from?t[a].to=r.to:t.push({from:n.from+/^\s*/.exec(n.text)[0].length,to:r.to})}return t}(t)),0);function E(e,t){e=e.languageDataAt("commentTokens",t);return e.length?e[0]:{}}const g=50;function r(e,f,t=f.selection.ranges){let p=t.map(e=>E(f,e.from).block);if(p.every(e=>e)){let r=t.map((r,n)=>{{var[n,{open:r,close:a},i,o]=[f,p[n],r.from,r.to],s=n.sliceDoc(i-g,i),l=n.sliceDoc(o,o+g),c=/\s*$/.exec(s)[0].length,u=/^\s*/.exec(l)[0].length,d=s.length-c;if(s.slice(d-r.length,d)==r&&l.slice(u,u+a.length)==a)return{open:{pos:i-c,margin:c&&1},close:{pos:o+u,margin:u&&1}};let e,t;return o-i<=2*g?e=t=n.sliceDoc(i,o):(e=n.sliceDoc(i,i+g),t=n.sliceDoc(o-g,o)),s=/^\s*/.exec(e)[0].length,d=/\s*$/.exec(t)[0].length,l=t.length-d-a.length,e.slice(s,s+r.length)==r&&t.slice(l,l+a.length)==a?{open:{pos:i+s+r.length,margin:/\s/.test(e.charAt(s+r.length))?1:0},close:{pos:o-d-a.length,margin:/\s/.test(t.charAt(l-1))?1:0}}:null}});if(2!=e&&!r.every(e=>e))return{changes:f.changes(t.map((e,t)=>r[t]?[]:[{from:e.from,insert:p[t].open+" "},{from:e.to,insert:" "+p[t].close}]))};if(1!=e&&r.some(e=>e)){var n,a,i,o=[];for(let e=0,t;e<r.length;e++)(t=r[e])&&(n=p[e],{open:a,close:i}=t,o.push({from:a.pos-n.open.length,to:a.pos+a.margin},{from:i.pos-i.margin,to:i.pos+n.close.length}));return{changes:o}}}return null}function t(e,n,t=n.selection.ranges){var a,i,o=[];let s=-1;for({from:a,to:i}of t){let t=o.length,r=1e9;var l=E(n,a).line;if(l){for(let e=a;e<=i;){var c,u,d,f=n.doc.lineAt(e);f.from>s&&(a==i||i>f.from)&&(s=f.from,u=(c=/^\s*/.exec(f.text)[0].length)==f.length,d=f.text.slice(c,c+l.length)==l?c:-1,c<f.text.length&&c<r&&(r=c),o.push({line:f,comment:d,token:l,indent:c,empty:u,single:!1})),e=f.to+1}if(r<1e9)for(let e=t;e<o.length;e++)o[e].indent<o[e].line.text.length&&(o[e].indent=r);o.length==t+1&&(o[t].single=!0)}}if(2!=e&&o.some(e=>e.comment<0&&(!e.empty||e.single))){var r,p,h,g,m,_=[];for({line:r,token:p,indent:h,empty:g,single:m}of o)!m&&g||_.push({from:r.from+h,insert:p+" "});t=n.changes(_);return{changes:t,selection:n.selection.map(t,1)}}if(1!=e&&o.some(e=>0<=e.comment)){var y,T,b,v=[];for({line:y,comment:T,token:b}of o)if(0<=T){let e=y.from+T,t=e+b.length;" "==y.text[t-y.from]&&t++,v.push({from:e,to:t})}return{changes:v}}return null}const l=h.Annotation.define(),W=h.Annotation.define(),q=h.Facet.define(),$=h.Facet.define({combine(e){return h.combineConfig(e,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(r,n)=>(e,t)=>r(e,t)||n(e,t)})}}),i=h.StateField.define({create(){return m.empty},update(t,r){var n=r.state.facet($),a=r.annotation(l);if(a){var i=s.fromTransaction(r,a.selection),o=a.side;let e=0==o?t.undone:t.done;return e=i?u(e,e.length,n.minDepth,i):te(e,r.startState.selection),new m(0==o?a.rest:e,0==o?e:a.rest)}var e,i=r.annotation(W);return"full"!=i&&"before"!=i||(t=t.isolate()),!1===r.annotation(h.Transaction.addToHistory)?r.changes.empty?t:t.addMapping(r.changes.desc):(o=s.fromTransaction(r),a=r.annotation(h.Transaction.time),e=r.annotation(h.Transaction.userEvent),o?t=t.addChanges(o,a,e,n,r):r.selection&&(t=t.addSelection(r.startState.selection,a,e,n.newGroupDelay)),"full"!=i&&"after"!=i?t:t.isolate())},toJSON(e){return{done:e.done.map(e=>e.toJSON()),undone:e.undone.map(e=>e.toJSON())}},fromJSON(e){return new m(e.done.map(s.fromJSON),e.undone.map(s.fromJSON))}});var z=i;function n(n,a){return function({state:e,dispatch:t}){var r;return!(!a&&e.readOnly||!(r=e.field(i,!1))||!(r=r.pop(n,e,a))||(t(r),0))}}const a=n(0,!1),o=n(1,!1);var K=n(0,!0),Y=n(1,!0);function J(t){return function(e){var e=e.field(i,!1);return e?(e=0==t?e.done:e.undone).length-(e.length&&!e[0].changes?1:0):0}}var Z=J(0),Q=J(1);class s{constructor(e,t,r,n,a){this.changes=e,this.effects=t,this.mapped=r,this.startSelection=n,this.selectionsAfter=a}setSelAfter(e){return new s(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e;return{changes:null==(e=this.changes)?void 0:e.toJSON(),mapped:null==(e=this.mapped)?void 0:e.toJSON(),startSelection:null==(e=this.startSelection)?void 0:e.toJSON(),selectionsAfter:this.selectionsAfter.map(e=>e.toJSON())}}static fromJSON(e){return new s(e.changes&&h.ChangeSet.fromJSON(e.changes),[],e.mapped&&h.ChangeDesc.fromJSON(e.mapped),e.startSelection&&h.EditorSelection.fromJSON(e.startSelection),e.selectionsAfter.map(h.EditorSelection.fromJSON))}static fromTransaction(e,t){let r=d;for(var n of e.startState.facet(q)){n=n(e);n.length&&(r=r.concat(n))}return!r.length&&e.changes.empty?null:new s(e.changes.invert(e.startState.doc),r,void 0,t||e.startState.selection,d)}static selection(e){return new s(void 0,d,void 0,void 0,e)}}function u(e,t,r,n){e=e.slice(r+20<t+1?t-r-1:0,t);return e.push(n),e}function X(e,t){return e.length?t.length?e.concat(t):e:t}const d=[],ee=200;function te(e,t){var r,n;return e.length?(n=(r=e[e.length-1]).selectionsAfter.slice(Math.max(0,r.selectionsAfter.length-ee))).length&&n[n.length-1].eq(t)?e:(n.push(t),u(e,e.length-1,1e9,r.setSelAfter(n))):[s.selection([t])]}function re(e,t){if(!e.length)return e;let r=e.length,n=d;for(;r;){var a,i=function(e,t,r){r=X(e.selectionsAfter.length?e.selectionsAfter.map(e=>e.map(t)):d,r);if(!e.changes)return s.selection(r);var n=e.changes.map(t),a=t.mapDesc(e.changes,!0),i=e.mapped?e.mapped.composeDesc(a):a;return new s(n,h.StateEffect.mapEffects(e.effects,t),i,e.startSelection.map(a),r)}(e[r-1],t,n);if(i.changes&&!i.changes.empty||i.effects.length)return(a=e.slice(0,r))[r-1]=i,a;t=i.mapped,r--,n=i.selectionsAfter}return n.length?[s.selection(n)]:d}const ne=/^(input\.type|delete)($|\.)/;class m{constructor(e,t,r=0,n=void 0){this.done=e,this.undone=t,this.prevTime=r,this.prevUserEvent=n}isolate(){return this.prevTime?new m(this.done,this.undone):this}addChanges(e,t,r,n,a){let i=this.done,o=i[i.length-1];return i=o&&o.changes&&!o.changes.empty&&e.changes&&(!r||ne.test(r))&&(!o.selectionsAfter.length&&t-this.prevTime<n.newGroupDelay&&n.joinToEvent(a,function(e,t){let o=[],s=!1;return e.iterChangedRanges((e,t)=>o.push(e,t)),t.iterChangedRanges((e,t,r,n)=>{for(let e=0;e<o.length;){var a=o[e++],i=o[e++];a<=n&&r<=i&&(s=!0)}}),s}(o.changes,e.changes))||"input.type.compose"==r)?u(i,i.length-1,n.minDepth,new s(e.changes.compose(o.changes),X(e.effects,o.effects),o.mapped,o.startSelection,d)):u(i,i.length,n.minDepth,e),new m(i,d,t,r)}addSelection(e,t,r,n){var a,i=this.done.length?this.done[this.done.length-1].selectionsAfter:d;return 0<i.length&&t-this.prevTime<n&&r==this.prevUserEvent&&r&&/^select($|\.)/.test(r)&&(n=i[i.length-1],a=e,n.ranges.length==a.ranges.length)&&0===n.ranges.filter((e,t)=>e.empty!=a.ranges[t].empty).length?this:new m(te(this.done,e),this.undone,t,r)}addMapping(e){return new m(re(this.done,e),re(this.undone,e),this.prevTime,this.prevUserEvent)}pop(t,r,e){var n,a,i=0==t?this.done:this.undone;if(0!=i.length){var o=i[i.length-1],s=o.selectionsAfter[0]||r.selection;if(e&&o.selectionsAfter.length)return r.update({selection:o.selectionsAfter[o.selectionsAfter.length-1],annotations:l.of({side:t,rest:(n=(e=i)[e.length-1],(a=e.slice())[e.length-1]=n.setSelAfter(n.selectionsAfter.slice(0,n.selectionsAfter.length-1)),a),selection:s}),userEvent:0==t?"select.undo":"select.redo",scrollIntoView:!0});if(o.changes){let e=1==i.length?d:i.slice(0,i.length-1);return o.mapped&&(e=re(e,o.mapped)),r.update({changes:o.changes,selection:o.startSelection,effects:o.effects,annotations:l.of({side:t,rest:e,selection:s}),filter:!1,userEvent:0==t?"undo":"redo",scrollIntoView:!0})}}return null}}m.empty=new m(d,d);var ae=[{key:"Mod-z",run:a,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:o,preventDefault:!0},{linux:"Ctrl-Shift-z",run:o,preventDefault:!0},{key:"Mod-u",run:K,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:Y,preventDefault:!0}];function _(e,t){return h.EditorSelection.create(e.ranges.map(t),e.mainIndex)}function y(e,t){return e.update({selection:t,scrollIntoView:!0,userEvent:"select"})}function T({state:e,dispatch:t},r){r=_(e.selection,r);return!r.eq(e.selection,!0)&&(t(y(e,r)),!0)}function b(e,t){return h.EditorSelection.cursor(t?e.to:e.from)}function v(t,r){return T(t,e=>e.empty?t.moveByChar(e,r):b(e,r))}function S(e){return e.textDirectionAt(e.state.selection.main.head)==c.Direction.LTR}var ie=e=>v(e,!S(e)),oe=e=>v(e,S(e));function A(t,r){return T(t,e=>e.empty?t.moveByGroup(e,r):b(e,r))}var se=e=>A(e,!S(e)),le=e=>A(e,S(e));const ce="undefined"!=typeof Intl&&Intl.Segmenter?new Intl.Segmenter(void 0,{granularity:"word"}):null;function ue(n,e,a){let i=n.state.charCategorizer(e.from),o=h.CharCategory.Space,s=e.from,l=0,c=!1,u=!1,d=!1,t=e=>{if(c)return!1;s+=a?e.length:-e.length;let t=i(e),r;if(t==h.CharCategory.Word&&e.charCodeAt(0)<128&&/[\W_]/.test(e)&&(t=-1),(o=o==h.CharCategory.Space?t:o)!=t)return!1;if(o==h.CharCategory.Word)if(e.toLowerCase()==e){if(!a&&u)return!1;d=!0}else if(d){if(a)return!1;c=!0}else{if(u&&a&&i(r=n.state.sliceDoc(s,s+1))==h.CharCategory.Word&&r.toLowerCase()==r)return!1;u=!0}return l++,!0};var r=n.moveByChar(e,a,e=>(t(e),t));if(ce&&o==h.CharCategory.Word&&r.from==e.from+l*(a?1:-1)){var f=Math.min(e.head,r.head),p=Math.max(e.head,r.head),f=n.state.sliceDoc(f,p);if(1<f.length&&/[\u4E00-\uffff]/.test(f)){p=Array.from(ce.segment(f));if(1<p.length)return a?h.EditorSelection.cursor(e.head+p[1].index,-1):h.EditorSelection.cursor(r.head+p[p.length-1].index,1)}}return r}function de(t,r){return T(t,e=>e.empty?ue(t,e,r):b(e,r))}function O(t,r,n){let a=f.syntaxTree(t).resolveInner(r.head);var i,o,s,l=n?p.NodeProp.closedBy:p.NodeProp.openedBy;for(let e=r.head;;){var c=n?a.childAfter(e):a.childBefore(e);if(!c)break;i=t,s=l,(o=c).type.prop(s)||(s=o.to-o.from)&&(2<s||/[^\s,.;:]/.test(i.sliceDoc(o.from,o.to)))||o.firstChild?a=c:e=n?c.to:c.from}let e=a.type.prop(l),u,d;return d=e&&(u=n?f.matchBrackets(t,a.from,1):f.matchBrackets(t,a.to,-1))&&u.matched?n?u.end.to:u.end.from:n?a.to:a.from,h.EditorSelection.cursor(d,n?-1:1)}var fe=t=>T(t,e=>O(t.state,e,!S(t))),pe=t=>T(t,e=>O(t.state,e,S(t)));function he(r,n){return T(r,e=>{var t;return e.empty?(t=r.moveVertically(e,n)).head!=e.head?t:r.moveToLineBoundary(e,n):b(e,n)})}var ge=e=>he(e,!1),me=e=>he(e,!0);function _e(e){var t=e.scrollDOM.clientHeight<e.scrollDOM.scrollHeight-2;let r=0,n=0,a;if(t){for(var i of e.state.facet(c.EditorView.scrollMargins)){i=i(e);null!=i&&i.top&&(r=Math.max(null==i?void 0:i.top,r)),null!=i&&i.bottom&&(n=Math.max(null==i?void 0:i.bottom,n))}a=e.scrollDOM.clientHeight-r-n}else a=(e.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:r,marginBottom:n,selfScroll:t,height:Math.max(e.defaultLineHeight,a-5)}}function ye(t,r){let n=_e(t);var e,a,i,o=t["state"],s=_(o.selection,e=>e.empty?t.moveVertically(e,r,n.height):b(e,r));if(s.eq(o.selection))return!1;let l;return n.selfScroll&&(e=t.coordsAtPos(o.selection.main.head),a=(i=t.scrollDOM.getBoundingClientRect()).top+n.marginTop,i=i.bottom-n.marginBottom,e)&&e.top>a&&e.bottom<i&&(l=c.EditorView.scrollIntoView(s.main.head,{y:"start",yMargin:e.top-a})),t.dispatch(y(o,s),{effects:l}),!0}var Te=e=>ye(e,!1),C=e=>ye(e,!0);function k(e,t,r){let n=e.lineBlockAt(t.head),a=e.moveToLineBoundary(t,r);return a.head==t.head&&a.head!=(r?n.to:n.from)&&(a=e.moveToLineBoundary(t,r,!1)),a=!r&&a.head==n.from&&n.length&&(r=/^\s*/.exec(e.state.sliceDoc(n.from,Math.min(n.from+100,n.to)))[0].length)&&t.head!=n.from+r?h.EditorSelection.cursor(n.from+r):a}var be=t=>T(t,e=>k(t,e,!0)),ve=t=>T(t,e=>k(t,e,!1)),Ee=t=>T(t,e=>k(t,e,!S(t))),Se=t=>T(t,e=>k(t,e,S(t))),Ae=t=>T(t,e=>h.EditorSelection.cursor(t.lineBlockAt(e.head).from,1)),Oe=t=>T(t,e=>h.EditorSelection.cursor(t.lineBlockAt(e.head).to,-1));function Ce(r,e,n){let a=!1,t=_(r.selection,e=>{var t=f.matchBrackets(r,e.head,-1)||f.matchBrackets(r,e.head,1)||0<e.head&&f.matchBrackets(r,e.head-1,1)||e.head<r.doc.length&&f.matchBrackets(r,e.head+1,-1);if(!t||!t.end)return e;a=!0;t=t.start.from==e.head?t.end.to:t.end.from;return n?h.EditorSelection.range(e.anchor,t):h.EditorSelection.cursor(t)});return!!a&&(e(y(r,t)),!0)}var ke=({state:e,dispatch:t})=>Ce(e,t,!1);function w(e,r){var t=_(e.state.selection,e=>{var t=r(e);return h.EditorSelection.range(e.anchor,t.head,t.goalColumn,t.bidiLevel||void 0)});return!t.eq(e.state.selection)&&(e.dispatch(y(e.state,t)),!0)}function R(t,r){return w(t,e=>t.moveByChar(e,r))}var we=e=>R(e,!S(e)),Re=e=>R(e,S(e));function I(t,r){return w(t,e=>t.moveByGroup(e,r))}var Ie=e=>I(e,!S(e)),Me=e=>I(e,S(e));function Pe(t,r){return w(t,e=>ue(t,e,r))}var Ne=t=>w(t,e=>O(t.state,e,!S(t))),De=t=>w(t,e=>O(t.state,e,S(t)));function xe(t,r){return w(t,e=>t.moveVertically(e,r))}var Le=e=>xe(e,!1),Fe=e=>xe(e,!0);function Ue(t,r){return w(t,e=>t.moveVertically(e,r,_e(t).height))}var Be=e=>Ue(e,!1),je=e=>Ue(e,!0),He=t=>w(t,e=>k(t,e,!0)),Ge=t=>w(t,e=>k(t,e,!1)),Ve=t=>w(t,e=>k(t,e,!S(t))),We=t=>w(t,e=>k(t,e,S(t))),qe=t=>w(t,e=>h.EditorSelection.cursor(t.lineBlockAt(e.head).from)),$e=t=>w(t,e=>h.EditorSelection.cursor(t.lineBlockAt(e.head).to)),ze=({state:e,dispatch:t})=>(t(y(e,{anchor:0})),!0),Ke=({state:e,dispatch:t})=>(t(y(e,{anchor:e.doc.length})),!0),Ye=({state:e,dispatch:t})=>(t(y(e,{anchor:e.selection.main.anchor,head:0})),!0),Je=({state:e,dispatch:t})=>(t(y(e,{anchor:e.selection.main.anchor,head:e.doc.length})),!0),Ze=({state:e,dispatch:t})=>(t(e.update({selection:{anchor:0,head:e.doc.length},userEvent:"select"})),!0),Qe=({state:r,dispatch:e})=>{var t=D(r).map(({from:e,to:t})=>h.EditorSelection.range(e,Math.min(t+1,r.doc.length)));return e(r.update({selection:h.EditorSelection.create(t),userEvent:"select"})),!0},Xe=({state:a,dispatch:e})=>{var t=_(a.selection,t=>{var r;for(let e=f.syntaxTree(a).resolveStack(t.from,1);e;e=e.next){var n=e["node"];if((n.from<t.from&&n.to>=t.to||n.to>t.to&&n.from<=t.from)&&null!=(r=n.parent)&&r.parent)return h.EditorSelection.range(n.to,n.from)}return t});return e(y(a,t)),!0},et=({state:e,dispatch:t})=>{let r=e.selection,n=null;return 1<r.ranges.length?n=h.EditorSelection.create([r.main]):r.main.empty||(n=h.EditorSelection.create([h.EditorSelection.cursor(r.main.head)])),!!n&&(t(y(e,n)),!0)};function M(a,i){if(a.state.readOnly)return!1;let o="delete.selection",e=a["state"];var t=e.changeByRange(t=>{let{from:r,to:n}=t;if(r==n){let e=i(t);e<r?(o="delete.backward",e=P(a,e,!1)):e>r&&(o="delete.forward",e=P(a,e,!0)),r=Math.min(r,e),n=Math.max(n,e)}else r=P(a,r,!1),n=P(a,n,!0);return r==n?{range:t}:{changes:{from:r,to:n},range:h.EditorSelection.cursor(r,r<t.head?-1:1)}});return!t.changes.empty&&(a.dispatch(e.update(t,{scrollIntoView:!0,userEvent:o,effects:"delete.selection"==o?c.EditorView.announce.of(e.phrase("Selection deleted")):void 0})),!0)}function P(t,r,n){if(t instanceof c.EditorView)for(var e of t.state.facet(c.EditorView.atomicRanges).map(e=>e(t)))e.between(r,r,(e,t)=>{e<r&&r<t&&(r=n?t:e)});return r}const tt=(s,l,c)=>M(s,e=>{let t=e.from,r=s["state"],n=r.doc.lineAt(t),a,i;if(c&&!l&&t>n.from&&t<n.from+200&&!/[^ \t]/.test(a=n.text.slice(0,t-n.from))){if("\t"==a[a.length-1])return t-1;var o=h.countColumn(a,r.tabSize)%f.getIndentUnit(r)||f.getIndentUnit(r);for(let e=0;e<o&&" "==a[a.length-1-e];e++)t--;i=t}else(i=h.findClusterBreak(n.text,t-n.from,l,l)+n.from)==t&&n.number!=(l?r.doc.lines:1)?i+=l?1:-1:!l&&/[\ufe00-\ufe0f]/.test(n.text.slice(i-n.from,t-n.from))&&(i=h.findClusterBreak(n.text,i-n.from,!1,!1)+n.from);return i});var N=e=>tt(e,!1,!0),rt=e=>tt(e,!0,!1);const nt=(e,c)=>M(e,t=>{let r=t.head,n=e["state"],a=n.doc.lineAt(r);var i=n.charCategorizer(r);for(let e=null;;){if(r==(c?a.to:a.from)){r==t.head&&a.number!=(c?n.doc.lines:1)&&(r+=c?1:-1);break}var o=h.findClusterBreak(a.text,r-a.from,c)+a.from,s=a.text.slice(Math.min(r,o)-a.from,Math.max(r,o)-a.from),l=i(s);if(null!=e&&l!=e)break;" "==s&&r==t.head||(e=l),r=o}return r});var at=e=>nt(e,!1),it=e=>nt(e,!0),ot=r=>M(r,e=>{var t=r.lineBlockAt(e.head).to;return e.head<t?t:Math.min(r.state.doc.length,e.head+1)}),st=r=>M(r,e=>{var t=r.moveToLineBoundary(e,!1).head;return e.head>t?t:Math.max(0,e.head-1)}),lt=r=>M(r,e=>{var t=r.moveToLineBoundary(e,!0).head;return e.head<t?t:Math.min(r.state.doc.length,e.head+1)}),ct=({state:e,dispatch:t})=>{var r;return!e.readOnly&&(r=e.changeByRange(e=>({changes:{from:e.from,to:e.to,insert:h.Text.of(["",""])},range:h.EditorSelection.cursor(e.from)})),t(e.update(r,{scrollIntoView:!0,userEvent:"input"})),!0)},ut=({state:a,dispatch:e})=>{var t;return!a.readOnly&&!(t=a.changeByRange(e=>{var t,r,n;return e.empty&&0!=e.from&&e.from!=a.doc.length?{changes:{from:r=(t=e.from)==(n=a.doc.lineAt(t)).from?t-1:h.findClusterBreak(n.text,t-n.from,!1)+n.from,to:n=t==n.to?t+1:h.findClusterBreak(n.text,t-n.from,!0)+n.from,insert:a.doc.slice(t,n).append(a.doc.slice(r,t))},range:h.EditorSelection.cursor(n)}:{range:e}})).changes.empty&&(e(a.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function D(r){let n=[],a=-1;for(var i of r.selection.ranges){let e=r.doc.lineAt(i.from),t=r.doc.lineAt(i.to);var o;i.empty||i.to!=t.from||(t=r.doc.lineAt(i.to-1)),a>=e.number?((o=n[n.length-1]).to=t.to,o.ranges.push(i)):n.push({from:e.from,to:t.to,ranges:[i]}),a=t.number+1}return n}function dt(e,t,r){if(e.readOnly)return!1;var n,a=[],i=[];for(n of D(e))if(r?n.to!=e.doc.length:0!=n.from){var o=e.doc.lineAt(r?n.to+1:n.from-1),s=o.length+1;if(r){a.push({from:n.to,to:o.to},{from:n.from,insert:o.text+e.lineBreak});for(var l of n.ranges)i.push(h.EditorSelection.range(Math.min(e.doc.length,l.anchor+s),Math.min(e.doc.length,l.head+s)))}else{a.push({from:o.from,to:n.from},{from:n.to,insert:e.lineBreak+o.text});for(var c of n.ranges)i.push(h.EditorSelection.range(c.anchor-s,c.head-s))}}return!!a.length&&(t(e.update({changes:a,scrollIntoView:!0,selection:h.EditorSelection.create(i,e.selection.mainIndex),userEvent:"move.line"})),!0)}var ft=({state:e,dispatch:t})=>dt(e,t,!1),pt=({state:e,dispatch:t})=>dt(e,t,!0);function ht(e,t,r){if(e.readOnly)return!1;var n,a=[];for(n of D(e))a.push(r?{from:n.from,insert:e.doc.slice(n.from,n.to)+e.lineBreak}:{from:n.to,insert:e.lineBreak+e.doc.slice(n.from,n.to)});return t(e.update({changes:a,scrollIntoView:!0,userEvent:"input.copyline"})),!0}var gt=({state:e,dispatch:t})=>ht(e,t,!1),mt=({state:e,dispatch:t})=>ht(e,t,!0),_t=a=>{if(a.state.readOnly)return!1;let r=a["state"],e=r.changes(D(r).map(({from:e,to:t})=>(0<e?e--:t<r.doc.length&&t++,{from:e,to:t})));var t=_(r.selection,e=>{let t=void 0;var r,n;return a.lineWrapping&&(r=a.lineBlockAt(e.head),n=a.coordsAtPos(e.head,e.assoc||1))&&(t=r.bottom+a.documentTop-n.bottom+a.defaultLineHeight/2),a.moveVertically(e,!0,t)}).map(e);return a.dispatch({changes:e,selection:t,scrollIntoView:!0,userEvent:"delete.line"}),!0};var yt=bt(!1),Tt=bt(!0);function bt(l){return({state:s,dispatch:e})=>{var t;return!s.readOnly&&(t=s.changeByRange(e=>{let{from:t,to:r}=e,n=s.doc.lineAt(t);var e=!l&&t==r&&function(e,t){if(/\(\)|\[\]|\{\}/.test(e.sliceDoc(t-1,t+1)))return{from:t,to:t};var r=f.syntaxTree(e).resolveInner(t);let n=r.childBefore(t),a=r.childAfter(t),i;return n&&a&&n.to<=t&&a.from>=t&&(i=n.type.prop(p.NodeProp.closedBy))&&-1<i.indexOf(a.name)&&e.doc.lineAt(n.to).from==e.doc.lineAt(a.from).from&&!/\S/.test(e.sliceDoc(n.to,a.from))?{from:n.to,to:a.from}:null}(s,t),a=(l&&(t=r=(r<=n.to?n:s.doc.lineAt(r)).to),new f.IndentContext(s,{simulateBreak:t,simulateDoubleBreak:!!e}));let i=f.getIndentation(a,t);for(null==i&&(i=h.countColumn(/^\s*/.exec(s.doc.lineAt(t).text)[0],s.tabSize));r<n.to&&/\s/.test(n.text[r-n.from]);)r++;e?{from:t,to:r}=e:t>n.from&&t<n.from+100&&!/\S/.test(n.text.slice(0,t))&&(t=n.from);var o=["",f.indentString(s,i)];return e&&o.push(f.indentString(s,a.lineIndent(n.from,-1))),{changes:{from:t,to:r,insert:h.Text.of(o)},range:h.EditorSelection.cursor(t+1+o[1].length)}}),e(s.update(t,{scrollIntoView:!0,userEvent:"input"})),!0)}}function vt(a,i){let o=-1;return a.changeByRange(t=>{var r=[];for(let e=t.from;e<=t.to;){var n=a.doc.lineAt(e);n.number>o&&(t.empty||t.to>n.from)&&(i(n,r,t),o=n.number),e=n.to+1}var e=a.changes(r);return{changes:r,range:h.EditorSelection.range(e.mapPos(t.anchor,1),e.mapPos(t.head,1))}})}var Et=({state:o,dispatch:e})=>{if(o.readOnly)return!1;let s=Object.create(null),l=new f.IndentContext(o,{overrideIndentation:e=>{e=s[e];return null==e?-1:e}});var t=vt(o,(e,t,r)=>{let n=f.getIndentation(l,e.from);var a,i;null!=n&&(/\S/.test(e.text)||(n=0),(a=/^\s*/.exec(e.text)[0])!=(i=f.indentString(o,n))||r.from<e.from+a.length)&&(s[e.from]=n,t.push({from:e.from,to:e.from+a.length,insert:i}))});return t.changes.empty||e(o.update(t,{userEvent:"indent"})),!0};const x=({state:r,dispatch:e})=>!r.readOnly&&(e(r.update(vt(r,(e,t)=>{t.push({from:e.from,insert:r.facet(f.indentUnit)})}),{userEvent:"input.indent"})),!0);var St=({state:o,dispatch:e})=>!o.readOnly&&(e(o.update(vt(o,(r,n)=>{var a=/^\s*/.exec(r.text)[0];if(a){let e=h.countColumn(a,o.tabSize),t=0;for(var i=f.indentString(o,Math.max(0,e-f.getIndentUnit(o)));t<a.length&&t<i.length&&a.charCodeAt(t)==i.charCodeAt(t);)t++;n.push({from:r.from+t,to:r.from+a.length,insert:i.slice(t)})}}),{userEvent:"delete.dedent"})),!0),At=e=>(e.setTabFocusMode(),!0),Ot=[{key:"Ctrl-b",run:ie,shift:we,preventDefault:!0},{key:"Ctrl-f",run:oe,shift:Re},{key:"Ctrl-p",run:ge,shift:Le},{key:"Ctrl-n",run:me,shift:Fe},{key:"Ctrl-a",run:Ae,shift:qe},{key:"Ctrl-e",run:Oe,shift:$e},{key:"Ctrl-d",run:rt},{key:"Ctrl-h",run:N},{key:"Ctrl-k",run:ot},{key:"Ctrl-Alt-h",run:at},{key:"Ctrl-o",run:ct},{key:"Ctrl-t",run:ut},{key:"Ctrl-v",run:C}],Ct=[{key:"ArrowLeft",run:ie,shift:we,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:se,shift:Ie,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:Ee,shift:Ve,preventDefault:!0},{key:"ArrowRight",run:oe,shift:Re,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:le,shift:Me,preventDefault:!0},{mac:"Cmd-ArrowRight",run:Se,shift:We,preventDefault:!0},{key:"ArrowUp",run:ge,shift:Le,preventDefault:!0},{mac:"Cmd-ArrowUp",run:ze,shift:Ye},{mac:"Ctrl-ArrowUp",run:Te,shift:Be},{key:"ArrowDown",run:me,shift:Fe,preventDefault:!0},{mac:"Cmd-ArrowDown",run:Ke,shift:Je},{mac:"Ctrl-ArrowDown",run:C,shift:je},{key:"PageUp",run:Te,shift:Be},{key:"PageDown",run:C,shift:je},{key:"Home",run:ve,shift:Ge,preventDefault:!0},{key:"Mod-Home",run:ze,shift:Ye},{key:"End",run:be,shift:He,preventDefault:!0},{key:"Mod-End",run:Ke,shift:Je},{key:"Enter",run:yt},{key:"Mod-a",run:Ze},{key:"Backspace",run:N,shift:N},{key:"Delete",run:rt},{key:"Mod-Backspace",mac:"Alt-Backspace",run:at},{key:"Mod-Delete",mac:"Alt-Delete",run:it},{mac:"Mod-Backspace",run:st},{mac:"Mod-Delete",run:lt}].concat(Ot.map(e=>({mac:e.key,run:e.run,shift:e.shift}))),kt=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:fe,shift:Ne},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:pe,shift:De},{key:"Alt-ArrowUp",run:ft},{key:"Shift-Alt-ArrowUp",run:gt},{key:"Alt-ArrowDown",run:pt},{key:"Shift-Alt-ArrowDown",run:mt},{key:"Escape",run:et},{key:"Mod-Enter",run:Tt},{key:"Alt-l",mac:"Ctrl-l",run:Qe},{key:"Mod-i",run:Xe,preventDefault:!0},{key:"Mod-[",run:St},{key:"Mod-]",run:x},{key:"Mod-Alt-\\",run:Et},{key:"Shift-Mod-k",run:_t},{key:"Shift-Mod-\\",run:ke},{key:"Mod-/",run:L},{key:"Alt-A",run:j},{key:"Ctrl-m",mac:"Shift-Alt-m",run:At}].concat(Ct),wt={key:"Tab",run:x,shift:St};return Rt.blockComment=H,Rt.blockUncomment=G,Rt.copyLineDown=mt,Rt.copyLineUp=gt,Rt.cursorCharBackward=e=>v(e,!1),Rt.cursorCharForward=e=>v(e,!0),Rt.cursorCharLeft=ie,Rt.cursorCharRight=oe,Rt.cursorDocEnd=Ke,Rt.cursorDocStart=ze,Rt.cursorGroupBackward=e=>A(e,!1),Rt.cursorGroupForward=e=>A(e,!0),Rt.cursorGroupLeft=se,Rt.cursorGroupRight=le,Rt.cursorLineBoundaryBackward=ve,Rt.cursorLineBoundaryForward=be,Rt.cursorLineBoundaryLeft=Ee,Rt.cursorLineBoundaryRight=Se,Rt.cursorLineDown=me,Rt.cursorLineEnd=Oe,Rt.cursorLineStart=Ae,Rt.cursorLineUp=ge,Rt.cursorMatchingBracket=ke,Rt.cursorPageDown=C,Rt.cursorPageUp=Te,Rt.cursorSubwordBackward=e=>de(e,!1),Rt.cursorSubwordForward=e=>de(e,!0),Rt.cursorSyntaxLeft=fe,Rt.cursorSyntaxRight=pe,Rt.defaultKeymap=kt,Rt.deleteCharBackward=N,Rt.deleteCharBackwardStrict=e=>tt(e,!1,!1),Rt.deleteCharForward=rt,Rt.deleteGroupBackward=at,Rt.deleteGroupForward=it,Rt.deleteLine=_t,Rt.deleteLineBoundaryBackward=st,Rt.deleteLineBoundaryForward=lt,Rt.deleteToLineEnd=ot,Rt.deleteToLineStart=r=>M(r,e=>{var t=r.lineBlockAt(e.head).from;return e.head>t?t:Math.max(0,e.head-1)}),Rt.deleteTrailingWhitespace=({state:n,dispatch:e})=>{if(n.readOnly)return!1;var a=[];for(let e=0,t="",r=n.doc.iter();;){if(r.next(),r.lineBreak||r.done){var i=t.search(/\s+$/);if(-1<i&&a.push({from:e-(t.length-i),to:e}),r.done)break;t=""}else t=r.value;e+=r.value.length}return!!a.length&&(e(n.update({changes:a,userEvent:"delete"})),!0)},Rt.emacsStyleKeymap=Ot,Rt.history=function(e={}){return[i,$.of(e),c.EditorView.domEventHandlers({beforeinput(e,t){var r="historyUndo"==e.inputType?a:"historyRedo"==e.inputType?o:null;return!!r&&(e.preventDefault(),r(t))}})]},Rt.historyField=z,Rt.historyKeymap=ae,Rt.indentLess=St,Rt.indentMore=x,Rt.indentSelection=Et,Rt.indentWithTab=wt,Rt.insertBlankLine=Tt,Rt.insertNewline=({state:e,dispatch:t})=>(t(e.update(e.replaceSelection(e.lineBreak),{scrollIntoView:!0,userEvent:"input"})),!0),Rt.insertNewlineAndIndent=yt,Rt.insertNewlineKeepIndent=({state:r,dispatch:e})=>(e(r.update(r.changeByRange(e=>{var t=/^\s*/.exec(r.doc.lineAt(e.from).text)[0];return{changes:{from:e.from,to:e.to,insert:r.lineBreak+t},range:h.EditorSelection.cursor(e.from+t.length+1)}}),{scrollIntoView:!0,userEvent:"input"})),!0),Rt.insertTab=({state:e,dispatch:t})=>e.selection.ranges.some(e=>!e.empty)?x({state:e,dispatch:t}):(t(e.update(e.replaceSelection("\t"),{scrollIntoView:!0,userEvent:"input"})),!0),Rt.invertedEffects=q,Rt.isolateHistory=W,Rt.lineComment=U,Rt.lineUncomment=B,Rt.moveLineDown=pt,Rt.moveLineUp=ft,Rt.redo=o,Rt.redoDepth=Q,Rt.redoSelection=Y,Rt.selectAll=Ze,Rt.selectCharBackward=e=>R(e,!1),Rt.selectCharForward=e=>R(e,!0),Rt.selectCharLeft=we,Rt.selectCharRight=Re,Rt.selectDocEnd=Je,Rt.selectDocStart=Ye,Rt.selectGroupBackward=e=>I(e,!1),Rt.selectGroupForward=e=>I(e,!0),Rt.selectGroupLeft=Ie,Rt.selectGroupRight=Me,Rt.selectLine=Qe,Rt.selectLineBoundaryBackward=Ge,Rt.selectLineBoundaryForward=He,Rt.selectLineBoundaryLeft=Ve,Rt.selectLineBoundaryRight=We,Rt.selectLineDown=Fe,Rt.selectLineEnd=$e,Rt.selectLineStart=qe,Rt.selectLineUp=Le,Rt.selectMatchingBracket=({state:e,dispatch:t})=>Ce(e,t,!0),Rt.selectPageDown=je,Rt.selectPageUp=Be,Rt.selectParentSyntax=Xe,Rt.selectSubwordBackward=e=>Pe(e,!1),Rt.selectSubwordForward=e=>Pe(e,!0),Rt.selectSyntaxLeft=Ne,Rt.selectSyntaxRight=De,Rt.simplifySelection=et,Rt.splitLine=ct,Rt.standardKeymap=Ct,Rt.temporarilySetTabFocusMode=e=>(e.setTabFocusMode(2e3),!0),Rt.toggleBlockComment=j,Rt.toggleBlockCommentByLine=V,Rt.toggleComment=L,Rt.toggleLineComment=F,Rt.toggleTabFocusMode=At,Rt.transposeChars=ut,Rt.undo=a,Rt.undoDepth=Z,Rt.undoSelection=K,Rt}var J1,Z1={};var Q1,X1,eO,tO={},fe={};function rO(){return X1||(X1=1,Q1=function(){var e,t=arguments[0],r=("string"==typeof t&&(t=document.createElement(t)),1),n=arguments[1];if(n&&"object"==typeof n&&null==n.nodeType&&!Array.isArray(n)){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&("string"==typeof(e=n[a])?t.setAttribute(a,e):null!=e&&(t[a]=e));r++}for(;r<arguments.length;r++)!function e(t,r){if("string"==typeof r)t.appendChild(document.createTextNode(r));else if(null!=r)if(null!=r.nodeType)t.appendChild(r);else{if(!Array.isArray(r))throw new RangeError("Unsupported child node: "+r);for(var n=0;n<r.length;n++)e(t,r[n])}}(t,arguments[r]);return t}),Q1}function nO(){if(eO)return fe;eO=1;var g=B1(),m=I1(),n=rO();const o="function"==typeof String.prototype.normalize?e=>e.normalize("NFKD"):e=>e;class _{constructor(e,t,r=0,n=e.length,a,i){this.test=i,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(r,n),this.bufferStart=r,this.normalize=a?e=>a(o(e)):o,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return m.codePointAt(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){var e=this.peek();if(e<0)return this.done=!0,this;var r=m.fromCodePoint(e),n=this.bufferStart+this.bufferPos,a=(this.bufferPos+=m.codePointSize(e),this.normalize(r));for(let e=0,t=n;;e++){var i=a.charCodeAt(e),o=this.match(i,t,this.bufferPos+this.bufferStart);if(e==a.length-1){if(o)return this.value=o,this;break}t==n&&e<r.length&&r.charCodeAt(e)==i&&t++}}}match(n,e,a){let i=null;for(let r=0;r<this.matches.length;r+=2){let e=this.matches[r],t=!1;this.query.charCodeAt(e)==n&&(e==this.query.length-1?i={from:this.matches[r+1],to:a}:(this.matches[r]++,t=!0)),t||(this.matches.splice(r,2),r-=2)}return this.query.charCodeAt(0)==n&&(1==this.query.length?i={from:e,to:a}:this.matches.push(1,e)),i=i&&this.test&&!this.test(i.from,i.to,this.buffer,this.bufferStart)?null:i}}"undefined"!=typeof Symbol&&(_.prototype[Symbol.iterator]=function(){return this});const i={from:-1,to:-1,match:/.*/.exec("")},s="gm"+(null==/x/.unicode?"":"u");class l{constructor(e,t,r,n=0,a=e.length){if(this.text=e,this.to=a,this.curLine="",this.done=!1,this.value=i,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new U(e,t,r,n,a);this.re=new RegExp(t,s+(null!=r&&r.ignoreCase?"i":"")),this.test=null==r?void 0:r.test,this.iter=e.iter();a=e.lineAt(n);this.curLineStart=a.from,this.matchPos=d(e,n),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;var t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){var r=this.curLineStart+t.index,n=r+t[0].length;if(this.matchPos=d(this.text,n+(r==n?1:0)),r==this.curLineStart+this.curLine.length&&this.nextLine(),(r<n||r>this.value.to)&&(!this.test||this.test(r,n,t)))return this.value={from:r,to:n,match:t},this;e=this.matchPos-this.curLineStart}else{if(!(this.curLineStart+this.curLine.length<this.to))return this.done=!0,this;this.nextLine(),e=0}}}}const c=new WeakMap;class u{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,r){var n,a=c.get(e);if(!a||a.from>=r||a.to<=t)return n=new u(t,e.sliceString(t,r)),c.set(e,n),n;if(a.from==t&&a.to==r)return a;let{text:i,from:o}=a;return o>t&&(i=e.sliceString(t,o)+i,o=t),a.to<r&&(i+=e.sliceString(a.to,r)),c.set(e,new u(o,i)),new u(t,i.slice(t-o,r-o))}}class U{constructor(e,t,r,n,a){this.text=e,this.to=a,this.done=!1,this.value=i,this.matchPos=d(e,n),this.re=new RegExp(t,s+(null!=r&&r.ignoreCase?"i":"")),this.test=null==r?void 0:r.test,this.flat=u.get(e,n,this.chunkEnd(n+5e3))}chunkEnd(e){return(e>=this.to?this:this.text.lineAt(e)).to}next(){for(;;){var t=this.re.lastIndex=this.matchPos-this.flat.from;let e=this.re.exec(this.flat.text);if(e&&!e[0]&&e.index==t&&(this.re.lastIndex=1+t,e=this.re.exec(this.flat.text)),e){var t=this.flat.from+e.index,r=t+e[0].length;if((this.flat.to>=this.to||e.index+e[0].length<=this.flat.text.length-10)&&(!this.test||this.test(t,r,e)))return this.value={from:t,to:r,match:e},this.matchPos=d(this.text,r+(t==r?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=u.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+2*this.flat.text.length))}}}function d(r,n){if(!(n>=r.length)){let e=r.lineAt(n),t;for(;n<e.to&&56320<=(t=e.text.charCodeAt(n-e.from))&&t<57344;)n++}return n}function a(s){var e=String(s.state.doc.lineAt(s.state.selection.main.head).number);let t=n("input",{class:"cm-textfield",name:"line",value:e});function r(){var r=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(t.value);if(r){var n=s["state"],a=n.doc.lineAt(n.selection.main.head),[,r,e,i,o]=r,i=i?+i.slice(1):0;let t=e?+e:a.number;if(e&&o){let e=t/100;r&&(e=e*("-"==r?-1:1)+a.number/n.doc.lines),t=Math.round(n.doc.lines*e)}else e&&r&&(t=t*("-"==r?-1:1)+a.number);o=n.doc.line(Math.max(1,Math.min(n.doc.lines,t))),e=m.EditorSelection.cursor(o.from+Math.max(0,Math.min(i,o.length)));s.dispatch({effects:[f.of(!1),g.EditorView.scrollIntoView(e.from,{y:"center"})],selection:e}),s.focus()}}return{dom:n("form",{class:"cm-gotoLine",onkeydown:e=>{27==e.keyCode?(e.preventDefault(),s.dispatch({effects:f.of(!1)}),s.focus()):13==e.keyCode&&(e.preventDefault(),r())},onsubmit:e=>{e.preventDefault(),r()}},n("label",s.state.phrase("Go to line"),": ",t)," ",n("button",{class:"cm-button",type:"submit"},s.state.phrase("go")))}}"undefined"!=typeof Symbol&&(l.prototype[Symbol.iterator]=U.prototype[Symbol.iterator]=function(){return this});const f=m.StateEffect.define(),B=m.StateField.define({create(){return!0},update(e,t){for(var r of t.effects)r.is(f)&&(e=r.value);return e},provide:e=>g.showPanel.from(e,e=>e?a:null)});var t=e=>{let t=g.getPanel(e,a);var r;return t||(r=[f.of(!0)],null==e.state.field(B,!1)&&r.push(m.StateEffect.appendConfig.of([B,j])),e.dispatch({effects:r}),t=g.getPanel(e,a)),t&&t.dom.querySelector("input").select(),!0};const j=g.EditorView.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),r={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},H=m.Facet.define({combine(e){return m.combineConfig(e,r,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}});const G=g.Decoration.mark({class:"cm-selectionMatch"}),V=g.Decoration.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function W(e,t,r,n){return!(0!=r&&e(t.sliceDoc(r-1,r))==m.CharCategory.Word||n!=t.doc.length&&e(t.sliceDoc(n,n+1))==m.CharCategory.Word)}const q=g.ViewPlugin.fromClass(class{constructor(e){this.decorations=this.getDeco(e)}update(e){(e.selectionSet||e.docChanged||e.viewportChanged)&&(this.decorations=this.getDeco(e.view))}getDeco(e){var t,r,n,a=e.state.facet(H),i=e["state"],o=i.selection;if(1<o.ranges.length)return g.Decoration.none;let s=o.main,l,c=null;if(s.empty){if(!a.highlightWordAroundCursor)return g.Decoration.none;var o=i.wordAt(s.head);if(!o)return g.Decoration.none;c=i.charCategorizer(s.head),l=i.sliceDoc(o.from,o.to)}else{o=s.to-s.from;if(o<a.minSelectionLength||200<o)return g.Decoration.none;if(a.wholeWords){if(l=i.sliceDoc(s.from,s.to),!W(c=i.charCategorizer(s.head),i,s.from,s.to)||(o=c,t=i,r=s.from,n=s.to,o(t.sliceDoc(r,r+1))!=m.CharCategory.Word)||o(t.sliceDoc(n-1,n))!=m.CharCategory.Word)return g.Decoration.none}else if(!(l=i.sliceDoc(s.from,s.to)))return g.Decoration.none}var u,d=[];for(u of e.visibleRanges)for(var f=new _(i.doc,l,u.from,u.to);!f.next().done;){var{from:p,to:h}=f.value;if((!c||W(c,i,p,h))&&(s.empty&&p<=s.from&&h>=s.to?d.push(V.range(p,h)):(p>=s.to||h<=s.from)&&d.push(G.range(p,h)),d.length>a.maxMatches))return g.Decoration.none}return g.Decoration.set(d)}},{decorations:e=>e.decorations}),$=g.EditorView.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}});var z=({state:t,dispatch:e})=>{var r,n,a,i,o=t.selection["ranges"];if(o.some(e=>e.from===e.to))return{state:r,dispatch:n}=[{state:t,dispatch:e}][0],i=r.selection,!(a=m.EditorSelection.create(i.ranges.map(e=>r.wordAt(e.head)||m.EditorSelection.cursor(e.head)),i.mainIndex)).eq(i)&&(n(r.update({selection:a})),!0);let s=t.sliceDoc(o[0].from,o[0].to);return!t.selection.ranges.some(e=>t.sliceDoc(e.from,e.to)!=s)&&!!(i=function(r,n){var{main:e,ranges:a}=r.selection,t=r.wordAt(e.head),i=t&&t.from==e.from&&t.to==e.to;for(let e=!1,t=new _(r.doc,n,a[a.length-1].to);;)if(t.next(),t.done){if(e)return null;t=new _(r.doc,n,0,Math.max(0,a[a.length-1].from-1)),e=!0}else if(!e||!a.some(e=>e.from==t.value.from)){if(i){var o=r.wordAt(t.value.from);if(!o||o.from!=t.value.from||o.to!=t.value.to)continue}return t.value}}(t,s))&&(e(t.update({selection:t.selection.addRange(m.EditorSelection.range(i.from,i.to),!1),effects:g.EditorView.scrollIntoView(i.to)})),!0)};const p=m.Facet.define({combine(e){return m.combineConfig(e,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new oe(e),scrollToMatch:e=>g.EditorView.scrollIntoView(e)})}});class h{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||function(e){try{return new RegExp(e,s),!0}catch(e){return!1}}(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(e,t)=>"n"==t?"\n":"r"==t?"\r":"t"==t?"\t":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return new(this.regexp?J:Y)(this)}getCursor(e,t=0,r){e=e.doc?e:m.EditorState.create({doc:e});return null==r&&(r=e.doc.length),(this.regexp?T:y)(this,e,t,r)}}class K{constructor(e){this.spec=e}}function y(e,t,r,n){return new _(t.doc,e.unquoted,r,n,e.caseSensitive?void 0:e=>e.toLowerCase(),e.wholeWord?(a=t.doc,i=t.charCategorizer(t.selection.main.head),(e,t,r,n)=>((e<n||n+r.length<t)&&(n=Math.max(0,e-2),r=a.sliceString(n,Math.min(a.length,t+2))),!(i(b(r,e-n))==m.CharCategory.Word&&i(v(r,e-n))==m.CharCategory.Word||i(v(r,t-n))==m.CharCategory.Word&&i(b(r,t-n))==m.CharCategory.Word))):void 0);var a,i}class Y extends K{constructor(e){super(e)}nextMatch(e,t,r){let n=y(this.spec,e,r,e.doc.length).nextOverlapping();return(n=n.done?y(this.spec,e,0,t).nextOverlapping():n).done?null:n.value}prevMatchInRange(n,a,e){for(let r=e;;){var i=Math.max(a,r-1e4-this.spec.unquoted.length);let e=y(this.spec,n,i,r),t=null;for(;!e.nextOverlapping().done;)t=e.value;if(t)return t;if(i==a)return null;r-=1e4}}prevMatch(e,t,r){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,r,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){for(var r=y(this.spec,e,0,e.doc.length),n=[];!r.next().done;){if(t<=n.length)return null;n.push(r.value)}return n}highlight(e,t,r,n){for(var a=y(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(r+this.spec.unquoted.length,e.doc.length));!a.next().done;)n(a.value.from,a.value.to)}}function T(e,t,r,n){return new l(t.doc,e.search,{ignoreCase:!e.caseSensitive,test:e.wholeWord?(a=t.charCategorizer(t.selection.main.head),(e,t,r)=>!r[0].length||(a(b(r.input,r.index))!=m.CharCategory.Word||a(v(r.input,r.index))!=m.CharCategory.Word)&&(a(v(r.input,r.index+r[0].length))!=m.CharCategory.Word||a(b(r.input,r.index+r[0].length))!=m.CharCategory.Word)):void 0},r,n);var a}function b(e,t){return e.slice(m.findClusterBreak(e,t,!1),t)}function v(e,t){return e.slice(t,m.findClusterBreak(e,t))}class J extends K{nextMatch(e,t,r){let n=T(this.spec,e,r,e.doc.length).next();return(n=n.done?T(this.spec,e,0,t).next():n).done?null:n.value}prevMatchInRange(n,a,i){for(let r=1;;r++){var o=Math.max(a,i-1e4*r);let e=T(this.spec,n,o,i),t=null;for(;!e.next().done;)t=e.value;if(t&&(o==a||t.from>o+10))return t;if(o==a)return null}}prevMatch(e,t,r){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,r,e.doc.length)}getReplacement(r){return this.spec.unquote(this.spec.replace).replace(/\$([$&\d+])/g,(e,t)=>"$"==t?"$":"&"==t?r.match[0]:"0"!=t&&+t<r.match.length?r.match[t]:e)}matchAll(e,t){for(var r=T(this.spec,e,0,e.doc.length),n=[];!r.next().done;){if(t<=n.length)return null;n.push(r.value)}return n}highlight(e,t,r,n){for(var a=T(this.spec,e,Math.max(0,t-250),Math.min(r+250,e.doc.length));!a.next().done;)n(a.value.from,a.value.to)}}const E=m.StateEffect.define(),S=m.StateEffect.define(),A=m.StateField.define({create(e){return new O(I(e).create(),null)},update(e,t){for(var r of t.effects)r.is(E)?e=new O(r.value.create(),e.panel):r.is(S)&&(e=new O(e.query,r.value?R:null));return e},provide:e=>g.showPanel.from(e,e=>e.panel)});class O{constructor(e,t){this.query=e,this.panel=t}}const Z=g.Decoration.mark({class:"cm-searchMatch"}),Q=g.Decoration.mark({class:"cm-searchMatch cm-searchMatch-selected"});var X=g.ViewPlugin.fromClass(class{constructor(e){this.view=e,this.decorations=this.highlight(e.state.field(A))}update(e){var t=e.state.field(A);(t!=e.startState.field(A)||e.docChanged||e.selectionSet||e.viewportChanged)&&(this.decorations=this.highlight(t))}highlight({query:i,panel:e}){if(!e||!i.spec.valid)return g.Decoration.none;let o=this["view"],s=new m.RangeSetBuilder;for(let r=0,n=o.visibleRanges,a=n.length;r<a;r++){let{from:e,to:t}=n[r];for(;r<a-1&&t>n[r+1].from-500;)t=n[++r].to;i.highlight(o.state,e,t,(t,r)=>{var e=o.state.selection.ranges.some(e=>e.from==t&&e.to==r);s.add(t,r,e?Q:Z)})}return s.finish()}},{decorations:e=>e.decorations});function e(r){return e=>{var t=e.state.field(A,!1);return t&&t.query.spec.valid?r(e,t):M(e)}}const C=e((e,{query:t})=>{var r,n=e.state.selection.main["to"],t=t.nextMatch(e.state,n,n);return!!t&&(n=m.EditorSelection.single(t.from,t.to),r=e.state.facet(p),e.dispatch({selection:n,effects:[L(e,t),r.scrollToMatch(n.main,e)],userEvent:"select.search"}),ae(e),!0)}),k=e((e,{query:t})=>{var r=e["state"],n=r.selection.main["from"],t=t.prevMatch(r,n,n);return!!t&&(r=m.EditorSelection.single(t.from,t.to),n=e.state.facet(p),e.dispatch({selection:r,effects:[L(e,t),n.scrollToMatch(r.main,e)],userEvent:"select.search"}),ae(e),!0)}),ee=e((e,{query:t})=>{t=t.matchAll(e.state,1e3);return!(!t||!t.length||(e.dispatch({selection:m.EditorSelection.create(t.map(e=>m.EditorSelection.range(e.from,e.to))),userEvent:"select.search.matches"}),0))});var te=({state:e,dispatch:t})=>{var r=e.selection;if(1<r.ranges.length||r.main.empty)return!1;var{from:n,to:r}=r.main;let a=[],i=0;for(var o=new _(e.doc,e.sliceDoc(n,r));!o.next().done;){if(1e3<a.length)return!1;o.value.from==n&&(i=a.length),a.push(m.EditorSelection.range(o.value.from,o.value.to))}return t(e.update({selection:m.EditorSelection.create(a,i),userEvent:"select.search.matches"})),!0};const w=e((e,{query:t})=>{var r=e["state"],{from:n,to:a}=r.selection.main;if(r.readOnly)return!1;let i=t.nextMatch(r,n,n);if(!i)return!1;let o=[],s,l;var c=[];return i.from==n&&i.to==a&&(l=r.toText(t.getReplacement(i)),o.push({from:i.from,to:i.to,insert:l}),i=t.nextMatch(r,i.from,i.to),c.push(g.EditorView.announce.of(r.phrase("replaced match on line $",r.doc.lineAt(n).number)+"."))),i&&(a=0==o.length||o[0].from>=i.to?0:i.to-i.from-l.length,s=m.EditorSelection.single(i.from-a,i.to-a),c.push(L(e,i)),c.push(r.facet(p).scrollToMatch(s.main,e))),e.dispatch({changes:o,selection:s,effects:c,userEvent:"input.replace"}),!0}),re=e((e,{query:n})=>{var t,r;return!e.state.readOnly&&!!(t=n.matchAll(e.state,1e9).map(e=>{var{from:t,to:r}=e;return{from:t,to:r,insert:n.getReplacement(e)}})).length&&(r=e.state.phrase("replaced $ matches",t.length)+".",e.dispatch({changes:t,effects:g.EditorView.announce.of(r),userEvent:"input.replace.all"}),!0)});function R(e){return e.state.facet(p).createPanel(e)}function I(e,t){var r,n=e.selection.main,n=n.empty||n.to>n.from+100?"":e.sliceDoc(n.from,n.to);return t&&!n?t:(e=e.facet(p),new h({search:(null!=(r=null==t?void 0:t.literal)?r:e.literal)?n:n.replace(/\n/g,"\\n"),caseSensitive:null!=(r=null==t?void 0:t.caseSensitive)?r:e.caseSensitive,literal:null!=(n=null==t?void 0:t.literal)?n:e.literal,regexp:null!=(r=null==t?void 0:t.regexp)?r:e.regexp,wholeWord:null!=(n=null==t?void 0:t.wholeWord)?n:e.wholeWord}))}function ne(e){e=g.getPanel(e,R);return e&&e.dom.querySelector("[main-field]")}function ae(e){var t=ne(e);t&&t==e.root.activeElement&&t.select()}const M=e=>{var t,r,n=e.state.field(A,!1);return n&&n.panel?(t=ne(e))&&t!=e.root.activeElement&&((r=I(e.state,n.query.spec)).valid&&e.dispatch({effects:E.of(r)}),t.focus(),t.select()):e.dispatch({effects:[S.of(!0),n?E.of(I(e.state,n.query.spec)):m.StateEffect.appendConfig.of(F)]}),!0},P=e=>{var t=e.state.field(A,!1);return!(!t||!t.panel||((t=g.getPanel(e,R))&&t.dom.contains(e.root.activeElement)&&e.focus(),e.dispatch({effects:S.of(!1)}),0))};var ie=[{key:"Mod-f",run:M,scope:"editor search-panel"},{key:"F3",run:C,shift:k,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:C,shift:k,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:P,scope:"editor search-panel"},{key:"Mod-Shift-l",run:te},{key:"Mod-Alt-g",run:t},{key:"Mod-d",run:z,preventDefault:!0}];class oe{constructor(e){this.view=e;var t=this.query=e.state.field(A).query.spec;function r(e,t,r){return n("button",{class:"cm-button",name:e,onclick:t,type:"button"},r)}this.commit=this.commit.bind(this),this.searchField=n("input",{value:t.search,placeholder:N(e,"Find"),"aria-label":N(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=n("input",{value:t.replace,placeholder:N(e,"Replace"),"aria-label":N(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=n("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=n("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=n("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit}),this.dom=n("div",{onkeydown:e=>this.keydown(e),class:"cm-search"},[this.searchField,r("next",()=>C(e),[N(e,"next")]),r("prev",()=>k(e),[N(e,"previous")]),r("select",()=>ee(e),[N(e,"all")]),n("label",null,[this.caseField,N(e,"match case")]),n("label",null,[this.reField,N(e,"regexp")]),n("label",null,[this.wordField,N(e,"by word")]),...e.state.readOnly?[]:[n("br"),this.replaceField,r("replace",()=>w(e),[N(e,"replace")]),r("replaceAll",()=>re(e),[N(e,"replace all")])],n("button",{name:"close",onclick:()=>P(e),"aria-label":N(e,"close"),type:"button"},["×"])])}commit(){var e=new h({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:E.of(e)}))}keydown(e){g.runScopeHandlers(this.view,e,"search-panel")?e.preventDefault():13==e.keyCode&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?k:C)(this.view)):13==e.keyCode&&e.target==this.replaceField&&(e.preventDefault(),w(this.view))}update(e){for(var t of e.transactions)for(var r of t.effects)r.is(E)&&!r.value.eq(this.query)&&this.setQuery(r.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(p).top}}function N(e,t){return e.state.phrase(t)}const D=30,x=/[\s\.,:;?!]/;function L(e,{from:t,to:r}){var n=e.state.doc.lineAt(t),a=e.state.doc.lineAt(r).to,t=Math.max(n.from,t-D),r=Math.min(a,r+D);let i=e.state.sliceDoc(t,r);if(t!=n.from)for(let e=0;e<D;e++)if(!x.test(i[e+1])&&x.test(i[e])){i=i.slice(e);break}if(r!=a)for(let e=i.length-1;e>i.length-D;e--)if(!x.test(i[e-1])&&x.test(i[e])){i=i.slice(0,e);break}return g.EditorView.announce.of(`${e.state.phrase("current match")}. ${i} ${e.state.phrase("on line")} ${n.number}.`)}var se=g.EditorView.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}});const F=[A,m.Prec.low(X),se];return fe.RegExpCursor=l,fe.SearchCursor=_,fe.SearchQuery=h,fe.closeSearchPanel=P,fe.findNext=C,fe.findPrevious=k,fe.getSearchQuery=function(e){var t=e.field(A,!1);return t?t.query.spec:I(e)},fe.gotoLine=t,fe.highlightSelectionMatches=function(e){var t=[$,q];return e&&t.push(H.of(e)),t},fe.openSearchPanel=M,fe.replaceAll=re,fe.replaceNext=w,fe.search=function(e){return e?[p.of(e),F]:F},fe.searchKeymap=ie,fe.searchPanelOpen=function(e){return null!=(null==(e=e.field(A,!1))?void 0:e.panel)},fe.selectMatches=ee,fe.selectNextOccurrence=z,fe.selectSelectionMatches=te,fe.setSearchQuery=E,fe}var aO,xe={};function iO(){if(aO)return xe;aO=1;var t,r,S=I1(),h=B1(),m=K1();class s{constructor(e,t,r){this.state=e,this.pos=t,this.explicit=r,this.abortListeners=[]}tokenBefore(e){let t=m.syntaxTree(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){var t=this.state.doc.lineAt(this.pos),r=Math.max(t.from,this.pos-250),t=t.text.slice(r-t.from,this.pos-t.from),e=t.search(c(e,!1));return e<0?null:{from:r+e,to:this.pos,text:t.slice(e)}}get aborted(){return null==this.abortListeners}addEventListener(e,t){"abort"==e&&this.abortListeners&&this.abortListeners.push(t)}}function i(e){let t=Object.keys(e).join("");e=/\w/.test(t);return`[${e?"\\w":""}${(t=e?t.replace(/\w/g,""):t).replace(/[^\w\s]/g,"\\$&")}]`}function n(e){let r=e.map(e=>"string"==typeof e?{label:e}:e),[n,a]=r.every(e=>/^\w+$/.test(e.label))?[/\w*$/,/\w+$/]:function(e){var t,r=Object.create(null),n=Object.create(null);for({label:t}of e){r[t[0]]=!0;for(let e=1;e<t.length;e++)n[t[e]]=!0}return e=i(r)+i(n)+"*$",[new RegExp("^"+e),new RegExp(e)]}(r);return e=>{var t=e.matchBefore(a);return t||e.explicit?{from:t?t.from:e.pos,options:r,validFor:n}:null}}class E{constructor(e,t,r,n){this.completion=e,this.source=t,this.match=r,this.score=n}}function l(e){return e.selection.main.from}function c(e,t){var r=e["source"],t=t&&"^"!=r[0],n="$"!=r[r.length-1];return t||n?new RegExp(`${t?"^":""}(?:${r})`+(n?"$":""),null!=(t=e.flags)?t:e.ignoreCase?"i":""):e}const u=S.Annotation.define();function a(t,r,n,a){let i=t.selection["main"],o=n-i.from,s=a-i.from;return Object.assign(Object.assign({},t.changeByRange(e=>e!=i&&n!=a&&t.sliceDoc(e.from+o,e.from+s)!=t.sliceDoc(n,a)?{range:e}:{changes:{from:e.from+o,to:a==i.from?e.to:e.from+s,insert:r},range:S.EditorSelection.cursor(e.from+o+r.length)})),{scrollIntoView:!0,userEvent:"input.complete"})}const L=new WeakMap;function F(e){if(!Array.isArray(e))return e;let t=L.get(e);return t||L.set(e,t=n(e)),t}const d=S.StateEffect.define(),f=S.StateEffect.define();class U{constructor(t){this.pattern=t,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let e=0;e<t.length;){var r=S.codePointAt(t,e),n=S.codePointSize(r),r=(this.chars.push(r),t.slice(e,e+n)),a=r.toUpperCase();this.folded.push(S.codePointAt(a==r?r.toLowerCase():a,0)),e+=n}this.astral=t.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,this}match(n){if(0==this.pattern.length)return this.ret(-100,[]);if(n.length<this.pattern.length)return null;var{chars:a,folded:i,any:r,precise:o,byWord:s}=this;if(1==a.length){var t=S.codePointAt(n,0),l=S.codePointSize(t);let e=l==n.length?0:-100;if(t!=a[0]){if(t!=i[0])return null;e+=-200}return this.ret(e,[0,l])}var c=n.indexOf(this.pattern);if(0==c)return this.ret(n.length==this.pattern.length?0:-100,[0,this.pattern.length]);let u=a.length,d=0;if(c<0){for(let e=0,t=Math.min(n.length,200);e<t&&d<u;){var f=S.codePointAt(n,e);f!=a[d]&&f!=i[d]||(r[d++]=e),e+=S.codePointSize(f)}if(d<u)return null}let p=0,h=0,g=!1,m=0,_=-1,y=-1,T=/[a-z]/.test(n),b=!0;for(let e=0,t=Math.min(n.length,200),r=0;e<t&&h<u;){var v=S.codePointAt(n,e);c<0&&(p<u&&v==a[p]&&(o[p++]=e),m<u)&&(v==a[m]||v==i[m]?(0==m&&(_=e),y=e+1,m++):m=0);var E=v<255?48<=v&&v<=57||97<=v&&v<=122?2:65<=v&&v<=90?1:0:(E=S.fromCodePoint(v))!=E.toLowerCase()?1:E!=E.toUpperCase()?2:0;(!e||1==E&&T||0==r&&0!=E)&&(a[h]==v||i[h]==v&&(g=!0)?s[h++]=e:s.length&&(b=!1)),r=E,e+=S.codePointSize(v)}return h==u&&0==s[0]&&b?this.result((g?-200:0)-100,s,n):m==u&&0==_?this.ret(-200-n.length+(y==n.length?0:-100),[0,y]):-1<c?this.ret(-700-n.length,[c,c+this.pattern.length]):m==u?this.ret(-900-n.length,[_,y]):h==u?this.result((g?-200:0)-100-700+(b?0:-1100),s,n):2==a.length?null:this.result((r[0]?-700:0)-200-1100,r,n)}result(e,t,r){let n=[],a=0;for(var i of t){var o=i+(this.astral?S.codePointSize(S.codePointAt(r,i)):1);a&&n[a-1]==i?n[a-1]=o:(n[a++]=i,n[a++]=o)}return this.ret(e-r.length,n)}}class B{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){var t,r;return e.length<this.pattern.length||null==(r=(t=e.slice(0,this.pattern.length))==this.pattern?0:t.toLowerCase()==this.folded?-200:null)?null:(this.matched=[0,t.length],this.score=r+(e.length==this.pattern.length?0:-100),this)}}const A=S.Facet.define({combine(e){return S.combineConfig(e,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:H,filterStrict:!1,compareCompletions:(e,t)=>e.label.localeCompare(t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(t,r)=>e=>j(t(e),r(e)),optionClass:(t,r)=>e=>j(t(e),r(e)),addToOptions:(e,t)=>e.concat(t),filterStrict:(e,t)=>e||t})}});function j(e,t){return e?t?e+" "+t:e:t}function H(e,t,r,n,a,i){let o=e.textDirection==h.Direction.RTL,s=o,l=!1,c="top",u,d;var e=t.left-a.left,f=a.right-t.right,p=n.right-n.left,n=n.bottom-n.top,e=(s&&e<Math.min(p,f)?s=!1:!s&&f<Math.min(p,e)&&(s=!0),p<=(s?e:f)?(u=Math.max(a.top,Math.min(r.top,a.bottom-n))-t.top,d=Math.min(400,s?e:f)):(l=!0,d=Math.min(400,(o?t.right:a.right-t.left)-30),p=a.bottom-t.bottom,u=n<=p||p>t.top?r.bottom-t.top:(c="bottom",t.bottom-r.top)),(t.bottom-t.top)/i.offsetHeight),f=(t.right-t.left)/i.offsetWidth;return{style:`${c}: ${u/e}px; max-width: ${d/f}px`,class:"cm-completionInfo-"+(l?o?"left-narrow":"right-narrow":s?"left":"right")}}function p(e,t,r){var n;return e<=r?{from:0,to:e}:(t=t<0?0:t)<=e>>1?{from:(n=Math.floor(t/r))*r,to:(n+1)*r}:{from:e-((n=Math.floor((e-t)/r))+1)*r,to:e-n*r}}class G{constructor(a,e,t){this.view=a,this.stateField=e,this.applyCompletion=t,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:e=>this.placeInfo(e),key:this},this.space=null,this.currentClass="";var r,n,t=a.state.field(e),{options:i,selected:o}=t.open,s=a.state.facet(A);this.optionContent=(n=(r=s).addToOptions.slice(),r.icons&&n.push({render(e){var t=document.createElement("div");return t.classList.add("cm-completionIcon"),e.type&&t.classList.add(...e.type.split(/\s+/g).map(e=>"cm-completionIcon-"+e)),t.setAttribute("aria-hidden","true"),t},position:20}),n.push({render(e,t,r,n){var a=document.createElement("span");a.className="cm-completionLabel";let i=e.displayLabel||e.label,o=0;for(let e=0;e<n.length;){var s=n[e++],l=n[e++],c=(s>o&&a.appendChild(document.createTextNode(i.slice(o,s))),a.appendChild(document.createElement("span")));c.appendChild(document.createTextNode(i.slice(s,l))),c.className="cm-completionMatchedText",o=l}return o<i.length&&a.appendChild(document.createTextNode(i.slice(o))),a},position:50},{render(e){var t;return e.detail?((t=document.createElement("span")).className="cm-completionDetail",t.textContent=e.detail,t):null},position:80}),n.sort((e,t)=>e.position-t.position).map(e=>e.render)),this.optionClass=s.optionClass,this.tooltipClass=s.tooltipClass,this.range=p(i.length,o,s.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(a.state),this.dom.addEventListener("mousedown",r=>{var n=a.state.field(e).open["options"];for(let e=r.target,t;e&&e!=this.dom;e=e.parentNode)if("LI"==e.nodeName&&(t=/-(\d+)$/.exec(e.id))&&+t[1]<n.length)return this.applyCompletion(a,n[+t[1]]),void r.preventDefault()}),this.dom.addEventListener("focusout",e=>{var t=a.state.field(this.stateField,!1);t&&t.tooltip&&a.state.facet(A).closeOnBlur&&e.relatedTarget!=a.contentDOM&&a.dispatch({effects:f.of(null)})}),this.showOptions(i,t.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var t,r,n,a=e.state.field(this.stateField),i=e.startState.field(this.stateField);this.updateTooltipClass(e.state),a!=i&&({options:t,selected:r,disabled:n}=a.open,i.open&&i.open.options==t||(this.range=p(t.length,r,e.state.facet(A).maxRenderedOptions),this.showOptions(t,a.id)),this.updateSel(),n!=(null==(r=i.open)?void 0:r.disabled))&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!n)}updateTooltipClass(e){e=this.tooltipClass(e);if(e!=this.currentClass){for(var t of this.currentClass.split(" "))t&&this.dom.classList.remove(t);for(var r of e.split(" "))r&&this.dom.classList.add(r);this.currentClass=e}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let r=this.view.state.field(this.stateField),e=r.open;if((-1<e.selected&&e.selected<this.range.from||e.selected>=this.range.to)&&(this.range=p(e.options.length,e.selected,this.view.state.facet(A).maxRenderedOptions),this.showOptions(e.options,r.id)),this.updateSelectedOption(e.selected)){this.destroyInfo();let t=e.options[e.selected]["completion"];var n=t["info"];n&&(n="string"==typeof n?document.createTextNode(n):n(t))&&("then"in n?n.then(e=>{e&&this.view.state.field(this.stateField,!1)==r&&this.addInfoPane(e,t)}).catch(e=>h.logException(this.view.state,e,"completion info")):this.addInfoPane(n,t))}}addInfoPane(e,t){this.destroyInfo();var r,n=this.info=document.createElement("div");n.className="cm-tooltip cm-completionInfo",null!=e.nodeType?(n.appendChild(e),this.infoDestroy=null):({dom:e,destroy:r}=e,n.appendChild(e),this.infoDestroy=r||null),this.dom.appendChild(n),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(r){let n=null;for(let e=this.list.firstChild,t=this.range.from;e;e=e.nextSibling,t++)"LI"==e.nodeName&&e.id?t==r?e.hasAttribute("aria-selected")||(e.setAttribute("aria-selected","true"),n=e):e.hasAttribute("aria-selected")&&e.removeAttribute("aria-selected"):t--;var e,t,a,i;return n&&(e=this.list,t=n,a=e.getBoundingClientRect(),t=t.getBoundingClientRect(),i=a.height/e.offsetHeight,t.top<a.top?e.scrollTop-=(a.top-t.top)/i:t.bottom>a.bottom&&(e.scrollTop+=(t.bottom-a.bottom)/i)),n}measureInfo(){var e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;var t,r=this.dom.getBoundingClientRect(),n=this.info.getBoundingClientRect(),e=e.getBoundingClientRect();let a=this.space;return a||(t=this.dom.ownerDocument.defaultView||window,a={left:0,top:0,right:t.innerWidth,bottom:t.innerHeight}),e.top>Math.min(a.bottom,r.bottom)-10||e.bottom<Math.max(a.top,r.top)+10?null:this.view.state.facet(A).positionInfo(this.view,r,e,n,a,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(t,r,n){var a=document.createElement("ul");a.id=r,a.setAttribute("role","listbox"),a.setAttribute("aria-expanded","true"),a.setAttribute("aria-label",this.view.state.phrase("Completions"));let i=null;for(let e=n.from;e<n.to;e++){var o,s,{completion:l,match:c}=t[e],u=l["section"],d=(u&&(o="string"==typeof u?u:u.name)!=i&&(e>n.from||0==n.from)&&(i=o,"string"!=typeof u&&u.header?a.appendChild(u.header(u)):a.appendChild(document.createElement("completion-section")).textContent=o),a.appendChild(document.createElement("li"))),u=(d.id=r+"-"+e,d.setAttribute("role","option"),this.optionClass(l));u&&(d.className=u);for(s of this.optionContent){var f=s(l,this.view.state,this.view,c);f&&d.appendChild(f)}}return n.from&&a.classList.add("cm-completionListIncompleteTop"),n.to<t.length&&a.classList.add("cm-completionListIncompleteBottom"),a}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function V(e){return 100*(e.boost||0)+(e.apply?10:0)+(e.info?5:0)+(e.type?1:0)}class g{constructor(e,t,r,n,a,i){this.options=e,this.attrs=t,this.tooltip=r,this.timestamp=n,this.selected=a,this.disabled=i}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new g(this.options,$(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,r,n,a){var i=function(e,t){let r=[],n=null;var a,i,o,s,l=e=>{r.push(e);e=e.completion.section;if(e){n=n||[];let t="string"==typeof e?e:e.name;n.some(e=>e.name==t)||n.push("string"==typeof e?{name:t}:e)}},c=t.facet(A);for(a of e)if(a.hasResult()){var u=a.result.getMatch;if(!1===a.result.filter)for(var d of a.result.options)l(new E(d,a.source,u?u(d):[],1e9-r.length));else{var f,p,h,g=t.sliceDoc(a.from,a.to),m=new(c.filterStrict?B:U)(g);for(p of a.result.options)(f=m.match(p.label))&&(h=p.displayLabel?u?u(p,f.matched):[]:f.matched,l(new E(p,a.source,h,f.score+(p.boost||0))))}}if(n){let e=Object.create(null),t=0;for(o of n.sort((e,t)=>{var r;return(null!=(r=e.rank)?r:1e9)-(null!=(r=t.rank)?r:1e9)||(e.name<t.name?-1:1)}))t-=1e5,e[o.name]=t;for(s of r){var _=s.completion["section"];_&&(s.score+=e["string"==typeof _?_:_.name])}}let y=[],T=null,b=c.compareCompletions;for(i of r.sort((e,t)=>t.score-e.score||b(e.completion,t.completion))){var v=i.completion;!T||T.label!=v.label||T.detail!=v.detail||null!=T.type&&null!=v.type&&T.type!=v.type||T.apply!=v.apply||T.boost!=v.boost?y.push(i):V(i.completion)>V(T)&&(y[y.length-1]=i),T=i.completion}return y}(e,t);if(!i.length)return n&&e.some(e=>1==e.state)?new g(n.options,n.attrs,n.tooltip,n.timestamp,n.selected,!0):null;let o=t.facet(A).selectOnOpen?0:-1;if(n&&n.selected!=o&&-1!=n.selected){var s=n.options[n.selected].completion;for(let e=0;e<i.length;e++)if(i[e].completion==s){o=e;break}}return new g(i,$(r,o),{pos:e.reduce((e,t)=>t.hasResult()?Math.min(e,t.from):e,1e8),create:Y,above:a.aboveCursor},n?n.timestamp:Date.now(),o,!1)}map(e){return new g(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class o{constructor(e,t,r){this.active=e,this.id=t,this.open=r}static start(){return new o(z,"cm-ac-"+Math.floor(2e6*Math.random()).toString(36),null)}update(r){let e=r["state"],n=e.facet(A);var t;let a=(n.override||e.languageDataAt("autocomplete",l(e)).map(F)).map(t=>{return(this.active.find(e=>e.source==t)||new y(t,this.active.some(e=>0!=e.state)?1:0)).update(r,n)}),i=(a.length==this.active.length&&a.every((e,t)=>e==this.active[t])&&(a=this.active),this.open);i&&r.docChanged&&(i=i.map(r.changes)),r.selection||a.some(e=>e.hasResult()&&r.changes.touchesRange(e.from,e.to))||!function(r,n){if(r==n)return 1;for(let e=0,t=0;;){for(;e<r.length&&!r[e].hasResult;)e++;for(;t<n.length&&!n[t].hasResult;)t++;var a=e==r.length,i=t==n.length;if(a||i)return a==i;if(r[e++].result!=n[t++].result)return}}(a,this.active)?i=g.build(a,e,this.id,i,n):i&&i.disabled&&!a.some(e=>1==e.state)&&(i=null),!i&&a.every(e=>1!=e.state)&&a.some(e=>e.hasResult())&&(a=a.map(e=>e.hasResult()?new y(e.source,0):e));for(t of r.effects)t.is(b)&&(i=i&&i.setSelected(t.value,this.id));return a==this.active&&i==this.open?this:new o(a,this.id,i)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?W:q}}const W={"aria-autocomplete":"list"},q={};function $(e,t){var r={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":e};return-1<t&&(r["aria-activedescendant"]=e+"-"+t),r}const z=[];function _(e,t){if(e.isUserEvent("input.complete")){var r=e.annotation(u);if(r&&t.activateOnCompletion(r))return"input"}return e.isUserEvent("input.type")?"input":e.isUserEvent("delete.backward")?"delete":null}class y{constructor(e,t,r=-1){this.source=e,this.state=t,this.explicitPos=r}hasResult(){return!1}update(e,t){let r=_(e,t),n=this;r?n=n.handleUserEvent(e,r,t):e.docChanged?n=n.handleChange(e):e.selection&&0!=n.state&&(n=new y(n.source,0));for(var a of e.effects)if(a.is(d))n=new y(n.source,1,a.value?l(e.state):-1);else if(a.is(f))n=new y(n.source,0);else if(a.is(K))for(var i of a.value)i.source==n.source&&(n=i);return n}handleUserEvent(e,t,r){return"delete"!=t&&r.activateOnTyping?new y(this.source,1):this.map(e.changes)}handleChange(e){return e.changes.touchesRange(l(e.startState))?new y(this.source,0):this.map(e.changes)}map(e){return e.empty||this.explicitPos<0?this:new y(this.source,this.state,e.mapPos(this.explicitPos))}}class T extends y{constructor(e,t,r,n,a){super(e,2,t),this.result=r,this.from=n,this.to=a}hasResult(){return!0}handleUserEvent(e,t,r){let n=this.result;n.map&&!e.changes.empty&&(n=n.map(n,e.changes));var a=e.changes.mapPos(this.from),i=e.changes.mapPos(this.to,1),o=l(e.state);return(this.explicitPos<0?o<=a:o<this.from)||i<o||!n||"delete"==t&&l(e.startState)==this.from?new y(this.source,"input"==t&&r.activateOnTyping?1:0):(t=this.explicitPos<0?-1:e.changes.mapPos(this.explicitPos),function(e,t,r,n){if(!e)return;var a=t.sliceDoc(r,n);return"function"==typeof e?e(a,r,n,t):c(e,!0).test(a)}(n.validFor,e.state,a,i)?new T(this.source,t,n,a,i):n.update&&(n=n.update(n,a,i,new s(e.state,o,0<=t)))?new T(this.source,t,n,n.from,null!=(r=n.to)?r:l(e.state)):new y(this.source,1,t))}handleChange(e){return e.changes.touchesRange(this.from,this.to)?new y(this.source,0):this.map(e.changes)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new T(this.source,this.explicitPos<0?-1:e.mapPos(this.explicitPos),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new y(this.source,0)}}const K=S.StateEffect.define({map(e,t){return e.map(e=>e.map(t))}}),b=S.StateEffect.define(),v=S.StateField.define({create(){return o.start()},update(e,t){return e.update(t)},provide:e=>[h.showTooltip.from(e,e=>e.tooltip),h.EditorView.contentAttributes.from(e,e=>e.attrs)]});function O(e,t){var r=t.completion.apply||t.completion.label,n=e.state.field(v).active.find(e=>e.source==t.source);return n instanceof T&&("string"==typeof r?e.dispatch(Object.assign(Object.assign({},a(e.state,r,n.from,n.to)),{annotations:u.of(t.completion)})):r(e,t.completion,n.from,n.to),!0)}t=v,r=O;const Y=e=>new G(e,t,r);function e(o,s="option"){return e=>{var t=e.state.field(v,!1);if(!t||!t.open||t.open.disabled||Date.now()-t.open.timestamp<e.state.facet(A).interactionDelay)return!1;let r=1,n;"page"==s&&(n=h.getTooltip(e,t.open.tooltip))&&(r=Math.max(2,Math.floor(n.dom.offsetHeight/n.dom.querySelector("li").offsetHeight)-1));var a=t.open.options["length"];let i=-1<t.open.selected?t.open.selected+r*(o?1:-1):o?0:a-1;return i<0?i="page"==s?0:a-1:i>=a&&(i="page"==s?a-1:0),e.dispatch({effects:b.of(i)}),!0}}var J=e=>{var t=e.state.field(v,!1);return!(e.state.readOnly||!t||!t.open||t.open.selected<0||t.open.disabled||Date.now()-t.open.timestamp<e.state.facet(A).interactionDelay)&&O(e,t.open.options[t.open.selected])},Z=e=>{return!!e.state.field(v,!1)&&(e.dispatch({effects:d.of(!0)}),!0)},Q=e=>{var t=e.state.field(v,!1);return!(!t||!t.active.some(e=>0!=e.state)||(e.dispatch({effects:f.of(null)}),0))};class X{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const ee=h.ViewPlugin.fromClass(class{constructor(e){this.view=e,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(var t of e.state.field(v).active)1==t.state&&this.startQuery(t)}update(t){var e=t.state.field(v);let r=t.state.facet(A);if(t.selectionSet||t.docChanged||t.startState.field(v)!=e){var n=t.transactions.some(e=>(e.selection||e.docChanged)&&!_(e,r));for(let e=0;e<this.running.length;e++){var a=this.running[e];if(n||50<a.updates.length+t.transactions.length&&1e3<Date.now()-a.time){for(var i of a.context.abortListeners)try{i()}catch(e){h.logException(this.view.state,e)}a.context.abortListeners=null,this.running.splice(e--,1)}else a.updates.push(...t.transactions)}-1<this.debounceUpdate&&clearTimeout(this.debounceUpdate),t.transactions.some(e=>e.effects.some(e=>e.is(d)))&&(this.pendingStart=!0);var o=this.pendingStart?50:r.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(t=>1==t.state&&!this.running.some(e=>e.active.source==t.source))?setTimeout(()=>this.startUpdate(),o):-1,0!=this.composing)for(var s of t.transactions)"input"==_(s,r)?this.composing=2:2==this.composing&&s.selection&&(this.composing=3)}}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;var e=this.view["state"];for(let t of e.field(v).active)1!=t.state||this.running.some(e=>e.active.source==t.source)||this.startQuery(t)}startQuery(e){var t=this.view["state"],r=l(t),t=new s(t,r,e.explicitPos==r);let n=new X(e,t);this.running.push(n),Promise.resolve(e.source(t)).then(e=>{n.context.aborted||(n.done=e||null,this.scheduleAccept())},e=>{this.view.dispatch({effects:f.of(null)}),h.logException(this.view.state,e)})}scheduleAccept(){this.running.every(e=>void 0!==e.done)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(A).updateSyncTime))}accept(){-1<this.debounceAccept&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;var r=[],n=this.view.state.facet(A);for(let e=0;e<this.running.length;e++){let t=this.running[e];if(void 0!==t.done){if(this.running.splice(e--,1),t.done){let e=new T(t.active.source,t.active.explicitPos,t.done,t.done.from,null!=(i=t.done.to)?i:l(t.updates.length?t.updates[0].startState:this.view.state));for(var a of t.updates)e=e.update(a,n);if(e.hasResult()){r.push(e);continue}}var i=this.view.state.field(v).active.find(e=>e.source==t.active.source);if(i&&1==i.state)if(null==t.done){let e=new y(t.active.source,0);for(var o of t.updates)e=e.update(o,n);1!=e.state&&r.push(e)}else this.startQuery(i)}}r.length&&this.view.dispatch({effects:K.of(r)})}},{eventHandlers:{blur(e){var t=this.view.state.field(v,!1);t&&t.tooltip&&this.view.state.facet(A).closeOnBlur&&((t=t.open&&h.getTooltip(this.view,t.open.tooltip))&&t.dom.contains(e.relatedTarget)||setTimeout(()=>this.view.dispatch({effects:f.of(null)}),10))},compositionstart(){this.composing=1},compositionend(){3==this.composing&&setTimeout(()=>this.view.dispatch({effects:d.of(!1)}),20),this.composing=0}}}),te="object"==typeof navigator&&/Win/.test(navigator.platform),re=S.Prec.highest(h.EditorView.domEventHandlers({keydown(e,r){var n=r.state.field(v,!1);if(!(!n||!n.open||n.open.disabled||n.open.selected<0||1<e.key.length||e.ctrlKey&&(!te||!e.altKey)||e.metaKey)){let t=n.open.options[n.open.selected];n=n.active.find(e=>e.source==t.source),n=t.completion.commitCharacters||n.result.commitCharacters;n&&-1<n.indexOf(e.key)&&O(r,t)}return!1}})),ne=h.EditorView.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'𝑥'"}},".cm-completionIcon-constant":{"&:after":{content:"'𝐶'"}},".cm-completionIcon-type":{"&:after":{content:"'𝑡'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'🔑︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class ae{constructor(e,t,r,n){this.field=e,this.line=t,this.from=r,this.to=n}}class ie{constructor(e,t,r){this.field=e,this.from=t,this.to=r}map(e){var t=e.mapPos(this.from,-1,S.MapMode.TrackDel),e=e.mapPos(this.to,1,S.MapMode.TrackDel);return null==t||null==e?null:new ie(this.field,t,e)}}class oe{constructor(e,t){this.lines=e,this.fieldPositions=t}instantiate(n,e){let t=[],a=[e];var i,r=n.doc.lineAt(e),o=/^\s*/.exec(r.text)[0];for(i of this.lines){if(t.length){let t=o,r=/^\t*/.exec(i)[0].length;for(let e=0;e<r;e++)t+=n.facet(m.indentUnit);a.push(e+t.length-r),i=t+i.slice(r)}t.push(i),e+=i.length+1}r=this.fieldPositions.map(e=>new ie(e.field,a[e.line]+e.from,a[e.line]+e.to));return{text:t,ranges:r}}static parse(e){var n,a=[];let i=[],o=[],s;for(n of e.split(/\r\n?|\n/)){for(;s=/[#$]\{(?:(\d+)(?::([^}]*))?|((?:\\[{}]|[^}])*))\}/.exec(n);){let t=s[1]?+s[1]:null,e=s[2]||s[3]||"",r=-1;var l=e.replace(/\\[{}]/g,e=>e[1]);for(let e=0;e<a.length;e++)(null!=t?a[e].seq==t:l&&a[e].name==l)&&(r=e);if(r<0){let e=0;for(;e<a.length&&(null==t||null!=a[e].seq&&a[e].seq<t);)e++;a.splice(e,0,{seq:t,name:l}),r=e;for(var c of o)c.field>=r&&c.field++}o.push(new ae(r,i.length,s.index,s.index+l.length)),n=n.slice(0,s.index)+e+n.slice(s.index+s[0].length)}n=n.replace(/\\([{}])/g,(e,t,r)=>{for(var n of o)n.line==i.length&&n.from>r&&(n.from--,n.to--);return t}),i.push(n)}return new oe(i,o)}}let se=h.Decoration.widget({widget:new class extends h.WidgetType{toDOM(){var e=document.createElement("span");return e.className="cm-snippetFieldPosition",e}ignoreEvent(){return!1}}}),le=h.Decoration.mark({class:"cm-snippetField"});class C{constructor(e,t){this.ranges=e,this.active=t,this.deco=h.Decoration.set(e.map(e=>(e.from==e.to?se:le).range(e.from,e.to)))}map(e){var t,r=[];for(t of this.ranges){var n=t.map(e);if(!n)return null;r.push(n)}return new C(r,this.active)}selectionInsideField(e){return e.ranges.every(t=>this.ranges.some(e=>e.field==this.active&&e.from<=t.from&&e.to>=t.to))}}const k=S.StateEffect.define({map(e,t){return e&&e.map(t)}}),ce=S.StateEffect.define(),w=S.StateField.define({create(){return null},update(e,t){for(var r of t.effects){if(r.is(k))return r.value;if(r.is(ce)&&e)return new C(e.ranges,r.value)}return e=(e=e&&t.docChanged?e.map(t.changes):e)&&t.selection&&!e.selectionInsideField(t.selection)?null:e},provide:e=>h.EditorView.decorations.from(e,e=>e?e.deco:h.Decoration.none)});function R(e,t){return S.EditorSelection.create(e.filter(e=>e.field==t).map(e=>S.EditorSelection.range(e.from,e.to)))}function ue(e){let o=oe.parse(e);return(e,t,r,n)=>{var{text:a,ranges:i}=o.instantiate(e.state,r),r={changes:{from:r,to:n,insert:S.Text.of(a)},scrollIntoView:!0,annotations:t?[u.of(t),S.Transaction.userEvent.of("input.complete")]:void 0};i.length&&(r.selection=R(i,0)),i.some(e=>0<e.field)&&(n=new C(i,0),a=r.effects=[k.of(n)],void 0===e.state.field(w,!1))&&a.push(S.StateEffect.appendConfig.of([w,me,_e,ne])),e.dispatch(e.state.update(r))}}function de(i){return({state:e,dispatch:t})=>{var r=e.field(w,!1);if(!r||i<0&&0==r.active)return!1;let n=r.active+i,a=0<i&&!r.ranges.some(e=>e.field==n+i);return t(e.update({selection:R(r.ranges,n),effects:k.of(a?null:new C(r.ranges,n)),scrollIntoView:!0})),!0}}var fe=({state:e,dispatch:t})=>{return!!e.field(w,!1)&&(t(e.update({effects:k.of(null)})),!0)},pe=de(1),he=de(-1);const ge=[{key:"Tab",run:pe,shift:he},{key:"Escape",run:fe}],I=S.Facet.define({combine(e){return e.length?e[0]:ge}}),me=S.Prec.highest(h.keymap.compute([I],e=>e.facet(I)));const _e=h.EditorView.domEventHandlers({mousedown(e,t){let r=t.state.field(w,!1),n;if(!r||null==(n=t.posAtCoords({x:e.clientX,y:e.clientY})))return!1;let a=r.ranges.find(e=>e.from<=n&&e.to>=n);return!(!a||a.field==r.active||(t.dispatch({selection:R(r.ranges,a.field),effects:k.of(r.ranges.some(e=>e.field>a.field)?new C(r.ranges,a.field):null),scrollIntoView:!0}),0))}});function ye(e,t){return new RegExp(t(e.source),e.unicode?"u":"")}const Te=Object.create(null);function be(r,n,a,i,o){for(let e=r.iterLines(),t=0;!e.next().done;){var s,l=e["value"];for(n.lastIndex=0;s=n.exec(l);)if(!i[s[0]]&&t+s.index!=o&&(a.push({type:"text",label:s[0]}),i[s[0]]=!0,2e3<=a.length))return;t+=l.length+1}}const M={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},P=S.StateEffect.define({map(e,t){t=t.mapPos(e,-1,S.MapMode.TrackAfter);return null==t?void 0:t}}),N=new class extends S.RangeValue{},ve=(N.startSide=1,N.endSide=-1,S.StateField.define({create(){return S.RangeSet.empty},update(e,r){if(e=e.map(r.changes),r.selection){let t=r.state.doc.lineAt(r.selection.main.head);e=e.update({filter:e=>e>=t.from&&e<=t.to})}for(var t of r.effects)t.is(P)&&(e=e.update({add:[N.range(t.value,t.value+1)]}));return e}}));const D="()[]{}<>";function Ee(t){for(let e=0;e<D.length;e+=2)if(D.charCodeAt(e)==t)return D.charAt(e+1);return S.fromCodePoint(t<128?t:t+1)}function Se(e,t){return e.languageDataAt("closeBrackets",t)[0]||M}const Ae="object"==typeof navigator&&/Android\b/.test(navigator.userAgent),Oe=h.EditorView.inputHandler.of((e,t,r,n)=>{var a;return!((Ae?e.composing:e.compositionStarted)||e.state.readOnly||(a=e.state.selection.main,2<n.length)||2==n.length&&1==S.codePointSize(S.codePointAt(n,0))||t!=a.from||r!=a.to||!(t=we(e.state,n))||(e.dispatch(t),0))});var Ce=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let a=Se(n,n.selection.main.head).brackets||M.brackets,i=null,t=n.changeByRange(e=>{if(e.empty){var t,r=function(e,t){e=e.sliceString(t-2,t);return S.codePointSize(S.codePointAt(e,0))==e.length?e:e.slice(1)}(n.doc,e.head);for(t of a)if(t==r&&x(n.doc,e.head)==Ee(S.codePointAt(t,0)))return{changes:{from:e.head-t.length,to:e.head+t.length},range:S.EditorSelection.cursor(e.head-t.length)}}return{range:i=e}});return i||e(n.update(t,{scrollIntoView:!0,userEvent:"delete.backward"})),!i},ke=[{key:"Backspace",run:Ce}];function we(n,e){var a,t=Se(n,n.selection.main.head),r=t.brackets||M.brackets;for(a of r){var i=Ee(S.codePointAt(a,0));if(e==a)if(i==a){var s=n;var l=a;var c=-1<r.indexOf(a+a+a);var u=t;let i=u.stringPrefixes||M.stringPrefixes,o=null,e=s.changeByRange(e=>{if(!e.empty)return{changes:[{insert:l,from:e.from},{insert:l,from:e.to}],effects:P.of(e.to+l.length),range:S.EditorSelection.range(e.anchor+l.length,e.head+l.length)};let t=e.head,r=x(s.doc,t),n;if(r==l){if(Ie(s,t))return{changes:{insert:l+l,from:t},effects:P.of(t+l.length),range:S.EditorSelection.cursor(t+l.length)};var a;if(Re(s,t))return{changes:{from:t,to:t+(a=c&&s.sliceDoc(t,t+3*l.length)==l+l+l?l+l+l:l).length,insert:a},range:S.EditorSelection.cursor(t+a.length)}}else{if(c&&s.sliceDoc(t-2*l.length,t)==l+l&&-1<(n=Me(s,t-2*l.length,i))&&Ie(s,n))return{changes:{insert:l+l+l+l,from:t},effects:P.of(t+l.length),range:S.EditorSelection.cursor(t+l.length)};if(s.charCategorizer(t)(r)!=S.CharCategory.Word&&-1<Me(s,t,i)&&!function(t,r,n,a){let i=m.syntaxTree(t).resolveInner(r,-1),o=a.reduce((e,t)=>Math.max(e,t.length),0);for(let e=0;e<5;e++){var s=t.sliceDoc(i.from,Math.min(i.to,i.from+n.length+o)),l=s.indexOf(n);if(!l||-1<l&&-1<a.indexOf(s.slice(0,l))){let e=i.firstChild;for(;e&&e.from==i.from&&e.to-e.from>n.length+l;){if(t.sliceDoc(e.to-n.length,e.to)==n)return;e=e.firstChild}return 1}s=i.to==r&&i.parent;if(!s)break;i=s}return}(s,t,l,i))return{changes:{insert:l+l,from:t},effects:P.of(t+l.length),range:S.EditorSelection.cursor(t+l.length)}}return{range:o=e}});return o?null:s.update(e,{scrollIntoView:!0,userEvent:"input.type"});return}else{var o=n;var d=a;var f=i;var p=t.before||M.before;let r=null,e=o.changeByRange(e=>{var t;return e.empty?!(t=x(o.doc,e.head))||/\s/.test(t)||-1<p.indexOf(t)?{changes:{insert:d+f,from:e.head},effects:P.of(e.head+d.length),range:S.EditorSelection.cursor(e.head+d.length)}:{range:r=e}:{changes:[{insert:d,from:e.from},{insert:f,from:e.to}],effects:P.of(e.to+d.length),range:S.EditorSelection.range(e.anchor+d.length,e.head+d.length)}});return r?null:o.update(e,{scrollIntoView:!0,userEvent:"input.type"});return}if(e==i&&Re(n,n.selection.main.from)){var h=n;a;var g=i;let t=null,e=h.changeByRange(e=>e.empty&&x(h.doc,e.head)==g?{changes:{from:e.head,to:e.head+g.length,insert:g},range:S.EditorSelection.cursor(e.head+g.length)}:t={range:e});return t?null:h.update(e,{scrollIntoView:!0,userEvent:"input.type"});return}}return null}function Re(e,t){let r=!1;return e.field(ve).between(0,e.doc.length,e=>{e==t&&(r=!0)}),r}function x(e,t){e=e.sliceString(t,t+2);return e.slice(0,S.codePointSize(S.codePointAt(e,0)))}function Ie(e,t){e=m.syntaxTree(e).resolveInner(t+1);return e.parent&&e.from==t}function Me(e,t,r){var n,a=e.charCategorizer(t);if(a(e.sliceDoc(t-1,t))!=S.CharCategory.Word)return t;for(n of r){var i=t-n.length;if(e.sliceDoc(i,t)==n&&a(e.sliceDoc(i-1,i))!=S.CharCategory.Word)return i}return-1}const Pe=[{key:"Ctrl-Space",run:Z},{key:"Escape",run:Q},{key:"ArrowDown",run:e(!0)},{key:"ArrowUp",run:e(!1)},{key:"PageDown",run:e(!0,"page")},{key:"PageUp",run:e(!1,"page")},{key:"Enter",run:J}],Ne=S.Prec.highest(h.keymap.computeN([A],e=>e.facet(A).defaultKeymap?[Pe]:[]));const De=new WeakMap;return xe.CompletionContext=s,xe.acceptCompletion=J,xe.autocompletion=function(e={}){return[re,v,A.of(e),ee,Ne,ne]},xe.clearSnippet=fe,xe.closeBrackets=function(){return[Oe,ve]},xe.closeBracketsKeymap=ke,xe.closeCompletion=Q,xe.completeAnyWord=e=>{var t=e.state.languageDataAt("wordChars",e.pos).join(""),r=function(t){t=t.replace(/[\]\-\\]/g,"\\$&");try{return new RegExp(`[\\p{Alphabetic}\\p{Number}_${t}]+`,"ug")}catch(e){return new RegExp(`[w${t}]`,"g")}}(t),n=e.matchBefore(ye(r,e=>e+"$"));return n||e.explicit?{from:n=n?n.from:e.pos,options:function t(r,n,a,i,o){var e=1e3<=r.length,s=e&&n.get(r);if(s)return s;var l=[],c=Object.create(null);if(r.children){let e=0;for(var u of r.children){if(1e3<=u.length)for(var d of t(u,n,a,i-e,o-e))c[d.label]||(c[d.label]=!0,l.push(d));else be(u,a,l,c,o-e);e+=u.length+1}}else be(r,a,l,c,o);return e&&l.length<2e3&&n.set(r,l),l}(e.state.doc,(e=t,Te[e]||(Te[e]=new WeakMap)),r,5e4,n),validFor:ye(r,e=>"^"+e)}:null},xe.completeFromList=n,xe.completionKeymap=Pe,xe.completionStatus=function(e){return(e=e.field(v,!1))&&e.active.some(e=>1==e.state)?"pending":e&&e.active.some(e=>0!=e.state)?"active":null},xe.currentCompletions=function(e){if(!(e=null==(e=e.field(v,!1))?void 0:e.open)||e.disabled)return[];let t=De.get(e.options);return t||De.set(e.options,t=e.options.map(e=>e.completion)),t},xe.deleteBracketPair=Ce,xe.hasNextSnippetField=function(e){let t=e.field(w,!1);return!(!t||!t.ranges.some(e=>e.field==t.active+1))},xe.hasPrevSnippetField=function(e){return!!((e=e.field(w,!1))&&0<e.active)},xe.ifIn=function(r,n){return t=>{for(let e=m.syntaxTree(t.state).resolveInner(t.pos,-1);e;e=e.parent){if(-1<r.indexOf(e.name))return n(t);if(e.type.isTop)break}return null}},xe.ifNotIn=function(r,e){return t=>{for(let e=m.syntaxTree(t.state).resolveInner(t.pos,-1);e;e=e.parent){if(-1<r.indexOf(e.name))return null;if(e.type.isTop)break}return e(t)}},xe.insertBracket=we,xe.insertCompletionText=a,xe.moveCompletionSelection=e,xe.nextSnippetField=pe,xe.pickedCompletion=u,xe.prevSnippetField=he,xe.selectedCompletion=function(e){return(e=null==(e=e.field(v,!1))?void 0:e.open)&&!e.disabled&&0<=e.selected?e.options[e.selected].completion:null},xe.selectedCompletionIndex=function(e){return(e=null==(e=e.field(v,!1))?void 0:e.open)&&!e.disabled&&0<=e.selected?e.selected:null},xe.setSelectedCompletion=function(e){return b.of(e)},xe.snippet=ue,xe.snippetCompletion=function(e,t){return Object.assign(Object.assign({},t),{apply:ue(e)})},xe.snippetKeymap=I,xe.startCompletion=Z,xe}var oO,sO,lO,cO={};function uO(){if(oO)return cO;oO=1;var a=B1(),s=I1(),u=rO();class i{constructor(e,t,r){this.from=e,this.to=t,this.diagnostic=r}}class o{constructor(e,t,r){this.diagnostics=e,this.panel=t,this.selected=r}static init(e,t,r){let n=e;e=r.facet(b).markerFilter,e&&(n=e(n,r)),e=a.Decoration.set(n.map(e=>e.from==e.to||e.from==e.to-1&&r.doc.lineAt(e.from).to==e.from?a.Decoration.widget({widget:new S(e),diagnostic:e}).range(e.from):a.Decoration.mark({attributes:{class:"cm-lintRange cm-lintRange-"+e.severity+(e.markClass?" "+e.markClass:"")},diagnostic:e}).range(e.from,e.to)),!0);return new o(e,t,d(e))}}function d(e,n=null,t=0){let a=null;return e.between(t,1e9,(e,t,{spec:r})=>{if(!n||r.diagnostic==n)return a=new i(e,t,r.diagnostic),!1}),a}function r(e,t){var r=t.pos,n=t.end||r,r=e.state.facet(b).hideOn(e,r,n);return null!=r?r:(r=e.startState.doc.lineAt(t.pos),!(!e.effects.some(e=>e.is(c))&&!e.changes.touchesRange(r.from,Math.max(r.to,n))))}function n(e,t){return e.field(h,!1)?t:t.concat(s.StateEffect.appendConfig.of(D))}function l(e,t){return{effects:n(e,[c.of(t)])}}const c=s.StateEffect.define(),f=s.StateEffect.define(),p=s.StateEffect.define(),h=s.StateField.define({create(){return new o(a.Decoration.none,null,null)},update(n,a){if(a.docChanged&&n.diagnostics.size){let e=n.diagnostics.map(a.changes),t=null,r=n.panel;var i;n.selected&&(i=a.changes.mapPos(n.selected.from,1),t=d(e,n.selected.diagnostic,i)||d(e,null,i)),!e.size&&r&&a.state.facet(b).autoPanel&&(r=null),n=new o(e,r,t)}for(var e of a.effects){var t;e.is(c)?(t=a.state.facet(b).autoPanel?e.value.length?O.open:null:n.panel,n=o.init(e.value,t,a.state)):e.is(f)?n=new o(n.diagnostics,e.value?O.open:null,n.selected):e.is(p)&&(n=new o(n.diagnostics,n.panel,e.value))}return n},provide:e=>[a.showPanel.from(e,e=>e.panel),a.EditorView.decorations.from(e,e=>e.diagnostics)]});const g=a.Decoration.mark({class:"cm-lintRange cm-lintRange-active"});function m(t,e){return u("ul",{class:"cm-tooltip-lint"},e.map(e=>E(t,e,!1)))}var e=e=>{var t=e.state.field(h,!1),t=(t&&t.panel||e.dispatch({effects:n(e.state,[f.of(!0)])}),a.getPanel(e,O.open));return t&&t.dom.querySelector(".cm-panel-lint ul").focus(),!0};const _=e=>{var t=e.state.field(h,!1);return!(!t||!t.panel||(e.dispatch({effects:f.of(!1)}),0))};var t=e=>{var t=e.state.field(h,!1);if(!t)return!1;let r=e.state.selection.main,n=t.diagnostics.iter(r.to+1);return!(!n.value&&(!(n=t.diagnostics.iter(0)).value||n.from==r.from&&n.to==r.to)||(e.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0}),0))},y=[{key:"Mod-Shift-m",run:e,preventDefault:!0},{key:"F8",run:t}];const T=a.ViewPlugin.fromClass(class{constructor(e){this.view=e,this.timeout=-1,this.set=!0;e=e.state.facet(b).delay;this.lintTime=Date.now()+e,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,e)}run(){clearTimeout(this.timeout);var e=Date.now();if(e<this.lintTime-10)this.timeout=setTimeout(this.run,this.lintTime-e);else{this.set=!1;let t=this.view["state"],e=t.facet(b)["sources"];e.length&&Promise.all(e.map(e=>Promise.resolve(e(this.view)))).then(e=>{e=e.reduce((e,t)=>e.concat(t));this.view.state.doc==t.doc&&this.view.dispatch(l(this.view.state,e))},e=>{a.logException(this.view.state,e)})}}update(e){var t=e.state.facet(b);(e.docChanged||t!=e.startState.facet(b)||t.needsRefresh&&t.needsRefresh(e))&&(this.lintTime=Date.now()+t.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,t.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}}),b=s.Facet.define({combine(e){return Object.assign({sources:e.map(e=>e.source).filter(e=>null!=e)},s.combineConfig(e.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(t,r)=>t?r?e=>t(e)||r(e):t:r}))}});function v(e){var r=[];if(e)e:for(var{name:n}of e){for(let e=0;e<n.length;e++){let t=n[e];if(/[a-zA-Z]/.test(t)&&!r.some(e=>e.toLowerCase()==t.toLowerCase())){r.push(t);continue e}}r.push("")}return r}function E(s,l,e){let c=e?v(l.actions):[];return u("li",{class:"cm-diagnostic cm-diagnostic-"+l.severity},u("span",{class:"cm-diagnosticText"},l.renderMessage?l.renderMessage(s):l.message),null==(e=l.actions)?void 0:e.map((t,e)=>{let r=!1,n=e=>{e.preventDefault(),!r&&(r=!0,e=d(s.state.field(h).diagnostics,l))&&t.apply(s,e.from,e.to)};var a=t["name"],i=c[e]?a.indexOf(c[e]):-1,o=i<0?a:[a.slice(0,i),u("u",a.slice(i,i+1)),a.slice(i+1)];return u("button",{type:"button",class:"cm-diagnosticAction",onclick:n,onmousedown:n,"aria-label":` Action: ${a}${i<0?"":` (access key "${c[e]})"`}.`},o)}),l.source&&u("div",{class:"cm-diagnosticSource"},l.source))}class S extends a.WidgetType{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return u("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class A{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(4294967295*Math.random()).toString(16),this.dom=E(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class O{constructor(i){this.view=i,this.items=[];this.list=u("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t=>{if(27==t.keyCode)_(this.view),this.view.focus();else if(38==t.keyCode||33==t.keyCode)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(40==t.keyCode||34==t.keyCode)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(36==t.keyCode)this.moveSelection(0);else if(35==t.keyCode)this.moveSelection(this.items.length-1);else if(13==t.keyCode)this.view.focus();else{if(!(65<=t.keyCode&&t.keyCode<=90&&0<=this.selectedIndex))return;var r,n=this.items[this.selectedIndex]["diagnostic"],a=v(n.actions);for(let e=0;e<a.length;e++)a[e].toUpperCase().charCodeAt(0)==t.keyCode&&(r=d(this.view.state.field(h).diagnostics,n))&&n.actions[e].apply(i,r.from,r.to)}t.preventDefault()},onclick:t=>{for(let e=0;e<this.items.length;e++)this.items[e].dom.contains(t.target)&&this.moveSelection(e)}}),this.dom=u("div",{class:"cm-panel-lint"},this.list,u("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>_(this.view)},"×")),this.update()}get selectedIndex(){var t=this.view.state.field(h).selected;if(t)for(let e=0;e<this.items.length;e++)if(this.items[e].diagnostic==t.diagnostic)return e;return-1}update(){let{diagnostics:e,selected:i}=this.view.state.field(h),o=0,s=!1,l=null;for(e.between(0,this.view.state.doc.length,(e,t,{spec:r})=>{let n=-1,a;for(let e=o;e<this.items.length;e++)if(this.items[e].diagnostic==r.diagnostic){n=e;break}n<0?(a=new A(this.view,r.diagnostic),this.items.splice(o,0,a),s=!0):(a=this.items[n],n>o&&(this.items.splice(o,n-o),s=!0)),i&&a.diagnostic==i.diagnostic?a.dom.hasAttribute("aria-selected")||(a.dom.setAttribute("aria-selected","true"),l=a):a.dom.hasAttribute("aria-selected")&&a.dom.removeAttribute("aria-selected"),o++});o<this.items.length&&!(1==this.items.length&&this.items[0].diagnostic.from<0);)s=!0,this.items.pop();0==this.items.length&&(this.items.push(new A(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),s=!0),l?(this.list.setAttribute("aria-activedescendant",l.id),this.view.requestMeasure({key:this,read:()=>({sel:l.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:e,panel:t})=>{var r=t.height/this.list.offsetHeight;e.top<t.top?this.list.scrollTop-=(t.top-e.top)/r:e.bottom>t.bottom&&(this.list.scrollTop+=(e.bottom-t.bottom)/r)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),s&&this.sync()}sync(){let t=this.list.firstChild;function e(){var e=t;t=e.nextSibling,e.remove()}for(var r of this.items)if(r.dom.parentNode==this.list){for(;t!=r.dom;)e();t=r.dom.nextSibling}else this.list.insertBefore(r.dom,t);for(;t;)e()}moveSelection(e){this.selectedIndex<0||(e=d(this.view.state.field(h).diagnostics,this.items[e].diagnostic))&&this.view.dispatch({selection:{anchor:e.from,head:e.to},scrollIntoView:!0,effects:p.of(e)})}static open(e){return new O(e)}}function C(e,t='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${t}>${encodeURIComponent(e)}</svg>')`}function k(e){return C(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${e}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}var w=a.EditorView.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:k("#d11")},".cm-lintRange-warning":{backgroundImage:k("orange")},".cm-lintRange-info":{backgroundImage:k("#999")},".cm-lintRange-hint":{backgroundImage:k("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function R(e){return"error"==e?4:"warning"==e?3:"info"==e?2:1}class I extends a.GutterMarker{constructor(e){super(),this.diagnostics=e,this.severity=e.reduce((e,t)=>R(e)<R(t.severity)?t.severity:e,"hint")}toDOM(a){let s=document.createElement("div"),l=(s.className="cm-lint-marker cm-lint-marker-"+this.severity,this.diagnostics);var e=a.state.facet(x).tooltipFilter;return(l=e?e(l,a.state):l).length&&(s.onmouseover=()=>{{var i=a,o=s,r=l;function n(){var e=i.elementAtHeight(o.getBoundingClientRect().top+5-i.documentTop);i.coordsAtPos(e.from)&&i.dispatch({effects:P.of({pos:e.from,above:!1,create(){return{dom:m(i,r),getCoords:()=>o.getBoundingClientRect()}}})}),o.onmouseout=o.onmousemove=null;{var n=i,a=o;let r=t=>{var e=a.getBoundingClientRect();if(!(t.clientX>e.left-10&&t.clientX<e.right+10&&t.clientY>e.top-10&&t.clientY<e.bottom+10)){for(let e=t.target;e;e=e.parentNode)if(1==e.nodeType&&e.classList.contains("cm-tooltip-lint"))return;window.removeEventListener("mousemove",r),n.state.field(N)&&n.dispatch({effects:P.of(null)})}};window.addEventListener("mousemove",r)}}let e=i.state.facet(x)["hoverTime"],t=setTimeout(n,e);o.onmouseout=()=>{clearTimeout(t),o.onmouseout=o.onmousemove=null},o.onmousemove=()=>{clearTimeout(t),t=setTimeout(n,e)}}}),s}}const L=a.gutter({class:"cm-gutter-lint",markers:e=>e.state.field(M)}),M=s.StateField.define({create(){return s.RangeSet.empty},update(t,r){t=t.map(r.changes);var n,a=r.state.facet(x).markerFilter;for(n of r.effects)if(n.is(c)){let e=n.value;a&&(e=a(e||[],r.state)),t=function(e,t){var r,n=Object.create(null);for(r of t){var a=e.lineAt(r.from);(n[a.from]||(n[a.from]=[])).push(r)}var i,o=[];for(i in n)o.push(new I(n[i]).range(+i));return s.RangeSet.of(o,!0)}(r.state.doc,e.slice(0))}return t}}),P=s.StateEffect.define(),N=s.StateField.define({create(){return null},update(e,t){return e&&t.docChanged&&(e=r(t,e)?null:Object.assign(Object.assign({},e),{pos:t.changes.mapPos(e.pos)})),t.effects.reduce((e,t)=>t.is(P)?t.value:e,e)},provide:e=>a.showTooltip.from(e)}),F=a.EditorView.baseTheme({".cm-gutter-lint":{width:"1.4em","& .cm-gutterElement":{padding:".2em"}},".cm-lint-marker":{width:"1em",height:"1em"},".cm-lint-marker-info":{content:C('<path fill="#aaf" stroke="#77e" stroke-width="6" stroke-linejoin="round" d="M5 5L35 5L35 35L5 35Z"/>')},".cm-lint-marker-warning":{content:C('<path fill="#fe8" stroke="#fd7" stroke-width="6" stroke-linejoin="round" d="M20 6L37 35L3 35Z"/>')},".cm-lint-marker-error":{content:C('<circle cx="20" cy="20" r="15" fill="#f87" stroke="#f43" stroke-width="6"/>')}}),D=[h,a.EditorView.decorations.compute([h],e=>{var{selected:e,panel:t}=e.field(h);return e&&t&&e.from!=e.to?a.Decoration.set([g.range(e.from,e.to)]):a.Decoration.none}),a.hoverTooltip(function(e,n,a){var t=e.state.field(h)["diagnostics"];let i=[],o=2e8,s=0;return t.between(n-(a<0?1:0),n+(0<a?1:0),(e,t,{spec:r})=>{e<=n&&n<=t&&(e==t||(e<n||0<a)&&(n<t||a<0))&&(i.push(r.diagnostic),o=Math.min(e,o),s=Math.max(t,s))}),t=e.state.facet(b).tooltipFilter,(i=t?t(i,e.state):i).length?{pos:o,end:s,above:e.state.doc.lineAt(o).to<s,create(){return{dom:m(e,i)}}}:null},{hideOn:r}),w],x=s.Facet.define({combine(e){return s.combineConfig(e,{hoverTime:300,markerFilter:null,tooltipFilter:null})}});return cO.closeLintPanel=_,cO.diagnosticCount=function(e){return(e=e.field(h,!1))?e.diagnostics.size:0},cO.forEachDiagnostic=function(e,t){if((e=e.field(h,!1))&&e.diagnostics.size)for(var r=s.RangeSet.iter([e.diagnostics]);r.value;r.next())t(r.value.spec.diagnostic,r.from,r.to)},cO.forceLinting=function(e){(e=e.plugin(T))&&e.force()},cO.lintGutter=function(e={}){return[x.of(e),M,L,F,N]},cO.lintKeymap=y,cO.linter=function(e,t={}){return[b.of({source:e,config:t}),T,D]},cO.nextDiagnostic=t,cO.openLintPanel=e,cO.previousDiagnostic=e=>{var t=e["state"],r=t.field(h,!1);if(!r)return!1;let n=t.selection.main,a,i,o,s;return r.diagnostics.between(0,t.doc.length,(e,t)=>{t<n.to&&(null==a||a<e)&&(a=e,i=t),(null==o||e>o)&&(o=e,s=t)}),null!=o&&(null!=a||o!=n.from)&&(e.dispatch({selection:{anchor:null!==a&&void 0!==a?a:o,head:null!==i&&void 0!==i?i:s},scrollIntoView:!0}),!0)},cO.setDiagnostics=l,cO.setDiagnosticsEffect=c,cO}function dO(){if(!lO){lO=1,Object.defineProperty(w1,"__esModule",{value:!0}),w1.Editor=void 0;var e,t,r,n,a,i,o,s,l,c,u,d,f,p=or;const h=Y1(),g=(J1||(J1=1,Object.defineProperty(Z1,"__esModule",{value:!0}),r=B1(),e=K1(),f=z1(),t={chalky:"#e5c07b",coral:u="#e06c75",cyan:"#56b6c2",invalid:"#ffffff",ivory:l="#abb2bf",stone:c="#7d8799",malibu:"#61afef",sage:"#98c379",whiskey:d="#d19a66",violet:"#c678dd",darkBackground:"#21252b",highlightBackground:s="#2c313a",background:a="#282c34",tooltipBackground:i="#353a42",selection:"#3E4451",cursor:n="#528bff"},r=r.EditorView.theme({"&":{color:l,backgroundColor:a},".cm-content":{caretColor:n},".cm-cursor, .cm-dropCursor":{borderLeftColor:n},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:"#3E4451"},".cm-panels":{backgroundColor:"#21252b",color:l},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:a,color:c,border:"none"},".cm-activeLineGutter":{backgroundColor:s},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:i},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:i,borderBottomColor:i},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:s,color:l}}},{dark:!0}),n=e.HighlightStyle.define([{tag:f.tags.keyword,color:"#c678dd"},{tag:[f.tags.name,f.tags.deleted,f.tags.character,f.tags.propertyName,f.tags.macroName],color:u},{tag:[f.tags.function(f.tags.variableName),f.tags.labelName],color:"#61afef"},{tag:[f.tags.color,f.tags.constant(f.tags.name),f.tags.standard(f.tags.name)],color:d},{tag:[f.tags.definition(f.tags.name),f.tags.separator],color:l},{tag:[f.tags.typeName,f.tags.className,f.tags.number,f.tags.changed,f.tags.annotation,f.tags.modifier,f.tags.self,f.tags.namespace],color:"#e5c07b"},{tag:[f.tags.operator,f.tags.operatorKeyword,f.tags.url,f.tags.escape,f.tags.regexp,f.tags.link,f.tags.special(f.tags.string)],color:"#56b6c2"},{tag:[f.tags.meta,f.tags.comment],color:c},{tag:f.tags.strong,fontWeight:"bold"},{tag:f.tags.emphasis,fontStyle:"italic"},{tag:f.tags.strikethrough,textDecoration:"line-through"},{tag:f.tags.link,color:c,textDecoration:"underline"},{tag:f.tags.heading,fontWeight:"bold",color:u},{tag:[f.tags.atom,f.tags.bool,f.tags.special(f.tags.variableName)],color:d},{tag:[f.tags.processingInstruction,f.tags.string,f.tags.inserted],color:"#98c379"},{tag:f.tags.invalid,color:"#ffffff"}]),a=[r,e.syntaxHighlighting(n)],Z1.color=t,Z1.oneDark=a,Z1.oneDarkHighlightStyle=n,Z1.oneDarkTheme=r),Z1),m=B1(),_=(sO||(sO=1,i=tO,Object.defineProperty(i,"__esModule",{value:!0}),o=B1(),s=I1(),l=K1(),c=Y1(),u=nO(),d=iO(),f=uO(),s=[o.lineNumbers(),o.highlightActiveLineGutter(),o.highlightSpecialChars(),c.history(),l.foldGutter(),o.drawSelection(),o.dropCursor(),s.EditorState.allowMultipleSelections.of(!0),l.indentOnInput(),l.syntaxHighlighting(l.defaultHighlightStyle,{fallback:!0}),l.bracketMatching(),d.closeBrackets(),d.autocompletion(),o.rectangularSelection(),o.crosshairCursor(),o.highlightActiveLine(),u.highlightSelectionMatches(),o.keymap.of([...d.closeBracketsKeymap,...c.defaultKeymap,...u.searchKeymap,...c.historyKeymap,...l.foldKeymap,...d.completionKeymap,...f.lintKeymap])],u=[o.highlightSpecialChars(),c.history(),o.drawSelection(),l.syntaxHighlighting(l.defaultHighlightStyle,{fallback:!0}),o.keymap.of([...c.defaultKeymap,...c.historyKeymap])],Object.defineProperty(i,"EditorView",{enumerable:!0,get:function(){return o.EditorView}}),i.basicSetup=s,i.minimalSetup=u),tO),y=p.__importDefault(ae());w1.Editor=class{editorView;generation;oncreate({dom:e,attrs:t}){var r=[h.indentWithTab];const a=t.onExecute,n=t.onUpdate;a&&r.push({key:"Mod-Enter",run:e=>{var e=e.state,t=e.selection;let r=e.doc.toString();if(!t.main.empty){let e="";for(const n of t.ranges)e+=r.slice(n.from,n.to);r=e}return a(r),!0}});let i;n&&(i=(e,t)=>{t.update([e]);e=t.state.doc.toString();n(e)}),this.generation=t.generation,this.editorView=new _.EditorView({doc:t.initialText??"",extensions:[m.keymap.of(r),g.oneDarkTheme,_.basicSetup],parent:e,dispatch:i})}onupdate({attrs:e}){var t,{initialText:e,generation:r}=e,n=this.editorView;n&&this.generation!==r&&(t=n.state,n.dispatch(t.update({changes:{from:0,to:t.doc.length,insert:e}})),this.generation=r)}onremove(){this.editorView&&(this.editorView.destroy(),this.editorView=void 0)}view({}){return(0,y.default)(".pf-editor")}}}return w1}var fO,pO,hO={};function gO(){if(!pO){pO=1,Object.defineProperty(k1,"__esModule",{value:!0}),k1.QueryPage=void 0;const r=or.__importDefault(ae()),n=Dd(),a=J(),i=Jf(),o=ie(),s=ep(),l=dO(),c=oe();var e=c1();const u=function(){if(!fO){fO=1;{var o=hO;Object.defineProperty(o,"__esModule",{value:!0}),o.queryHistoryStorage=o.HistoryItemComponent=o.QueryHistoryComponent=void 0;const s=or.__importDefault(ae()),r=X(),i=ee(),n=al(),a=ie();var e=ra();const l="queryHistory";o.QueryHistoryComponent=class{view({attrs:e}){var t=e.runQuery,r=e.setQuery,n=[],a=[];for(let e=o.queryHistoryStorage.data.length-1;0<=e;e--){var i=o.queryHistoryStorage.data[e];(i.starred?a:n).push({index:e,entry:i,runQuery:t,setQuery:r})}return(0,s.default)(".query-history",(0,s.default)("header.overview",`Query history (${o.queryHistoryStorage.data.length} queries)`),a.map(e=>(0,s.default)(c,e)),n.map(e=>(0,s.default)(c,e)))}};class c{view(e){const t=e.attrs.entry.query;return(0,s.default)(".history-item",(0,s.default)(".history-item-buttons",(0,s.default)("button",{onclick:()=>{o.queryHistoryStorage.setStarred(e.attrs.index,!e.attrs.entry.starred),a.raf.scheduleFullRedraw()}},(0,s.default)(n.Icon,{icon:r.Icons.Star,filled:e.attrs.entry.starred})),(0,s.default)("button",{onclick:()=>e.attrs.setQuery(t)},(0,s.default)(n.Icon,{icon:"edit"})),(0,s.default)("button",{onclick:()=>e.attrs.runQuery(t)},(0,s.default)(n.Icon,{icon:"play_arrow"})),(0,s.default)("button",{onclick:()=>{o.queryHistoryStorage.remove(e.attrs.index),a.raf.scheduleFullRedraw()}},(0,s.default)(n.Icon,{icon:"delete"}))),(0,s.default)("pre",{onclick:()=>e.attrs.setQuery(t),ondblclick:()=>e.attrs.runQuery(t)},t))}}o.HistoryItemComponent=c;var t=e.z.object({query:e.z.string(),starred:e.z.boolean().default(!1)});const u=e.z.array(t);o.queryHistoryStorage=new class{data;maxItems=50;constructor(){this.data=this.load()}saveQuery(t){var r=this.data;let n=-1,a=0;for(let e=0;e<r.length;e++)if(r[e].starred||(a++,-1===n&&(n=e)),r[e].query===t)return;a>=this.maxItems&&((0,i.assertTrue)(-1!==n),r.splice(n,1)),r.push({query:t,starred:!1}),this.save()}setStarred(e,t){(0,i.assertTrue)(0<=e&&e<this.data.length),this.data[e].starred=t,this.save()}remove(e){(0,i.assertTrue)(0<=e&&e<this.data.length),this.data.splice(e,1),this.save()}load(){var e=window.localStorage.getItem(l);return null!==e&&(e=u.safeParse(JSON.parse(e))).success?e.data:[]}save(){window.localStorage.setItem(l,JSON.stringify(this.data))}}}}return hO}(),d=up(),f=cp(),p={enteredText:"",heightPx:"100px",generation:0};class h{resize;oncreate({dom:e}){this.resize=new n.SimpleResizeObserver(e,()=>{p.heightPx=e.style.height}),e.style.height=p.heightPx}onremove(){this.resize&&(this.resize[Symbol.dispose](),this.resize=void 0)}view(){return(0,r.default)(l.Editor,{generation:p.generation,initialText:p.enteredText,onExecute:e=>{e&&(u.queryHistoryStorage.saveQuery(e),t(e))},onUpdate:e=>{p.enteredText=e}})}}function t(t){p.executedQuery=t,p.queryResult=void 0;var e=function(){var e=c.globals.getCurrentEngine()?.id;if(void 0===e)return;e=c.globals.engines.get(e)?.getProxy("QueryPage");return e}();e&&(0,i.runQuery)((0,a.undoCommonChatAppReplacements)(t),e).then(e=>{(0,d.addQueryResultsTab)({query:t,title:"Standalone Query",prefetchedResponse:e},"analyze_page_query"),p.executedQuery===t&&(p.queryResult=e,o.raf.scheduleFullRedraw())}),o.raf.scheduleDelayedFullRedraw()}k1.QueryPage=(0,e.createPage)({view(){return(0,r.default)(".query-page",(0,r.default)(s.Callout,"Enter query and press Cmd/Ctrl + Enter"),(0,r.default)(h),void 0===p.executedQuery?null:(0,r.default)(f.QueryTable,{query:p.executedQuery,resp:p.queryResult,fillParent:!1}),(0,r.default)(u.QueryHistoryComponent,{runQuery:t,setQuery:e=>{p.enteredText=e,p.generation++,o.raf.scheduleFullRedraw()}}))}})}return k1}var mO,_O={},yO={};function TO(){if(!mO){mO=1,Object.defineProperty(yO,"__esModule",{value:!0}),yO.CategoriesCheckboxList=yO.CodeSnippet=yO.Textarea=yO.Dropdown=yO.Slider=yO.Toggle=yO.Probe=void 0,yO.CompactProbe=function(e){return(0,u.default)(n,{title:e.title,img:null,compact:!0,descr:"",isEnabled:e.isEnabled,setEnabled:e.setEnabled})};var e=or;const i=_e(),u=e.__importDefault(ae()),t=Ws(),o=ee(),s=ne(),d=oe();class r{view({attrs:e}){return(0,u.default)("a.inline-chip",{href:e.href,title:"Open docs in new tab",target:"_blank"},(0,u.default)("i.material-icons","info")," Docs")}}class n{view({attrs:r,children:e}){const t=t=>{var e=(0,i.produce)(d.globals.state.recordConfig,e=>{r.setEnabled(e,t)});d.globals.dispatch(s.Actions.setRecordConfig({config:e}))},n=r.isEnabled(d.globals.state.recordConfig);return(0,u.default)(".probe"+(r.compact?".compact":"")+(n?".enabled":""),r.img&&(0,u.default)("img",{src:d.globals.root+"assets/"+r.img,onclick:()=>t(!n)}),(0,u.default)("label",(0,u.default)("input[type=checkbox]",{checked:n,oninput:e=>{t(e.target.checked)}}),(0,u.default)("span",r.title)),r.compact?"":(0,u.default)("div"+(r.img?"":".extended-desc"),(0,u.default)("div",r.descr),(0,u.default)(".probe-config",e)))}}yO.Probe=n;yO.Toggle=class{view({attrs:r}){var e=r.isEnabled(d.globals.state.recordConfig);return(0,u.default)(".toggle"+(e?".enabled":"")+(r.cssClass??""),(0,u.default)("label",(0,u.default)("input[type=checkbox]",{checked:e,oninput:e=>{var t;t=e.target.checked,e=(0,i.produce)(d.globals.state.recordConfig,e=>{r.setEnabled(e,t)}),d.globals.dispatch(s.Actions.setRecordConfig({config:e}))}}),(0,u.default)("span",r.title)),(0,u.default)(".descr",r.descr))}};yO.Slider=class{onValueChange(t,r){var e=(0,i.produce)(d.globals.state.recordConfig,e=>{t.set(e,r)});d.globals.dispatch(s.Actions.setRecordConfig({config:e}))}onTimeValueChange(e,t){try{var r=new Date(`1970-01-01T${t}.000Z`);isNaN(r.getTime())||this.onValueChange(e,r.getTime())}catch{}}onSliderChange(e,t){this.onValueChange(e,e.values[t])}view({attrs:t}){var e=t.title.replace(/[^a-z0-9]/gim,"_").toLowerCase(),r=t.values.length-1,n=t.get(d.globals.state.recordConfig);let a=t.min||1;t.zeroIsDefault&&(a=Math.min(0,a));var i,o=t.description,s=t.disabled;let l=0;for(;l<t.values.length&&t.values[l]<n;l++);let c={};return c=t.isTime?{type:"text",pattern:"(0[0-9]|1[0-9]|2[0-3])(:[0-5][0-9]){2}",value:new Date(n).toISOString().substr(11,8),oninput:e=>{this.onTimeValueChange(t,e.target.value)}}:{type:"number",value:(i=t.zeroIsDefault&&0===n)?"":n,placeholder:i?"(default)":"",oninput:e=>{this.onValueChange(t,+e.target.value)}},(0,u.default)(".slider"+(t.cssClass??""),(0,u.default)("header",t.title),o?(0,u.default)("header.descr",t.description):"",void 0!==t.icon?(0,u.default)("i.material-icons",t.icon):[],(0,u.default)(`input[id="${e}"][type=range][min=0][max=${r}][value=${l}]`,{disabled:s,oninput:e=>{this.onSliderChange(t,+e.target.value)}}),(0,u.default)(`input.spinner[min=${a}][for=${e}]`,c),(0,u.default)(".unit",t.unit))}};yO.Dropdown=class{resetScroll(e){setTimeout(()=>{e!==document.activeElement&&(e.scrollTop=0)},0)}onChange(t,e){var r=e.target;const n=[];for(let e=0;e<r.selectedOptions.length;e++){var a=(0,o.assertExists)(r.selectedOptions.item(e));n.push(a.value)}e=(0,i.produce)(d.globals.state.recordConfig,e=>{t.set(e,n)});d.globals.dispatch(s.Actions.setRecordConfig({config:e}))}view({attrs:t}){var e=[],r=t.get(d.globals.state.recordConfig);let n=0;var a=[...t.options.entries()];const i=void 0===t.sort?c:t.sort;a.sort((e,t)=>i(e[1],t[1]));for(const[l,s]of a){var o={value:l,selected:!1};r.includes(l)&&(o.selected=!0,n++),e.push((0,u.default)("option",o,s))}const s=t.title+" "+(n?`(${n})`:"");return(0,u.default)(`select.dropdown${t.cssClass??""}[multiple=multiple]`,{onblur:e=>this.resetScroll(e.target),onmouseleave:e=>this.resetScroll(e.target),oninput:e=>this.onChange(t,e),oncreate:e=>this.resetScroll(e.dom)},(0,u.default)("optgroup",{label:s},e))}};yO.Textarea=class{onChange(t,r){var e=(0,i.produce)(d.globals.state.recordConfig,e=>{t.set(e,r.value)});d.globals.dispatch(s.Actions.setRecordConfig({config:e}))}view({attrs:t}){return(0,u.default)(".textarea-holder",(0,u.default)("header",t.title,t.docsLink&&[" ",(0,u.default)(r,{href:t.docsLink})]),(0,u.default)("textarea.extra-input"+(t.cssClass??""),{onchange:e=>this.onChange(t,e.target),placeholder:t.placeholder,value:t.get(d.globals.state.recordConfig)}))}};yO.CodeSnippet=class{view({attrs:e}){return(0,u.default)(".code-snippet",(0,u.default)("button",{title:"Copy to clipboard",onclick:()=>(0,t.copyToClipboard)(e.text)},(0,u.default)("i.material-icons","assignment")),(0,u.default)("code",e.text))}};function c(e,t){return e.localeCompare(t)}yO.CategoriesCheckboxList=class{updateValue(r,n,a){var e=(0,i.produce)(d.globals.state.recordConfig,e=>{var e=r.get(e),t=e.indexOf(n);a&&-1===t&&e.push(n),a||-1===t||e.splice(t,1)});d.globals.dispatch(s.Actions.setRecordConfig({config:e}))}view({attrs:n}){const a=new Set(n.get(d.globals.state.recordConfig));return(0,u.default)(".categories-list",(0,u.default)("h3",n.title,(0,u.default)("button.config-button",{onclick:()=>{var e=(0,i.produce)(d.globals.state.recordConfig,e=>{n.set(e,Array.from(n.categories.keys()))});d.globals.dispatch(s.Actions.setRecordConfig({config:e}))}},"All"),(0,u.default)("button.config-button",{onclick:()=>{var e=(0,i.produce)(d.globals.state.recordConfig,e=>{n.set(e,[])});d.globals.dispatch(s.Actions.setRecordConfig({config:e}))}},"None")),(0,u.default)("ul.checkboxes",Array.from(n.categories.entries()).map(([t,e])=>{var r="category-checkbox-"+t;return(0,u.default)("label",{for:r},(0,u.default)("li",(0,u.default)("input[type=checkbox]",{id:r,checked:a.has(t),onclick:e=>{e=e.target;this.updateValue(n,t,e.checked)}}),e))})))}}}return yO}var bO,vO={};function EO(){if(!bO){bO=1,Object.defineProperty(vO,"__esModule",{value:!0}),vO.AdvancedSettings=void 0;const t=or.__importDefault(ae()),r=TO(),n=new Map;n.set("binder/*","binder"),n.set("block/*","block"),n.set("clk/*","clk"),n.set("ext4/*","ext4"),n.set("f2fs/*","f2fs"),n.set("i2c/*","i2c"),n.set("irq/*","irq"),n.set("kmem/*","kmem"),n.set("memory_bus/*","memory_bus"),n.set("mmc/*","mmc"),n.set("oom/*","oom"),n.set("power/*","power"),n.set("regulator/*","regulator"),n.set("sched/*","sched"),n.set("sync/*","sync"),n.set("task/*","task"),n.set("task/*","task"),n.set("vmscan/*","vmscan"),n.set("fastrpc/*","fastrpc");vO.AdvancedSettings=class{view({attrs:e}){return(0,t.default)(".record-section"+e.cssClass,(0,t.default)(r.Probe,{title:"Advanced ftrace config",img:"rec_ftrace.png",descr:`Enable individual events and tune the kernel-tracing (ftrace)
                  module. The events enabled here are in addition to those from
                  enabled by other probes.`,setEnabled:(e,t)=>e.ftrace=t,isEnabled:e=>e.ftrace},(0,t.default)(r.Toggle,{title:"Resolve kernel symbols",cssClass:".thin",descr:`Enables lookup via /proc/kallsyms for workqueue,
              sched_blocked_reason and other events
              (userdebug/eng builds only).`,setEnabled:(e,t)=>e.symbolizeKsyms=t,isEnabled:e=>e.symbolizeKsyms}),(0,t.default)(r.Slider,{title:"Buf size",cssClass:".thin",values:[0,512,1024,2048,4096,16384,32768],unit:"KB",zeroIsDefault:!0,set:(e,t)=>e.ftraceBufferSizeKb=t,get:e=>e.ftraceBufferSizeKb}),(0,t.default)(r.Slider,{title:"Drain rate",cssClass:".thin",values:[0,100,250,500,1e3,2500,5e3],unit:"ms",zeroIsDefault:!0,set:(e,t)=>e.ftraceDrainPeriodMs=t,get:e=>e.ftraceDrainPeriodMs}),(0,t.default)(r.Dropdown,{title:"Event groups",cssClass:".multicolumn.ftrace-events",options:n,set:(e,t)=>e.ftraceEvents=t,get:e=>e.ftraceEvents}),(0,t.default)(r.Textarea,{placeholder:"Add extra events, one per line, e.g.:\nsched/sched_switch\nkmem/*",set:(e,t)=>e.ftraceExtraEvents=t,get:e=>e.ftraceExtraEvents})))}}}return vO}var SO,AO={};function OO(){if(!SO){SO=1,Object.defineProperty(AO,"__esModule",{value:!0}),AO.AndroidSettings=void 0;const i=or.__importDefault(ae()),e=oe(),o=TO(),s=new Map,l=(s.set("LID_CRASH","Crash"),s.set("LID_DEFAULT","Main"),s.set("LID_EVENTS","Binary events"),s.set("LID_KERNEL","Kernel"),s.set("LID_RADIO","Radio"),s.set("LID_SECURITY","Security"),s.set("LID_STATS","Stats"),s.set("LID_SYSTEM","System"),new Map);l.set("adb","ADB"),l.set("aidl","AIDL calls"),l.set("am","Activity Manager"),l.set("audio","Audio"),l.set("binder_driver","Binder Kernel driver"),l.set("binder_lock","Binder global lock trace"),l.set("bionic","Bionic C library"),l.set("camera","Camera"),l.set("dalvik","ART & Dalvik"),l.set("database","Database"),l.set("gfx","Graphics"),l.set("hal","Hardware Modules"),l.set("input","Input"),l.set("network","Network"),l.set("nnapi","Neural Network API"),l.set("pm","Package Manager"),l.set("power","Power Management"),l.set("res","Resource Loading"),l.set("rro","Resource Overlay"),l.set("rs","RenderScript"),l.set("sm","Sync Manager"),l.set("ss","System Server"),l.set("vibrator","Vibrator"),l.set("video","Video"),l.set("view","View System"),l.set("webview","WebView"),l.set("wm","Window Manager");class c{view(){return e.globals.state.recordConfig.allAtraceApps?(0,i.default)("div"):(0,i.default)(o.Textarea,{placeholder:"Apps to profile, one per line, e.g.:\ncom.android.phone\nlmkd\ncom.android.nfc",cssClass:".record-apps-list",set:(e,t)=>e.atraceApps=t,get:e=>e.atraceApps})}}AO.AndroidSettings=class{view({attrs:e}){let t=l;for(const n of e.dataSources)if("linux.ftrace"===n.name&&((r=n.descriptor)instanceof Object&&void 0!==r.name)){r=n.descriptor.ftraceDescriptor?.atraceCategories;if(!r||0===r.length)break;t=new Map;for(const a of r)a.name&&t.set(a.name,a.description??"")}var r;return(0,i.default)(".record-section"+e.cssClass,(0,i.default)(o.Probe,{title:"Atrace userspace annotations",img:"rec_atrace.png",descr:`Enables C++ / Java codebase annotations (ATRACE_BEGIN() /
                      os.Trace())`,setEnabled:(e,t)=>e.atrace=t,isEnabled:e=>e.atrace},(0,i.default)(o.Dropdown,{title:"Categories",cssClass:".multicolumn.atrace-categories",options:t,set:(e,t)=>e.atraceCats=t,get:e=>e.atraceCats}),(0,i.default)(o.Toggle,{title:"Record events from all Android apps and services",descr:"",setEnabled:(e,t)=>e.allAtraceApps=t,isEnabled:e=>e.allAtraceApps}),(0,i.default)(c)),(0,i.default)(o.Probe,{title:"Event log (logcat)",img:"rec_logcat.png",descr:`Streams the event log into the trace. If no buffer filter is
                      specified, all buffers are selected.`,setEnabled:(e,t)=>e.androidLogs=t,isEnabled:e=>e.androidLogs},(0,i.default)(o.Dropdown,{title:"Buffers",cssClass:".multicolumn",options:s,set:(e,t)=>e.androidLogBuffers=t,get:e=>e.androidLogBuffers})),(0,i.default)(o.Probe,{title:"Frame timeline",img:"rec_frame_timeline.png",descr:`Records expected/actual frame timings from surface_flinger.
                      Requires Android 12 (S) or above.`,setEnabled:(e,t)=>e.androidFrameTimeline=t,isEnabled:e=>e.androidFrameTimeline}),(0,i.default)(o.Probe,{title:"Game intervention list",img:"",descr:`List game modes and interventions.
                    Requires Android 13 (T) or above.`,setEnabled:(e,t)=>e.androidGameInterventionList=t,isEnabled:e=>e.androidGameInterventionList}),(0,i.default)(o.Probe,{title:"Network Tracing",img:"",descr:`Records detailed information on network packets.
                      Requires Android 14 (U) or above.`,setEnabled:(e,t)=>e.androidNetworkTracing=t,isEnabled:e=>e.androidNetworkTracing},(0,i.default)(o.Slider,{title:"Poll interval",cssClass:".thin",values:[100,250,500,1e3,2500],unit:"ms",set:(e,t)=>e.androidNetworkTracingPollMs=t,get:e=>e.androidNetworkTracingPollMs})))}}}return AO}var CO,kO={};function wO(){if(!CO){CO=1,Object.defineProperty(kO,"__esModule",{value:!0}),kO.ChromeSettings=void 0;var e=or;const t=_e(),i=e.__importDefault(ae()),r=ne(),o=Y(),s=Ry(),l=Rf(),c=oe(),n=TO();class u{defaultCategoryOptions=void 0;disabledByDefaultCategoryOptions=void 0;static updateValue(o,s){var e=(0,t.produce)(c.globals.state.recordConfig,e=>{var t=o.get(e);for(const i of s){var r=i.id,n=t.indexOf(r),a=i.checked;a&&-1===n&&t.push(r),a||-1===n||t.splice(n,1)}});c.globals.dispatch(r.Actions.setRecordConfig({config:e}))}view({attrs:t}){const r={get:e=>e.chromeCategoriesSelected,set:(e,t)=>e.chromeCategoriesSelected=t};if(void 0===this.defaultCategoryOptions||void 0===this.disabledByDefaultCategoryOptions){const n=new Set(r.get(c.globals.state.recordConfig));let e=c.globals.state.chromeCategories||function(e){for(const t of e)if("chromeCategories"===t.name)return t.descriptor}(t.dataSources);e&&(0,o.isChromeTarget)(c.globals.state.recordingTarget)||(e=(0,o.getBuiltinChromeCategoryList)()),this.defaultCategoryOptions=[],this.disabledByDefaultCategoryOptions=[];const a="disabled-by-default-";e.forEach(e=>{var t=n.has(e);e.startsWith(a)&&void 0!==this.disabledByDefaultCategoryOptions?this.disabledByDefaultCategoryOptions.push({id:e,name:e.replace(a,""),checked:t}):e.startsWith(a)||void 0===this.defaultCategoryOptions||this.defaultCategoryOptions.push({id:e,name:e,checked:t})})}return(0,i.default)("div.chrome-categories",(0,i.default)(l.Section,{title:"Additional Categories"},(0,i.default)(s.MultiSelect,{options:this.defaultCategoryOptions,repeatCheckedItemsAtTop:!1,fixedSize:!1,onChange:e=>{e.forEach(({id:e,checked:t})=>{if(void 0!==this.defaultCategoryOptions)for(const r of this.defaultCategoryOptions)r.id==e&&(r.checked=t)}),u.updateValue(r,e)}})),(0,i.default)(l.Section,{title:"High Overhead Categories"},(0,i.default)(s.MultiSelect,{options:this.disabledByDefaultCategoryOptions,repeatCheckedItemsAtTop:!1,fixedSize:!1,onChange:e=>{e.forEach(({id:e,checked:t})=>{if(void 0!==this.disabledByDefaultCategoryOptions)for(const r of this.disabledByDefaultCategoryOptions)r.id==e&&(r.checked=t)}),u.updateValue(r,e)}})))}}kO.ChromeSettings=class{view({attrs:e}){return(0,i.default)(".record-section"+e.cssClass,(0,n.CompactProbe)({title:"Task scheduling",setEnabled:(e,t)=>e.taskScheduling=t,isEnabled:e=>e.taskScheduling}),(0,n.CompactProbe)({title:"IPC flows",setEnabled:(e,t)=>e.ipcFlows=t,isEnabled:e=>e.ipcFlows}),(0,n.CompactProbe)({title:"Javascript execution",setEnabled:(e,t)=>e.jsExecution=t,isEnabled:e=>e.jsExecution}),(0,n.CompactProbe)({title:"Web content rendering, layout and compositing",setEnabled:(e,t)=>e.webContentRendering=t,isEnabled:e=>e.webContentRendering}),(0,n.CompactProbe)({title:"UI rendering & surface compositing",setEnabled:(e,t)=>e.uiRendering=t,isEnabled:e=>e.uiRendering}),(0,n.CompactProbe)({title:"Input events",setEnabled:(e,t)=>e.inputEvents=t,isEnabled:e=>e.inputEvents}),(0,n.CompactProbe)({title:"Navigation & Loading",setEnabled:(e,t)=>e.navigationAndLoading=t,isEnabled:e=>e.navigationAndLoading}),(0,n.CompactProbe)({title:"Chrome Logs",setEnabled:(e,t)=>e.chromeLogs=t,isEnabled:e=>e.chromeLogs}),(0,n.CompactProbe)({title:"Audio",setEnabled:(e,t)=>e.audio=t,isEnabled:e=>e.audio}),(0,n.CompactProbe)({title:"Video",setEnabled:(e,t)=>e.video=t,isEnabled:e=>e.video}),(0,i.default)(n.Toggle,{title:"Remove untyped and sensitive data like URLs from the trace",descr:"Not recommended unless you intend to share the trace with third-parties.",setEnabled:(e,t)=>e.chromePrivacyFiltering=t,isEnabled:e=>e.chromePrivacyFiltering}),(0,i.default)(u,e))}}}return kO}var RO,IO,MO={},PO={};function NO(){return RO||(RO=1,Object.defineProperty(PO,"__esModule",{value:!0}),PO.POLL_INTERVAL_MS=void 0,PO.POLL_INTERVAL_MS=[250,500,1e3,2500,5e3,3e4,6e4]),PO}function DO(){if(!IO){IO=1,Object.defineProperty(MO,"__esModule",{value:!0}),MO.CpuSettings=void 0;const t=or.__importDefault(ae()),r=TO(),n=NO();MO.CpuSettings=class{view({attrs:e}){return(0,t.default)(".record-section"+e.cssClass,(0,t.default)(r.Probe,{title:"Coarse CPU usage counter",img:"rec_cpu_coarse.png",descr:`Lightweight polling of CPU usage counters via /proc/stat.
                    Allows to periodically monitor CPU usage.`,setEnabled:(e,t)=>e.cpuCoarse=t,isEnabled:e=>e.cpuCoarse},(0,t.default)(r.Slider,{title:"Poll interval",cssClass:".thin",values:n.POLL_INTERVAL_MS,unit:"ms",set:(e,t)=>e.cpuCoarsePollMs=t,get:e=>e.cpuCoarsePollMs})),(0,t.default)(r.Probe,{title:"Scheduling details",img:"rec_cpu_fine.png",descr:"Enables high-detailed tracking of scheduling events",setEnabled:(e,t)=>e.cpuSched=t,isEnabled:e=>e.cpuSched}),(0,t.default)(r.Probe,{title:"CPU frequency and idle states",img:"rec_cpu_freq.png",descr:"Records cpu frequency and idle state changes via ftrace and sysfs",setEnabled:(e,t)=>e.cpuFreq=t,isEnabled:e=>e.cpuFreq},(0,t.default)(r.Slider,{title:"Sysfs poll interval",cssClass:".thin",values:n.POLL_INTERVAL_MS,unit:"ms",set:(e,t)=>e.cpuFreqPollMs=t,get:e=>e.cpuFreqPollMs})),(0,t.default)(r.Probe,{title:"Syscalls",img:"rec_syscalls.png",descr:`Tracks the enter and exit of all syscalls. On Android
                requires a userdebug or eng build.`,setEnabled:(e,t)=>e.cpuSyscall=t,isEnabled:e=>e.cpuSyscall}))}}}return MO}var xO,LO={};function FO(){if(!xO){xO=1,Object.defineProperty(LO,"__esModule",{value:!0}),LO.GpuSettings=void 0;const t=or.__importDefault(ae()),r=TO();LO.GpuSettings=class{view({attrs:e}){return(0,t.default)(".record-section"+e.cssClass,(0,t.default)(r.Probe,{title:"GPU frequency",img:"rec_cpu_freq.png",descr:"Records gpu frequency via ftrace",setEnabled:(e,t)=>e.gpuFreq=t,isEnabled:e=>e.gpuFreq}),(0,t.default)(r.Probe,{title:"GPU memory",img:"rec_gpu_mem_total.png",descr:`Allows to track per process and global total GPU memory usages.
                (Available on recent Android 12+ kernels)`,setEnabled:(e,t)=>e.gpuMemTotal=t,isEnabled:e=>e.gpuMemTotal}),(0,t.default)(r.Probe,{title:"GPU work period",img:"rec_cpu_voltage.png",descr:`Allows to track per package GPU work.
                (Available on recent Android 14+ kernels)`,setEnabled:(e,t)=>e.gpuWorkPeriod=t,isEnabled:e=>e.gpuWorkPeriod}))}}}return LO}var UO,BO={};function jO(){if(!UO){UO=1,Object.defineProperty(BO,"__esModule",{value:!0}),BO.LinuxPerfSettings=void 0;const t=or.__importDefault(ae()),r=TO();BO.LinuxPerfSettings=class{config={targets:[]};view({attrs:e}){return(0,t.default)(".record-section"+e.cssClass,(0,t.default)(r.Probe,{title:"Callstack sampling",img:"rec_profiling.png",descr:`Periodically records the current callstack (chain of 
              function calls) of processes.`,setEnabled:(e,t)=>e.tracePerf=t,isEnabled:e=>e.tracePerf},(0,t.default)(r.Slider,{title:"Sampling Frequency",cssClass:".thin",values:[20,40,60,80,100,120,140,160,180,200],unit:"hz",set:(e,t)=>e.timebaseFrequency=t,get:e=>e.timebaseFrequency}),(0,t.default)(r.Textarea,{placeholder:`Filters for processes to profile, one per line e.g.:
com.android.phone
lmkd
com.android.webview:sandboxed_process*`,cssClass:".record-apps-list",set:(e,t)=>{e.targetCmdLine=t.split("\n")},get:e=>e.targetCmdLine.join("\n")})))}}}return BO}var HO,GO={};function VO(){if(!HO){HO=1,Object.defineProperty(GO,"__esModule",{value:!0}),GO.MemorySettings=void 0;const i=or.__importDefault(ae()),o=Sa(),r=oe(),s=TO(),l=NO();class c{view({attrs:e}){var t=[0,1e3,1e4,3e4,6e4,3e5,6e5,18e5,36e5];return(0,i.default)("."+e.cssClass,(0,i.default)(s.Textarea,{title:"Names or pids of the processes to track (required)",docsLink:"https://perfetto.dev/docs/data-sources/native-heap-profiler#heapprofd-targets",placeholder:"One per line, e.g.:\nsystem_server\ncom.google.android.apps.photos\n1503",set:(e,t)=>e.hpProcesses=t,get:e=>e.hpProcesses}),(0,i.default)(s.Slider,{title:"Sampling interval",cssClass:".thin",values:[0,1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288,1048576],unit:"B",min:0,set:(e,t)=>e.hpSamplingIntervalBytes=t,get:e=>e.hpSamplingIntervalBytes}),(0,i.default)(s.Slider,{title:"Continuous dumps interval ",description:"Time between following dumps (0 = disabled)",cssClass:".thin",values:t,unit:"ms",min:0,set:(e,t)=>{e.hpContinuousDumpsInterval=t},get:e=>e.hpContinuousDumpsInterval}),(0,i.default)(s.Slider,{title:"Continuous dumps phase",description:"Time before first dump",cssClass:".thin"+(0===r.globals.state.recordConfig.hpContinuousDumpsInterval?".greyed-out":""),values:t,unit:"ms",min:0,disabled:0===r.globals.state.recordConfig.hpContinuousDumpsInterval,set:(e,t)=>e.hpContinuousDumpsPhase=t,get:e=>e.hpContinuousDumpsPhase}),(0,i.default)(s.Slider,{title:"Shared memory buffer",cssClass:".thin",values:[0,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288,1048576,67108864,134217728,268435456,536870912].filter(e=>0===e||8192<=e&&e%4096==0),unit:"B",min:0,set:(e,t)=>e.hpSharedMemoryBuffer=t,get:e=>e.hpSharedMemoryBuffer}),(0,i.default)(s.Toggle,{title:"Block client",cssClass:".thin",descr:"Slow down target application if profiler cannot keep up.",setEnabled:(e,t)=>e.hpBlockClient=t,isEnabled:e=>e.hpBlockClient}),(0,i.default)(s.Toggle,{title:"All custom allocators (Q+)",cssClass:".thin",descr:`If the target application exposes custom allocators, also
sample from those.`,setEnabled:(e,t)=>e.hpAllHeaps=t,isEnabled:e=>e.hpAllHeaps}))}}class u{view({attrs:e}){var t=[0,1e3,1e4,3e4,6e4,3e5,6e5,18e5,36e5];return(0,i.default)("."+e.cssClass,(0,i.default)(s.Textarea,{title:"Names or pids of the processes to track (required)",placeholder:"One per line, e.g.:\ncom.android.vending\n1503",set:(e,t)=>e.jpProcesses=t,get:e=>e.jpProcesses}),(0,i.default)(s.Slider,{title:"Continuous dumps interval ",description:"Time between following dumps (0 = disabled)",cssClass:".thin",values:t,unit:"ms",min:0,set:(e,t)=>{e.jpContinuousDumpsInterval=t},get:e=>e.jpContinuousDumpsInterval}),(0,i.default)(s.Slider,{title:"Continuous dumps phase",description:"Time before first dump",cssClass:".thin"+(0===r.globals.state.recordConfig.jpContinuousDumpsInterval?".greyed-out":""),values:t,unit:"ms",min:0,disabled:0===r.globals.state.recordConfig.jpContinuousDumpsInterval,set:(e,t)=>e.jpContinuousDumpsPhase=t,get:e=>e.jpContinuousDumpsPhase}))}}GO.MemorySettings=class{view({attrs:e}){var t=new Map;for(const n in o.MeminfoCounters)"number"!=typeof o.MeminfoCounters[n]||(""+n).endsWith("_UNSPECIFIED")||t.set(n,n.replace("MEMINFO_","").toLowerCase());var r=new Map;for(const a in o.VmstatCounters)"number"!=typeof o.VmstatCounters[a]||(""+a).endsWith("_UNSPECIFIED")||r.set(a,a.replace("VMSTAT_","").toLowerCase());return(0,i.default)(".record-section"+e.cssClass,(0,i.default)(s.Probe,{title:"Native heap profiling",img:"rec_native_heap_profiler.png",descr:`Track native heap allocations & deallocations of an Android
               process. (Available on Android 10+)`,setEnabled:(e,t)=>e.heapProfiling=t,isEnabled:e=>e.heapProfiling},(0,i.default)(c,e)),(0,i.default)(s.Probe,{title:"Java heap dumps",img:"rec_java_heap_dump.png",descr:`Dump information about the Java object graph of an
          Android app. (Available on Android 11+)`,setEnabled:(e,t)=>e.javaHeapDump=t,isEnabled:e=>e.javaHeapDump},(0,i.default)(u,e)),(0,i.default)(s.Probe,{title:"Kernel meminfo",img:"rec_meminfo.png",descr:"Polling of /proc/meminfo",setEnabled:(e,t)=>e.meminfo=t,isEnabled:e=>e.meminfo},(0,i.default)(s.Slider,{title:"Poll interval",cssClass:".thin",values:l.POLL_INTERVAL_MS,unit:"ms",set:(e,t)=>e.meminfoPeriodMs=t,get:e=>e.meminfoPeriodMs}),(0,i.default)(s.Dropdown,{title:"Select counters",cssClass:".multicolumn",options:t,set:(e,t)=>e.meminfoCounters=t,get:e=>e.meminfoCounters})),(0,i.default)(s.Probe,{title:"High-frequency memory events",img:"rec_mem_hifreq.png",descr:`Allows to track short memory spikes and transitories through
                ftrace's mm_event, rss_stat and ion events. Available only
                on recent Android Q+ kernels`,setEnabled:(e,t)=>e.memHiFreq=t,isEnabled:e=>e.memHiFreq}),(0,i.default)(s.Probe,{title:"Low memory killer",img:"rec_lmk.png",descr:`Record LMK events. Works both with the old in-kernel LMK
                and the newer userspace lmkd. It also tracks OOM score
                adjustments.`,setEnabled:(e,t)=>e.memLmk=t,isEnabled:e=>e.memLmk}),(0,i.default)(s.Probe,{title:"Per process stats",img:"rec_ps_stats.png",descr:`Periodically samples all processes in the system tracking:
                    their thread list, memory counters (RSS, swap and other
                    /proc/status counters) and oom_score_adj.`,setEnabled:(e,t)=>e.procStats=t,isEnabled:e=>e.procStats},(0,i.default)(s.Slider,{title:"Poll interval",cssClass:".thin",values:l.POLL_INTERVAL_MS,unit:"ms",set:(e,t)=>e.procStatsPeriodMs=t,get:e=>e.procStatsPeriodMs})),(0,i.default)(s.Probe,{title:"Virtual memory stats",img:"rec_vmstat.png",descr:`Periodically polls virtual memory stats from /proc/vmstat.
                    Allows to gather statistics about swap, eviction,
                    compression and pagecache efficiency`,setEnabled:(e,t)=>e.vmstat=t,isEnabled:e=>e.vmstat},(0,i.default)(s.Slider,{title:"Poll interval",cssClass:".thin",values:l.POLL_INTERVAL_MS,unit:"ms",set:(e,t)=>e.vmstatPeriodMs=t,get:e=>e.vmstatPeriodMs}),(0,i.default)(s.Dropdown,{title:"Select counters",cssClass:".multicolumn",options:r,set:(e,t)=>e.vmstatCounters=t,get:e=>e.vmstatCounters})))}}}return GO}var WO,qO={};function $O(){if(!WO){WO=1,Object.defineProperty(qO,"__esModule",{value:!0}),qO.PowerSettings=void 0;const r=or.__importDefault(ae()),n=oe(),a=TO(),i=NO();qO.PowerSettings=class{view({attrs:e}){var t=[(0,r.default)("div",(0,r.default)("span",`Polls charge counters and instantaneous power draw from
                    the battery power management IC and the power rails from
                    the PowerStats HAL (`),(0,r.default)("a",{href:"https://perfetto.dev/docs/data-sources/battery-counters",target:"_blank"},"see docs for more"),(0,r.default)("span",")"))];return n.globals.isInternalUser&&t.push((0,r.default)("div",(0,r.default)("span","Googlers: See "),(0,r.default)("a",{href:"http://go/power-rails-internal-doc",target:"_blank"},"this doc"),(0,r.default)("span",` for instructions on how to change the default rail selection
                  on internal devices.`))),(0,r.default)(".record-section"+e.cssClass,(0,r.default)(a.Probe,{title:"Battery drain & power rails",img:"rec_battery_counters.png",descr:t,setEnabled:(e,t)=>e.batteryDrain=t,isEnabled:e=>e.batteryDrain},(0,r.default)(a.Slider,{title:"Poll interval",cssClass:".thin",values:i.POLL_INTERVAL_MS,unit:"ms",set:(e,t)=>e.batteryDrainPollMs=t,get:e=>e.batteryDrainPollMs})),(0,r.default)(a.Probe,{title:"Board voltages & frequencies",img:"rec_board_voltage.png",descr:"Tracks voltage and frequency changes from board sensors",setEnabled:(e,t)=>e.boardSensors=t,isEnabled:e=>e.boardSensors}))}}}return qO}var zO,KO={};function YO(){if(!zO){zO=1,Object.defineProperty(KO,"__esModule",{value:!0}),KO.RecordingSettings=void 0;var e=or;const i=_e(),o=e.__importDefault(ae()),s=ne(),l=oe(),r=TO();KO.RecordingSettings=class{view({attrs:e}){const a=l.globals.state.recordConfig;var t=(t,e,r)=>{var n={checked:a.mode===t,onchange:e=>{e.target.checked&&(e=(0,i.produce)(l.globals.state.recordConfig,e=>{e.mode=t}),l.globals.dispatch(s.Actions.setRecordConfig({config:e})))}};return(0,o.default)("label"+(a.mode===t?".selected":""),(0,o.default)("input[type=radio][name=rec_mode]",n),(0,o.default)(`img[src=${l.globals.root}assets/${r}]`),(0,o.default)("span",e))};return(0,o.default)(".record-section"+e.cssClass,(0,o.default)("header","Recording mode"),(0,o.default)(".record-mode",t("STOP_WHEN_FULL","Stop when full","rec_one_shot.png"),t("RING_BUFFER","Ring buffer","rec_ring_buf.png"),t("LONG_TRACE","Long trace","rec_long_trace.png")),(0,o.default)(r.Slider,{title:"In-memory buffer size",icon:"360",values:[4,8,16,32,64,128,256,512],unit:"MB",set:(e,t)=>e.bufferSizeMb=t,get:e=>e.bufferSizeMb}),(0,o.default)(r.Slider,{title:"Max duration",icon:"timer",values:[1e4,15e3,3e4,6e4,3e5,18e5,36e5,216e5,432e5],isTime:!0,unit:"h:m:s",set:(e,t)=>e.durationMs=t,get:e=>e.durationMs}),(0,o.default)(r.Slider,{title:"Max file size",icon:"save",cssClass:"LONG_TRACE"!==a.mode?".hide":"",values:[5,25,50,100,500,1e3,5e3,1e4],unit:"MB",set:(e,t)=>e.maxFileSizeMb=t,get:e=>e.maxFileSizeMb}),(0,o.default)(r.Slider,{title:"Flush on disk every",cssClass:"LONG_TRACE"!==a.mode?".hide":"",icon:"av_timer",values:[100,250,500,1e3,2500,5e3],unit:"ms",set:(e,t)=>e.fileWritePeriodMs=t,get:e=>e.fileWritePeriodMs||0}))}}}return KO}var JO,ZO,QO={};function XO(){if(!JO){JO=1,Object.defineProperty(QO,"__esModule",{value:!0}),QO.EtwSettings=void 0;const t=or.__importDefault(ae()),r=TO();QO.EtwSettings=class{view({attrs:e}){return(0,t.default)(".record-section"+e.cssClass,(0,t.default)(r.Probe,{title:"CSwitch",img:null,descr:"Enables to recording of context switches.",setEnabled:(e,t)=>e.etwCSwitch=t,isEnabled:e=>e.etwCSwitch}),(0,t.default)(r.Probe,{title:"Dispatcher",img:null,descr:"Enables to get thread state.",setEnabled:(e,t)=>e.etwThreadState=t,isEnabled:e=>e.etwThreadState}))}}}return QO}function eC(){if(!ZO){ZO=1;{var p=_O;Object.defineProperty(p,"__esModule",{value:!0}),p.RecordPage=p.ConfigTitleState=p.RECORDING_SECTIONS=p.PERSIST_CONFIG_FLAG=void 0,p.loadedConfigEqual=r,p.loadConfigButton=n,p.displayRecordConfigs=a,p.Configurations=s,p.ErrorLabel=c,p.updateAvailableAdbDevices=d,p.maybeGetActiveCss=h;const g=or.__importDefault(ae()),m=ne(),_=Y(),y=kE(),T=na();var e=re();const b=ie(),v=oe();var t=c1();const E=da(),S=TO(),A=EO(),O=OO(),C=wO(),k=DO(),w=FO(),R=jO(),I=VO(),M=$O(),P=YO(),N=XO(),D=kT();function i(){return(0,g.default)(".record-header",(0,g.default)(".top-part",(0,g.default)(".target-and-status",function(){if(v.globals.state.recordingInProgress)return[];const e=v.globals.state.availableAdbDevices,t=v.globals.state.recordingTarget,r=[];for(var{os:n,name:a}of(0,_.getDefaultRecordingTargets)())r.push((0,g.default)("option",{value:n},a));for(const o of e)r.push((0,g.default)("option",{value:o.serial},o.name));const i=(0,_.isAdbTarget)(t)?r.findIndex(e=>e.attrs.value===t.serial):r.findIndex(e=>e.attrs.value===t.os);return(0,g.default)(".target",(0,g.default)("label","Target platform:",(0,g.default)("select",{selectedIndex:i,onchange:e=>{var t=e.target.value,e=v.globals.state.availableAdbDevices.find(e=>e.serial===t)||(0,_.getDefaultRecordingTargets)().find(e=>e.os===t)||(0,_.getDefaultRecordingTargets)()[0];(0,_.isChromeTarget)(e)&&v.globals.dispatch(m.Actions.setFetchChromeCategories({fetch:!0})),v.globals.dispatch(m.Actions.setRecordingTarget({target:e})),E.recordTargetStore.save(t),b.raf.scheduleFullRedraw()},onupdate:e=>{e.dom.selectedIndex=i}},...r)),(0,g.default)(".chip",{onclick:u},(0,g.default)("button","Add ADB Device"),(0,g.default)("i.material-icons","add")))}(),(e=v.globals.state.recordingStatus)?(0,g.default)("label",e):[],c()),function(){var e=v.globals.state,t=e.recordingTarget,r=e.recordingInProgress,n=(0,g.default)("button",{class:r?"":"selected",onclick:l},"Start Recording"),a=[];(0,_.isAndroidTarget)(t)?!r&&(0,_.isAdbTarget)(t)&&"LONG_TRACE"!==v.globals.state.recordConfig.mode&&a.push(n):((0,_.isWindowsTarget)(t)||(0,_.isChromeTarget)(t))&&e.extensionInstalled&&a.push(n);return(0,g.default)(".button",a)}()),function(){var e="https://perfetto.dev/docs/quickstart/android-tracing#perfetto-cmdline",t="https://chrome.google.com/webstore/detail/perfetto-ui/lfmkphfpdbjijhpomgecfikhfohaoine",r=[],n=(0,g.default)("span",`Some probes are only supported in Perfetto versions running
      on Android Q+. `),a=(0,g.default)("span","Perfetto is not supported natively before Android P. "),i=(0,g.default)("span","If you have a rooted device you can ",(0,g.default)("a",{href:"https://perfetto.dev/docs/contributing/build-instructions#get-the-code",target:"_blank"},`sideload the latest version of
         Perfetto.`)),o=(0,g.default)(".note",`Recording Perfetto traces from the UI is not supported natively
     before Android Q. If you are using a P device, please select 'Android P'
     as the 'Target Platform' and `,(0,g.default)("a",{href:e,target:"_blank"},"collect the trace using ADB.")),s=(0,g.default)(".note","To trace Chrome from the Perfetto UI, you need to install our ",(0,g.default)("a",{href:t,target:"_blank"},"Chrome extension")," and then reload this page. "),l=(0,g.default)(".note","To trace with Etw on Windows from the Perfetto UI, you to run chrome with","administrator permission and you need to install our ",(0,g.default)("a",{href:t,target:"_blank"},"Chrome extension")," and then reload this page."),c=(0,g.default)(".note","Use this ",(0,g.default)("a",{href:"https://perfetto.dev/docs/quickstart/linux-tracing",target:"_blank"},"quickstart guide")," to get started with tracing on Linux."),t=(0,g.default)(".note",`Recording in long trace mode through the UI is not supported. Please copy
    the command and `,(0,g.default)("a",{href:e,target:"_blank"},"collect the trace using ADB.")),e=(0,g.default)(".note","It looks like you didn't add any probes. Please add at least one to get a non-empty trace.");(0,_.hasActiveProbes)(v.globals.state.recordConfig)||r.push(e);(0,_.isAdbTarget)(v.globals.state.recordingTarget)&&r.push(o);switch(v.globals.state.recordingTarget.os){case"Q":break;case"P":r.push((0,g.default)(".note",n,i));break;case"O":r.push((0,g.default)(".note",a,i));break;case"L":r.push(c);break;case"C":case"CrOS":v.globals.state.extensionInstalled||r.push(s);break;case"Win":v.globals.state.extensionInstalled||r.push(l)}"LONG_TRACE"===v.globals.state.recordConfig.mode&&r.unshift(t);return 0<r.length?(0,g.default)("div",r):[]}());var e}function o(e){return(0,g.default)(".record-section.instructions"+e,(0,g.default)("header","Recording command"),p.PERSIST_CONFIG_FLAG.get()?(0,g.default)("button.permalinkconfig",{onclick:()=>(0,D.createPermalink)({mode:"RECORDING_OPTS"})},"Share recording settings"):null,function(){var e=v.globals.state.recordingTarget;if((0,_.isChromeTarget)(e))return v.globals.state.extensionInstalled&&!v.globals.state.recordingInProgress?(0,g.default)("div",(0,g.default)("label",`To trace Chrome from the Perfetto UI you just have to press
         'Start Recording'.`)):[];return(0,g.default)(S.CodeSnippet,{text:function(e){var t=v.globals.trackDataStore.get("config"),r=v.globals.state.recordConfig;r=r.durationMs/1e3;r>_.MAX_TIME&&_.MAX_TIME;r=t?t.pbBase64:"",t=t?t.pbtxt:"";let n="";n=(0,_.isAndroidP)(e)?(n+=`echo '${r}' | 
`)+'base64 --decode | \nadb shell "perfetto -c - -o /data/misc/perfetto-traces/trace"\n':(n=(n=n+((0,_.isAndroidTarget)(e)?"adb shell perfetto \\\n":"perfetto \\\n")+"  -c - --txt \\\n")+"  -o /data/misc/perfetto-traces/trace \\\n<<EOF\n\n")+t+"\nEOF\n";return n}(e)})}(),function(){if(!v.globals.state.recordingInProgress)return[];var e=v.globals.bufferUsage??0;return 0===e?[]:(0,g.default)("label","Buffer usage: ",(0,g.default)("progress",{max:100,value:100*e}))}(),(0,g.default)(".buttons",function(){if(!v.globals.state.recordingInProgress)return[];var e=(0,g.default)("button.selected",{onclick:()=>v.globals.dispatch(m.Actions.stopRecording({}))},"Stop"),t=(0,g.default)("button",{onclick:()=>v.globals.dispatch(m.Actions.cancelRecording({}))},"Cancel");return[e,t]}()),void 0===(e=v.globals.recordingLog)?[]:(0,g.default)(".code-snippet.no-top-bar",(0,g.default)("code",e)))}function r(e,t){return"NAMED"===e.type&&"NAMED"===t.type?e.name===t.name:e.type===t.type}function n(e,t){return(0,g.default)("button",{class:"config-button",title:"Apply configuration settings",disabled:r(t,v.globals.state.lastLoadedConfig),onclick:()=>{v.globals.dispatch(m.Actions.setRecordConfig({config:e,configType:t})),b.raf.scheduleFullRedraw()}},(0,g.default)("i.material-icons","file_upload"))}function a(){var e=[];E.autosaveConfigStore.hasSavedConfig&&e.push((0,g.default)(".config",[(0,g.default)("span.title-config",(0,g.default)("strong","Latest started recording")),n(E.autosaveConfigStore.get(),{type:"AUTOMATIC"})]));for(const t of E.recordConfigStore.recordConfigs)e.push((0,g.default)(".config",[(0,g.default)("span.title-config",t.title),n(t.config,{type:"NAMED",name:t.title}),(0,g.default)("button",{class:"config-button",title:"Overwrite configuration with current settings",onclick:()=>{confirm(`Overwrite config "${t.title}" with current settings?`)&&(E.recordConfigStore.overwrite(v.globals.state.recordConfig,t.key),v.globals.dispatch(m.Actions.setRecordConfig({config:t.config,configType:{type:"NAMED",name:t.title}})),b.raf.scheduleFullRedraw())}},(0,g.default)("i.material-icons","save")),(0,g.default)("button",{class:"config-button",title:"Remove configuration",onclick:()=>{E.recordConfigStore.delete(t.key),b.raf.scheduleFullRedraw()}},(0,g.default)("i.material-icons","delete"))]));return e}function s(e){var t=E.recordConfigStore.canSave(p.ConfigTitleState.getTitle());return(0,g.default)(".record-section"+e,(0,g.default)("header","Save and load configurations"),(0,g.default)(".input-config",[(0,g.default)("input",{value:p.ConfigTitleState.title,placeholder:"Title for config",oninput(){p.ConfigTitleState.setTitle(this.value),b.raf.scheduleFullRedraw()}}),(0,g.default)("button",{class:"config-button",disabled:!t,title:t?"Save current config":"Duplicate name, saving disabled",onclick:()=>{E.recordConfigStore.save(v.globals.state.recordConfig,p.ConfigTitleState.getTitle()),b.raf.scheduleFullRedraw(),p.ConfigTitleState.clearTitle()}},(0,g.default)("i.material-icons","save")),(0,g.default)("button",{class:"config-button",title:"Clear current configuration",onclick:()=>{confirm("Current configuration will be cleared. Are you sure?")&&(v.globals.dispatch(m.Actions.setRecordConfig({config:(0,T.createEmptyRecordConfig)(),configType:{type:"NONE"}})),b.raf.scheduleFullRedraw())}},(0,g.default)("i.material-icons","delete_forever"))]),a())}function l(){location.href="#!/record/instructions",b.raf.scheduleFullRedraw(),E.autosaveConfigStore.save(v.globals.state.recordConfig);var e=v.globals.state.recordingTarget;((0,_.isAndroidTarget)(e)||(0,_.isChromeTarget)(e)||(0,_.isWindowsTarget)(e))&&(v.globals.logging.logEvent("Record Trace",`Record trace (${e.os})`),v.globals.dispatch(m.Actions.startRecording({})))}function c(){var e=v.globals.state.lastRecordingError;return e?(0,g.default)("label.error-label","Error:  "+e):[]}async function u(){let e;try{e=await(new y.AdbOverWebUsb).findDevice()}catch(e){var t=`No device found: ${e.name}: `+e.message;return console.error(t,e),void alert(t)}e.serialNumber?await d(e.serialNumber):console.error("serial number undefined")}p.PERSIST_CONFIG_FLAG=e.featureFlags.register({id:"persistConfigsUI",name:"Config persistence UI",description:"Show experimental config persistence UI on the record page.",defaultValue:!0}),p.RECORDING_SECTIONS=["buffers","instructions","config","cpu","etw","gpu","power","memory","android","chrome","tracePerf","advanced"],p.ConfigTitleState={title:"",getTitle:()=>p.ConfigTitleState.title,setTitle:e=>{p.ConfigTitleState.title=e},clearTitle:()=>{p.ConfigTitleState.title=""}};const x=e.featureFlags.register({id:"recordingPageUseSAsDefault",name:"Use Android S as a default recording target",description:"Use Android S as a default recording target instead of Q",defaultValue:!1});async function d(t){var r,e,n,a=await(new y.AdbOverWebUsb).getPairedDevices();let i=void 0;const o=[];return a.forEach(e=>{e.productName&&e.serialNumber&&(o.push({name:e.productName,serial:e.serialNumber,os:x.get()?"S":"Q"}),t)&&t===e.serialNumber&&(i=o[o.length-1])}),v.globals.dispatch(m.Actions.setAvailableAdbDevices({devices:o})),a=o,r=(r=i)||v.globals.state.recordingTarget,e=(0,_.isAdbTarget)(r),n=e&&void 0===a.find(e=>e.serial===r.serial),a.length?(e&&!n||(r=a[0]),v.globals.dispatch(m.Actions.setRecordingTarget({target:r}))):n&&v.globals.dispatch(m.Actions.setRecordingTarget({target:(0,_.getDefaultRecordingTargets)()[0]})),b.raf.scheduleFullRedraw(),o}function f(e){var t=v.globals.state.recordingTarget,r=(0,g.default)('a[href="#!/record/chrome"]',(0,g.default)("li"+("chrome"===e?".active":""),(0,g.default)("i.material-icons","laptop_chromebook"),(0,g.default)(".title","Chrome"),(0,g.default)(".sub","Chrome traces"))),n=(0,g.default)('a[href="#!/record/cpu"]',(0,g.default)("li"+("cpu"===e?".active":""),(0,g.default)("i.material-icons","subtitles"),(0,g.default)(".title","CPU"),(0,g.default)(".sub","CPU usage, scheduling, wakeups"))),a=(0,g.default)('a[href="#!/record/gpu"]',(0,g.default)("li"+("gpu"===e?".active":""),(0,g.default)("i.material-icons","aspect_ratio"),(0,g.default)(".title","GPU"),(0,g.default)(".sub","GPU frequency, memory"))),i=(0,g.default)('a[href="#!/record/power"]',(0,g.default)("li"+("power"===e?".active":""),(0,g.default)("i.material-icons","battery_charging_full"),(0,g.default)(".title","Power"),(0,g.default)(".sub","Battery and other energy counters"))),o=(0,g.default)('a[href="#!/record/memory"]',(0,g.default)("li"+("memory"===e?".active":""),(0,g.default)("i.material-icons","memory"),(0,g.default)(".title","Memory"),(0,g.default)(".sub","Physical mem, VM, LMK"))),s=(0,g.default)('a[href="#!/record/android"]',(0,g.default)("li"+("android"===e?".active":""),(0,g.default)("i.material-icons","android"),(0,g.default)(".title","Android apps & svcs"),(0,g.default)(".sub","atrace and logcat"))),l=(0,g.default)('a[href="#!/record/advanced"]',(0,g.default)("li"+("advanced"===e?".active":""),(0,g.default)("i.material-icons","settings"),(0,g.default)(".title","Advanced settings"),(0,g.default)(".sub","Complicated stuff for wizards"))),c=(0,g.default)('a[href="#!/record/tracePerf"]',(0,g.default)("li"+("tracePerf"===e?".active":""),(0,g.default)("i.material-icons","full_stacked_bar_chart"),(0,g.default)(".title","Stack Samples"),(0,g.default)(".sub","Lightweight stack polling"))),u=(0,g.default)('a[href="#!/record/etw"]',(0,g.default)("li"+("etw"===e?".active":""),(0,g.default)("i.material-icons","subtitles"),(0,g.default)(".title","ETW Tracing Config"),(0,g.default)(".sub","Context switch, Thread state"))),d=v.globals.state.recordingInProgress,f=[];return(0,_.isLinuxTarget)(t)?f.push(n,i,o,r,l):(0,_.isChromeTarget)(t)&&!(0,_.isCrOSTarget)(t)?f.push(r):(0,_.isWindowsTarget)(t)?f.push(r,u):f.push(n,a,i,o,s,r,c,l),(0,g.default)(".record-menu",{class:d?"disabled":"",onclick:()=>b.raf.scheduleFullRedraw()},(0,g.default)("header","Trace config"),(0,g.default)("ul",(0,g.default)('a[href="#!/record/buffers"]',(0,g.default)("li"+("buffers"===e?".active":""),(0,g.default)("i.material-icons","tune"),(0,g.default)(".title","Recording settings"),(0,g.default)(".sub","Buffer mode, size and duration"))),(0,g.default)('a[href="#!/record/instructions"]',(0,g.default)("li"+("instructions"===e?".active":""),(0,g.default)("i.material-icons-filled.rec","fiber_manual_record"),(0,g.default)(".title","Recording command"),(0,g.default)(".sub","Manually record trace"))),p.PERSIST_CONFIG_FLAG.get()?(0,g.default)('a[href="#!/record/config"]',{onclick:()=>{E.recordConfigStore.reloadFromLocalStorage()}},(0,g.default)("li"+("config"===e?".active":""),(0,g.default)("i.material-icons","save"),(0,g.default)(".title","Saved configs"),(0,g.default)(".sub","Manage local configs"))):null),(0,g.default)("header","Probes"),(0,g.default)("ul",f))}function h(e,t){return e===t?".active":""}p.RecordPage=(0,t.createPage)({view({attrs:e}){var t,r,n=[];let a=e.subpage?e.subpage.substr(1):"";p.RECORDING_SECTIONS.includes(a)||(a="buffers"),n.push(f(a)),n.push((0,g.default)(P.RecordingSettings,{dataSources:[],cssClass:h(a,"buffers")})),n.push(o(h(a,"instructions"))),n.push(s(h(a,"config")));for([t,r]of new Map([["cpu",k.CpuSettings],["gpu",w.GpuSettings],["power",M.PowerSettings],["memory",I.MemorySettings],["android",O.AndroidSettings],["chrome",C.ChromeSettings],["tracePerf",R.LinuxPerfSettings],["advanced",A.AdvancedSettings],["etw",N.EtwSettings]]).entries())n.push((0,g.default)(r,{dataSources:[],cssClass:h(a,t)}));return(0,_.isChromeTarget)(v.globals.state.recordingTarget)&&v.globals.dispatch(m.Actions.setFetchChromeCategories({fetch:!0})),(0,g.default)(".record-page",v.globals.state.recordingInProgress?(0,g.default)(".hider"):[],(0,g.default)(".record-container",i(),(0,g.default)(".record-container-content",f(a),n)))}})}}return _O}var tC,rC={},nC={},aC={};function iC(){var e;return tC||(tC=1,e=aC,Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_TRACED_WEBSOCKET_URL=e.DEFAULT_ADB_WEBSOCKET_URL=e.TRACED_ENDPOINT=e.ADB_ENDPOINT=e.DEFAULT_WEBSOCKET_URL=e.FORCE_RESET_MESSAGE=void 0,e.FORCE_RESET_MESSAGE="Force reset the USB interface",e.DEFAULT_WEBSOCKET_URL="ws://127.0.0.1:8037",e.ADB_ENDPOINT="/adb",e.TRACED_ENDPOINT="/traced",e.DEFAULT_ADB_WEBSOCKET_URL=e.DEFAULT_WEBSOCKET_URL+e.ADB_ENDPOINT,e.DEFAULT_TRACED_WEBSOCKET_URL=e.DEFAULT_WEBSOCKET_URL+e.TRACED_ENDPOINT),aC}var oC,sC,lC={};function cC(){if(!oC){oC=1,Object.defineProperty(lC,"__esModule",{value:!0}),lC.couldNotClaimInterface=function(e,t){let r=!1;(0,a.showModal)({title:"Could not claim the USB interface",content:(0,n.default)("div",(0,n.default)("text","This can happen if you have the Android Debug Bridge (adb) running on your workstation or any other tool which is taking exclusive access of the USB interface."),(0,n.default)("br"),(0,n.default)("br"),(0,n.default)("text.small-font","Resetting will cause the ADB server to disconnect and will try to reassign the interface to the current browser.")),buttons:[{text:i.FORCE_RESET_MESSAGE,primary:!0,id:"force_USB_interface",action:()=>{r=!0,e()}},{text:"Cancel",primary:!1,id:"cancel_USB_interface",action:()=>{r=!0,t()}}]}).then(()=>{r||t()})};const n=or.__importDefault(ae()),a=de(),i=iC()}return lC}var uC,dC={},fC={};var pC,hC,gC,mC={};function _C(){if(hC)return dC;hC=1,Object.defineProperty(dC,"__esModule",{value:!0}),dC.showAddNewTargetModal=function(n){(0,l.showModal)({title:"Add new recording target",key:i.RECORDING_MODAL_DIALOG_KEY,content:()=>{return(0,a.default)(".record-modal",(0,a.default)("text","Select platform:"),(r=n,(0,a.default)(".record-modal-section",(0,a.default)(".logo-wrapping",(0,a.default)("i.material-icons","usb")),(0,a.default)(".record-modal-description",(0,a.default)("h3","Android device over WebUSB"),(0,a.default)("text","Android developers: this option cannot co-operate with the adb host on your machine. Only one entity between the browser and adb can control the USB endpoint. If adb is running, you will be prompted to re-assign the device to the browser. Use the websocket option below to use both simultaneously."),(0,a.default)(".record-modal-button",{onclick:()=>{(0,l.closeModal)(i.RECORDING_MODAL_DIALOG_KEY),r.addAndroidDevice()}},"Connect new WebUSB driver")))),(0,a.default)(".line"),(e=n,(t=[]).push((0,a.default)("h3","Android / Linux / MacOS device via Websocket")),t.push((0,a.default)("text","This option assumes that the adb server is already running on your machine."),(0,a.default)(".record-modal-command",(0,a.default)(c.CodeSnippet,{text:d}))),t.push((0,a.default)(".record-modal-command",(0,a.default)("text","Websocket bridge address: "),(0,a.default)("input[type=text]",{value:f.getPath(),oninput(){f.setPath(this.value)}}),(0,a.default)(".record-modal-logo-button",{onclick:()=>f.onPathChange()},(0,a.default)("i.material-icons","refresh")))),t.push((0,a.default)(u.RecordingMultipleChoice,{controller:e,targetFactories:f.getTargetFactories()})),(0,a.default)(".record-modal-section",(0,a.default)(".logo-wrapping",(0,a.default)("i.material-icons","settings_ethernet")),(0,a.default)(".record-modal-description",...t))),(0,a.default)(".line"),function(e){if(!s.targetFactoryRegistry.has(o.CHROME_TARGET_FACTORY))return;var t=[],r=(t.push((0,a.default)("h3","Chrome Browser instance or ChromeOS device")),s.targetFactoryRegistry.get(o.CHROME_TARGET_FACTORY));r.isExtensionInstalled?t.push((0,a.default)(u.RecordingMultipleChoice,{controller:e,targetFactories:[r]})):t.push((0,a.default)("text","Install the extension ",(0,a.default)("a",{href:i.EXTENSION_URL,target:"_blank"},"from this link "),"and refresh the page."));return(0,a.default)(".record-modal-section",(0,a.default)(".logo-wrapping",(0,a.default)("i.material-icons","web")),(0,a.default)(".record-modal-description",...t))}(n));var e,t,r}})};const a=or.__importDefault(ae()),i=b_(),o=rE(),s=uv();var e=function(){if(!uC){uC=1,Object.defineProperty(fC,"__esModule",{value:!0}),fC.WebsocketMenuController=void 0;const e=iC(),t=Bv(),r=uE(),n=uv();fC.WebsocketMenuController=class{path=e.DEFAULT_WEBSOCKET_URL;getPath(){return this.path}setPath(e){this.path=e}onPathChange(){n.targetFactoryRegistry.has(t.ANDROID_WEBSOCKET_TARGET_FACTORY)&&n.targetFactoryRegistry.get(t.ANDROID_WEBSOCKET_TARGET_FACTORY).tryEstablishWebsocket(this.path+e.ADB_ENDPOINT),n.targetFactoryRegistry.has(r.HOST_OS_TARGET_FACTORY)&&n.targetFactoryRegistry.get(r.HOST_OS_TARGET_FACTORY).tryEstablishWebsocket(this.path+e.TRACED_ENDPOINT)}getTargetFactories(){var e=[];return n.targetFactoryRegistry.has(t.ANDROID_WEBSOCKET_TARGET_FACTORY)&&e.push(n.targetFactoryRegistry.get(t.ANDROID_WEBSOCKET_TARGET_FACTORY)),n.targetFactoryRegistry.has(r.HOST_OS_TARGET_FACTORY)&&e.push(n.targetFactoryRegistry.get(r.HOST_OS_TARGET_FACTORY)),e}}}return fC}();const l=de(),c=TO(),u=function(){if(!pC){pC=1,Object.defineProperty(mC,"__esModule",{value:!0}),mC.RecordingMultipleChoice=void 0;const o=or.__importDefault(ae()),i=b_(),s=de();mC.RecordingMultipleChoice=class{selectedIndex=-1;targetSelection(t,r){var n=r.getTargetInfo(),a=[];this.selectedIndex=-1;for(let e=0;e<t.length;e++){var i=t[e].getInfo().name;a.push((0,o.default)("option",i)),n&&i===n.name&&(this.selectedIndex=e)}var e=this.selectedIndex;return(0,o.default)("label",(0,o.default)("select",{selectedIndex:e,onchange:e=>{r.onTargetSelection(e.target.value)},onupdate:e=>{e.dom.selectedIndex=this.selectedIndex},size:t.length,multiple:"multiple"},...a))}view({attrs:e}){const t=e.controller;if(t.shouldShowTargetSelection()){var r=[];for(const n of e.targetFactories)for(const a of n.listTargets())r.push(a);if(0!==r.length)return[(0,o.default)("text","Select target:"),(0,o.default)(".record-modal-command",this.targetSelection(r,t),(0,o.default)("button.record-modal-button-high",{disabled:-1===this.selectedIndex,onclick:()=>{(0,s.closeModal)(i.RECORDING_MODAL_DIALOG_KEY),t.onStartRecordingPressed()}},"Connect"))]}}}}return mC}(),d="# Get tracebox\ncurl -LO https://get.perfetto.dev/tracebox\nchmod +x ./tracebox\n# Option A - trace android devices\nadb start-server\n# Option B - trace the host OS\n./tracebox traced --background\n./tracebox traced_probes --background\n# Start the websocket server\n./tracebox websocket_bridge\n";const f=new e.WebsocketMenuController;return dC}function yC(){if(!gC){gC=1,Object.defineProperty(rC,"__esModule",{value:!0}),rC.RecordPageV2=void 0,rC.targetSelection=a;const T=or.__importDefault(ae()),b=ee();var e=AE();const v=function(){if(!sC){sC=1,Object.defineProperty(nC,"__esModule",{value:!0}),nC.RecordingPageController=nC.RecordingState=void 0;const a=ee(),r=K(),i=ie(),o=oe(),s=da(),t=iC(),l=cC(),c=ne(),u=$y(),d=AE(),f=iv(),p=b_(),h=Bv(),g=Mv(),m=uE(),_=uv();var n,e;(e=n||(nC.RecordingState=n={}))[e.NO_TARGET=0]="NO_TARGET",e[e.TARGET_SELECTED=1]="TARGET_SELECTED",e[e.ASK_TO_FORCE_P1=2]="ASK_TO_FORCE_P1",e[e.AUTH_P1=3]="AUTH_P1",e[e.TARGET_INFO_DISPLAYED=4]="TARGET_INFO_DISPLAYED",e[e.ASK_TO_FORCE_P2=5]="ASK_TO_FORCE_P2",e[e.AUTH_P2=6]="AUTH_P2",e[e.RECORDING=7]="RECORDING",e[e.WAITING_FOR_TRACE_DISPLAY=8]="WAITING_FOR_TRACE_DISPLAY";class y{tracingSession=void 0;isCancelled=!1;tracingSessionListener={onTraceData:e=>this.controller.maybeOnTraceData(this,e),onStatus:e=>this.controller.maybeOnStatus(this,e),onDisconnect:e=>this.controller.maybeOnDisconnect(this,e),onError:e=>this.controller.maybeOnError(this,e)};target;controller;constructor(e,t){this.target=e,this.controller=t}async start(t){let r=this.controller.getStateGeneration();var e=async()=>{try{this.controller.maybeSetState(this,n.AUTH_P2,r),r+=1;var e=await this.target.createTracingSession(this.tracingSessionListener);this.isCancelled?e.cancel():(this.tracingSession=e,this.controller.maybeSetState(this,n.RECORDING,r),this.tracingSession.start((0,a.assertExists)(t)))}catch(e){this.tracingSessionListener.onError(e.message)}};await this.target.canConnectWithoutContention()?await e():(this.controller.maybeSetState(this,n.ASK_TO_FORCE_P2,r),r+=1,(0,l.couldNotClaimInterface)(e,()=>this.controller.maybeClearRecordingState(this)))}async fetchTargetInfo(){let e=this.controller.getStateGeneration();var t=async()=>{try{this.controller.maybeSetState(this,n.AUTH_P1,e),e+=1,await this.target.fetchTargetInfo(this.tracingSessionListener),this.controller.maybeSetState(this,n.TARGET_INFO_DISPLAYED,e)}catch(e){this.tracingSessionListener.onError(e.message)}};await this.target.canConnectWithoutContention()?await t():(this.controller.maybeSetState(this,n.ASK_TO_FORCE_P1,e),e+=1,(0,l.couldNotClaimInterface)(t,()=>this.controller.maybeSetState(this,n.TARGET_SELECTED,e)))}cancel(){this.tracingSession?this.tracingSession.cancel():this.isCancelled=!0,this.controller.maybeClearRecordingState(this)}stop(){var e=this.controller.getStateGeneration();this.tracingSession?(this.tracingSession.stop(),this.controller.maybeSetState(this,n.WAITING_FOR_TRACE_DISPLAY,e)):(this.isCancelled=!0,this.controller.maybeClearRecordingState(this))}getTraceBufferUsage(){if(this.tracingSession)return this.tracingSession.getTraceBufferUsage();throw new f.RecordingError(p.BUFFER_USAGE_NOT_ACCESSIBLE)}}nC.RecordingPageController=class{state=n.NO_TARGET;target=void 0;tracingSessionWrapper=void 0;bufferUsagePercentage=0;stateGeneration=0;getBufferUsagePercentage(){return this.bufferUsagePercentage}getState(){return this.state}getStateGeneration(){return this.stateGeneration}maybeSetState(e,t,r){if(this.tracingSessionWrapper===e){if(r!==this.stateGeneration)throw new f.RecordingError("Recording page state transition out of order.");this.setState(t),o.globals.dispatch(c.Actions.setRecordingStatus({status:void 0})),i.raf.scheduleFullRedraw()}}maybeClearRecordingState(e){this.tracingSessionWrapper===e&&this.clearRecordingState()}maybeOnTraceData(e,t){this.tracingSessionWrapper===e&&(o.globals.dispatch(c.Actions.openTraceFromBuffer({title:"Recorded trace",buffer:t.buffer,fileName:"trace_"+(0,r.currentDateHourAndMinute)()+u.TRACE_SUFFIX})),this.clearRecordingState())}maybeOnStatus(e,t){this.tracingSessionWrapper===e&&(t.startsWith(p.RECORDING_IN_PROGRESS)?o.globals.dispatch(c.Actions.setRecordingStatus({status:t})):(0,f.showRecordingModal)(t))}maybeOnDisconnect(e,t){this.tracingSessionWrapper===e&&(t&&(0,f.showRecordingModal)(t),this.clearRecordingState(),this.onTargetChange())}maybeOnError(e,t){this.tracingSessionWrapper===e&&((0,f.showRecordingModal)(t),this.clearRecordingState())}getTargetInfo(){if(this.target)return this.target.getInfo()}canCreateTracingSession(){return!!this.target&&this.target.canCreateTracingSession()}selectTarget(e){(0,a.assertTrue)(n.NO_TARGET<=this.state&&this.state<n.RECORDING),e&&e===this.target||(this.target=e,this.target?(this.setState(n.TARGET_SELECTED),i.raf.scheduleFullRedraw(),this.tracingSessionWrapper=this.createTracingSessionWrapper(this.target),this.tracingSessionWrapper.fetchTargetInfo()):(this.setState(n.NO_TARGET),i.raf.scheduleFullRedraw()))}async addAndroidDevice(){try{var e=await _.targetFactoryRegistry.get(g.ANDROID_WEBUSB_TARGET_FACTORY).connectNewTarget();this.selectTarget(e)}catch(e){if(!(e instanceof f.RecordingError))throw e;(0,f.showRecordingModal)(e.message)}}onTargetSelection(t){(0,a.assertTrue)(n.NO_TARGET<=this.state&&this.state<n.RECORDING);var e=_.targetFactoryRegistry.listTargets();this.selectTarget(e.find(e=>e.getInfo().name===t))}onStartRecordingPressed(){(0,a.assertTrue)(n.TARGET_INFO_DISPLAYED===this.state),location.href="#!/record/instructions",s.autosaveConfigStore.save(o.globals.state.recordConfig);var e=this.getTarget(),t=e.getInfo(),t=(o.globals.logging.logEvent("Record Trace",`Record trace (${t.targetType})`),(0,d.genTraceConfig)(o.globals.state.recordConfig,t));this.tracingSessionWrapper=this.createTracingSessionWrapper(e),this.tracingSessionWrapper.start(t)}onCancel(){(0,a.assertTrue)(n.AUTH_P2<=this.state&&this.state<=n.RECORDING),this.getTracingSessionWrapper().cancel()}onStop(){(0,a.assertTrue)(n.AUTH_P2<=this.state&&this.state<=n.RECORDING),this.getTracingSessionWrapper().stop()}async fetchBufferUsage(){if((0,a.assertTrue)(this.state>=n.AUTH_P2),this.tracingSessionWrapper){var e=this.tracingSessionWrapper;try{var t=await e.getTraceBufferUsage();this.tracingSessionWrapper===e&&(this.bufferUsagePercentage=t)}catch(e){if(!(e instanceof f.RecordingError))throw e}i.raf.scheduleFullRedraw()}}initFactories(){(0,a.assertTrue)(this.state<=n.TARGET_INFO_DISPLAYED);for(const e of _.targetFactoryRegistry.listTargetFactories())e&&e.setOnTargetChange(this.onTargetChange.bind(this));_.targetFactoryRegistry.has(h.ANDROID_WEBSOCKET_TARGET_FACTORY)&&_.targetFactoryRegistry.get(h.ANDROID_WEBSOCKET_TARGET_FACTORY).tryEstablishWebsocket(t.DEFAULT_ADB_WEBSOCKET_URL),_.targetFactoryRegistry.has(m.HOST_OS_TARGET_FACTORY)&&_.targetFactoryRegistry.get(m.HOST_OS_TARGET_FACTORY).tryEstablishWebsocket(t.DEFAULT_TRACED_WEBSOCKET_URL)}shouldShowTargetSelection(){return n.NO_TARGET<=this.state&&this.state<n.RECORDING}shouldShowStopCancelButtons(){return n.AUTH_P2<=this.state&&this.state<=n.RECORDING}onTargetChange(){var e=_.targetFactoryRegistry.listTargets();this.target&&e.includes(this.target)?i.raf.scheduleFullRedraw():this.selectTarget()}createTracingSessionWrapper(e){return new y(e,this)}clearRecordingState(){this.bufferUsagePercentage=0,this.tracingSessionWrapper=void 0,this.setState(n.TARGET_INFO_DISPLAYED),o.globals.dispatch(c.Actions.setRecordingStatus({status:void 0})),i.raf.scheduleFullRedraw()}setState(e){this.state=e,this.stateGeneration+=1}getTarget(){return(0,a.assertTrue)(n.TARGET_INFO_DISPLAYED===this.state),(0,a.assertExists)(this.target)}getTracingSessionWrapper(){return(0,a.assertTrue)(n.ASK_TO_FORCE_P2<=this.state&&this.state<=n.RECORDING),(0,a.assertExists)(this.tracingSessionWrapper)}}}return nC}(),s=b_(),l=uv(),E=ie(),c=oe();var t=c1();const S=da(),A=eC(),n=TO(),O=EO(),C=OO(),k=wO(),w=DO(),R=XO(),I=FO(),M=jO(),P=VO(),N=$O(),D=YO(),x=iC(),i=_C(),o=kT(),u="Start Recording",L=new v.RecordingPageController,d=new e.RecordingConfigUtils;function _(){var e=L.getState()>=v.RecordingState.RECORDING?void 0:(0,T.default)(".target",(0,T.default)(".chip",{onclick:()=>(0,i.showAddNewTargetModal)(L)},(0,T.default)("button","Add new recording target"),(0,T.default)("i.material-icons","add")),a()),t=function(){var e=c.globals.state.recordingStatus;if(e)return(0,T.default)("label",e)}(),r=function(){if(L.getState()!==v.RecordingState.TARGET_INFO_DISPLAYED||!L.canCreateTracingSession())return;var e=(0,b.assertExists)(L.getTargetInfo()),e=d.fetchLatestRecordCommand(c.globals.state.recordConfig,e).hasDataSources;if(e)return(0,T.default)(".button",(0,T.default)("button",{class:"selected",onclick:()=>L.onStartRecordingPressed()},u))}(),n=function(){if(L.getState()!==v.RecordingState.TARGET_INFO_DISPLAYED)return;const e=(0,b.assertExists)(L.getTargetInfo()),t=[],r=(0,T.default)("span",`Some probes are only supported in Perfetto versions running
      on Android Q+. Therefore, Perfetto will sideload the latest version onto
      the device.`),n=(0,T.default)("span",`Perfetto is not supported natively before Android P. Therefore, Perfetto
       will sideload the latest version onto the device.`),a=(0,T.default)(".note","Use this ",(0,T.default)("a",{href:"https://perfetto.dev/docs/quickstart/linux-tracing",target:"_blank"},"quickstart guide")," to get started with tracing on Linux."),i=(0,T.default)(".note",`Recording in long trace mode through the UI is not supported. Please copy
    the command and `,(0,T.default)("a",{href:"https://perfetto.dev/docs/quickstart/android-tracing#perfetto-cmdline",target:"_blank"},"collect the trace using ADB."));d.fetchLatestRecordCommand(c.globals.state.recordConfig,e).hasDataSources||t.push((0,T.default)(".note","It looks like you didn't add any probes. Please add at least one to get a non-empty trace."));switch(l.targetFactoryRegistry.listRecordingProblems().map(e=>{e.includes(s.EXTENSION_URL)&&(e=e.split(s.EXTENSION_URL),t.push((0,T.default)(".note",e[0],(0,T.default)("a",{href:s.EXTENSION_URL,target:"_blank"},s.EXTENSION_NAME),e[1])))}),e.targetType){case"LINUX":t.push(a);break;case"ANDROID":var o=e.androidApiLevel;28===o?t.push((0,T.default)(".note",r)):o&&o<=27&&t.push((0,T.default)(".note",n))}"LONG_TRACE"===c.globals.state.recordConfig.mode&&t.unshift(i);return 0<t.length?(0,T.default)("div",t):void 0}();if(e||t||r||n)return(0,T.default)(".record-header",(0,T.default)(".top-part",(0,T.default)(".target-and-status",e,t),r),n)}function a(){if(L.shouldShowTargetSelection()){var r=l.targetFactoryRegistry.listTargets(),n=[],a=L.getTargetInfo();a||n.push((0,T.default)("option","PLEASE_SELECT_TARGET"));let t=0;for(let e=0;e<r.length;e++){var i=r[e].getInfo().name;n.push((0,T.default)("option",i)),a&&i===a.name&&(t=e)}return(0,T.default)("label","Target platform:",(0,T.default)("select",{selectedIndex:t,onchange:e=>{L.onTargetSelection(e.target.value)},onupdate:e=>{e.dom.selectedIndex=t}},...n))}}function y(e){var t;if(!(L.getState()<v.RecordingState.TARGET_SELECTED))return t=(0,b.assertExists)(L.getTargetInfo()),(0,T.default)(".record-section.instructions"+e,(0,T.default)("header","Recording command"),A.PERSIST_CONFIG_FLAG.get()?(0,T.default)("button.permalinkconfig",{onclick:()=>(0,o.createPermalink)({mode:"RECORDING_OPTS"})},"Share recording settings"):null,function(e){if(["CHROME","CHROME_OS","WINDOWS"].includes(e.targetType))return L.getState()>v.RecordingState.AUTH_P2?void 0:(0,T.default)("div",(0,T.default)("label",`To trace Chrome from the Perfetto UI you just have to press
         '${u}'.`));return(0,T.default)(n.CodeSnippet,{text:function(e){var t=d.fetchLatestRecordCommand(c.globals.state.recordConfig,e),r=t?.configProtoBase64??"",t=t?.configProtoText??"";let n="";n="ANDROID"===e.targetType&&28===e.androidApiLevel?(n+=`echo '${r}' | 
`)+'base64 --decode | \nadb shell "perfetto -c - -o /data/misc/perfetto-traces/trace"\n':(n=(n=n+("ANDROID"===e.targetType?"adb shell perfetto \\\n":"perfetto \\\n")+"  -c - --txt \\\n")+"  -o /data/misc/perfetto-traces/trace \\\n<<EOF\n\n")+t+"\nEOF\n";return n}(e)})}(t),function(){if(L.getState()!==v.RecordingState.RECORDING)return;L.fetchBufferUsage();var e=L.getBufferUsagePercentage();return 0===e?void 0:(0,T.default)("label","Buffer usage: ",(0,T.default)("progress",{max:100,value:100*e}))}(),(0,T.default)(".buttons",function(){if(!L.shouldShowStopCancelButtons())return;var e=(0,T.default)("button.selected",{onclick:()=>L.onStop()},"Stop"),t=(0,T.default)("button",{onclick:()=>L.onCancel()},"Cancel");return[e,t]}()))}function r(t){var r=[_()];if(L.getState()===v.RecordingState.NO_TARGET)r.push((0,T.default)(".full-centered","Please connect a valid target."));else if(L.getState()<=v.RecordingState.ASK_TO_FORCE_P1)r.push((0,T.default)(".full-centered","Can not access the device without resetting the connection. Please refresh the page, then click "+`'${x.FORCE_RESET_MESSAGE}.'`));else if(L.getState()===v.RecordingState.AUTH_P1)r.push((0,T.default)(".full-centered","Please allow USB debugging on the device."));else if(L.getState()===v.RecordingState.WAITING_FOR_TRACE_DISPLAY)r.push((0,T.default)(".full-centered","Waiting for the trace to be collected."));else{var n,a,i,o,s,l,c,u,d,f,p,h,g,m=[];let e=t?t.substr(1):"";A.RECORDING_SECTIONS.includes(e)||(e="buffers"),m.push((t=e,n=(0,T.default)('a[href="#!/record/chrome"]',(0,T.default)("li"+("chrome"===t?".active":""),(0,T.default)("i.material-icons","laptop_chromebook"),(0,T.default)(".title","Chrome"),(0,T.default)(".sub","Chrome traces"))),a=(0,T.default)('a[href="#!/record/cpu"]',(0,T.default)("li"+("cpu"===t?".active":""),(0,T.default)("i.material-icons","subtitles"),(0,T.default)(".title","CPU"),(0,T.default)(".sub","CPU usage, scheduling, wakeups"))),i=(0,T.default)('a[href="#!/record/gpu"]',(0,T.default)("li"+("gpu"===t?".active":""),(0,T.default)("i.material-icons","aspect_ratio"),(0,T.default)(".title","GPU"),(0,T.default)(".sub","GPU frequency, memory"))),o=(0,T.default)('a[href="#!/record/power"]',(0,T.default)("li"+("power"===t?".active":""),(0,T.default)("i.material-icons","battery_charging_full"),(0,T.default)(".title","Power"),(0,T.default)(".sub","Battery and other energy counters"))),s=(0,T.default)('a[href="#!/record/memory"]',(0,T.default)("li"+("memory"===t?".active":""),(0,T.default)("i.material-icons","memory"),(0,T.default)(".title","Memory"),(0,T.default)(".sub","Physical mem, VM, LMK"))),l=(0,T.default)('a[href="#!/record/android"]',(0,T.default)("li"+("android"===t?".active":""),(0,T.default)("i.material-icons","android"),(0,T.default)(".title","Android apps & svcs"),(0,T.default)(".sub","atrace and logcat"))),c=(0,T.default)('a[href="#!/record/advanced"]',(0,T.default)("li"+("advanced"===t?".active":""),(0,T.default)("i.material-icons","settings"),(0,T.default)(".title","Advanced settings"),(0,T.default)(".sub","Complicated stuff for wizards"))),u=(0,T.default)('a[href="#!/record/tracePerf"]',(0,T.default)("li"+("tracePerf"===t?".active":""),(0,T.default)("i.material-icons","full_stacked_bar_chart"),(0,T.default)(".title","Stack Samples"),(0,T.default)(".sub","Lightweight stack polling"))),d=(0,T.default)('a[href="#!/record/etw"]',(0,T.default)("li"+("etw"===t?".active":""),(0,T.default)("i.material-icons","subtitles"),(0,T.default)(".title","ETW Tracing Config"),(0,T.default)(".sub","Context switch, Thread state"))),f=(0,b.assertExists)(L.getTargetInfo()).targetType,p=[],"LINUX"===f?p.push(a,o,s,n,c):"WINDOWS"===f?p.push(n,d):"CHROME"===f?p.push(n):p.push(a,i,o,s,l,n,u,c),(0,T.default)(".record-menu",{class:L.getState()>v.RecordingState.TARGET_INFO_DISPLAYED?"disabled":"",onclick:()=>E.raf.scheduleFullRedraw()},(0,T.default)("header","Trace config"),(0,T.default)("ul",(0,T.default)('a[href="#!/record/buffers"]',(0,T.default)("li"+("buffers"===t?".active":""),(0,T.default)("i.material-icons","tune"),(0,T.default)(".title","Recording settings"),(0,T.default)(".sub","Buffer mode, size and duration"))),(0,T.default)('a[href="#!/record/instructions"]',(0,T.default)("li"+("instructions"===t?".active":""),(0,T.default)("i.material-icons-filled.rec","fiber_manual_record"),(0,T.default)(".title","Recording command"),(0,T.default)(".sub","Manually record trace"))),A.PERSIST_CONFIG_FLAG.get()?(0,T.default)('a[href="#!/record/config"]',{onclick:()=>{S.recordConfigStore.reloadFromLocalStorage()}},(0,T.default)("li"+("config"===t?".active":""),(0,T.default)("i.material-icons","save"),(0,T.default)(".title","Saved configs"),(0,T.default)(".sub","Manage local configs"))):null),(0,T.default)("header","Probes"),(0,T.default)("ul",p)))),m.push((0,T.default)(D.RecordingSettings,{dataSources:[],cssClass:(0,A.maybeGetActiveCss)(e,"buffers")})),m.push(y((0,A.maybeGetActiveCss)(e,"instructions"))),m.push((0,A.Configurations)((0,A.maybeGetActiveCss)(e,"config")));for([h,g]of new Map([["cpu",w.CpuSettings],["gpu",I.GpuSettings],["power",N.PowerSettings],["memory",P.MemorySettings],["android",C.AndroidSettings],["chrome",k.ChromeSettings],["tracePerf",M.LinuxPerfSettings],["advanced",O.AdvancedSettings],["etw",R.EtwSettings]]).entries())m.push((0,T.default)(g,{dataSources:L.getTargetInfo()?.dataSources||[],cssClass:(0,A.maybeGetActiveCss)(e,h)}));r.push((0,T.default)(".record-container-content",m))}return(0,T.default)(".record-container",r)}rC.RecordPageV2=(0,t.createPage)({oninit(){L.initFactories()},view({attrs:e}){return(0,T.default)(".record-page",L.getState()>v.RecordingState.TARGET_INFO_DISPLAYED?(0,T.default)(".hider"):[],r(e.subpage))}})}return rC}var TC,bC={};function vC(){if(!TC){TC=1,Object.defineProperty(bC,"__esModule",{value:!0}),bC.CheckHttpRpcConnection=async function(){var e=await p.HttpRpcEngine.checkConnection();if((0,_.publishHttpRpcState)(e),e.connected){var t=(0,u.assertExists)(e.status);if(""!==t.versionCode&&t.versionCode!==f.VERSION){e=await g.Router.isVersionAvailable(t.versionCode);if(void 0!==e){var r=await async function(e,t){let r=o.Dismissed;return await(0,h.showModal)({title:"Version mismatch",content:(0,c.default)(".modal-pre",function(e){return`The trace processor instance on ${p.HttpRpcEngine.hostAndPort} is a different build from the UI.

This may cause problems. Where possible it is better to use the matched version of the UI.
You can do this by clicking the button below.

UI version code: ${f.VERSION}
UI RPC API: ${y}

Trace processor version: ${e.humanReadableVersion}
Trace processor version code: ${e.versionCode}
Trace processor RPC API: ${e.apiVersion}
`}(e)),buttons:[{primary:!0,text:"Open "+t,action:()=>{r=o.UseMatchingUi}},{text:"Use builtin Wasm",action:()=>{r=o.UseWasm}},{text:"Use mismatched version regardless (might crash)",action:()=>{r=o.UseMismatchedRpc}}]}),r}(t,e);switch(r){case o.Dismissed:case o.UseMatchingUi:return void g.Router.navigateToVersion(t.versionCode);case o.UseMismatchedRpc:break;case o.UseWasm:return void i();default:throw new Error("Unsupported result "+r)}}}if(t.apiVersion<y){var n=await async function(e){let t=s.Dismissed;return await(0,h.showModal)({title:"Incompatible RPC version",content:(0,c.default)(".modal-pre",function(e){return`The Trace Processor instance on ${p.HttpRpcEngine.hostAndPort} is too old.

This UI requires TraceProcessor features that are not present in the
Trace Processor native accelerator you are currently running.
If you continue, this is almost surely going to cause UI failures.

Please update your local Trace Processor binary:

curl -LO https://get.perfetto.dev/trace_processor
chmod +x ./trace_processor
./trace_processor --httpd

UI version code: ${f.VERSION}
UI RPC API: ${y}

Trace processor version: ${e.humanReadableVersion}
Trace processor version code: ${e.versionCode}
Trace processor RPC API: ${e.apiVersion}
`}(e)),buttons:[{text:"Use builtin Wasm",primary:!0,action:()=>{t=s.UseWasm}},{text:"Use old version regardless (will crash)",action:()=>{t=s.UseIncompatibleRpc}}]}),t}(t);switch(n){case s.Dismissed:case s.UseWasm:return void i();case s.UseIncompatibleRpc:break;default:throw new Error("Unsupported result "+n)}}if(t.loadedTraceName){var a=await async function(e){let t=l.Dismissed;return await(0,h.showModal)({title:"Use trace processor native acceleration?",content:(0,c.default)(".modal-pre",function(e){return`Trace Processor Native Accelerator detected on ${p.HttpRpcEngine.hostAndPort} with:
${e.loadedTraceName}

YES, use loaded trace:
Will load from the current state of Trace Processor. If you did run
trace_processor_shell --httpd file.pftrace this is likely what you want.

YES, but reset state:
Use this if you want to open another trace but still use the
accelerator. This is the equivalent of killing and restarting
trace_processor_shell --httpd.

NO, Use builtin WASM:
Will not use the accelerator in this tab.

Using the native accelerator has some minor caveats:
- Only one tab can be using the accelerator.
- Sharing, downloading and conversion-to-legacy aren't supported.
`}(e)),buttons:[{text:"YES, use loaded trace",primary:!0,action:()=>{t=l.UseRpcWithPreloadedTrace}},{text:"YES, but reset state",action:()=>{t=l.UseRpc}},{text:"NO, Use builtin WASM",action:()=>{t=l.UseWasm}}]}),t}(t);switch(a){case l.Dismissed:case l.UseRpcWithPreloadedTrace:return void m.globals.dispatch(d.Actions.openTraceFromHttpRpc({}));case l.UseRpc:return;case l.UseWasm:return void i();default:throw new Error("Unsupported result "+a)}}function i(){m.globals.dispatch(d.Actions.setNewEngineMode({mode:"FORCE_BUILTIN_WASM"}))}}};const c=or.__importDefault(ae()),u=ee(),d=ne(),f=Nr();var o,s,l,e=Sa();const p=KE(),h=de(),g=So(),m=oe(),_=CT(),y=e.TraceProcessorApiVersion.TRACE_PROCESSOR_CURRENT_API_VERSION;(e=o=o||{}).UseMatchingUi="useMatchingUi",e.UseWasm="useWasm",e.UseMismatchedRpc="useMismatchedRpc",e.Dismissed="dismissed",(e=s=s||{}).UseWasm="useWasm",e.UseIncompatibleRpc="useIncompatibleRpc",e.Dismissed="dismissed",(e=l=l||{}).UseRpcWithPreloadedTrace="useRpcWithPreloadedTrace",e.UseRpc="useRpc",e.UseWasm="useWasm",e.Dismissed="dismissed"}return bC}var EC,SC={};var AC,OC,CC={},kC={};function wC(){if(!AC){AC=1,Object.defineProperty(kC,"__esModule",{value:!0}),kC.loadAndroidBugToolInfo=function(){const r=(0,t.defer)();return chrome.runtime.sendMessage(a,{action:n.CONVERT_OBJECT_URL},async e=>{if(e.action!==n.CONVERT_OBJECT_URL_RESPONSE)throw new Error(`Received unhandled response code (${e.action}) from extension.`);if(!(0<e.attachments?.length))throw new Error("Got no attachements from extension");var t=e.attachments.map(async e=>{var t=await(await fetch(e.objectUrl)).blob();return new File([t],e.name)}),t=await Promise.all(t);r.resolve({issueId:e.issueId,issueTitle:e.issueTitle,file:t[0]})}),r};const t=Wa();var n,e;(e=n=n||{})[e.UNKNOWN=0]="UNKNOWN",e[e.CONVERT_OBJECT_URL=1]="CONVERT_OBJECT_URL",e[e.CONVERT_OBJECT_URL_RESPONSE=2]="CONVERT_OBJECT_URL_RESPONSE";const a="mbbaofdfoekifkfpgehgffcpagbbjkmj"}return kC}function RC(){if(!OC){OC=1,Object.defineProperty(CC,"__esModule",{value:!0}),CC.maybeOpenTraceFromRoute=function(e){if(e.args.s)(0,l.loadPermalink)(e.args.s);else if((t=e.args.url)&&t!==function(){var e=u.globals.getCurrentEngine()?.source;if(e&&"URL"===e.type)return e.url;return}()){var t,r=["127.0.0.1","localhost"].includes(new URL(t).hostname);if(r){const n=t.split("/").pop()??"local_trace.pftrace";r=fetch(t).then(e=>e.blob()).then(e=>{u.globals.dispatch(i.Actions.openTraceFromFile({file:new File([e],n)}))}).catch(e=>alert("Could not load local trace "+e));f.taskTracker.trackPromise(r,"Downloading local trace")}else u.globals.dispatch(i.Actions.openTraceFromUrl({url:t}))}else e.args.openFromAndroidBugTool?(u.globals.dispatch(i.Actions.updateStatus({msg:"Loading trace from ABT extension",timestamp:Date.now()/1e3})),r=(0,c.loadAndroidBugToolInfo)(),f.taskTracker.trackPromise(r,"Loading trace from ABT extension"),r.then(e=>{u.globals.dispatch(i.Actions.openTraceFromFile({file:e.file}))}).catch(e=>{console.error(e)})):e.args.p&&"/record"===e.page?d.Router.navigate("#!/record/"+e.args.p):e.args.local_cache_key?async function(t){if(t!==u.globals.state.traceUuid&&""!==t){if(void 0!==u.globals.state.engine){var r=u.globals.state.engine;if("ARRAY_BUFFER"===r.source.type&&r.source.uuid===t)return}const n=await(0,o.tryGetTrace)(t);r=()=>{d.Router.navigate("#!/viewer?local_cache_key="+(u.globals.state.traceUuid??""))};if(n)if(void 0===u.globals.state.traceUuid)u.globals.dispatch(i.Actions.openTraceFromBuffer(n));else{let e=!1;await(0,s.showModal)({title:"You are about to load a different trace and reset the UI state",content:(0,a.default)("div",(0,a.default)("p","You are seeing this because you either pasted a URL with a different ?local_cache_key=xxx argument or because you hit the history back/fwd button and reached a different trace."),(0,a.default)("p","If you continue another trace will be loaded and the UI state will be cleared."),(0,a.default)("pre",`Old trace: ${u.globals.state.traceUuid||"<no trace>"}
`+"New trace: "+t)),buttons:[{text:"Continue",id:"trace_id_open",primary:!0,action:()=>{e=!0,u.globals.dispatch(i.Actions.openTraceFromBuffer(n))}},{text:"Cancel"}]}),e||r()}else(0,s.showModal)({title:"Could not find the trace in the cache storage",content:(0,a.default)("div",(0,a.default)("p","You are trying to load a cached trace by setting the ?local_cache_key argument in the URL."),(0,a.default)("p","Unfortunately the trace wasn't in the cache storage."),(0,a.default)("p","This can happen if a tab was discarded and wasn't opened for too long, or if you just mis-pasted the URL."),(0,a.default)("pre","Trace UUID: "+t))}),r()}}(e.args.local_cache_key):e.page||fetch("/vizviewer_info").then(e=>200==e.status?"http://"+window.location.host:"http://127.0.0.1:9001").catch(e=>{console.log(e)}).then(t=>{fetch(t+"/file_info").then(e=>e.json()).then(e=>{u.globals.sourceFileStorage=e,u.globals.dispatch(i.Actions.openTraceFromUrl({url:t+"/localtrace"}))}).catch(e=>{console.log(e)})})};const a=or.__importDefault(ae()),i=ne(),o=jE(),s=de(),l=kT(),c=wC(),u=oe(),d=So(),f=kA()}return CC}var IC,MC,PC={},NC={},DC={},xC={};function LC(){if(!IC){IC=1,Object.defineProperty(xC,"__esModule",{value:!0}),xC.DragStrategy=void 0;const r=Mo(),n=ie(),a=oe();xC.DragStrategy=class{map;constructor(e){this.map=e}updateGlobals(e,t){t=new r.HighPrecisionTimeSpan(e,t.sub(e).toNumber());a.globals.timeline.updateVisibleTimeHP(t),n.raf.scheduleRedraw()}}}return xC}var FC,UC={};var BC,jC,HC={};function GC(){if(!jC){jC=1,Object.defineProperty(NC,"__esModule",{value:!0}),NC.OverviewTimelinePanel=void 0;const e=or.__importDefault(ae()),S=K(),A=M(),O=Fa(),C=uA(),r=function(){if(!MC){MC=1,Object.defineProperty(DC,"__esModule",{value:!0}),DC.BorderDragStrategy=void 0;class e extends LC().DragStrategy{pixelBounds;moveStart=!1;constructor(e,t){super(e),this.pixelBounds=t}onDrag(e){var t=this.moveStart?e:this.pixelBounds[0],e=this.moveStart?this.pixelBounds[1]:e,r=this.map.pxToHpTime(Math.min(t,e)),n=this.map.pxToHpTime(Math.max(t,e));e<t&&(this.moveStart=!this.moveStart),super.updateGlobals(r,n),this.pixelBounds=[this.map.hpTimeToPx(r),this.map.hpTimeToPx(n)]}onDragStart(e){this.moveStart=Math.abs(e-this.pixelBounds[0])<Math.abs(e-this.pixelBounds[1])}}DC.BorderDragStrategy=e}return DC}(),n=function(){if(!FC){FC=1,Object.defineProperty(UC,"__esModule",{value:!0}),UC.InnerDragStrategy=void 0;class e extends LC().DragStrategy{pixelBounds;dragStartPx=0;constructor(e,t){super(e),this.pixelBounds=t}onDrag(e){var e=e-this.dragStartPx,t=this.map.pxToHpTime(this.pixelBounds[0]+e),e=this.map.pxToHpTime(this.pixelBounds[1]+e);super.updateGlobals(t,e)}onDragStart(e){this.dragStartPx=e}}UC.InnerDragStrategy=e}return UC}(),a=function(){if(!BC){BC=1,Object.defineProperty(HC,"__esModule",{value:!0}),HC.OuterDragStrategy=void 0;class e extends LC().DragStrategy{dragStartPx=0;onDrag(e){var t=this.map.pxToHpTime(Math.min(e,this.dragStartPx)),e=this.map.pxToHpTime(Math.max(e,this.dragStartPx));super.updateGlobals(t,e)}onDragStart(e){this.dragStartPx=e}}HC.OuterDragStrategy=e}return HC}(),i=nT(),k=oe(),w=gA(),o=Yo(),s=Mo();class R{static HANDLE_SIZE_PX=5;kind="panel";selectable=!1;width=0;gesture;timeScale;dragStrategy;boundOnMouseMove=this.onMouseMove.bind(this);onupdate({dom:e}){this.width=e.getBoundingClientRect().width;var t,r=k.globals.traceContext;this.width>C.TRACK_SHELL_WIDTH?(t=new o.PxSpan(C.TRACK_SHELL_WIDTH,this.width),r=s.HighPrecisionTimeSpan.fromTime(r.start,r.end),this.timeScale=new o.TimeScale(r,t),void 0===this.gesture&&(this.gesture=new i.DragGestureHandler(e,this.onDrag.bind(this),this.onDragStart.bind(this),this.onDragEnd.bind(this)))):this.timeScale=void 0}oncreate(e){this.onupdate(e),e.dom.addEventListener("mousemove",this.boundOnMouseMove)}onremove({dom:e}){this.gesture&&(this.gesture[Symbol.dispose](),this.gesture=void 0),e.removeEventListener("mousemove",this.boundOnMouseMove)}render(){return(0,e.default)(".overview-timeline",{oncreate:e=>this.oncreate(e),onupdate:e=>this.onupdate(e),onremove:e=>this.onremove(e)})}renderCanvas(r,e){if(void 0!==this.width&&void 0!==this.timeScale){var n=e.height-20,t=new S.TimeSpan(k.globals.traceContext.start,k.globals.traceContext.end);if(e.width>C.TRACK_SHELL_WIDTH&&0n<t.duration){var a,i,o=(0,w.getMaxMajorTicks)(this.width-C.TRACK_SHELL_WIDTH),s=k.globals.timestampOffset(),t=(0,w.generateTicks)(t,o,s);r.font="10px Roboto Condensed",r.fillStyle="#999";for({type:a,time:i}of t){var l=Math.floor(this.timeScale.timeToPx(i));if(!(l<=0)){if(l>this.width)break;if(a===w.TickType.MAJOR){r.fillRect(l-1,0,1,15);var c=k.globals.toDomainTime(i),u=(g=h=p=f=d=u=void 0,r),d=c,f=l+5,p=18,h=w.MIN_PX_PER_STEP,g=(0,O.timestampFormat)();switch(g){case O.TimestampFormat.UTC:case O.TimestampFormat.TraceTz:case O.TimestampFormat.Timecode:!function(e,t,r,n,a){t=S.Time.toTimecode(t),t=t.dhhmmss;e.fillText(t,r,n,a)}(u,d,f,p,h);break;case O.TimestampFormat.Raw:u.fillText(d.toString(),f,p,h);break;case O.TimestampFormat.RawLocale:u.fillText(d.toLocaleString(),f,p,h);break;case O.TimestampFormat.Seconds:u.fillText(S.Time.formatSeconds(d),f,p,h);break;default:throw new Error("Invalid timestamp "+g)}}else a==w.TickType.MEDIUM?r.fillRect(l-1,0,1,8):a==w.TickType.MINOR&&r.fillRect(l-1,0,1,5)}}}if(0<k.globals.overviewStore.size){let t=0;var m=(n-1)/k.globals.overviewStore.size;for(const E of k.globals.overviewStore.keys()){var _=k.globals.overviewStore.get(E);for(let e=0;e<_.length;e++){var y=Math.floor(this.timeScale.timeToPx(_[e].start)),T=Math.ceil(this.timeScale.timeToPx(_[e].end)),b=Math.floor(20+t*m),v=Math.ceil(100*(1-.7*_[e].load)),v=(0,A.colorForCpu)(t).setHSL({s:50,l:v});r.fillStyle=v.cssString,r.fillRect(y,b,T-y,Math.ceil(m))}t++}}r.fillStyle="#dadada",r.fillRect(0,e.height-1,this.width,1);var[o,s]=R.extractBounds(this.timeScale),t=(r.fillStyle=C.OVERVIEW_TIMELINE_NON_VISIBLE_COLOR,r.fillRect(C.TRACK_SHELL_WIDTH-1,20,o-C.TRACK_SHELL_WIDTH,n),r.fillRect(s,20,this.width-s,n),r.fillStyle="#999",r.fillRect(o-1,20,1,n),r.fillRect(s,20,1,n),R.HANDLE_SIZE_PX),e=.4*n;r.fillRect(o-Math.floor(t/2)-1,20,t,e),r.fillRect(s-Math.floor(t/2),20,t,e)}}onMouseMove(e){void 0===this.gesture||this.gesture.isDragging||(e.target.style.cursor=this.chooseCursor(e.offsetX))}chooseCursor(e){var t,r;return void 0===this.timeScale?"default":([t,r]=R.extractBounds(this.timeScale),R.inBorderRange(e,t)||R.inBorderRange(e,r)?"ew-resize":e<C.TRACK_SHELL_WIDTH?"default":e<t||r<e?"crosshair":"all-scroll")}onDrag(e){void 0!==this.dragStrategy&&this.dragStrategy.onDrag(e)}onDragStart(e){var t;void 0!==this.timeScale&&(t=R.extractBounds(this.timeScale),R.inBorderRange(e,t[0])||R.inBorderRange(e,t[1])?this.dragStrategy=new r.BorderDragStrategy(this.timeScale,t):e<t[0]||t[1]<e?this.dragStrategy=new a.OuterDragStrategy(this.timeScale):this.dragStrategy=new n.InnerDragStrategy(this.timeScale,t),this.dragStrategy.onDragStart(e))}onDragEnd(){this.dragStrategy=void 0}static extractBounds(e){var t=k.globals.timeline.visibleWindow;return[Math.floor(e.hpTimeToPx(t.start)),Math.ceil(e.hpTimeToPx(t.end))]}static inBorderRange(e,t){return Math.abs(e-t)<this.HANDLE_SIZE_PX/2}}NC.OverviewTimelinePanel=R}return NC}var VC,WC={},qC={};function $C(){if(!VC){VC=1,Object.defineProperty(qC,"__esModule",{value:!0}),qC.FlowEventsRenderer=qC.FlowEventsRendererArgs=void 0;const i=z(),o=FA(),f=oe(),e=Yo();qC.FlowEventsRendererArgs=class{trackIdToTrackPanel;groupIdToTrackGroupPanel;constructor(){this.trackIdToTrackPanel=new Map,this.groupIdToTrackGroupPanel=new Map}registerPanel(e,t,r){if((0,i.exists)(e.trackKey)){var n=f.globals.state.tracks[e.trackKey];for(const a of(n=n,f.globals.trackManager.resolveTrackInfo(n.uri)?.tags?.trackIds??[]))this.trackIdToTrackPanel.set(a,{panel:e,yStart:t})}else(0,i.exists)(e.groupKey)&&this.groupIdToTrackGroupPanel.set(e.groupKey,{panel:e,yStart:t,height:r})}};qC.FlowEventsRenderer=class{getTrackGroupIdByTrackId(e){e=f.globals.trackManager.trackKeyByTrackId.get(e);return e?f.globals.state.tracks[e].trackGroup:void 0}getTrackGroupYCoordinate(e,t){t=this.getTrackGroupIdByTrackId(t);if(t){e=e.groupIdToTrackGroupPanel.get(t);if(e)return e.yStart+e.height-5}}getTrackYCoordinate(e,t){return e.trackIdToTrackPanel.get(t)?.yStart}getYConnection(e,t,r,n){if(!n){const a=this.getTrackGroupYCoordinate(e,t);return void 0===a?void 0:{y:a,connection:"TRACK_GROUP"}}const a=(this.getTrackYCoordinate(e,t)??0)+n.top+.5*n.height;return{y:Math.min(Math.max(0,a),r),connection:"TRACK"}}getSliceRect(e,t){e=e.trackIdToTrackPanel.get(t.trackId)?.panel;if(e)return e.getSliceRect?.(t.sliceStartTs,t.sliceEndTs,t.depth)}render(r,n,a){const i=new e.TimeScale(f.globals.timeline.visibleWindow,new e.PxSpan(0,a.width));f.globals.connectedFlows.forEach(e=>{this.drawFlow(r,i,a,n,e,10)}),f.globals.selectedFlows.forEach(e=>{for(const t of(0,o.getFlowCategories)(e))if(f.globals.visibleFlowCategories.get(t)||f.globals.visibleFlowCategories.get(o.ALL_CATEGORIES)){this.drawFlow(r,i,a,n,e,230);break}})}drawFlow(a,i,o,s,l,c){var u=this.getSliceRect(s,l.begin),d=this.getSliceRect(s,l.end),u=this.getYConnection(s,l.begin.trackId,o.height,u),s=this.getYConnection(s,l.end.trackId,o.height,d);if(u&&s){let e="LEFT",t="RIGHT";"TRACK_GROUP"===u.connection&&(e=u.y>s.y?"DOWN":"UP"),"TRACK_GROUP"===s.connection&&(t=s.y>u.y?"DOWN":"UP");o={x:i.timeToPx(l.flowToDescendant||l.begin.sliceStartTs>=l.end.sliceStartTs?l.begin.sliceStartTs:l.begin.sliceEndTs),y:u.y,dir:e},d={x:i.timeToPx(l.end.sliceStartTs),y:s.y,dir:t},u=l.end.sliceId===f.globals.state.highlightedSliceId||l.begin.sliceId===f.globals.state.highlightedSliceId;let r=70,n=2;(l.id===f.globals.state.focusedFlowIdLeft||l.id===f.globals.state.focusedFlowIdRight)&&(r=55,n=3),u&&(r=45),this.drawFlowArrow(a,o,d,c,r,n)}}getDeltaX(e,t){switch(e){case"LEFT":return-t;case"RIGHT":return t;default:return 0}}getDeltaY(e,t){switch(e){case"LEFT":case"RIGHT":return 0;case"UP":return-t;case"DOWN":return t;default:return 0}}drawFlowArrow(e,t,r,n,a,i){var o=15<Math.abs(t.x-r.x),s="RIGHT"!==r.dir&&"LEFT"!==r.dir||!o?0:5,n=`hsl(${n}, 50%, ${a}%)`;e.strokeStyle=n,e.lineWidth=i,e.beginPath(),e.moveTo(t.x,t.y),e.bezierCurveTo(t.x-this.getDeltaX(t.dir,30),t.y-this.getDeltaY(t.dir,30),r.x-this.getDeltaX(r.dir,30+s),r.y-this.getDeltaY(r.dir,30+s),r.x-this.getDeltaX(r.dir,s),r.y-this.getDeltaY(r.dir,s)),e.stroke(),"RIGHT"!==t.dir&&"LEFT"!==t.dir&&(e.fillStyle=n,e.beginPath(),e.arc(t.x,t.y,3,0,2*Math.PI),e.closePath(),e.fill()),"RIGHT"!==r.dir&&"LEFT"!==r.dir?(e.fillStyle=n,e.beginPath(),e.arc(r.x,r.y,3,0,2*Math.PI),e.closePath(),e.fill()):o&&this.drawArrowHead(r,e,n)}drawArrowHead(e,t,r){var n=this.getDeltaX(e.dir,5),a=this.getDeltaY(e.dir,5);t.fillStyle=r,t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(e.x-n-a,e.y+n-a),t.lineTo(e.x-n+a,e.y-n-a),t.closePath(),t.fill()}}}return qC}var zC,KC,YC={};function JC(){if(!KC){KC=1,Object.defineProperty(WC,"__esModule",{value:!0}),WC.PanelContainer=void 0;const n=or.__importDefault(ae()),o=hl(),s=ee(),f=uo(),t=ie(),l=Dd(),p=Rs(),h=uA(),g=$C(),c=oe(),u=function(){if(!zC){zC=1,Object.defineProperty(YC,"__esModule",{value:!0}),YC.VirtualCanvas=void 0;var e=V();const c=ig();class t{_trash=new e.DisposableStack;_canvasElement;_targetElement;_canvasRect;_layoutShiftListener;_canvasResizeListener;constructor(r,n,e){const{overdrawPx:a=100,avoidOverflowingContainer:i}=e??{},o=()=>{var e=n.getBoundingClientRect(),t=r.getBoundingClientRect(),e=(0,c.intersectRects)(e,t),e=(0,c.expandRect)(e,a),e=i?(0,c.intersectRects)(e,t):e;return(0,c.rebaseRect)(e,t.x,t.y)},t=()=>{let e=!1;var t=o(),r=(0,c.rectSize)(t),n=this._canvasRect,a=(0,c.rectSize)(n);this._canvasRect=t,a.width===r.width&&a.height===r.height||(l.style.width=r.width+"px",l.style.height=r.height+"px",this._canvasResizeListener?.(l,r.width,r.height),e=!0),n.left===t.left&&n.top===t.top||(l.style.transform=`translate(${t.left}px, ${t.top}px)`,e=!0),e&&this._layoutShiftListener?.(l,t)},s=(n.addEventListener("scroll",t,{passive:!0}),this._trash.defer(()=>n.removeEventListener("scroll",t)),new ResizeObserver(()=>{t()})),l=(s.observe(n),s.observe(r),this._trash.defer(()=>{s.disconnect()}),r.style.overflow="hidden",document.createElement("canvas"));l.style.position="absolute",r.appendChild(l),this._trash.defer(()=>{r.removeChild(l)}),this._canvasElement=l,this._targetElement=r,this._canvasRect={left:0,top:0,bottom:0,right:0}}setLayoutShiftListener(e){this._layoutShiftListener=e}setCanvasResizeListener(e){this._canvasResizeListener=e}get canvasElement(){return this._canvasElement}get targetElement(){return this._targetElement}get size(){return{width:this._targetElement.clientWidth,height:this._targetElement.clientHeight}}get canvasRect(){return this._canvasRect}get canvasSize(){return(0,c.rectSize)(this._canvasRect)}[Symbol.dispose](){this._trash.dispose()}overlapsCanvas(e){var t=this._canvasRect,r=e.top<t.bottom&&e.bottom>t.top;return e.left<t.right&&e.right>t.left&&r}}YC.VirtualCanvas=t}return YC}();var e=V();const d=Yo();WC.PanelContainer=class{panelContainerTop=0;panelContainerHeight=0;panelById=new Map;panelInfos=[];panelPerfStats=new WeakMap;perfStats={totalPanels:0,panelsOnCanvas:0,renderStats:new f.RunningStatistics(10)};ctx;trash=new e.DisposableStack;OVERLAY_REF="overlay";PANEL_STACK_REF="panel-stack";getPanelsInRegion(e,t,r,n){var a=Math.min(e,t),i=Math.max(e,t),o=Math.min(r,n),s=Math.max(r,n),l=[];for(let e=0;e<this.panelInfos.length;e++){var c=this.panelInfos[e],u=c.clientX-h.TRACK_SHELL_WIDTH;u+c.width>=a&&u<=i&&c.clientY+c.height>=o&&c.clientY<=s&&c.panel.selectable&&l.push(c.panel)}return l}handleAreaSelection(){var e=c.globals.timeline.selectedArea;if(void 0!==e&&void 0!==c.globals.timeline.areaY.start&&void 0!==c.globals.timeline.areaY.end&&0!==this.panelInfos.length){var t=this.panelInfos[0].clientY,r=this.panelInfos[this.panelInfos.length-1].clientY+this.panelInfos[this.panelInfos.length-1].height;if(!(c.globals.timeline.areaY.start+h.TOPBAR_HEIGHT<t||c.globals.timeline.areaY.start+h.TOPBAR_HEIGHT>r)){var t=new d.TimeScale(c.globals.timeline.visibleWindow,new d.PxSpan(0,this.virtualCanvas.size.width-h.TRACK_SHELL_WIDTH)),n=[];for(const i of this.getPanelsInRegion(t.timeToPx(e.start),t.timeToPx(e.end),c.globals.timeline.areaY.start+h.TOPBAR_HEIGHT,c.globals.timeline.areaY.end+h.TOPBAR_HEIGHT))if(void 0!==i.trackKey)n.push(i.trackKey);else if(void 0!==i.groupKey){var a=c.globals.state.trackGroups[i.groupKey];if(a.collapsed){n.push(i.groupKey);for(const o of a.tracks)n.push(o)}}c.globals.timeline.selectArea(e.start,e.end,n)}}}constructor(){const e=()=>this.renderCanvas();t.raf.addRedrawCallback(e),this.trash.defer(()=>{t.raf.removeRedrawCallback(e)}),f.perfDisplay.addContainer(this),this.trash.defer(()=>{f.perfDisplay.removeContainer(this)})}virtualCanvas;oncreate(e){const{dom:t,attrs:r}=e;var n=(0,o.toHTMLElement)((0,s.assertExists)((0,o.findRef)(t,this.OVERLAY_REF))),n=new u.VirtualCanvas(n,t,{overdrawPx:100}),a=(this.trash.use(n),(this.virtualCanvas=n).canvasElement.getContext("2d"));if(!a)throw Error("Cannot create canvas context");this.ctx=a,n.setCanvasResizeListener((e,t,r)=>{var n=window.devicePixelRatio;e.width=t*n,e.height=r*n}),n.setLayoutShiftListener(()=>{this.renderCanvas()}),this.onupdate(e);const i=(0,o.toHTMLElement)((0,s.assertExists)((0,o.findRef)(t,this.PANEL_STACK_REF)));this.trash.use(new l.SimpleResizeObserver(i,()=>{r.onPanelStackResize?.(i.clientWidth,i.clientHeight)}))}onremove(){this.trash.dispose()}renderPanel(e,t,r=""){return(0,s.assertFalse)(this.panelById.has(t)),this.panelById.set(t,e),(0,n.default)(".pf-panel"+r,{"data-panel-id":t},e.render())}renderTree(e,r){return"group"===e.kind?(0,n.default)("div.pf-panel-group",this.renderPanel(e.header,r+"-header",e.collapsed?"":".pf-sticky"),...e.childPanels.map((e,t)=>this.renderTree(e,r+"-"+t))):this.renderPanel(e,r)}view({attrs:e}){this.panelById.clear();var t=e.panels.map((e,t)=>this.renderTree(e,""+t));return(0,n.default)(".pf-panel-container",{className:e.className},(0,n.default)(".pf-panel-stack",{ref:this.PANEL_STACK_REF},(0,n.default)(".pf-overlay",{ref:this.OVERLAY_REF}),t))}onupdate({dom:e}){this.readPanelRectsFromDom(e)}readPanelRectsFromDom(e){this.panelInfos=[];var t=(0,s.assertExists)((0,o.findRef)(e,this.PANEL_STACK_REF)).getBoundingClientRect();this.panelContainerTop=t.y,this.panelContainerHeight=t.height,e.querySelectorAll(".pf-panel").forEach(e=>{var t=(0,o.toHTMLElement)(e),t=(0,s.assertExists)(t.dataset.panelId),t=(0,s.assertExists)(this.panelById.get(t)),r=t.trackKey||t.groupKey||"",e=e.getBoundingClientRect();this.panelInfos.push({trackOrGroupKey:r,height:e.height,width:e.width,clientX:e.x,clientY:e.y,panel:t})})}renderCanvas(){var e,t,r,n;this.ctx&&this.virtualCanvas&&(n=this.ctx,e=this.virtualCanvas,t=(0,f.debugNow)(),n.resetTransform(),n.clearRect(0,0,n.canvas.width,n.canvas.height),r=window.devicePixelRatio,n.scale(r,r),n.translate(-e.canvasRect.left,-e.canvasRect.top),this.handleAreaSelection(),r=this.renderPanels(n,e),this.drawTopLayerOnCanvas(n,e),n=(0,f.debugNow)()-t,this.updatePerfStats(n,this.panelInfos.length,r))}renderPanels(t,r){let n=0,a=0;var i=new g.FlowEventsRendererArgs;for(let e=0;e<this.panelInfos.length;e++){var{panel:o,width:s,height:l}=this.panelInfos[e],c={left:0,top:n,bottom:n+l,right:s},u={width:s,height:l};i.registerPanel(o,n,l),r.overlapsCanvas(c)&&(a++,t.save(),t.translate(0,n),(0,p.canvasClip)(t,0,0,s,l),c=(0,f.debugNow)(),o.renderCanvas(t,u),this.updatePanelStats(e,o,(0,f.debugNow)()-c,t,u),t.restore()),n+=l}var e=new g.FlowEventsRenderer,d=(t.save(),t.translate(h.TRACK_SHELL_WIDTH,0),{width:r.size.width-h.TRACK_SHELL_WIDTH,height:r.size.height});return(0,p.canvasClip)(t,0,0,d.width,d.height),e.render(t,i,d),t.restore(),a}drawTopLayerOnCanvas(e,a){var i,o,s=c.globals.timeline.selectedArea;if(void 0!==s&&void 0!==c.globals.timeline.areaY.start&&void 0!==c.globals.timeline.areaY.end&&0!==this.panelInfos.length&&0!==s.tracks.length){let t=this.panelContainerHeight+this.panelContainerTop,r=this.panelContainerTop,n=!1;for(let e=0;e<this.panelInfos.length;e++)s.tracks.includes(this.panelInfos[e].trackOrGroupKey)&&(n=!0,t=Math.min(t,this.panelInfos[e].clientY),r=Math.max(r,this.panelInfos[e].clientY+this.panelInfos[e].height));n&&(i=(o=new d.TimeScale(c.globals.timeline.visibleWindow,new d.PxSpan(0,a.size.width-h.TRACK_SHELL_WIDTH))).timeToPx(s.start),o=o.timeToPx(s.end),t-=this.panelContainerTop,r-=this.panelContainerTop,e.save(),e.strokeStyle=h.SELECTION_STROKE_COLOR,e.lineWidth=1,e.translate(h.TRACK_SHELL_WIDTH,0),(0,p.canvasClip)(e,0,0,a.size.width-h.TRACK_SHELL_WIDTH,a.size.height),e.strokeRect(i,r,o-i,t-r),e.restore())}}updatePanelStats(t,r,n,a,i){if((0,f.perfDebug)()){let e=this.panelPerfStats.get(r);void 0===e&&(e=new f.RunningStatistics,this.panelPerfStats.set(r,e)),e.addValue(n),a.strokeStyle="rgba(69, 187, 73, 0.5)";a.lineWidth=1,a.strokeRect(.5,.5,i.width-1,i.height-1);a.fillStyle="hsl(97, 100%, 96%)",a.fillRect(i.width-300,i.height-20,300,20),a.fillStyle="hsla(122, 77%, 22%)";r=`Panel ${t+1} | `+(0,f.runningStatStr)(e);a.fillText(r,i.width-300,i.height-10)}}updatePerfStats(e,t,r){(0,f.perfDebug)()&&(this.perfStats.renderStats.addValue(e),this.perfStats.totalPanels=t,this.perfStats.panelsOnCanvas=r)}renderPerfStats(){return[(0,n.default)("div",this.perfStats.totalPanels+" panels, "+this.perfStats.panelsOnCanvas+" on canvas."),(0,n.default)("div",(0,f.runningStatStr)(this.perfStats.renderStats))]}}}return WC}var ZC,QC,XC={},ek={};function tk(){if(QC)return XC;QC=1,Object.defineProperty(XC,"__esModule",{value:!0}),XC.TabPanel=void 0;const i=or.__importDefault(ae()),r=tl(),a=ne(),o=Y(),s=wy(),n=function(){if(!ZC){ZC=1,Object.defineProperty(ek,"__esModule",{value:!0}),ek.DragHandle=void 0,ek.getDefaultDetailsHeight=t;const l=or.__importDefault(ae()),c=ie(),u=le(),r=vl(),n=uA(),a=nT(),i=oe();var e=V();const o=28;function t(){return o+n.DEFAULT_DETAILS_CONTENT_HEIGHT}function s(){var e=document.querySelector(".page");return null===e?t():e.clientHeight}ek.DragHandle=class{dragStartHeight=0;height=0;previousHeight=this.height;resize=()=>{};isClosed=this.height<=0;isFullscreen=!1;fullscreenHeight=0;trash=new e.DisposableStack;oncreate({dom:e,attrs:t}){this.resize=t.resize,this.height=t.height,this.isClosed=this.height<=0,this.fullscreenHeight=s();t=e,this.trash.use(new a.DragGestureHandler(t,this.onDrag.bind(this),this.onDragStart.bind(this),this.onDragEnd.bind(this))),e=i.globals.commandManager.registerCommand({id:"perfetto.ToggleDrawer",name:"Toggle drawer",defaultHotkey:"Q",callback:()=>{this.toggleVisibility()}});this.trash.use(e)}toggleVisibility(){0===this.height?(this.isClosed=!1,0===this.previousHeight&&(this.previousHeight=t()),this.resize(this.previousHeight)):(this.isFullscreen=!1,this.isClosed=!0,this.previousHeight=this.height,this.resize(0)),c.raf.scheduleFullRedraw()}onupdate({attrs:e}){this.resize=e.resize,this.height=e.height,this.isClosed=this.height<=0}onremove(e){this.trash.dispose()}onDrag(e,t){t=Math.floor(this.dragStartHeight+o/2-t);this.isClosed=t<=0,this.isFullscreen=t>=this.fullscreenHeight,this.resize(t),c.raf.scheduleFullRedraw()}onDragStart(e,t){this.dragStartHeight=this.height}onDragEnd(){}view({attrs:e}){const{tabDropdownEntries:t,currentTabKey:a,tabs:r,onTabClick:i,onTabClose:o=()=>{}}=e;var e=this.isClosed?"keyboard_arrow_up":"keyboard_arrow_down",n=this.isClosed?"Show panel":"Hide panel";return(0,l.default)(".handle",(0,l.default)(".buttons",t&&this.renderTabDropdown(t)),(0,l.default)(".tabs",r.map(e=>{const{key:t,hasCloseButton:r=!1}=e;var n=a===t?".tab[active]":".tab";return(0,l.default)(n,{key:t,onclick:e=>{e.defaultPrevented||i(t)},onauxclick:e=>{e.defaultPrevented||o(t)}},(0,l.default)("span.pf-tab-title",e.title),r&&(0,l.default)(u.Button,{onclick:e=>{o(t),e.preventDefault()},compact:!0,icon:"close"}))})),(0,l.default)(".buttons",(0,l.default)(u.Button,{onclick:()=>{this.isClosed=!1,this.isFullscreen=!0,this.fullscreenHeight=s(),this.resize(this.fullscreenHeight),c.raf.scheduleFullRedraw()},title:"Open fullscreen",disabled:this.isFullscreen,icon:"vertical_align_top",compact:!0}),(0,l.default)(u.Button,{onclick:()=>{this.toggleVisibility()},title:n,icon:e,compact:!0})))}renderTabDropdown(e){return(0,l.default)(r.PopupMenu2,{trigger:(0,l.default)(u.Button,{compact:!0,icon:"more_vert",disabled:0===e.length,title:"More Tabs"})},e.map(e=>(0,l.default)(r.MenuItem,{key:e.key,label:e.title,onclick:()=>e.onClick(),icon:e.checked?"check_box":"check_box_outline_blank"})))}}}return ek}(),l=oe(),t=ie();XC.TabPanel=class{detailsHeight=0;fadeContext=new e;hasBeenDragged=!1;view(){var e=l.globals.tabManager,t=l.globals.store.state.tabs.openTabs,e=e.resolveTabs(t).map(({uri:e,tab:t})=>t?{key:e,hasCloseButton:!0,title:t.content.getTitle(),content:t.content.render()}:{key:e,hasCloseButton:!0,title:"Tab does not exist",content:void 0}),t=(!this.hasBeenDragged&&(0<e.length||"empty"!==l.globals.state.selection.kind)&&(this.detailsHeight=(0,n.getDefaultDetailsHeight)()),e.unshift({key:"current_selection",title:"Current Selection",content:this.renderCSTabContentWithFading()}),l.globals.tabManager.tabs.filter(e=>!1===e.isEphemeral).map(({content:e,uri:t})=>{var r=void 0!==l.globals.state.tabs.openTabs.find(e=>e===t);const n=r?a.Actions.hideTab({uri:t}):a.Actions.showTab({uri:t});return{key:t,title:e.getTitle(),onClick:()=>l.globals.dispatch(n),checked:r}}));return[(0,i.default)(n.DragHandle,{resize:e=>{this.detailsHeight=Math.max(e,0),this.hasBeenDragged=!0},height:this.detailsHeight,tabs:e,currentTabKey:l.globals.state.tabs.currentTab,tabDropdownEntries:t,onTabClick:e=>l.globals.dispatch(a.Actions.showTab({uri:e})),onTabClose:e=>l.globals.dispatch(a.Actions.hideTab({uri:e}))}),(0,i.default)(".details-panel-container",{style:{height:this.detailsHeight+"px"}},e.map(({key:e,content:t})=>{e=e===l.globals.state.tabs.currentTab;return(0,i.default)(r.Gate,{open:e},t)}))]}renderCSTabContentWithFading(){var e=this.renderCSTabContent();return e.isLoading?(0,i.default)(u,e.content):(0,i.default)(c,{context:this.fadeContext},e.content)}renderCSTabContent(){const t=l.globals.state.selection,r=(0,o.getLegacySelection)(l.globals.state);if("empty"===t.kind)return{isLoading:!1,content:(0,i.default)(s.EmptyState,{className:"pf-noselection",title:"Nothing selected"},"Selection details will appear here")};if("single"===t.kind){var e=t.trackKey,e=l.globals.state.tracks[e]?.uri;if(e){const a=l.globals.trackManager.resolveTrackInfo(e)?.detailsPanel;if(a)return{content:a.render(t.eventId),isLoading:a.isLoading?.()??!1}}}let n=l.globals.tabManager.detailsPanels.map(e=>({content:e.render(t),isLoading:e.isLoading?.()??!1}));null!==r&&(e=l.globals.tabManager.legacyDetailsPanels.map(e=>({content:e.render(r),isLoading:e.isLoading?.()??!1})),n=n.concat(e));const a=n.find(({content:e})=>e);return a||{isLoading:!1,content:(0,i.default)(s.EmptyState,{className:"pf-noselection",title:"No details available",icon:"warning"},`Selection kind: '${t.kind}'`)}}};class e{resolver=()=>{};putResolver(e){this.resolver=e}resolve(){this.resolver(),this.resolver=()=>{}}}class c{onbeforeremove({attrs:t}){return new Promise(e=>{t.context.putResolver(e),setTimeout(e,50)})}oncreate({attrs:e}){e.context.resolve()}view(e){return e.children}}class u{show=!1;oncreate(e){setTimeout(()=>{this.show=!0,t.raf.scheduleFullRedraw()},50)}view(e){return this.show?e.children:void 0}}return XC}var rk,nk={};var ak,ik={};function ok(){if(!ak){ak=1,Object.defineProperty(ik,"__esModule",{value:!0}),ik.TimeAxisPanel=void 0;const e=or.__importDefault(ae()),p=K(),h=Fa(),n=uA(),u=oe(),d=gA(),g=Yo(),a=Rs();function c(e,t,r,n,a){var i,o,s,l,c,u,d=(0,h.timestampFormat)();switch(d){case h.TimestampFormat.UTC:case h.TimestampFormat.TraceTz:case h.TimestampFormat.Timecode:return i=e,o=t,s=r,l=n,c=a,o=p.Time.toTimecode(o),i.font="11px Roboto Condensed",u=o.dhhmmss,o=o.subsec(" "),i.fillText(u,s,l,c),u=i.measureText(o).width,i.font="10.5px Roboto Condensed",i.fillText(o,s,l+10,c),s=i.measureText(o).width,Math.max(u,s);case h.TimestampFormat.Raw:return f(e,t.toString(),r,n,a);case h.TimestampFormat.RawLocale:return f(e,t.toLocaleString(),r,n,a);case h.TimestampFormat.Seconds:return f(e,p.Time.formatSeconds(t),r,n,a);default:throw new Error("Invalid timestamp "+d)}}function f(e,t,r,n,a){return e.font="11px Roboto Condensed",e.fillText(t,r,n,a),e.measureText(t).width}ik.TimeAxisPanel=class{kind="panel";selectable=!1;render(){return(0,e.default)(".time-axis-panel")}renderCanvas(e,t){e.fillStyle="#999",e.textAlign="left",e.font="11px Roboto Condensed",this.renderOffsetTimestamp(e);var r={...t,width:t.width-n.TRACK_SHELL_WIDTH};e.save(),e.translate(n.TRACK_SHELL_WIDTH,0),(0,a.canvasClip)(e,0,0,r.width,r.height),this.renderPanel(e,r),e.restore(),e.fillRect(n.TRACK_SHELL_WIDTH-2,0,2,t.height)}renderOffsetTimestamp(e){var t=u.globals.timestampOffset();switch((0,h.timestampFormat)()){case h.TimestampFormat.Raw:case h.TimestampFormat.RawLocale:break;case h.TimestampFormat.Seconds:case h.TimestampFormat.Timecode:var r=c(e,t,6,10,d.MIN_PX_PER_STEP);e.fillText("+",6+r+2,10,6);break;case h.TimestampFormat.UTC:r=p.Time.toDate(u.globals.traceContext.utcOffset,u.globals.traceContext.realtimeOffset),r=(0,p.toISODateOnly)(r);e.fillText("UTC "+r,6,10);break;case h.TimestampFormat.TraceTz:r=p.Time.toDate(u.globals.traceContext.traceTzOffset,u.globals.traceContext.realtimeOffset),r=(0,p.toISODateOnly)(r);e.fillText(r,6,10)}}renderPanel(e,t){var r=u.globals.timeline.visibleWindow,n=new g.TimeScale(r,new g.PxSpan(0,t.width)),r=r.toTimeSpan(),a=u.globals.timestampOffset();if(0<t.width&&0n<r.duration){var i,o,s,l=(0,d.getMaxMajorTicks)(t.width);for({type:i,time:o}of(0,d.generateTicks)(r,l,a))i===d.TickType.MAJOR&&(s=Math.floor(n.timeToPx(o)),e.fillRect(s,0,1,t.height),c(e,u.globals.toDomainTime(o),s+5,10,d.MIN_PX_PER_STEP))}}}}return ik}var sk,lk={};function ck(){if(!sk){sk=1,Object.defineProperty(lk,"__esModule",{value:!0}),lk.TimeSelectionPanel=void 0;const e=or.__importDefault(ae()),f=K(),s=Fa(),u=uA(),p=oe(),h=gA(),d=L(),r=Rs(),g=Yo();lk.TimeSelectionPanel=class{kind="panel";selectable=!1;render(){return(0,e.default)(".time-selection-panel")}renderCanvas(e,t){e.fillStyle="#999",e.fillRect(u.TRACK_SHELL_WIDTH-2,0,2,t.height);t={...t,width:t.width-u.TRACK_SHELL_WIDTH};e.save(),e.translate(u.TRACK_SHELL_WIDTH,0),(0,r.canvasClip)(e,0,0,t.width,t.height),this.renderPanel(e,t),e.restore()}renderPanel(e,t){var r=p.globals.timeline.visibleWindow,n=new g.TimeScale(r,new g.PxSpan(0,t.width)),r=r.toTimeSpan();if(0<t.width&&0n<r.duration){var a,i,o=(0,h.getMaxMajorTicks)(t.width),s=p.globals.timestampOffset();for({type:a,time:i}of(0,h.generateTicks)(r,o,s)){var l=Math.floor(n.timeToPx(i));a===h.TickType.MAJOR&&e.fillRect(l,0,1,t.height)}}var r=p.globals.timeline.selectedArea,c=p.globals.state.selection;void 0!==r?(o=f.Time.min(r.start,r.end),s=f.Time.max(r.start,r.end),this.renderSpan(e,n,t,o,s)):"area"===c.kind&&(r=f.Time.min(c.start,c.end),o=f.Time.max(c.start,c.end),this.renderSpan(e,n,t,r,o)),-1n!==p.globals.state.hoverCursorTimestamp&&this.renderHover(e,n,t,p.globals.state.hoverCursorTimestamp);for(const d of Object.values(p.globals.state.notes)){var u="note"===c.kind&&c.id===d.id;"SPAN"!==d.noteType||u||this.renderSpan(e,n,t,d.start,d.end)}e.restore()}renderHover(t,r,n,a){r=Math.floor(r.timeToPx(a)),a=function(e){var t=(0,s.timestampFormat)();switch(t){case s.TimestampFormat.UTC:case s.TimestampFormat.TraceTz:case s.TimestampFormat.Timecode:return f.Time.toTimecode(e).toString(" ");case s.TimestampFormat.Raw:return e.toString();case s.TimestampFormat.RawLocale:return e.toLocaleString();case s.TimestampFormat.Seconds:return f.Time.formatSeconds(e);default:throw new Error("Invalid timestamp "+t)}}(p.globals.toDomainTime(a)),n=this.getBBoxFromSize(n);if(!(r<n.x)){t.fillStyle=u.FOREGROUND_COLOR,t.fillRect(r,0,1,n.width);var i=Math.floor(n.height/2+n.y),o=t.measureText(a).width;let e;r+3+o>n.width?(e=r-3,t.textAlign="right"):(e=r+3,t.textAlign="left"),t.fillStyle=u.BACKGROUND_COLOR,t.fillRect(e-1,0,o+2,n.height),t.textBaseline="middle",t.fillStyle=u.FOREGROUND_COLOR,t.font="10px Roboto Condensed",t.fillText(a,e,i)}}renderSpan(t,r,n,a,i){var o=r.timeToPx(a),r=r.timeToPx(i),i=(0,d.renderDuration)(i-a);{a=t,t={x:o,y:0,width:r-o,height:n.height},r=this.getBBoxFromSize(n),o=i,a.fillStyle=u.FOREGROUND_COLOR;var n=Math.floor(t.x),i=Math.floor(t.x+t.width),s=Math.floor(t.height/2+t.y),l=i-n,c=(a.beginPath(),a.rect(r.x,r.y,r.width,r.height),a.clip(),a.fillRect(n,s,l,1),a.fillRect(n,t.y,1,t.height),a.fillRect(i,t.y,1,t.height),a.measureText(o).width);let e=Math.floor(l/2-c/2+n);(c>t.width||e<r.x||e+c>r.x+r.width)&&(e=i>r.x+r.width?n-c-3:i+3),a.fillStyle=u.BACKGROUND_COLOR,a.fillRect(e-1,0,c+1,t.height),a.textBaseline="middle",a.fillStyle=u.FOREGROUND_COLOR,a.font="10px Roboto Condensed",a.fillText(o,e,s)}}getBBoxFromSize(e){return{x:0,y:0,width:e.width,height:e.height}}}}return lk}var uk,dk,fk,pk,hk={},gk={},mk={};function _k(){return uk||(uk=1,Object.defineProperty(mk,"__esModule",{value:!0}),mk.drawVerticalLineAtTime=function(e,t,r,n,a,i=2){t=Math.floor(t.timeToPx(r));!function(e,t,r,n,a=2){e.beginPath(),e.strokeStyle=n;n=e.lineWidth;e.lineWidth=a,e.moveTo(t,0),e.lineTo(t,r),e.stroke(),e.closePath(),e.lineWidth=n}(e,t,n,a,i)}),mk}function yk(){if(!dk){dk=1;{var a=gk;Object.defineProperty(a,"__esModule",{value:!0}),a.TrackPanel=a.TrackContent=a.CrashButton=a.SHOW_TRACK_DETAILS_BUTTON=void 0,a.getTitleFontSize=function(e){e=e.length;if(55<e)return"9px";if(50<e)return"10px";if(45<e)return"11px";if(40<e)return"12px";if(35<e)return"13px";return},a.renderChips=o,a.drawGridLines=s,a.renderHoveredCursorVertical=l,a.renderHoveredNoteVertical=c,a.renderWakeupVertical=u,a.renderNoteVerticals=d;var e=or;const f=rn(),p=e.__importDefault(ae()),h=hl(),g=X(),m=ne(),_=ie(),y=Ps(),T=uA(),b=oe(),v=gA(),r=Bc(),E=_k(),S=Qs(),A=le(),n=bl(),O=Rs(),C=Yo(),k=Y(),w=sb(),t=z(),R=Gl(),I=ds();e=re();const M=ce();function i(e){var t=b.globals.state.selection;return"area"===t.kind&&t.tracks.includes(e)}a.SHOW_TRACK_DETAILS_BUTTON=e.featureFlags.register({id:"showTrackDetailsButton",name:"Show track details button",description:"Show track details button in track shells.",defaultValue:!1});class P{view({attrs:e}){return(0,p.default)("span.chip",e.text)}}function o(e){return e.map(e=>(0,p.default)(P,{text:e}))}class N{view({attrs:e}){return(0,p.default)(n.Popup,{trigger:(0,p.default)(A.Button,{icon:g.Icons.Crashed,compact:!0})},this.renderErrorMessage(e.error))}renderErrorMessage(e){return(0,p.default)("","This track has crashed",(0,p.default)(A.Button,{label:"Re-raise exception",intent:R.Intent.Primary,className:n.Popup.DISMISS_POPUP_GROUP_CLASS,onclick:()=>{throw e}}))}}a.CrashButton=N;class L{dragging=!1;dropping=void 0;view({attrs:t}){let e=void 0;var r=b.globals.state.searchIndex,r=(-1!==r&&b.globals.currentSearchResults.trackKeys[r]===t.trackKey&&(e="flash"),b.globals.state.selection),n=(n=t.trackKey,-1!==b.globals.state.pinnedTracks.indexOf(n));return(0,p.default)(".track-shell[draggable=true]",{className:(0,S.classNames)(e,this.dragging&&"drag",this.dropping&&"drop-"+this.dropping),ondragstart:e=>this.ondragstart(e,t.trackKey),ondragend:this.ondragend.bind(this),ondragover:this.ondragover.bind(this),ondragleave:this.ondragleave.bind(this),ondrop:e=>this.ondrop(e,t.trackKey)},(0,p.default)(".track-menubar",(0,p.default)("h1",{title:t.title},t.title,t.chips&&o(t.chips)),(0,p.default)(A.ButtonBar,{className:"track-buttons"},t.buttons,a.SHOW_TRACK_DETAILS_BUTTON.get()&&this.renderTrackDetailsButton(n,t),(0,p.default)(A.Button,{className:(0,S.classNames)(!n&&"pf-visible-on-hover"),onclick:()=>{b.globals.dispatch(m.Actions.toggleTrackPinned({trackKey:t.trackKey}))},icon:g.Icons.Pin,iconFilled:n,title:n?"Unpin":"Pin to top",compact:!0}),"area"===r.kind?(0,p.default)(A.Button,{onclick:e=>{b.globals.dispatch(m.Actions.toggleTrackSelection({key:t.trackKey,isTrackGroup:!1})),e.stopPropagation()},compact:!0,icon:i(t.trackKey)?g.Icons.Checkbox:g.Icons.BlankCheckbox,title:i(t.trackKey)?"Remove track":"Add track to selection"}):"")))}ondragstart(e,t){e=e.dataTransfer;null!==e&&(this.dragging=!0,_.raf.scheduleFullRedraw(),e.setData("perfetto/track",""+t),e.setDragImage(new Image,0,0))}ondragend(){this.dragging=!1,_.raf.scheduleFullRedraw()}ondragover(e){var t;this.dragging||e.target instanceof HTMLElement&&null!==(t=e.dataTransfer)&&t.types.includes("perfetto/track")&&(t.dropEffect="move",e.preventDefault(),e.offsetY<e.target.scrollHeight/3?this.dropping="before":e.offsetY>e.target.scrollHeight/3*2&&(this.dropping="after"),_.raf.scheduleFullRedraw())}ondragleave(){this.dropping=void 0,_.raf.scheduleFullRedraw()}ondrop(e,t){void 0!==this.dropping&&null!==(e=e.dataTransfer)&&(_.raf.scheduleFullRedraw(),e=e.getData("perfetto/track"),t=t,b.globals.dispatch(m.Actions.moveTrack({srcId:e,op:this.dropping,dstId:t})),this.dropping=void 0)}renderTrackDetailsButton(e,t){return(0,p.default)(n.Popup,{trigger:(0,p.default)(A.Button,{className:(0,S.classNames)(!e&&"pf-visible-on-hover"),icon:"info",title:"Show track details",compact:!0}),position:n.PopupPosition.RightStart},(0,p.default)(".pf-track-details-dropdown",(0,p.default)(M.Tree,(0,p.default)(M.TreeNode,{left:"URI",right:b.globals.state.tracks[t.trackKey]?.uri}),(0,p.default)(M.TreeNode,{left:"Title",right:t.title}),(0,p.default)(M.TreeNode,{left:"Track Key",right:t.trackKey}),(0,p.default)(M.TreeNode,{left:"Plugin ID",right:t.pluginId}),(0,p.default)(M.TreeNode,{left:"Tags"},t.tags&&Object.entries(t.tags).map(([e,t])=>(0,p.default)(M.TreeNode,{left:e,right:t?.toString()}))))))}}class D{mouseDownX;mouseDownY;selectionOccurred=!1;getTargetContainerSize(e){return e.target.getBoundingClientRect().width}getTargetTimeScale(e){var t=b.globals.timeline.visibleWindow;return new C.TimeScale(t,new C.PxSpan(0,this.getTargetContainerSize(e)))}view(e){const n=e.attrs;return(0,p.default)(".track-content",{style:(0,t.exists)(n.height)&&{height:n.height+"px"},className:(0,S.classNames)(n.hasError&&"pf-track-content-error"),onmousemove:e=>{var{x:t,y:r}=(0,h.currentTargetOffset)(e);n.track.onMouseMove?.({x:t,y:r,timescale:this.getTargetTimeScale(e)}),_.raf.scheduleRedraw()},onmouseout:()=>{n.track.onMouseOut?.(),_.raf.scheduleRedraw()},onmousedown:e=>{var{x:e,y:t}=(0,h.currentTargetOffset)(e);this.mouseDownX=e,this.mouseDownY=t},onmouseup:e=>{var t;void 0!==this.mouseDownX&&void 0!==this.mouseDownY&&({x:e,y:t}=(0,h.currentTargetOffset)(e),(1<Math.abs(e-this.mouseDownX)||1<Math.abs(t-this.mouseDownY))&&(this.selectionOccurred=!0),this.mouseDownX=void 0,this.mouseDownY=void 0)},onclick:e=>{var t,r;this.selectionOccurred?this.selectionOccurred=!1:({x:t,y:r}=(0,h.currentTargetOffset)(e),n.track.onMouseClick?.({x:t,y:r,timescale:this.getTargetTimeScale(e)})&&e.stopPropagation(),_.raf.scheduleRedraw())}},e.children)}}a.TrackContent=D;class x{view({attrs:e}){var t=e.heightPx??24,t=Math.max(t,18);return(0,p.default)(".track",{style:{height:Math.ceil(t)+"px"},id:"track_"+e.trackKey},[(0,p.default)(L,{buttons:[e.error&&(0,p.default)(N,{error:e.error}),e.closeable&&(0,p.default)(w.CloseTrackButton,{trackKey:e.trackKey}),e.buttons],title:e.title,trackKey:e.trackKey,tags:e.tags,chips:e.chips,pluginId:e.pluginId}),e.track&&(0,p.default)(D,{track:e.track,hasError:Boolean(e.error),height:e.heightPx})])}oncreate(e){var t=e["attrs"];b.globals.scrollToTrackKey===t.trackKey&&((0,r.verticalScrollToTrack)(t.trackKey),b.globals.scrollToTrackKey=void 0),this.onupdate(e),t.revealOnCreate&&e.dom.scrollIntoView()}onupdate(e){e.attrs.track?.onFullRedraw?.()}}function s(e,t,r,n){if(e.strokeStyle=T.TRACK_BORDER_COLOR,e.lineWidth=1,0<n.width&&0n<t.duration){var a,i,o=(0,v.getMaxMajorTicks)(n.width),s=b.globals.timestampOffset();for({type:a,time:i}of(0,v.generateTicks)(t,o,s)){var l=Math.floor(r.timeToPx(i));a===v.TickType.MAJOR&&(e.beginPath(),e.moveTo(l+.5,0),e.lineTo(l+.5,n.height),e.stroke())}}}function l(e,t,r){-1n!==b.globals.state.hoverCursorTimestamp&&(0,E.drawVerticalLineAtTime)(e,t,b.globals.state.hoverCursorTimestamp,r.height,"#344596")}function c(e,t,r){-1n!==b.globals.state.hoveredNoteTimestamp&&(0,E.drawVerticalLineAtTime)(e,t,b.globals.state.hoveredNoteTimestamp,r.height,"#aaa")}function u(e,t,r){var n=(0,k.getLegacySelection)(b.globals.state);null!==n&&"SCHED_SLICE"===n.kind&&void 0!==b.globals.sliceDetails.wakeupTs&&(0,E.drawVerticalLineAtTime)(e,t,b.globals.sliceDetails.wakeupTs,r.height,"black")}function d(e,t,r){for(const a of Object.values(b.globals.state.notes)){var n;"SPAN"===a.noteType?(n="rgba("+f.hex.rgb(a.color.substr(1)).toString()+", 0.65)",(0,E.drawVerticalLineAtTime)(e,t,a.start,r.height,n,1),(0,E.drawVerticalLineAtTime)(e,t,a.end,r.height,n,1)):"DEFAULT"===a.noteType&&(0,E.drawVerticalLineAtTime)(e,t,a.timestamp,r.height,a.color)}}a.TrackPanel=class{attrs;kind="panel";selectable=!0;previousTrackContext;constructor(e){this.attrs=e}get trackKey(){return this.attrs.trackKey}render(){var e=this.attrs;return e.trackFSM?e.trackFSM.getError()?(0,p.default)(x,{title:e.title,trackKey:e.trackKey,error:e.trackFSM.getError(),track:e.trackFSM.track,closeable:e.closeable,chips:e.chips,pluginId:e.pluginId}):(0,p.default)(x,{trackKey:e.trackKey,title:e.title,heightPx:e.trackFSM.track.getHeight(),buttons:e.trackFSM.track.getTrackShellButtons?.(),tags:e.tags,track:e.trackFSM.track,error:e.trackFSM.getError(),revealOnCreate:e.revealOnCreate,closeable:e.closeable,chips:e.chips,pluginId:e.pluginId}):(0,p.default)(x,{trackKey:e.trackKey,title:e.title,revealOnCreate:e.revealOnCreate,closeable:e.closeable,chips:e.chips,pluginId:e.pluginId})}highlightIfTrackSelected(e,t,r){var n,a=b.globals.state.selection;"area"===a.kind&&(n=a.end-a.start,a.tracks.includes(this.attrs.trackKey))&&(e.fillStyle=T.SELECTION_FILL_COLOR,e.fillRect(t.timeToPx(a.start),0,t.durationToPx(n),r.height))}renderCanvas(e,t){var t={...t,width:t.width-T.TRACK_SHELL_WIDTH},r=(e.save(),e.translate(T.TRACK_SHELL_WIDTH,0),(0,O.canvasClip)(e,0,0,t.width,t.height),b.globals.timeline.visibleWindow),n=r.toTimeSpan(),a=new C.TimeScale(r,new C.PxSpan(0,t.width)),n=(s(e,n,a,t),this.attrs.trackFSM);void 0!==n?(r={trackKey:n.trackKey,visibleWindow:r,size:t,resolution:(0,I.calculateResolution)(r,t.width),ctx:e,timescale:a},this.previousTrackContext=r,n.getError()||n.render(r)):(0,y.checkerboard)(e,t.height,0,t.width),this.highlightIfTrackSelected(e,a,t),c(e,a,t),l(e,a,t),u(e,a,t),d(e,a,t),e.restore()}getSliceRect(e,t,r){if(void 0!==this.attrs.trackFSM&&void 0!==this.previousTrackContext)return this.attrs.trackFSM.track.getSliceRect?.(this.previousTrackContext,e,t,r)}}}}return gk}function Tk(){if(!pk){pk=1,Object.defineProperty(PC,"__esModule",{value:!0}),PC.ViewerPage=void 0;const p=or.__importDefault(ae()),h=hl(),g=mn(),m=K(),_=ne();var e=re();const y=ie(),T=uA(),b=oe();var t=mA(),r=GC(),n=c1();const v=aT(),E=JC(),S=CT(),A=tk();var a=function(){if(!rk){rk=1,Object.defineProperty(nk,"__esModule",{value:!0}),nk.TickmarkPanel=void 0;const e=or.__importDefault(ae()),r=uA(),c=oe(),u=gA(),d=Yo(),n=Rs();nk.TickmarkPanel=class{kind="panel";selectable=!1;render(){return(0,e.default)(".tickbar")}renderCanvas(e,t){e.fillStyle="#999",e.fillRect(r.TRACK_SHELL_WIDTH-2,0,2,t.height);t={...t,width:t.width-r.TRACK_SHELL_WIDTH};e.save(),e.translate(r.TRACK_SHELL_WIDTH,0),(0,n.canvasClip)(e,0,0,t.width,t.height),this.renderTrack(e,t),e.restore()}renderTrack(e,t){var r=c.globals.timeline.visibleWindow,n=new d.TimeScale(r,new d.PxSpan(0,t.width)),r=r.toTimeSpan();if(0<t.width&&0n<r.duration){var a,i,o=(0,u.getMaxMajorTicks)(t.width),s=c.globals.timestampOffset();for({type:a,time:i}of(0,u.generateTicks)(r,o,s)){var l=Math.floor(n.timeToPx(i));a===u.TickType.MAJOR&&e.fillRect(l,0,1,t.height)}}r=c.globals.searchOverviewTrack;r&&r.render(e,t)}}}return nk}(),L=ok(),F=ck();const O=wA(),C=function(){if(!fk){fk=1,Object.defineProperty(hk,"__esModule",{value:!0}),hk.TrackGroupPanel=void 0;const d=or.__importDefault(ae()),f=X(),p=ne(),h=Y(),s=uA(),g=oe(),m=yk(),l=Rs(),_=le(),c=ds(),u=Yo(),y=z(),T=Qs();hk.TrackGroupPanel=class{attrs;kind="panel";selectable=!0;groupKey;constructor(e){this.attrs=e,this.groupKey=e.groupKey}render(){const{groupKey:t,title:e,subtitle:r,chips:n,collapsed:a,trackFSM:i,tooltip:o}=this.attrs;let s="";var l=g.globals.state.searchIndex;-1!==l&&(l=g.globals.currentSearchResults.trackKeys[l],(0,h.getContainingGroupKey)(g.globals.state,l)===t)&&(s="flash");const c=g.globals.state.selection;l=g.globals.state.trackGroups[t];let u=f.Icons.BlankCheckbox;"area"===c.kind&&(c.tracks.includes(t)&&l.tracks.every(e=>c.tracks.includes(e))?u=f.Icons.Checkbox:(c.tracks.includes(t)||l.tracks.some(e=>c.tracks.includes(e)))&&(u=f.Icons.IndeterminateCheckbox));l=i?.getError();return(0,d.default)(`.track-group-panel[collapsed=${a}]`,{id:"track_"+t,oncreate:()=>this.onupdate(),onupdate:()=>this.onupdate()},(0,d.default)(".shell",{className:(0,T.classNames)(this.attrs.collapsable&&"pf-clickable",s),onclick:e=>{e.defaultPrevented||(this.attrs.collapsable&&g.globals.dispatch(p.Actions.toggleTrackGroupCollapsed({groupKey:t})),e.stopPropagation())}},this.attrs.collapsable&&(0,d.default)(".fold-button",(0,d.default)("i.material-icons",a?f.Icons.ExpandDown:f.Icons.ExpandUp)),(0,d.default)(".title-wrapper",(0,d.default)("h1.track-title",{title:o},e,n&&(0,m.renderChips)(n)),a&&(0,y.exists)(r)&&(0,d.default)("h2.track-subtitle",r)),(0,d.default)(".track-buttons",l&&(0,d.default)(m.CrashButton,{error:l}),"area"===c.kind&&(0,d.default)(_.Button,{onclick:e=>{g.globals.dispatch(p.Actions.toggleTrackSelection({key:t,isTrackGroup:!0})),e.stopPropagation()},icon:u,compact:!0}))),i?(0,d.default)(m.TrackContent,{track:i.track,hasError:Boolean(i.getError()),height:this.attrs.trackFSM?.track.getHeight()},a||null===r?null:(0,d.default)("span",r)):null)}onupdate(){void 0!==this.attrs.trackFSM&&this.attrs.trackFSM.track.onFullRedraw?.()}highlightIfTrackSelected(e,t,r){var n,a=g.globals.state.selection;"area"===a.kind&&(n=a.end-a.start,a.tracks.includes(this.groupKey))&&(e.fillStyle="rgba(131, 152, 230, 0.3)",e.fillRect(t.timeToPx(a.start),0,t.durationToPx(n),r.height))}renderCanvas(e,t){var r,n,a,{collapsed:i,trackFSM:o}=this.attrs;i&&(i={width:t.width-s.TRACK_SHELL_WIDTH,height:t.height},e.save(),e.translate(s.TRACK_SHELL_WIDTH,0),(0,l.canvasClip)(e,0,0,i.width,i.height),a=(r=g.globals.timeline.visibleWindow).toTimeSpan(),n=new u.TimeScale(r,new u.PxSpan(0,i.width)),(0,m.drawGridLines)(e,a,n,i),o&&!o.getError()&&(a={visibleWindow:r,size:i,ctx:e,trackKey:o.trackKey,resolution:(0,c.calculateResolution)(r,i.width),timescale:n},o.render(a)),this.highlightIfTrackSelected(e,n,t),(0,m.renderHoveredNoteVertical)(e,n,t),(0,m.renderHoveredCursorVertical)(e,n,t),(0,m.renderWakeupVertical)(e,n,t),(0,m.renderNoteVerticals)(e,n,t),e.restore())}}}return hk}(),k=yk(),w=ee(),R=Yo(),I=Ra(),M=z(),P=wy(),N=sc(),D=e.featureFlags.register({id:"overviewVisible",name:"Overview Panel",description:"Show the panel providing an overview of the trace",defaultValue:!0});class x{zoomContent;keepCurrentSelection=!1;overviewTimelinePanel=new r.OverviewTimelinePanel;timeAxisPanel=new L.TimeAxisPanel;timeSelectionPanel=new F.TimeSelectionPanel;notesPanel=new t.NotesPanel;tickmarkPanel=new a.TickmarkPanel;timelineWidthPx;PAN_ZOOM_CONTENT_REF="pan-and-zoom-content";oncreate(n){var e=(0,h.findRef)(n.dom,this.PAN_ZOOM_CONTENT_REF),e=(0,h.toHTMLElement)((0,w.assertExists)(e));this.zoomContent=new v.PanAndZoomHandler({element:e,onPanned:e=>{var t=b.globals.timeline;void 0!==this.timelineWidthPx&&(this.keepCurrentSelection=!0,e=new R.TimeScale(t.visibleWindow,new R.PxSpan(0,this.timelineWidthPx)).pxToDuration(e),t.panVisibleWindow(e),localStorage.setItem(O.DISMISSED_PANNING_HINT_KEY,"true"),y.raf.scheduleRedraw())},onZoomed:(e,t)=>{var r=b.globals.timeline,e=(e-T.TRACK_SHELL_WIDTH)/(n.dom.getBoundingClientRect().width-T.TRACK_SHELL_WIDTH);r.zoomVisibleWindow(1-t,e),y.raf.scheduleRedraw()},editSelection:e=>{return void 0!==this.timelineWidthPx&&null!==d(new R.TimeScale(b.globals.timeline.visibleWindow,new R.PxSpan(0,this.timelineWidthPx)),e)},onSelection:(e,t,r,n,a,i)=>{var o=b.globals.traceContext,s=b.globals.timeline;if(void 0!==this.timelineWidthPx){var l=s["visibleWindow"],l=l.toTimeSpan(),c=(this.keepCurrentSelection=!0,new R.TimeScale(s.visibleWindow,new R.PxSpan(0,this.timelineWidthPx)));if(i){i=b.globals.state.selection;if("area"===i.kind){var u=b.globals.timeline.selectedArea||i;let e=c.pxToHpTime(n-T.TRACK_SHELL_WIDTH).toTime();r=d(c,r);if(null==r)return;r="START"===r?u.end:u.start;e=e<r?m.Time.max(e,l.start):m.Time.min(e,l.end),s.selectArea(m.Time.max(m.Time.min(r,e),o.start),m.Time.min(m.Time.max(r,e),o.end),i.tracks)}}else{u=Math.min(e,n)-T.TRACK_SHELL_WIDTH,l=Math.max(e,n)-T.TRACK_SHELL_WIDTH;if(u<0&&l<0)return;u=(0,g.clamp)(u,0,this.timelineWidthPx),l=(0,g.clamp)(l,0,this.timelineWidthPx),s.selectArea(c.pxToHpTime(u).toTime("floor"),c.pxToHpTime(l).toTime("ceil")),s.areaY.start=t,s.areaY.end=a,(0,S.publishShowPanningHint)()}y.raf.scheduleRedraw()}},endSelection:e=>{b.globals.timeline.areaY.start=void 0,b.globals.timeline.areaY.end=void 0;var t=b.globals.timeline.selectedArea;e?"area"===b.globals.state.selection.kind&&t&&b.globals.dispatch(_.Actions.selectArea({...t})):t&&b.globals.makeSelection(_.Actions.selectArea({...t})),b.globals.timeline.deselectArea(),y.raf.scheduleFullRedraw()}})}onremove(){this.zoomContent&&this.zoomContent[Symbol.dispose]()}view(){var e=function(e){var t=l(b.globals.state.scrollingTracks,e);for(const n of Object.values(b.globals.state.trackGroups)){var r;o(e)?(r=s(e),(r=(0,I.fuzzyMatch)(n.name,...r)).matches?(r=i(r.segments),t.push({kind:"group",collapsed:n.collapsed,childPanels:n.collapsed?[]:l(n.tracks),header:u(n,!0,n.collapsed,r)})):0!==(r=l(n.tracks,e)).length&&t.push({kind:"group",collapsed:!1,childPanels:r,header:u(n,!1,!1)})):t.push({kind:"group",collapsed:n.collapsed,childPanels:n.collapsed?[]:l(n.tracks),header:u(n,!0,n.collapsed)})}return t}(b.globals.state.trackFilterTerm),e=(0,p.default)(".page.viewer-page",(0,p.default)(".pan-and-zoom-content",{ref:this.PAN_ZOOM_CONTENT_REF,onclick:()=>{this.keepCurrentSelection?this.keepCurrentSelection=!1:b.globals.clearSelection()}},(0,p.default)(".pf-timeline-header",(0,p.default)(E.PanelContainer,{className:"header-panel-container",panels:(0,N.removeFalsyValues)([D.get()&&this.overviewTimelinePanel,this.timeAxisPanel,this.timeSelectionPanel,this.notesPanel,this.tickmarkPanel])}),(0,p.default)(".scrollbar-spacer-vertical")),(0,p.default)(E.PanelContainer,{className:"pinned-panel-container",panels:b.globals.state.pinnedTracks.map(e=>{var t=f(e);return new k.TrackPanel({trackKey:e,title:t.title,tags:t.tags,trackFSM:t.trackFSM,revealOnCreate:!0,closeable:t.closeable,chips:t.chips,pluginId:t.pluginId})})}),0===e.length&&o(b.globals.state.trackFilterTerm)?(0,p.default)(P.EmptyState,{title:"No matching tracks"},`No tracks match filter term "${b.globals.state.trackFilterTerm}"`):(0,p.default)(E.PanelContainer,{className:"scrolling-panel-container",panels:e,onPanelStackResize:e=>{e-=T.TRACK_SHELL_WIDTH;this.timelineWidthPx=e}})),(0,p.default)(A.TabPanel));return b.globals.trackManager.flushOldTracks(),e}}function d(e,t){var r=b.globals.state.selection;if("area"===r.kind){var r=b.globals.timeline.selectedArea||r,n=e.timeToPx(r.start),e=e.timeToPx(r.end),r=t-T.TRACK_SHELL_WIDTH,t=Math.abs(n-r),n=Math.abs(e-r),e=3*window.devicePixelRatio;if(t<e&&t<=n)return"START";if(n<e&&n<=t)return"END"}return null}function i(e){return e.map(({matching:e,value:t})=>e?(0,p.default)("b",t):t)}function o(e){return void 0!==e&&""!==e}function s(e){return e.split(",").map(e=>e.trim()).filter(e=>0<e.length)}function l(e,t){return o(t)?(t=s(t),new I.FuzzyFinder(e,e=>b.globals.state.tracks[e].name).find(...t).map(({item:e,segments:t})=>c(e,i(t)))):e.map(e=>c(e))}function c(e,t){var r=f(e);return new k.TrackPanel({trackKey:e,title:(0,p.default)("span",{style:{"font-size":(0,k.getTitleFontSize)(r.title)}},Boolean(t)?t:r.title),tags:r.tags,trackFSM:r.trackFSM,closeable:r.closeable,chips:r.chips,pluginId:r.pluginId})}function u(e,t,r,n){var a=e.summaryTrack;return(0,M.exists)(a)?(a=f(a),new C.TrackGroupPanel({groupKey:e.key,trackFSM:a.trackFSM,subtitle:a.subtitle,tags:a.tags,chips:a.chips,collapsed:r,title:(0,M.exists)(n)?n:e.name,tooltip:e.name,collapsable:t})):new C.TrackGroupPanel({groupKey:e.key,collapsed:r,title:(0,M.exists)(n)?n:e.name,tooltip:e.name,collapsable:t})}function f(e){var{uri:t,name:r,closeable:n}=b.globals.state.tracks[e],t=b.globals.trackManager.resolveTrackInfo(t),e=t&&b.globals.trackManager.resolveTrack(e,t),t=e?.desc.tags;return{title:r,subtitle:e?.desc.subtitle,closeable:n??!1,tags:t,trackFSM:e,chips:e?.desc.chips,pluginId:e?.desc.pluginId}}PC.ViewerPage=(0,n.createPage)({view(){return(0,p.default)(x)}})}return PC}var bk,vk={};function Ek(){if(!bk){bk=1,Object.defineProperty(vk,"__esModule",{value:!0}),vk.VizPage=void 0;const n=or.__importDefault(ae()),a=ie(),i=dO(),o=xd(),s=oe();var r=c1();let t="",e=void 0;vk.VizPage=(0,r.createPage)({oncreate(){e=function(){var e=s.globals.getCurrentEngine()?.id;if(void 0!==e)return s.globals.engines.get(e)?.getProxy("VizPage")}()},view(){return(0,n.default)(".viz-page",(0,n.default)(o.VegaView,{spec:t,engine:e,data:{}}),(0,n.default)(i.Editor,{onUpdate:e=>{t=e,a.raf.scheduleFullRedraw()}}))}})}return vk}var Sk,Ak={},Ok={};var Ck,kk,wk,Rk={};function Ik(){if(kk)return Ak;kk=1,Object.defineProperty(Ak,"__esModule",{value:!0}),Ak.WidgetsPage=void 0;const o=or.__importDefault(ae()),s=Qs(),n=te(),r=X(),a=ie(),i=se(),l=le(),e=ep(),t=Sy(),c=dO(),u=wy(),d=ef(),f=dT(),p=al(),h=vl(),g=de(),m=Ry(),_=bl(),y=dl(),T=Cc(),b=$l(),v=function(){if(!Sk){Sk=1,Object.defineProperty(Ok,"__esModule",{value:!0}),Ok.Switch=void 0;const o=or.__importDefault(ae()),s=Qs();Ok.Switch=class{view({attrs:e}){const{label:t,checked:r,disabled:n,className:a,...i}=e;e=(0,s.classNames)(n&&"pf-disabled",a);return(0,o.default)("label.pf-switch",{...i,className:e},(0,o.default)("input[type=checkbox]",{disabled:n,checked:r}),(0,o.default)("span"),t)}}}return Ok}(),E=Oc(),S=Lm(),A=ce(),L=xd();var O,C,k,F=c1();const U=Rm(),B=function(){if(!Ck){Ck=1,Object.defineProperty(Rk,"__esModule",{value:!0}),Rk.TableShowcase=void 0;const e=or.__importDefault(ae()),t=Im();const r=[(0,t.numberColumn)("ID",e=>e.id),(0,t.stringColumn)("Name",e=>e.name),(0,t.numberColumn)("Year",e=>e.year)];Rk.TableShowcase=class{data=new t.TableData([{id:1,name:"TypeScript",year:2012},{id:2,name:"JavaScript",year:1995},{id:3,name:"Lean",year:2013}]);view(){return(0,e.default)(t.Table,{data:this.data,columns:r})}}}return Rk}(),j=Nm(),w=Gl(),H=sg(),G=dg(),V=jT(),W={table:[{category:"a",amount:8.167},{category:"b",amount:1.492},{category:"c",amount:2.782},{category:"d",amount:4.253},{category:"e",amount:12.7},{category:"f",amount:2.228},{category:"g",amount:2.015},{category:"h",amount:6.094},{category:"i",amount:6.966},{category:"j",amount:.253},{category:"k",amount:1.772},{category:"l",amount:4.025},{category:"m",amount:2.406},{category:"n",amount:6.749},{category:"o",amount:7.507},{category:"p",amount:1.929},{category:"q",amount:.095},{category:"r",amount:5.987},{category:"s",amount:6.327},{category:"t",amount:9.056},{category:"u",amount:2.758},{category:"v",amount:.978},{category:"w",amount:2.36},{category:"x",amount:.25},{category:"y",amount:1.974},{category:"z",amount:.074}]},q={table:[{category:"a",amount:8.965},{category:"b",amount:1.482},{category:"c",amount:3.988},{category:"d",amount:3.293},{category:"e",amount:7.921},{category:"f",amount:.312},{category:"g",amount:1.377},{category:"h",amount:1.072},{category:"i",amount:8.286},{category:"j",amount:2.343},{category:"k",amount:3.411},{category:"l",amount:2.136},{category:"m",amount:2.911},{category:"n",amount:5.6},{category:"o",amount:7.59},{category:"p",amount:3.101},{category:"q",amount:.003},{category:"r",amount:4.571},{category:"s",amount:4.263},{category:"t",amount:3.966},{category:"u",amount:2.347},{category:"v",amount:.034},{category:"w",amount:4.549},{category:"x",amount:.019},{category:"y",amount:3.857},{category:"z",amount:5.62}]},$={};function R(e,t,r=void 0){return Boolean(e)?t:r}(k=O=O||{}).BarChart="Barchart",k.BarChartLite="Barchart (Lite)",k.Broken="Broken",(k=C=C||{}).English="English",k.Polish="Polish";const I={foobar:!(k.Empty="Empty"),foo:!1,bar:!1,baz:!1,qux:!1,quux:!1,corge:!1,grault:!1,garply:!1,waldo:!1,fred:!1,plugh:!1,xyzzy:!1,thud:!1};function z(){let n=!1;return{view:function({attrs:e}){var{zIndex:e=!0,absolute:t=!0,top:r=!0}=e;return[(0,o.default)(l.Button,{label:"Toggle Portal",intent:w.Intent.Primary,onclick:()=>{n=!n,a.raf.scheduleFullRedraw()}}),n&&(0,o.default)(y.Portal,{style:{position:R(t,"absolute"),top:R(r,"0"),zIndex:R(e,"10","0"),background:"white"}},(0,o.default)("",`A very simple portal - a div rendered outside of the normal
              flow of the page`))]}}}function K(){let t=!1;return{view:function(){return(0,o.default)(_.Popup,{trigger:(0,o.default)(l.Button,{label:`${t?"Close":"Open"} Popup`}),isOpen:t,onChange:e=>t=e},(0,o.default)(l.Button,{label:"Close Popup",onclick:()=>{t=!t,a.raf.scheduleFullRedraw()}}))}}}class M{initial;options;constructor(e,t){this.initial=e,this.options=t}}class Y{view({attrs:e}){var e=e["label"],t=e.replaceAll(" ","").toLowerCase(),r="#!/widgets#"+t;return(0,o.default)(i.Anchor,{id:t,href:r},(0,o.default)("h2",e))}}class P{optValues={};opts;renderOptions(e){return 0===e.length?null:(0,o.default)(".widget-controls",(0,o.default)("h3","Options"),(0,o.default)("ul",e))}oninit({attrs:{initialOpts:e}}){if(this.opts=e)for(const r in e){var t;Object.prototype.hasOwnProperty.call(e,r)&&((t=e[r])instanceof M?this.optValues[r]=t.initial:"boolean"!=typeof t&&!(0,n.isString)(t)||(this.optValues[r]=t))}}view({attrs:e}){var{renderWidget:e,wide:t,label:r,description:n}=e,a=[];if(this.opts)for(const i in this.opts)Object.prototype.hasOwnProperty.call(this.opts,i)&&a.push((0,o.default)("li",this.renderControlForOption(i)));return[(0,o.default)(Y,{label:r}),n&&(0,o.default)("p",n),(0,o.default)(".widget-block",(0,o.default)("div",{class:(0,s.classNames)("widget-container",t&&"widget-container-wide")},e(this.optValues)),this.renderOptions(a))]}renderControlForOption(e){var t;return this.opts?(t=this.opts[e])instanceof M?this.renderEnumOption(e,t):"boolean"==typeof t?this.renderBooleanOption(e):(0,n.isString)(t)?this.renderStringOption(e):null:null}renderBooleanOption(e){return(0,o.default)(t.Checkbox,{checked:this.optValues[e],label:e,onchange:()=>{this.optValues[e]=!Boolean(this.optValues[e]),a.raf.scheduleFullRedraw()}})}renderStringOption(t){return(0,o.default)(E.TextInput,{placeholder:t,value:this.optValues[t],oninput:e=>{this.optValues[t]=e.target.value,a.raf.scheduleFullRedraw()}})}renderEnumOption(t,e){e=e.options.map(e=>(0,o.default)("option",{value:e},e));return(0,o.default)(T.Select,{value:this.optValues[t],onchange:e=>{e=e.target;this.optValues[t]=e.value,a.raf.scheduleFullRedraw()}},e)}}const J=[{name:"foo",size:"10MB",date:"2023-04-02"},{name:"bar",size:"123KB",date:"2023-04-08",children:[{name:"baz",size:"4KB",date:"2023-05-07"},{name:"qux",size:"18KB",date:"2023-05-28",children:[{name:"quux",size:"4KB",date:"2023-05-07"},{name:"corge",size:"18KB",date:"2023-05-28",children:[{name:"grault",size:"4KB",date:"2023-05-07"},{name:"garply",size:"18KB",date:"2023-05-28"},{name:"waldo",size:"87KB",date:"2023-05-02"}]}]}]},{name:"fred",size:"8KB",date:"2022-12-27"}];let N={offset:0,rows:[]};function Z(){const t=["foo","bar","baz"];let r="";return{view:()=>(0,o.default)(G.TagInput,{tags:t,value:r,onTagAdd:e=>{t.push(e),r="",a.raf.scheduleFullRedraw()},onChange:e=>{r=e},onTagRemove:e=>{t.splice(e,1),a.raf.scheduleFullRedraw()}})}}function Q({attrs:e}){let t=0;return{view:()=>(0,o.default)(V.SegmentedButtons,{...e,options:[{label:"Yes"},{label:"Maybe"},{label:"No"}],selectedOption:t,onOptionSelected:e=>{t=e,a.raf.scheduleFullRedraw()}})}}Ak.WidgetsPage=(0,F.createPage)({view(){return(0,o.default)(".widgets-page",(0,o.default)("h1","Widgets"),(0,o.default)(P,{label:"Button",renderWidget:({label:e,icon:t,rightIcon:r,...n})=>(0,o.default)(l.Button,{icon:R(t,"send"),rightIcon:R(r,"arrow_forward"),label:R(e,"Button",""),...n}),initialOpts:{label:!0,icon:!0,rightIcon:!1,disabled:!1,intent:new M(w.Intent.None,Object.values(w.Intent)),active:!1,compact:!1,loading:!1}}),(0,o.default)(P,{label:"Segmented Buttons",description:`
          Segmented buttons are a group of buttons where one of them is
          'selected'; they act similar to a set of radio buttons.
        `,renderWidget:e=>(0,o.default)(Q,e),initialOpts:{disabled:!1}}),(0,o.default)(P,{label:"Checkbox",renderWidget:e=>(0,o.default)(t.Checkbox,{label:"Checkbox",...e}),initialOpts:{disabled:!1}}),(0,o.default)(P,{label:"Switch",renderWidget:({label:e,...t})=>(0,o.default)(v.Switch,{label:R(e,"Switch"),...t}),initialOpts:{label:!0,disabled:!1}}),(0,o.default)(P,{label:"Text Input",renderWidget:({placeholder:e,...t})=>(0,o.default)(E.TextInput,{placeholder:R(e,"Placeholder...",""),...t}),initialOpts:{placeholder:!0,disabled:!1}}),(0,o.default)(P,{label:"Select",renderWidget:e=>(0,o.default)(T.Select,e,[(0,o.default)("option",{value:"foo",label:"Foo"}),(0,o.default)("option",{value:"bar",label:"Bar"}),(0,o.default)("option",{value:"baz",label:"Baz"})]),initialOpts:{disabled:!1}}),(0,o.default)(P,{label:"Filterable Select",renderWidget:()=>(0,o.default)(T.FilterableSelect,{values:["foo","bar","baz"],onSelected:()=>{}})}),(0,o.default)(P,{label:"Empty State",renderWidget:({header:e,content:t})=>(0,o.default)(u.EmptyState,{title:R(e,"No search results found...")},R(t,(0,o.default)(l.Button,{label:"Try again"}))),initialOpts:{header:!0,content:!0}}),(0,o.default)(P,{label:"Anchor",renderWidget:({icon:e})=>(0,o.default)(i.Anchor,{icon:R(e,"open_in_new"),href:"https://perfetto.dev/docs/",target:"_blank"},"Docs"),initialOpts:{icon:!0}}),(0,o.default)(P,{label:"Table",renderWidget:()=>(0,o.default)(B.TableShowcase),initialOpts:{},wide:!0}),(0,o.default)(P,{label:"Portal",description:`A portal is a div rendered out of normal flow
          of the hierarchy.`,renderWidget:e=>(0,o.default)(z,e),initialOpts:{absolute:!0,zIndex:!0,top:!0}}),(0,o.default)(P,{label:"Popup",description:`A popup is a nicely styled portal element whose position is
        dynamically updated to appear to float alongside a specific element on
        the page, even as the element is moved and scrolled around.`,renderWidget:e=>(0,o.default)(_.Popup,{trigger:(0,o.default)(l.Button,{label:"Toggle Popup"}),...e},(0,o.default)("",{style:{width:"200px"}},`Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
      tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim
      veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea
      commodo consequat.Duis aute irure dolor in reprehenderit in voluptate
      velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat
      cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id
      est laborum.`)),initialOpts:{position:new M(_.PopupPosition.Auto,Object.values(_.PopupPosition)),closeOnEscape:!0,closeOnOutsideClick:!0}}),(0,o.default)(P,{label:"Controlled Popup",description:`The open/close state of a controlled popup is passed in via
        the 'isOpen' attribute. This means we can get open or close the popup
        from wherever we like. E.g. from a button inside the popup.
        Keeping this state external also means we can modify other parts of the
        page depending on whether the popup is open or not, such as the text
        on this button.
        Note, this is the same component as the popup above, but used in
        controlled mode.`,renderWidget:e=>(0,o.default)(K,e),initialOpts:{}}),(0,o.default)(P,{label:"Icon",renderWidget:e=>(0,o.default)(p.Icon,{icon:"star",...e}),initialOpts:{filled:!1}}),(0,o.default)(P,{label:"MultiSelect panel",renderWidget:({...e})=>(0,o.default)(m.MultiSelect,{options:Object.entries(I).map(([e,t])=>({id:e,name:e,checked:t})),onChange:e=>{e.forEach(({id:e,checked:t})=>{I[e]=t}),a.raf.scheduleFullRedraw()},...e}),initialOpts:{repeatCheckedItemsAtTop:!1,fixedSize:!1}}),(0,o.default)(P,{label:"Popup with MultiSelect",renderWidget:({icon:e,...t})=>(0,o.default)(m.PopupMultiSelect,{options:Object.entries(I).map(([e,t])=>({id:e,name:e,checked:t})),popupPosition:_.PopupPosition.Top,label:"Multi Select",icon:R(e,r.Icons.LibraryAddCheck),onChange:e=>{e.forEach(({id:e,checked:t})=>{I[e]=t}),a.raf.scheduleFullRedraw()},...t}),initialOpts:{icon:!0,showNumSelected:!0,repeatCheckedItemsAtTop:!1}}),(0,o.default)(P,{label:"PopupMenu",renderWidget:()=>(0,o.default)(U.PopupMenuButton,{icon:"description",items:[{itemType:"regular",text:"New",callback:()=>{}},{itemType:"regular",text:"Open",callback:()=>{}},{itemType:"regular",text:"Save",callback:()=>{}},{itemType:"regular",text:"Delete",callback:()=>{}},{itemType:"group",text:"Share",itemId:"foo",children:[{itemType:"regular",text:"Friends",callback:()=>{}},{itemType:"regular",text:"Family",callback:()=>{}},{itemType:"regular",text:"Everyone",callback:()=>{}}]}]})}),(0,o.default)(P,{label:"Menu",renderWidget:()=>(0,o.default)(h.Menu,(0,o.default)(h.MenuItem,{label:"New",icon:"add"}),(0,o.default)(h.MenuItem,{label:"Open",icon:"folder_open"}),(0,o.default)(h.MenuItem,{label:"Save",icon:"save",disabled:!0}),(0,o.default)(h.MenuDivider),(0,o.default)(h.MenuItem,{label:"Delete",icon:"delete"}),(0,o.default)(h.MenuDivider),(0,o.default)(h.MenuItem,{label:"Share",icon:"share"},(0,o.default)(h.MenuItem,{label:"Everyone",icon:"public"}),(0,o.default)(h.MenuItem,{label:"Friends",icon:"group"}),(0,o.default)(h.MenuItem,{label:"Specific people",icon:"person_add"},(0,o.default)(h.MenuItem,{label:"Alice",icon:"person"}),(0,o.default)(h.MenuItem,{label:"Bob",icon:"person"}))),(0,o.default)(h.MenuItem,{label:"More",icon:"more_horiz"},(0,o.default)(h.MenuItem,{label:"Query",icon:"database"}),(0,o.default)(h.MenuItem,{label:"Download",icon:"download"}),(0,o.default)(h.MenuItem,{label:"Clone",icon:"copy_all"})))}),(0,o.default)(P,{label:"PopupMenu2",renderWidget:e=>(0,o.default)(h.PopupMenu2,{trigger:(0,o.default)(l.Button,{label:"Menu",rightIcon:r.Icons.ContextMenu}),...e},(0,o.default)(h.MenuItem,{label:"New",icon:"add"}),(0,o.default)(h.MenuItem,{label:"Open",icon:"folder_open"}),(0,o.default)(h.MenuItem,{label:"Save",icon:"save",disabled:!0}),(0,o.default)(h.MenuDivider),(0,o.default)(h.MenuItem,{label:"Delete",icon:"delete"}),(0,o.default)(h.MenuDivider),(0,o.default)(h.MenuItem,{label:"Share",icon:"share"},(0,o.default)(h.MenuItem,{label:"Everyone",icon:"public"}),(0,o.default)(h.MenuItem,{label:"Friends",icon:"group"}),(0,o.default)(h.MenuItem,{label:"Specific people",icon:"person_add"},(0,o.default)(h.MenuItem,{label:"Alice",icon:"person"}),(0,o.default)(h.MenuItem,{label:"Bob",icon:"person"}))),(0,o.default)(h.MenuItem,{label:"More",icon:"more_horiz"},(0,o.default)(h.MenuItem,{label:"Query",icon:"database"}),(0,o.default)(h.MenuItem,{label:"Download",icon:"download"}),(0,o.default)(h.MenuItem,{label:"Clone",icon:"copy_all"}))),initialOpts:{popupPosition:new M(_.PopupPosition.Bottom,Object.values(_.PopupPosition))}}),(0,o.default)(P,{label:"Spinner",description:`Simple spinner, rotates forever.
            Width and height match the font size.`,renderWidget:({fontSize:e,easing:t})=>(0,o.default)("",{style:{fontSize:e}},(0,o.default)(b.Spinner,{easing:t})),initialOpts:{fontSize:new M("16px",["12px","16px","24px","32px","64px","128px"]),easing:!1}}),(0,o.default)(P,{label:"Tree",description:`Hierarchical tree with left and right values aligned to
        a grid.`,renderWidget:e=>(0,o.default)(A.Tree,e,(0,o.default)(A.TreeNode,{left:"Name",right:"my_event",icon:"badge"}),(0,o.default)(A.TreeNode,{left:"CPU",right:"2",icon:"memory"}),(0,o.default)(A.TreeNode,{left:"Start time",right:"1s 435ms",icon:"schedule"}),(0,o.default)(A.TreeNode,{left:"Duration",right:"86ms",icon:"timer"}),(0,o.default)(A.TreeNode,{left:"SQL",right:(0,o.default)(h.PopupMenu2,{popupPosition:_.PopupPosition.RightStart,trigger:(0,o.default)(i.Anchor,{icon:r.Icons.ContextMenu},"SELECT * FROM raw WHERE id = 123")},(0,o.default)(h.MenuItem,{label:"Copy SQL Query",icon:"content_copy"}),(0,o.default)(h.MenuItem,{label:"Execute Query in new tab",icon:"open_in_new"}))}),(0,o.default)(A.TreeNode,{icon:"account_tree",left:"Process",right:(0,o.default)(i.Anchor,{icon:"open_in_new"},"/bin/foo[789]")}),(0,o.default)(A.TreeNode,{left:"Thread",right:(0,o.default)(i.Anchor,{icon:"open_in_new"},"my_thread[456]")}),(0,o.default)(A.TreeNode,{left:"Args",summary:"foo: string, baz: string, quux: string[4]"},(0,o.default)(A.TreeNode,{left:"foo",right:"bar"}),(0,o.default)(A.TreeNode,{left:"baz",right:"qux"}),(0,o.default)(A.TreeNode,{left:"quux",summary:"string[4]"},(0,o.default)(A.TreeNode,{left:"[0]",right:"corge"}),(0,o.default)(A.TreeNode,{left:"[1]",right:"grault"}),(0,o.default)(A.TreeNode,{left:"[2]",right:"garply"}),(0,o.default)(A.TreeNode,{left:"[3]",right:"waldo"}))),(0,o.default)(A.LazyTreeNode,{left:"Lazy",icon:"bedtime",fetchData:async()=>(await new Promise(e=>setTimeout(e,1e3)),()=>(0,o.default)(A.TreeNode,{left:"foo"}))}),(0,o.default)(A.LazyTreeNode,{left:"Dynamic",unloadOnCollapse:!0,icon:"bedtime",fetchData:async()=>(await new Promise(e=>setTimeout(e,1e3)),()=>(0,o.default)(A.TreeNode,{left:"foo"}))}),function e(){return(0,o.default)(A.LazyTreeNode,{left:"Recursive",right:"...",fetchData:async()=>()=>e()})}()),wide:!0}),(0,o.default)(P,{label:"Form",renderWidget:()=>x("form")}),(0,o.default)(P,{label:"Nested Popups",renderWidget:()=>(0,o.default)(_.Popup,{trigger:(0,o.default)(l.Button,{label:"Open the popup"})},(0,o.default)(h.PopupMenu2,{trigger:(0,o.default)(l.Button,{label:"Select an option"})},(0,o.default)(h.MenuItem,{label:"Option 1"}),(0,o.default)(h.MenuItem,{label:"Option 2"})),(0,o.default)(l.Button,{label:"Done",dismissPopup:!0}))}),(0,o.default)(P,{label:"Callout",renderWidget:()=>(0,o.default)(e.Callout,{icon:"info"},"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla rhoncus tempor neque, sed malesuada eros dapibus vel. Aliquam in ligula vitae tortor porttitor laoreet iaculis finibus est.")}),(0,o.default)(P,{label:"Editor",renderWidget:()=>(0,o.default)(c.Editor)}),(0,o.default)(P,{label:"VegaView",renderWidget:e=>(0,o.default)(L.VegaView,{spec:function(e){switch(e){case O.BarChart:return`
{
  "$schema": "https://vega.github.io/schema/vega/v5.json",
  "description": "A basic bar chart example, with value labels shown upon mouse hover.",
  "width": 400,
  "height": 200,
  "padding": 5,

  "data": [
    {
      "name": "table"
    }
  ],

  "signals": [
    {
      "name": "tooltip",
      "value": {},
      "on": [
        {"events": "rect:mouseover", "update": "datum"},
        {"events": "rect:mouseout",  "update": "{}"}
      ]
    }
  ],

  "scales": [
    {
      "name": "xscale",
      "type": "band",
      "domain": {"data": "table", "field": "category"},
      "range": "width",
      "padding": 0.05,
      "round": true
    },
    {
      "name": "yscale",
      "domain": {"data": "table", "field": "amount"},
      "nice": true,
      "range": "height"
    }
  ],

  "axes": [
    { "orient": "bottom", "scale": "xscale" },
    { "orient": "left", "scale": "yscale" }
  ],

  "marks": [
    {
      "type": "rect",
      "from": {"data":"table"},
      "encode": {
        "enter": {
          "x": {"scale": "xscale", "field": "category"},
          "width": {"scale": "xscale", "band": 1},
          "y": {"scale": "yscale", "field": "amount"},
          "y2": {"scale": "yscale", "value": 0}
        },
        "update": {
          "fill": {"value": "steelblue"}
        },
        "hover": {
          "fill": {"value": "red"}
        }
      }
    },
    {
      "type": "text",
      "encode": {
        "enter": {
          "align": {"value": "center"},
          "baseline": {"value": "bottom"},
          "fill": {"value": "#333"}
        },
        "update": {
          "x": {"scale": "xscale", "signal": "tooltip.category", "band": 0.5},
          "y": {"scale": "yscale", "signal": "tooltip.amount", "offset": -2},
          "text": {"signal": "tooltip.amount"},
          "fillOpacity": [
            {"test": "datum === tooltip", "value": 0},
            {"value": 1}
          ]
        }
      }
    }
  ]
}
`;case O.BarChartLite:return`
{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "A simple bar chart with embedded data.",
  "data": {
    "name": "table"
  },
  "mark": "bar",
  "encoding": {
    "x": {"field": "category", "type": "nominal", "axis": {"labelAngle": 0}},
    "y": {"field": "amount", "type": "quantitative"}
  }
}
`;case O.Broken:return`{
  "description": 123
}
`;default:throw new Error("Unhandled case: "+e)}}(e.exampleSpec),data:function(e){switch(e){case C.English:return W;case C.Polish:return q;case C.Empty:return $;default:throw new Error("Unhandled case: "+e)}}(e.exampleData)}),initialOpts:{exampleSpec:new M(O.BarChart,Object.values(O)),exampleData:new M(C.English,Object.values(C))}}),(0,o.default)(P,{label:"Form within PopupMenu2",description:`A form placed inside a popup menu works just fine,
              and the cancel/submit buttons also dismiss the popup. A bit more
              margin is added around it too, which improves the look and feel.`,renderWidget:()=>(0,o.default)(h.PopupMenu2,{trigger:(0,o.default)(l.Button,{label:"Popup!"})},(0,o.default)(h.MenuItem,{label:"Open form..."},x("popup-form")))}),(0,o.default)(P,{label:"Hotkey",renderWidget:e=>{var t;return"auto"===e.platform?(0,o.default)(f.HotkeyGlyphs,{hotkey:e.hotkey}):(t=e.platform,(0,o.default)(f.HotkeyGlyphs,{hotkey:e.hotkey,spoof:t}))},initialOpts:{hotkey:"Mod+Shift+P",platform:new M("auto",["auto","Mac","PC"])}}),(0,o.default)(P,{label:"Text Paragraph",description:`A basic formatted text paragraph with wrapping. If
              it is desirable to preserve the original text format/line breaks,
              set the compressSpace attribute to false.`,renderWidget:e=>(0,o.default)(S.TextParagraph,{text:`Lorem ipsum dolor sit amet, consectetur adipiscing
                         elit. Nulla rhoncus tempor neque, sed malesuada eros
                         dapibus vel. Aliquam in ligula vitae tortor porttitor
                         laoreet iaculis finibus est.`,compressSpace:e.compressSpace}),initialOpts:{compressSpace:!0}}),(0,o.default)(P,{label:"Multi Paragraph Text",description:"A wrapper for multiple paragraph widgets.",renderWidget:()=>(0,o.default)(S.MultiParagraphText,(0,o.default)(S.TextParagraph,{text:`Lorem ipsum dolor sit amet, consectetur adipiscing
                         elit. Nulla rhoncus tempor neque, sed malesuada eros
                         dapibus vel. Aliquam in ligula vitae tortor porttitor
                         laoreet iaculis finibus est.`,compressSpace:!0}),(0,o.default)(S.TextParagraph,{text:`Sed ut perspiciatis unde omnis iste natus error sit
                         voluptatem accusantium doloremque laudantium, totam rem
                         aperiam, eaque ipsa quae ab illo inventore veritatis et
                         quasi architecto beatae vitae dicta sunt explicabo.
                         Nemo enim ipsam voluptatem quia voluptas sit aspernatur
                         aut odit aut fugit, sed quia consequuntur magni dolores
                         eos qui ratione voluptatem sequi nesciunt.`,compressSpace:!0}))}),(0,o.default)(P,{label:"Modal",description:"A helper for modal dialog.",renderWidget:()=>(0,o.default)(D)}),(0,o.default)(P,{label:"TreeTable",description:"Hierarchical tree with multiple columns",renderWidget:()=>{var e={rows:J,getChildren:e=>e.children,columns:[{name:"Name",getData:e=>e.name},{name:"Size",getData:e=>e.size},{name:"Date",getData:e=>e.date}]};return(0,o.default)(j.TreeTable,e)}}),(0,o.default)(P,{label:"VirtualTable",description:"Virtualized table for efficient rendering of large datasets",renderWidget:()=>{var e={columns:[{header:"x",width:"4em"},{header:"x^2",width:"8em"}],rows:N.rows,firstRowOffset:N.offset,rowHeight:20,numRows:5e5,style:{height:"200px"},onReload:(t,r)=>{var n=[];for(let e=t;e<t+r;e++)n.push({id:e,cells:[e,e**2]});N={offset:t,rows:n},a.raf.scheduleFullRedraw()}};return(0,o.default)(H.VirtualTable,e)}}),(0,o.default)(P,{label:"Tag Input",description:`
          TagInput displays Tag elements inside an input, followed by an
          interactive text input. The container is styled to look like a
          TextInput, but the actual editable element appears after the last tag.
          Clicking anywhere on the container will focus the text input.`,renderWidget:()=>(0,o.default)(Z)}))}});class D{static counter=0;static log(e){var t,r=document.getElementById("mwlogs");r&&r instanceof HTMLTextAreaElement&&(t=(new Date).toLocaleTimeString(),r.value+=`[${t}] ${e}
`,r.scrollTop=r.scrollHeight)}static showModalDialog(e=!1){const t="N="+ ++D.counter;D.log("Open "+t);let r;if(e)r=(0,o.default)(".modal-pre","Content of the modal dialog.\nEnd of content");else{const n={oninit:function(e){e.state.progress=(e.state.progress||0)+1},view:function(e){return e.state.progress=(e.state.progress+1)%100,a.raf.scheduleFullRedraw(),(0,o.default)("div",(0,o.default)("div","You should see an animating progress bar"),(0,o.default)("progress",{value:e.state.progress,max:100}))}};r=()=>(0,o.default)(n)}(0,g.showModal)({title:"Modal dialog "+t,buttons:[{text:"OK",action:()=>D.log("OK "+t)},{text:"Cancel",action:()=>D.log("Cancel "+t)},{text:"Show another now",action:()=>D.showModalDialog()},{text:"Show another in 2s",action:()=>setTimeout(()=>D.showModalDialog(),2e3)}],content:r}).then(()=>D.log("Close "+t))}view(){return(0,o.default)("div",{style:{display:"flex","flex-direction":"column",width:"100%"}},(0,o.default)("textarea",{id:"mwlogs",readonly:"readonly",rows:"8",placeholder:"Logs will appear here"}),(0,o.default)("input[type=button]",{value:"Show modal (static)",onclick:()=>D.showModalDialog(!0)}),(0,o.default)("input[type=button]",{value:"Show modal (dynamic)",onclick:()=>D.showModalDialog(!1)}))}}function x(e){return(0,o.default)(d.Form,{submitLabel:"Submit",submitIcon:"send",cancelLabel:"Cancel",resetLabel:"Reset",onSubmit:()=>window.alert("Form submitted!")},(0,o.default)(d.FormLabel,{for:e+"-foo"},"Foo"),(0,o.default)(E.TextInput,{id:e+"-foo"}),(0,o.default)(d.FormLabel,{for:e+"-bar"},"Bar"),(0,o.default)(T.Select,{id:e+"-bar"},[(0,o.default)("option",{value:"foo",label:"Foo"}),(0,o.default)("option",{value:"bar",label:"Bar"}),(0,o.default)("option",{value:"baz",label:"Baz"})]))}return Ak}return t(function(){if(!wk){wk=1,Object.defineProperty(pe,"__esModule",{value:!0});var r=or;he||(he=1,Symbol.dispose??=Symbol("Symbol.dispose"),Symbol.asyncDispose??=Symbol("Symbol.asyncDispose")),pt(),$h(),$b();const s=r.__importDefault(ae()),e=Wa(),l=ee(),c=ne(),u=Aa(),d=gp(),f=YS(),p=eE(),h=re(),g=QS(),m=ie(),_=ZE(),y=Tl(),T=ZA(),b=uA(),v=function(){if(!XA){XA=1,Object.defineProperty(e1,"__esModule",{value:!0}),e1.registerDebugGlobals=function(){window.getSchema=i.getSchema,window.m=r.default,window.globals=s.globals,window.Actions=n.Actions,window.produce=t.produce,window.pluginManager=a.pluginManager,window.raf=o.raf};var e=or;const t=_e(),r=e.__importDefault(ae()),n=ne(),a=gp(),i=r1(),o=ie(),s=oe()}return e1}(),E=M_(),S=function(){if(!n1){n1=1,Object.defineProperty(a1,"__esModule",{value:!0}),a1.installFileDropHandler=function(){window.ondragenter=e=>{e.preventDefault(),e.stopPropagation(),t=e.target,r(e)&&document.body.classList.add("filedrag")},window.ondragleave=e=>{e.preventDefault(),e.stopPropagation(),e.target===t&&document.body.classList.remove("filedrag")},window.ondrop=e=>{var t;e.preventDefault(),e.stopPropagation(),document.body.classList.remove("filedrag"),e.dataTransfer&&r(e)&&(t=e.dataTransfer.files[0])&&a.globals.dispatch(n.Actions.openTraceFromFile({file:t})),e.preventDefault()},window.ondragover=e=>{e.preventDefault(),e.stopPropagation()}};const n=ne(),a=oe();let t=null;function r(e){if(e.dataTransfer&&e.dataTransfer.types)for(const t of e.dataTransfer.types)if("Files"===t)return 1}}return a1}(),A=function(){if(!o1){o1=1,Object.defineProperty(s1,"__esModule",{value:!0}),s1.FlagsPage=void 0;const n=or.__importDefault(ae()),t=To(),r=re(),a=ie();var e=c1();const i=So();class o{view(e){var t=i.Router.parseUrl(window.location.href);const r=e.attrs;e=t.subpage==="/"+r.id?".focused":"";return(0,n.default)(".flag-widget"+e,{id:r.id},(0,n.default)("label",r.label),(0,n.default)("select",{onchange:e=>{e=e.target.value;r.onSelect(e),a.raf.scheduleFullRedraw()}},r.options.map(e=>{var t=e.id===r.selected;return(0,n.default)("option",{value:e.id,selected:t},e.name)})),(0,n.default)(".description",r.description))}}class s{view(e){const t=e.attrs.flag;e=t.defaultValue?"Enabled":"Disabled";return(0,n.default)(o,{label:t.name,id:t.id,description:t.description,options:[{id:r.OverrideState.DEFAULT,name:`Default (${e})`},{id:r.OverrideState.TRUE,name:"Enabled"},{id:r.OverrideState.FALSE,name:"Disabled"}],selected:t.overriddenState(),onSelect:e=>{switch(e){case r.OverrideState.TRUE:t.set(!0);break;case r.OverrideState.FALSE:t.set(!1);break;default:case r.OverrideState.DEFAULT:t.reset()}}})}}s1.FlagsPage=(0,e.createPage)({view(){var e=(0,t.channelChanged)();return(0,n.default)(".flags-page",(0,n.default)(".flags-content",(0,n.default)("h1","Feature flags"),e&&[(0,n.default)("h2","Please reload for your changes to take effect")],(0,n.default)(o,{label:"Release channel",id:"releaseChannel",description:["Which release channel of the UI to use. See ",(0,n.default)("a",{href:"https://perfetto.dev/docs/visualization/perfetto-ui-release-process"},"Release Process")," for more information."],options:[{id:"stable",name:"Stable (default)"},{id:"canary",name:"Canary"},{id:"autopush",name:"Autopush"}],selected:(0,t.getNextChannel)(),onSelect:e=>(0,t.setChannel)(e)}),(0,n.default)("button",{onclick:()=>{r.featureFlags.resetAll(),a.raf.scheduleFullRedraw()}},"Reset all below"),r.featureFlags.allFlags().map(e=>(0,n.default)(s,{flag:e}))))},oncreate(e){var t=i.Router.parseUrl(window.location.href),t=/[/](\w+)/.exec(t.subpage)?.slice(1,2)[0];t&&(e=e.dom.querySelector("#"+t))&&e.scrollIntoView({block:"center"})}})}return s1}(),O=oe(),C=function(){if(!u1){u1=1,Object.defineProperty(d1,"__esModule",{value:!0}),d1.HomePage=d1.Hints=void 0;const r=or.__importDefault(ae()),n=To(),a=se(),i=dT(),o=oe();var e=c1();class s{view(){return(0,r.default)(".home-page-hints",(0,r.default)(".tagline","New!"),(0,r.default)("ul",(0,r.default)("li","New updated ",(0,r.default)(a.Anchor,{href:"https://perfetto.dev/docs/visualization/perfetto-ui#tabs-v2"},"tabs")," are extensible and user friendly."),(0,r.default)("li","Use ",(0,r.default)(i.HotkeyGlyphs,{hotkey:"W"}),(0,r.default)(i.HotkeyGlyphs,{hotkey:"A"}),(0,r.default)(i.HotkeyGlyphs,{hotkey:"S"}),(0,r.default)(i.HotkeyGlyphs,{hotkey:"D"})," to navigate the trace."),(0,r.default)("li","Try the ",(0,r.default)(a.Anchor,{href:"https://perfetto.dev/docs/visualization/perfetto-ui#command-palette"},"command palette,")," press ",(0,r.default)(i.HotkeyGlyphs,{hotkey:"!Mod+Shift+P"}),".")))}}function t(e){var t=(0,n.getNextChannel)()===e?"[checked=true]":"";return[(0,r.default)(`input[type=radio][name=chan][id=chan_${e}]`+t,{onchange:()=>{(0,n.setChannel)(e)}}),(0,r.default)(`label[for=chan_${e}]`,e)]}d1.Hints=s,d1.HomePage=(0,e.createPage)({view(){return(0,r.default)(".page.home-page",(0,r.default)(".home-page-center",(0,r.default)(".home-page-title",(0,r.default)(`img.logo[src=${o.globals.root}assets/logo-3d.png]`),"Perfetto"),(0,r.default)(s),(0,r.default)(".channel-select",(0,r.default)("","Feeling adventurous? Try our bleeding edge Canary version"),(0,r.default)("fieldset",t("stable"),t("canary"),(0,r.default)(".highlight")),(0,r.default)(".home-page-reload"+((0,n.channelChanged)()?".show":""),"You need to reload the page for the changes to have effect"))),(0,r.default)("a.privacy",{href:"https://policies.google.com/privacy",target:"_blank"},"Privacy policy"))}})}return d1}(),k=function(){if(!f1){f1=1,Object.defineProperty(p1,"__esModule",{value:!0}),p1.InsightsPage=void 0;const t=or.__importDefault(ae());var e=c1();p1.InsightsPage=(0,e.createPage)({view(){return(0,t.default)(".insights-page")}})}return p1}(),w=T1(),R=E1(),U=O1(),B=gO(),I=eC(),j=yC(),M=So(),H=vC(),G=function(){if(!EC){EC=1,Object.defineProperty(SC,"__esModule",{value:!0}),SC.TraceInfoPage=void 0;const o=or.__importDefault(ae()),a=ie(),i=oe();var e=c1(),t=Z();const s={name:t.UNKNOWN,value:t.UNKNOWN,description:t.UNKNOWN,idx:t.UNKNOWN,severity:t.UNKNOWN,source:t.UNKNOWN};class l{data;constructor({attrs:e}){var t=r("StatsSection");void 0!==t&&(e=`
      select
        name,
        value,
        cast(ifnull(idx, '') as text) as idx,
        description,
        severity,
        source from stats
      where ${e.sqlConstraints||"1=1"}
      order by name, idx
    `,t.query(e).then(e=>{for(var t=[],r=e.iter(s);r.valid();r.next())t.push(n(r,s));this.data=t,a.raf.scheduleFullRedraw()}))}view({attrs:e}){var t=this.data;return void 0===t||0===t.length?(0,o.default)(""):(t=t.map(e=>{var t=[],r=(Boolean(e.description)&&t.push((0,o.default)("i.material-icons.contextual-help","help_outline")),""!==e.idx?`[${e.idx}]`:"");return(0,o.default)("tr",(0,o.default)("td.name",{title:e.description},e.name+r,t),(0,o.default)("td",""+e.value),(0,o.default)("td",`${e.severity} (${e.source})`))}),(0,o.default)("section"+e.cssClass,(0,o.default)("h2",e.title),(0,o.default)("h3",e.subTitle),(0,o.default)("table",(0,o.default)("thead",(0,o.default)("tr",(0,o.default)("td","Name"),(0,o.default)("td","Value"),(0,o.default)("td","Type"))),(0,o.default)("tbody",t))))}}class c{view(){if(i.globals.metricError)return(0,o.default)("section.errors",(0,o.default)("h2","Metric Errors"),(0,o.default)("h3","One or more metrics were not computed successfully:"),(0,o.default)("div.metric-error",i.globals.metricError))}}const u={name:t.UNKNOWN,value:t.UNKNOWN};class d{data;constructor(){var e=r("StatsSection");void 0!==e&&e.query(`
      with metadata_with_priorities as (
        select
          name,
          ifnull(str_value, cast(int_value as text)) as value,
          name in (
            "trace_size_bytes", 
            "cr-os-arch",
            "cr-os-name",
            "cr-os-version",
            "cr-physical-memory",
            "cr-product-version",
            "cr-hardware-class"
          ) as priority 
        from metadata
      )
      select
        name,
        value
      from metadata_with_priorities 
      order by
        priority desc,
        name
    `).then(e=>{for(var t=[],r=e.iter(u);r.valid();r.next())t.push(n(r,u));this.data=t,a.raf.scheduleFullRedraw()})}view(){var e=this.data;return void 0===e||0===e.length?(0,o.default)(""):(e=e.map(e=>(0,o.default)("tr",(0,o.default)("td.name",""+e.name),(0,o.default)("td",""+e.value))),(0,o.default)("section",(0,o.default)("h2","System info and metadata"),(0,o.default)("table",(0,o.default)("thead",(0,o.default)("tr",(0,o.default)("td","Name"),(0,o.default)("td","Value"))),(0,o.default)("tbody",e))))}}const f={package_name:t.UNKNOWN,uid:t.UNKNOWN,current_mode:t.UNKNOWN,standard_mode_supported:t.UNKNOWN,standard_mode_downscale:t.UNKNOWN,standard_mode_use_angle:t.UNKNOWN,standard_mode_fps:t.UNKNOWN,perf_mode_supported:t.UNKNOWN,perf_mode_downscale:t.UNKNOWN,perf_mode_use_angle:t.UNKNOWN,perf_mode_fps:t.UNKNOWN,battery_mode_supported:t.UNKNOWN,battery_mode_downscale:t.UNKNOWN,battery_mode_use_angle:t.UNKNOWN,battery_mode_fps:t.UNKNOWN};class p{data;constructor(){var e=r("StatsSection");void 0!==e&&e.query(`
      select
        package_name,
        uid,
        current_mode,
        standard_mode_supported,
        standard_mode_downscale,
        standard_mode_use_angle,
        standard_mode_fps,
        perf_mode_supported,
        perf_mode_downscale,
        perf_mode_use_angle,
        perf_mode_fps,
        battery_mode_supported,
        battery_mode_downscale,
        battery_mode_use_angle,
        battery_mode_fps
      from android_game_intervention_list
    `).then(e=>{for(var t=[],r=e.iter(f);r.valid();r.next())t.push(n(r,f));this.data=t,a.raf.scheduleFullRedraw()})}view(){var e=this.data;if(void 0===e||0===e.length)return(0,o.default)("");var t=[];let r="",n="",a="";for(const i of e)r=i.standard_mode_supported?`angle=${i.standard_mode_use_angle},downscale=${i.standard_mode_downscale},fps=`+i.standard_mode_fps:"Not supported",n=i.perf_mode_supported?`angle=${i.perf_mode_use_angle},downscale=${i.perf_mode_downscale},fps=`+i.perf_mode_fps:"Not supported",a=i.battery_mode_supported?`angle=${i.battery_mode_use_angle},downscale=${i.battery_mode_downscale},fps=`+i.battery_mode_fps:"Not supported",1===i.current_mode?i.current_mode="Standard":2===i.current_mode?i.current_mode="Performance":3===i.current_mode&&(i.current_mode="Battery"),t.push((0,o.default)("tr",(0,o.default)("td.name",""+i.package_name),(0,o.default)("td",""+i.current_mode),(0,o.default)("td",r),(0,o.default)("td",n),(0,o.default)("td",a)));return(0,o.default)("section",(0,o.default)("h2","Game Intervention List"),(0,o.default)("table",(0,o.default)("thead",(0,o.default)("tr",(0,o.default)("td","Name"),(0,o.default)("td","Current mode"),(0,o.default)("td","Standard mode interventions"),(0,o.default)("td","Performance mode interventions"),(0,o.default)("td","Battery mode interventions"))),(0,o.default)("tbody",t)))}}const h={packageName:t.UNKNOWN,versionCode:t.UNKNOWN,debuggable:t.UNKNOWN,profileableFromShell:t.UNKNOWN};class g{packageList;constructor(){var e=r("StatsSection");void 0!==e&&this.loadData(e)}async loadData(e){for(var t=[],r=(await e.query(`
      select
        package_name as packageName,
        version_code as versionCode,
        debuggable,
        profileable_from_shell as profileableFromShell
      from package_list
    `)).iter(h);r.valid();r.next())t.push(n(r,h));this.packageList=t,a.raf.scheduleFullRedraw()}view(){var e=this.packageList;if(void 0!==e&&0!==e.length)return e=e.map(e=>(0,o.default)("tr",(0,o.default)("td.name",""+e.packageName),(0,o.default)("td",""+e.versionCode),(0,o.default)("td",`${e.debuggable?"debuggable":""} `+(e.profileableFromShell?"profileable":"")))),(0,o.default)("section",(0,o.default)("h2","Package list"),(0,o.default)("table",(0,o.default)("thead",(0,o.default)("tr",(0,o.default)("td","Name"),(0,o.default)("td","Version code"),(0,o.default)("td","Flags"))),(0,o.default)("tbody",e)))}}function r(e){var t=i.globals.getCurrentEngine();if(void 0!==t)return t=t.id,i.globals.engines.get(t)?.getProxy(e)}function n(e,t){var r={};for(const n of Object.keys(t))r[n]=e[n];return r}SC.TraceInfoPage=(0,e.createPage)({view(){return(0,o.default)(".trace-info-page",(0,o.default)(c),(0,o.default)(l,{queryId:"info_errors",title:"Import errors",cssClass:".errors",subTitle:`The following errors have been encountered while importing the
               trace. These errors are usually non-fatal but indicate that one
               or more tracks might be missing or showing erroneous data.`,sqlConstraints:"severity = 'error' and value > 0"}),(0,o.default)(l,{queryId:"info_data_losses",title:"Data losses",cssClass:".errors",subTitle:`These counters are collected at trace recording time. The trace
               data for one or more data sources was dropped and hence some
               track contents will be incomplete.`,sqlConstraints:"severity = 'data_loss' and value > 0"}),(0,o.default)(d),(0,o.default)(g),(0,o.default)(p),(0,o.default)(l,{queryId:"info_all",title:"Debugging stats",cssClass:"",subTitle:`Debugging statistics such as trace buffer usage and metrics
                     coming from the TraceProcessor importer stages.`,sqlConstraints:""}))}})}return SC}(),V=RC(),W=Tk(),q=Ek(),$=Ik(),z=KE(),K=de(),P=h.featureFlags.register({id:"cspAllowAnyWebsocketPort",name:"Relax Content Security Policy for 127.0.0.1:*",description:"Allows simultaneous usage of several trace_processor_shell -D --http-port 1234 by opening https://ui.perfetto.dev/#!/?rpc_port=1234",defaultValue:!1});{(0,y.setScheduleFullRedraw)(()=>m.raf.scheduleFullRedraw());{let e=["http://127.0.0.1:9001","ws://127.0.0.1:9001"];P.get()&&(i=M.Router.parseUrl(window.location.href),/^\d+$/.exec(i.args.rpc_port??""))&&(e=["http://127.0.0.1:"+i.args.rpc_port,"ws://127.0.0.1:"+i.args.rpc_port]);var n,a,i={"default-src":["'self'","'sha256-LirUKeorCU4uRNtNzr8tlB11uy8rzrdmqHCX38JSwHY='"],"script-src":["'self'","'unsafe-eval'","https://*.google.com","https://*.googleusercontent.com","https://www.googletagmanager.com","https://*.google-analytics.com"],"object-src":["none"],"connect-src":["'self'","ws://127.0.0.1:8037","https://*.google-analytics.com","https://*.googleapis.com","http://127.0.0.1:*","blob:","data:"].concat(e),"img-src":["'self'","data:","blob:","https://*.google-analytics.com","https://www.googletagmanager.com","https://*.googleapis.com"],"style-src":["'self'","'unsafe-inline'"],"navigate-to":["https://*.perfetto.dev","self"]},r=document.createElement("meta");r.httpEquiv="Content-Security-Policy";let t="";for([n,a]of Object.entries(i))t+=`${n} ${a.join(" ")}; `;r.content=t,document.head.appendChild(r)}const N=(0,e.defer)(),D=((i=document.createElement("link")).rel="stylesheet",i.href=O.globals.root+"perfetto.css",i.onload=()=>N.resolve(),i.onerror=e=>N.reject(e),(r=document.head.querySelector("#favicon"))instanceof HTMLLinkElement&&(r.href=O.globals.root+"assets/favicon.png"),(r=document.createElement("script")).src="https://storage.cloud.google.com/perfetto-ui-internal/is_internal_user.js",r.async=!0,r.onerror=()=>O.globals.logging.initialize(),r.onload=()=>O.globals.logging.initialize(),setTimeout(()=>O.globals.logging.initialize(),5e3),document.head.append(r,i),(0,l.addErrorHandler)(E.maybeShowErrorDialog),(0,l.addErrorHandler)(e=>O.globals.logging.logError(e)),window.addEventListener("error",e=>(0,l.reportError)(e)),window.addEventListener("unhandledrejection",e=>(0,l.reportError)(e)),new MessageChannel),x=((0,_.initWasm)(O.globals.root),(0,f.initController)(D.port1),r=M.Router.parseUrl(window.location.href),O.globals.embeddedMode="embedded"===r.args.mode,O.globals.hideSidebar=!0===r.args.hideSidebar,O.globals.initialize(L),O.globals.serviceWorkerController.install(),O.globals.store.subscribe(F),O.globals.publishRedraw=()=>m.raf.scheduleFullRedraw(),window.chrome&&chrome.runtime?chrome.runtime.connect("lfmkphfpdbjijhpomgecfikhfohaoine"):void 0);t(void 0!==x),x&&(x.onDisconnect.addListener(e=>{t(!1),chrome.runtime.lastError}),x.onMessage.addListener((e,t)=>{(0,p.isGetCategoriesResponse)(e)?O.globals.dispatch(c.Actions.setChromeCategories(e)):D.port2.postMessage(e)})),D.port2.onmessage=({data:e})=>{x&&x.postMessage(e)},(0,v.registerDebugGlobals)(),document.body.addEventListener("wheel",e=>{e.ctrlKey&&e.preventDefault()},{passive:!1}),N.then(()=>{{(0,b.initCssConstants)(),document.body.innerHTML="";const t=new M.Router({"/":C.HomePage,"/viewer":W.ViewerPage,"/record":h.RECORDING_V2_FLAG.get()?j.RecordPageV2:I.RecordPage,"/query":B.QueryPage,"/insights":k.InsightsPage,"/flags":A.FlagsPage,"/metrics":w.MetricsPage,"/info":G.TraceInfoPage,"/widgets":$.WidgetsPage,"/viz":q.VizPage,"/plugins":R.PluginsPage});if(t.onRouteChanged=o,m.raf.domRedraw=()=>{s.default.render(document.body,(0,s.default)(T.App,t.resolve()))},!location.origin.startsWith("http://localhost:")&&!location.origin.startsWith("http://127.0.0.1:")||O.globals.embeddedMode||O.globals.testing||(0,g.initLiveReload)(),!h.RECORDING_V2_FLAG.get()){(0,I.updateAvailableAdbDevices)();try{navigator.usb.addEventListener("connect",()=>(0,I.updateAvailableAdbDevices)()),navigator.usb.addEventListener("disconnect",()=>(0,I.updateAvailableAdbDevices)())}catch(e){console.error("WebUSB API not supported")}}var e=M.Router.parseUrl(window.location.href);void 0!==e.args.rpc_port&&(P.get()?z.HttpRpcEngine.rpcPort=e.args.rpc_port:(0,K.showModal)({title:"Using a different port requires a flag change",content:(0,s.default)("div",(0,s.default)("span","For security reasons before connecting to a non-standard TraceProcessor port you need to manually enable the flag to relax the Content Security Policy and restart the UI.")),buttons:[{text:"Take me to the flags page",primary:!0,action:()=>M.Router.navigate("#!/flags/cspAllowAnyWebsocketPort")}]})),(0,H.CheckHttpRpcConnection)().then(()=>{var e=M.Router.parseUrl(window.location.href),t=(O.globals.dispatch(c.Actions.maybeSetPendingDeeplink({ts:e.args.ts,tid:e.args.tid,dur:e.args.dur,pid:e.args.pid,query:e.args.query,visStart:e.args.visStart,visEnd:e.args.visEnd})),O.globals.embeddedMode||(0,S.installFileDropHandler)(),O.globals.getCurrentEngine());t&&"HTTP_RPC"===t.source.type||(window.addEventListener("message",U.postMessageHandler,{passive:!0}),o(e))}),s.default.render(document.body,(0,s.default)(T.App,t.resolve())),d.pluginManager.initialize()}}),O.globals.testing&&document.body.classList.add("testing")}function t(e){O.globals.dispatch(c.Actions.setExtensionAvailable({available:e}))}function o(t){m.raf.scheduleFullRedraw(),(0,V.maybeOpenTraceFromRoute)(t),t.fragment&&m.raf.addPendingCallback(()=>{var e=document.getElementById(t.fragment);e&&e.scrollIntoView()})}function L(e){e=e.map(t=>(0,u.traceEvent)("action."+t.type,()=>e=>{c.StateActions[t.type](e,t.args)},{args:(0,u.flattenArgs)(t.args)}));O.globals.store.edit(e)}function F(e,t){t!==e.state&&m.raf.scheduleFullRedraw(),setTimeout(f.runControllers,0)}}return pe}())}();
//# sourceMappingURL=frontend_bundle.js.map
