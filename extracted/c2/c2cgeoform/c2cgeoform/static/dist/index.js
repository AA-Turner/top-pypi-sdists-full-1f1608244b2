var c2cgeoform;(()=>{var t={4572:(t,e,i)=>{"use strict";i(2419),i(8128),i(5777),i(2681),i(5240),i(1368),i(6073),i(7739),i(4897),i(4925),i(1243),i(8978),i(3415),i(7452)},2419:(t,e,i)=>{i(9650),i(935),i(6064),i(7067),i(2642),i(3e3),i(8647),i(1895),i(8236),i(3822),i(5572),i(9318),i(5032),i(9073),i(1430),i(8451),i(8132),i(7482),i(5049),i(489),i(5502),i(571),i(6108),i(4509),i(7727),i(6701),i(4419),i(1933),i(3157),i(9497),i(4104),i(210),i(6576),i(4437),i(8050),i(6648),i(5771),i(2392),i(2335),i(4896),i(4521),i(9147),i(1318),i(4352),i(5327),i(7509),i(5909),i(9584),i(345),i(9134),i(7901),i(6592),i(2220),i(3483),i(957),i(2975),i(2405),i(7224),i(8872),i(4894),i(177),i(7360),i(9011),i(4591),i(7334),i(7083),i(9213),i(8437),i(9839),i(6549),i(2818),i(8543),i(3559),i(4153),i(3292),i(2346),i(9429),i(7849),i(8951),i(7899),i(3863),i(4570),i(6511),i(5853),i(7075),i(3504),i(4913),i(9813),i(8892),i(8888),i(1449),i(7874),i(4609),i(3706),i(9620),i(7762),i(5144),i(5369),i(6209),i(5165),i(8301),i(4116),i(8604),i(9638),i(4040),i(8305),i(4701),i(341),i(6517),i(3386),i(1632),i(9397),i(8163),i(5706),i(660),i(8699),i(4702),i(333),i(1220),i(2087),i(8066),i(8537),i(7925),i(2490),i(7103),i(2586),i(2552),i(4376),i(5153),i(1879),i(2650),i(1104),i(1883),i(5433),i(5e3),i(5932),i(5443),i(6316),t.exports=i(6094)},5777:(t,e,i)=>{i(9766),t.exports=i(6094).Array.flatMap},8128:(t,e,i)=>{i(9087),t.exports=i(6094).Array.includes},1243:(t,e,i)=>{i(7146),t.exports=i(6094).Object.entries},4897:(t,e,i)=>{i(4614),t.exports=i(6094).Object.getOwnPropertyDescriptors},4925:(t,e,i)=>{i(7594),t.exports=i(6094).Object.values},8978:(t,e,i)=>{"use strict";i(6517),i(8583),t.exports=i(6094).Promise.finally},5240:(t,e,i)=>{i(5693),t.exports=i(6094).String.padEnd},2681:(t,e,i)=>{i(5380),t.exports=i(6094).String.padStart},6073:(t,e,i)=>{i(521),t.exports=i(6094).String.trimRight},1368:(t,e,i)=>{i(62),t.exports=i(6094).String.trimLeft},7739:(t,e,i)=>{i(2820),t.exports=i(7960).f("asyncIterator")},3387:t=>{t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},5122:(t,e,i)=>{var n=i(5089);t.exports=function(t,e){if("number"!=typeof t&&"Number"!=n(t))throw TypeError(e);return+t}},8184:(t,e,i)=>{var n=i(7574)("unscopables"),s=Array.prototype;null==s[n]&&i(3341)(s,n,{}),t.exports=function(t){s[n][t]=!0}},8828:(t,e,i)=>{"use strict";var n=i(1212)(!0);t.exports=function(t,e,i){return e+(i?n(t,e).length:1)}},6440:t=>{t.exports=function(t,e,i,n){if(!(t instanceof e)||void 0!==n&&n in t)throw TypeError(i+": incorrect invocation!");return t}},4228:(t,e,i)=>{var n=i(3305);t.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},4438:(t,e,i)=>{"use strict";var n=i(8270),s=i(157),r=i(1485);t.exports=[].copyWithin||function(t,e){var i=n(this),o=r(i.length),a=s(t,o),h=s(e,o),l=arguments.length>2?arguments[2]:void 0,c=Math.min((void 0===l?o:s(l,o))-h,o-a),u=1;for(h<a&&a<h+c&&(u=-1,h+=c-1,a+=c-1);c-- >0;)h in i?i[a]=i[h]:delete i[a],a+=u,h+=u;return i}},5564:(t,e,i)=>{"use strict";var n=i(8270),s=i(157),r=i(1485);t.exports=function(t){for(var e=n(this),i=r(e.length),o=arguments.length,a=s(o>1?arguments[1]:void 0,i),h=o>2?arguments[2]:void 0,l=void 0===h?i:s(h,i);l>a;)e[a++]=t;return e}},1464:(t,e,i)=>{var n=i(7221),s=i(1485),r=i(157);t.exports=function(t){return function(e,i,o){var a,h=n(e),l=s(h.length),c=r(o,l);if(t&&i!=i){for(;l>c;)if((a=h[c++])!=a)return!0}else for(;l>c;c++)if((t||c in h)&&h[c]===i)return t||c||0;return!t&&-1}}},6179:(t,e,i)=>{var n=i(5052),s=i(1249),r=i(8270),o=i(1485),a=i(3191);t.exports=function(t,e){var i=1==t,h=2==t,l=3==t,c=4==t,u=6==t,d=5==t||u,g=e||a;return function(e,a,f){for(var p,_,m=r(e),y=s(m),v=n(a,f,3),x=o(y.length),M=0,w=i?g(e,x):h?g(e,0):void 0;x>M;M++)if((d||M in y)&&(_=v(p=y[M],M,m),t))if(i)w[M]=_;else if(_)switch(t){case 3:return!0;case 5:return p;case 6:return M;case 2:w.push(p)}else if(c)return!1;return u?-1:l||c?c:w}}},6543:(t,e,i)=>{var n=i(3387),s=i(8270),r=i(1249),o=i(1485);t.exports=function(t,e,i,a,h){n(e);var l=s(t),c=r(l),u=o(l.length),d=h?u-1:0,g=h?-1:1;if(i<2)for(;;){if(d in c){a=c[d],d+=g;break}if(d+=g,h?d<0:u<=d)throw TypeError("Reduce of empty array with no initial value")}for(;h?d>=0:u>d;d+=g)d in c&&(a=e(a,c[d],d,l));return a}},3606:(t,e,i)=>{var n=i(3305),s=i(7981),r=i(7574)("species");t.exports=function(t){var e;return s(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!s(e.prototype)||(e=void 0),n(e)&&null===(e=e[r])&&(e=void 0)),void 0===e?Array:e}},3191:(t,e,i)=>{var n=i(3606);t.exports=function(t,e){return new(n(t))(e)}},5538:(t,e,i)=>{"use strict";var n=i(3387),s=i(3305),r=i(4877),o=[].slice,a={};t.exports=Function.bind||function(t){var e=n(this),i=o.call(arguments,1),h=function(){var n=i.concat(o.call(arguments));return this instanceof h?function(t,e,i){if(!(e in a)){for(var n=[],s=0;s<e;s++)n[s]="a["+s+"]";a[e]=Function("F,a","return new F("+n.join(",")+")")}return a[e](t,i)}(e,n.length,n):r(e,n,t)};return s(e.prototype)&&(h.prototype=e.prototype),h}},4848:(t,e,i)=>{var n=i(5089),s=i(7574)("toStringTag"),r="Arguments"==n(function(){return arguments}());t.exports=function(t){var e,i,o;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),s))?i:r?n(e):"Object"==(o=n(e))&&"function"==typeof e.callee?"Arguments":o}},5089:t=>{var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},6197:(t,e,i)=>{"use strict";var n=i(7967).f,s=i(4719),r=i(6065),o=i(5052),a=i(6440),h=i(8790),l=i(8175),c=i(4970),u=i(5762),d=i(1763),g=i(2988).fastKey,f=i(2888),p=d?"_s":"size",_=function(t,e){var i,n=g(e);if("F"!==n)return t._i[n];for(i=t._f;i;i=i.n)if(i.k==e)return i};t.exports={getConstructor:function(t,e,i,l){var c=t((function(t,n){a(t,c,e,"_i"),t._t=e,t._i=s(null),t._f=void 0,t._l=void 0,t[p]=0,null!=n&&h(n,i,t[l],t)}));return r(c.prototype,{clear:function(){for(var t=f(this,e),i=t._i,n=t._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete i[n.i];t._f=t._l=void 0,t[p]=0},delete:function(t){var i=f(this,e),n=_(i,t);if(n){var s=n.n,r=n.p;delete i._i[n.i],n.r=!0,r&&(r.n=s),s&&(s.p=r),i._f==n&&(i._f=s),i._l==n&&(i._l=r),i[p]--}return!!n},forEach:function(t){f(this,e);for(var i,n=o(t,arguments.length>1?arguments[1]:void 0,3);i=i?i.n:this._f;)for(n(i.v,i.k,this);i&&i.r;)i=i.p},has:function(t){return!!_(f(this,e),t)}}),d&&n(c.prototype,"size",{get:function(){return f(this,e)[p]}}),c},def:function(t,e,i){var n,s,r=_(t,e);return r?r.v=i:(t._l=r={i:s=g(e,!0),k:e,v:i,p:n=t._l,n:void 0,r:!1},t._f||(t._f=r),n&&(n.n=r),t[p]++,"F"!==s&&(t._i[s]=r)),t},getEntry:_,setStrong:function(t,e,i){l(t,e,(function(t,i){this._t=f(t,e),this._k=i,this._l=void 0}),(function(){for(var t=this,e=t._k,i=t._l;i&&i.r;)i=i.p;return t._t&&(t._l=i=i?i.n:t._t._f)?c(0,"keys"==e?i.k:"values"==e?i.v:[i.k,i.v]):(t._t=void 0,c(1))}),i?"entries":"values",!i,!0),u(e)}}},9882:(t,e,i)=>{"use strict";var n=i(6065),s=i(2988).getWeak,r=i(4228),o=i(3305),a=i(6440),h=i(8790),l=i(6179),c=i(7917),u=i(2888),d=l(5),g=l(6),f=0,p=function(t){return t._l||(t._l=new _)},_=function(){this.a=[]},m=function(t,e){return d(t.a,(function(t){return t[0]===e}))};_.prototype={get:function(t){var e=m(this,t);if(e)return e[1]},has:function(t){return!!m(this,t)},set:function(t,e){var i=m(this,t);i?i[1]=e:this.a.push([t,e])},delete:function(t){var e=g(this.a,(function(e){return e[0]===t}));return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,i,r){var l=t((function(t,n){a(t,l,e,"_i"),t._t=e,t._i=f++,t._l=void 0,null!=n&&h(n,i,t[r],t)}));return n(l.prototype,{delete:function(t){if(!o(t))return!1;var i=s(t);return!0===i?p(u(this,e)).delete(t):i&&c(i,this._i)&&delete i[this._i]},has:function(t){if(!o(t))return!1;var i=s(t);return!0===i?p(u(this,e)).has(t):i&&c(i,this._i)}}),l},def:function(t,e,i){var n=s(r(e),!0);return!0===n?p(t).set(e,i):n[t._i]=i,t},ufstore:p}},8933:(t,e,i)=>{"use strict";var n=i(7526),s=i(2127),r=i(8859),o=i(6065),a=i(2988),h=i(8790),l=i(6440),c=i(3305),u=i(9448),d=i(8931),g=i(3844),f=i(8880);t.exports=function(t,e,i,p,_,m){var y=n[t],v=y,x=_?"set":"add",M=v&&v.prototype,w={},S=function(t){var e=M[t];r(M,t,"delete"==t||"has"==t?function(t){return!(m&&!c(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return m&&!c(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,i){return e.call(this,0===t?0:t,i),this})};if("function"==typeof v&&(m||M.forEach&&!u((function(){(new v).entries().next()})))){var C=new v,b=C[x](m?{}:-0,1)!=C,E=u((function(){C.has(1)})),P=d((function(t){new v(t)})),I=!m&&u((function(){for(var t=new v,e=5;e--;)t[x](e,e);return!t.has(-0)}));P||((v=e((function(e,i){l(e,v,t);var n=f(new y,e,v);return null!=i&&h(i,_,n[x],n),n}))).prototype=M,M.constructor=v),(E||I)&&(S("delete"),S("has"),_&&S("get")),(I||b)&&S(x),m&&M.clear&&delete M.clear}else v=p.getConstructor(e,t,_,x),o(v.prototype,i),a.NEED=!0;return g(v,t),w[t]=v,s(s.G+s.W+s.F*(v!=y),w),m||p.setStrong(v,t,_),v}},6094:t=>{var e=t.exports={version:"2.6.12"};"number"==typeof __e&&(__e=e)},7227:(t,e,i)=>{"use strict";var n=i(7967),s=i(1996);t.exports=function(t,e,i){e in t?n.f(t,e,s(0,i)):t[e]=i}},5052:(t,e,i)=>{var n=i(3387);t.exports=function(t,e,i){if(n(t),void 0===e)return t;switch(i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,s){return t.call(e,i,n,s)}}return function(){return t.apply(e,arguments)}}},5385:(t,e,i)=>{"use strict";var n=i(9448),s=Date.prototype.getTime,r=Date.prototype.toISOString,o=function(t){return t>9?t:"0"+t};t.exports=n((function(){return"0385-07-25T07:06:39.999Z"!=r.call(new Date(-50000000000001))}))||!n((function(){r.call(new Date(NaN))}))?function(){if(!isFinite(s.call(this)))throw RangeError("Invalid time value");var t=this,e=t.getUTCFullYear(),i=t.getUTCMilliseconds(),n=e<0?"-":e>9999?"+":"";return n+("00000"+Math.abs(e)).slice(n?-6:-4)+"-"+o(t.getUTCMonth()+1)+"-"+o(t.getUTCDate())+"T"+o(t.getUTCHours())+":"+o(t.getUTCMinutes())+":"+o(t.getUTCSeconds())+"."+(i>99?i:"0"+o(i))+"Z"}:r},107:(t,e,i)=>{"use strict";var n=i(4228),s=i(3048),r="number";t.exports=function(t){if("string"!==t&&t!==r&&"default"!==t)throw TypeError("Incorrect hint");return s(n(this),t!=r)}},3344:t=>{t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},1763:(t,e,i)=>{t.exports=!i(9448)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},6034:(t,e,i)=>{var n=i(3305),s=i(7526).document,r=n(s)&&n(s.createElement);t.exports=function(t){return r?s.createElement(t):{}}},6140:t=>{t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},5969:(t,e,i)=>{var n=i(1311),s=i(1060),r=i(8449);t.exports=function(t){var e=n(t),i=s.f;if(i)for(var o,a=i(t),h=r.f,l=0;a.length>l;)h.call(t,o=a[l++])&&e.push(o);return e}},2127:(t,e,i)=>{var n=i(7526),s=i(6094),r=i(3341),o=i(8859),a=i(5052),h="prototype",l=function(t,e,i){var c,u,d,g,f=t&l.F,p=t&l.G,_=t&l.S,m=t&l.P,y=t&l.B,v=p?n:_?n[e]||(n[e]={}):(n[e]||{})[h],x=p?s:s[e]||(s[e]={}),M=x[h]||(x[h]={});for(c in p&&(i=e),i)d=((u=!f&&v&&void 0!==v[c])?v:i)[c],g=y&&u?a(d,n):m&&"function"==typeof d?a(Function.call,d):d,v&&o(v,c,d,t&l.U),x[c]!=d&&r(x,c,g),m&&M[c]!=d&&(M[c]=d)};n.core=s,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},5203:(t,e,i)=>{var n=i(7574)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(i){try{return e[n]=!1,!"/./"[t](e)}catch(t){}}return!0}},9448:t=>{t.exports=function(t){try{return!!t()}catch(t){return!0}}},9228:(t,e,i)=>{"use strict";i(4116);var n=i(8859),s=i(3341),r=i(9448),o=i(3344),a=i(7574),h=i(9600),l=a("species"),c=!r((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),u=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var i="ab".split(t);return 2===i.length&&"a"===i[0]&&"b"===i[1]}();t.exports=function(t,e,i){var d=a(t),g=!r((function(){var e={};return e[d]=function(){return 7},7!=""[t](e)})),f=g?!r((function(){var e=!1,i=/a/;return i.exec=function(){return e=!0,null},"split"===t&&(i.constructor={},i.constructor[l]=function(){return i}),i[d](""),!e})):void 0;if(!g||!f||"replace"===t&&!c||"split"===t&&!u){var p=/./[d],_=i(o,d,""[t],(function(t,e,i,n,s){return e.exec===h?g&&!s?{done:!0,value:p.call(e,i,n)}:{done:!0,value:t.call(i,e,n)}:{done:!1}})),m=_[0],y=_[1];n(String.prototype,t,m),s(RegExp.prototype,d,2==e?function(t,e){return y.call(t,this,e)}:function(t){return y.call(t,this)})}}},1158:(t,e,i)=>{"use strict";var n=i(4228);t.exports=function(){var t=n(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},2322:(t,e,i)=>{"use strict";var n=i(7981),s=i(3305),r=i(1485),o=i(5052),a=i(7574)("isConcatSpreadable");t.exports=function t(e,i,h,l,c,u,d,g){for(var f,p,_=c,m=0,y=!!d&&o(d,g,3);m<l;){if(m in h){if(f=y?y(h[m],m,i):h[m],p=!1,s(f)&&(p=void 0!==(p=f[a])?!!p:n(f)),p&&u>0)_=t(e,i,f,r(f.length),_,u-1)-1;else{if(_>=9007199254740991)throw TypeError();e[_]=f}_++}m++}return _}},8790:(t,e,i)=>{var n=i(5052),s=i(7368),r=i(1508),o=i(4228),a=i(1485),h=i(762),l={},c={},u=t.exports=function(t,e,i,u,d){var g,f,p,_,m=d?function(){return t}:h(t),y=n(i,u,e?2:1),v=0;if("function"!=typeof m)throw TypeError(t+" is not iterable!");if(r(m)){for(g=a(t.length);g>v;v++)if((_=e?y(o(f=t[v])[0],f[1]):y(t[v]))===l||_===c)return _}else for(p=m.call(t);!(f=p.next()).done;)if((_=s(p,y,f.value,e))===l||_===c)return _};u.BREAK=l,u.RETURN=c},9461:(t,e,i)=>{t.exports=i(4556)("native-function-to-string",Function.toString)},7526:t=>{var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)},7917:t=>{var e={}.hasOwnProperty;t.exports=function(t,i){return e.call(t,i)}},3341:(t,e,i)=>{var n=i(7967),s=i(1996);t.exports=i(1763)?function(t,e,i){return n.f(t,e,s(1,i))}:function(t,e,i){return t[e]=i,t}},1308:(t,e,i)=>{var n=i(7526).document;t.exports=n&&n.documentElement},2956:(t,e,i)=>{t.exports=!i(1763)&&!i(9448)((function(){return 7!=Object.defineProperty(i(6034)("div"),"a",{get:function(){return 7}}).a}))},8880:(t,e,i)=>{var n=i(3305),s=i(5170).set;t.exports=function(t,e,i){var r,o=e.constructor;return o!==i&&"function"==typeof o&&(r=o.prototype)!==i.prototype&&n(r)&&s&&s(t,r),t}},4877:t=>{t.exports=function(t,e,i){var n=void 0===i;switch(e.length){case 0:return n?t():t.call(i);case 1:return n?t(e[0]):t.call(i,e[0]);case 2:return n?t(e[0],e[1]):t.call(i,e[0],e[1]);case 3:return n?t(e[0],e[1],e[2]):t.call(i,e[0],e[1],e[2]);case 4:return n?t(e[0],e[1],e[2],e[3]):t.call(i,e[0],e[1],e[2],e[3])}return t.apply(i,e)}},1249:(t,e,i)=>{var n=i(5089);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},1508:(t,e,i)=>{var n=i(906),s=i(7574)("iterator"),r=Array.prototype;t.exports=function(t){return void 0!==t&&(n.Array===t||r[s]===t)}},7981:(t,e,i)=>{var n=i(5089);t.exports=Array.isArray||function(t){return"Array"==n(t)}},3842:(t,e,i)=>{var n=i(3305),s=Math.floor;t.exports=function(t){return!n(t)&&isFinite(t)&&s(t)===t}},3305:t=>{t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},5411:(t,e,i)=>{var n=i(3305),s=i(5089),r=i(7574)("match");t.exports=function(t){var e;return n(t)&&(void 0!==(e=t[r])?!!e:"RegExp"==s(t))}},7368:(t,e,i)=>{var n=i(4228);t.exports=function(t,e,i,s){try{return s?e(n(i)[0],i[1]):e(i)}catch(e){var r=t.return;throw void 0!==r&&n(r.call(t)),e}}},6032:(t,e,i)=>{"use strict";var n=i(4719),s=i(1996),r=i(3844),o={};i(3341)(o,i(7574)("iterator"),(function(){return this})),t.exports=function(t,e,i){t.prototype=n(o,{next:s(1,i)}),r(t,e+" Iterator")}},8175:(t,e,i)=>{"use strict";var n=i(2750),s=i(2127),r=i(8859),o=i(3341),a=i(906),h=i(6032),l=i(3844),c=i(627),u=i(7574)("iterator"),d=!([].keys&&"next"in[].keys()),g="keys",f="values",p=function(){return this};t.exports=function(t,e,i,_,m,y,v){h(i,e,_);var x,M,w,S=function(t){if(!d&&t in P)return P[t];switch(t){case g:case f:return function(){return new i(this,t)}}return function(){return new i(this,t)}},C=e+" Iterator",b=m==f,E=!1,P=t.prototype,I=P[u]||P["@@iterator"]||m&&P[m],T=I||S(m),R=m?b?S("entries"):T:void 0,A="Array"==e&&P.entries||I;if(A&&(w=c(A.call(new t)))!==Object.prototype&&w.next&&(l(w,C,!0),n||"function"==typeof w[u]||o(w,u,p)),b&&I&&I.name!==f&&(E=!0,T=function(){return I.call(this)}),n&&!v||!d&&!E&&P[u]||o(P,u,T),a[e]=T,a[C]=p,m)if(x={values:b?T:S(f),keys:y?T:S(g),entries:R},v)for(M in x)M in P||r(P,M,x[M]);else s(s.P+s.F*(d||E),e,x);return x}},8931:(t,e,i)=>{var n=i(7574)("iterator"),s=!1;try{var r=[7][n]();r.return=function(){s=!0},Array.from(r,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!s)return!1;var i=!1;try{var r=[7],o=r[n]();o.next=function(){return{done:i=!0}},r[n]=function(){return o},t(r)}catch(t){}return i}},4970:t=>{t.exports=function(t,e){return{value:e,done:!!t}}},906:t=>{t.exports={}},2750:t=>{t.exports=!1},5551:t=>{var e=Math.expm1;t.exports=!e||e(10)>22025.465794806718||e(10)<22025.465794806718||-2e-17!=e(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:e},2122:(t,e,i)=>{var n=i(3733),s=Math.pow,r=s(2,-52),o=s(2,-23),a=s(2,127)*(2-o),h=s(2,-126);t.exports=Math.fround||function(t){var e,i,s=Math.abs(t),l=n(t);return s<h?l*(s/h/o+1/r-1/r)*h*o:(i=(e=(1+o/r)*s)-(e-s))>a||i!=i?l*(1/0):l*i}},1473:t=>{t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},3733:t=>{t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},2988:(t,e,i)=>{var n=i(4415)("meta"),s=i(3305),r=i(7917),o=i(7967).f,a=0,h=Object.isExtensible||function(){return!0},l=!i(9448)((function(){return h(Object.preventExtensions({}))})),c=function(t){o(t,n,{value:{i:"O"+ ++a,w:{}}})},u=t.exports={KEY:n,NEED:!1,fastKey:function(t,e){if(!s(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!r(t,n)){if(!h(t))return"F";if(!e)return"E";c(t)}return t[n].i},getWeak:function(t,e){if(!r(t,n)){if(!h(t))return!0;if(!e)return!1;c(t)}return t[n].w},onFreeze:function(t){return l&&u.NEED&&h(t)&&!r(t,n)&&c(t),t}}},1384:(t,e,i)=>{var n=i(7526),s=i(2780).set,r=n.MutationObserver||n.WebKitMutationObserver,o=n.process,a=n.Promise,h="process"==i(5089)(o);t.exports=function(){var t,e,i,l=function(){var n,s;for(h&&(n=o.domain)&&n.exit();t;){s=t.fn,t=t.next;try{s()}catch(n){throw t?i():e=void 0,n}}e=void 0,n&&n.enter()};if(h)i=function(){o.nextTick(l)};else if(!r||n.navigator&&n.navigator.standalone)if(a&&a.resolve){var c=a.resolve(void 0);i=function(){c.then(l)}}else i=function(){s.call(n,l)};else{var u=!0,d=document.createTextNode("");new r(l).observe(d,{characterData:!0}),i=function(){d.data=u=!u}}return function(n){var s={fn:n,next:void 0};e&&(e.next=s),t||(t=s,i()),e=s}}},4258:(t,e,i)=>{"use strict";var n=i(3387);function s(t){var e,i;this.promise=new t((function(t,n){if(void 0!==e||void 0!==i)throw TypeError("Bad Promise constructor");e=t,i=n})),this.resolve=n(e),this.reject=n(i)}t.exports.f=function(t){return new s(t)}},8206:(t,e,i)=>{"use strict";var n=i(1763),s=i(1311),r=i(1060),o=i(8449),a=i(8270),h=i(1249),l=Object.assign;t.exports=!l||i(9448)((function(){var t={},e={},i=Symbol(),n="abcdefghijklmnopqrst";return t[i]=7,n.split("").forEach((function(t){e[t]=t})),7!=l({},t)[i]||Object.keys(l({},e)).join("")!=n}))?function(t,e){for(var i=a(t),l=arguments.length,c=1,u=r.f,d=o.f;l>c;)for(var g,f=h(arguments[c++]),p=u?s(f).concat(u(f)):s(f),_=p.length,m=0;_>m;)g=p[m++],n&&!d.call(f,g)||(i[g]=f[g]);return i}:l},4719:(t,e,i)=>{var n=i(4228),s=i(1626),r=i(6140),o=i(766)("IE_PROTO"),a=function(){},h="prototype",l=function(){var t,e=i(6034)("iframe"),n=r.length;for(e.style.display="none",i(1308).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),l=t.F;n--;)delete l[h][r[n]];return l()};t.exports=Object.create||function(t,e){var i;return null!==t?(a[h]=n(t),i=new a,a[h]=null,i[o]=t):i=l(),void 0===e?i:s(i,e)}},7967:(t,e,i)=>{var n=i(4228),s=i(2956),r=i(3048),o=Object.defineProperty;e.f=i(1763)?Object.defineProperty:function(t,e,i){if(n(t),e=r(e,!0),n(i),s)try{return o(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(t[e]=i.value),t}},1626:(t,e,i)=>{var n=i(7967),s=i(4228),r=i(1311);t.exports=i(1763)?Object.defineProperties:function(t,e){s(t);for(var i,o=r(e),a=o.length,h=0;a>h;)n.f(t,i=o[h++],e[i]);return t}},8641:(t,e,i)=>{var n=i(8449),s=i(1996),r=i(7221),o=i(3048),a=i(7917),h=i(2956),l=Object.getOwnPropertyDescriptor;e.f=i(1763)?l:function(t,e){if(t=r(t),e=o(e,!0),h)try{return l(t,e)}catch(t){}if(a(t,e))return s(!n.f.call(t,e),t[e])}},4765:(t,e,i)=>{var n=i(7221),s=i(9415).f,r={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return o&&"[object Window]"==r.call(t)?function(t){try{return s(t)}catch(t){return o.slice()}}(t):s(n(t))}},9415:(t,e,i)=>{var n=i(4561),s=i(6140).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,s)}},1060:(t,e)=>{e.f=Object.getOwnPropertySymbols},627:(t,e,i)=>{var n=i(7917),s=i(8270),r=i(766)("IE_PROTO"),o=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=s(t),n(t,r)?t[r]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?o:null}},4561:(t,e,i)=>{var n=i(7917),s=i(7221),r=i(1464)(!1),o=i(766)("IE_PROTO");t.exports=function(t,e){var i,a=s(t),h=0,l=[];for(i in a)i!=o&&n(a,i)&&l.push(i);for(;e.length>h;)n(a,i=e[h++])&&(~r(l,i)||l.push(i));return l}},1311:(t,e,i)=>{var n=i(4561),s=i(6140);t.exports=Object.keys||function(t){return n(t,s)}},8449:(t,e)=>{e.f={}.propertyIsEnumerable},923:(t,e,i)=>{var n=i(2127),s=i(6094),r=i(9448);t.exports=function(t,e){var i=(s.Object||{})[t]||Object[t],o={};o[t]=e(i),n(n.S+n.F*r((function(){i(1)})),"Object",o)}},3854:(t,e,i)=>{var n=i(1763),s=i(1311),r=i(7221),o=i(8449).f;t.exports=function(t){return function(e){for(var i,a=r(e),h=s(a),l=h.length,c=0,u=[];l>c;)i=h[c++],n&&!o.call(a,i)||u.push(t?[i,a[i]]:a[i]);return u}}},6222:(t,e,i)=>{var n=i(9415),s=i(1060),r=i(4228),o=i(7526).Reflect;t.exports=o&&o.ownKeys||function(t){var e=n.f(r(t)),i=s.f;return i?e.concat(i(t)):e}},3589:(t,e,i)=>{var n=i(7526).parseFloat,s=i(629).trim;t.exports=1/n(i(832)+"-0")!=-1/0?function(t){var e=s(String(t),3),i=n(e);return 0===i&&"-"==e.charAt(0)?-0:i}:n},2738:(t,e,i)=>{var n=i(7526).parseInt,s=i(629).trim,r=i(832),o=/^[-+]?0[xX]/;t.exports=8!==n(r+"08")||22!==n(r+"0x16")?function(t,e){var i=s(String(t),3);return n(i,e>>>0||(o.test(i)?16:10))}:n},128:t=>{t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},5957:(t,e,i)=>{var n=i(4228),s=i(3305),r=i(4258);t.exports=function(t,e){if(n(t),s(e)&&e.constructor===t)return e;var i=r.f(t);return(0,i.resolve)(e),i.promise}},1996:t=>{t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},6065:(t,e,i)=>{var n=i(8859);t.exports=function(t,e,i){for(var s in e)n(t,s,e[s],i);return t}},8859:(t,e,i)=>{var n=i(7526),s=i(3341),r=i(7917),o=i(4415)("src"),a=i(9461),h="toString",l=(""+a).split(h);i(6094).inspectSource=function(t){return a.call(t)},(t.exports=function(t,e,i,a){var h="function"==typeof i;h&&(r(i,"name")||s(i,"name",e)),t[e]!==i&&(h&&(r(i,o)||s(i,o,t[e]?""+t[e]:l.join(String(e)))),t===n?t[e]=i:a?t[e]?t[e]=i:s(t,e,i):(delete t[e],s(t,e,i)))})(Function.prototype,h,(function(){return"function"==typeof this&&this[o]||a.call(this)}))},2535:(t,e,i)=>{"use strict";var n=i(4848),s=RegExp.prototype.exec;t.exports=function(t,e){var i=t.exec;if("function"==typeof i){var r=i.call(t,e);if("object"!=typeof r)throw new TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==n(t))throw new TypeError("RegExp#exec called on incompatible receiver");return s.call(t,e)}},9600:(t,e,i)=>{"use strict";var n,s,r=i(1158),o=RegExp.prototype.exec,a=String.prototype.replace,h=o,l="lastIndex",c=(n=/a/,s=/b*/g,o.call(n,"a"),o.call(s,"a"),0!==n[l]||0!==s[l]),u=void 0!==/()??/.exec("")[1];(c||u)&&(h=function(t){var e,i,n,s,h=this;return u&&(i=new RegExp("^"+h.source+"$(?!\\s)",r.call(h))),c&&(e=h[l]),n=o.call(h,t),c&&n&&(h[l]=h.global?n.index+n[0].length:e),u&&n&&n.length>1&&a.call(n[0],i,(function(){for(s=1;s<arguments.length-2;s++)void 0===arguments[s]&&(n[s]=void 0)})),n}),t.exports=h},7359:t=>{t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},5170:(t,e,i)=>{var n=i(3305),s=i(4228),r=function(t,e){if(s(t),!n(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,n){try{(n=i(5052)(Function.call,i(8641).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,i){return r(t,i),e?t.__proto__=i:n(t,i),t}}({},!1):void 0),check:r}},5762:(t,e,i)=>{"use strict";var n=i(7526),s=i(7967),r=i(1763),o=i(7574)("species");t.exports=function(t){var e=n[t];r&&e&&!e[o]&&s.f(e,o,{configurable:!0,get:function(){return this}})}},3844:(t,e,i)=>{var n=i(7967).f,s=i(7917),r=i(7574)("toStringTag");t.exports=function(t,e,i){t&&!s(t=i?t:t.prototype,r)&&n(t,r,{configurable:!0,value:e})}},766:(t,e,i)=>{var n=i(4556)("keys"),s=i(4415);t.exports=function(t){return n[t]||(n[t]=s(t))}},4556:(t,e,i)=>{var n=i(6094),s=i(7526),r="__core-js_shared__",o=s[r]||(s[r]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:n.version,mode:i(2750)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},9190:(t,e,i)=>{var n=i(4228),s=i(3387),r=i(7574)("species");t.exports=function(t,e){var i,o=n(t).constructor;return void 0===o||null==(i=n(o)[r])?e:s(i)}},6884:(t,e,i)=>{"use strict";var n=i(9448);t.exports=function(t,e){return!!t&&n((function(){e?t.call(null,(function(){}),1):t.call(null)}))}},1212:(t,e,i)=>{var n=i(7087),s=i(3344);t.exports=function(t){return function(e,i){var r,o,a=String(s(e)),h=n(i),l=a.length;return h<0||h>=l?t?"":void 0:(r=a.charCodeAt(h))<55296||r>56319||h+1===l||(o=a.charCodeAt(h+1))<56320||o>57343?t?a.charAt(h):r:t?a.slice(h,h+2):o-56320+(r-55296<<10)+65536}}},8942:(t,e,i)=>{var n=i(5411),s=i(3344);t.exports=function(t,e,i){if(n(e))throw TypeError("String#"+i+" doesn't accept regex!");return String(s(t))}},2468:(t,e,i)=>{var n=i(2127),s=i(9448),r=i(3344),o=/"/g,a=function(t,e,i,n){var s=String(r(t)),a="<"+e;return""!==i&&(a+=" "+i+'="'+String(n).replace(o,"&quot;")+'"'),a+">"+s+"</"+e+">"};t.exports=function(t,e){var i={};i[t]=e(a),n(n.P+n.F*s((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3})),"String",i)}},4472:(t,e,i)=>{var n=i(1485),s=i(7926),r=i(3344);t.exports=function(t,e,i,o){var a=String(r(t)),h=a.length,l=void 0===i?" ":String(i),c=n(e);if(c<=h||""==l)return a;var u=c-h,d=s.call(l,Math.ceil(u/l.length));return d.length>u&&(d=d.slice(0,u)),o?d+a:a+d}},7926:(t,e,i)=>{"use strict";var n=i(7087),s=i(3344);t.exports=function(t){var e=String(s(this)),i="",r=n(t);if(r<0||r==1/0)throw RangeError("Count can't be negative");for(;r>0;(r>>>=1)&&(e+=e))1&r&&(i+=e);return i}},629:(t,e,i)=>{var n=i(2127),s=i(3344),r=i(9448),o=i(832),a="["+o+"]",h=RegExp("^"+a+a+"*"),l=RegExp(a+a+"*$"),c=function(t,e,i){var s={},a=r((function(){return!!o[t]()||"​"!="​"[t]()})),h=s[t]=a?e(u):o[t];i&&(s[i]=h),n(n.P+n.F*a,"String",s)},u=c.trim=function(t,e){return t=String(s(t)),1&e&&(t=t.replace(h,"")),2&e&&(t=t.replace(l,"")),t};t.exports=c},832:t=>{t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},2780:(t,e,i)=>{var n,s,r,o=i(5052),a=i(4877),h=i(1308),l=i(6034),c=i(7526),u=c.process,d=c.setImmediate,g=c.clearImmediate,f=c.MessageChannel,p=c.Dispatch,_=0,m={},y="onreadystatechange",v=function(){var t=+this;if(m.hasOwnProperty(t)){var e=m[t];delete m[t],e()}},x=function(t){v.call(t.data)};d&&g||(d=function(t){for(var e=[],i=1;arguments.length>i;)e.push(arguments[i++]);return m[++_]=function(){a("function"==typeof t?t:Function(t),e)},n(_),_},g=function(t){delete m[t]},"process"==i(5089)(u)?n=function(t){u.nextTick(o(v,t,1))}:p&&p.now?n=function(t){p.now(o(v,t,1))}:f?(r=(s=new f).port2,s.port1.onmessage=x,n=o(r.postMessage,r,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(n=function(t){c.postMessage(t+"","*")},c.addEventListener("message",x,!1)):n=y in l("script")?function(t){h.appendChild(l("script"))[y]=function(){h.removeChild(this),v.call(t)}}:function(t){setTimeout(o(v,t,1),0)}),t.exports={set:d,clear:g}},157:(t,e,i)=>{var n=i(7087),s=Math.max,r=Math.min;t.exports=function(t,e){return(t=n(t))<0?s(t+e,0):r(t,e)}},3133:(t,e,i)=>{var n=i(7087),s=i(1485);t.exports=function(t){if(void 0===t)return 0;var e=n(t),i=s(e);if(e!==i)throw RangeError("Wrong length!");return i}},7087:t=>{var e=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:e)(t)}},7221:(t,e,i)=>{var n=i(1249),s=i(3344);t.exports=function(t){return n(s(t))}},1485:(t,e,i)=>{var n=i(7087),s=Math.min;t.exports=function(t){return t>0?s(n(t),9007199254740991):0}},8270:(t,e,i)=>{var n=i(3344);t.exports=function(t){return Object(n(t))}},3048:(t,e,i)=>{var n=i(3305);t.exports=function(t,e){if(!n(t))return t;var i,s;if(e&&"function"==typeof(i=t.toString)&&!n(s=i.call(t)))return s;if("function"==typeof(i=t.valueOf)&&!n(s=i.call(t)))return s;if(!e&&"function"==typeof(i=t.toString)&&!n(s=i.call(t)))return s;throw TypeError("Can't convert object to primitive value")}},7209:(t,e,i)=>{"use strict";if(i(1763)){var n=i(2750),s=i(7526),r=i(9448),o=i(2127),a=i(237),h=i(8032),l=i(5052),c=i(6440),u=i(1996),d=i(3341),g=i(6065),f=i(7087),p=i(1485),_=i(3133),m=i(157),y=i(3048),v=i(7917),x=i(4848),M=i(3305),w=i(8270),S=i(1508),C=i(4719),b=i(627),E=i(9415).f,P=i(762),I=i(4415),T=i(7574),R=i(6179),A=i(1464),F=i(9190),L=i(5165),k=i(906),O=i(8931),D=i(5762),N=i(5564),G=i(4438),j=i(7967),z=i(8641),B=j.f,W=z.f,q=s.RangeError,X=s.TypeError,U=s.Uint8Array,V="ArrayBuffer",K="Shared"+V,Y="BYTES_PER_ELEMENT",Z="prototype",H=Array[Z],J=h.ArrayBuffer,$=h.DataView,Q=R(0),tt=R(2),et=R(3),it=R(4),nt=R(5),st=R(6),rt=A(!0),ot=A(!1),at=L.values,ht=L.keys,lt=L.entries,ct=H.lastIndexOf,ut=H.reduce,dt=H.reduceRight,gt=H.join,ft=H.sort,pt=H.slice,_t=H.toString,mt=H.toLocaleString,yt=T("iterator"),vt=T("toStringTag"),xt=I("typed_constructor"),Mt=I("def_constructor"),wt=a.CONSTR,St=a.TYPED,Ct=a.VIEW,bt="Wrong length!",Et=R(1,(function(t,e){return At(F(t,t[Mt]),e)})),Pt=r((function(){return 1===new U(new Uint16Array([1]).buffer)[0]})),It=!!U&&!!U[Z].set&&r((function(){new U(1).set({})})),Tt=function(t,e){var i=f(t);if(i<0||i%e)throw q("Wrong offset!");return i},Rt=function(t){if(M(t)&&St in t)return t;throw X(t+" is not a typed array!")},At=function(t,e){if(!M(t)||!(xt in t))throw X("It is not a typed array constructor!");return new t(e)},Ft=function(t,e){return Lt(F(t,t[Mt]),e)},Lt=function(t,e){for(var i=0,n=e.length,s=At(t,n);n>i;)s[i]=e[i++];return s},kt=function(t,e,i){B(t,e,{get:function(){return this._d[i]}})},Ot=function(t){var e,i,n,s,r,o,a=w(t),h=arguments.length,c=h>1?arguments[1]:void 0,u=void 0!==c,d=P(a);if(null!=d&&!S(d)){for(o=d.call(a),n=[],e=0;!(r=o.next()).done;e++)n.push(r.value);a=n}for(u&&h>2&&(c=l(c,arguments[2],2)),e=0,i=p(a.length),s=At(this,i);i>e;e++)s[e]=u?c(a[e],e):a[e];return s},Dt=function(){for(var t=0,e=arguments.length,i=At(this,e);e>t;)i[t]=arguments[t++];return i},Nt=!!U&&r((function(){mt.call(new U(1))})),Gt=function(){return mt.apply(Nt?pt.call(Rt(this)):Rt(this),arguments)},jt={copyWithin:function(t,e){return G.call(Rt(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return it(Rt(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return N.apply(Rt(this),arguments)},filter:function(t){return Ft(this,tt(Rt(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return nt(Rt(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return st(Rt(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){Q(Rt(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return ot(Rt(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return rt(Rt(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return gt.apply(Rt(this),arguments)},lastIndexOf:function(t){return ct.apply(Rt(this),arguments)},map:function(t){return Et(Rt(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return ut.apply(Rt(this),arguments)},reduceRight:function(t){return dt.apply(Rt(this),arguments)},reverse:function(){for(var t,e=this,i=Rt(e).length,n=Math.floor(i/2),s=0;s<n;)t=e[s],e[s++]=e[--i],e[i]=t;return e},some:function(t){return et(Rt(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return ft.call(Rt(this),t)},subarray:function(t,e){var i=Rt(this),n=i.length,s=m(t,n);return new(F(i,i[Mt]))(i.buffer,i.byteOffset+s*i.BYTES_PER_ELEMENT,p((void 0===e?n:m(e,n))-s))}},zt=function(t,e){return Ft(this,pt.call(Rt(this),t,e))},Bt=function(t){Rt(this);var e=Tt(arguments[1],1),i=this.length,n=w(t),s=p(n.length),r=0;if(s+e>i)throw q(bt);for(;r<s;)this[e+r]=n[r++]},Wt={entries:function(){return lt.call(Rt(this))},keys:function(){return ht.call(Rt(this))},values:function(){return at.call(Rt(this))}},qt=function(t,e){return M(t)&&t[St]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},Xt=function(t,e){return qt(t,e=y(e,!0))?u(2,t[e]):W(t,e)},Ut=function(t,e,i){return!(qt(t,e=y(e,!0))&&M(i)&&v(i,"value"))||v(i,"get")||v(i,"set")||i.configurable||v(i,"writable")&&!i.writable||v(i,"enumerable")&&!i.enumerable?B(t,e,i):(t[e]=i.value,t)};wt||(z.f=Xt,j.f=Ut),o(o.S+o.F*!wt,"Object",{getOwnPropertyDescriptor:Xt,defineProperty:Ut}),r((function(){_t.call({})}))&&(_t=mt=function(){return gt.call(this)});var Vt=g({},jt);g(Vt,Wt),d(Vt,yt,Wt.values),g(Vt,{slice:zt,set:Bt,constructor:function(){},toString:_t,toLocaleString:Gt}),kt(Vt,"buffer","b"),kt(Vt,"byteOffset","o"),kt(Vt,"byteLength","l"),kt(Vt,"length","e"),B(Vt,vt,{get:function(){return this[St]}}),t.exports=function(t,e,i,h){var l=t+((h=!!h)?"Clamped":"")+"Array",u="get"+t,g="set"+t,f=s[l],m=f||{},y=f&&b(f),v=!f||!a.ABV,w={},S=f&&f[Z],P=function(t,i){B(t,i,{get:function(){return function(t,i){var n=t._d;return n.v[u](i*e+n.o,Pt)}(this,i)},set:function(t){return function(t,i,n){var s=t._d;h&&(n=(n=Math.round(n))<0?0:n>255?255:255&n),s.v[g](i*e+s.o,n,Pt)}(this,i,t)},enumerable:!0})};v?(f=i((function(t,i,n,s){c(t,f,l,"_d");var r,o,a,h,u=0,g=0;if(M(i)){if(!(i instanceof J||(h=x(i))==V||h==K))return St in i?Lt(f,i):Ot.call(f,i);r=i,g=Tt(n,e);var m=i.byteLength;if(void 0===s){if(m%e)throw q(bt);if((o=m-g)<0)throw q(bt)}else if((o=p(s)*e)+g>m)throw q(bt);a=o/e}else a=_(i),r=new J(o=a*e);for(d(t,"_d",{b:r,o:g,l:o,e:a,v:new $(r)});u<a;)P(t,u++)})),S=f[Z]=C(Vt),d(S,"constructor",f)):r((function(){f(1)}))&&r((function(){new f(-1)}))&&O((function(t){new f,new f(null),new f(1.5),new f(t)}),!0)||(f=i((function(t,i,n,s){var r;return c(t,f,l),M(i)?i instanceof J||(r=x(i))==V||r==K?void 0!==s?new m(i,Tt(n,e),s):void 0!==n?new m(i,Tt(n,e)):new m(i):St in i?Lt(f,i):Ot.call(f,i):new m(_(i))})),Q(y!==Function.prototype?E(m).concat(E(y)):E(m),(function(t){t in f||d(f,t,m[t])})),f[Z]=S,n||(S.constructor=f));var I=S[yt],T=!!I&&("values"==I.name||null==I.name),R=Wt.values;d(f,xt,!0),d(S,St,l),d(S,Ct,!0),d(S,Mt,f),(h?new f(1)[vt]==l:vt in S)||B(S,vt,{get:function(){return l}}),w[l]=f,o(o.G+o.W+o.F*(f!=m),w),o(o.S,l,{BYTES_PER_ELEMENT:e}),o(o.S+o.F*r((function(){m.of.call(f,1)})),l,{from:Ot,of:Dt}),Y in S||d(S,Y,e),o(o.P,l,jt),D(l),o(o.P+o.F*It,l,{set:Bt}),o(o.P+o.F*!T,l,Wt),n||S.toString==_t||(S.toString=_t),o(o.P+o.F*r((function(){new f(1).slice()})),l,{slice:zt}),o(o.P+o.F*(r((function(){return[1,2].toLocaleString()!=new f([1,2]).toLocaleString()}))||!r((function(){S.toLocaleString.call([1,2])}))),l,{toLocaleString:Gt}),k[l]=T?I:R,n||T||d(S,yt,R)}}else t.exports=function(){}},8032:(t,e,i)=>{"use strict";var n=i(7526),s=i(1763),r=i(2750),o=i(237),a=i(3341),h=i(6065),l=i(9448),c=i(6440),u=i(7087),d=i(1485),g=i(3133),f=i(9415).f,p=i(7967).f,_=i(5564),m=i(3844),y="ArrayBuffer",v="DataView",x="prototype",M="Wrong index!",w=n[y],S=n[v],C=n.Math,b=n.RangeError,E=n.Infinity,P=w,I=C.abs,T=C.pow,R=C.floor,A=C.log,F=C.LN2,L="buffer",k="byteLength",O="byteOffset",D=s?"_b":L,N=s?"_l":k,G=s?"_o":O;function j(t,e,i){var n,s,r,o=new Array(i),a=8*i-e-1,h=(1<<a)-1,l=h>>1,c=23===e?T(2,-24)-T(2,-77):0,u=0,d=t<0||0===t&&1/t<0?1:0;for((t=I(t))!=t||t===E?(s=t!=t?1:0,n=h):(n=R(A(t)/F),t*(r=T(2,-n))<1&&(n--,r*=2),(t+=n+l>=1?c/r:c*T(2,1-l))*r>=2&&(n++,r/=2),n+l>=h?(s=0,n=h):n+l>=1?(s=(t*r-1)*T(2,e),n+=l):(s=t*T(2,l-1)*T(2,e),n=0));e>=8;o[u++]=255&s,s/=256,e-=8);for(n=n<<e|s,a+=e;a>0;o[u++]=255&n,n/=256,a-=8);return o[--u]|=128*d,o}function z(t,e,i){var n,s=8*i-e-1,r=(1<<s)-1,o=r>>1,a=s-7,h=i-1,l=t[h--],c=127&l;for(l>>=7;a>0;c=256*c+t[h],h--,a-=8);for(n=c&(1<<-a)-1,c>>=-a,a+=e;a>0;n=256*n+t[h],h--,a-=8);if(0===c)c=1-o;else{if(c===r)return n?NaN:l?-E:E;n+=T(2,e),c-=o}return(l?-1:1)*n*T(2,c-e)}function B(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function W(t){return[255&t]}function q(t){return[255&t,t>>8&255]}function X(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function U(t){return j(t,52,8)}function V(t){return j(t,23,4)}function K(t,e,i){p(t[x],e,{get:function(){return this[i]}})}function Y(t,e,i,n){var s=g(+i);if(s+e>t[N])throw b(M);var r=t[D]._b,o=s+t[G],a=r.slice(o,o+e);return n?a:a.reverse()}function Z(t,e,i,n,s,r){var o=g(+i);if(o+e>t[N])throw b(M);for(var a=t[D]._b,h=o+t[G],l=n(+s),c=0;c<e;c++)a[h+c]=l[r?c:e-c-1]}if(o.ABV){if(!l((function(){w(1)}))||!l((function(){new w(-1)}))||l((function(){return new w,new w(1.5),new w(NaN),w.name!=y}))){for(var H,J=(w=function(t){return c(this,w),new P(g(t))})[x]=P[x],$=f(P),Q=0;$.length>Q;)(H=$[Q++])in w||a(w,H,P[H]);r||(J.constructor=w)}var tt=new S(new w(2)),et=S[x].setInt8;tt.setInt8(0,2147483648),tt.setInt8(1,2147483649),!tt.getInt8(0)&&tt.getInt8(1)||h(S[x],{setInt8:function(t,e){et.call(this,t,e<<24>>24)},setUint8:function(t,e){et.call(this,t,e<<24>>24)}},!0)}else w=function(t){c(this,w,y);var e=g(t);this._b=_.call(new Array(e),0),this[N]=e},S=function(t,e,i){c(this,S,v),c(t,w,v);var n=t[N],s=u(e);if(s<0||s>n)throw b("Wrong offset!");if(s+(i=void 0===i?n-s:d(i))>n)throw b("Wrong length!");this[D]=t,this[G]=s,this[N]=i},s&&(K(w,k,"_l"),K(S,L,"_b"),K(S,k,"_l"),K(S,O,"_o")),h(S[x],{getInt8:function(t){return Y(this,1,t)[0]<<24>>24},getUint8:function(t){return Y(this,1,t)[0]},getInt16:function(t){var e=Y(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=Y(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return B(Y(this,4,t,arguments[1]))},getUint32:function(t){return B(Y(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return z(Y(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return z(Y(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){Z(this,1,t,W,e)},setUint8:function(t,e){Z(this,1,t,W,e)},setInt16:function(t,e){Z(this,2,t,q,e,arguments[2])},setUint16:function(t,e){Z(this,2,t,q,e,arguments[2])},setInt32:function(t,e){Z(this,4,t,X,e,arguments[2])},setUint32:function(t,e){Z(this,4,t,X,e,arguments[2])},setFloat32:function(t,e){Z(this,4,t,V,e,arguments[2])},setFloat64:function(t,e){Z(this,8,t,U,e,arguments[2])}});m(w,y),m(S,v),a(S[x],o.VIEW,!0),e[y]=w,e[v]=S},237:(t,e,i)=>{for(var n,s=i(7526),r=i(3341),o=i(4415),a=o("typed_array"),h=o("view"),l=!(!s.ArrayBuffer||!s.DataView),c=l,u=0,d="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");u<9;)(n=s[d[u++]])?(r(n.prototype,a,!0),r(n.prototype,h,!0)):c=!1;t.exports={ABV:l,CONSTR:c,TYPED:a,VIEW:h}},4415:t=>{var e=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++e+i).toString(36))}},4514:(t,e,i)=>{var n=i(7526).navigator;t.exports=n&&n.userAgent||""},2888:(t,e,i)=>{var n=i(3305);t.exports=function(t,e){if(!n(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},5392:(t,e,i)=>{var n=i(7526),s=i(6094),r=i(2750),o=i(7960),a=i(7967).f;t.exports=function(t){var e=s.Symbol||(s.Symbol=r?{}:n.Symbol||{});"_"==t.charAt(0)||t in e||a(e,t,{value:o.f(t)})}},7960:(t,e,i)=>{e.f=i(7574)},7574:(t,e,i)=>{var n=i(4556)("wks"),s=i(4415),r=i(7526).Symbol,o="function"==typeof r;(t.exports=function(t){return n[t]||(n[t]=o&&r[t]||(o?r:s)("Symbol."+t))}).store=n},762:(t,e,i)=>{var n=i(4848),s=i(7574)("iterator"),r=i(906);t.exports=i(6094).getIteratorMethod=function(t){if(null!=t)return t[s]||t["@@iterator"]||r[n(t)]}},9620:(t,e,i)=>{var n=i(2127);n(n.P,"Array",{copyWithin:i(4438)}),i(8184)("copyWithin")},8888:(t,e,i)=>{"use strict";var n=i(2127),s=i(6179)(4);n(n.P+n.F*!i(6884)([].every,!0),"Array",{every:function(t){return s(this,t,arguments[1])}})},7762:(t,e,i)=>{var n=i(2127);n(n.P,"Array",{fill:i(5564)}),i(8184)("fill")},9813:(t,e,i)=>{"use strict";var n=i(2127),s=i(6179)(2);n(n.P+n.F*!i(6884)([].filter,!0),"Array",{filter:function(t){return s(this,t,arguments[1])}})},5369:(t,e,i)=>{"use strict";var n=i(2127),s=i(6179)(6),r="findIndex",o=!0;r in[]&&Array(1)[r]((function(){o=!1})),n(n.P+n.F*o,"Array",{findIndex:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}}),i(8184)(r)},5144:(t,e,i)=>{"use strict";var n=i(2127),s=i(6179)(5),r="find",o=!0;r in[]&&Array(1)[r]((function(){o=!1})),n(n.P+n.F*o,"Array",{find:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}}),i(8184)(r)},3504:(t,e,i)=>{"use strict";var n=i(2127),s=i(6179)(0),r=i(6884)([].forEach,!0);n(n.P+n.F*!r,"Array",{forEach:function(t){return s(this,t,arguments[1])}})},3863:(t,e,i)=>{"use strict";var n=i(5052),s=i(2127),r=i(8270),o=i(7368),a=i(1508),h=i(1485),l=i(7227),c=i(762);s(s.S+s.F*!i(8931)((function(t){Array.from(t)})),"Array",{from:function(t){var e,i,s,u,d=r(t),g="function"==typeof this?this:Array,f=arguments.length,p=f>1?arguments[1]:void 0,_=void 0!==p,m=0,y=c(d);if(_&&(p=n(p,f>2?arguments[2]:void 0,2)),null==y||g==Array&&a(y))for(i=new g(e=h(d.length));e>m;m++)l(i,m,_?p(d[m],m):d[m]);else for(u=y.call(d),i=new g;!(s=u.next()).done;m++)l(i,m,_?o(u,p,[s.value,m],!0):s.value);return i.length=m,i}})},4609:(t,e,i)=>{"use strict";var n=i(2127),s=i(1464)(!1),r=[].indexOf,o=!!r&&1/[1].indexOf(1,-0)<0;n(n.P+n.F*(o||!i(6884)(r)),"Array",{indexOf:function(t){return o?r.apply(this,arguments)||0:s(this,t,arguments[1])}})},7899:(t,e,i)=>{var n=i(2127);n(n.S,"Array",{isArray:i(7981)})},5165:(t,e,i)=>{"use strict";var n=i(8184),s=i(4970),r=i(906),o=i(7221);t.exports=i(8175)(Array,"Array",(function(t,e){this._t=o(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,i=this._i++;return!t||i>=t.length?(this._t=void 0,s(1)):s(0,"keys"==e?i:"values"==e?t[i]:[i,t[i]])}),"values"),r.Arguments=r.Array,n("keys"),n("values"),n("entries")},6511:(t,e,i)=>{"use strict";var n=i(2127),s=i(7221),r=[].join;n(n.P+n.F*(i(1249)!=Object||!i(6884)(r)),"Array",{join:function(t){return r.call(s(this),void 0===t?",":t)}})},3706:(t,e,i)=>{"use strict";var n=i(2127),s=i(7221),r=i(7087),o=i(1485),a=[].lastIndexOf,h=!!a&&1/[1].lastIndexOf(1,-0)<0;n(n.P+n.F*(h||!i(6884)(a)),"Array",{lastIndexOf:function(t){if(h)return a.apply(this,arguments)||0;var e=s(this),i=o(e.length),n=i-1;for(arguments.length>1&&(n=Math.min(n,r(arguments[1]))),n<0&&(n=i+n);n>=0;n--)if(n in e&&e[n]===t)return n||0;return-1}})},4913:(t,e,i)=>{"use strict";var n=i(2127),s=i(6179)(1);n(n.P+n.F*!i(6884)([].map,!0),"Array",{map:function(t){return s(this,t,arguments[1])}})},4570:(t,e,i)=>{"use strict";var n=i(2127),s=i(7227);n(n.S+n.F*i(9448)((function(){function t(){}return!(Array.of.call(t)instanceof t)})),"Array",{of:function(){for(var t=0,e=arguments.length,i=new("function"==typeof this?this:Array)(e);e>t;)s(i,t,arguments[t++]);return i.length=e,i}})},7874:(t,e,i)=>{"use strict";var n=i(2127),s=i(6543);n(n.P+n.F*!i(6884)([].reduceRight,!0),"Array",{reduceRight:function(t){return s(this,t,arguments.length,arguments[1],!0)}})},1449:(t,e,i)=>{"use strict";var n=i(2127),s=i(6543);n(n.P+n.F*!i(6884)([].reduce,!0),"Array",{reduce:function(t){return s(this,t,arguments.length,arguments[1],!1)}})},5853:(t,e,i)=>{"use strict";var n=i(2127),s=i(1308),r=i(5089),o=i(157),a=i(1485),h=[].slice;n(n.P+n.F*i(9448)((function(){s&&h.call(s)})),"Array",{slice:function(t,e){var i=a(this.length),n=r(this);if(e=void 0===e?i:e,"Array"==n)return h.call(this,t,e);for(var s=o(t,i),l=o(e,i),c=a(l-s),u=new Array(c),d=0;d<c;d++)u[d]="String"==n?this.charAt(s+d):this[s+d];return u}})},8892:(t,e,i)=>{"use strict";var n=i(2127),s=i(6179)(3);n(n.P+n.F*!i(6884)([].some,!0),"Array",{some:function(t){return s(this,t,arguments[1])}})},7075:(t,e,i)=>{"use strict";var n=i(2127),s=i(3387),r=i(8270),o=i(9448),a=[].sort,h=[1,2,3];n(n.P+n.F*(o((function(){h.sort(void 0)}))||!o((function(){h.sort(null)}))||!i(6884)(a)),"Array",{sort:function(t){return void 0===t?a.call(r(this)):a.call(r(this),s(t))}})},6209:(t,e,i)=>{i(5762)("Array")},3292:(t,e,i)=>{var n=i(2127);n(n.S,"Date",{now:function(){return(new Date).getTime()}})},9429:(t,e,i)=>{var n=i(2127),s=i(5385);n(n.P+n.F*(Date.prototype.toISOString!==s),"Date",{toISOString:s})},2346:(t,e,i)=>{"use strict";var n=i(2127),s=i(8270),r=i(3048);n(n.P+n.F*i(9448)((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})})),"Date",{toJSON:function(t){var e=s(this),i=r(e);return"number"!=typeof i||isFinite(i)?e.toISOString():null}})},8951:(t,e,i)=>{var n=i(7574)("toPrimitive"),s=Date.prototype;n in s||i(3341)(s,n,i(107))},7849:(t,e,i)=>{var n=Date.prototype,s="Invalid Date",r="toString",o=n[r],a=n.getTime;new Date(NaN)+""!=s&&i(8859)(n,r,(function(){var t=a.call(this);return t==t?o.call(this):s}))},5049:(t,e,i)=>{var n=i(2127);n(n.P,"Function",{bind:i(5538)})},5502:(t,e,i)=>{"use strict";var n=i(3305),s=i(627),r=i(7574)("hasInstance"),o=Function.prototype;r in o||i(7967).f(o,r,{value:function(t){if("function"!=typeof this||!n(t))return!1;if(!n(this.prototype))return t instanceof this;for(;t=s(t);)if(this.prototype===t)return!0;return!1}})},489:(t,e,i)=>{var n=i(7967).f,s=Function.prototype,r=/^\s*function ([^ (]*)/,o="name";o in s||i(1763)&&n(s,o,{configurable:!0,get:function(){try{return(""+this).match(r)[1]}catch(t){return""}}})},3386:(t,e,i)=>{"use strict";var n=i(6197),s=i(2888),r="Map";t.exports=i(8933)(r,(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(t){var e=n.getEntry(s(this,r),t);return e&&e.v},set:function(t,e){return n.def(s(this,r),0===t?0:t,e)}},n,!0)},6648:(t,e,i)=>{var n=i(2127),s=i(1473),r=Math.sqrt,o=Math.acosh;n(n.S+n.F*!(o&&710==Math.floor(o(Number.MAX_VALUE))&&o(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:s(t-1+r(t-1)*r(t+1))}})},5771:(t,e,i)=>{var n=i(2127),s=Math.asinh;n(n.S+n.F*!(s&&1/s(0)>0),"Math",{asinh:function t(e){return isFinite(e=+e)&&0!=e?e<0?-t(-e):Math.log(e+Math.sqrt(e*e+1)):e}})},2392:(t,e,i)=>{var n=i(2127),s=Math.atanh;n(n.S+n.F*!(s&&1/s(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},2335:(t,e,i)=>{var n=i(2127),s=i(3733);n(n.S,"Math",{cbrt:function(t){return s(t=+t)*Math.pow(Math.abs(t),1/3)}})},4896:(t,e,i)=>{var n=i(2127);n(n.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},4521:(t,e,i)=>{var n=i(2127),s=Math.exp;n(n.S,"Math",{cosh:function(t){return(s(t=+t)+s(-t))/2}})},9147:(t,e,i)=>{var n=i(2127),s=i(5551);n(n.S+n.F*(s!=Math.expm1),"Math",{expm1:s})},1318:(t,e,i)=>{var n=i(2127);n(n.S,"Math",{fround:i(2122)})},4352:(t,e,i)=>{var n=i(2127),s=Math.abs;n(n.S,"Math",{hypot:function(t,e){for(var i,n,r=0,o=0,a=arguments.length,h=0;o<a;)h<(i=s(arguments[o++]))?(r=r*(n=h/i)*n+1,h=i):r+=i>0?(n=i/h)*n:i;return h===1/0?1/0:h*Math.sqrt(r)}})},5327:(t,e,i)=>{var n=i(2127),s=Math.imul;n(n.S+n.F*i(9448)((function(){return-5!=s(4294967295,5)||2!=s.length})),"Math",{imul:function(t,e){var i=65535,n=+t,s=+e,r=i&n,o=i&s;return 0|r*o+((i&n>>>16)*o+r*(i&s>>>16)<<16>>>0)}})},7509:(t,e,i)=>{var n=i(2127);n(n.S,"Math",{log10:function(t){return Math.log(t)*Math.LOG10E}})},5909:(t,e,i)=>{var n=i(2127);n(n.S,"Math",{log1p:i(1473)})},9584:(t,e,i)=>{var n=i(2127);n(n.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},345:(t,e,i)=>{var n=i(2127);n(n.S,"Math",{sign:i(3733)})},9134:(t,e,i)=>{var n=i(2127),s=i(5551),r=Math.exp;n(n.S+n.F*i(9448)((function(){return-2e-17!=!Math.sinh(-2e-17)})),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(s(t)-s(-t))/2:(r(t-1)-r(-t-1))*(Math.E/2)}})},7901:(t,e,i)=>{var n=i(2127),s=i(5551),r=Math.exp;n(n.S,"Math",{tanh:function(t){var e=s(t=+t),i=s(-t);return e==1/0?1:i==1/0?-1:(e-i)/(r(t)+r(-t))}})},6592:(t,e,i)=>{var n=i(2127);n(n.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},4509:(t,e,i)=>{"use strict";var n=i(7526),s=i(7917),r=i(5089),o=i(8880),a=i(3048),h=i(9448),l=i(9415).f,c=i(8641).f,u=i(7967).f,d=i(629).trim,g="Number",f=n[g],p=f,_=f.prototype,m=r(i(4719)(_))==g,y="trim"in String.prototype,v=function(t){var e=a(t,!1);if("string"==typeof e&&e.length>2){var i,n,s,r=(e=y?e.trim():d(e,3)).charCodeAt(0);if(43===r||45===r){if(88===(i=e.charCodeAt(2))||120===i)return NaN}else if(48===r){switch(e.charCodeAt(1)){case 66:case 98:n=2,s=49;break;case 79:case 111:n=8,s=55;break;default:return+e}for(var o,h=e.slice(2),l=0,c=h.length;l<c;l++)if((o=h.charCodeAt(l))<48||o>s)return NaN;return parseInt(h,n)}}return+e};if(!f(" 0o1")||!f("0b1")||f("+0x1")){f=function(t){var e=arguments.length<1?0:t,i=this;return i instanceof f&&(m?h((function(){_.valueOf.call(i)})):r(i)!=g)?o(new p(v(e)),i,f):v(e)};for(var x,M=i(1763)?l(p):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),w=0;M.length>w;w++)s(p,x=M[w])&&!s(f,x)&&u(f,x,c(p,x));f.prototype=_,_.constructor=f,i(8859)(n,g,f)}},4419:(t,e,i)=>{var n=i(2127);n(n.S,"Number",{EPSILON:Math.pow(2,-52)})},1933:(t,e,i)=>{var n=i(2127),s=i(7526).isFinite;n(n.S,"Number",{isFinite:function(t){return"number"==typeof t&&s(t)}})},3157:(t,e,i)=>{var n=i(2127);n(n.S,"Number",{isInteger:i(3842)})},9497:(t,e,i)=>{var n=i(2127);n(n.S,"Number",{isNaN:function(t){return t!=t}})},4104:(t,e,i)=>{var n=i(2127),s=i(3842),r=Math.abs;n(n.S,"Number",{isSafeInteger:function(t){return s(t)&&r(t)<=9007199254740991}})},210:(t,e,i)=>{var n=i(2127);n(n.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},6576:(t,e,i)=>{var n=i(2127);n(n.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},4437:(t,e,i)=>{var n=i(2127),s=i(3589);n(n.S+n.F*(Number.parseFloat!=s),"Number",{parseFloat:s})},8050:(t,e,i)=>{var n=i(2127),s=i(2738);n(n.S+n.F*(Number.parseInt!=s),"Number",{parseInt:s})},7727:(t,e,i)=>{"use strict";var n=i(2127),s=i(7087),r=i(5122),o=i(7926),a=1..toFixed,h=Math.floor,l=[0,0,0,0,0,0],c="Number.toFixed: incorrect invocation!",u="0",d=function(t,e){for(var i=-1,n=e;++i<6;)n+=t*l[i],l[i]=n%1e7,n=h(n/1e7)},g=function(t){for(var e=6,i=0;--e>=0;)i+=l[e],l[e]=h(i/t),i=i%t*1e7},f=function(){for(var t=6,e="";--t>=0;)if(""!==e||0===t||0!==l[t]){var i=String(l[t]);e=""===e?i:e+o.call(u,7-i.length)+i}return e},p=function(t,e,i){return 0===e?i:e%2==1?p(t,e-1,i*t):p(t*t,e/2,i)};n(n.P+n.F*(!!a&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!i(9448)((function(){a.call({})}))),"Number",{toFixed:function(t){var e,i,n,a,h=r(this,c),l=s(t),_="",m=u;if(l<0||l>20)throw RangeError(c);if(h!=h)return"NaN";if(h<=-1e21||h>=1e21)return String(h);if(h<0&&(_="-",h=-h),h>1e-21)if(e=function(t){for(var e=0,i=t;i>=4096;)e+=12,i/=4096;for(;i>=2;)e+=1,i/=2;return e}(h*p(2,69,1))-69,i=e<0?h*p(2,-e,1):h/p(2,e,1),i*=4503599627370496,(e=52-e)>0){for(d(0,i),n=l;n>=7;)d(1e7,0),n-=7;for(d(p(10,n,1),0),n=e-1;n>=23;)g(1<<23),n-=23;g(1<<n),d(1,1),g(2),m=f()}else d(0,i),d(1<<-e,0),m=f()+o.call(u,l);return l>0?_+((a=m.length)<=l?"0."+o.call(u,l-a)+m:m.slice(0,a-l)+"."+m.slice(a-l)):_+m}})},6701:(t,e,i)=>{"use strict";var n=i(2127),s=i(9448),r=i(5122),o=1..toPrecision;n(n.P+n.F*(s((function(){return"1"!==o.call(1,void 0)}))||!s((function(){o.call({})}))),"Number",{toPrecision:function(t){var e=r(this,"Number#toPrecision: incorrect invocation!");return void 0===t?o.call(e):o.call(e,t)}})},1430:(t,e,i)=>{var n=i(2127);n(n.S+n.F,"Object",{assign:i(8206)})},935:(t,e,i)=>{var n=i(2127);n(n.S,"Object",{create:i(4719)})},7067:(t,e,i)=>{var n=i(2127);n(n.S+n.F*!i(1763),"Object",{defineProperties:i(1626)})},6064:(t,e,i)=>{var n=i(2127);n(n.S+n.F*!i(1763),"Object",{defineProperty:i(7967).f})},8236:(t,e,i)=>{var n=i(3305),s=i(2988).onFreeze;i(923)("freeze",(function(t){return function(e){return t&&n(e)?t(s(e)):e}}))},2642:(t,e,i)=>{var n=i(7221),s=i(8641).f;i(923)("getOwnPropertyDescriptor",(function(){return function(t,e){return s(n(t),e)}}))},1895:(t,e,i)=>{i(923)("getOwnPropertyNames",(function(){return i(4765).f}))},3e3:(t,e,i)=>{var n=i(8270),s=i(627);i(923)("getPrototypeOf",(function(){return function(t){return s(n(t))}}))},9073:(t,e,i)=>{var n=i(3305);i(923)("isExtensible",(function(t){return function(e){return!!n(e)&&(!t||t(e))}}))},9318:(t,e,i)=>{var n=i(3305);i(923)("isFrozen",(function(t){return function(e){return!n(e)||!!t&&t(e)}}))},5032:(t,e,i)=>{var n=i(3305);i(923)("isSealed",(function(t){return function(e){return!n(e)||!!t&&t(e)}}))},8451:(t,e,i)=>{var n=i(2127);n(n.S,"Object",{is:i(7359)})},8647:(t,e,i)=>{var n=i(8270),s=i(1311);i(923)("keys",(function(){return function(t){return s(n(t))}}))},5572:(t,e,i)=>{var n=i(3305),s=i(2988).onFreeze;i(923)("preventExtensions",(function(t){return function(e){return t&&n(e)?t(s(e)):e}}))},3822:(t,e,i)=>{var n=i(3305),s=i(2988).onFreeze;i(923)("seal",(function(t){return function(e){return t&&n(e)?t(s(e)):e}}))},8132:(t,e,i)=>{var n=i(2127);n(n.S,"Object",{setPrototypeOf:i(5170).set})},7482:(t,e,i)=>{"use strict";var n=i(4848),s={};s[i(7574)("toStringTag")]="z",s+""!="[object z]"&&i(8859)(Object.prototype,"toString",(function(){return"[object "+n(this)+"]"}),!0)},6108:(t,e,i)=>{var n=i(2127),s=i(3589);n(n.G+n.F*(parseFloat!=s),{parseFloat:s})},571:(t,e,i)=>{var n=i(2127),s=i(2738);n(n.G+n.F*(parseInt!=s),{parseInt:s})},6517:(t,e,i)=>{"use strict";var n,s,r,o,a=i(2750),h=i(7526),l=i(5052),c=i(4848),u=i(2127),d=i(3305),g=i(3387),f=i(6440),p=i(8790),_=i(9190),m=i(2780).set,y=i(1384)(),v=i(4258),x=i(128),M=i(4514),w=i(5957),S="Promise",C=h.TypeError,b=h.process,E=b&&b.versions,P=E&&E.v8||"",I=h[S],T="process"==c(b),R=function(){},A=s=v.f,F=!!function(){try{var t=I.resolve(1),e=(t.constructor={})[i(7574)("species")]=function(t){t(R,R)};return(T||"function"==typeof PromiseRejectionEvent)&&t.then(R)instanceof e&&0!==P.indexOf("6.6")&&-1===M.indexOf("Chrome/66")}catch(t){}}(),L=function(t){var e;return!(!d(t)||"function"!=typeof(e=t.then))&&e},k=function(t,e){if(!t._n){t._n=!0;var i=t._c;y((function(){for(var n=t._v,s=1==t._s,r=0,o=function(e){var i,r,o,a=s?e.ok:e.fail,h=e.resolve,l=e.reject,c=e.domain;try{a?(s||(2==t._h&&N(t),t._h=1),!0===a?i=n:(c&&c.enter(),i=a(n),c&&(c.exit(),o=!0)),i===e.promise?l(C("Promise-chain cycle")):(r=L(i))?r.call(i,h,l):h(i)):l(n)}catch(t){c&&!o&&c.exit(),l(t)}};i.length>r;)o(i[r++]);t._c=[],t._n=!1,e&&!t._h&&O(t)}))}},O=function(t){m.call(h,(function(){var e,i,n,s=t._v,r=D(t);if(r&&(e=x((function(){T?b.emit("unhandledRejection",s,t):(i=h.onunhandledrejection)?i({promise:t,reason:s}):(n=h.console)&&n.error&&n.error("Unhandled promise rejection",s)})),t._h=T||D(t)?2:1),t._a=void 0,r&&e.e)throw e.v}))},D=function(t){return 1!==t._h&&0===(t._a||t._c).length},N=function(t){m.call(h,(function(){var e;T?b.emit("rejectionHandled",t):(e=h.onrejectionhandled)&&e({promise:t,reason:t._v})}))},G=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),k(e,!0))},j=function(t){var e,i=this;if(!i._d){i._d=!0,i=i._w||i;try{if(i===t)throw C("Promise can't be resolved itself");(e=L(t))?y((function(){var n={_w:i,_d:!1};try{e.call(t,l(j,n,1),l(G,n,1))}catch(t){G.call(n,t)}})):(i._v=t,i._s=1,k(i,!1))}catch(t){G.call({_w:i,_d:!1},t)}}};F||(I=function(t){f(this,I,S,"_h"),g(t),n.call(this);try{t(l(j,this,1),l(G,this,1))}catch(t){G.call(this,t)}},(n=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=i(6065)(I.prototype,{then:function(t,e){var i=A(_(this,I));return i.ok="function"!=typeof t||t,i.fail="function"==typeof e&&e,i.domain=T?b.domain:void 0,this._c.push(i),this._a&&this._a.push(i),this._s&&k(this,!1),i.promise},catch:function(t){return this.then(void 0,t)}}),r=function(){var t=new n;this.promise=t,this.resolve=l(j,t,1),this.reject=l(G,t,1)},v.f=A=function(t){return t===I||t===o?new r(t):s(t)}),u(u.G+u.W+u.F*!F,{Promise:I}),i(3844)(I,S),i(5762)(S),o=i(6094)[S],u(u.S+u.F*!F,S,{reject:function(t){var e=A(this);return(0,e.reject)(t),e.promise}}),u(u.S+u.F*(a||!F),S,{resolve:function(t){return w(a&&this===o?I:this,t)}}),u(u.S+u.F*!(F&&i(8931)((function(t){I.all(t).catch(R)}))),S,{all:function(t){var e=this,i=A(e),n=i.resolve,s=i.reject,r=x((function(){var i=[],r=0,o=1;p(t,!1,(function(t){var a=r++,h=!1;i.push(void 0),o++,e.resolve(t).then((function(t){h||(h=!0,i[a]=t,--o||n(i))}),s)})),--o||n(i)}));return r.e&&s(r.v),i.promise},race:function(t){var e=this,i=A(e),n=i.reject,s=x((function(){p(t,!1,(function(t){e.resolve(t).then(i.resolve,n)}))}));return s.e&&n(s.v),i.promise}})},7103:(t,e,i)=>{var n=i(2127),s=i(3387),r=i(4228),o=(i(7526).Reflect||{}).apply,a=Function.apply;n(n.S+n.F*!i(9448)((function(){o((function(){}))})),"Reflect",{apply:function(t,e,i){var n=s(t),h=r(i);return o?o(n,e,h):a.call(n,e,h)}})},2586:(t,e,i)=>{var n=i(2127),s=i(4719),r=i(3387),o=i(4228),a=i(3305),h=i(9448),l=i(5538),c=(i(7526).Reflect||{}).construct,u=h((function(){function t(){}return!(c((function(){}),[],t)instanceof t)})),d=!h((function(){c((function(){}))}));n(n.S+n.F*(u||d),"Reflect",{construct:function(t,e){r(t),o(e);var i=arguments.length<3?t:r(arguments[2]);if(d&&!u)return c(t,e,i);if(t==i){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var n=[null];return n.push.apply(n,e),new(l.apply(t,n))}var h=i.prototype,g=s(a(h)?h:Object.prototype),f=Function.apply.call(t,g,e);return a(f)?f:g}})},2552:(t,e,i)=>{var n=i(7967),s=i(2127),r=i(4228),o=i(3048);s(s.S+s.F*i(9448)((function(){Reflect.defineProperty(n.f({},1,{value:1}),1,{value:2})})),"Reflect",{defineProperty:function(t,e,i){r(t),e=o(e,!0),r(i);try{return n.f(t,e,i),!0}catch(t){return!1}}})},4376:(t,e,i)=>{var n=i(2127),s=i(8641).f,r=i(4228);n(n.S,"Reflect",{deleteProperty:function(t,e){var i=s(r(t),e);return!(i&&!i.configurable)&&delete t[e]}})},5153:(t,e,i)=>{"use strict";var n=i(2127),s=i(4228),r=function(t){this._t=s(t),this._i=0;var e,i=this._k=[];for(e in t)i.push(e)};i(6032)(r,"Object",(function(){var t,e=this,i=e._k;do{if(e._i>=i.length)return{value:void 0,done:!0}}while(!((t=i[e._i++])in e._t));return{value:t,done:!1}})),n(n.S,"Reflect",{enumerate:function(t){return new r(t)}})},2650:(t,e,i)=>{var n=i(8641),s=i(2127),r=i(4228);s(s.S,"Reflect",{getOwnPropertyDescriptor:function(t,e){return n.f(r(t),e)}})},1104:(t,e,i)=>{var n=i(2127),s=i(627),r=i(4228);n(n.S,"Reflect",{getPrototypeOf:function(t){return s(r(t))}})},1879:(t,e,i)=>{var n=i(8641),s=i(627),r=i(7917),o=i(2127),a=i(3305),h=i(4228);o(o.S,"Reflect",{get:function t(e,i){var o,l,c=arguments.length<3?e:arguments[2];return h(e)===c?e[i]:(o=n.f(e,i))?r(o,"value")?o.value:void 0!==o.get?o.get.call(c):void 0:a(l=s(e))?t(l,i,c):void 0}})},1883:(t,e,i)=>{var n=i(2127);n(n.S,"Reflect",{has:function(t,e){return e in t}})},5433:(t,e,i)=>{var n=i(2127),s=i(4228),r=Object.isExtensible;n(n.S,"Reflect",{isExtensible:function(t){return s(t),!r||r(t)}})},5e3:(t,e,i)=>{var n=i(2127);n(n.S,"Reflect",{ownKeys:i(6222)})},5932:(t,e,i)=>{var n=i(2127),s=i(4228),r=Object.preventExtensions;n(n.S,"Reflect",{preventExtensions:function(t){s(t);try{return r&&r(t),!0}catch(t){return!1}}})},6316:(t,e,i)=>{var n=i(2127),s=i(5170);s&&n(n.S,"Reflect",{setPrototypeOf:function(t,e){s.check(t,e);try{return s.set(t,e),!0}catch(t){return!1}}})},5443:(t,e,i)=>{var n=i(7967),s=i(8641),r=i(627),o=i(7917),a=i(2127),h=i(1996),l=i(4228),c=i(3305);a(a.S,"Reflect",{set:function t(e,i,a){var u,d,g=arguments.length<4?e:arguments[3],f=s.f(l(e),i);if(!f){if(c(d=r(e)))return t(d,i,a,g);f=h(0)}if(o(f,"value")){if(!1===f.writable||!c(g))return!1;if(u=s.f(g,i)){if(u.get||u.set||!1===u.writable)return!1;u.value=a,n.f(g,i,u)}else n.f(g,i,h(0,a));return!0}return void 0!==f.set&&(f.set.call(g,a),!0)}})},8301:(t,e,i)=>{var n=i(7526),s=i(8880),r=i(7967).f,o=i(9415).f,a=i(5411),h=i(1158),l=n.RegExp,c=l,u=l.prototype,d=/a/g,g=/a/g,f=new l(d)!==d;if(i(1763)&&(!f||i(9448)((function(){return g[i(7574)("match")]=!1,l(d)!=d||l(g)==g||"/a/i"!=l(d,"i")})))){l=function(t,e){var i=this instanceof l,n=a(t),r=void 0===e;return!i&&n&&t.constructor===l&&r?t:s(f?new c(n&&!r?t.source:t,e):c((n=t instanceof l)?t.source:t,n&&r?h.call(t):e),i?this:u,l)};for(var p=function(t){t in l||r(l,t,{configurable:!0,get:function(){return c[t]},set:function(e){c[t]=e}})},_=o(c),m=0;_.length>m;)p(_[m++]);u.constructor=l,l.prototype=u,i(8859)(n,"RegExp",l)}i(5762)("RegExp")},4116:(t,e,i)=>{"use strict";var n=i(9600);i(2127)({target:"RegExp",proto:!0,forced:n!==/./.exec},{exec:n})},9638:(t,e,i)=>{i(1763)&&"g"!=/./g.flags&&i(7967).f(RegExp.prototype,"flags",{configurable:!0,get:i(1158)})},4040:(t,e,i)=>{"use strict";var n=i(4228),s=i(1485),r=i(8828),o=i(2535);i(9228)("match",1,(function(t,e,i,a){return[function(i){var n=t(this),s=null==i?void 0:i[e];return void 0!==s?s.call(i,n):new RegExp(i)[e](String(n))},function(t){var e=a(i,t,this);if(e.done)return e.value;var h=n(t),l=String(this);if(!h.global)return o(h,l);var c=h.unicode;h.lastIndex=0;for(var u,d=[],g=0;null!==(u=o(h,l));){var f=String(u[0]);d[g]=f,""===f&&(h.lastIndex=r(l,s(h.lastIndex),c)),g++}return 0===g?null:d}]}))},8305:(t,e,i)=>{"use strict";var n=i(4228),s=i(8270),r=i(1485),o=i(7087),a=i(8828),h=i(2535),l=Math.max,c=Math.min,u=Math.floor,d=/\$([$&`']|\d\d?|<[^>]*>)/g,g=/\$([$&`']|\d\d?)/g;i(9228)("replace",2,(function(t,e,i,f){return[function(n,s){var r=t(this),o=null==n?void 0:n[e];return void 0!==o?o.call(n,r,s):i.call(String(r),n,s)},function(t,e){var s=f(i,t,this,e);if(s.done)return s.value;var u=n(t),d=String(this),g="function"==typeof e;g||(e=String(e));var _=u.global;if(_){var m=u.unicode;u.lastIndex=0}for(var y=[];;){var v=h(u,d);if(null===v)break;if(y.push(v),!_)break;""===String(v[0])&&(u.lastIndex=a(d,r(u.lastIndex),m))}for(var x,M="",w=0,S=0;S<y.length;S++){v=y[S];for(var C=String(v[0]),b=l(c(o(v.index),d.length),0),E=[],P=1;P<v.length;P++)E.push(void 0===(x=v[P])?x:String(x));var I=v.groups;if(g){var T=[C].concat(E,b,d);void 0!==I&&T.push(I);var R=String(e.apply(void 0,T))}else R=p(C,d,b,E,I,e);b>=w&&(M+=d.slice(w,b)+R,w=b+C.length)}return M+d.slice(w)}];function p(t,e,n,r,o,a){var h=n+t.length,l=r.length,c=g;return void 0!==o&&(o=s(o),c=d),i.call(a,c,(function(i,s){var a;switch(s.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,n);case"'":return e.slice(h);case"<":a=o[s.slice(1,-1)];break;default:var c=+s;if(0===c)return i;if(c>l){var d=u(c/10);return 0===d?i:d<=l?void 0===r[d-1]?s.charAt(1):r[d-1]+s.charAt(1):i}a=r[c-1]}return void 0===a?"":a}))}}))},4701:(t,e,i)=>{"use strict";var n=i(4228),s=i(7359),r=i(2535);i(9228)("search",1,(function(t,e,i,o){return[function(i){var n=t(this),s=null==i?void 0:i[e];return void 0!==s?s.call(i,n):new RegExp(i)[e](String(n))},function(t){var e=o(i,t,this);if(e.done)return e.value;var a=n(t),h=String(this),l=a.lastIndex;s(l,0)||(a.lastIndex=0);var c=r(a,h);return s(a.lastIndex,l)||(a.lastIndex=l),null===c?-1:c.index}]}))},341:(t,e,i)=>{"use strict";var n=i(5411),s=i(4228),r=i(9190),o=i(8828),a=i(1485),h=i(2535),l=i(9600),c=i(9448),u=Math.min,d=[].push,g="split",f="length",p="lastIndex",_=4294967295,m=!c((function(){RegExp(_,"y")}));i(9228)("split",2,(function(t,e,i,c){var y;return y="c"=="abbc"[g](/(b)*/)[1]||4!="test"[g](/(?:)/,-1)[f]||2!="ab"[g](/(?:ab)*/)[f]||4!="."[g](/(.?)(.?)/)[f]||"."[g](/()()/)[f]>1||""[g](/.?/)[f]?function(t,e){var s=String(this);if(void 0===t&&0===e)return[];if(!n(t))return i.call(s,t,e);for(var r,o,a,h=[],c=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),u=0,g=void 0===e?_:e>>>0,m=new RegExp(t.source,c+"g");(r=l.call(m,s))&&!((o=m[p])>u&&(h.push(s.slice(u,r.index)),r[f]>1&&r.index<s[f]&&d.apply(h,r.slice(1)),a=r[0][f],u=o,h[f]>=g));)m[p]===r.index&&m[p]++;return u===s[f]?!a&&m.test("")||h.push(""):h.push(s.slice(u)),h[f]>g?h.slice(0,g):h}:"0"[g](void 0,0)[f]?function(t,e){return void 0===t&&0===e?[]:i.call(this,t,e)}:i,[function(i,n){var s=t(this),r=null==i?void 0:i[e];return void 0!==r?r.call(i,s,n):y.call(String(s),i,n)},function(t,e){var n=c(y,t,this,e,y!==i);if(n.done)return n.value;var l=s(t),d=String(this),g=r(l,RegExp),f=l.unicode,p=(l.ignoreCase?"i":"")+(l.multiline?"m":"")+(l.unicode?"u":"")+(m?"y":"g"),v=new g(m?l:"^(?:"+l.source+")",p),x=void 0===e?_:e>>>0;if(0===x)return[];if(0===d.length)return null===h(v,d)?[d]:[];for(var M=0,w=0,S=[];w<d.length;){v.lastIndex=m?w:0;var C,b=h(v,m?d:d.slice(w));if(null===b||(C=u(a(v.lastIndex+(m?0:w)),d.length))===M)w=o(d,w,f);else{if(S.push(d.slice(M,w)),S.length===x)return S;for(var E=1;E<=b.length-1;E++)if(S.push(b[E]),S.length===x)return S;w=M=C}}return S.push(d.slice(M)),S}]}))},8604:(t,e,i)=>{"use strict";i(9638);var n=i(4228),s=i(1158),r=i(1763),o="toString",a=/./[o],h=function(t){i(8859)(RegExp.prototype,o,t,!0)};i(9448)((function(){return"/a/b"!=a.call({source:"a",flags:"b"})}))?h((function(){var t=n(this);return"/".concat(t.source,"/","flags"in t?t.flags:!r&&t instanceof RegExp?s.call(t):void 0)})):a.name!=o&&h((function(){return a.call(this)}))},1632:(t,e,i)=>{"use strict";var n=i(6197),s=i(2888);t.exports=i(8933)("Set",(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(t){return n.def(s(this,"Set"),t=0===t?0:t,t)}},n)},7360:(t,e,i)=>{"use strict";i(2468)("anchor",(function(t){return function(e){return t(this,"a","name",e)}}))},9011:(t,e,i)=>{"use strict";i(2468)("big",(function(t){return function(){return t(this,"big","","")}}))},4591:(t,e,i)=>{"use strict";i(2468)("blink",(function(t){return function(){return t(this,"blink","","")}}))},7334:(t,e,i)=>{"use strict";i(2468)("bold",(function(t){return function(){return t(this,"b","","")}}))},2405:(t,e,i)=>{"use strict";var n=i(2127),s=i(1212)(!1);n(n.P,"String",{codePointAt:function(t){return s(this,t)}})},7224:(t,e,i)=>{"use strict";var n=i(2127),s=i(1485),r=i(8942),o="endsWith",a=""[o];n(n.P+n.F*i(5203)(o),"String",{endsWith:function(t){var e=r(this,t,o),i=arguments.length>1?arguments[1]:void 0,n=s(e.length),h=void 0===i?n:Math.min(s(i),n),l=String(t);return a?a.call(e,l,h):e.slice(h-l.length,h)===l}})},7083:(t,e,i)=>{"use strict";i(2468)("fixed",(function(t){return function(){return t(this,"tt","","")}}))},9213:(t,e,i)=>{"use strict";i(2468)("fontcolor",(function(t){return function(e){return t(this,"font","color",e)}}))},8437:(t,e,i)=>{"use strict";i(2468)("fontsize",(function(t){return function(e){return t(this,"font","size",e)}}))},2220:(t,e,i)=>{var n=i(2127),s=i(157),r=String.fromCharCode,o=String.fromCodePoint;n(n.S+n.F*(!!o&&1!=o.length),"String",{fromCodePoint:function(t){for(var e,i=[],n=arguments.length,o=0;n>o;){if(e=+arguments[o++],s(e,1114111)!==e)throw RangeError(e+" is not a valid code point");i.push(e<65536?r(e):r(55296+((e-=65536)>>10),e%1024+56320))}return i.join("")}})},8872:(t,e,i)=>{"use strict";var n=i(2127),s=i(8942),r="includes";n(n.P+n.F*i(5203)(r),"String",{includes:function(t){return!!~s(this,t,r).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},9839:(t,e,i)=>{"use strict";i(2468)("italics",(function(t){return function(){return t(this,"i","","")}}))},2975:(t,e,i)=>{"use strict";var n=i(1212)(!0);i(8175)(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,i=this._i;return i>=e.length?{value:void 0,done:!0}:(t=n(e,i),this._i+=t.length,{value:t,done:!1})}))},6549:(t,e,i)=>{"use strict";i(2468)("link",(function(t){return function(e){return t(this,"a","href",e)}}))},3483:(t,e,i)=>{var n=i(2127),s=i(7221),r=i(1485);n(n.S,"String",{raw:function(t){for(var e=s(t.raw),i=r(e.length),n=arguments.length,o=[],a=0;i>a;)o.push(String(e[a++])),a<n&&o.push(String(arguments[a]));return o.join("")}})},4894:(t,e,i)=>{var n=i(2127);n(n.P,"String",{repeat:i(7926)})},2818:(t,e,i)=>{"use strict";i(2468)("small",(function(t){return function(){return t(this,"small","","")}}))},177:(t,e,i)=>{"use strict";var n=i(2127),s=i(1485),r=i(8942),o="startsWith",a=""[o];n(n.P+n.F*i(5203)(o),"String",{startsWith:function(t){var e=r(this,t,o),i=s(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),n=String(t);return a?a.call(e,n,i):e.slice(i,i+n.length)===n}})},8543:(t,e,i)=>{"use strict";i(2468)("strike",(function(t){return function(){return t(this,"strike","","")}}))},3559:(t,e,i)=>{"use strict";i(2468)("sub",(function(t){return function(){return t(this,"sub","","")}}))},4153:(t,e,i)=>{"use strict";i(2468)("sup",(function(t){return function(){return t(this,"sup","","")}}))},957:(t,e,i)=>{"use strict";i(629)("trim",(function(t){return function(){return t(this,3)}}))},9650:(t,e,i)=>{"use strict";var n=i(7526),s=i(7917),r=i(1763),o=i(2127),a=i(8859),h=i(2988).KEY,l=i(9448),c=i(4556),u=i(3844),d=i(4415),g=i(7574),f=i(7960),p=i(5392),_=i(5969),m=i(7981),y=i(4228),v=i(3305),x=i(8270),M=i(7221),w=i(3048),S=i(1996),C=i(4719),b=i(4765),E=i(8641),P=i(1060),I=i(7967),T=i(1311),R=E.f,A=I.f,F=b.f,L=n.Symbol,k=n.JSON,O=k&&k.stringify,D="prototype",N=g("_hidden"),G=g("toPrimitive"),j={}.propertyIsEnumerable,z=c("symbol-registry"),B=c("symbols"),W=c("op-symbols"),q=Object[D],X="function"==typeof L&&!!P.f,U=n.QObject,V=!U||!U[D]||!U[D].findChild,K=r&&l((function(){return 7!=C(A({},"a",{get:function(){return A(this,"a",{value:7}).a}})).a}))?function(t,e,i){var n=R(q,e);n&&delete q[e],A(t,e,i),n&&t!==q&&A(q,e,n)}:A,Y=function(t){var e=B[t]=C(L[D]);return e._k=t,e},Z=X&&"symbol"==typeof L.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof L},H=function(t,e,i){return t===q&&H(W,e,i),y(t),e=w(e,!0),y(i),s(B,e)?(i.enumerable?(s(t,N)&&t[N][e]&&(t[N][e]=!1),i=C(i,{enumerable:S(0,!1)})):(s(t,N)||A(t,N,S(1,{})),t[N][e]=!0),K(t,e,i)):A(t,e,i)},J=function(t,e){y(t);for(var i,n=_(e=M(e)),s=0,r=n.length;r>s;)H(t,i=n[s++],e[i]);return t},$=function(t){var e=j.call(this,t=w(t,!0));return!(this===q&&s(B,t)&&!s(W,t))&&(!(e||!s(this,t)||!s(B,t)||s(this,N)&&this[N][t])||e)},Q=function(t,e){if(t=M(t),e=w(e,!0),t!==q||!s(B,e)||s(W,e)){var i=R(t,e);return!i||!s(B,e)||s(t,N)&&t[N][e]||(i.enumerable=!0),i}},tt=function(t){for(var e,i=F(M(t)),n=[],r=0;i.length>r;)s(B,e=i[r++])||e==N||e==h||n.push(e);return n},et=function(t){for(var e,i=t===q,n=F(i?W:M(t)),r=[],o=0;n.length>o;)!s(B,e=n[o++])||i&&!s(q,e)||r.push(B[e]);return r};X||(a((L=function(){if(this instanceof L)throw TypeError("Symbol is not a constructor!");var t=d(arguments.length>0?arguments[0]:void 0),e=function(i){this===q&&e.call(W,i),s(this,N)&&s(this[N],t)&&(this[N][t]=!1),K(this,t,S(1,i))};return r&&V&&K(q,t,{configurable:!0,set:e}),Y(t)})[D],"toString",(function(){return this._k})),E.f=Q,I.f=H,i(9415).f=b.f=tt,i(8449).f=$,P.f=et,r&&!i(2750)&&a(q,"propertyIsEnumerable",$,!0),f.f=function(t){return Y(g(t))}),o(o.G+o.W+o.F*!X,{Symbol:L});for(var it="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;it.length>nt;)g(it[nt++]);for(var st=T(g.store),rt=0;st.length>rt;)p(st[rt++]);o(o.S+o.F*!X,"Symbol",{for:function(t){return s(z,t+="")?z[t]:z[t]=L(t)},keyFor:function(t){if(!Z(t))throw TypeError(t+" is not a symbol!");for(var e in z)if(z[e]===t)return e},useSetter:function(){V=!0},useSimple:function(){V=!1}}),o(o.S+o.F*!X,"Object",{create:function(t,e){return void 0===e?C(t):J(C(t),e)},defineProperty:H,defineProperties:J,getOwnPropertyDescriptor:Q,getOwnPropertyNames:tt,getOwnPropertySymbols:et});var ot=l((function(){P.f(1)}));o(o.S+o.F*ot,"Object",{getOwnPropertySymbols:function(t){return P.f(x(t))}}),k&&o(o.S+o.F*(!X||l((function(){var t=L();return"[null]"!=O([t])||"{}"!=O({a:t})||"{}"!=O(Object(t))}))),"JSON",{stringify:function(t){for(var e,i,n=[t],s=1;arguments.length>s;)n.push(arguments[s++]);if(i=e=n[1],(v(e)||void 0!==t)&&!Z(t))return m(e)||(e=function(t,e){if("function"==typeof i&&(e=i.call(this,t,e)),!Z(e))return e}),n[1]=e,O.apply(k,n)}}),L[D][G]||i(3341)(L[D],G,L[D].valueOf),u(L,"Symbol"),u(Math,"Math",!0),u(n.JSON,"JSON",!0)},5706:(t,e,i)=>{"use strict";var n=i(2127),s=i(237),r=i(8032),o=i(4228),a=i(157),h=i(1485),l=i(3305),c=i(7526).ArrayBuffer,u=i(9190),d=r.ArrayBuffer,g=r.DataView,f=s.ABV&&c.isView,p=d.prototype.slice,_=s.VIEW,m="ArrayBuffer";n(n.G+n.W+n.F*(c!==d),{ArrayBuffer:d}),n(n.S+n.F*!s.CONSTR,m,{isView:function(t){return f&&f(t)||l(t)&&_ in t}}),n(n.P+n.U+n.F*i(9448)((function(){return!new d(2).slice(1,void 0).byteLength})),m,{slice:function(t,e){if(void 0!==p&&void 0===e)return p.call(o(this),t);for(var i=o(this).byteLength,n=a(t,i),s=a(void 0===e?i:e,i),r=new(u(this,d))(h(s-n)),l=new g(this),c=new g(r),f=0;n<s;)c.setUint8(f++,l.getUint8(n++));return r}}),i(5762)(m)},660:(t,e,i)=>{var n=i(2127);n(n.G+n.W+n.F*!i(237).ABV,{DataView:i(8032).DataView})},7925:(t,e,i)=>{i(7209)("Float32",4,(function(t){return function(e,i,n){return t(this,e,i,n)}}))},2490:(t,e,i)=>{i(7209)("Float64",8,(function(t){return function(e,i,n){return t(this,e,i,n)}}))},1220:(t,e,i)=>{i(7209)("Int16",2,(function(t){return function(e,i,n){return t(this,e,i,n)}}))},8066:(t,e,i)=>{i(7209)("Int32",4,(function(t){return function(e,i,n){return t(this,e,i,n)}}))},8699:(t,e,i)=>{i(7209)("Int8",1,(function(t){return function(e,i,n){return t(this,e,i,n)}}))},2087:(t,e,i)=>{i(7209)("Uint16",2,(function(t){return function(e,i,n){return t(this,e,i,n)}}))},8537:(t,e,i)=>{i(7209)("Uint32",4,(function(t){return function(e,i,n){return t(this,e,i,n)}}))},4702:(t,e,i)=>{i(7209)("Uint8",1,(function(t){return function(e,i,n){return t(this,e,i,n)}}))},333:(t,e,i)=>{i(7209)("Uint8",1,(function(t){return function(e,i,n){return t(this,e,i,n)}}),!0)},9397:(t,e,i)=>{"use strict";var n,s=i(7526),r=i(6179)(0),o=i(8859),a=i(2988),h=i(8206),l=i(9882),c=i(3305),u=i(2888),d=i(2888),g=!s.ActiveXObject&&"ActiveXObject"in s,f="WeakMap",p=a.getWeak,_=Object.isExtensible,m=l.ufstore,y=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},v={get:function(t){if(c(t)){var e=p(t);return!0===e?m(u(this,f)).get(t):e?e[this._i]:void 0}},set:function(t,e){return l.def(u(this,f),t,e)}},x=t.exports=i(8933)(f,y,v,l,!0,!0);d&&g&&(h((n=l.getConstructor(y,f)).prototype,v),a.NEED=!0,r(["delete","has","get","set"],(function(t){var e=x.prototype,i=e[t];o(e,t,(function(e,s){if(c(e)&&!_(e)){this._f||(this._f=new n);var r=this._f[t](e,s);return"set"==t?this:r}return i.call(this,e,s)}))})))},8163:(t,e,i)=>{"use strict";var n=i(9882),s=i(2888),r="WeakSet";i(8933)(r,(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(t){return n.def(s(this,r),t,!0)}},n,!1,!0)},9766:(t,e,i)=>{"use strict";var n=i(2127),s=i(2322),r=i(8270),o=i(1485),a=i(3387),h=i(3191);n(n.P,"Array",{flatMap:function(t){var e,i,n=r(this);return a(t),e=o(n.length),i=h(n,0),s(i,n,n,e,0,1,t,arguments[1]),i}}),i(8184)("flatMap")},9087:(t,e,i)=>{"use strict";var n=i(2127),s=i(1464)(!0);n(n.P,"Array",{includes:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}}),i(8184)("includes")},7146:(t,e,i)=>{var n=i(2127),s=i(3854)(!0);n(n.S,"Object",{entries:function(t){return s(t)}})},4614:(t,e,i)=>{var n=i(2127),s=i(6222),r=i(7221),o=i(8641),a=i(7227);n(n.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,i,n=r(t),h=o.f,l=s(n),c={},u=0;l.length>u;)void 0!==(i=h(n,e=l[u++]))&&a(c,e,i);return c}})},7594:(t,e,i)=>{var n=i(2127),s=i(3854)(!1);n(n.S,"Object",{values:function(t){return s(t)}})},8583:(t,e,i)=>{"use strict";var n=i(2127),s=i(6094),r=i(7526),o=i(9190),a=i(5957);n(n.P+n.R,"Promise",{finally:function(t){var e=o(this,s.Promise||r.Promise),i="function"==typeof t;return this.then(i?function(i){return a(e,t()).then((function(){return i}))}:t,i?function(i){return a(e,t()).then((function(){throw i}))}:t)}})},5693:(t,e,i)=>{"use strict";var n=i(2127),s=i(4472),r=i(4514),o=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(r);n(n.P+n.F*o,"String",{padEnd:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},5380:(t,e,i)=>{"use strict";var n=i(2127),s=i(4472),r=i(4514),o=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(r);n(n.P+n.F*o,"String",{padStart:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},62:(t,e,i)=>{"use strict";i(629)("trimLeft",(function(t){return function(){return t(this,1)}}),"trimStart")},521:(t,e,i)=>{"use strict";i(629)("trimRight",(function(t){return function(){return t(this,2)}}),"trimEnd")},2820:(t,e,i)=>{i(5392)("asyncIterator")},5890:(t,e,i)=>{for(var n=i(5165),s=i(1311),r=i(8859),o=i(7526),a=i(3341),h=i(906),l=i(7574),c=l("iterator"),u=l("toStringTag"),d=h.Array,g={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=s(g),p=0;p<f.length;p++){var _,m=f[p],y=g[m],v=o[m],x=v&&v.prototype;if(x&&(x[c]||a(x,c,d),x[u]||a(x,u,m),h[m]=d,y))for(_ in n)x[_]||r(x,_,n[_],!0)}},5417:(t,e,i)=>{var n=i(2127),s=i(2780);n(n.G+n.B,{setImmediate:s.set,clearImmediate:s.clear})},8772:(t,e,i)=>{var n=i(7526),s=i(2127),r=i(4514),o=[].slice,a=/MSIE .\./.test(r),h=function(t){return function(e,i){var n=arguments.length>2,s=!!n&&o.call(arguments,2);return t(n?function(){("function"==typeof e?e:Function(e)).apply(this,s)}:e,i)}};s(s.G+s.B+s.F*a,{setTimeout:h(n.setTimeout),setInterval:h(n.setInterval)})},3415:(t,e,i)=>{i(8772),i(5417),i(5890),t.exports=i(6094)},7452:t=>{var e=function(t){"use strict";var e,i=Object.prototype,n=i.hasOwnProperty,s=Object.defineProperty||function(t,e,i){t[e]=i.value},r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",h=r.toStringTag||"@@toStringTag";function l(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,i){return t[e]=i}}function c(t,e,i,n){var r=e&&e.prototype instanceof m?e:m,o=Object.create(r.prototype),a=new R(n||[]);return s(o,"_invoke",{value:E(t,i,a)}),o}function u(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var d="suspendedStart",g="suspendedYield",f="executing",p="completed",_={};function m(){}function y(){}function v(){}var x={};l(x,o,(function(){return this}));var M=Object.getPrototypeOf,w=M&&M(M(A([])));w&&w!==i&&n.call(w,o)&&(x=w);var S=v.prototype=m.prototype=Object.create(x);function C(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function i(s,r,o,a){var h=u(t[s],t,r);if("throw"!==h.type){var l=h.arg,c=l.value;return c&&"object"==typeof c&&n.call(c,"__await")?e.resolve(c.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(c).then((function(t){l.value=t,o(l)}),(function(t){return i("throw",t,o,a)}))}a(h.arg)}var r;s(this,"_invoke",{value:function(t,n){function s(){return new e((function(e,s){i(t,n,e,s)}))}return r=r?r.then(s,s):s()}})}function E(t,e,i){var n=d;return function(s,r){if(n===f)throw new Error("Generator is already running");if(n===p){if("throw"===s)throw r;return F()}for(i.method=s,i.arg=r;;){var o=i.delegate;if(o){var a=P(o,i);if(a){if(a===_)continue;return a}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===d)throw n=p,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=f;var h=u(t,e,i);if("normal"===h.type){if(n=i.done?p:g,h.arg===_)continue;return{value:h.arg,done:i.done}}"throw"===h.type&&(n=p,i.method="throw",i.arg=h.arg)}}}function P(t,i){var n=i.method,s=t.iterator[n];if(s===e)return i.delegate=null,"throw"===n&&t.iterator.return&&(i.method="return",i.arg=e,P(t,i),"throw"===i.method)||"return"!==n&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var r=u(s,t.iterator,i.arg);if("throw"===r.type)return i.method="throw",i.arg=r.arg,i.delegate=null,_;var o=r.arg;return o?o.done?(i[t.resultName]=o.value,i.next=t.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,_):o:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,_)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function A(t){if(t){var i=t[o];if(i)return i.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var s=-1,r=function i(){for(;++s<t.length;)if(n.call(t,s))return i.value=t[s],i.done=!1,i;return i.value=e,i.done=!0,i};return r.next=r}}return{next:F}}function F(){return{value:e,done:!0}}return y.prototype=v,s(S,"constructor",{value:v,configurable:!0}),s(v,"constructor",{value:y,configurable:!0}),y.displayName=l(v,h,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,l(t,h,"GeneratorFunction")),t.prototype=Object.create(S),t},t.awrap=function(t){return{__await:t}},C(b.prototype),l(b.prototype,a,(function(){return this})),t.AsyncIterator=b,t.async=function(e,i,n,s,r){void 0===r&&(r=Promise);var o=new b(c(e,i,n,s),r);return t.isGeneratorFunction(i)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},C(S),l(S,h,"Generator"),l(S,o,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),i=[];for(var n in e)i.push(n);return i.reverse(),function t(){for(;i.length;){var n=i.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=A,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var i in this)"t"===i.charAt(0)&&n.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var i=this;function s(n,s){return a.type="throw",a.arg=t,i.next=n,s&&(i.method="next",i.arg=e),!!s}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],a=o.completion;if("root"===o.tryLoc)return s("end");if(o.tryLoc<=this.prev){var h=n.call(o,"catchLoc"),l=n.call(o,"finallyLoc");if(h&&l){if(this.prev<o.catchLoc)return s(o.catchLoc,!0);if(this.prev<o.finallyLoc)return s(o.finallyLoc)}else if(h){if(this.prev<o.catchLoc)return s(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return s(o.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i];if(s.tryLoc<=this.prev&&n.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var r=s;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=t,o.arg=e,r?(this.method="next",this.next=r.finallyLoc,_):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),_},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),T(i),_}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var s=n.arg;T(i)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(t,i,n){return this.delegate={iterator:A(t),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=e),_}},t}(t.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}},e={};function i(n){var s=e[n];if(void 0!==s)return s.exports;var r=e[n]={exports:{}};return t[n](r,r.exports,i),r.exports}i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};i(4572),(()=>{"use strict";i.r(n),i.d(n,{addLayer:()=>Rf,checkInitialized:()=>Af,getObjectMap:()=>Ff,initMap:()=>If,initMapWidget:()=>Tf,registerProjection:()=>kf,setItemIcon:()=>Of,setReadOnly:()=>Lf});const t=class{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}},e="propertychange",s=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}};function r(t,e){return t>e?1:t<e?-1:0}function o(t,e,i){if(t[0]<=e)return 0;const n=t.length;if(e<=t[n-1])return n-1;if("function"==typeof i){for(let s=1;s<n;++s){const n=t[s];if(n===e)return s;if(n<e)return i(e,t[s-1],n)>0?s-1:s}return n-1}if(i>0){for(let i=1;i<n;++i)if(t[i]<e)return i-1;return n-1}if(i<0){for(let i=1;i<n;++i)if(t[i]<=e)return i;return n-1}for(let i=1;i<n;++i){if(t[i]==e)return i;if(t[i]<e)return t[i-1]-e<e-t[i]?i-1:i}return n-1}function a(t,e,i){for(;e<i;){const n=t[e];t[e]=t[i],t[i]=n,++e,--i}}function h(t,e){const i=Array.isArray(e)?e:[e],n=i.length;for(let e=0;e<n;e++)t[t.length]=i[e]}function l(t,e){const i=t.length;if(i!==e.length)return!1;for(let n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}function c(){return!0}function u(){return!1}function d(){}function g(t){let e,i,n;return function(){const s=Array.prototype.slice.call(arguments);return i&&this===n&&l(s,i)||(n=this,i=s,e=t.apply(this,arguments)),e}}function f(t){return function(){let e;try{e=t()}catch(t){return Promise.reject(t)}return e instanceof Promise?e:Promise.resolve(e)}()}function p(t){for(const e in t)delete t[e]}function _(t){let e;for(e in t)return!1;return!e}const m=class extends s{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const i=this.listeners_||(this.listeners_={}),n=i[t]||(i[t]=[]);n.includes(e)||n.push(e)}dispatchEvent(e){const i="string"==typeof e,n=i?e:e.type,s=this.listeners_&&this.listeners_[n];if(!s)return;const r=i?new t(e):e;r.target||(r.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});let h;n in o||(o[n]=0,a[n]=0),++o[n];for(let t=0,e=s.length;t<e;++t)if(h="handleEvent"in s[t]?s[t].handleEvent(r):s[t].call(this,r),!1===h||r.propagationStopped){h=!1;break}if(0==--o[n]){let t=a[n];for(delete a[n];t--;)this.removeEventListener(n,d);delete o[n]}return h}disposeInternal(){this.listeners_&&p(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return!!this.listeners_&&(t?t in this.listeners_:Object.keys(this.listeners_).length>0)}removeEventListener(t,e){if(!this.listeners_)return;const i=this.listeners_[t];if(!i)return;const n=i.indexOf(e);-1!==n&&(this.pendingRemovals_&&t in this.pendingRemovals_?(i[n]=d,++this.pendingRemovals_[t]):(i.splice(n,1),0===i.length&&delete this.listeners_[t]))}},y="change",v="contextmenu",x="click",M="keydown",w="keypress",S="touchmove",C="wheel";function b(t,e,i,n,s){if(s){const s=i;i=function(){t.removeEventListener(e,i),s.apply(n??this,arguments)}}else n&&n!==t&&(i=i.bind(n));const r={target:t,type:e,listener:i};return t.addEventListener(e,i),r}function E(t,e,i,n){return b(t,e,i,n,!0)}function P(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),p(t))}class I extends m{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(y)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const i=t.length,n=new Array(i);for(let s=0;s<i;++s)n[s]=b(this,t[s],e);return n}return b(this,t,e)}onceInternal(t,e){let i;if(Array.isArray(t)){const n=t.length;i=new Array(n);for(let s=0;s<n;++s)i[s]=E(this,t[s],e)}else i=E(this,t,e);return e.ol_key=i,i}unInternal(t,e){const i=e.ol_key;if(i)!function(t){if(Array.isArray(t))for(let e=0,i=t.length;e<i;++e)P(t[e]);else P(t)}(i);else if(Array.isArray(t))for(let i=0,n=t.length;i<n;++i)this.removeEventListener(t[i],e);else this.removeEventListener(t,e)}}I.prototype.on,I.prototype.once,I.prototype.un;const T=I;function R(){throw new Error("Unimplemented abstract method.")}let A=0;function F(t){return t.ol_uid||(t.ol_uid=String(++A))}class L extends t{constructor(t,e,i){super(t),this.key=e,this.oldValue=i}}const k=class extends T{constructor(t){super(),this.on,this.once,this.un,F(this),this.values_=null,void 0!==t&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,i){let n;n=`change:${t}`,this.hasListener(n)&&this.dispatchEvent(new L(n,t,i)),n=e,this.hasListener(n)&&this.dispatchEvent(new L(n,t,i))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,i){const n=this.values_||(this.values_={});if(i)n[t]=e;else{const i=n[t];n[t]=e,i!==e&&this.notify(t,i)}}setProperties(t,e){for(const i in t)this.set(i,t[i],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const i=this.values_[t];delete this.values_[t],_(this.values_)&&(this.values_=null),e||this.notify(t,i)}}};function O(t,e){if(!t)throw new Error(e)}class D extends k{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if("function"==typeof t.getSimplifiedGeometry){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new D(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const i=this.getStyle();return i&&t.setStyle(i),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(P(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=b(t,y,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?function(t){if("function"==typeof t)return t;let e;return Array.isArray(t)?e=t:(O("function"==typeof t.getZIndex,"Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[t]),function(){return e}}(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}const N=D;function G(t,e){const i=e[0],n=e[1];return e[0]=t[0]*i+t[2]*n+t[4],e[1]=t[1]*i+t[3]*n+t[5],e}function j(t,e,i,n,s,r,o,a){const h=Math.sin(r),l=Math.cos(r);return t[0]=n*l,t[1]=s*h,t[2]=-n*h,t[3]=s*l,t[4]=o*n*l-a*n*h+e,t[5]=o*s*h+a*s*l+i,t}function z(t,e){const i=(n=e)[0]*n[3]-n[1]*n[2];var n;O(0!==i,"Transformation matrix cannot be inverted");const s=e[0],r=e[1],o=e[2],a=e[3],h=e[4],l=e[5];return t[0]=a/i,t[1]=-r/i,t[2]=-o/i,t[3]=s/i,t[4]=(o*l-a*h)/i,t[5]=-(s*l-r*h)/i,t}new Array(6);const B=[1e6,1e6,1e6,1e6,2,2];const W={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function q(t){const e=[1/0,1/0,-1/0,-1/0];for(let i=0,n=t.length;i<n;++i)st(e,t[i]);return e}function X(t,e,i){return i?(i[0]=t[0]-e,i[1]=t[1]-e,i[2]=t[2]+e,i[3]=t[3]+e,i):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function U(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function V(t,e,i){let n,s;return n=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0,s=i<t[1]?t[1]-i:t[3]<i?i-t[3]:0,n*n+s*s}function K(t,e){return Z(t,e[0],e[1])}function Y(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function Z(t,e,i){return t[0]<=e&&e<=t[2]&&t[1]<=i&&i<=t[3]}function H(t,e){const i=t[0],n=t[1],s=t[2],r=t[3],o=e[0],a=e[1];let h=W.UNKNOWN;return o<i?h|=W.LEFT:o>s&&(h|=W.RIGHT),a<n?h|=W.BELOW:a>r&&(h|=W.ABOVE),h===W.UNKNOWN&&(h=W.INTERSECTING),h}function J(t,e,i,n,s){return s?(s[0]=t,s[1]=e,s[2]=i,s[3]=n,s):[t,e,i,n]}function Q(t){return J(1/0,1/0,-1/0,-1/0,t)}function tt(t,e){const i=t[0],n=t[1];return J(i,n,i,n,e)}function et(t,e,i,n,s){return rt(Q(s),t,e,i,n)}function it(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function nt(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function st(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function rt(t,e,i,n,s){for(;i<n;i+=s)ot(t,e[i],e[i+1]);return t}function ot(t,e,i){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],i),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],i)}function at(t,e){let i;return i=e(lt(t)),i||(i=e(ct(t)),i||(i=e(mt(t)),i||(i=e(_t(t)),i||!1)))}function ht(t){let e=0;return xt(t)||(e=yt(t)*ft(t)),e}function lt(t){return[t[0],t[1]]}function ct(t){return[t[2],t[1]]}function ut(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function dt(t,e){let i;if("bottom-left"===e)i=lt(t);else if("bottom-right"===e)i=ct(t);else if("top-left"===e)i=_t(t);else{if("top-right"!==e)throw new Error("Invalid corner");i=mt(t)}return i}function gt(t,e,i,n,s){const[r,o,a,h,l,c,u,d]=function(t,e,i,n){const s=e*n[0]/2,r=e*n[1]/2,o=Math.cos(i),a=Math.sin(i),h=s*o,l=s*a,c=r*o,u=r*a,d=t[0],g=t[1];return[d-h+u,g-l-c,d-h-u,g-l+c,d+h-u,g+l+c,d+h+u,g+l-c,d-h+u,g-l-c]}(t,e,i,n);return J(Math.min(r,a,l,u),Math.min(o,h,c,d),Math.max(r,a,l,u),Math.max(o,h,c,d),s)}function ft(t){return t[3]-t[1]}function pt(t,e,i){const n=i||[1/0,1/0,-1/0,-1/0];return vt(t,e)?(t[0]>e[0]?n[0]=t[0]:n[0]=e[0],t[1]>e[1]?n[1]=t[1]:n[1]=e[1],t[2]<e[2]?n[2]=t[2]:n[2]=e[2],t[3]<e[3]?n[3]=t[3]:n[3]=e[3]):Q(n),n}function _t(t){return[t[0],t[3]]}function mt(t){return[t[2],t[3]]}function yt(t){return t[2]-t[0]}function vt(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function xt(t){return t[2]<t[0]||t[3]<t[1]}function Mt(t,e){const i=e.getExtent(),n=ut(t);if(e.canWrapX()&&(n[0]<i[0]||n[0]>=i[2])){const e=yt(i),s=Math.floor((n[0]-i[0])/e)*e;t[0]-=s,t[2]-=s}return t}function wt(t,e,i){if(e.canWrapX()){const n=e.getExtent();if(!isFinite(t[0])||!isFinite(t[2]))return[[n[0],t[1],n[2],t[3]]];Mt(t,e);const s=yt(n);if(yt(t)>s&&!i)return[[n[0],t[1],n[2],t[3]]];if(t[0]<n[0])return[[t[0]+s,t[1],n[2],t[3]],[n[0],t[1],t[2],t[3]]];if(t[2]>n[2])return[[t[0],t[1],n[2],t[3]],[n[0],t[1],t[2]-s,t[3]]]}return[t]}function St(t,e,i){return Math.min(Math.max(t,e),i)}function Ct(t,e,i,n,s,r){const o=s-i,a=r-n;if(0!==o||0!==a){const h=((t-i)*o+(e-n)*a)/(o*o+a*a);h>1?(i=s,n=r):h>0&&(i+=o*h,n+=a*h)}return bt(t,e,i,n)}function bt(t,e,i,n){const s=i-t,r=n-e;return s*s+r*r}function Et(t){return t*Math.PI/180}function Pt(t,e){const i=t%e;return i*e<0?i+e:i}function It(t,e,i){return t+i*(e-t)}function Tt(t,e){const i=Math.pow(10,e);return Math.round(t*i)/i}function Rt(t,e){return Math.round(Tt(t,e))}function At(t,e){return Math.floor(Tt(t,e))}function Ft(t,e){return Math.ceil(Tt(t,e))}function Lt(t,e,i,n,s,r,o){const a=(i-e)/n;if(a<3){for(;e<i;e+=n)r[o++]=t[e],r[o++]=t[e+1];return o}const h=new Array(a);h[0]=1,h[a-1]=1;const l=[e,i-n];let c=0;for(;l.length>0;){const i=l.pop(),r=l.pop();let o=0;const a=t[r],u=t[r+1],d=t[i],g=t[i+1];for(let e=r+n;e<i;e+=n){const i=Ct(t[e],t[e+1],a,u,d,g);i>o&&(c=e,o=i)}o>s&&(h[(c-e)/n]=1,r+n<c&&l.push(r,c),c+n<i&&l.push(c,i))}for(let i=0;i<a;++i)h[i]&&(r[o++]=t[e+i*n],r[o++]=t[e+i*n+1]);return o}function kt(t,e,i,n,s,r,o,a){for(let h=0,l=i.length;h<l;++h){const l=i[h];o=Lt(t,e,l,n,s,r,o),a.push(o),e=l}return o}function Ot(t,e){return e*Math.round(t/e)}function Dt(t,e,i,n,s,r,o){if(e==i)return o;let a,h,l=Ot(t[e],s),c=Ot(t[e+1],s);e+=n,r[o++]=l,r[o++]=c;do{if(a=Ot(t[e],s),h=Ot(t[e+1],s),(e+=n)==i)return r[o++]=a,r[o++]=h,o}while(a==l&&h==c);for(;e<i;){const i=Ot(t[e],s),u=Ot(t[e+1],s);if(e+=n,i==a&&u==h)continue;const d=a-l,g=h-c,f=i-l,p=u-c;d*p==g*f&&(d<0&&f<d||d==f||d>0&&f>d)&&(g<0&&p<g||g==p||g>0&&p>g)?(a=i,h=u):(r[o++]=a,r[o++]=h,l=a,c=h,a=i,h=u)}return r[o++]=a,r[o++]=h,o}function Nt(t,e,i,n,s,r,o,a){for(let h=0,l=i.length;h<l;++h){const l=i[h];o=Dt(t,e,l,n,s,r,o),a.push(o),e=l}return o}function Gt(t,e,i,n,s){return!at(s,(function(s){return!jt(t,e,i,n,s[0],s[1])}))}function jt(t,e,i,n,s,r){let o=0,a=t[i-n],h=t[i-n+1];for(;e<i;e+=n){const i=t[e],n=t[e+1];h<=r?n>r&&(i-a)*(r-h)-(s-a)*(n-h)>0&&o++:n<=r&&(i-a)*(r-h)-(s-a)*(n-h)<0&&o--,a=i,h=n}return 0!==o}function zt(t,e,i,n,s,r){if(0===i.length)return!1;if(!jt(t,e,i[0],n,s,r))return!1;for(let e=1,o=i.length;e<o;++e)if(jt(t,i[e-1],i[e],n,s,r))return!1;return!0}function Bt(t,e,i,n,s,o,a){let h,l,c,u,d,g,f;const p=s[o+1],_=[];for(let s=0,r=i.length;s<r;++s){const r=i[s];for(u=t[r-n],g=t[r-n+1],h=e;h<r;h+=n)d=t[h],f=t[h+1],(p<=g&&f<=p||g<=p&&p<=f)&&(c=(p-g)/(f-g)*(d-u)+u,_.push(c)),u=d,g=f}let m=NaN,y=-1/0;for(_.sort(r),u=_[0],h=1,l=_.length;h<l;++h){d=_[h];const s=Math.abs(d-u);s>y&&(c=(u+d)/2,zt(t,e,i,n,c,p)&&(m=c,y=s)),u=d}return isNaN(m)&&(m=s[o]),a?(a.push(m,p,y),a):[m,p,y]}function Wt(t,e,i,n,s){let r=[];for(let o=0,a=i.length;o<a;++o){const a=i[o];r=Bt(t,e,a,n,s,2*o,r),e=a[a.length-1]}return r}const qt={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937},Xt=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||qt[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}},Ut=6378137,Vt=Math.PI*Ut,Kt=[-Vt,-Vt,Vt,Vt],Yt=[-180,-85,180,85],Zt=Ut*Math.log(Math.tan(Math.PI/2));class Ht extends Xt{constructor(t){super({code:t,units:"m",extent:Kt,global:!0,worldExtent:Yt,getPointResolution:function(t,e){return t/Math.cosh(e[1]/Ut)}})}}const Jt=[new Ht("EPSG:3857"),new Ht("EPSG:102100"),new Ht("EPSG:102113"),new Ht("EPSG:900913"),new Ht("http://www.opengis.net/def/crs/EPSG/0/3857"),new Ht("http://www.opengis.net/gml/srs/epsg.xml#3857")];const $t=[-180,-90,180,90],Qt=6378137*Math.PI/180;class te extends Xt{constructor(t,e){super({code:t,units:"degrees",extent:$t,axisOrientation:e,global:!0,metersPerUnit:Qt,worldExtent:$t})}}const ee=[new te("CRS:84"),new te("EPSG:4326","neu"),new te("urn:ogc:def:crs:OGC:1.3:CRS84"),new te("urn:ogc:def:crs:OGC:2:84"),new te("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new te("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new te("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let ie={},ne={};function se(t,e,i){const n=t.getCode(),s=e.getCode();n in ne||(ne[n]={}),ne[n][s]=i}function re(t,e){let i;return t in ne&&e in ne[t]&&(i=ne[t][e]),i}function oe(t,e){const i=t[0],n=t[1],s=e[0],r=e[1],o=s[0],a=s[1],h=r[0],l=r[1],c=h-o,u=l-a,d=0===c&&0===u?0:(c*(i-o)+u*(n-a))/(c*c+u*u||0);let g,f;return d<=0?(g=o,f=a):d>=1?(g=h,f=l):(g=o+d*c,f=a+d*u),[g,f]}function ae(t,e){let i=!0;for(let n=t.length-1;n>=0;--n)if(t[n]!=e[n]){i=!1;break}return i}function he(t,e){const i=Math.cos(e),n=Math.sin(e),s=t[0]*i-t[1]*n,r=t[1]*i+t[0]*n;return t[0]=s,t[1]=r,t}function le(t,e){const i=t[0]-e[0],n=t[1]-e[1];return i*i+n*n}function ce(t,e){return Math.sqrt(le(t,e))}function ue(t,e){if(e.canWrapX()){const i=yt(e.getExtent()),n=de(t,e,i);n&&(t[0]-=n*i)}return t}function de(t,e,i){const n=e.getExtent();let s=0;return e.canWrapX()&&(t[0]<n[0]||t[0]>n[2])&&(i=i||yt(n),s=Math.floor((t[0]-n[0])/i)),s}const ge=6371008.8;function fe(t,e,i){i=i||ge;const n=Et(t[1]),s=Et(e[1]),r=(s-n)/2,o=Et(e[0]-t[0])/2,a=Math.sin(r)*Math.sin(r)+Math.sin(o)*Math.sin(o)*Math.cos(n)*Math.cos(s);return 2*i*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}const pe={info:1,warn:2,error:3,none:4};let _e=pe.info;function me(...t){_e>pe.warn||console.warn(...t)}let ye=!0;function ve(t){ye=!(void 0===t||t)}function xe(t,e){if(void 0!==e)for(let i=0,n=t.length;i<n;++i)e[i]=t[i];else e=t.slice();return e}function Me(t,e){if(void 0!==e&&t!==e){for(let i=0,n=t.length;i<n;++i)e[i]=t[i];t=e}return t}function we(t){!function(t,e){ie[t]=e}(t.getCode(),t),se(t,t,xe)}function Se(t){return"string"==typeof t?ie[e=t]||ie[e.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null:t||null;var e}function Ce(t,e,i,n){let s;const r=(t=Se(t)).getPointResolutionFunc();if(r){if(s=r(e,i),n&&n!==t.getUnits()){const e=t.getMetersPerUnit();e&&(s=s*e/qt[n])}}else{const r=t.getUnits();if("degrees"==r&&!n||"degrees"==n)s=e;else{const o=Re(t,Se("EPSG:4326"));if(o===Me&&"degrees"!==r)s=e*t.getMetersPerUnit();else{let t=[i[0]-e/2,i[1],i[0]+e/2,i[1],i[0],i[1]-e/2,i[0],i[1]+e/2];t=o(t,t,2),s=(fe(t.slice(0,2),t.slice(2,4))+fe(t.slice(4,6),t.slice(6,8)))/2}const a=n?qt[n]:t.getMetersPerUnit();void 0!==a&&(s/=a)}}return s}function be(t){!function(t){t.forEach(we)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&se(e,t,xe)}))}))}function Ee(t,e){return t?"string"==typeof t?Se(t):t:Se(e)}function Pe(t){return function(e,i,n,s){const r=e.length;n=void 0!==n?n:2,s=s??n,i=void 0!==i?i:new Array(r);for(let o=0;o<r;o+=s){const r=t(e.slice(o,o+n)),a=r.length;for(let t=0,n=s;t<n;++t)i[o+t]=t>=a?e[o+t]:r[t]}return i}}function Ie(t,e,i,n){const s=Se(t),r=Se(e);se(s,r,Pe(i)),se(r,s,Pe(n))}function Te(t,e){if(t===e)return!0;const i=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||Re(t,e)===xe)&&i}function Re(t,e){let i=re(t.getCode(),e.getCode());return i||(i=Me),i}function Ae(t,e){return Re(Se(t),Se(e))}function Fe(t,e,i){return Ae(e,i)(t,void 0,t.length)}function Le(t,e,i,n){return function(t,e,i,n){if(xt(t))return Q(i);let s=[];if(n>1){const e=t[2]-t[0],i=t[3]-t[1];for(let r=0;r<n;++r)s.push(t[0]+e*r/n,t[1],t[2],t[1]+i*r/n,t[2]-e*r/n,t[3],t[0],t[3]-i*r/n)}else s=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];e(s,s,2);const r=[],o=[];for(let t=0,e=s.length;t<e;t+=2)r.push(s[t]),o.push(s[t+1]);return function(t,e,i){return J(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),i)}(r,o,i)}(t,Ae(e,i),void 0,n)}let ke=null;function Oe(){return ke}function De(t,e){return ke?Fe(t,e,ke):t}function Ne(t,e){return ke?Fe(t,ke,e):(ye&&!ae(t,[0,0])&&t[0]>=-180&&t[0]<=180&&t[1]>=-90&&t[1]<=90&&(ye=!1,me("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),t)}function Ge(t,e){return ke?Le(t,e,ke):t}function je(t,e){return ke?Le(t,ke,e):t}function ze(t,e){if(!ke)return t;const i=Se(e).getMetersPerUnit(),n=ke.getMetersPerUnit();return i&&n?t*i/n:t}function Be(t,e,i){return function(n){let s,r;if(t.canWrapX()){const e=t.getExtent(),o=yt(e);r=de(n=n.slice(0),t,o),r&&(n[0]=n[0]-r*o),n[0]=St(n[0],e[0],e[2]),n[1]=St(n[1],e[1],e[3]),s=i(n)}else s=i(n);return r&&e.canWrapX()&&(s[0]+=r*yt(e.getExtent())),s}}var We,qe,Xe;function Ue(t,e,i,n){for(;e<i-n;){for(let s=0;s<n;++s){const r=t[e+s];t[e+s]=t[i-n+s],t[i-n+s]=r}e+=n,i-=n}}function Ve(t,e,i,n){let s=0,r=t[i-n],o=t[i-n+1];for(;e<i;e+=n){const i=t[e],n=t[e+1];s+=(i-r)*(n+o),r=i,o=n}return 0===s?void 0:s>0}function Ke(t,e,i,n,s){s=void 0!==s&&s;for(let r=0,o=i.length;r<o;++r){const o=i[r],a=Ve(t,e,o,n);if(0===r){if(s&&a||!s&&!a)return!1}else if(s&&!a||!s&&a)return!1;e=o}return!0}function Ye(t,e,i,n,s){for(let r=0,o=i.length;r<o;++r){const o=i[r];if(!Ke(t,e,o,n,s))return!1;o.length&&(e=o[o.length-1])}return!0}function Ze(t,e,i,n,s){s=void 0!==s&&s;for(let r=0,o=i.length;r<o;++r){const o=i[r],a=Ve(t,e,o,n);(0===r?s&&a||!s&&!a:s&&!a||!s&&a)&&Ue(t,e,o,n),e=o}return e}function He(t,e,i,n,s){for(let r=0,o=i.length;r<o;++r)e=Ze(t,e,i[r],n,s);return e}function Je(t,e,i,n,s,o,a){let h,l;const c=(i-e)/n;if(1===c)h=e;else if(2===c)h=e,l=s;else if(0!==c){let o=t[e],a=t[e+1],c=0;const u=[0];for(let s=e+n;s<i;s+=n){const e=t[s],i=t[s+1];c+=Math.sqrt((e-o)*(e-o)+(i-a)*(i-a)),u.push(c),o=e,a=i}const d=s*c,g=function(t,e,i){let n,s;i=i||r;let o=0,a=t.length,h=!1;for(;o<a;)n=o+(a-o>>1),s=+i(t[n],e),s<0?o=n+1:(a=n,h=!s);return h?o:~o}(u,d);g<0?(l=(d-u[-g-2])/(u[-g-1]-u[-g-2]),h=e+(-g-2)*n):h=e+g*n}a=a>1?a:2,o=o||new Array(a);for(let e=0;e<a;++e)o[e]=void 0===h?NaN:void 0===l?t[h+e]:It(t[h+e],t[h+n+e],l);return o}function $e(t,e,i,n,s,r){if(i==e)return null;let o;if(s<t[e+n-1])return r?(o=t.slice(e,e+n),o[n-1]=s,o):null;if(t[i-1]<s)return r?(o=t.slice(i-n,i),o[n-1]=s,o):null;if(s==t[e+n-1])return t.slice(e,e+n);let a=e/n,h=i/n;for(;a<h;){const e=a+h>>1;s<t[(e+1)*n-1]?h=e:a=e+1}const l=t[a*n-1];if(s==l)return t.slice((a-1)*n,(a-1)*n+n);const c=(s-l)/(t[(a+1)*n-1]-l);o=[];for(let e=0;e<n-1;++e)o.push(It(t[(a-1)*n+e],t[a*n+e],c));return o.push(s),o}function Qe(t,e,i,n){const s=[];let r=[1/0,1/0,-1/0,-1/0];for(let o=0,a=i.length;o<a;++o){const a=i[o];r=et(t,e,a[0],n),s.push((r[0]+r[2])/2,(r[1]+r[3])/2),e=a[a.length-1]}return s}function ti(t,e,i,n,s,r,o){r=r||[],o=o||2;let a=0;for(let h=e;h<i;h+=n){const e=t[h],i=t[h+1];r[a++]=s[0]*e+s[2]*i+s[4],r[a++]=s[1]*e+s[3]*i+s[5];for(let e=2;e<o;e++)r[a++]=t[h+e]}return r&&r.length!=a&&(r.length=a),r}function ei(t,e,i,n,s,r,o){o=o||[];const a=Math.cos(s),h=Math.sin(s),l=r[0],c=r[1];let u=0;for(let s=e;s<i;s+=n){const e=t[s]-l,i=t[s+1]-c;o[u++]=l+e*a-i*h,o[u++]=c+e*h+i*a;for(let e=s+2;e<s+n;++e)o[u++]=t[e]}return o&&o.length!=u&&(o.length=u),o}be(Jt),be(ee),We=Jt,qe=function(t,e,i,n){const s=t.length;i=i>1?i:2,n=n??i,void 0===e&&(e=i>2?t.slice():new Array(s));for(let i=0;i<s;i+=n){e[i]=Vt*t[i]/180;let n=Ut*Math.log(Math.tan(Math.PI*(+t[i+1]+90)/360));n>Zt?n=Zt:n<-Zt&&(n=-Zt),e[i+1]=n}return e},Xe=function(t,e,i,n){const s=t.length;i=i>1?i:2,n=n??i,void 0===e&&(e=i>2?t.slice():new Array(s));for(let i=0;i<s;i+=n)e[i]=180*t[i]/Vt,e[i+1]=360*Math.atan(Math.exp(t[i+1]/Ut))/Math.PI-90;return e},ee.forEach((function(t){We.forEach((function(e){se(t,e,qe),se(e,t,Xe)}))}));const ii=[1,0,0,1,0,0];class ni{constructor(t,e,i,n,s,r){this.styleFunction,this.extent_,this.id_=r,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=s,this.squaredTolerance_,this.stride_=n,this.simplifiedGeometry_}get(t){return this.properties_[t]}getExtent(){return this.extent_||(this.extent_="Point"===this.type_?tt(this.flatCoordinates_):et(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const t=ut(this.getExtent());this.flatInteriorPoints_=Bt(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const t=function(t,e){const i=[];let n,s=0,r=0;for(let o=0,a=e.length;o<a;++o){const a=e[o],h=Ve(t,s,a,2);if(void 0===n&&(n=h),h===n)i.push(e.slice(r,o+1));else{if(0===i.length)continue;i[i.length-1].push(e[r])}r=o+1,s=a}return i}(this.flatCoordinates_,this.ends_),e=Qe(this.flatCoordinates_,0,t,2);this.flatInteriorPoints_=Wt(this.flatCoordinates_,0,t,2,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=Je(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const t=this.flatCoordinates_;let e=0;const i=this.ends_;for(let n=0,s=i.length;n<s;++n){const s=i[n],r=Je(t,e,s,2,.5);h(this.flatMidpoints_,r),e=s}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(t){return this}simplifyTransformed(t,e){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(t){const e=(t=Se(t)).getExtent(),i=t.getWorldExtent();if(e&&i){const t=ft(i)/ft(e);j(ii,i[0],i[3],t,-t,0,0,0),ti(this.flatCoordinates_,0,this.flatCoordinates_.length,2,ii,this.flatCoordinates_)}}applyTransform(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new ni(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=g(((t,e)=>{if(t===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),e&&this.simplifiedGeometry_.applyTransform(e);const i=this.simplifiedGeometry_.getFlatCoordinates();let n;switch(this.type_){case"LineString":i.length=Lt(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,t,i,0),n=[i.length];break;case"MultiLineString":n=[],i.length=kt(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,t,i,0,n);break;case"Polygon":n=[],i.length=Nt(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(t),i,0,n)}return n&&(this.simplifiedGeometry_=new ni(this.type_,i,n,2,this.properties_,this.id_)),this.squaredTolerance_=t,this.simplifiedGeometry_})),this}}ni.prototype.getFlatCoordinates=ni.prototype.getOrientedFlatCoordinates;const si=ni,ri=[1,0,0,1,0,0],oi=class extends k{constructor(){super(),this.extent_=[1/0,1/0,-1/0,-1/0],this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=g(((t,e,i)=>{if(!i)return this.getSimplifiedGeometry(e);const n=this.clone();return n.applyTransform(i),n.getSimplifiedGeometry(e)}))}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return R()}closestPointXY(t,e,i,n){return R()}containsXY(t,e){const i=this.getClosestPoint([t,e]);return i[0]===t&&i[1]===e}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return R()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&Q(t),this.extentRevision_=this.getRevision()}return function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)}rotate(t,e){R()}scale(t,e,i){R()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return R()}getType(){return R()}applyTransform(t){R()}intersectsExtent(t){return R()}translate(t,e){R()}transform(t,e){const i=Se(t),n="tile-pixels"==i.getUnits()?function(t,n,s){const r=i.getExtent(),o=i.getWorldExtent(),a=ft(o)/ft(r);return j(ri,o[0],o[3],a,-a,0,0,0),ti(t,0,t.length,s,ri,n),Ae(i,e)(t,n,s)}:Ae(i,e);return this.applyTransform(n),this}};function ai(t){let e;return 2==t?e="XY":3==t?e="XYZ":4==t&&(e="XYZM"),e}function hi(t){let e;return"XY"==t?e=2:"XYZ"==t||"XYM"==t?e=3:"XYZM"==t&&(e=4),e}const li=class extends oi{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return et(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return R()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=hi(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){R()}setLayout(t,e,i){let n;if(t)n=hi(t);else{for(let t=0;t<i;++t){if(0===e.length)return this.layout="XY",void(this.stride=2);e=e[0]}n=e.length,t=ai(n)}this.layout=t,this.stride=n}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(t,e){const i=this.getFlatCoordinates();if(i){const n=this.getStride();ei(i,0,i.length,n,t,e,i),this.changed()}}scale(t,e,i){void 0===e&&(e=t),i||(i=ut(this.getExtent()));const n=this.getFlatCoordinates();if(n){const s=this.getStride();!function(t,e,i,n,s,r,o,a){a=a||[];const h=o[0],l=o[1];let c=0;for(let e=0;e<i;e+=n){const i=t[e]-h,o=t[e+1]-l;a[c++]=h+s*i,a[c++]=l+r*o;for(let i=e+2;i<e+n;++i)a[c++]=t[i]}a&&a.length!=c&&(a.length=c)}(n,0,n.length,s,t,e,i,n),this.changed()}}translate(t,e){const i=this.getFlatCoordinates();if(i){const n=this.getStride();!function(t,e,i,n,s,r,o){o=o||[];let a=0;for(let e=0;e<i;e+=n){o[a++]=t[e]+s,o[a++]=t[e+1]+r;for(let i=e+2;i<e+n;++i)o[a++]=t[i]}o&&o.length!=a&&(o.length=a)}(i,0,i.length,n,t,e,i),this.changed()}}};function ci(t,e,i,n){for(let n=0,s=i.length;n<s;++n)t[e++]=i[n];return e}function ui(t,e,i,n){for(let s=0,r=i.length;s<r;++s){const r=i[s];for(let i=0;i<n;++i)t[e++]=r[i]}return e}function di(t,e,i,n,s){s=s||[];let r=0;for(let o=0,a=i.length;o<a;++o){const a=ui(t,e,i[o],n);s[r++]=a,e=a}return s.length=r,s}function gi(t,e,i,n,s){s=s||[];let r=0;for(let o=0,a=i.length;o<a;++o){const a=di(t,e,i[o],n,s[r]);0===a.length&&(a[0]=e),s[r++]=a,e=a[a.length-1]}return s.length=r,s}class fi extends li{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new fi(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){const s=this.flatCoordinates,r=bt(t,e,s[0],s[1]);if(r<n){const t=this.stride;for(let e=0;e<t;++e)i[e]=s[e];return i.length=t,r}return n}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return tt(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return Z(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ci(this.flatCoordinates,0,t,this.stride),this.changed()}}const pi=fi;function _i(t,e,i,n,s,r,o){const a=t[e],h=t[e+1],l=t[i]-a,c=t[i+1]-h;let u;if(0===l&&0===c)u=e;else{const d=((s-a)*l+(r-h)*c)/(l*l+c*c);if(d>1)u=i;else{if(d>0){for(let s=0;s<n;++s)o[s]=It(t[e+s],t[i+s],d);return void(o.length=n)}u=e}}for(let e=0;e<n;++e)o[e]=t[u+e];o.length=n}function mi(t,e,i,n,s){let r=t[e],o=t[e+1];for(e+=n;e<i;e+=n){const i=t[e],n=t[e+1],a=bt(r,o,i,n);a>s&&(s=a),r=i,o=n}return s}function yi(t,e,i,n,s){for(let r=0,o=i.length;r<o;++r){const o=i[r];s=mi(t,e,o,n,s),e=o}return s}function vi(t,e,i,n,s,r,o,a,h,l,c){if(e==i)return l;let u,d;if(0===s){if(d=bt(o,a,t[e],t[e+1]),d<l){for(u=0;u<n;++u)h[u]=t[e+u];return h.length=n,d}return l}c=c||[NaN,NaN];let g=e+n;for(;g<i;)if(_i(t,g-n,g,n,o,a,c),d=bt(o,a,c[0],c[1]),d<l){for(l=d,u=0;u<n;++u)h[u]=c[u];h.length=n,g+=n}else g+=n*Math.max((Math.sqrt(d)-Math.sqrt(l))/s|0,1);if(r&&(_i(t,i-n,e,n,o,a,c),d=bt(o,a,c[0],c[1]),d<l)){for(l=d,u=0;u<n;++u)h[u]=c[u];h.length=n}return l}function xi(t,e,i,n,s,r,o,a,h,l,c){c=c||[NaN,NaN];for(let u=0,d=i.length;u<d;++u){const d=i[u];l=vi(t,e,d,n,s,r,o,a,h,l,c),e=d}return l}function Mi(t,e,i,n,s){let r;for(e+=n;e<i;e+=n)if(r=s(t.slice(e-n,e),t.slice(e,e+n)),r)return r;return!1}function wi(t,e,i,n,s){s=void 0!==s?s:[];let r=0;for(let o=e;o<i;o+=n)s[r++]=t.slice(o,o+n);return s.length=r,s}function Si(t,e,i,n,s){s=void 0!==s?s:[];let r=0;for(let o=0,a=i.length;o<a;++o){const a=i[o];s[r++]=wi(t,e,a,n,s[r]),e=a}return s.length=r,s}function Ci(t,e,i,n,s){s=void 0!==s?s:[];let r=0;for(let o=0,a=i.length;o<a;++o){const a=i[o];s[r++]=1===a.length&&a[0]===e?[]:Si(t,e,a,n,s[r]),e=a[a.length-1]}return s.length=r,s}function bi(t,e,i,n,s){const r=rt([1/0,1/0,-1/0,-1/0],t,e,i,n);return!!vt(s,r)&&(!!Y(s,r)||r[0]>=s[0]&&r[2]<=s[2]||r[1]>=s[1]&&r[3]<=s[3]||Mi(t,e,i,n,(function(t,e){return function(t,e,i){let n=!1;const s=H(t,e),r=H(t,i);if(s===W.INTERSECTING||r===W.INTERSECTING)n=!0;else{const o=t[0],a=t[1],h=t[2],l=t[3],c=e[0],u=e[1],d=i[0],g=i[1],f=(g-u)/(d-c);let p,_;r&W.ABOVE&&!(s&W.ABOVE)&&(p=d-(g-l)/f,n=p>=o&&p<=h),n||!(r&W.RIGHT)||s&W.RIGHT||(_=g-(d-h)*f,n=_>=a&&_<=l),n||!(r&W.BELOW)||s&W.BELOW||(p=d-(g-a)/f,n=p>=o&&p<=h),n||!(r&W.LEFT)||s&W.LEFT||(_=g-(d-o)*f,n=_>=a&&_<=l)}return n}(s,t,e)})))}function Ei(t,e,i,n,s){return!!(bi(t,e,i,n,s)||jt(t,e,i,n,s[0],s[1])||jt(t,e,i,n,s[0],s[3])||jt(t,e,i,n,s[2],s[1])||jt(t,e,i,n,s[2],s[3]))}function Pi(t,e,i,n,s){if(!Ei(t,e,i[0],n,s))return!1;if(1===i.length)return!0;for(let e=1,r=i.length;e<r;++e)if(Gt(t,i[e-1],i[e],n,s)&&!bi(t,i[e-1],i[e],n,s))return!1;return!0}function Ii(t,e,i,n){let s=t[e],r=t[e+1],o=0;for(let a=e+n;a<i;a+=n){const e=t[a],i=t[a+1];o+=Math.sqrt((e-s)*(e-s)+(i-r)*(i-r)),s=e,r=i}return o}class Ti extends li{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}appendCoordinate(t){h(this.flatCoordinates,t),this.changed()}clone(){const t=new Ti(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<V(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(mi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),vi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,n))}forEachSegment(t){return Mi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return"XYM"!=this.layout&&"XYZM"!=this.layout?null:(e=void 0!==e&&e,$e(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}getCoordinates(){return wi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return Je(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return Ii(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=Lt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new Ti(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return bi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ui(this.flatCoordinates,0,t,this.stride),this.changed()}}const Ri=Ti;function Ai(t,e,i,n){let s=0;const r=t[i-n],o=t[i-n+1];let a=0,h=0;for(;e<i;e+=n){const i=t[e]-r,n=t[e+1]-o;s+=h*i-a*n,a=i,h=n}return s/2}function Fi(t,e,i,n){let s=0;for(let r=0,o=i.length;r<o;++r){const o=i[r];s+=Ai(t,e,o,n),e=o}return s}class Li extends li{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}clone(){return new Li(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,i,n){return n<V(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(mi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),vi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,n))}getArea(){return Ai(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return wi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=Lt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new Li(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ui(this.flatCoordinates,0,t,this.stride),this.changed()}}const ki=Li;class Oi extends li{constructor(t,e,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,void 0!==e&&i?(this.setFlatCoordinates(e,t),this.ends_=i):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?h(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new Oi(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<V(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(yi(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),xi(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,n))}containsXY(t,e){return zt(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return Fi(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),Ze(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,Si(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=ut(this.getExtent());this.flatInteriorPoint_=Bt(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new pi(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new ki(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,i=this.ends_,n=[];let s=0;for(let r=0,o=i.length;r<o;++r){const o=i[r],a=new ki(e.slice(s,o),t);n.push(a),s=o}return n}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;Ke(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Ze(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=Nt(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,i),new Oi(e,"XY",i)}getType(){return"Polygon"}intersectsExtent(t){return Pi(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=di(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()}}const Di=Oi;function Ni(t){if(xt(t))throw new Error("Cannot create polygon from empty extent");const e=t[0],i=t[1],n=t[2],s=t[3],r=[e,i,e,s,n,s,n,i,e,i];return new Oi(r,"XY",[r.length])}function Gi(t,e,i){e=e||32;const n=t.getStride(),s=t.getLayout(),r=t.getCenter(),o=n*(e+1),a=new Array(o);for(let t=0;t<o;t+=n){a[t]=0,a[t+1]=0;for(let e=2;e<n;e++)a[t+e]=r[e]}const h=[a.length],l=new Oi(a,s,h);return function(t,e,i,n){const s=t.getFlatCoordinates(),r=t.getStride(),o=s.length/r-1,a=n||0;for(let t=0;t<=o;++t){const n=t*r,h=a+2*Pt(t,o)*Math.PI/o;s[n]=e[0]+i*Math.cos(h),s[n+1]=e[1]+i*Math.sin(h)}t.changed()}(l,r,t.getRadius(),i),l}class ji extends li{constructor(t,e){super(),e&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendPoint(t){h(this.flatCoordinates,t.getFlatCoordinates()),this.changed()}clone(){const t=new ji(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){if(n<V(this.getExtent(),t,e))return n;const s=this.flatCoordinates,r=this.stride;for(let o=0,a=s.length;o<a;o+=r){const a=bt(t,e,s[o],s[o+1]);if(a<n){n=a;for(let t=0;t<r;++t)i[t]=s[o+t];i.length=r}}return n}getCoordinates(){return wi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){const e=this.flatCoordinates.length/this.stride;return t<0||e<=t?null:new pi(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,e=this.layout,i=this.stride,n=[];for(let s=0,r=t.length;s<r;s+=i){const r=new pi(t.slice(s,s+i),e);n.push(r)}return n}getType(){return"MultiPoint"}intersectsExtent(t){const e=this.flatCoordinates,i=this.stride;for(let n=0,s=e.length;n<s;n+=i)if(Z(t,e[n],e[n+1]))return!0;return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ui(this.flatCoordinates,0,t,this.stride),this.changed()}}const zi=ji;class Bi extends li{constructor(t,e,i){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,e);else if(void 0!==e&&i)this.setFlatCoordinates(e,t),this.ends_=i;else{const e=t,i=[],n=[];for(let t=0,s=e.length;t<s;++t)h(i,e[t].getFlatCoordinates()),n.push(i.length);const s=0===e.length?this.getLayout():e[0].getLayout();this.setFlatCoordinates(s,i),this.ends_=n}}appendLineString(t){h(this.flatCoordinates,t.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new Bi(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<V(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(yi(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),xi(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,n))}getCoordinateAtM(t,e,i){return"XYM"!=this.layout&&"XYZM"!=this.layout||0===this.flatCoordinates.length?null:(e=void 0!==e&&e,i=void 0!==i&&i,function(t,e,i,n,s,r,o){if(o)return $e(t,e,i[i.length-1],n,s,r);let a;if(s<t[n-1])return r?(a=t.slice(0,n),a[n-1]=s,a):null;if(t[t.length-1]<s)return r?(a=t.slice(t.length-n),a[n-1]=s,a):null;for(let r=0,o=i.length;r<o;++r){const o=i[r];if(e!=o){if(s<t[e+n-1])return null;if(s<=t[o-1])return $e(t,e,o,n,s,!1);e=o}}return null}(this.flatCoordinates,0,this.ends_,this.stride,t,e,i))}getCoordinates(){return Si(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new Ri(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,e=this.ends_,i=this.layout,n=[];let s=0;for(let r=0,o=e.length;r<o;++r){const o=e[r],a=new Ri(t.slice(s,o),i);n.push(a),s=o}return n}getFlatMidpoints(){const t=[],e=this.flatCoordinates;let i=0;const n=this.ends_,s=this.stride;for(let r=0,o=n.length;r<o;++r){const o=n[r];h(t,Je(e,i,o,s,.5)),i=o}return t}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=kt(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,i),new Bi(e,"XY",i)}getType(){return"MultiLineString"}intersectsExtent(t){return function(t,e,i,n,s){for(let r=0,o=i.length;r<o;++r){if(bi(t,e,i[r],n,s))return!0;e=i[r]}return!1}(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=di(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()}}const Wi=Bi;class qi extends li{constructor(t,e,i){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!i&&!Array.isArray(t[0])){const n=t,s=[],r=[];for(let t=0,e=n.length;t<e;++t){const e=n[t],i=s.length,o=e.getEnds();for(let t=0,e=o.length;t<e;++t)o[t]+=i;h(s,e.getFlatCoordinates()),r.push(o)}e=0===n.length?this.getLayout():n[0].getLayout(),t=s,i=r}void 0!==e&&i?(this.setFlatCoordinates(e,t),this.endss_=i):this.setCoordinates(t,e)}appendPolygon(t){let e;if(this.flatCoordinates){const i=this.flatCoordinates.length;h(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(let t=0,n=e.length;t<n;++t)e[t]+=i}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()}clone(){const t=this.endss_.length,e=new Array(t);for(let i=0;i<t;++i)e[i]=this.endss_[i].slice();const i=new qi(this.flatCoordinates.slice(),this.layout,e);return i.applyProperties(this),i}closestPointXY(t,e,i,n){return n<V(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,i,n,s){for(let r=0,o=i.length;r<o;++r){const o=i[r];s=yi(t,e,o,n,s),e=o[o.length-1]}return s}(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,i,n,s,r,o,a,h,l,c){c=c||[NaN,NaN];for(let r=0,u=i.length;r<u;++r){const u=i[r];l=xi(t,e,u,n,s,true,o,a,h,l,c),e=u[u.length-1]}return l}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,0,t,e,i,n))}containsXY(t,e){return function(t,e,i,n,s,r){if(0===i.length)return!1;for(let o=0,a=i.length;o<a;++o){const a=i[o];if(zt(t,e,a,n,s,r))return!0;e=a[a.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}getArea(){return function(t,e,i,n){let s=0;for(let r=0,o=i.length;r<o;++r){const o=i[r];s+=Fi(t,e,o,n),e=o[o.length-1]}return s}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),He(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,Ci(e,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=Qe(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=Wt(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new zi(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;Ye(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=He(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=function(t,e,i,n,s,r,o,a){for(let h=0,l=i.length;h<l;++h){const l=i[h],c=[];o=Nt(t,e,l,n,s,r,o,c),a.push(c),e=l[l.length-1]}return o}(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,i),new qi(e,"XY",i)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let e;if(0===t)e=0;else{const i=this.endss_[t-1];e=i[i.length-1]}const i=this.endss_[t].slice(),n=i[i.length-1];if(0!==e)for(let t=0,n=i.length;t<n;++t)i[t]-=e;return new Di(this.flatCoordinates.slice(e,n),this.layout,i)}getPolygons(){const t=this.layout,e=this.flatCoordinates,i=this.endss_,n=[];let s=0;for(let r=0,o=i.length;r<o;++r){const o=i[r].slice(),a=o[o.length-1];if(0!==s)for(let t=0,e=o.length;t<e;++t)o[t]-=s;const h=new Di(e.slice(s,a),t,o);n.push(h),s=a}return n}getType(){return"MultiPolygon"}intersectsExtent(t){return function(t,e,i,n,s){for(let r=0,o=i.length;r<o;++r){const o=i[r];if(Pi(t,e,o,n,s))return!0;e=o[o.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const i=gi(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===i.length)this.flatCoordinates.length=0;else{const t=i[i.length-1];this.flatCoordinates.length=0===t.length?0:t[t.length-1]}this.changed()}}const Xi=qi;class Ui extends oi{constructor(t){super(),this.geometries_=t,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(P),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const t=this.geometries_;for(let e=0,i=t.length;e<i;++e)this.changeEventsKeys_.push(b(t[e],y,this.changed,this))}clone(){const t=new Ui(Vi(this.geometries_));return t.applyProperties(this),t}closestPointXY(t,e,i,n){if(n<V(this.getExtent(),t,e))return n;const s=this.geometries_;for(let r=0,o=s.length;r<o;++r)n=s[r].closestPointXY(t,e,i,n);return n}containsXY(t,e){const i=this.geometries_;for(let n=0,s=i.length;n<s;++n)if(i[n].containsXY(t,e))return!0;return!1}computeExtent(t){Q(t);const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)nt(t,e[i].getExtent());return t}getGeometries(){return Vi(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let t=[];const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)e[i].getType()===this.getType()?t=t.concat(e[i].getGeometriesArrayRecursive()):t.push(e[i]);return t}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=[],i=this.geometries_;let n=!1;for(let s=0,r=i.length;s<r;++s){const r=i[s],o=r.getSimplifiedGeometry(t);e.push(o),o!==r&&(n=!0)}return n?new Ui(e):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getType(){return"GeometryCollection"}intersectsExtent(t){const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)if(e[i].intersectsExtent(t))return!0;return!1}isEmpty(){return 0===this.geometries_.length}rotate(t,e){const i=this.geometries_;for(let n=0,s=i.length;n<s;++n)i[n].rotate(t,e);this.changed()}scale(t,e,i){i||(i=ut(this.getExtent()));const n=this.geometries_;for(let s=0,r=n.length;s<r;++s)n[s].scale(t,e,i);this.changed()}setGeometries(t){this.setGeometriesArray(Vi(t))}setGeometriesArray(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}applyTransform(t){const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)e[i].applyTransform(t);this.changed()}translate(t,e){const i=this.geometries_;for(let n=0,s=i.length;n<s;++n)i[n].translate(t,e);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function Vi(t){return t.map((t=>t.clone()))}const Ki=Ui,Yi=class{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=N,this.supportedMediaTypes=null}getReadOptions(t,e){if(e){let i=e.dataProjection?Se(e.dataProjection):this.readProjection(t);e.extent&&i&&"tile-pixels"===i.getUnits()&&(i=Se(i),i.setWorldExtent(e.extent)),e={dataProjection:i,featureProjection:e.featureProjection}}return this.adaptOptions(e)}adaptOptions(t){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},t)}getType(){return R()}readFeature(t,e){return R()}readFeatures(t,e){return R()}readGeometry(t,e){return R()}readProjection(t){return R()}writeFeature(t,e){return R()}writeFeatures(t,e){return R()}writeGeometry(t,e){return R()}};function Zi(t,e,i){const n=i?Se(i.featureProjection):null,s=i?Se(i.dataProjection):null;let r=t;if(n&&s&&!Te(n,s)){e&&(r=t.clone());const i=e?n:s,o=e?s:n;"tile-pixels"===i.getUnits()?r.transform(i,o):r.applyTransform(Ae(i,o))}if(e&&i&&void 0!==i.decimals){const e=Math.pow(10,i.decimals),n=function(t){for(let i=0,n=t.length;i<n;++i)t[i]=Math.round(t[i]*e)/e;return t};r===t&&(r=t.clone()),r.applyTransform(n)}return r}const Hi={Point:pi,LineString:Ri,Polygon:Di,MultiPoint:zi,MultiLineString:Wi,MultiPolygon:Xi};function Ji(t,e){const i=t.geometry;if(!i)return[];if(Array.isArray(i))return i.map((e=>Ji({...t,geometry:e}))).flat();const n="MultiPolygon"===i.type?"Polygon":i.type;if("GeometryCollection"===n||"Circle"===n)throw new Error("Unsupported geometry type: "+n);const s=i.layout.length;return Zi(new si(n,"Polygon"===n?function(t,e,i){return Array.isArray(e[0])?(Ye(t,0,e,i)||He(t=t.slice(),0,e,i),t):(Ke(t,0,e,i)||Ze(t=t.slice(),0,e,i),t)}(i.flatCoordinates,i.ends,s):i.flatCoordinates,i.ends?.flat(),s,t.properties||{},t.id).enableSimplifyTransformed(),!1,e)}function $i(t,e){if(!t)return null;if(Array.isArray(t)){const i=t.map((t=>$i(t,e)));return new Ki(i)}return Zi(new(0,Hi[t.type])(t.flatCoordinates,t.layout,t.ends),!1,e)}function Qi(t){if("string"==typeof t){return JSON.parse(t)||null}return null!==t?t:null}const tn=class extends Yi{constructor(){super()}getType(){return"json"}readFeature(t,e){return this.readFeatureFromObject(Qi(t),this.getReadOptions(t,e))}readFeatures(t,e){return this.readFeaturesFromObject(Qi(t),this.getReadOptions(t,e))}readFeatureFromObject(t,e){return R()}readFeaturesFromObject(t,e){return R()}readGeometry(t,e){return this.readGeometryFromObject(Qi(t),this.getReadOptions(t,e))}readGeometryFromObject(t,e){return R()}readProjection(t){return this.readProjectionFromObject(Qi(t))}readProjectionFromObject(t){return R()}writeFeature(t,e){return JSON.stringify(this.writeFeatureObject(t,e))}writeFeatureObject(t,e){return R()}writeFeatures(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))}writeFeaturesObject(t,e){return R()}writeGeometry(t,e){return JSON.stringify(this.writeGeometryObject(t,e))}writeGeometryObject(t,e){return R()}};function en(t,e){if(!t)return null;let i;switch(t.type){case"Point":i=function(t){const e=t.coordinates;return{type:"Point",flatCoordinates:e,layout:ai(e.length)}}(t);break;case"LineString":i=function(t){const e=t.coordinates,i=e.flat();return{type:"LineString",flatCoordinates:i,ends:[i.length],layout:ai(e[0]?.length||2)}}(t);break;case"Polygon":i=function(t){const e=t.coordinates,i=[],n=e[0]?.[0]?.length;return{type:"Polygon",flatCoordinates:i,ends:di(i,0,e,n),layout:ai(n)}}(t);break;case"MultiPoint":i=function(t){const e=t.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:ai(e[0]?.length||2)}}(t);break;case"MultiLineString":i=function(t){const e=t.coordinates,i=e[0]?.[0]?.length||2,n=[];return{type:"MultiLineString",flatCoordinates:n,ends:di(n,0,e,i),layout:ai(i)}}(t);break;case"MultiPolygon":i=function(t){const e=t.coordinates,i=[],n=e[0]?.[0]?.[0].length||2;return{type:"MultiPolygon",flatCoordinates:i,ends:gi(i,0,e,n),layout:ai(n)}}(t);break;case"GeometryCollection":i=function(t){const e=t.geometries.map((function(t){return en(t)}));return e}(t);break;default:throw new Error("Unsupported GeoJSON type: "+t.type)}return i}function nn(t,e){const i=(t=Zi(t,!0,e)).getType();let n;switch(i){case"Point":n=function(t){return{type:"Point",coordinates:t.getCoordinates()}}(t);break;case"LineString":n=function(t){return{type:"LineString",coordinates:t.getCoordinates()}}(t);break;case"Polygon":n=function(t,e){let i;return e&&(i=e.rightHanded),{type:"Polygon",coordinates:t.getCoordinates(i)}}(t,e);break;case"MultiPoint":n=function(t){return{type:"MultiPoint",coordinates:t.getCoordinates()}}(t);break;case"MultiLineString":n=function(t){return{type:"MultiLineString",coordinates:t.getCoordinates()}}(t);break;case"MultiPolygon":n=function(t,e){let i;return e&&(i=e.rightHanded),{type:"MultiPolygon",coordinates:t.getCoordinates(i)}}(t,e);break;case"GeometryCollection":n=function(t,e){delete(e=Object.assign({},e)).featureProjection;return{type:"GeometryCollection",geometries:t.getGeometriesArray().map((function(t){return nn(t,e)}))}}(t,e);break;case"Circle":n={type:"GeometryCollection",geometries:[]};break;default:throw new Error("Unsupported geometry type: "+i)}return n}const sn=class extends tn{constructor(t){t=t||{},super(),this.dataProjection=Se(t.dataProjection?t.dataProjection:"EPSG:4326"),t.featureProjection&&(this.defaultFeatureProjection=Se(t.featureProjection)),t.featureClass&&(this.featureClass=t.featureClass),this.geometryName_=t.geometryName,this.extractGeometryName_=t.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(t,e){let i=null;i="Feature"===t.type?t:{type:"Feature",geometry:t,properties:null};const n=en(i.geometry);if(this.featureClass===si)return Ji({geometry:n,id:i.id,properties:i.properties},e);const s=new N;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&i.geometry_name&&s.setGeometryName(i.geometry_name),s.setGeometry($i(n,e)),"id"in i&&s.setId(i.id),i.properties&&s.setProperties(i.properties,!0),s}readFeaturesFromObject(t,e){let i=null;if("FeatureCollection"===t.type){i=[];const n=t.features;for(let t=0,s=n.length;t<s;++t){const s=this.readFeatureFromObject(n[t],e);s&&i.push(s)}}else i=[this.readFeatureFromObject(t,e)];return i.flat()}readGeometryFromObject(t,e){return function(t,e){return $i(en(t),e)}(t,e)}readProjectionFromObject(t){const e=t.crs;let i;if(e)if("name"==e.type)i=Se(e.properties.name);else{if("EPSG"!==e.type)throw new Error("Unknown SRS type");i=Se("EPSG:"+e.properties.code)}else i=this.dataProjection;return i}writeFeatureObject(t,e){e=this.adaptOptions(e);const i={type:"Feature",geometry:null,properties:null},n=t.getId();if(void 0!==n&&(i.id=n),!t.hasProperties())return i;const s=t.getProperties(),r=t.getGeometry();return r&&(i.geometry=nn(r,e),delete s[t.getGeometryName()]),_(s)||(i.properties=s),i}writeFeaturesObject(t,e){e=this.adaptOptions(e);const i=[];for(let n=0,s=t.length;n<s;++n)i.push(this.writeFeatureObject(t[n],e));return{type:"FeatureCollection",features:i}}writeGeometryObject(t,e){return nn(t,this.adaptOptions(e))}},rn="add",on="remove",an="length";class hn extends t{constructor(t,e,i){super(t),this.element=e,this.index=i}}const ln=class extends k{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t||[],this.unique_)for(let t=0,e=this.array_.length;t<e;++t)this.assertUnique_(this.array_[t],t);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,i=t.length;e<i;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let i=0,n=e.length;i<n;++i)t(e[i],i,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(an)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new hn(rn,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let i=0,n=e.length;i<n;++i)if(e[i]===t)return this.removeAt(i)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new hn(on,e,t)),e}setAt(t,e){if(t>=this.getLength())return void this.insertAt(t,e);if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const i=this.array_[t];this.array_[t]=e,this.dispatchEvent(new hn(on,i,t)),this.dispatchEvent(new hn(rn,e,t))}updateLength_(){this.set(an,this.array_.length)}assertUnique_(t,e){for(let i=0,n=this.array_.length;i<n;++i)if(this.array_[i]===t&&i!==e)throw new Error("Duplicate item added to a unique collection")}},cn="opacity",un="visible",dn="extent",gn="zIndex",fn="maxResolution",pn="minResolution",_n="maxZoom",mn="minZoom",yn="source",vn=class extends k{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);"object"==typeof t.properties&&(delete e.properties,Object.assign(e,t.properties)),e[cn]=void 0!==t.opacity?t.opacity:1,O("number"==typeof e[cn],"Layer opacity must be a number"),e[un]=void 0===t.visible||t.visible,e[gn]=t.zIndex,e[fn]=void 0!==t.maxResolution?t.maxResolution:1/0,e[pn]=void 0!==t.minResolution?t.minResolution:0,e[mn]=void 0!==t.minZoom?t.minZoom:-1/0,e[_n]=void 0!==t.maxZoom?t.maxZoom:1/0,this.className_=void 0!==e.className?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:void 0===t||t},i=this.getZIndex();return e.opacity=St(Math.round(100*this.getOpacity())/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==i||e.managed?i:1/0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return R()}getLayerStatesArray(t){return R()}getExtent(){return this.get(dn)}getMaxResolution(){return this.get(fn)}getMinResolution(){return this.get(pn)}getMinZoom(){return this.get(mn)}getMaxZoom(){return this.get(_n)}getOpacity(){return this.get(cn)}getSourceState(){return R()}getVisible(){return this.get(un)}getZIndex(){return this.get(gn)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(dn,t)}setMaxResolution(t){this.set(fn,t)}setMinResolution(t){this.set(pn,t)}setMaxZoom(t){this.set(_n,t)}setMinZoom(t){this.set(mn,t)}setOpacity(t){O("number"==typeof t,"Layer opacity must be a number"),this.set(cn,t)}setVisible(t){this.set(un,t)}setZIndex(t){this.set(gn,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}},xn="prerender",Mn="postrender",wn="precompose",Sn="rendercomplete",Cn={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},bn=42,En=256;function Pn(t,e,i){return function(n,s,r,o,a){if(!n)return;if(!s&&!e)return n;const h=e?0:r[0]*s,l=e?0:r[1]*s,c=a?a[0]:0,u=a?a[1]:0;let d=t[0]+h/2+c,g=t[2]-h/2+c,f=t[1]+l/2+u,p=t[3]-l/2+u;d>g&&(d=(g+d)/2,g=d),f>p&&(f=(p+f)/2,p=f);let _=St(n[0],d,g),m=St(n[1],f,p);if(o&&i&&s){const t=30*s;_+=-t*Math.log(1+Math.max(0,d-n[0])/t)+t*Math.log(1+Math.max(0,n[0]-g)/t),m+=-t*Math.log(1+Math.max(0,f-n[1])/t)+t*Math.log(1+Math.max(0,n[1]-p)/t)}return[_,m]}}function In(t){return t}function Tn(t,e,i,n){const s=yt(e)/i[0],r=ft(e)/i[1];return n?Math.min(t,Math.max(s,r)):Math.min(t,Math.min(s,r))}function Rn(t,e,i){let n=Math.min(t,e);return n*=Math.log(1+50*Math.max(0,t/e-1))/50+1,i&&(n=Math.max(n,i),n/=Math.log(1+50*Math.max(0,i/t-1))/50+1),St(n,i/2,2*e)}function An(t,e,i,n,s){return i=void 0===i||i,function(r,o,a,h){if(void 0!==r){const o=n?Tn(t,n,a,s):t;return i&&h?Rn(r,o,e):St(r,e,o)}}}function Fn(t){if(void 0!==t)return 0}function Ln(t){if(void 0!==t)return t}function kn(t){return Math.pow(t,3)}function On(t){return 1-kn(1-t)}function Dn(t){return 3*t*t-2*t*t*t}function Nn(t){return t}function Gn(t,e){setTimeout((function(){t(e)}),0)}function jn(t){return!(t.sourceCenter&&t.targetCenter&&!ae(t.sourceCenter,t.targetCenter))&&t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation}function zn(t,e,i,n,s){const r=Math.cos(-s);let o=Math.sin(-s),a=t[0]*r-t[1]*o,h=t[1]*r+t[0]*o;return a+=(e[0]/2-i[0])*n,h+=(i[1]-e[1]/2)*n,o=-o,[a*r-h*o,h*r+a*o]}const Bn=class extends k{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=Ee(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&ve(),t.center&&(t.center=Ne(t.center,this.projection_)),t.extent&&(t.extent=je(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const t in Cn)delete e[t];this.setProperties(e,!0);const i=function(t){let e,i,n;let s=void 0!==t.minZoom?t.minZoom:0,r=void 0!==t.maxZoom?t.maxZoom:28;const a=void 0!==t.zoomFactor?t.zoomFactor:2,h=void 0!==t.multiWorld&&t.multiWorld,l=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,c=void 0!==t.showFullExtent&&t.showFullExtent,u=Ee(t.projection,"EPSG:3857"),d=u.getExtent();let g=t.constrainOnlyCenter,f=t.extent;if(h||f||!u.isGlobal()||(g=!1,f=d),void 0!==t.resolutions){const a=t.resolutions;i=a[s],n=void 0!==a[r]?a[r]:a[a.length-1],e=t.constrainResolution?function(t,e,i,n){return e=void 0===e||e,function(s,r,a,h){if(void 0!==s){const l=t[0],c=t[t.length-1],u=i?Tn(l,i,a,n):l;if(h)return e?Rn(s,u,c):St(s,c,u);const d=Math.min(u,s),g=Math.floor(o(t,d,r));return t[g]>u&&g<t.length-1?t[g+1]:t[g]}}}(a,l,!g&&f,c):An(i,n,l,!g&&f,c)}else{const o=(d?Math.max(yt(d),ft(d)):360*qt.degrees/u.getMetersPerUnit())/En/Math.pow(2,0),h=o/Math.pow(2,28);i=t.maxResolution,void 0!==i?s=0:i=o/Math.pow(a,s),n=t.minResolution,void 0===n&&(n=void 0!==t.maxZoom?void 0!==t.maxResolution?i/Math.pow(a,r):o/Math.pow(a,r):h),r=s+Math.floor(Math.log(i/n)/Math.log(a)),n=i/Math.pow(a,r-s),e=t.constrainResolution?function(t,e,i,n,s,r){return n=void 0===n||n,i=void 0!==i?i:0,function(o,a,h,l){if(void 0!==o){const c=s?Tn(e,s,h,r):e;if(l)return n?Rn(o,c,i):St(o,i,c);const u=1e-9,d=Math.ceil(Math.log(e/c)/Math.log(t)-u),g=-a*(.5-u)+.5,f=Math.min(c,o),p=Math.floor(Math.log(e/f)/Math.log(t)+g),_=Math.max(d,p);return St(e/Math.pow(t,_),i,c)}}}(a,i,n,l,!g&&f,c):An(i,n,l,!g&&f,c)}return{constraint:e,maxResolution:i,minResolution:n,minZoom:s,zoomFactor:a}}(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=i.minZoom;const n=function(t){if(void 0!==t.extent){const e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return Pn(t.extent,t.constrainOnlyCenter,e)}const e=Ee(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,Pn(t,!1,!1)}return In}(t),s=i.constraint,r=function(t){if(void 0===t.enableRotation||t.enableRotation){const e=t.constrainRotation;return void 0===e||!0===e?function(){const t=Et(5);return function(e,i){return i||void 0===e?e:Math.abs(e)<=t?0:e}}():!1===e?Ln:"number"==typeof e?function(t){const e=2*Math.PI/t;return function(t,i){return i?t:void 0!==t?t=Math.floor(t/e+.5)*e:void 0}}(e):Ln}return Fn}(t);this.constraints_={center:n,resolution:s,rotation:r},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const i=this.getCenterInternal();if(i){const n=t||[0,0,0,0];e=e||[0,0,0,0];const s=this.getResolution(),r=s/2*(n[3]-e[3]+e[1]-n[1]),o=s/2*(n[0]-e[0]+e[2]-n[2]);this.setCenterInternal([i[0]+r,i[1]-o])}}getUpdatedOptions_(t){const e=this.getProperties();return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let t=0;t<e.length;++t){let i=arguments[t];i.center&&(i=Object.assign({},i),i.center=Ne(i.center,this.getProjection())),i.anchor&&(i=Object.assign({},i),i.anchor=Ne(i.anchor,this.getProjection())),e[t]=i}this.animateInternal.apply(this,e)}animateInternal(t){let e,i=arguments.length;i>1&&"function"==typeof arguments[i-1]&&(e=arguments[i-1],--i);let n=0;for(;n<i&&!this.isDef();++n){const t=arguments[n];t.center&&this.setCenterInternal(t.center),void 0!==t.zoom?this.setZoom(t.zoom):t.resolution&&this.setResolution(t.resolution),void 0!==t.rotation&&this.setRotation(t.rotation)}if(n===i)return void(e&&Gn(e,!0));let s=Date.now(),r=this.targetCenter_.slice(),o=this.targetResolution_,a=this.targetRotation_;const h=[];for(;n<i;++n){const t=arguments[n],i={start:s,complete:!1,anchor:t.anchor,duration:void 0!==t.duration?t.duration:1e3,easing:t.easing||Dn,callback:e};if(t.center&&(i.sourceCenter=r,i.targetCenter=t.center.slice(),r=i.targetCenter),void 0!==t.zoom?(i.sourceResolution=o,i.targetResolution=this.getResolutionForZoom(t.zoom),o=i.targetResolution):t.resolution&&(i.sourceResolution=o,i.targetResolution=t.resolution,o=i.targetResolution),void 0!==t.rotation){i.sourceRotation=a;const e=Pt(t.rotation-a+Math.PI,2*Math.PI)-Math.PI;i.targetRotation=a+e,a=i.targetRotation}jn(i)?i.complete=!0:s+=i.duration,h.push(i)}this.animations_.push(h),this.setHint(0,1),this.updateAnimations_()}getAnimating(){return this.hints_[0]>0}getInteracting(){return this.hints_[1]>0}cancelAnimations(){let t;this.setHint(0,-this.hints_[0]);for(let e=0,i=this.animations_.length;e<i;++e){const i=this.animations_[e];if(i[0].callback&&Gn(i[0].callback,!1),!t)for(let e=0,n=i.length;e<n;++e){const n=i[e];if(!n.complete){t=n.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let i=this.animations_.length-1;i>=0;--i){const n=this.animations_[i];let s=!0;for(let i=0,r=n.length;i<r;++i){const r=n[i];if(r.complete)continue;const o=t-r.start;let a=r.duration>0?o/r.duration:1;a>=1?(r.complete=!0,a=1):s=!1;const h=r.easing(a);if(r.sourceCenter){const t=r.sourceCenter[0],e=r.sourceCenter[1],i=r.targetCenter[0],n=r.targetCenter[1];this.nextCenter_=r.targetCenter;const s=t+h*(i-t),o=e+h*(n-e);this.targetCenter_=[s,o]}if(r.sourceResolution&&r.targetResolution){const t=1===h?r.targetResolution:r.sourceResolution+h*(r.targetResolution-r.sourceResolution);if(r.anchor){const e=this.getViewportSize_(this.getRotation()),i=this.constraints_.resolution(t,0,e,!0);this.targetCenter_=this.calculateCenterZoom(i,r.anchor)}this.nextResolution_=r.targetResolution,this.targetResolution_=t,this.applyTargetState_(!0)}if(void 0!==r.sourceRotation&&void 0!==r.targetRotation){const t=1===h?Pt(r.targetRotation+Math.PI,2*Math.PI)-Math.PI:r.sourceRotation+h*(r.targetRotation-r.sourceRotation);if(r.anchor){const e=this.constraints_.rotation(t,!0);this.targetCenter_=this.calculateCenterRotate(e,r.anchor)}this.nextRotation_=r.targetRotation,this.targetRotation_=t}if(this.applyTargetState_(!0),e=!0,!r.complete)break}if(s){this.animations_[i]=null,this.setHint(0,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const t=n[0].callback;t&&Gn(t,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let i;const n=this.getCenterInternal();var s,r;return void 0!==n&&(i=[n[0]-e[0],n[1]-e[1]],he(i,t-this.getRotation()),r=e,(s=i)[0]+=+r[0],s[1]+=+r[1]),i}calculateCenterZoom(t,e){let i;const n=this.getCenterInternal(),s=this.getResolution();return void 0!==n&&void 0!==s&&(i=[e[0]-t*(e[0]-n[0])/s,e[1]-t*(e[1]-n[1])/s]),i}getViewportSize_(t){const e=this.viewportSize_;if(t){const i=e[0],n=e[1];return[Math.abs(i*Math.cos(t))+Math.abs(n*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(n*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t?De(t,this.getProjection()):t}getCenterInternal(){return this.get(Cn.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){return Ge(this.calculateExtentInternal(t),this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();O(e,"The view center is not defined");const i=this.getResolution();O(void 0!==i,"The view resolution is not defined");const n=this.getRotation();return O(void 0!==n,"The view rotation is not defined"),gt(e,i,n,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(Cn.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(je(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const i=yt(t)/e[0],n=ft(t)/e[1];return Math.max(i,n)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,n=Math.log(e/i)/Math.log(t);return function(i){return e/Math.pow(t,i*n)}}getRotation(){return this.get(Cn.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,s=Math.log(i/n)/e;return function(t){return Math.log(i/t)/e/s}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const i=this.padding_;return i&&(e=[e[0]-i[1]-i[3],e[1]-i[0]-i[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),i=this.getRotation();let n=this.getCenterInternal();const s=this.padding_;if(s){const t=this.getViewportSizeMinusPadding_();n=zn(n,this.getViewportSize_(),[t[0]/2+s[3],t[1]/2+s[0]],e,i)}return{center:n.slice(0),projection:void 0!==t?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e,i,n=this.minZoom_||0;if(this.resolutions_){const s=o(this.resolutions_,t,1);n=s,e=this.resolutions_[s],i=s==this.resolutions_.length-1?2:e/this.resolutions_[s+1]}else e=this.maxResolution_,i=this.zoomFactor_;return n+Math.log(e/t)/Math.log(i)}getResolutionForZoom(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;const e=St(Math.floor(t),0,this.resolutions_.length-2),i=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(i,St(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let i;if(O(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,"Invalid extent or geometry provided as `geometry`"),Array.isArray(t))O(!xt(t),"Cannot fit empty extent provided as `geometry`"),i=Ni(je(t,this.getProjection()));else if("Circle"===t.getType()){const e=je(t.getExtent(),this.getProjection());i=Ni(e),i.rotate(this.getRotation(),ut(e))}else{const e=Oe();i=e?t.clone().transform(e,this.getProjection()):t}this.fitInternal(i,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),i=Math.cos(e),n=Math.sin(-e),s=t.getFlatCoordinates(),r=t.getStride();let o=1/0,a=1/0,h=-1/0,l=-1/0;for(let t=0,e=s.length;t<e;t+=r){const e=s[t]*i-s[t+1]*n,r=s[t]*n+s[t+1]*i;o=Math.min(o,e),a=Math.min(a,r),h=Math.max(h,e),l=Math.max(l,r)}return[o,a,h,l]}fitInternal(t,e){let i=(e=e||{}).size;i||(i=this.getViewportSizeMinusPadding_());const n=void 0!==e.padding?e.padding:[0,0,0,0],s=void 0!==e.nearest&&e.nearest;let r;r=void 0!==e.minResolution?e.minResolution:void 0!==e.maxZoom?this.getResolutionForZoom(e.maxZoom):0;const o=this.rotatedExtentForGeometry(t);let a=this.getResolutionForExtentInternal(o,[i[0]-n[1]-n[3],i[1]-n[0]-n[2]]);a=isNaN(a)?r:Math.max(a,r),a=this.getConstrainedResolution(a,s?0:1);const h=this.getRotation(),l=Math.sin(h),c=Math.cos(h),u=ut(o);u[0]+=(n[1]-n[3])/2*a,u[1]+=(n[0]-n[2])/2*a;const g=u[0]*c-u[1]*l,f=u[1]*c+u[0]*l,p=this.getConstrainedCenter([g,f],a),_=e.callback?e.callback:d;void 0!==e.duration?this.animateInternal({resolution:a,center:p,duration:e.duration,easing:e.easing},_):(this.targetResolution_=a,this.targetCenter_=p,this.applyTargetState_(!1,!0),Gn(_,!0))}centerOn(t,e,i){this.centerOnInternal(Ne(t,this.getProjection()),e,i)}centerOnInternal(t,e,i){this.setCenterInternal(zn(t,e,i,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,i,n){let s;const r=this.padding_;if(r&&t){const o=this.getViewportSizeMinusPadding_(-i),a=zn(t,n,[o[0]/2+r[3],o[1]/2+r[0]],e,i);s=[t[0]-a[0],t[1]-a[1]]}return s}isDef(){return!!this.getCenterInternal()&&void 0!==this.getResolution()}adjustCenter(t){const e=De(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&Ne(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const i=this.getAnimating()||this.getInteracting(),n=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*t,0,n,i);e&&(this.targetCenter_=this.calculateCenterZoom(s,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=Ne(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const i=this.getAnimating()||this.getInteracting(),n=this.constraints_.rotation(this.targetRotation_+t,i);e&&(this.targetCenter_=this.calculateCenterRotate(n,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t?Ne(t,this.getProjection()):t)}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const i=this.getAnimating()||this.getInteracting()||e,n=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(n),r=this.constraints_.resolution(this.targetResolution_,0,s,i),o=this.constraints_.center(this.targetCenter_,r,s,i,this.calculateCenterShift(this.targetCenter_,r,n,s));this.get(Cn.ROTATION)!==n&&this.set(Cn.ROTATION,n),this.get(Cn.RESOLUTION)!==r&&(this.set(Cn.RESOLUTION,r),this.set("zoom",this.getZoom(),!0)),o&&this.get(Cn.CENTER)&&ae(this.get(Cn.CENTER),o)||this.set(Cn.CENTER,o),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,i){t=void 0!==t?t:200;const n=e||0,s=this.constraints_.rotation(this.targetRotation_),r=this.getViewportSize_(s),o=this.constraints_.resolution(this.targetResolution_,n,r),a=this.constraints_.center(this.targetCenter_,o,r,!1,this.calculateCenterShift(this.targetCenter_,o,s,r));if(0===t&&!this.cancelAnchor_)return this.targetResolution_=o,this.targetRotation_=s,this.targetCenter_=a,void this.applyTargetState_();i=i||(0===t?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,this.getResolution()===o&&this.getRotation()===s&&this.getCenterInternal()&&ae(this.getCenterInternal(),a)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:a,resolution:o,duration:t,easing:On,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(1,1)}endInteraction(t,e,i){i=i&&Ne(i,this.getProjection()),this.endInteractionInternal(t,e,i)}endInteractionInternal(t,e,i){this.getInteracting()&&(this.setHint(1,-1),this.resolveConstraints(t,e,i))}getConstrainedCenter(t,e){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),i)}getConstrainedZoom(t,e){const i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,e))}getConstrainedResolution(t,e){e=e||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,i)}};function Wn(t,e){if(!t.visible)return!1;const i=e.resolution;if(i<t.minResolution||i>=t.maxResolution)return!1;const n=e.zoom;return n>t.minZoom&&n<=t.maxZoom}const qn=class extends vn{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(yn,this.handleSourcePropertyChange_);const i=t.source?t.source:null;this.setSource(i)}getLayersArray(t){return(t=t||[]).push(this),t}getLayerStatesArray(t){return(t=t||[]).push(this.getLayerState()),t}getSource(){return this.get(yn)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),this.sourceReady_||"ready"!==this.getSource().getState()||(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(P(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=b(t,y,this.handleSourceChange_,this),"ready"===t.getState()&&(this.sourceReady_=!0,setTimeout((()=>{this.dispatchEvent("sourceready")}),0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return this.renderer_&&this.rendered?this.renderer_.getData(t):null}isVisible(t){let e;const i=this.getMapInternal();let n;!t&&i&&(t=i.getView()),e=t instanceof Bn?{viewState:t.getState(),extent:t.calculateExtent()}:t,!e.layerStatesArray&&i&&(e.layerStatesArray=i.getLayerGroup().getLayerStatesArray()),n=e.layerStatesArray?e.layerStatesArray.find((t=>t.layer===this)):this.getLayerState();const s=this.getExtent();return Wn(n,e.viewState)&&(!s||vt(s,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];const e=this.getSource()?.getAttributions();if(!e)return[];let i=e(t instanceof Bn?t.getViewStateAndExtent():t);return Array.isArray(i)||(i=[i]),i}render(t,e){const i=this.getRenderer();return i.prepareFrame(t)?(this.rendered=!0,i.renderFrame(t,e)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(t,e){}renderDeferred(t){const e=this.getRenderer();e&&e.renderDeferred(t)}setMapInternal(t){t||this.unrender(),this.set("map",t)}getMapInternal(){return this.get("map")}setMap(t){this.mapPrecomposeKey_&&(P(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(P(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=b(t,wn,(t=>{const e=t.frameState.layerStatesArray,i=this.getLayerState(!1);O(!e.some((function(t){return t.layer===i.layer})),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),e.push(i)})),this.mapRenderKey_=b(this,y,t.render,t),this.changed())}setSource(t){this.set(yn,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}};function Xn(t,e,i=0,n=t.length-1,s=Vn){for(;n>i;){if(n-i>600){const r=n-i+1,o=e-i+1,a=Math.log(r),h=.5*Math.exp(2*a/3),l=.5*Math.sqrt(a*h*(r-h)/r)*(o-r/2<0?-1:1);Xn(t,e,Math.max(i,Math.floor(e-o*h/r+l)),Math.min(n,Math.floor(e+(r-o)*h/r+l)),s)}const r=t[e];let o=i,a=n;for(Un(t,i,e),s(t[n],r)>0&&Un(t,i,n);o<a;){for(Un(t,o,a),o++,a--;s(t[o],r)<0;)o++;for(;s(t[a],r)>0;)a--}0===s(t[i],r)?Un(t,i,a):(a++,Un(t,a,n)),a<=e&&(i=a+1),e<=a&&(n=a-1)}}function Un(t,e,i){const n=t[e];t[e]=t[i],t[i]=n}function Vn(t,e){return t<e?-1:t>e?1:0}class Kn{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}all(){return this._all(this.data,[])}search(t){let e=this.data;const i=[];if(!ss(t,e))return i;const n=this.toBBox,s=[];for(;e;){for(let r=0;r<e.children.length;r++){const o=e.children[r],a=e.leaf?n(o):o;ss(t,a)&&(e.leaf?i.push(o):ns(t,a)?this._all(o,i):s.push(o))}e=s.pop()}return i}collides(t){let e=this.data;if(!ss(t,e))return!1;const i=[];for(;e;){for(let n=0;n<e.children.length;n++){const s=e.children[n],r=e.leaf?this.toBBox(s):s;if(ss(t,r)){if(e.leaf||ns(t,r))return!0;i.push(s)}}e=i.pop()}return!1}load(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(let e=0;e<t.length;e++)this.insert(t[e]);return this}let e=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){const t=this.data;this.data=e,e=t}this._insert(e,this.data.height-e.height-1,!0)}else this.data=e;return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=rs([]),this}remove(t,e){if(!t)return this;let i=this.data;const n=this.toBBox(t),s=[],r=[];let o,a,h;for(;i||s.length;){if(i||(i=s.pop(),a=s[s.length-1],o=r.pop(),h=!0),i.leaf){const n=Yn(t,i.children,e);if(-1!==n)return i.children.splice(n,1),s.push(i),this._condense(s),this}h||i.leaf||!ns(i,n)?a?(o++,i=a.children[o],h=!1):i=null:(s.push(i),r.push(o),o=0,a=i,i=i.children[0])}return this}toBBox(t){return t}compareMinX(t,e){return t.minX-e.minX}compareMinY(t,e){return t.minY-e.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,e){const i=[];for(;t;)t.leaf?e.push(...t.children):i.push(...t.children),t=i.pop();return e}_build(t,e,i,n){const s=i-e+1;let r,o=this._maxEntries;if(s<=o)return r=rs(t.slice(e,i+1)),Zn(r,this.toBBox),r;n||(n=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,n-1))),r=rs([]),r.leaf=!1,r.height=n;const a=Math.ceil(s/o),h=a*Math.ceil(Math.sqrt(o));os(t,e,i,h,this.compareMinX);for(let s=e;s<=i;s+=h){const e=Math.min(s+h-1,i);os(t,s,e,a,this.compareMinY);for(let i=s;i<=e;i+=a){const s=Math.min(i+a-1,e);r.children.push(this._build(t,i,s,n-1))}}return Zn(r,this.toBBox),r}_chooseSubtree(t,e,i,n){for(;n.push(e),!e.leaf&&n.length-1!==i;){let i,n=1/0,o=1/0;for(let a=0;a<e.children.length;a++){const h=e.children[a],l=ts(h),c=(s=t,r=h,(Math.max(r.maxX,s.maxX)-Math.min(r.minX,s.minX))*(Math.max(r.maxY,s.maxY)-Math.min(r.minY,s.minY))-l);c<o?(o=c,n=l<n?l:n,i=h):c===o&&l<n&&(n=l,i=h)}e=i||e.children[0]}var s,r;return e}_insert(t,e,i){const n=i?t:this.toBBox(t),s=[],r=this._chooseSubtree(n,this.data,e,s);for(r.children.push(t),Jn(r,n);e>=0&&s[e].children.length>this._maxEntries;)this._split(s,e),e--;this._adjustParentBBoxes(n,s,e)}_split(t,e){const i=t[e],n=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,n);const r=this._chooseSplitIndex(i,s,n),o=rs(i.children.splice(r,i.children.length-r));o.height=i.height,o.leaf=i.leaf,Zn(i,this.toBBox),Zn(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(i,o)}_splitRoot(t,e){this.data=rs([t,e]),this.data.height=t.height+1,this.data.leaf=!1,Zn(this.data,this.toBBox)}_chooseSplitIndex(t,e,i){let n,s=1/0,r=1/0;for(let o=e;o<=i-e;o++){const e=Hn(t,0,o,this.toBBox),a=Hn(t,o,i,this.toBBox),h=is(e,a),l=ts(e)+ts(a);h<s?(s=h,n=o,r=l<r?l:r):h===s&&l<r&&(r=l,n=o)}return n||i-e}_chooseSplitAxis(t,e,i){const n=t.leaf?this.compareMinX:$n,s=t.leaf?this.compareMinY:Qn;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,s)&&t.children.sort(n)}_allDistMargin(t,e,i,n){t.children.sort(n);const s=this.toBBox,r=Hn(t,0,e,s),o=Hn(t,i-e,i,s);let a=es(r)+es(o);for(let n=e;n<i-e;n++){const e=t.children[n];Jn(r,t.leaf?s(e):e),a+=es(r)}for(let n=i-e-1;n>=e;n--){const e=t.children[n];Jn(o,t.leaf?s(e):e),a+=es(o)}return a}_adjustParentBBoxes(t,e,i){for(let n=i;n>=0;n--)Jn(e[n],t)}_condense(t){for(let e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children,e.splice(e.indexOf(t[i]),1)):this.clear():Zn(t[i],this.toBBox)}}function Yn(t,e,i){if(!i)return e.indexOf(t);for(let n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function Zn(t,e){Hn(t,0,t.children.length,e,t)}function Hn(t,e,i,n,s){s||(s=rs(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let r=e;r<i;r++){const e=t.children[r];Jn(s,t.leaf?n(e):e)}return s}function Jn(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function $n(t,e){return t.minX-e.minX}function Qn(t,e){return t.minY-e.minY}function ts(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function es(t){return t.maxX-t.minX+(t.maxY-t.minY)}function is(t,e){const i=Math.max(t.minX,e.minX),n=Math.max(t.minY,e.minY),s=Math.min(t.maxX,e.maxX),r=Math.min(t.maxY,e.maxY);return Math.max(0,s-i)*Math.max(0,r-n)}function ns(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function ss(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function rs(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function os(t,e,i,n,s){const r=[e,i];for(;r.length;){if((i=r.pop())-(e=r.pop())<=n)continue;const o=e+Math.ceil((i-e)/n/2)*n;Xn(t,o,e,i,s),r.push(e,o,o,i)}}const as=0,hs=1,ls=2,cs=3,us=4;function ds(t){return t[0]>0&&t[1]>0}function gs(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}class fs{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=gs(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new fs({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return R()}getImage(t){return R()}getHitDetectionImage(){return R()}getPixelRatio(t){return 1}getImageState(){return R()}getImageSize(){return R()}getOrigin(){return R()}getSize(){return R()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=gs(t)}listenImageChange(t){R()}load(){R()}unlistenImageChange(t){R()}ready(){return Promise.resolve()}}const ps=fs,_s={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]};var ms={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"],whitepoint:{2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}}};ms.max=ms.whitepoint[2].D65,ms.rgb=function(t,e){e=e||ms.whitepoint[2].E;var i,n,s,r=t[0]/e[0],o=t[1]/e[1],a=t[2]/e[2];return n=-.96924363628087*r+1.87596750150772*o+.041555057407175*a,s=.055630079696993*r+-.20397695888897*o+1.056971514242878*a,i=(i=3.240969941904521*r+-1.537383177570093*o+-.498610760293*a)>.0031308?1.055*Math.pow(i,1/2.4)-.055:i*=12.92,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:n*=12.92,s=s>.0031308?1.055*Math.pow(s,1/2.4)-.055:s*=12.92,[255*(i=Math.min(Math.max(0,i),1)),255*(n=Math.min(Math.max(0,n),1)),255*(s=Math.min(Math.max(0,s),1))]},_s.xyz=function(t,e){var i=t[0]/255,n=t[1]/255,s=t[2]/255,r=.21263900587151*(i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92)+.71516867876775*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.072192315360733*(s=s>.04045?Math.pow((s+.055)/1.055,2.4):s/12.92),o=.019330818715591*i+.11919477979462*n+.95053215224966*s;return[(.41239079926595*i+.35758433938387*n+.18048078840183*s)*(e=e||ms.whitepoint[2].E)[0],r*e[1],o*e[2]]};const ys=ms,vs={name:"luv",min:[0,-134,-140],max:[100,224,122],channel:["lightness","u","v"],alias:["LUV","cieluv","cie1976"],xyz:function(t,e,i){var n,s,r,o,a,h,l,c,u;return r=t[0],o=t[1],a=t[2],0===r?[0,0,0]:(e=e||"D65",i=i||2,n=o/(13*r)+4*(l=ys.whitepoint[i][e][0])/(l+15*(c=ys.whitepoint[i][e][1])+3*(u=ys.whitepoint[i][e][2]))||0,s=a/(13*r)+9*c/(l+15*c+3*u)||0,[9*(h=r>8?c*Math.pow((r+16)/116,3):c*r*.0011070564598794539)*n/(4*s)||0,h,h*(12-3*n-20*s)/(4*s)||0])}};ys.luv=function(t,e,i){var n,s,r,o,a,h,l,c,u,d,g;e=e||"D65",i=i||2,d=4*(l=ys.whitepoint[i][e][0])/(l+15*(c=ys.whitepoint[i][e][1])+3*(u=ys.whitepoint[i][e][2])),g=9*c/(l+15*c+3*u),n=4*(o=t[0])/(o+15*(a=t[1])+3*(h=t[2]))||0,s=9*a/(o+15*a+3*h)||0;var f=a/c;return[r=f<=.008856451679035631?903.2962962962961*f:116*Math.pow(f,1/3)-16,13*r*(n-d),13*r*(s-g)]};var xs={name:"lchuv",channel:["lightness","chroma","hue"],alias:["LCHuv","cielchuv"],min:[0,0,0],max:[100,100,360],luv:function(t){var e,i=t[0],n=t[1];return e=t[2]/360*2*Math.PI,[i,n*Math.cos(e),n*Math.sin(e)]},xyz:function(t){return vs.xyz(xs.luv(t))}};const Ms=xs;vs.lchuv=function(t){var e=t[0],i=t[1],n=t[2],s=Math.sqrt(i*i+n*n),r=360*Math.atan2(n,i)/2/Math.PI;return r<0&&(r+=360),[e,s,r]},ys.lchuv=function(t){return vs.lchuv(ys.luv(t))};const ws={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Ss=function(t){var e,i,n=[],s=1;if("number"==typeof t)return{space:"rgb",values:[t>>>16,(65280&t)>>>8,255&t],alpha:1};if("number"==typeof t)return{space:"rgb",values:[t>>>16,(65280&t)>>>8,255&t],alpha:1};if(t=String(t).toLowerCase(),ws[t])n=ws[t].slice(),i="rgb";else if("transparent"===t)s=0,i="rgb",n=[0,0,0];else if("#"===t[0]){var r=t.slice(1),o=r.length;s=1,o<=4?(n=[parseInt(r[0]+r[0],16),parseInt(r[1]+r[1],16),parseInt(r[2]+r[2],16)],4===o&&(s=parseInt(r[3]+r[3],16)/255)):(n=[parseInt(r[0]+r[1],16),parseInt(r[2]+r[3],16),parseInt(r[4]+r[5],16)],8===o&&(s=parseInt(r[6]+r[7],16)/255)),n[0]||(n[0]=0),n[1]||(n[1]=0),n[2]||(n[2]=0),i="rgb"}else if(e=/^((?:rgba?|hs[lvb]a?|hwba?|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms|oklch|oklab|color))\s*\(([^\)]*)\)/.exec(t)){var a=e[1],h="cmyk"===(i=a.replace(/a$/,""))?4:"gray"===i?1:3;n=e[2].trim().split(/\s*[,\/]\s*|\s+/),"color"===i&&(i=n.shift()),s=(n=n.map((function(t,e){if("%"===t[t.length-1])return t=parseFloat(t)/100,3===e?t:"rgb"===i?255*t:"h"===i[0]?100*t:"l"!==i[0]||e?"lab"===i?125*t:"lch"===i?e<2?150*t:360*t:"o"!==i[0]||e?"oklab"===i?.4*t:"oklch"===i?e<2?.4*t:360*t:t:t:100*t;if("h"===i[e]||2===e&&"h"===i[i.length-1]){if(void 0!==Cs[t])return Cs[t];if(t.endsWith("deg"))return parseFloat(t);if(t.endsWith("turn"))return 360*parseFloat(t);if(t.endsWith("grad"))return 360*parseFloat(t)/400;if(t.endsWith("rad"))return 180*parseFloat(t)/Math.PI}return"none"===t?0:parseFloat(t)}))).length>h?n.pop():1}else/[0-9](?:\s|\/|,)/.test(t)&&(n=t.match(/([0-9]+)/g).map((function(t){return parseFloat(t)})),i=t.match(/([a-z])/gi)?.join("")?.toLowerCase()||"rgb");return{space:i,values:n,alpha:s}};var Cs={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};const bs={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(t){var e,i,n,s,r,o=t[0]/360,a=t[1]/100,h=t[2]/100,l=0;if(0===a)return[r=255*h,r,r];for(e=2*h-(i=h<.5?h*(1+a):h+a-h*a),s=[0,0,0];l<3;)(n=o+1/3*-(l-1))<0?n++:n>1&&n--,r=6*n<1?e+6*(i-e)*n:2*n<1?i:3*n<2?e+(i-e)*(2/3-n)*6:e,s[l++]=255*r;return s}};_s.hsl=function(t){var e,i,n=t[0]/255,s=t[1]/255,r=t[2]/255,o=Math.min(n,s,r),a=Math.max(n,s,r),h=a-o;return a===o?e=0:n===a?e=(s-r)/h:s===a?e=2+(r-n)/h:r===a&&(e=4+(n-s)/h),(e=Math.min(60*e,360))<0&&(e+=360),i=(o+a)/2,[e,100*(a===o?0:i<=.5?h/(a+o):h/(2-a-o)),100*i]};const Es=[NaN,NaN,NaN,0],Ps=1024,Is={};let Ts=0;function Rs(t){if(4===t.length)return t;const e=t.slice();return e[3]=1,e}function As(t){const e=ys.lchuv(_s.xyz(t));return e[3]=t[3],e}function Fs(t){if("none"===t)return Es;if(Is.hasOwnProperty(t))return Is[t];if(Ts>=Ps){let t=0;for(const e in Is)3&t++||(delete Is[e],--Ts)}const e=function(t){var e;Array.isArray(t)&&t.raw&&(t=String.raw(...arguments)),t instanceof Number&&(t=+t);var i=Ss(t);if(!i.space)return[];const n="h"===i.space[0]?bs.min:_s.min,s="h"===i.space[0]?bs.max:_s.max;return(e=Array(3))[0]=Math.min(Math.max(i.values[0],n[0]),s[0]),e[1]=Math.min(Math.max(i.values[1],n[1]),s[1]),e[2]=Math.min(Math.max(i.values[2],n[2]),s[2]),"h"===i.space[0]&&(e=bs.rgb(e)),e.push(Math.min(Math.max(i.alpha,0),1)),e}(t);if(4!==e.length)throw new Error('failed to parse "'+t+'" as color');for(const i of e)if(isNaN(i))throw new Error('failed to parse "'+t+'" as color');return ks(e),Is[t]=e,++Ts,e}function Ls(t){return Array.isArray(t)?t:Fs(t)}function ks(t){return t[0]=St(t[0]+.5|0,0,255),t[1]=St(t[1]+.5|0,0,255),t[2]=St(t[2]+.5|0,0,255),t[3]=St(t[3],0,1),t}function Os(t){let e=t[0];e!=(0|e)&&(e=e+.5|0);let i=t[1];i!=(0|i)&&(i=i+.5|0);let n=t[2];return n!=(0|n)&&(n=n+.5|0),"rgba("+e+","+i+","+n+","+(void 0===t[3]?1:Math.round(1e3*t[3])/1e3)+")"}const Ds="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"",Ns=Ds.includes("firefox"),Gs=(Ds.includes("safari")&&!Ds.includes("chrom")&&(Ds.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(Ds)),Ds.includes("webkit")&&!Ds.includes("edge")),js=Ds.includes("macintosh"),zs="undefined"!=typeof devicePixelRatio?devicePixelRatio:1,Bs="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,Ws="undefined"!=typeof Image&&Image.prototype.decode,qs="function"==typeof createImageBitmap,Xs=function(){let t=!1;try{const e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch(t){}return t}();function Us(t,e,i,n){let s;return s=i&&i.length?i.shift():Bs?new OffscreenCanvas(t||300,e||300):document.createElement("canvas"),t&&(s.width=t),e&&(s.height=e),s.getContext("2d",n)}let Vs;function Ks(){return Vs||(Vs=Us(1,1)),Vs}function Ys(t){const e=t.canvas;e.width=1,e.height=1,t.clearRect(0,0,1,1)}function Zs(t,e){const i=e.parentNode;i&&i.replaceChild(t,e)}function Hs(t,e){return e&&(t.src=e),t.src&&Ws?new Promise(((e,i)=>t.decode().then((()=>e(t))).catch((n=>t.complete&&t.width?e(t):i(n))))):function(t){return new Promise(((e,i)=>{function n(){r(),e(t)}function s(){r(),i(new Error("Image load error"))}function r(){t.removeEventListener("load",n),t.removeEventListener("error",s)}t.addEventListener("load",n),t.addEventListener("error",s)}))}(t)}function Js(t,e){return e&&(t.src=e),t.src&&Ws&&qs?t.decode().then((()=>createImageBitmap(t))).catch((e=>{if(t.complete&&t.width)return t;throw e})):Hs(t)}const $s=class extends m{constructor(t,e,i,n){super(),this.extent=t,this.pixelRatio_=i,this.resolution=e,this.state="function"==typeof n?as:n,this.image_=null,this.loader="function"==typeof n?n:null}changed(){this.dispatchEvent(y)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==as&&this.loader){this.state=hs,this.changed();const t=this.getResolution(),e=Array.isArray(t)?t[0]:t;f((()=>this.loader(this.getExtent(),e,this.getPixelRatio()))).then((t=>{"image"in t&&(this.image_=t.image),"extent"in t&&(this.extent=t.extent),"resolution"in t&&(this.resolution=t.resolution),"pixelRatio"in t&&(this.pixelRatio_=t.pixelRatio),(t instanceof HTMLImageElement||t instanceof ImageBitmap||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement)&&(this.image_=t),this.state=ls})).catch((t=>{this.state=cs,console.error(t)})).finally((()=>this.changed()))}}setImage(t){this.image_=t}setResolution(t){this.resolution=t}};function Qs(t,e,i){return e+":"+t+":"+(i?Ls(i):"null")}const tr=new class{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const i=this.cache_[e];3&t++||i.hasListener()||(delete this.cache_[e],delete this.patternCache_[e],--this.cacheSize_)}}}get(t,e,i){const n=Qs(t,e,i);return n in this.cache_?this.cache_[n]:null}getPattern(t,e,i){const n=Qs(t,e,i);return n in this.patternCache_?this.patternCache_[n]:null}set(t,e,i,n,s){const r=Qs(t,e,i),o=r in this.cache_;this.cache_[r]=n,s&&(n.getImageState()===as&&n.load(),n.getImageState()===hs?n.ready().then((()=>{this.patternCache_[r]=Ks().createPattern(n.getImage(1),"repeat")})):this.patternCache_[r]=Ks().createPattern(n.getImage(1),"repeat")),o||++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}};let er=null;class ir extends m{constructor(t,e,i,n,s){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=void 0===n?as:n,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=e,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(void 0===this.tainted_&&this.imageState_===ls){er||(er=Us(1,1,void 0,{willReadFrequently:!0})),er.drawImage(this.image_,0,0);try{er.getImageData(0,0,1,1),this.tainted_=!1}catch(t){er=null,this.tainted_=!0}}return!0===this.tainted_}dispatchChangeEvent_(){this.dispatchEvent(y)}handleImageError_(){this.imageState_=cs,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=ls,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],i=Us(t,e);i.fillRect(0,0,t,e),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===as){this.image_||this.initializeImage_(),this.imageState_=hs;try{void 0!==this.src_&&(this.image_.src=this.src_)}catch(t){this.handleImageError_()}this.image_ instanceof HTMLImageElement&&Hs(this.image_,this.src_).then((t=>{this.image_=t,this.handleImageLoad_()})).catch(this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||this.imageState_!==ls)return;const e=this.image_,i=document.createElement("canvas");i.width=Math.ceil(e.width*t),i.height=Math.ceil(e.height*t);const n=i.getContext("2d");var s;n.scale(t,t),n.drawImage(e,0,0),n.globalCompositeOperation="multiply",n.fillStyle="string"==typeof(s=this.color_)?s:Os(s),n.fillRect(0,0,i.width/t,i.height/t),n.globalCompositeOperation="destination-in",n.drawImage(e,0,0),this.canvas_[t]=i}ready(){return this.ready_||(this.ready_=new Promise((t=>{if(this.imageState_===ls||this.imageState_===cs)t();else{const e=()=>{this.imageState_!==ls&&this.imageState_!==cs||(this.removeEventListener(y,e),t())};this.addEventListener(y,e)}}))),this.ready_}}function nr(t,e,i,n,s,r){let o=void 0===e?void 0:tr.get(e,i,s);return o||(o=new ir(t,t&&"src"in t?t.src||void 0:e,i,n,s),tr.set(e,i,s,o,r)),r&&o&&!tr.getPattern(e,i,s)&&tr.set(e,i,s,o,r),o}function sr(t){return t?Array.isArray(t)?Os(t):"object"==typeof t&&"src"in t?function(t){if(!t.offset||!t.size)return tr.getPattern(t.src,"anonymous",t.color);const e=t.src+":"+t.offset,i=tr.getPattern(e,void 0,t.color);if(i)return i;const n=tr.get(t.src,"anonymous",null);if(n.getImageState()!==ls)return null;const s=Us(t.size[0],t.size[1]);return s.drawImage(n.getImage(1),t.offset[0],t.offset[1],t.size[0],t.size[1],0,0,t.size[0],t.size[1]),nr(s.canvas,e,void 0,ls,t.color,!0),tr.getPattern(e,void 0,t.color)}(t):t:null}const rr="ol-hidden",or="ol-unselectable",ar="ol-control",hr="ol-collapsed",lr=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i"),cr=["style","variant","weight","size","lineHeight","family"],ur=function(t){const e=t.match(lr);if(!e)return null;const i={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let t=0,n=cr.length;t<n;++t){const n=e[t+1];void 0!==n&&(i[cr[t]]=n)}return i.families=i.family.split(/,\s?/),i},dr="10px sans-serif",gr="#000",fr="round",pr=[],_r="round",mr="#000",yr="center",vr="middle",xr=[0,0,0,0],Mr=new k;let wr,Sr=null;const Cr={},br=function(){const t="32px ",e=["monospace","serif"],i=e.length,n="wmytzilWMYTZIL@#/&?$%10";let s,r;function o(s,o,a){let h=!0;for(let l=0;l<i;++l){const i=e[l];if(r=Ir(s+" "+o+" "+t+i,n),a!=i){const e=Ir(s+" "+o+" "+t+a+","+i,n);h=h&&e!=r}}return!!h}function a(){let t=!0;const e=Mr.getKeys();for(let i=0,n=e.length;i<n;++i){const n=e[i];if(Mr.get(n)<100){const[e,i,s]=n.split("\n");o(e,i,s)?(p(Cr),Sr=null,wr=void 0,Mr.set(n,100)):(Mr.set(n,Mr.get(n)+1,!0),t=!1)}}t&&(clearInterval(s),s=void 0)}return function(t){const e=ur(t);if(!e)return;const i=e.families;for(let t=0,n=i.length;t<n;++t){const n=i[t],r=e.style+"\n"+e.weight+"\n"+n;void 0===Mr.get(r)&&(Mr.set(r,100,!0),o(e.style,e.weight,n)||(Mr.set(r,0,!0),void 0===s&&(s=setInterval(a,32))))}}}(),Er=function(){let t;return function(e){let i=Cr[e];if(null==i){if(Bs){const t=ur(e),n=Pr(e,"Žg");i=(isNaN(Number(t.lineHeight))?1.2:Number(t.lineHeight))*(n.actualBoundingBoxAscent+n.actualBoundingBoxDescent)}else t||(t=document.createElement("div"),t.innerHTML="M",t.style.minHeight="0",t.style.maxHeight="none",t.style.height="auto",t.style.padding="0",t.style.border="none",t.style.position="absolute",t.style.display="block",t.style.left="-99999px"),t.style.font=e,document.body.appendChild(t),i=t.offsetHeight,document.body.removeChild(t);Cr[e]=i}return i}}();function Pr(t,e){return Sr||(Sr=Us(1,1)),t!=wr&&(Sr.font=t,wr=Sr.font),Sr.measureText(e)}function Ir(t,e){return Pr(t,e).width}function Tr(t,e,i){if(e in i)return i[e];const n=e.split("\n").reduce(((e,i)=>Math.max(e,Ir(t,i))),0);return i[e]=n,n}class Rr extends ps{constructor(t){super({opacity:1,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,rotation:void 0!==t.rotation?t.rotation:0,scale:void 0!==t.scale?t.scale:1,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode}),this.canvases_,this.hitDetectionCanvas_=null,this.fill_=void 0!==t.fill?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius=t.radius,this.radius2_=t.radius2,this.angle_=void 0!==t.angle?t.angle:0,this.stroke_=void 0!==t.stroke?t.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?hs:ls,this.imageState_===hs&&this.ready().then((()=>this.imageState_=ls)),this.render()}clone(){const t=this.getScale(),e=new Rr({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_,e=this.getDisplacement(),i=this.getScaleArray();return[t[0]/2-e[0]/i[0],t[1]/2+e[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(t){let e=this.canvases_[t];if(!e){const i=this.renderOptions_,n=Us(i.size*t,i.size*t);this.draw_(i,n,t),e=n.canvas,this.canvases_[t]=e}return e}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,i){if(0===e||this.points_===1/0||"bevel"!==t&&"miter"!==t)return e;let n=this.radius,s=void 0===this.radius2_?n:this.radius2_;if(n<s){const t=n;n=s,s=t}const r=void 0===this.radius2_?this.points_:2*this.points_,o=2*Math.PI/r,a=s*Math.sin(o),h=n-Math.sqrt(s*s-a*a),l=Math.sqrt(a*a+h*h),c=l/a;if("miter"===t&&c<=i)return c*e;const u=e/2/c,d=e/2*(h/l),g=Math.sqrt((n+u)*(n+u)+d*d)-n;if(void 0===this.radius2_||"bevel"===t)return 2*g;const f=n*Math.sin(o),p=s-Math.sqrt(n*n-f*f),_=Math.sqrt(f*f+p*p)/f;if(_<=i){const t=_*e/2-s-n;return 2*Math.max(g,t)}return 2*g}createRenderOptions(){let t,e=fr,i=_r,n=0,s=null,r=0,o=0;this.stroke_&&(t=sr(this.stroke_.getColor()??mr),o=this.stroke_.getWidth()??1,s=this.stroke_.getLineDash(),r=this.stroke_.getLineDashOffset()??0,i=this.stroke_.getLineJoin()??_r,e=this.stroke_.getLineCap()??fr,n=this.stroke_.getMiterLimit()??10);const a=this.calculateLineJoinSize_(i,o,n),h=Math.max(this.radius,this.radius2_||0);return{strokeStyle:t,strokeWidth:o,size:Math.ceil(2*h+a),lineCap:e,lineDash:s,lineDashOffset:r,lineJoin:i,miterLimit:n}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.canvases_={},this.hitDetectionCanvas_=null,this.size_=[t,t]}draw_(t,e,i){if(e.scale(i,i),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let t=this.fill_.getColor();null===t&&(t=gr),e.fillStyle=sr(t),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){let e;if(this.fill_){let i=this.fill_.getColor(),n=0;"string"==typeof i&&(i=Ls(i)),null===i?n=1:Array.isArray(i)&&(n=4===i.length?i[3]:1),0===n&&(e=Us(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}createPath_(t){let e=this.points_;const i=this.radius;if(e===1/0)t.arc(0,0,i,0,2*Math.PI);else{const n=void 0===this.radius2_?i:this.radius2_;void 0!==this.radius2_&&(e*=2);const s=this.angle_-Math.PI/2,r=2*Math.PI/e;for(let o=0;o<e;o++){const e=s+o*r,a=o%2==0?i:n;t.lineTo(a*Math.cos(e),a*Math.sin(e))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=gr,e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}const Ar=Rr;class Fr extends Ar{constructor(t){super({points:1/0,fill:(t=t||{radius:5}).fill,radius:t.radius,stroke:t.stroke,scale:void 0!==t.scale?t.scale:1,rotation:void 0!==t.rotation?t.rotation:0,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new Fr({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius=t,this.render()}}const Lr=Fr;class kr{constructor(t){t=t||{},this.patternImage_=null,this.color_=null,void 0!==t.color&&this.setColor(t.color)}clone(){const t=this.getColor();return new kr({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){if(null!==t&&"object"==typeof t&&"src"in t){const e=nr(null,t.src,"anonymous",void 0,t.offset?null:t.color?t.color:null,!(t.offset&&t.size));e.ready().then((()=>{this.patternImage_=null})),e.getImageState()===as&&e.load(),e.getImageState()===hs&&(this.patternImage_=e)}this.color_=t}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}const Or=kr;class Dr{constructor(t){t=t||{},this.color_=void 0!==t.color?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=void 0!==t.lineDash?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new Dr({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}}const Nr=Dr;class Gr{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=Wr,void 0!==t.geometry&&this.setGeometry(t.geometry),this.fill_=void 0!==t.fill?t.fill:null,this.image_=void 0!==t.image?t.image:null,this.renderer_=void 0!==t.renderer?t.renderer:null,this.hitDetectionRenderer_=void 0!==t.hitDetectionRenderer?t.hitDetectionRenderer:null,this.stroke_=void 0!==t.stroke?t.stroke:null,this.text_=void 0!==t.text?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&"object"==typeof t&&(t=t.clone()),new Gr({geometry:t??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=Wr,this.geometry_=t}setZIndex(t){this.zIndex_=t}}let jr=null;function zr(t,e){if(!jr){const t=new Or({color:"rgba(255,255,255,0.4)"}),e=new Nr({color:"#3399CC",width:1.25});jr=[new Gr({image:new Lr({fill:t,stroke:e,radius:5}),fill:t,stroke:e})]}return jr}function Br(){const t={},e=[255,255,255,1],i=[0,153,255,1];return t.Polygon=[new Gr({fill:new Or({color:[255,255,255,.5]})})],t.MultiPolygon=t.Polygon,t.LineString=[new Gr({stroke:new Nr({color:e,width:5})}),new Gr({stroke:new Nr({color:i,width:3})})],t.MultiLineString=t.LineString,t.Circle=t.Polygon.concat(t.LineString),t.Point=[new Gr({image:new Lr({radius:6,fill:new Or({color:i}),stroke:new Nr({color:e,width:1.5})}),zIndex:1/0})],t.MultiPoint=t.Point,t.GeometryCollection=t.Polygon.concat(t.LineString,t.Point),t}function Wr(t){return t.getGeometry()}const qr=Gr;function Xr(t,e,i,n){return void 0!==i&&void 0!==n?[i/t,n/e]:void 0!==i?i/t:void 0!==n?n/e:1}class Ur extends ps{constructor(t){const e=void 0!==(t=t||{}).opacity?t.opacity:1,i=void 0!==t.rotation?t.rotation:0,n=void 0!==t.scale?t.scale:1,s=void 0!==t.rotateWithView&&t.rotateWithView;super({opacity:e,rotation:i,scale:n,displacement:void 0!==t.displacement?t.displacement:[0,0],rotateWithView:s,declutterMode:t.declutterMode}),this.anchor_=void 0!==t.anchor?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=void 0!==t.anchorOrigin?t.anchorOrigin:"top-left",this.anchorXUnits_=void 0!==t.anchorXUnits?t.anchorXUnits:"fraction",this.anchorYUnits_=void 0!==t.anchorYUnits?t.anchorYUnits:"fraction",this.crossOrigin_=void 0!==t.crossOrigin?t.crossOrigin:null;const r=void 0!==t.img?t.img:null;let o,a=t.src;if(O(!(void 0!==a&&r),"`image` and `src` cannot be provided at the same time"),void 0!==a&&0!==a.length||!r||(a=r.src||F(r)),O(void 0!==a&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),O(!((void 0!==t.width||void 0!==t.height)&&void 0!==t.scale),"`width` or `height` cannot be provided together with `scale`"),void 0!==t.src?o=as:void 0!==r&&(o="complete"in r?r.complete?r.src?ls:as:hs:ls),this.color_=void 0!==t.color?Ls(t.color):null,this.iconImage_=nr(r,a,this.crossOrigin_,o,this.color_),this.offset_=void 0!==t.offset?t.offset:[0,0],this.offsetOrigin_=void 0!==t.offsetOrigin?t.offsetOrigin:"top-left",this.origin_=null,this.size_=void 0!==t.size?t.size:null,this.initialOptions_,void 0!==t.width||void 0!==t.height){let e,i;if(t.size)[e,i]=t.size;else{const n=this.getImage(1);if(n.width&&n.height)e=n.width,i=n.height;else if(n instanceof HTMLImageElement){this.initialOptions_=t;const e=()=>{if(this.unlistenImageChange(e),!this.initialOptions_)return;const i=this.iconImage_.getSize();this.setScale(Xr(i[0],i[1],t.width,t.height))};return void this.listenImageChange(e)}}void 0!==e&&this.setScale(Xr(e,i,t.width,t.height))}}clone(){let t,e,i;return this.initialOptions_?(e=this.initialOptions_.width,i=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new Ur({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:i,size:null!==this.size_?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const e=this.getSize();if("fraction"==this.anchorXUnits_||"fraction"==this.anchorYUnits_){if(!e)return null;t=this.anchor_.slice(),"fraction"==this.anchorXUnits_&&(t[0]*=e[0]),"fraction"==this.anchorYUnits_&&(t[1]*=e[1])}if("top-left"!=this.anchorOrigin_){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),"top-right"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[0]=-t[0]+e[0]),"bottom-left"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[1]=-t[1]+e[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),i=this.getScaleArray();return[t[0]-e[0]/i[0],t[1]+e[1]/i[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if("top-left"!=this.offsetOrigin_){const e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),"top-right"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[0]=i[0]-e[0]-t[0]),"bottom-left"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const t=this.getScaleArray();return this.size_?this.size_[0]*t[0]:this.iconImage_.getImageState()==ls?this.iconImage_.getSize()[0]*t[0]:void 0}getHeight(){const t=this.getScaleArray();return this.size_?this.size_[1]*t[1]:this.iconImage_.getImageState()==ls?this.iconImage_.getSize()[1]*t[1]:void 0}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener(y,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(y,t)}ready(){return this.iconImage_.ready()}}const Vr=Ur;class Kr{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.scale_=t.scale,this.scaleArray_=gs(void 0!==t.scale?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=void 0!==t.fill?t.fill:new Or({color:"#333"}),this.maxAngle_=void 0!==t.maxAngle?t.maxAngle:Math.PI/4,this.placement_=void 0!==t.placement?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=void 0!==t.stroke?t.stroke:null,this.offsetX_=void 0!==t.offsetX?t.offsetX:0,this.offsetY_=void 0!==t.offsetY?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=void 0===t.padding?null:t.padding,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new Kr({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=gs(void 0!==t?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}}const Yr=Kr;let Zr=0;const Hr=1<<Zr++,Jr=1<<Zr++,$r=1<<Zr++,Qr=1<<Zr++,to=1<<Zr++,eo=1<<Zr++,io=Math.pow(2,6)-1,no={[Hr]:"boolean",[Jr]:"number",[$r]:"string",[Qr]:"color",[to]:"number[]",[eo]:"size"},so=Object.keys(no).map(Number).sort(r);function ro(t){const e=[];for(const i of so)oo(t,i)&&e.push(no[i]);return 0===e.length?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function oo(t,e){return(t&e)===e}function ao(t,e){return t===e}class ho{constructor(t,e){if(!function(t){return t in no}(t))throw new Error(`literal expressions must have a specific type, got ${ro(t)}`);this.type=t,this.value=e}}class lo{constructor(t,e,...i){this.type=t,this.operator=e,this.args=i}}function co(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1}}function uo(t,e,i){switch(typeof t){case"boolean":if(ao(e,$r))return new ho($r,t?"true":"false");if(!oo(e,Hr))throw new Error(`got a boolean, but expected ${ro(e)}`);return new ho(Hr,t);case"number":if(ao(e,eo))return new ho(eo,gs(t));if(ao(e,Hr))return new ho(Hr,!!t);if(ao(e,$r))return new ho($r,t.toString());if(!oo(e,Jr))throw new Error(`got a number, but expected ${ro(e)}`);return new ho(Jr,t);case"string":if(ao(e,Qr))return new ho(Qr,Fs(t));if(ao(e,Hr))return new ho(Hr,!!t);if(!oo(e,$r))throw new Error(`got a string, but expected ${ro(e)}`);return new ho($r,t)}if(!Array.isArray(t))throw new Error("expression must be an array or a primitive value");if(0===t.length)throw new Error("empty expression");if("string"==typeof t[0])return function(t,e,i){const n=t[0],s=fo[n];if(!s)throw new Error(`unknown operator: ${n}`);return s(t,e,i)}(t,e,i);for(const e of t)if("number"!=typeof e)throw new Error("expected an array of numbers");if(ao(e,eo)){if(2!==t.length)throw new Error(`expected an array of two values for a size, got ${t.length}`);return new ho(eo,t)}if(ao(e,Qr)){if(3===t.length)return new ho(Qr,[...t,1]);if(4===t.length)return new ho(Qr,t);throw new Error(`expected an array of 3 or 4 values for a color, got ${t.length}`)}if(!oo(e,to))throw new Error(`got an array of numbers, but expected ${ro(e)}`);return new ho(to,t)}const go={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},fo={[go.Get]:Mo(mo(1,1/0),po),[go.Var]:Mo(mo(1,1),(function(t,e,i){const n=t[1];if("string"!=typeof n)throw new Error("expected a string argument for var operation");return i.variables.add(n),[new ho($r,n)]})),[go.Has]:Mo(mo(1,1/0),po),[go.Id]:Mo((function(t,e,i){i.featureId=!0}),_o),[go.Concat]:Mo(mo(2,1/0),vo($r)),[go.GeometryType]:Mo((function(t,e,i){i.geometryType=!0}),_o),[go.LineMetric]:Mo(_o),[go.Resolution]:Mo(_o),[go.Zoom]:Mo(_o),[go.Time]:Mo(_o),[go.Any]:Mo(mo(2,1/0),vo(Hr)),[go.All]:Mo(mo(2,1/0),vo(Hr)),[go.Not]:Mo(mo(1,1),vo(Hr)),[go.Equal]:Mo(mo(2,2),vo(io)),[go.NotEqual]:Mo(mo(2,2),vo(io)),[go.GreaterThan]:Mo(mo(2,2),vo(Jr)),[go.GreaterThanOrEqualTo]:Mo(mo(2,2),vo(Jr)),[go.LessThan]:Mo(mo(2,2),vo(Jr)),[go.LessThanOrEqualTo]:Mo(mo(2,2),vo(Jr)),[go.Multiply]:Mo(mo(2,1/0),yo),[go.Coalesce]:Mo(mo(2,1/0),yo),[go.Divide]:Mo(mo(2,2),vo(Jr)),[go.Add]:Mo(mo(2,1/0),vo(Jr)),[go.Subtract]:Mo(mo(2,2),vo(Jr)),[go.Clamp]:Mo(mo(3,3),vo(Jr)),[go.Mod]:Mo(mo(2,2),vo(Jr)),[go.Pow]:Mo(mo(2,2),vo(Jr)),[go.Abs]:Mo(mo(1,1),vo(Jr)),[go.Floor]:Mo(mo(1,1),vo(Jr)),[go.Ceil]:Mo(mo(1,1),vo(Jr)),[go.Round]:Mo(mo(1,1),vo(Jr)),[go.Sin]:Mo(mo(1,1),vo(Jr)),[go.Cos]:Mo(mo(1,1),vo(Jr)),[go.Atan]:Mo(mo(1,2),vo(Jr)),[go.Sqrt]:Mo(mo(1,1),vo(Jr)),[go.Match]:Mo(mo(4,1/0),xo,(function(t,e,i){const n=t.length-1,s=$r|Jr|Hr,r=uo(t[1],s,i),o=uo(t[t.length-1],e,i),a=new Array(n-2);for(let e=0;e<n-2;e+=2){try{const n=uo(t[e+2],r.type,i);a[e]=n}catch(t){throw new Error(`failed to parse argument ${e+1} of match expression: ${t.message}`)}try{const n=uo(t[e+3],o.type,i);a[e+1]=n}catch(t){throw new Error(`failed to parse argument ${e+2} of match expression: ${t.message}`)}}return[r,...a,o]})),[go.Between]:Mo(mo(3,3),vo(Jr)),[go.Interpolate]:Mo(mo(6,1/0),xo,(function(t,e,i){const n=t[1];let s;switch(n[0]){case"linear":s=1;break;case"exponential":const t=n[1];if("number"!=typeof t||t<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(t)} instead`);s=t;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(n)}`)}const r=new ho(Jr,s);let o;try{o=uo(t[2],Jr,i)}catch(t){throw new Error(`failed to parse argument 1 in interpolate expression: ${t.message}`)}const a=new Array(t.length-3);for(let n=0;n<a.length;n+=2){try{const e=uo(t[n+3],Jr,i);a[n]=e}catch(t){throw new Error(`failed to parse argument ${n+2} for interpolate expression: ${t.message}`)}try{const s=uo(t[n+4],e,i);a[n+1]=s}catch(t){throw new Error(`failed to parse argument ${n+3} for interpolate expression: ${t.message}`)}}return[r,o,...a]})),[go.Case]:Mo(mo(3,1/0),(function(t,e,i){const n=t[0],s=t.length-1;if(s%2==0)throw new Error(`expected an odd number of arguments for ${n}, got ${s} instead`)}),(function(t,e,i){const n=uo(t[t.length-1],e,i),s=new Array(t.length-1);for(let e=0;e<s.length-1;e+=2){try{const n=uo(t[e+1],Hr,i);s[e]=n}catch(t){throw new Error(`failed to parse argument ${e} of case expression: ${t.message}`)}try{const r=uo(t[e+2],n.type,i);s[e+1]=r}catch(t){throw new Error(`failed to parse argument ${e+1} of case expression: ${t.message}`)}}return s[s.length-1]=n,s})),[go.In]:Mo(mo(2,2),(function(t,e,i){let n,s=t[2];if(!Array.isArray(s))throw new Error('the second argument for the "in" operator must be an array');if("string"==typeof s[0]){if("literal"!==s[0])throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(s[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');s=s[1],n=$r}else n=Jr;const r=new Array(s.length);for(let t=0;t<r.length;t++)try{const e=uo(s[t],n,i);r[t]=e}catch(e){throw new Error(`failed to parse haystack item ${t} for "in" expression: ${e.message}`)}return[uo(t[1],n,i),...r]})),[go.Number]:Mo(mo(1,1/0),vo(io)),[go.String]:Mo(mo(1,1/0),vo(io)),[go.Array]:Mo(mo(1,1/0),vo(Jr)),[go.Color]:Mo(mo(1,4),vo(Jr)),[go.Band]:Mo(mo(1,3),vo(Jr)),[go.Palette]:Mo(mo(2,2),(function(t,e,i){let n;try{n=uo(t[1],Jr,i)}catch(t){throw new Error(`failed to parse first argument in palette expression: ${t.message}`)}const s=t[2];if(!Array.isArray(s))throw new Error("the second argument of palette must be an array");const r=new Array(s.length);for(let t=0;t<r.length;t++){let e;try{e=uo(s[t],Qr,i)}catch(e){throw new Error(`failed to parse color at index ${t} in palette expression: ${e.message}`)}if(!(e instanceof ho))throw new Error(`the palette color at index ${t} must be a literal value`);r[t]=e}return[n,...r]})),[go.ToString]:Mo(mo(1,1),vo(Hr|Jr|$r|Qr))};function po(t,e,i){const n=t.length-1,s=new Array(n);for(let e=0;e<n;++e){const n=t[e+1];switch(typeof n){case"number":s[e]=new ho(Jr,n);break;case"string":s[e]=new ho($r,n);break;default:throw new Error(`expected a string key or numeric array index for a get operation, got ${n}`)}0===e&&i.properties.add(String(n))}return s}function _o(t,e,i){const n=t[0];if(1!==t.length)throw new Error(`expected no arguments for ${n} operation`);return[]}function mo(t,e){return function(i,n,s){const r=i[0],o=i.length-1;if(t===e){if(o!==t)throw new Error(`expected ${t} argument${1===t?"":"s"} for ${r}, got ${o}`)}else if(o<t||o>e)throw new Error(`expected ${e===1/0?`${t} or more`:`${t} to ${e}`} arguments for ${r}, got ${o}`)}}function yo(t,e,i){const n=t.length-1,s=new Array(n);for(let r=0;r<n;++r){const n=uo(t[r+1],e,i);s[r]=n}return s}function vo(t){return function(e,i,n){const s=e.length-1,r=new Array(s);for(let i=0;i<s;++i){const s=uo(e[i+1],t,n);r[i]=s}return r}}function xo(t,e,i){const n=t[0],s=t.length-1;if(s%2==1)throw new Error(`expected an even number of arguments for operation ${n}, got ${s} instead`)}function Mo(...t){return function(e,i,n){const s=e[0];let r;for(let s=0;s<t.length;s++){const o=t[s](e,i,n);if(s==t.length-1){if(!o)throw new Error("expected last argument validator to return the parsed args");r=o}}return new lo(i,s,...r)}}function wo(t){if(!t)return"";const e=t.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return wo(t.getGeometries()[0]);default:return""}}function So(t,e,i){return Co(uo(t,e,i),i)}function Co(t,e){if(t instanceof ho){if(t.type===Qr&&"string"==typeof t.value){const e=Fs(t.value);return function(){return e}}return function(){return t.value}}const i=t.operator;switch(i){case go.Number:case go.String:case go.Coalesce:return function(t,e){const i=t.operator,n=t.args.length,s=new Array(n);for(let i=0;i<n;++i)s[i]=Co(t.args[i],e);switch(i){case go.Coalesce:return t=>{for(let e=0;e<n;++e){const i=s[e](t);if(null!=i)return i}throw new Error("Expected one of the values to be non-null")};case go.Number:case go.String:return t=>{for(let e=0;e<n;++e){const n=s[e](t);if(typeof n===i)return n}throw new Error(`Expected one of the values to be a ${i}`)};default:throw new Error(`Unsupported assertion operator ${i}`)}}(t,e);case go.Get:case go.Var:case go.Has:return function(t){const e=t.args[0].value;switch(t.operator){case go.Get:return i=>{const n=t.args;let s=i.properties[e];for(let t=1,e=n.length;t<e;++t)s=s[n[t].value];return s};case go.Var:return t=>t.variables[e];case go.Has:return i=>{const n=t.args;if(!(e in i.properties))return!1;let s=i.properties[e];for(let t=1,e=n.length;t<e;++t){const e=n[t].value;if(!s||!Object.hasOwn(s,e))return!1;s=s[e]}return!0};default:throw new Error(`Unsupported accessor operator ${t.operator}`)}}(t);case go.Id:return t=>t.featureId;case go.GeometryType:return t=>t.geometryType;case go.Concat:{const i=t.args.map((t=>Co(t,e)));return t=>"".concat(...i.map((e=>e(t).toString())))}case go.Resolution:return t=>t.resolution;case go.Any:case go.All:case go.Between:case go.In:case go.Not:return function(t,e){const i=t.operator,n=t.args.length,s=new Array(n);for(let i=0;i<n;++i)s[i]=Co(t.args[i],e);switch(i){case go.Any:return t=>{for(let e=0;e<n;++e)if(s[e](t))return!0;return!1};case go.All:return t=>{for(let e=0;e<n;++e)if(!s[e](t))return!1;return!0};case go.Between:return t=>{const e=s[0](t),i=s[1](t),n=s[2](t);return e>=i&&e<=n};case go.In:return t=>{const e=s[0](t);for(let i=1;i<n;++i)if(e===s[i](t))return!0;return!1};case go.Not:return t=>!s[0](t);default:throw new Error(`Unsupported logical operator ${i}`)}}(t,e);case go.Equal:case go.NotEqual:case go.LessThan:case go.LessThanOrEqualTo:case go.GreaterThan:case go.GreaterThanOrEqualTo:return function(t,e){const i=t.operator,n=Co(t.args[0],e),s=Co(t.args[1],e);switch(i){case go.Equal:return t=>n(t)===s(t);case go.NotEqual:return t=>n(t)!==s(t);case go.LessThan:return t=>n(t)<s(t);case go.LessThanOrEqualTo:return t=>n(t)<=s(t);case go.GreaterThan:return t=>n(t)>s(t);case go.GreaterThanOrEqualTo:return t=>n(t)>=s(t);default:throw new Error(`Unsupported comparison operator ${i}`)}}(t,e);case go.Multiply:case go.Divide:case go.Add:case go.Subtract:case go.Clamp:case go.Mod:case go.Pow:case go.Abs:case go.Floor:case go.Ceil:case go.Round:case go.Sin:case go.Cos:case go.Atan:case go.Sqrt:return function(t,e){const i=t.operator,n=t.args.length,s=new Array(n);for(let i=0;i<n;++i)s[i]=Co(t.args[i],e);switch(i){case go.Multiply:return t=>{let e=1;for(let i=0;i<n;++i)e*=s[i](t);return e};case go.Divide:return t=>s[0](t)/s[1](t);case go.Add:return t=>{let e=0;for(let i=0;i<n;++i)e+=s[i](t);return e};case go.Subtract:return t=>s[0](t)-s[1](t);case go.Clamp:return t=>{const e=s[0](t),i=s[1](t);if(e<i)return i;const n=s[2](t);return e>n?n:e};case go.Mod:return t=>s[0](t)%s[1](t);case go.Pow:return t=>Math.pow(s[0](t),s[1](t));case go.Abs:return t=>Math.abs(s[0](t));case go.Floor:return t=>Math.floor(s[0](t));case go.Ceil:return t=>Math.ceil(s[0](t));case go.Round:return t=>Math.round(s[0](t));case go.Sin:return t=>Math.sin(s[0](t));case go.Cos:return t=>Math.cos(s[0](t));case go.Atan:return 2===n?t=>Math.atan2(s[0](t),s[1](t)):t=>Math.atan(s[0](t));case go.Sqrt:return t=>Math.sqrt(s[0](t));default:throw new Error(`Unsupported numeric operator ${i}`)}}(t,e);case go.Case:return function(t,e){const i=t.args.length,n=new Array(i);for(let s=0;s<i;++s)n[s]=Co(t.args[s],e);return t=>{for(let e=0;e<i-1;e+=2)if(n[e](t))return n[e+1](t);return n[i-1](t)}}(t,e);case go.Match:return function(t,e){const i=t.args.length,n=new Array(i);for(let s=0;s<i;++s)n[s]=Co(t.args[s],e);return t=>{const e=n[0](t);for(let s=1;s<i;s+=2)if(e===n[s](t))return n[s+1](t);return n[i-1](t)}}(t,e);case go.Interpolate:return function(t,e){const i=t.args.length,n=new Array(i);for(let s=0;s<i;++s)n[s]=Co(t.args[s],e);return t=>{const e=n[0](t),s=n[1](t);let r,o;for(let a=2;a<i;a+=2){const i=n[a](t);let h=n[a+1](t);const l=Array.isArray(h);if(l&&(h=Rs(h)),i>=s)return 2===a?h:l?Eo(e,s,r,o,i,h):bo(e,s,r,o,i,h);r=i,o=h}return o}}(t,e);case go.ToString:return function(t,e){const i=t.operator,n=t.args.length,s=new Array(n);for(let i=0;i<n;++i)s[i]=Co(t.args[i],e);if(i===go.ToString)return e=>{const i=s[0](e);return t.args[0].type===Qr?Os(i):i.toString()};throw new Error(`Unsupported convert operator ${i}`)}(t,e);default:throw new Error(`Unsupported operator ${i}`)}}function bo(t,e,i,n,s,r){const o=s-i;if(0===o)return n;const a=e-i;return n+(1===t?a/o:(Math.pow(t,a)-1)/(Math.pow(t,o)-1))*(r-n)}function Eo(t,e,i,n,s,r){if(0==s-i)return n;const o=As(n),a=As(r);let h=a[2]-o[2];return h>180?h-=360:h<-180&&(h+=360),ks(function(t){const e=ys.rgb(Ms.xyz(t));return e[3]=t[3],e}([bo(t,e,i,o[0],s,a[0]),bo(t,e,i,o[1],s,a[1]),o[2]+bo(t,e,i,0,s,h),bo(t,e,i,n[3],s,r[3])]))}function Po(t){return!0}function Io(t){const e=co(),i=function(t,e){const i=t.length,n=new Array(i);for(let s=0;s<i;++s){const i=t[s],r="filter"in i?So(i.filter,Hr,e):Po;let o;if(Array.isArray(i.style)){const t=i.style.length;o=new Array(t);for(let n=0;n<t;++n)o[n]=Ro(i.style[n],e)}else o=[Ro(i.style,e)];n[s]={filter:r,styles:o}}return function(e){const s=[];let r=!1;for(let o=0;o<i;++o)if((0,n[o].filter)(e)&&(!t[o].else||!r)){r=!0;for(const t of n[o].styles){const i=t(e);i&&s.push(i)}}return s}}(t,e),n={variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""};return function(t,s){if(n.properties=t.getPropertiesInternal(),n.resolution=s,e.featureId){const e=t.getId();n.featureId=void 0!==e?e:null}return e.geometryType&&(n.geometryType=wo(t.getGeometry())),i(n)}}function To(t){const e=co(),i=t.length,n=new Array(i);for(let s=0;s<i;++s)n[s]=Ro(t[s],e);const s={variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""},r=new Array(i);return function(t,o){if(s.properties=t.getPropertiesInternal(),s.resolution=o,e.featureId){const e=t.getId();s.featureId=void 0!==e?e:null}let a=0;for(let t=0;t<i;++t){const e=n[t](s);e&&(r[a]=e,a+=1)}return r.length=a,r}}function Ro(t,e){const i=Ao(t,"",e),n=Fo(t,"",e),s=function(t,e){const i="text-",n=ko(t,i+"value",e);if(!n)return null;const s=Ao(t,i,e),r=Ao(t,i+"background-",e),o=Fo(t,i,e),a=Fo(t,i+"background-",e),h=ko(t,i+"font",e),l=Lo(t,i+"max-angle",e),c=Lo(t,i+"offset-x",e),u=Lo(t,i+"offset-y",e),d=Oo(t,i+"overflow",e),g=ko(t,i+"placement",e),f=Lo(t,i+"repeat",e),p=zo(t,i+"scale",e),_=Oo(t,i+"rotate-with-view",e),m=Lo(t,i+"rotation",e),y=ko(t,i+"align",e),v=ko(t,i+"justify",e),x=ko(t,i+"baseline",e),M=No(t,i+"padding",e),w=Xo(t,i+"declutter-mode"),S=new Yr({declutterMode:w});return function(t){if(S.setText(n(t)),s&&S.setFill(s(t)),r&&S.setBackgroundFill(r(t)),o&&S.setStroke(o(t)),a&&S.setBackgroundStroke(a(t)),h&&S.setFont(h(t)),l&&S.setMaxAngle(l(t)),c&&S.setOffsetX(c(t)),u&&S.setOffsetY(u(t)),d&&S.setOverflow(d(t)),g){const e=g(t);if("point"!==e&&"line"!==e)throw new Error("Expected point or line for text-placement");S.setPlacement(e)}if(f&&S.setRepeat(f(t)),p&&S.setScale(p(t)),_&&S.setRotateWithView(_(t)),m&&S.setRotation(m(t)),y){const e=y(t);if("left"!==e&&"center"!==e&&"right"!==e&&"end"!==e&&"start"!==e)throw new Error("Expected left, right, center, start, or end for text-align");S.setTextAlign(e)}if(v){const e=v(t);if("left"!==e&&"right"!==e&&"center"!==e)throw new Error("Expected left, right, or center for text-justify");S.setJustify(e)}if(x){const e=x(t);if("bottom"!==e&&"top"!==e&&"middle"!==e&&"alphabetic"!==e&&"hanging"!==e)throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");S.setTextBaseline(e)}return M&&S.setPadding(M(t)),S}}(t,e),r=function(t,e){return"icon-src"in t?function(t,e){const i="icon-",n=i+"src",s=Vo(t[n],n),r=Go(t,i+"anchor",e),o=zo(t,i+"scale",e),a=Lo(t,i+"opacity",e),h=Go(t,i+"displacement",e),l=Lo(t,i+"rotation",e),c=Oo(t,i+"rotate-with-view",e),u=Wo(t,i+"anchor-origin"),d=qo(t,i+"anchor-x-units"),g=qo(t,i+"anchor-y-units"),f=function(t,e){const i=t[e];if(void 0!==i)return Yo(i,e)}(t,i+"color"),p=function(t,e){const i=t[e];if(void 0!==i){if("string"!=typeof i)throw new Error(`Expected a string for ${e}`);return i}}(t,i+"cross-origin"),_=function(t,e){const i=t[e];if(void 0!==i)return Uo(i,e)}(t,i+"offset"),m=Wo(t,i+"offset-origin"),y=Bo(t,i+"width"),v=Bo(t,i+"height"),x=function(t,e){const i=t[e];if(void 0!==i){if("number"==typeof i)return gs(i);if(!Array.isArray(i))throw new Error(`Expected a number or size array for ${e}`);if(2!==i.length||"number"!=typeof i[0]||"number"!=typeof i[1])throw new Error(`Expected a number or size array for ${e}`);return i}}(t,i+"size"),M=Xo(t,i+"declutter-mode"),w=new Vr({src:s,anchorOrigin:u,anchorXUnits:d,anchorYUnits:g,color:f,crossOrigin:p,offset:_,offsetOrigin:m,height:v,width:y,size:x,declutterMode:M});return function(t){return a&&w.setOpacity(a(t)),h&&w.setDisplacement(h(t)),l&&w.setRotation(l(t)),c&&w.setRotateWithView(c(t)),o&&w.setScale(o(t)),r&&w.setAnchor(r(t)),w}}(t,e):"shape-points"in t?function(t,e){const i="shape-",n=i+"points",s=i+"radius",r=Ko(t[n],n),o=Ko(t[s],s),a=Ao(t,i,e),h=Fo(t,i,e),l=zo(t,i+"scale",e),c=Go(t,i+"displacement",e),u=Lo(t,i+"rotation",e),d=Oo(t,i+"rotate-with-view",e),g=Bo(t,i+"radius2"),f=Bo(t,i+"angle"),p=Xo(t,i+"declutter-mode"),_=new Ar({points:r,radius:o,radius2:g,angle:f,declutterMode:p});return function(t){return a&&_.setFill(a(t)),h&&_.setStroke(h(t)),c&&_.setDisplacement(c(t)),u&&_.setRotation(u(t)),d&&_.setRotateWithView(d(t)),l&&_.setScale(l(t)),_}}(t,e):"circle-radius"in t?function(t,e){const i="circle-",n=Ao(t,i,e),s=Fo(t,i,e),r=Lo(t,i+"radius",e),o=zo(t,i+"scale",e),a=Go(t,i+"displacement",e),h=Lo(t,i+"rotation",e),l=Oo(t,i+"rotate-with-view",e),c=Xo(t,i+"declutter-mode"),u=new Lr({radius:5,declutterMode:c});return function(t){return r&&u.setRadius(r(t)),n&&u.setFill(n(t)),s&&u.setStroke(s(t)),a&&u.setDisplacement(a(t)),h&&u.setRotation(h(t)),l&&u.setRotateWithView(l(t)),o&&u.setScale(o(t)),u}}(t,e):null}(t,e),o=Lo(t,"z-index",e);if(!(i||n||s||r||_(t)))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(t));const a=new qr;return function(t){let e=!0;if(i){const n=i(t);n&&(e=!1),a.setFill(n)}if(n){const i=n(t);i&&(e=!1),a.setStroke(i)}if(s){const i=s(t);i&&(e=!1),a.setText(i)}if(r){const i=r(t);i&&(e=!1),a.setImage(i)}return o&&a.setZIndex(o(t)),e?null:a}}function Ao(t,e,i){let n;if(e+"fill-pattern-src"in t)n=function(t,e,i){const n=ko(t,e+"pattern-src",i),s=jo(t,e+"pattern-offset",i),r=jo(t,e+"pattern-size",i),o=Do(t,e+"color",i);return function(t){return{src:n(t),offset:s&&s(t),size:r&&r(t),color:o&&o(t)}}}(t,e+"fill-",i);else{if("none"===t[e+"fill-color"])return t=>null;n=Do(t,e+"fill-color",i)}if(!n)return null;const s=new Or;return function(t){const e=n(t);return e===Es?null:(s.setColor(e),s)}}function Fo(t,e,i){const n=Lo(t,e+"stroke-width",i),s=Do(t,e+"stroke-color",i);if(!n&&!s)return null;const r=ko(t,e+"stroke-line-cap",i),o=ko(t,e+"stroke-line-join",i),a=No(t,e+"stroke-line-dash",i),h=Lo(t,e+"stroke-line-dash-offset",i),l=Lo(t,e+"stroke-miter-limit",i),c=new Nr;return function(t){if(s){const e=s(t);if(e===Es)return null;c.setColor(e)}if(n&&c.setWidth(n(t)),r){const e=r(t);if("butt"!==e&&"round"!==e&&"square"!==e)throw new Error("Expected butt, round, or square line cap");c.setLineCap(e)}if(o){const e=o(t);if("bevel"!==e&&"round"!==e&&"miter"!==e)throw new Error("Expected bevel, round, or miter line join");c.setLineJoin(e)}return a&&c.setLineDash(a(t)),h&&c.setLineDashOffset(h(t)),l&&c.setMiterLimit(l(t)),c}}function Lo(t,e,i){if(!(e in t))return;const n=So(t[e],Jr,i);return function(t){return Ko(n(t),e)}}function ko(t,e,i){if(!(e in t))return null;const n=So(t[e],$r,i);return function(t){return Vo(n(t),e)}}function Oo(t,e,i){if(!(e in t))return null;const n=So(t[e],Hr,i);return function(t){const i=n(t);if("boolean"!=typeof i)throw new Error(`Expected a boolean for ${e}`);return i}}function Do(t,e,i){if(!(e in t))return null;const n=So(t[e],Qr,i);return function(t){return Yo(n(t),e)}}function No(t,e,i){if(!(e in t))return null;const n=So(t[e],to,i);return function(t){return Uo(n(t),e)}}function Go(t,e,i){if(!(e in t))return null;const n=So(t[e],to,i);return function(t){const i=Uo(n(t),e);if(2!==i.length)throw new Error(`Expected two numbers for ${e}`);return i}}function jo(t,e,i){if(!(e in t))return null;const n=So(t[e],to,i);return function(t){return Zo(n(t),e)}}function zo(t,e,i){if(!(e in t))return null;const n=So(t[e],to|Jr,i);return function(t){return i=n(t),s=e,"number"==typeof i?i:Zo(i,s);var i,s}}function Bo(t,e){const i=t[e];if(void 0!==i){if("number"!=typeof i)throw new Error(`Expected a number for ${e}`);return i}}function Wo(t,e){const i=t[e];if(void 0!==i){if("bottom-left"!==i&&"bottom-right"!==i&&"top-left"!==i&&"top-right"!==i)throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return i}}function qo(t,e){const i=t[e];if(void 0!==i){if("pixels"!==i&&"fraction"!==i)throw new Error(`Expected pixels or fraction for ${e}`);return i}}function Xo(t,e){const i=t[e];if(void 0!==i){if("string"!=typeof i)throw new Error(`Expected a string for ${e}`);if("declutter"!==i&&"obstacle"!==i&&"none"!==i)throw new Error(`Expected declutter, obstacle, or none for ${e}`);return i}}function Uo(t,e){if(!Array.isArray(t))throw new Error(`Expected an array for ${e}`);const i=t.length;for(let n=0;n<i;++n)if("number"!=typeof t[n])throw new Error(`Expected an array of numbers for ${e}`);return t}function Vo(t,e){if("string"!=typeof t)throw new Error(`Expected a string for ${e}`);return t}function Ko(t,e){if("number"!=typeof t)throw new Error(`Expected a number for ${e}`);return t}function Yo(t,e){if("string"==typeof t)return t;const i=Uo(t,e),n=i.length;if(n<3||n>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return i}function Zo(t,e){const i=Uo(t,e);if(2!==i.length)throw new Error(`Expected an array of two numbers for ${e}`);return i}const Ho="renderOrder",Jo=class extends qn{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=t.declutter?String(t.declutter):void 0,this.renderBuffer_=void 0!==t.renderBuffer?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=void 0!==t.updateWhileAnimating&&t.updateWhileAnimating,this.updateWhileInteracting_=void 0!==t.updateWhileInteracting&&t.updateWhileInteracting}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(Ho)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t,e){const i=this.getDeclutter();i in t.declutter==0&&(t.declutter[i]=new Kn(9)),this.getRenderer().renderDeclutter(t,e)}setRenderOrder(t){this.set(Ho,t)}setStyle(t){this.style_=void 0===t?zr:t;const e=function(t){if(void 0===t)return zr;if(!t)return null;if("function"==typeof t)return t;if(t instanceof qr)return t;if(!Array.isArray(t))return To([t]);if(0===t.length)return[];const e=t.length,i=t[0];if(i instanceof qr){const i=new Array(e);for(let n=0;n<e;++n){const e=t[n];if(!(e instanceof qr))throw new Error("Expected a list of style instances");i[n]=e}return i}if("style"in i){const i=new Array(e);for(let n=0;n<e;++n){const e=t[n];if(!("style"in e))throw new Error("Expected a list of rules with a style property");i[n]=e}return Io(i)}return To(t)}(t);this.styleFunction_=null===t?void 0:function(t){let e;if("function"==typeof t)e=t;else{let i;Array.isArray(t)?i=t:(O("function"==typeof t.getZIndex,"Expected an `Style` or an array of `Style`"),i=[t]),e=function(){return i}}return e}(e),this.changed()}};function $o(t,e){tr.expire()}const Qo=class extends s{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){R()}calculateMatrices2D(t){const e=t.viewState,i=t.coordinateToPixelTransform,n=t.pixelToCoordinateTransform;j(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),z(n,i)}forEachFeatureAtCoordinate(t,e,i,n,s,r,o,a){let h;const l=e.viewState;function c(t,e,i,n){return s.call(r,e,t?i:null,n)}const u=l.projection,d=ue(t.slice(),u),g=[[0,0]];if(u.canWrapX()&&n){const t=yt(u.getExtent());g.push([-t,0],[t,0])}const f=e.layerStatesArray,p=f.length,_=[],m=[];for(let n=0;n<g.length;n++)for(let s=p-1;s>=0;--s){const r=f[s],u=r.layer;if(u.hasRenderer()&&Wn(r,l)&&o.call(a,u)){const s=u.getRenderer(),o=u.getSource();if(s&&o){const a=o.getWrapX()?d:t,l=c.bind(null,r.managed);m[0]=a[0]+g[n][0],m[1]=a[1]+g[n][1],h=s.forEachFeatureAtCoordinate(m,e,i,l,_)}if(h)return h}}if(0===_.length)return;const y=1/_.length;return _.forEach(((t,e)=>t.distanceSq+=e*y)),_.sort(((t,e)=>t.distanceSq-e.distanceSq)),_.some((t=>h=t.callback(t.feature,t.layer,t.geometry))),h}hasFeatureAtCoordinate(t,e,i,n,s,r){return void 0!==this.forEachFeatureAtCoordinate(t,e,i,n,c,this,s,r)}getMap(){return this.map_}renderFrame(t){R()}scheduleExpireIconCache(t){tr.canExpireCache()&&t.postRenderFunctions.push($o)}},ta=class extends t{constructor(t,e,i,n){super(t),this.inversePixelTransform=e,this.frameState=i,this.context=n}},ea=class extends Qo{constructor(t){super(t),this.fontChangeListenerKey_=b(Mr,e,t.redrawText.bind(t)),this.element_=document.createElement("div");const i=this.element_.style;i.position="absolute",i.width="100%",i.height="100%",i.zIndex="0",this.element_.className=or+" ol-layers";const n=t.getViewport();n.insertBefore(this.element_,n.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(t,e){const i=this.getMap();if(i.hasListener(t)){const n=new ta(t,void 0,e);i.dispatchEvent(n)}}disposeInternal(){P(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(t){if(!t)return void(this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1));this.calculateMatrices2D(t),this.dispatchRenderEvent(wn,t);const e=t.layerStatesArray.sort(((t,e)=>t.zIndex-e.zIndex));e.some((t=>t.layer instanceof Jo&&t.layer.getDeclutter()))&&(t.declutter={});const i=t.viewState;this.children_.length=0;const n=[];let s=null;for(let r=0,o=e.length;r<o;++r){const o=e[r];t.layerIndex=r;const a=o.layer,h=a.getSourceState();if(!Wn(o,i)||"ready"!=h&&"undefined"!=h){a.unrender();continue}const l=a.render(t,s);l&&(l!==s&&(this.children_.push(l),s=l),n.push(o))}this.declutter(t,n),function(t,e){const i=t.childNodes;for(let n=0;;++n){const s=i[n],r=e[n];if(!s&&!r)break;s!==r&&(s?r?t.insertBefore(r,s):(t.removeChild(s),--n):t.appendChild(r))}}(this.element_,this.children_),this.dispatchRenderEvent("postcompose",t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}declutter(t,e){if(t.declutter){for(let i=e.length-1;i>=0;--i){const n=e[i],s=n.layer;s.getDeclutter()&&s.renderDeclutter(t,n)}e.forEach((e=>e.layer.renderDeferred(t)))}}};class ia extends t{constructor(t,e){super(t),this.layer=e}}const na="layers";class sa extends vn{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let i=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(na,this.handleLayersChanged_),i?Array.isArray(i)?i=new ln(i.slice(),{unique:!0}):O("function"==typeof i.getArray,"Expected `layers` to be an array or a `Collection`"):i=new ln(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(P),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(b(t,rn,this.handleLayersAdd_,this),b(t,on,this.handleLayersRemove_,this));for(const t in this.listenerKeys_)this.listenerKeys_[t].forEach(P);p(this.listenerKeys_);const e=t.getArray();for(let t=0,i=e.length;t<i;t++){const i=e[t];this.registerLayerListeners_(i),this.dispatchEvent(new ia("addlayer",i))}this.changed()}registerLayerListeners_(t){const i=[b(t,e,this.handleLayerChange_,this),b(t,y,this.handleLayerChange_,this)];t instanceof sa&&i.push(b(t,"addlayer",this.handleLayerGroupAdd_,this),b(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[F(t)]=i}handleLayerGroupAdd_(t){this.dispatchEvent(new ia("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new ia("removelayer",t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new ia("addlayer",e)),this.changed()}handleLayersRemove_(t){const e=t.element,i=F(e);this.listenerKeys_[i].forEach(P),delete this.listenerKeys_[i],this.dispatchEvent(new ia("removelayer",e)),this.changed()}getLayers(){return this.get(na)}setLayers(t){const e=this.getLayers();if(e){const t=e.getArray();for(let e=0,i=t.length;e<i;++e)this.dispatchEvent(new ia("removelayer",t[e]))}this.set(na,t)}getLayersArray(t){return t=void 0!==t?t:[],this.getLayers().forEach((function(e){e.getLayersArray(t)})),t}getLayerStatesArray(t){const e=void 0!==t?t:[],i=e.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(e)}));const n=this.getLayerState();let s=n.zIndex;t||void 0!==n.zIndex||(s=0);for(let t=i,r=e.length;t<r;t++){const i=e[t];i.opacity*=n.opacity,i.visible=i.visible&&n.visible,i.maxResolution=Math.min(i.maxResolution,n.maxResolution),i.minResolution=Math.max(i.minResolution,n.minResolution),i.minZoom=Math.max(i.minZoom,n.minZoom),i.maxZoom=Math.min(i.maxZoom,n.maxZoom),void 0!==n.extent&&(void 0!==i.extent?i.extent=pt(i.extent,n.extent):i.extent=n.extent),void 0===i.zIndex&&(i.zIndex=s)}return e}getSourceState(){return"ready"}}const ra=sa,oa=class extends t{constructor(t,e,i){super(t),this.map=e,this.frameState=void 0!==i?i:null}},aa=class extends oa{constructor(t,e,i,n,s,r){super(t,e,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=void 0!==n&&n,this.activePointers=r}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}},ha={SINGLECLICK:"singleclick",CLICK:x,DBLCLICK:"dblclick",POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},la="pointerdown",ca=class extends m{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=void 0===e?1:e,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=b(i,la,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=b(i,"pointermove",this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(S,this.boundHandleTouchMove_,!!Xs&&{passive:!1})}emulateClick_(t){let e=new aa(ha.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new aa(ha.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout((()=>{this.clickTimeoutId_=void 0;const e=new aa(ha.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}),250)}updateActivePointers_(t){const e=t,i=e.pointerId;if(e.type==ha.POINTERUP||e.type==ha.POINTERCANCEL){delete this.trackedTouches_[i];for(const t in this.trackedTouches_)if(this.trackedTouches_[t].target!==e.target){delete this.trackedTouches_[t];break}}else e.type!=ha.POINTERDOWN&&e.type!=ha.POINTERMOVE||(this.trackedTouches_[i]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new aa(ha.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),0===this.activePointers_.length&&(this.dragListenerKeys_.forEach(P),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return 0===t.button}handlePointerDown_(t){this.emulateClicks_=0===this.activePointers_.length,this.updateActivePointers_(t);const e=new aa(ha.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),0===this.dragListenerKeys_.length){const t=this.map_.getOwnerDocument();this.dragListenerKeys_.push(b(t,ha.POINTERMOVE,this.handlePointerMove_,this),b(t,ha.POINTERUP,this.handlePointerUp_,this),b(this.element_,ha.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==t&&this.dragListenerKeys_.push(b(this.element_.getRootNode(),ha.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new aa(ha.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new aa(ha.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;e&&!e.defaultPrevented||"boolean"==typeof t.cancelable&&!0!==t.cancelable||t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(P(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(S,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(P(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(P),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}},ua="postrender",da="loadstart",ga="loadend",fa="layergroup",pa="size",_a="target",ma="view",ya=1/0,va=class{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,p(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,i=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const n=this.keyFunction_(i);return delete this.queuedElements_[n],i}enqueue(t){O(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const e=this.priorityFunction_(t);return e!=ya&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}getCount(){return this.elements_.length}getLeftChildIndex_(t){return 2*t+1}getRightChildIndex_(t){return 2*t+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return 0===this.elements_.length}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,i=this.priorities_,n=e.length,s=e[t],r=i[t],o=t;for(;t<n>>1;){const s=this.getLeftChildIndex_(t),r=this.getRightChildIndex_(t),o=r<n&&i[r]<i[s]?r:s;e[t]=e[o],i[t]=i[o],t=o}e[t]=s,i[t]=r,this.siftDown_(o,t)}siftDown_(t,e){const i=this.elements_,n=this.priorities_,s=i[e],r=n[e];for(;e>t;){const t=this.getParentIndex_(e);if(!(n[t]>r))break;i[e]=i[t],n[e]=n[t],e=t}i[e]=s,n[e]=r}reprioritize(){const t=this.priorityFunction_,e=this.elements_,i=this.priorities_;let n=0;const s=e.length;let r,o,a;for(o=0;o<s;++o)r=e[o],a=t(r),a==ya?delete this.queuedElements_[this.keyFunction_(r)]:(i[n]=a,e[n++]=r);e.length=n,i.length=n,this.heapify_()}},xa=class extends va{constructor(t,e){super((function(e){return t.apply(null,e)}),(function(t){return t[0].getKey()})),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);return e&&t[0].addEventListener(y,this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,i=e.getState();if(2===i||3===i||4===i){3!==i&&e.removeEventListener(y,this.boundHandleTileChange_);const t=e.getKey();t in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[t],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let i=0;for(;this.tilesLoading_<t&&i<e&&this.getCount()>0;){const t=this.dequeue()[0],e=t.getKey();0!==t.getState()||e in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[e]=!0,++this.tilesLoading_,++i,t.load())}}},Ma=class extends k{constructor(t){super();const e=t.element;!e||t.target||e.style.pointerEvents||(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&this.element?.remove();for(let t=0,e=this.listenerKeys.length;t<e;++t)P(this.listenerKeys[t]);this.listenerKeys.length=0,this.map_=t,t&&((this.target_??t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==d&&this.listenerKeys.push(b(t,ua,this.render,this)),t.render())}render(t){}setTarget(t){this.target_="string"==typeof t?document.getElementById(t):t}},wa=class extends Ma{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=void 0===t.collapsed||t.collapsed,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=void 0!==t.collapsible,this.collapsible_=void 0===t.collapsible||t.collapsible,this.collapsible_||(this.collapsed_=!1),this.attributions_=t.attributions;const e=void 0!==t.className?t.className:"ol-attribution",i=void 0!==t.tipLabel?t.tipLabel:"Attributions",n=void 0!==t.expandClassName?t.expandClassName:e+"-expand",s=void 0!==t.collapseLabel?t.collapseLabel:"›",r=void 0!==t.collapseClassName?t.collapseClassName:e+"-collapse";"string"==typeof s?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=r):this.collapseLabel_=s;const o=void 0!==t.label?t.label:"i";"string"==typeof o?(this.label_=document.createElement("span"),this.label_.textContent=o,this.label_.className=n):this.label_=o;const a=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(a),this.toggleButton_.addEventListener(x,this.handleClick_.bind(this),!1);const h=e+" "+or+" "+ar+(this.collapsed_&&this.collapsible_?" "+hr:"")+(this.collapsible_?"":" ol-uncollapsible"),l=this.element;l.className=h,l.appendChild(this.toggleButton_),l.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e=this.getMap().getAllLayers(),i=new Set(e.flatMap((e=>e.getAttributions(t))));if(void 0!==this.attributions_&&(Array.isArray(this.attributions_)?this.attributions_.forEach((t=>i.add(t))):i.add(this.attributions_)),!this.overrideCollapsible_){const t=!e.some((t=>!1===t.getSource()?.getAttributionsCollapsible()));this.setCollapsible(t)}return Array.from(i)}async updateElement_(t){if(!t)return void(this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1));const e=await Promise.all(this.collectSourceAttributions_(t).map((t=>f((()=>t))))),i=e.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!l(e,this.renderedAttributions_)){!function(t){for(;t.lastChild;)t.lastChild.remove()}(this.ulElement_);for(let t=0,i=e.length;t<i;++t){const i=document.createElement("li");i.innerHTML=e[t],this.ulElement_.appendChild(i)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(hr),this.collapsed_?Zs(this.collapseLabel_,this.label_):Zs(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}},Sa=class extends Ma{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=void 0!==t.className?t.className:"ol-rotate",i=void 0!==t.label?t.label:"⇧",n=void 0!==t.compassClassName?t.compassClassName:"ol-compass";this.label_=null,"string"==typeof i?(this.label_=document.createElement("span"),this.label_.className=n,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(n));const s=t.tipLabel?t.tipLabel:"Reset rotation",r=document.createElement("button");r.className=e+"-reset",r.setAttribute("type","button"),r.title=s,r.appendChild(this.label_),r.addEventListener(x,this.handleClick_.bind(this),!1);const o=e+" "+or+" "+ar,a=this.element;a.className=o,a.appendChild(r),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=void 0!==t.duration?t.duration:250,this.autoHide_=void 0===t.autoHide||t.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(rr)}handleClick_(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const e=t.getRotation();void 0!==e&&(this.duration_>0&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:On}):t.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const i=e.viewState.rotation;if(i!=this.rotation_){const t="rotate("+i+"rad)";if(this.autoHide_){const t=this.element.classList.contains(rr);t||0!==i?t&&0!==i&&this.element.classList.remove(rr):this.element.classList.add(rr)}this.label_.style.transform=t}this.rotation_=i}},Ca=class extends Ma{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=void 0!==t.className?t.className:"ol-zoom",i=void 0!==t.delta?t.delta:1,n=void 0!==t.zoomInClassName?t.zoomInClassName:e+"-in",s=void 0!==t.zoomOutClassName?t.zoomOutClassName:e+"-out",r=void 0!==t.zoomInLabel?t.zoomInLabel:"+",o=void 0!==t.zoomOutLabel?t.zoomOutLabel:"–",a=void 0!==t.zoomInTipLabel?t.zoomInTipLabel:"Zoom in",h=void 0!==t.zoomOutTipLabel?t.zoomOutTipLabel:"Zoom out",l=document.createElement("button");l.className=n,l.setAttribute("type","button"),l.title=a,l.appendChild("string"==typeof r?document.createTextNode(r):r),l.addEventListener(x,this.handleClick_.bind(this,i),!1);const c=document.createElement("button");c.className=s,c.setAttribute("type","button"),c.title=h,c.appendChild("string"==typeof o?document.createTextNode(o):o),c.addEventListener(x,this.handleClick_.bind(this,-i),!1);const u=e+" "+or+" "+ar,d=this.element;d.className=u,d.appendChild(l),d.appendChild(c),this.duration_=void 0!==t.duration?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const e=this.getMap().getView();if(!e)return;const i=e.getZoom();if(void 0!==i){const n=e.getConstrainedZoom(i+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:n,duration:this.duration_,easing:On})):e.setZoom(n)}}};function ba(t){t=t||{};const e=new ln;return(void 0===t.zoom||t.zoom)&&e.push(new Ca(t.zoomOptions)),(void 0===t.rotate||t.rotate)&&e.push(new Sa(t.rotateOptions)),(void 0===t.attribution||t.attribution)&&e.push(new wa(t.attributionOptions)),e}const Ea="active";function Pa(t,e,i,n){const s=t.getZoom();if(void 0===s)return;const r=t.getConstrainedZoom(s+e),o=t.getResolutionForZoom(r);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:o,anchor:i,duration:void 0!==n?n:250,easing:On})}const Ia=class extends k{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(Ea)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(Ea,t)}setMap(t){this.map_=t}},Ta=class extends Ia{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:250}handleEvent(t){let e=!1;if(t.type==ha.DBLCLICK){const i=t.originalEvent,n=t.map,s=t.coordinate,r=i.shiftKey?-this.delta_:this.delta_;Pa(n.getView(),r,s,this.duration_),i.preventDefault(),e=!0}return!e}};function Ra(t){const e=t.length;let i=0,n=0;for(let s=0;s<e;s++)i+=t[s].clientX,n+=t[s].clientY;return{clientX:i/e,clientY:n/e}}const Aa=class extends Ia{constructor(t){super(t=t||{}),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==ha.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==ha.POINTERUP){const e=this.handleUpEvent(t);this.handlingDownUpSequence=e&&this.targetPointers.length>0}}else if(t.type==ha.POINTERDOWN){const i=this.handleDownEvent(t);this.handlingDownUpSequence=i,e=this.stopDown(i)}else t.type==ha.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}};function Fa(t){const e=arguments;return function(t){let i=!0;for(let n=0,s=e.length;n<s&&(i=i&&e[n](t),i);++n);return i}}const La=function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},ka=function(t){const e=t.map.getTargetElement(),i=e.getRootNode();return!(i instanceof ShadowRoot?i.host:e).hasAttribute("tabindex")||function(t){const e=t.map.getTargetElement(),i=e.getRootNode(),n=t.map.getOwnerDocument().activeElement;return i instanceof ShadowRoot?i.host.contains(n):e.contains(n)}(t)},Oa=c,Da=function(t){const e=t.originalEvent;return 0==e.button&&!(Gs&&js&&e.ctrlKey)},Na=u,Ga=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},ja=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},za=function(t){const e=t.originalEvent,i=e.target.tagName;return"INPUT"!==i&&"SELECT"!==i&&"TEXTAREA"!==i&&!e.target.isContentEditable},Ba=function(t){const e=t.originalEvent;return O(void 0!==e,"mapBrowserEvent must originate from a pointer event"),"mouse"==e.pointerType},Wa=function(t){const e=t.originalEvent;return O(void 0!==e,"mapBrowserEvent must originate from a pointer event"),e.isPrimary&&0===e.button},qa=class extends Aa{constructor(t){super({stopDown:u}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const e=t.condition?t.condition:Fa(Ga,Wa);this.condition_=t.onFocusOnly?Fa(ka,e):e,this.noKinetic_=!1}handleDragEvent(t){const e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());const i=this.targetPointers,n=e.getEventPixel(Ra(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(n[0],n[1]),this.lastCentroid){const e=[this.lastCentroid[0]-n[0],n[1]-this.lastCentroid[1]],i=t.map.getView();s=e,r=i.getResolution(),s[0]*=r,s[1]*=r,he(e,i.getRotation()),i.adjustCenterInternal(e)}}else this.kinetic_&&this.kinetic_.begin();var s,r;this.lastCentroid=n,this.lastPointersCount_=i.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,i=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const t=this.kinetic_.getDistance(),n=this.kinetic_.getAngle(),s=i.getCenterInternal(),r=e.getPixelFromCoordinateInternal(s),o=e.getCoordinateFromPixelInternal([r[0]-t*Math.cos(n),r[1]-t*Math.sin(n)]);i.animateInternal({center:i.getConstrainedCenter(o),duration:500,easing:On})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}},Xa=class extends Aa{constructor(t){t=t||{},super({stopDown:u}),this.condition_=t.condition?t.condition:La,this.lastAngle_=void 0,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){if(!Ba(t))return;const e=t.map,i=e.getView();if(i.getConstraints().rotation===Fn)return;const n=e.getSize(),s=t.pixel,r=Math.atan2(n[1]/2-s[1],s[0]-n[0]/2);if(void 0!==this.lastAngle_){const t=r-this.lastAngle_;i.adjustRotationInternal(-t)}this.lastAngle_=r}handleUpEvent(t){return!Ba(t)||(t.map.getView().endInteraction(this.duration_),!1)}handleDownEvent(t){return!!Ba(t)&&(!(!Da(t)||!this.condition_(t))&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0))}},Ua=class extends s{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,i="px",n=this.element_.style;n.left=Math.min(t[0],e[0])+i,n.top=Math.min(t[1],e[1])+i,n.width=Math.abs(e[0]-t[0])+i,n.height=Math.abs(e[1]-t[1])+i}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const t=this.startPixel_,e=this.endPixel_,i=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new Di([i])}getGeometry(){return this.geometry_}},Va="boxcancel";class Ka extends t{constructor(t,e,i){super(t),this.coordinate=e,this.mapBrowserEvent=i}}const Ya=class extends Aa{constructor(t){super(),this.on,this.once,this.un,t=t??{},this.box_=new Ua(t.className||"ol-dragbox"),this.minArea_=t.minArea??64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition??Da,this.boxEndCondition_=t.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,i){const n=i[0]-e[0],s=i[1]-e[1];return n*n+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.startPixel_&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new Ka("boxdrag",t.coordinate,t)))}handleUpEvent(t){if(!this.startPixel_)return!1;const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new Ka(e?"boxend":Va,t.coordinate,t)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Ka("boxstart",t.coordinate,t)),!0)}onBoxEnd(t){}setActive(t){t||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ka(Va,this.startPixel_,null)),this.startPixel_=null)),super.setActive(t)}setMap(t){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ka(Va,this.startPixel_,null)),this.startPixel_=null)),super.setMap(t)}},Za=class extends Ya{constructor(t){super({condition:(t=t||{}).condition?t.condition:ja,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=void 0!==t.duration?t.duration:200,this.out_=void 0!==t.out&&t.out}onBoxEnd(t){const e=this.getMap().getView();let i=this.getGeometry();if(this.out_){const t=e.rotatedExtentForGeometry(i),n=e.getResolutionForExtentInternal(t),s=e.getResolution()/n;i=i.clone(),i.scale(s*s)}e.fitInternal(i,{duration:this.duration_,easing:On})}},Ha="ArrowLeft",Ja="ArrowRight",$a="ArrowDown",Qa=class extends Ia{constructor(t){super(),t=t||{},this.defaultCondition_=function(t){return Ga(t)&&za(t)},this.condition_=void 0!==t.condition?t.condition:this.defaultCondition_,this.duration_=void 0!==t.duration?t.duration:100,this.pixelDelta_=void 0!==t.pixelDelta?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==M){const i=t.originalEvent,n=i.key;if(this.condition_(t)&&(n==$a||n==Ha||n==Ja||"ArrowUp"==n)){const s=t.map.getView(),r=s.getResolution()*this.pixelDelta_;let o=0,a=0;n==$a?a=-r:n==Ha?o=-r:n==Ja?o=r:a=r;const h=[o,a];he(h,s.getRotation()),function(t,e,i){const n=t.getCenterInternal();if(n){const s=[n[0]+e[0],n[1]+e[1]];t.animateInternal({duration:void 0!==i?i:250,easing:Nn,center:t.getConstrainedCenter(s)})}}(s,h,this.duration_),i.preventDefault(),e=!0}}return!e}},th=class extends Ia{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:function(t){return!function(t){const e=t.originalEvent;return js?e.metaKey:e.ctrlKey}(t)&&za(t)},this.delta_=t.delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:100}handleEvent(t){let e=!1;if(t.type==M||t.type==w){const i=t.originalEvent,n=i.key;if(this.condition_(t)&&("+"===n||"-"===n)){const s=t.map,r="+"===n?this.delta_:-this.delta_;Pa(s.getView(),r,void 0,this.duration_),i.preventDefault(),e=!0}}return!e}},eh=class{constructor(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let i=e-3;for(;i>0&&this.points_[i+2]>t;)i-=3;const n=this.points_[e+2]-this.points_[i+2];if(n<1e3/60)return!1;const s=this.points_[e]-this.points_[i],r=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(r,s),this.initialVelocity_=Math.sqrt(s*s+r*r)/n,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}},ih=class extends Ia{constructor(t){super(t=t||{}),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=void 0!==t.maxDelta?t.maxDelta:1,this.duration_=void 0!==t.duration?t.duration:250,this.timeout_=void 0!==t.timeout?t.timeout:80,this.useAnchor_=void 0===t.useAnchor||t.useAnchor,this.constrainResolution_=void 0!==t.constrainResolution&&t.constrainResolution;const e=t.condition?t.condition:Oa;this.condition_=t.onFocusOnly?Fa(ka,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();t&&t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}handleEvent(t){if(!this.condition_(t))return!0;if(t.type!==C)return!0;const e=t.map,i=t.originalEvent;let n;if(i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==C&&(n=i.deltaY,Ns&&i.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(n/=zs),i.deltaMode===WheelEvent.DOM_DELTA_LINE&&(n*=40)),0===n)return!1;this.lastDelta_=n;const s=Date.now();void 0===this.startTime_&&(this.startTime_=s),(!this.mode_||s-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(n)<4?"trackpad":"wheel");const r=e.getView();if("trackpad"===this.mode_&&!r.getConstrainResolution()&&!this.constrainResolution_)return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(r.getAnimating()&&r.cancelAnimations(),r.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),r.adjustZoom(-n/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=s,!1;this.totalDelta_+=n;const o=Math.max(this.timeout_-(s-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,e),o),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let i=-St(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),Pa(e,i,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}},nh=class extends Aa{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=u),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==t.threshold?t.threshold:.3,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){let e=0;const i=this.targetPointers[0],n=this.targetPointers[1],s=Math.atan2(n.clientY-i.clientY,n.clientX-i.clientX);if(void 0!==this.lastAngle_){const t=s-this.lastAngle_;this.rotationDelta_+=t,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=t}this.lastAngle_=s;const r=t.map,o=r.getView();o.getConstraints().rotation!==Fn&&(this.anchor_=r.getCoordinateFromPixelInternal(r.getEventPixel(Ra(this.targetPointers))),this.rotating_&&(r.render(),o.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){return!(this.targetPointers.length<2)||(t.map.getView().endInteraction(this.duration_),!1)}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}},sh=class extends Aa{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=u),super(e),this.anchor_=null,this.duration_=void 0!==t.duration?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const i=this.targetPointers[0],n=this.targetPointers[1],s=i.clientX-n.clientX,r=i.clientY-n.clientY,o=Math.sqrt(s*s+r*r);void 0!==this.lastDistance_&&(e=this.lastDistance_/o),this.lastDistance_=o;const a=t.map,h=a.getView();1!=e&&(this.lastScaleDelta_=e),this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel(Ra(this.targetPointers))),a.render(),h.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){const e=t.map.getView(),i=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,i),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}};function rh(t){t=t||{};const e=new ln,i=new eh(-.005,.05,100);return(void 0===t.altShiftDragRotate||t.altShiftDragRotate)&&e.push(new Xa),(void 0===t.doubleClickZoom||t.doubleClickZoom)&&e.push(new Ta({delta:t.zoomDelta,duration:t.zoomDuration})),(void 0===t.dragPan||t.dragPan)&&e.push(new qa({onFocusOnly:t.onFocusOnly,kinetic:i})),(void 0===t.pinchRotate||t.pinchRotate)&&e.push(new nh),(void 0===t.pinchZoom||t.pinchZoom)&&e.push(new sh({duration:t.zoomDuration})),(void 0===t.keyboard||t.keyboard)&&(e.push(new Qa),e.push(new th({delta:t.zoomDelta,duration:t.zoomDuration}))),(void 0===t.mouseWheelZoom||t.mouseWheelZoom)&&e.push(new ih({onFocusOnly:t.onFocusOnly,duration:t.zoomDuration})),(void 0===t.shiftDragZoom||t.shiftDragZoom)&&e.push(new Za({duration:t.zoomDuration})),e}function oh(t){t instanceof qn?t.setMapInternal(null):t instanceof ra&&t.getLayers().forEach(oh)}function ah(t,e){if(t instanceof qn)t.setMapInternal(e);else if(t instanceof ra){const i=t.getLayers().getArray();for(let t=0,n=i.length;t<n;++t)ah(i[t],e)}}const hh=class extends k{constructor(t){super(),t=t||{},this.on,this.once,this.un;const e=function(t){let e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);const i={},n=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new ra({layers:t.layers});let s,r,o;return i[fa]=n,i[_a]=t.target,i[ma]=t.view instanceof Bn?t.view:new Bn,void 0!==t.controls&&(Array.isArray(t.controls)?s=new ln(t.controls.slice()):(O("function"==typeof t.controls.getArray,"Expected `controls` to be an array or an `ol/Collection.js`"),s=t.controls)),void 0!==t.interactions&&(Array.isArray(t.interactions)?r=new ln(t.interactions.slice()):(O("function"==typeof t.interactions.getArray,"Expected `interactions` to be an array or an `ol/Collection.js`"),r=t.interactions)),void 0!==t.overlays?Array.isArray(t.overlays)?o=new ln(t.overlays.slice()):(O("function"==typeof t.overlays.getArray,"Expected `overlays` to be an array or an `ol/Collection.js`"),o=t.overlays):o=new ln,{controls:s,interactions:r,keyboardEventTarget:e,overlays:o,values:i}}(t);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=void 0!==t.maxTilesLoading?t.maxTilesLoading:16,this.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:zs,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=[1,0,0,1,0,0],this.pixelToCoordinateTransform_=[1,0,0,1,0,0],this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver((()=>this.updateSize())),this.controls=e.controls||ba(),this.interactions=e.interactions||rh({onFocusOnly:!0}),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new xa(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(fa,this.handleLayerGroupChanged_),this.addChangeListener(ma,this.handleViewChanged_),this.addChangeListener(pa,this.handleSizeChanged_),this.addChangeListener(_a,this.handleTargetChanged_),this.setProperties(e.values);const i=this;!t.view||t.view instanceof Bn||t.view.then((function(t){i.setView(new Bn(t))})),this.controls.addEventListener(rn,(t=>{t.element.setMap(this)})),this.controls.addEventListener(on,(t=>{t.element.setMap(null)})),this.interactions.addEventListener(rn,(t=>{t.element.setMap(this)})),this.interactions.addEventListener(on,(t=>{t.element.setMap(null)})),this.overlays_.addEventListener(rn,(t=>{this.addOverlayInternal_(t.element)})),this.overlays_.addEventListener(on,(t=>{const e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)})),this.controls.forEach((t=>{t.setMap(this)})),this.interactions.forEach((t=>{t.setMap(this)})),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){ah(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,i){if(!this.frameState_||!this.renderer_)return;const n=this.getCoordinateFromPixelInternal(t),s=void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance:0,r=void 0!==i.layerFilter?i.layerFilter:c,o=!1!==i.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,s,o,e,null,r,null)}getFeaturesAtPixel(t,e){const i=[];return this.forEachFeatureAtPixel(t,(function(t){i.push(t)}),e),i}getAllLayers(){const t=[];return function e(i){i.forEach((function(i){i instanceof ra?e(i.getLayers()):t.push(i)}))}(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(t),n=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:c,s=void 0!==e.hitTolerance?e.hitTolerance:0,r=!1!==e.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,r,n,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const e=this.viewport_.getBoundingClientRect(),i=this.getSize(),n=e.width/i[0],s=e.height/i[1],r="changedTouches"in t?t.changedTouches[0]:t;return[(r.clientX-e.left)/n,(r.clientY-e.top)/s]}getTarget(){return this.get(_a)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return De(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?G(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(fa)}setLayers(t){const e=this.getLayerGroup();if(t instanceof ln)return void e.setLayers(t);const i=e.getLayers();i.clear(),i.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const i=t[e];if(!i.visible)continue;const n=i.layer.getRenderer();if(n&&!n.ready)return!0;const s=i.layer.getSource();if(s&&s.loading)return!0}return!1}getPixelFromCoordinate(t){const e=Ne(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?G(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(pa)}getView(){return this.get(ma)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,i,n){return function(t,e,i,n,s){if(!t||!(i in t.wantedTiles))return ya;if(!t.wantedTiles[i][e.getKey()])return ya;const r=t.viewState.center,o=n[0]-r[0],a=n[1]-r[1];return 65536*Math.log(s)+Math.sqrt(o*o+a*a)/s}(this.frameState_,t,e,i,n)}handleBrowserEvent(t,e){e=e||t.type;const i=new aa(e,this,t);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,i=e.type;if(i===la||i===C||i===M){const t=this.getOwnerDocument(),i=this.viewport_.getRootNode?this.viewport_.getRootNode():t,n=e.target,s=i instanceof ShadowRoot?i.host===n?i.host.ownerDocument:i:i===t?t.documentElement:i;if(this.overlayContainerStopEvent_.contains(n)||!s.contains(n))return}if(t.frameState=this.frameState_,!1!==this.dispatchEvent(t)){const e=this.getInteractions().getArray().slice();for(let i=e.length-1;i>=0;i--){const n=e[i];if(n.getMap()===this&&n.getActive()&&this.getTargetElement()&&(!n.handleEvent(t)||t.propagationStopped))break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let i=this.maxTilesLoading_,n=i;if(t){const e=t.viewHints;if(e[0]||e[1]){const e=Date.now()-t.time>8;i=e?0:8,n=e?0:2}}e.getTilesLoading()<i&&(e.reprioritize(),e.loadMoreTiles(i,n))}t&&this.renderer_&&!t.animate&&(this.renderComplete_?(this.hasListener(Sn)&&this.renderer_.dispatchRenderEvent(Sn,t),!1===this.loaded_&&(this.loaded_=!0,this.dispatchEvent(new oa(ga,this,t)))):!0===this.loaded_&&(this.loaded_=!1,this.dispatchEvent(new oa(da,this,t))));const i=this.postRenderFunctions_;for(let e=0,n=i.length;e<n;++e)i[e](this,t);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let t=0,e=this.targetChangeHandlerKeys_.length;t<e;++t)P(this.targetChangeHandlerKeys_[t]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(v,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(C,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const t=this.targetElement_.getRootNode();t instanceof ShadowRoot&&this.resizeObserver_.unobserve(t.host),this.setSize(void 0)}const t=this.getTarget(),e="string"==typeof t?document.getElementById(t):t;if(this.targetElement_=e,e){e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new ea(this)),this.mapBrowserEventHandler_=new ca(this,this.moveTolerance_);for(const t in ha)this.mapBrowserEventHandler_.addEventListener(ha[t],this.handleMapBrowserEvent.bind(this));let t;if(this.viewport_.addEventListener(v,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(C,this.boundHandleBrowserEvent_,!!Xs&&{passive:!1}),this.keyboardEventTarget_)t=this.keyboardEventTarget_;else{const i=e.getRootNode();t=i instanceof ShadowRoot?i.host:e}this.targetChangeHandlerKeys_=[b(t,M,this.handleBrowserEvent,this),b(t,w,this.handleBrowserEvent,this)];const i=e.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.observe(i.host),this.resizeObserver_.observe(e)}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(P(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(P(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=b(t,e,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=b(t,y,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(P),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.handleLayerAdd_(new ia("addlayer",t)),this.layerGroupPropertyListenerKeys_=[b(t,e,this.render,this),b(t,y,this.render,this),b(t,"addlayer",this.handleLayerAdd_,this),b(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const i=t[e].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){oh(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),i=this.getView(),n=this.frameState_;let s=null;if(void 0!==e&&ds(e)&&i&&i.isDef()){const n=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),r=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:gt(r.center,r.resolution,r.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:r,viewHints:n,wantedTiles:{},mapId:F(this),renderTargets:{}},r.nextCenter&&r.nextResolution){const t=isNaN(r.nextRotation)?r.rotation:r.nextRotation;s.nextExtent=gt(r.nextCenter,r.nextResolution,t,e)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),n&&(!this.previousExtent_||!xt(this.previousExtent_)&&!it(s.extent,this.previousExtent_))&&(this.dispatchEvent(new oa("movestart",this,n)),this.previousExtent_=Q(this.previousExtent_)),this.previousExtent_&&!s.viewHints[0]&&!s.viewHints[1]&&!it(s.extent,this.previousExtent_)&&(this.dispatchEvent(new oa("moveend",this,s)),U(s.extent,this.previousExtent_))),this.dispatchEvent(new oa(ua,this,s)),this.renderComplete_=(this.hasListener(da)||this.hasListener(ga)||this.hasListener(Sn))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout((()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()}),0))}setLayerGroup(t){const e=this.getLayerGroup();e&&this.handleLayerRemove_(new ia("removelayer",e)),this.set(fa,t)}setSize(t){this.set(pa,t)}setTarget(t){this.set(_a,t)}setView(t){if(!t||t instanceof Bn)return void this.set(ma,t);this.set(ma,new Bn);const e=this;t.then((function(t){e.setView(new Bn(t))}))}updateSize(){const t=this.getTargetElement();let e;if(t){const i=getComputedStyle(t),n=t.offsetWidth-parseFloat(i.borderLeftWidth)-parseFloat(i.paddingLeft)-parseFloat(i.paddingRight)-parseFloat(i.borderRightWidth),s=t.offsetHeight-parseFloat(i.borderTopWidth)-parseFloat(i.paddingTop)-parseFloat(i.paddingBottom)-parseFloat(i.borderBottomWidth);isNaN(n)||isNaN(s)||(e=[Math.max(0,n),Math.max(0,s)],!ds(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&me("No map visible because the map container's width or height are 0."))}const i=this.getSize();!e||i&&l(e,i)||(this.setSize(e),this.updateViewportSize_(e))}updateViewportSize_(t){const e=this.getView();e&&e.setViewportSize(t)}},lh=class{constructor(t){this.rbush_=new Kn(t),this.items_={}}insert(t,e){const i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[F(e)]=i}load(t,e){const i=new Array(e.length);for(let n=0,s=e.length;n<s;n++){const s=t[n],r=e[n],o={minX:s[0],minY:s[1],maxX:s[2],maxY:s[3],value:r};i[n]=o,this.items_[F(r)]=o}this.rbush_.load(i)}remove(t){const e=F(t),i=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(i)}update(t,e){const i=this.items_[F(e)];it([i.minX,i.minY,i.maxX,i.maxY],t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map((function(t){return t.value}))}getInExtent(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map((function(t){return t.value}))}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let i;for(let n=0,s=t.length;n<s;n++)if(i=e(t[n]),i)return i;return i}isEmpty(){return _(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return J(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}};function ch(t){return t?"function"==typeof t?t:(Array.isArray(t)||(t=[t]),e=>t):null}const uh=class extends k{constructor(t){super(),this.projection=Se(t.projection),this.attributions_=ch(t.attributions),this.attributionsCollapsible_=t.attributionsCollapsible??!0,this.loading=!1,this.state_=void 0!==t.state?t.state:"ready",this.wrapX_=void 0!==t.wrapX&&t.wrapX,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise((function(t,i){e.viewResolver=t,e.viewRejector=i}))}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=ch(t),this.changed()}setState(t){this.state_=t,this.changed()}},dh="addfeature",gh="removefeature";function fh(t,e){return[[-1/0,-1/0,1/0,1/0]]}function ph(t,e){return function(i,n,s,r,o){const a=this;!function(t,e,i,n,s,r,o){const a=new XMLHttpRequest;a.open("GET","function"==typeof t?t(i,n,s):t,!0),"arraybuffer"==e.getType()&&(a.responseType="arraybuffer"),a.withCredentials=false,a.onload=function(t){if(!a.status||a.status>=200&&a.status<300){const t=e.getType();try{let n;"text"==t||"json"==t?n=a.responseText:"xml"==t?n=a.responseXML||a.responseText:"arraybuffer"==t&&(n=a.response),n?r(e.readFeatures(n,{extent:i,featureProjection:s}),e.readProjection(n)):o()}catch{o()}}else o()},a.onerror=o,a.send()}(t,e,i,n,s,(function(t,e){a.addFeatures(t),void 0!==r&&r(t)}),o||d)}}class _h extends t{constructor(t,e,i){super(t),this.feature=e,this.features=i}}const mh=class extends uh{constructor(t){super({attributions:(t=t||{}).attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:void 0===t.wrapX||t.wrapX}),this.on,this.once,this.un,this.loader_=d,this.format_=t.format||null,this.overlaps_=void 0===t.overlaps||t.overlaps,this.url_=t.url,void 0!==t.loader?this.loader_=t.loader:void 0!==this.url_&&(O(this.format_,"`format` must be set when `url` is set"),this.loader_=ph(this.url_,this.format_)),this.strategy_=void 0!==t.strategy?t.strategy:fh;const e=void 0===t.useSpatialIndex||t.useSpatialIndex;let i,n;this.featuresRtree_=e?new lh:null,this.loadedExtentsRtree_=new lh,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,Array.isArray(t.features)?n=t.features:t.features&&(i=t.features,n=i.getArray()),e||void 0!==i||(i=new ln(n)),void 0!==n&&this.addFeaturesInternal(n),void 0!==i&&this.bindFeaturesCollection_(i)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=F(t);if(!this.addToIndex_(e,t))return void(this.featuresCollection_&&this.featuresCollection_.remove(t));this.setupChangeEvents_(e,t);const i=t.getGeometry();if(i){const e=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(e,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new _h(dh,t))}setupChangeEvents_(t,i){i instanceof si||(this.featureChangeKeys_[t]=[b(i,y,this.handleFeatureChange_,this),b(i,e,this.handleFeatureChange_,this)])}addToIndex_(t,e){let i=!0;if(void 0!==e.getId()){const t=String(e.getId());if(t in this.idIndex_)if(e instanceof si){const n=this.idIndex_[t];n instanceof si?Array.isArray(n)?n.push(e):this.idIndex_[t]=[n,e]:i=!1}else i=!1;else this.idIndex_[t]=e}return i&&(O(!(t in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[t]=e),i}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],i=[],n=[];for(let e=0,n=t.length;e<n;e++){const n=t[e],s=F(n);this.addToIndex_(s,n)&&i.push(n)}for(let t=0,s=i.length;t<s;t++){const s=i[t],r=F(s);this.setupChangeEvents_(r,s);const o=s.getGeometry();if(o){const t=o.getExtent();e.push(t),n.push(s)}else this.nullGeometryFeatures_[r]=s}if(this.featuresRtree_&&this.featuresRtree_.load(e,n),this.hasListener(dh))for(let t=0,e=i.length;t<e;t++)this.dispatchEvent(new _h(dh,i[t]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener(dh,(function(i){e||(e=!0,t.push(i.feature),e=!1)})),this.addEventListener(gh,(function(i){e||(e=!0,t.remove(i.feature),e=!1)})),t.addEventListener(rn,(t=>{e||(e=!0,this.addFeature(t.element),e=!1)})),t.addEventListener(on,(t=>{e||(e=!0,this.removeFeature(t.element),e=!1)})),this.featuresCollection_=t}clear(t){if(t){for(const t in this.featureChangeKeys_)this.featureChangeKeys_[t].forEach(P);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){const t=t=>{this.removeFeatureInternal(t)};this.featuresRtree_.forEach(t);for(const t in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[t])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new _h("clear");this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){const i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,(function(i){const n=i.getGeometry();if(n instanceof si||n.intersectsCoordinate(t))return e(i)}))}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,(function(i){const n=i.getGeometry();if(n instanceof si||n.intersectsExtent(t)){const t=e(i);if(t)return t}}))}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),_(this.nullGeometryFeatures_)||h(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,(function(t){e.push(t)})),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const i=wt(t,e);return[].concat(...i.map((t=>this.featuresRtree_.getInExtent(t))))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){const i=t[0],n=t[1];let s=null;const r=[NaN,NaN];let o=1/0;const a=[-1/0,-1/0,1/0,1/0];return e=e||c,this.featuresRtree_.forEachInExtent(a,(function(t){if(e(t)){const e=t.getGeometry(),h=o;if(o=e instanceof si?0:e.closestPointXY(i,n,r,o),o<h){s=t;const e=Math.sqrt(o);a[0]=i-e,a[1]=n-e,a[2]=i+e,a[3]=n+e}}})),s}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const e=this.idIndex_[t.toString()];return void 0!==e?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return void 0!==e?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,i=F(e),n=e.getGeometry();if(n){const t=n.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(t,e)):this.featuresRtree_&&this.featuresRtree_.update(t,e)}else i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);const s=e.getId();if(void 0!==s){const t=s.toString();this.idIndex_[t]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[t]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[i]=e;this.changed(),this.dispatchEvent(new _h("changefeature",e))}hasFeature(t){const e=t.getId();return void 0!==e?e in this.idIndex_:F(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&_(this.nullGeometryFeatures_):!this.featuresCollection_||0===this.featuresCollection_.getLength()}loadFeatures(t,e,i){const n=this.loadedExtentsRtree_,s=this.strategy_(t,e,i);for(let t=0,r=s.length;t<r;++t){const r=s[t];n.forEachInExtent(r,(function(t){return Y(t.extent,r)}))||(++this.loadingExtentsCount_,this.dispatchEvent(new _h("featuresloadstart")),this.loader_.call(this,r,e,i,(t=>{--this.loadingExtentsCount_,this.dispatchEvent(new _h("featuresloadend",void 0,t))}),(()=>{--this.loadingExtentsCount_,this.dispatchEvent(new _h("featuresloaderror"))})),n.insert(r,{extent:r.slice()}))}this.loading=!(this.loader_.length<4)&&this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_;let i;e.forEachInExtent(t,(function(e){if(it(e.extent,t))return i=e,!0})),i&&e.remove(i)}removeFeatures(t){let e=!1;for(let i=0,n=t.length;i<n;++i)e=this.removeFeatureInternal(t[i])||e;e&&this.changed()}removeFeature(t){t&&this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=F(t);if(!(e in this.uidIndex_))return!1;e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t);const i=this.featureChangeKeys_[e];i?.forEach(P),delete this.featureChangeKeys_[e];const n=t.getId();if(void 0!==n){const e=n.toString(),i=this.idIndex_[e];i===t?delete this.idIndex_[e]:Array.isArray(i)&&(i.splice(i.indexOf(t),1),1===i.length&&(this.idIndex_[e]=i[0]))}return delete this.uidIndex_[e],this.hasListener(gh)&&this.dispatchEvent(new _h(gh,t)),!0}removeFromIdIndex_(t){for(const e in this.idIndex_)if(this.idIndex_[e]===t){delete this.idIndex_[e];break}}setLoader(t){this.loader_=t}setUrl(t){O(this.format_,"`format` must be set when `url` is set"),this.url_=t,this.setLoader(ph(t,this.format_))}};var yh=1,vh=2,xh=3,Mh=5,wh=6378137,Sh=6356752.314,Ch=.0066943799901413165,bh=484813681109536e-20,Eh=Math.PI/2,Ph=1e-10,Ih=.017453292519943295,Th=57.29577951308232,Rh=Math.PI/4,Ah=2*Math.PI,Fh=3.14159265359,Lh={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667};const kh={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}};var Oh=/[\s_\-\/\(\)]/g;function Dh(t,e){if(t[e])return t[e];for(var i,n=Object.keys(t),s=e.toLowerCase().replace(Oh,""),r=-1;++r<n.length;)if((i=n[r]).toLowerCase().replace(Oh,"")===s)return t[i]}function Nh(t){var e,i,n,s={},r=t.split("+").map((function(t){return t.trim()})).filter((function(t){return t})).reduce((function(t,e){var i=e.split("=");return i.push(!0),t[i[0].toLowerCase()]=i[1],t}),{}),o={proj:"projName",datum:"datumCode",rf:function(t){s.rf=parseFloat(t)},lat_0:function(t){s.lat0=t*Ih},lat_1:function(t){s.lat1=t*Ih},lat_2:function(t){s.lat2=t*Ih},lat_ts:function(t){s.lat_ts=t*Ih},lon_0:function(t){s.long0=t*Ih},lon_1:function(t){s.long1=t*Ih},lon_2:function(t){s.long2=t*Ih},alpha:function(t){s.alpha=parseFloat(t)*Ih},gamma:function(t){s.rectified_grid_angle=parseFloat(t)},lonc:function(t){s.longc=t*Ih},x_0:function(t){s.x0=parseFloat(t)},y_0:function(t){s.y0=parseFloat(t)},k_0:function(t){s.k0=parseFloat(t)},k:function(t){s.k0=parseFloat(t)},a:function(t){s.a=parseFloat(t)},b:function(t){s.b=parseFloat(t)},r:function(t){s.a=s.b=parseFloat(t)},r_a:function(){s.R_A=!0},zone:function(t){s.zone=parseInt(t,10)},south:function(){s.utmSouth=!0},towgs84:function(t){s.datum_params=t.split(",").map((function(t){return parseFloat(t)}))},to_meter:function(t){s.to_meter=parseFloat(t)},units:function(t){s.units=t;var e=Dh(kh,t);e&&(s.to_meter=e.to_meter)},from_greenwich:function(t){s.from_greenwich=t*Ih},pm:function(t){var e=Dh(Lh,t);s.from_greenwich=(e||parseFloat(t))*Ih},nadgrids:function(t){"@null"===t?s.datumCode="none":s.nadgrids=t},axis:function(t){var e="ewnsud";3===t.length&&-1!==e.indexOf(t.substr(0,1))&&-1!==e.indexOf(t.substr(1,1))&&-1!==e.indexOf(t.substr(2,1))&&(s.axis=t)},approx:function(){s.approx=!0}};for(e in r)i=r[e],e in o?"function"==typeof(n=o[e])?n(i):s[n]=i:s[e]=i;return"string"==typeof s.datumCode&&"WGS84"!==s.datumCode&&(s.datumCode=s.datumCode.toLowerCase()),s}const Gh=function(t){return new Uh(t).output()};var jh=1,zh=/\s/,Bh=/[A-Za-z]/,Wh=/[A-Za-z84_]/,qh=/[,\]]/,Xh=/[\d\.E\-\+]/;function Uh(t){if("string"!=typeof t)throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=jh}function Vh(t,e,i){Array.isArray(e)&&(i.unshift(e),e=null);var n=e?{}:t,s=i.reduce((function(t,e){return Kh(e,t),t}),n);e&&(t[e]=s)}function Kh(t,e){if(Array.isArray(t)){var i=t.shift();if("PARAMETER"===i&&(i=t.shift()),1===t.length)return Array.isArray(t[0])?(e[i]={},void Kh(t[0],e[i])):void(e[i]=t[0]);if(t.length)if("TOWGS84"!==i){if("AXIS"===i)return i in e||(e[i]=[]),void e[i].push(t);var n;switch(Array.isArray(i)||(e[i]={}),i){case"UNIT":case"PRIMEM":case"VERT_DATUM":return e[i]={name:t[0].toLowerCase(),convert:t[1]},void(3===t.length&&Kh(t[2],e[i]));case"SPHEROID":case"ELLIPSOID":return e[i]={name:t[0],a:t[1],rf:t[2]},void(4===t.length&&Kh(t[3],e[i]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return t[0]=["name",t[0]],void Vh(e,i,t);default:for(n=-1;++n<t.length;)if(!Array.isArray(t[n]))return Kh(t,e[i]);return Vh(e,i,t)}}else e[i]=t;else e[i]=!0}else e[t]=!0}Uh.prototype.readCharicter=function(){var t=this.text[this.place++];if(4!==this.state)for(;zh.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case jh:return this.neutral(t);case 2:return this.keyword(t);case 4:return this.quoted(t);case 5:return this.afterquote(t);case 3:return this.number(t);case-1:return}},Uh.prototype.afterquote=function(t){if('"'===t)return this.word+='"',void(this.state=4);if(qh.test(t))return this.word=this.word.trim(),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in afterquote yet, index '+this.place)},Uh.prototype.afterItem=function(t){return","===t?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=jh)):"]"===t?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=jh,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},Uh.prototype.number=function(t){if(!Xh.test(t)){if(qh.test(t))return this.word=parseFloat(this.word),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in number yet, index '+this.place)}this.word+=t},Uh.prototype.quoted=function(t){'"'!==t?this.word+=t:this.state=5},Uh.prototype.keyword=function(t){if(Wh.test(t))this.word+=t;else{if("["===t){var e=[];return e.push(this.word),this.level++,null===this.root?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,void(this.state=jh)}if(!qh.test(t))throw new Error("havn't handled \""+t+'" in keyword yet, index '+this.place);this.afterItem(t)}},Uh.prototype.neutral=function(t){if(Bh.test(t))return this.word=t,void(this.state=2);if('"'===t)return this.word="",void(this.state=4);if(Xh.test(t))return this.word=t,void(this.state=3);if(!qh.test(t))throw new Error("havn't handled \""+t+'" in neutral yet, index '+this.place);this.afterItem(t)},Uh.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};var Yh=.017453292519943295;function Zh(t){return t*Yh}function Hh(t){var e=Gh(t),i=e.shift(),n=e.shift();e.unshift(["name",n]),e.unshift(["type",i]);var s={};return Kh(e,s),function(t){if("GEOGCS"===t.type?t.projName="longlat":"LOCAL_CS"===t.type?(t.projName="identity",t.local=!0):"object"==typeof t.PROJECTION?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.AXIS){for(var e="",i=0,n=t.AXIS.length;i<n;++i){var s=[t.AXIS[i][0].toLowerCase(),t.AXIS[i][1].toLowerCase()];-1!==s[0].indexOf("north")||("y"===s[0]||"lat"===s[0])&&"north"===s[1]?e+="n":-1!==s[0].indexOf("south")||("y"===s[0]||"lat"===s[0])&&"south"===s[1]?e+="s":-1!==s[0].indexOf("east")||("x"===s[0]||"lon"===s[0])&&"east"===s[1]?e+="e":-1===s[0].indexOf("west")&&("x"!==s[0]&&"lon"!==s[0]||"west"!==s[1])||(e+="w")}2===e.length&&(e+="u"),3===e.length&&(t.axis=e)}t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),"metre"===t.units&&(t.units="meter"),t.UNIT.convert&&("GEOGCS"===t.type?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var r=t.GEOGCS;function o(e){return e*(t.to_meter||1)}"GEOGCS"===t.type&&(r=t),r&&(r.DATUM?t.datumCode=r.DATUM.name.toLowerCase():t.datumCode=r.name.toLowerCase(),"d_"===t.datumCode.slice(0,2)&&(t.datumCode=t.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==t.datumCode&&"new_zealand_1949"!==t.datumCode||(t.datumCode="nzgd49"),"wgs_1984"!==t.datumCode&&"world_geodetic_system_1984"!==t.datumCode||("Mercator_Auxiliary_Sphere"===t.PROJECTION&&(t.sphere=!0),t.datumCode="wgs84"),"_ferro"===t.datumCode.slice(-6)&&(t.datumCode=t.datumCode.slice(0,-6)),"_jakarta"===t.datumCode.slice(-8)&&(t.datumCode=t.datumCode.slice(0,-8)),~t.datumCode.indexOf("belge")&&(t.datumCode="rnb72"),r.DATUM&&r.DATUM.SPHEROID&&(t.ellps=r.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===t.ellps.toLowerCase().slice(0,13)&&(t.ellps="intl"),t.a=r.DATUM.SPHEROID.a,t.rf=parseFloat(r.DATUM.SPHEROID.rf,10)),r.DATUM&&r.DATUM.TOWGS84&&(t.datum_params=r.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),"ch1903+"===t.datumCode&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Zh],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Zh],["x0","false_easting",o],["y0","false_northing",o],["long0","central_meridian",Zh],["lat0","latitude_of_origin",Zh],["lat0","standard_parallel_1",Zh],["lat1","standard_parallel_1",Zh],["lat2","standard_parallel_2",Zh],["azimuth","Azimuth"],["alpha","azimuth",Zh],["srsCode","name"]].forEach((function(e){return function(t,e){var i=e[0],n=e[1];!(i in t)&&n in t&&(t[i]=t[n],3===e.length&&(t[i]=e[2](t[i])))}(t,e)})),t.long0||!t.longc||"Albers_Conic_Equal_Area"!==t.projName&&"Lambert_Azimuthal_Equal_Area"!==t.projName||(t.long0=t.longc),t.lat_ts||!t.lat1||"Stereographic_South_Pole"!==t.projName&&"Polar Stereographic (variant B)"!==t.projName?!t.lat_ts&&t.lat0&&"Polar_Stereographic"===t.projName&&(t.lat_ts=t.lat0,t.lat0=Zh(t.lat0>0?90:-90)):(t.lat0=Zh(t.lat1>0?90:-90),t.lat_ts=t.lat1)}(s),s}function Jh(t){var e=this;if(2===arguments.length){var i=arguments[1];"string"==typeof i?"+"===i.charAt(0)?Jh[t]=Nh(arguments[1]):Jh[t]=Hh(arguments[1]):Jh[t]=i}else if(1===arguments.length){if(Array.isArray(t))return t.map((function(t){Array.isArray(t)?Jh.apply(e,t):Jh(t)}));if("string"==typeof t){if(t in Jh)return Jh[t]}else"EPSG"in t?Jh["EPSG:"+t.EPSG]=t:"ESRI"in t?Jh["ESRI:"+t.ESRI]=t:"IAU2000"in t?Jh["IAU2000:"+t.IAU2000]=t:console.log(t);return}}!function(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}(Jh);const $h=Jh;var Qh=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"],tl=["3857","900913","3785","102113"];function el(t,e){var i,n;if(t=t||{},!e)return t;for(n in e)void 0!==(i=e[n])&&(t[n]=i);return t}function il(t,e,i){var n=t*e;return i/Math.sqrt(1-n*n)}function nl(t){return t<0?-1:1}function sl(t){return Math.abs(t)<=Fh?t:t-nl(t)*Ah}function rl(t,e,i){var n=t*i,s=.5*t;return n=Math.pow((1-n)/(1+n),s),Math.tan(.5*(Eh-e))/n}function ol(t,e){for(var i,n,s=.5*t,r=Eh-2*Math.atan(e),o=0;o<=15;o++)if(i=t*Math.sin(r),r+=n=Eh-2*Math.atan(e*Math.pow((1-i)/(1+i),s))-r,Math.abs(n)<=1e-10)return r;return-9999}function al(t){return t}var hl=[{init:function(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=il(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function(t){var e,i,n=t.x,s=t.y;if(s*Th>90&&s*Th<-90&&n*Th>180&&n*Th<-180)return null;if(Math.abs(Math.abs(s)-Eh)<=Ph)return null;if(this.sphere)e=this.x0+this.a*this.k0*sl(n-this.long0),i=this.y0+this.a*this.k0*Math.log(Math.tan(Rh+.5*s));else{var r=Math.sin(s),o=rl(this.e,s,r);e=this.x0+this.a*this.k0*sl(n-this.long0),i=this.y0-this.a*this.k0*Math.log(o)}return t.x=e,t.y=i,t},inverse:function(t){var e,i,n=t.x-this.x0,s=t.y-this.y0;if(this.sphere)i=Eh-2*Math.atan(Math.exp(-s/(this.a*this.k0)));else{var r=Math.exp(-s/(this.a*this.k0));if(-9999===(i=ol(this.e,r)))return null}return e=sl(this.long0+n/(this.a*this.k0)),t.x=e,t.y=i,t},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:al,inverse:al,names:["longlat","identity"]}],ll={},cl=[];function ul(t,e){var i=cl.length;return t.names?(cl[i]=t,t.names.forEach((function(t){ll[t.toLowerCase()]=i})),this):(console.log(e),!0)}const dl={start:function(){hl.forEach(ul)},add:ul,get:function(t){if(!t)return!1;var e=t.toLowerCase();return void 0!==ll[e]&&cl[ll[e]]?cl[ll[e]]:void 0}};var gl={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:6378249.2,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},fl=gl.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};gl.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var pl={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},militargeographische_institut:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}};var _l={};function ml(t){if(0===t.length)return null;var e="@"===t[0];return e&&(t=t.slice(1)),"null"===t?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:t,mandatory:!e,grid:_l[t]||null,isNull:!1}}function yl(t){return t/3600*Math.PI/180}function vl(t,e,i){return String.fromCharCode.apply(null,new Uint8Array(t.buffer.slice(e,i)))}function xl(t){return t.map((function(t){return[yl(t.longitudeShift),yl(t.latitudeShift)]}))}function Ml(t,e,i){return{name:vl(t,e+8,e+16).trim(),parent:vl(t,e+24,e+24+8).trim(),lowerLatitude:t.getFloat64(e+72,i),upperLatitude:t.getFloat64(e+88,i),lowerLongitude:t.getFloat64(e+104,i),upperLongitude:t.getFloat64(e+120,i),latitudeInterval:t.getFloat64(e+136,i),longitudeInterval:t.getFloat64(e+152,i),gridNodeCount:t.getInt32(e+168,i)}}function wl(t,e,i,n){for(var s=e+176,r=[],o=0;o<i.gridNodeCount;o++){var a={latitudeShift:t.getFloat32(s+16*o,n),longitudeShift:t.getFloat32(s+16*o+4,n),latitudeAccuracy:t.getFloat32(s+16*o+8,n),longitudeAccuracy:t.getFloat32(s+16*o+12,n)};r.push(a)}return r}function Sl(t,e){if(!(this instanceof Sl))return new Sl(t);e=e||function(t){if(t)throw t};var i=function(t){if(!function(t){return"string"==typeof t}(t))return t;if(function(t){return t in $h}(t))return $h[t];if(function(t){return Qh.some((function(e){return t.indexOf(e)>-1}))}(t)){var e=Hh(t);if(function(t){var e=Dh(t,"authority");if(e){var i=Dh(e,"epsg");return i&&tl.indexOf(i)>-1}}(e))return $h["EPSG:3857"];var i=function(t){var e=Dh(t,"extension");if(e)return Dh(e,"proj4")}(e);return i?Nh(i):e}return function(t){return"+"===t[0]}(t)?Nh(t):void 0}(t);if("object"==typeof i){var n=Sl.projections.get(i.projName);if(n){if(i.datumCode&&"none"!==i.datumCode){var s=Dh(pl,i.datumCode);s&&(i.datum_params=i.datum_params||(s.towgs84?s.towgs84.split(","):null),i.ellps=s.ellipse,i.datumName=s.datumName?s.datumName:i.datumCode)}i.k0=i.k0||1,i.axis=i.axis||"enu",i.ellps=i.ellps||"wgs84",i.lat1=i.lat1||i.lat0;var r,o,a,h,l,c,u=function(t,e,i,n,s){if(!t){var r=Dh(gl,n);r||(r=fl),t=r.a,e=r.b,i=r.rf}return i&&!e&&(e=(1-1/i)*t),(0===i||Math.abs(t-e)<Ph)&&(s=!0,e=t),{a:t,b:e,rf:i,sphere:s}}(i.a,i.b,i.rf,i.ellps,i.sphere),d=(r=u.a,o=u.b,u.rf,l=((a=r*r)-(h=o*o))/a,c=0,i.R_A?(a=(r*=1-l*(.16666666666666666+l*(.04722222222222222+.022156084656084655*l)))*r,l=0):c=Math.sqrt(l),{es:l,e:c,ep2:(a-h)/h}),g=function(t){return void 0===t?null:t.split(",").map(ml)}(i.nadgrids),f=i.datum||function(t,e,i,n,s,r,o){var a={};return a.datum_type=void 0===t||"none"===t?Mh:4,e&&(a.datum_params=e.map(parseFloat),0===a.datum_params[0]&&0===a.datum_params[1]&&0===a.datum_params[2]||(a.datum_type=yh),a.datum_params.length>3&&(0===a.datum_params[3]&&0===a.datum_params[4]&&0===a.datum_params[5]&&0===a.datum_params[6]||(a.datum_type=vh,a.datum_params[3]*=bh,a.datum_params[4]*=bh,a.datum_params[5]*=bh,a.datum_params[6]=a.datum_params[6]/1e6+1))),o&&(a.datum_type=xh,a.grids=o),a.a=i,a.b=n,a.es=s,a.ep2=r,a}(i.datumCode,i.datum_params,u.a,u.b,d.es,d.ep2,g);el(this,i),el(this,n),this.a=u.a,this.b=u.b,this.rf=u.rf,this.sphere=u.sphere,this.es=d.es,this.e=d.e,this.ep2=d.ep2,this.datum=f,this.init(),e(null,this)}else e("Could not get projection name from: "+t)}else e("Could not parse to valid json: "+t)}Sl.projections=dl,Sl.projections.start();const Cl=Sl;function bl(t,e,i){var n,s,r,o,a=t.x,h=t.y,l=t.z?t.z:0;if(h<-Eh&&h>-1.001*Eh)h=-Eh;else if(h>Eh&&h<1.001*Eh)h=Eh;else{if(h<-Eh)return{x:-1/0,y:-1/0,z:t.z};if(h>Eh)return{x:1/0,y:1/0,z:t.z}}return a>Math.PI&&(a-=2*Math.PI),s=Math.sin(h),o=Math.cos(h),r=s*s,{x:((n=i/Math.sqrt(1-e*r))+l)*o*Math.cos(a),y:(n+l)*o*Math.sin(a),z:(n*(1-e)+l)*s}}function El(t,e,i,n){var s,r,o,a,h,l,c,u,d,g,f,p,_,m,y,v=t.x,x=t.y,M=t.z?t.z:0;if(s=Math.sqrt(v*v+x*x),r=Math.sqrt(v*v+x*x+M*M),s/i<1e-12){if(m=0,r/i<1e-12)return y=-n,{x:t.x,y:t.y,z:t.z}}else m=Math.atan2(x,v);o=M/r,u=(a=s/r)*(1-e)*(h=1/Math.sqrt(1-e*(2-e)*a*a)),d=o*h,_=0;do{_++,l=e*(c=i/Math.sqrt(1-e*d*d))/(c+(y=s*u+M*d-c*(1-e*d*d))),p=(f=o*(h=1/Math.sqrt(1-l*(2-l)*a*a)))*u-(g=a*(1-l)*h)*d,u=g,d=f}while(p*p>1e-24&&_<30);return{x:m,y:Math.atan(f/Math.abs(g)),z:y}}function Pl(t){return t===yh||t===vh}function Il(t,e,i){if(null===t.grids||0===t.grids.length)return console.log("Grid shift grids not found"),-1;var n={x:-i.x,y:i.y},s={x:Number.NaN,y:Number.NaN},r=[];t:for(var o=0;o<t.grids.length;o++){var a=t.grids[o];if(r.push(a.name),a.isNull){s=n;break}if(a.mandatory,null!==a.grid)for(var h=a.grid.subgrids,l=0,c=h.length;l<c;l++){var u=h[l],d=(Math.abs(u.del[1])+Math.abs(u.del[0]))/1e4,g=u.ll[0]-d,f=u.ll[1]-d,p=u.ll[0]+(u.lim[0]-1)*u.del[0]+d,_=u.ll[1]+(u.lim[1]-1)*u.del[1]+d;if(!(f>n.y||g>n.x||_<n.y||p<n.x||(s=Tl(n,e,u),isNaN(s.x))))break t}else if(a.mandatory)return console.log("Unable to find mandatory grid '"+a.name+"'"),-1}return isNaN(s.x)?(console.log("Failed to find a grid shift table for location '"+-n.x*Th+" "+n.y*Th+" tried: '"+r+"'"),-1):(i.x=-s.x,i.y=s.y,0)}function Tl(t,e,i){var n={x:Number.NaN,y:Number.NaN};if(isNaN(t.x))return n;var s={x:t.x,y:t.y};s.x-=i.ll[0],s.y-=i.ll[1],s.x=sl(s.x-Math.PI)+Math.PI;var r=Rl(s,i);if(e){if(isNaN(r.x))return n;r.x=s.x-r.x,r.y=s.y-r.y;var o,a,h=9;do{if(a=Rl(r,i),isNaN(a.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}o={x:s.x-(a.x+r.x),y:s.y-(a.y+r.y)},r.x+=o.x,r.y+=o.y}while(h--&&Math.abs(o.x)>1e-12&&Math.abs(o.y)>1e-12);if(h<0)return console.log("Inverse grid shift iterator failed to converge."),n;n.x=sl(r.x+i.ll[0]),n.y=r.y+i.ll[1]}else isNaN(r.x)||(n.x=t.x+r.x,n.y=t.y+r.y);return n}function Rl(t,e){var i,n={x:t.x/e.del[0],y:t.y/e.del[1]},s=Math.floor(n.x),r=Math.floor(n.y),o=n.x-1*s,a=n.y-1*r,h={x:Number.NaN,y:Number.NaN};if(s<0||s>=e.lim[0])return h;if(r<0||r>=e.lim[1])return h;i=r*e.lim[0]+s;var l=e.cvs[i][0],c=e.cvs[i][1];i++;var u=e.cvs[i][0],d=e.cvs[i][1];i+=e.lim[0];var g=e.cvs[i][0],f=e.cvs[i][1];i--;var p=e.cvs[i][0],_=e.cvs[i][1],m=o*a,y=o*(1-a),v=(1-o)*(1-a),x=(1-o)*a;return h.x=v*l+y*u+x*p+m*g,h.y=v*c+y*d+x*_+m*f,h}function Al(t,e,i){var n,s,r,o=i.x,a=i.y,h=i.z||0,l={};for(r=0;r<3;r++)if(!e||2!==r||void 0!==i.z)switch(0===r?(n=o,s=-1!=="ew".indexOf(t.axis[r])?"x":"y"):1===r?(n=a,s=-1!=="ns".indexOf(t.axis[r])?"y":"x"):(n=h,s="z"),t.axis[r]){case"e":case"n":l[s]=n;break;case"w":case"s":l[s]=-n;break;case"u":void 0!==i[s]&&(l.z=n);break;case"d":void 0!==i[s]&&(l.z=-n);break;default:return null}return l}function Fl(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e}function Ll(t){if("function"==typeof Number.isFinite){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof t||t!=t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function kl(t,e,i,n){var s,r=void 0!==(i=Array.isArray(i)?Fl(i):{x:i.x,y:i.y,z:i.z,m:i.m}).z;if(function(t){Ll(t.x),Ll(t.y)}(i),t.datum&&e.datum&&function(t,e){return(t.datum.datum_type===yh||t.datum.datum_type===vh||t.datum.datum_type===xh)&&"WGS84"!==e.datumCode||(e.datum.datum_type===yh||e.datum.datum_type===vh||e.datum.datum_type===xh)&&"WGS84"!==t.datumCode}(t,e)&&(i=kl(t,s=new Cl("WGS84"),i,n),t=s),n&&"enu"!==t.axis&&(i=Al(t,!1,i)),"longlat"===t.projName)i={x:i.x*Ih,y:i.y*Ih,z:i.z||0};else if(t.to_meter&&(i={x:i.x*t.to_meter,y:i.y*t.to_meter,z:i.z||0}),!(i=t.inverse(i)))return;if(t.from_greenwich&&(i.x+=t.from_greenwich),i=function(t,e,i){if(function(t,e){return t.datum_type===e.datum_type&&!(t.a!==e.a||Math.abs(t.es-e.es)>5e-11)&&(t.datum_type===yh?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]:t.datum_type!==vh||t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]&&t.datum_params[3]===e.datum_params[3]&&t.datum_params[4]===e.datum_params[4]&&t.datum_params[5]===e.datum_params[5]&&t.datum_params[6]===e.datum_params[6])}(t,e))return i;if(t.datum_type===Mh||e.datum_type===Mh)return i;var n=t.a,s=t.es;if(t.datum_type===xh){if(0!==Il(t,!1,i))return;n=wh,s=Ch}var r=e.a,o=e.b,a=e.es;return e.datum_type===xh&&(r=wh,o=Sh,a=Ch),s!==a||n!==r||Pl(t.datum_type)||Pl(e.datum_type)?(i=bl(i,s,n),Pl(t.datum_type)&&(i=function(t,e,i){if(e===yh)return{x:t.x+i[0],y:t.y+i[1],z:t.z+i[2]};if(e===vh){var n=i[0],s=i[1],r=i[2],o=i[3],a=i[4],h=i[5],l=i[6];return{x:l*(t.x-h*t.y+a*t.z)+n,y:l*(h*t.x+t.y-o*t.z)+s,z:l*(-a*t.x+o*t.y+t.z)+r}}}(i,t.datum_type,t.datum_params)),Pl(e.datum_type)&&(i=function(t,e,i){if(e===yh)return{x:t.x-i[0],y:t.y-i[1],z:t.z-i[2]};if(e===vh){var n=i[0],s=i[1],r=i[2],o=i[3],a=i[4],h=i[5],l=i[6],c=(t.x-n)/l,u=(t.y-s)/l,d=(t.z-r)/l;return{x:c+h*u-a*d,y:-h*c+u+o*d,z:a*c-o*u+d}}}(i,e.datum_type,e.datum_params)),i=El(i,a,r,o),e.datum_type!==xh||0===Il(e,!0,i)?i:void 0):i}(t.datum,e.datum,i))return e.from_greenwich&&(i={x:i.x-e.from_greenwich,y:i.y,z:i.z||0}),"longlat"===e.projName?i={x:i.x*Th,y:i.y*Th,z:i.z||0}:(i=e.forward(i),e.to_meter&&(i={x:i.x/e.to_meter,y:i.y/e.to_meter,z:i.z||0})),n&&"enu"!==e.axis?Al(e,!0,i):(i&&!r&&delete i.z,i)}var Ol=Cl("WGS84");function Dl(t,e,i,n){var s,r,o;return Array.isArray(i)?(s=kl(t,e,i,n)||{x:NaN,y:NaN},i.length>2?void 0!==t.name&&"geocent"===t.name||void 0!==e.name&&"geocent"===e.name?"number"==typeof s.z?[s.x,s.y,s.z].concat(i.slice(3)):[s.x,s.y,i[2]].concat(i.slice(3)):[s.x,s.y].concat(i.slice(2)):[s.x,s.y]):(r=kl(t,e,i,n),2===(o=Object.keys(i)).length||o.forEach((function(n){if(void 0!==t.name&&"geocent"===t.name||void 0!==e.name&&"geocent"===e.name){if("x"===n||"y"===n||"z"===n)return}else if("x"===n||"y"===n)return;r[n]=i[n]})),r)}function Nl(t){return t instanceof Cl?t:t.oProj?t.oProj:Cl(t)}const Gl=function(t,e,i){t=Nl(t);var n,s=!1;return void 0===e?(e=t,t=Ol,s=!0):(void 0!==e.x||Array.isArray(e))&&(i=e,e=t,t=Ol,s=!0),e=Nl(e),i?Dl(t,e,i):(n={forward:function(i,n){return Dl(t,e,i,n)},inverse:function(i,n){return Dl(e,t,i,n)}},s&&(n.oProj=e),n)};var jl=6,zl="AJSAJS",Bl="AFAFAF",Wl=65,ql=73,Xl=79,Ul=86,Vl=90;const Kl={forward:Yl,inverse:function(t){var e=$l(tc(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]},toPoint:Zl};function Yl(t,e){return e=e||5,function(t,e){var i,n,s,r,o,a,h,l,c,u,d,g="00000"+t.easting,f="00000"+t.northing;return t.zoneNumber+t.zoneLetter+(c=t.easting,u=t.northing,d=Ql(t.zoneNumber),i=Math.floor(c/1e5),n=Math.floor(u/1e5)%20,s=d-1,r=zl.charCodeAt(s),o=Bl.charCodeAt(s),l=!1,(a=r+i-1)>Vl&&(a=a-Vl+Wl-1,l=!0),(a===ql||r<ql&&a>ql||(a>ql||r<ql)&&l)&&a++,(a===Xl||r<Xl&&a>Xl||(a>Xl||r<Xl)&&l)&&++a===ql&&a++,a>Vl&&(a=a-Vl+Wl-1),(h=o+n)>Ul?(h=h-Ul+Wl-1,l=!0):l=!1,(h===ql||o<ql&&h>ql||(h>ql||o<ql)&&l)&&h++,(h===Xl||o<Xl&&h>Xl||(h>Xl||o<Xl)&&l)&&++h===ql&&h++,h>Ul&&(h=h-Ul+Wl-1),String.fromCharCode(a)+String.fromCharCode(h))+g.substr(g.length-5,e)+f.substr(f.length-5,e)}(function(t){var e,i,n,s,r,o,a,h=t.lat,l=t.lon,c=6378137,u=.00669438,d=.9996,g=Hl(h),f=Hl(l);a=Math.floor((l+180)/6)+1,180===l&&(a=60),h>=56&&h<64&&l>=3&&l<12&&(a=32),h>=72&&h<84&&(l>=0&&l<9?a=31:l>=9&&l<21?a=33:l>=21&&l<33?a=35:l>=33&&l<42&&(a=37)),o=Hl(6*(a-1)-180+3),e=.006739496752268451,i=c/Math.sqrt(1-u*Math.sin(g)*Math.sin(g)),n=Math.tan(g)*Math.tan(g),s=e*Math.cos(g)*Math.cos(g);var p,_,m=d*i*((r=Math.cos(g)*(f-o))+(1-n+s)*r*r*r/6+(5-18*n+n*n+72*s-58*e)*r*r*r*r*r/120)+5e5,y=d*(c*(.9983242984503243*g-.002514607064228144*Math.sin(2*g)+2639046602129982e-21*Math.sin(4*g)-3.418046101696858e-9*Math.sin(6*g))+i*Math.tan(g)*(r*r/2+(5-n+9*s+4*s*s)*r*r*r*r/24+(61-58*n+n*n+600*s-2.2240339282485886)*r*r*r*r*r*r/720));return h<0&&(y+=1e7),{northing:Math.round(y),easting:Math.round(m),zoneNumber:a,zoneLetter:(p=h,_="Z",84>=p&&p>=72?_="X":72>p&&p>=64?_="W":64>p&&p>=56?_="V":56>p&&p>=48?_="U":48>p&&p>=40?_="T":40>p&&p>=32?_="S":32>p&&p>=24?_="R":24>p&&p>=16?_="Q":16>p&&p>=8?_="P":8>p&&p>=0?_="N":0>p&&p>=-8?_="M":-8>p&&p>=-16?_="L":-16>p&&p>=-24?_="K":-24>p&&p>=-32?_="J":-32>p&&p>=-40?_="H":-40>p&&p>=-48?_="G":-48>p&&p>=-56?_="F":-56>p&&p>=-64?_="E":-64>p&&p>=-72?_="D":-72>p&&p>=-80&&(_="C"),_)}}({lat:t[1],lon:t[0]}),e)}function Zl(t){var e=$l(tc(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function Hl(t){return t*(Math.PI/180)}function Jl(t){return t/Math.PI*180}function $l(t){var e=t.northing,i=t.easting,n=t.zoneLetter,s=t.zoneNumber;if(s<0||s>60)return null;var r,o,a,h,l,c,u,d,g,f=.9996,p=6378137,_=.00669438,m=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),y=i-5e5,v=e;n<"N"&&(v-=1e7),u=6*(s-1)-180+3,r=.006739496752268451,g=(d=v/f/6367449.145945056)+(3*m/2-27*m*m*m/32)*Math.sin(2*d)+(21*m*m/16-55*m*m*m*m/32)*Math.sin(4*d)+151*m*m*m/96*Math.sin(6*d),o=p/Math.sqrt(1-_*Math.sin(g)*Math.sin(g)),a=Math.tan(g)*Math.tan(g),h=r*Math.cos(g)*Math.cos(g),l=.99330562*p/Math.pow(1-_*Math.sin(g)*Math.sin(g),1.5),c=y/(o*f);var x=g-o*Math.tan(g)/l*(c*c/2-(5+3*a+10*h-4*h*h-9*r)*c*c*c*c/24+(61+90*a+298*h+45*a*a-1.6983531815716497-3*h*h)*c*c*c*c*c*c/720);x=Jl(x);var M,w=(c-(1+2*a+h)*c*c*c/6+(5-2*h+28*a-3*h*h+8*r+24*a*a)*c*c*c*c*c/120)/Math.cos(g);if(w=u+Jl(w),t.accuracy){var S=$l({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});M={top:S.lat,right:S.lon,bottom:x,left:w}}else M={lat:x,lon:w};return M}function Ql(t){var e=t%jl;return 0===e&&(e=jl),e}function tc(t){if(t&&0===t.length)throw"MGRSPoint coverting from nothing";for(var e,i=t.length,n=null,s="",r=0;!/[A-Z]/.test(e=t.charAt(r));){if(r>=2)throw"MGRSPoint bad conversion from: "+t;s+=e,r++}var o=parseInt(s,10);if(0===r||r+3>i)throw"MGRSPoint bad conversion from: "+t;var a=t.charAt(r++);if(a<="A"||"B"===a||"Y"===a||a>="Z"||"I"===a||"O"===a)throw"MGRSPoint zone letter "+a+" not handled: "+t;n=t.substring(r,r+=2);for(var h=Ql(o),l=function(t,e){for(var i=zl.charCodeAt(e-1),n=1e5,s=!1;i!==t.charCodeAt(0);){if(++i===ql&&i++,i===Xl&&i++,i>Vl){if(s)throw"Bad character: "+t;i=Wl,s=!0}n+=1e5}return n}(n.charAt(0),h),c=function(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;for(var i=Bl.charCodeAt(e-1),n=0,s=!1;i!==t.charCodeAt(0);){if(++i===ql&&i++,i===Xl&&i++,i>Ul){if(s)throw"Bad character: "+t;i=Wl,s=!0}n+=1e5}return n}(n.charAt(1),h);c<ec(a);)c+=2e6;var u=i-r;if(u%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+t;var d,g,f,p=u/2,_=0,m=0;return p>0&&(d=1e5/Math.pow(10,p),g=t.substring(r,r+p),_=parseFloat(g)*d,f=t.substring(r+p),m=parseFloat(f)*d),{easting:_+l,northing:m+c,zoneLetter:a,zoneNumber:o,accuracy:d}}function ec(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}function ic(t,e,i){if(!(this instanceof ic))return new ic(t,e,i);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if("object"==typeof t)this.x=t.x,this.y=t.y,this.z=t.z||0;else if("string"==typeof t&&void 0===e){var n=t.split(",");this.x=parseFloat(n[0],10),this.y=parseFloat(n[1],10),this.z=parseFloat(n[2],10)||0}else this.x=t,this.y=e,this.z=i||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}ic.fromMGRS=function(t){return new ic(Zl(t))},ic.prototype.toMGRS=function(t){return Yl([this.x,this.y],t)};const nc=ic;var sc=.046875,rc=.01953125,oc=.01068115234375;function ac(t){var e=[];e[0]=1-t*(.25+t*(sc+t*(rc+t*oc))),e[1]=t*(.75-t*(sc+t*(rc+t*oc)));var i=t*t;return e[2]=i*(.46875-t*(.013020833333333334+.007120768229166667*t)),i*=t,e[3]=i*(.3645833333333333-.005696614583333333*t),e[4]=i*t*.3076171875,e}function hc(t,e,i,n){return i*=e,e*=e,n[0]*t-i*(n[1]+e*(n[2]+e*(n[3]+e*n[4])))}var lc=20;function cc(t,e,i){for(var n=1/(1-e),s=t,r=lc;r;--r){var o=Math.sin(s),a=1-e*o*o;if(s-=a=(hc(s,o,Math.cos(s),i)-t)*(a*Math.sqrt(a))*n,Math.abs(a)<Ph)return s}return s}const uc={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=ac(this.es),this.ml0=hc(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(t){var e,i,n,s=t.x,r=t.y,o=sl(s-this.long0),a=Math.sin(r),h=Math.cos(r);if(this.es){var l=h*o,c=Math.pow(l,2),u=this.ep2*Math.pow(h,2),d=Math.pow(u,2),g=Math.abs(h)>Ph?Math.tan(r):0,f=Math.pow(g,2),p=Math.pow(f,2);e=1-this.es*Math.pow(a,2),l/=Math.sqrt(e);var _=hc(r,a,h,this.en);i=this.a*(this.k0*l*(1+c/6*(1-f+u+c/20*(5-18*f+p+14*u-58*f*u+c/42*(61+179*p-p*f-479*f)))))+this.x0,n=this.a*(this.k0*(_-this.ml0+a*o*l/2*(1+c/12*(5-f+9*u+4*d+c/30*(61+p-58*f+270*u-330*f*u+c/56*(1385+543*p-p*f-3111*f))))))+this.y0}else{var m=h*Math.sin(o);if(Math.abs(Math.abs(m)-1)<Ph)return 93;if(i=.5*this.a*this.k0*Math.log((1+m)/(1-m))+this.x0,n=h*Math.cos(o)/Math.sqrt(1-Math.pow(m,2)),(m=Math.abs(n))>=1){if(m-1>Ph)return 93;n=0}else n=Math.acos(n);r<0&&(n=-n),n=this.a*this.k0*(n-this.lat0)+this.y0}return t.x=i,t.y=n,t},inverse:function(t){var e,i,n,s,r=(t.x-this.x0)*(1/this.a),o=(t.y-this.y0)*(1/this.a);if(this.es)if(i=cc(e=this.ml0+o/this.k0,this.es,this.en),Math.abs(i)<Eh){var a=Math.sin(i),h=Math.cos(i),l=Math.abs(h)>Ph?Math.tan(i):0,c=this.ep2*Math.pow(h,2),u=Math.pow(c,2),d=Math.pow(l,2),g=Math.pow(d,2);e=1-this.es*Math.pow(a,2);var f=r*Math.sqrt(e)/this.k0,p=Math.pow(f,2);n=i-(e*=l)*p/(1-this.es)*.5*(1-p/12*(5+3*d-9*c*d+c-4*u-p/30*(61+90*d-252*c*d+45*g+46*c-p/56*(1385+3633*d+4095*g+1574*g*d)))),s=sl(this.long0+f*(1-p/6*(1+2*d+c-p/20*(5+28*d+24*g+8*c*d+6*c-p/42*(61+662*d+1320*g+720*g*d))))/h)}else n=Eh*nl(o),s=0;else{var _=Math.exp(r/this.k0),m=.5*(_-1/_),y=this.lat0+o/this.k0,v=Math.cos(y);e=Math.sqrt((1-Math.pow(v,2))/(1+Math.pow(m,2))),n=Math.asin(e),o<0&&(n=-n),s=0===m&&0===v?0:sl(Math.atan2(m,v)+this.long0)}return t.x=s,t.y=n,t},names:["Fast_Transverse_Mercator","Fast Transverse Mercator"]};function dc(t){var e=Math.exp(t);return(e-1/e)/2}function gc(t,e){t=Math.abs(t),e=Math.abs(e);var i=Math.max(t,e),n=Math.min(t,e)/(i||1);return i*Math.sqrt(1+Math.pow(n,2))}function fc(t,e){for(var i,n=2*Math.cos(2*e),s=t.length-1,r=t[s],o=0;--s>=0;)i=n*r-o+t[s],o=r,r=i;return e+i*Math.sin(2*e)}function pc(t,e,i){for(var n,s,r=Math.sin(e),o=Math.cos(e),a=dc(i),h=function(t){var e=Math.exp(t);return(e+1/e)/2}(i),l=2*o*h,c=-2*r*a,u=t.length-1,d=t[u],g=0,f=0,p=0;--u>=0;)n=f,s=g,d=l*(f=d)-n-c*(g=p)+t[u],p=c*f-s+l*g;return[(l=r*h)*d-(c=o*a)*p,l*p+c*d]}const _c={init:function(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(uc.init.apply(this),this.forward=uc.forward,this.inverse=uc.inverse),this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),i=e;this.cgb[0]=e*(2+e*(-2/3+e*(e*(116/45+e*(26/45+e*(-2854/675)))-2))),this.cbg[0]=e*(e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))-2),i*=e,this.cgb[1]=i*(7/3+e*(e*(-227/45+e*(2704/315+e*(2323/945)))-1.6)),this.cbg[1]=i*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),i*=e,this.cgb[2]=i*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=i*(-26/15+e*(34/21+e*(1.6+e*(-12686/2835)))),i*=e,this.cgb[3]=i*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=i*(1237/630+e*(e*(-24832/14175)-2.4)),i*=e,this.cgb[4]=i*(4174/315+e*(-144838/6237)),this.cbg[4]=i*(-734/315+e*(109598/31185)),i*=e,this.cgb[5]=i*(601676/22275),this.cbg[5]=i*(444337/155925),i=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+i*(1/4+i*(1/64+i/256))),this.utg[0]=e*(e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))-.5),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=i*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=i*(13/48+e*(e*(557/1440+e*(281/630+e*(-1983433/1935360)))-.6)),i*=e,this.utg[2]=i*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=i*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),i*=e,this.utg[3]=i*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=i*(49561/161280+e*(-179/168+e*(6601661/7257600))),i*=e,this.utg[4]=i*(-4583/161280+e*(108847/3991680)),this.gtu[4]=i*(34729/80640+e*(-3418889/1995840)),i*=e,this.utg[5]=i*(-20648693/638668800),this.gtu[5]=.6650675310896665*i;var n=fc(this.cbg,this.lat0);this.Zb=-this.Qn*(n+function(t,e){for(var i,n=2*Math.cos(e),s=t.length-1,r=t[s],o=0;--s>=0;)i=n*r-o+t[s],o=r,r=i;return Math.sin(e)*i}(this.gtu,2*n))},forward:function(t){var e=sl(t.x-this.long0),i=t.y;i=fc(this.cbg,i);var n=Math.sin(i),s=Math.cos(i),r=Math.sin(e),o=Math.cos(e);i=Math.atan2(n,o*s),e=Math.atan2(r*s,gc(n,s*o)),e=function(t){var e=Math.abs(t);return e=function(t){var e=1+t,i=e-1;return 0===i?t:t*Math.log(e)/i}(e*(1+e/(gc(1,e)+1))),t<0?-e:e}(Math.tan(e));var a,h,l=pc(this.gtu,2*i,2*e);return i+=l[0],e+=l[1],Math.abs(e)<=2.623395162778?(a=this.a*(this.Qn*e)+this.x0,h=this.a*(this.Qn*i+this.Zb)+this.y0):(a=1/0,h=1/0),t.x=a,t.y=h,t},inverse:function(t){var e,i,n=(t.x-this.x0)*(1/this.a),s=(t.y-this.y0)*(1/this.a);if(s=(s-this.Zb)/this.Qn,n/=this.Qn,Math.abs(n)<=2.623395162778){var r=pc(this.utg,2*s,2*n);s+=r[0],n+=r[1],n=Math.atan(dc(n));var o=Math.sin(s),a=Math.cos(s),h=Math.sin(n),l=Math.cos(n);s=Math.atan2(o*l,gc(h,l*a)),e=sl((n=Math.atan2(h,l*a))+this.long0),i=fc(this.cgb,s)}else e=1/0,i=1/0;return t.x=e,t.y=i,t},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"]},mc={init:function(){var t=function(t,e){if(void 0===t){if((t=Math.floor(30*(sl(e)+Math.PI)/Math.PI)+1)<0)return 0;if(t>60)return 60}return t}(this.zone,this.long0);if(void 0===t)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*Ih,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,_c.init.apply(this),this.forward=_c.forward,this.inverse=_c.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"};function yc(t,e){return Math.pow((1-t)/(1+t),e)}const vc={init:function(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Rh)/(Math.pow(Math.tan(.5*this.lat0+Rh),this.C)*yc(this.e*t,this.ratexp))},forward:function(t){var e=t.x,i=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*i+Rh),this.C)*yc(this.e*Math.sin(i),this.ratexp))-Eh,t.x=this.C*e,t},inverse:function(t){for(var e=t.x/this.C,i=t.y,n=Math.pow(Math.tan(.5*i+Rh)/this.K,1/this.C),s=20;s>0&&(i=2*Math.atan(n*yc(this.e*Math.sin(t.y),-.5*this.e))-Eh,!(Math.abs(i-t.y)<1e-14));--s)t.y=i;return s?(t.x=e,t.y=i,t):null},names:["gauss"]},xc={init:function(){vc.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(t){var e,i,n,s;return t.x=sl(t.x-this.long0),vc.forward.apply(this,[t]),e=Math.sin(t.y),i=Math.cos(t.y),n=Math.cos(t.x),s=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*i*n),t.x=s*i*Math.sin(t.x),t.y=s*(this.cosc0*e-this.sinc0*i*n),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},inverse:function(t){var e,i,n,s,r;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,r=gc(t.x,t.y)){var o=2*Math.atan2(r,this.R2);e=Math.sin(o),i=Math.cos(o),s=Math.asin(i*this.sinc0+t.y*e*this.cosc0/r),n=Math.atan2(t.x*e,r*this.cosc0*i-t.y*this.sinc0*e)}else s=this.phic0,n=0;return t.x=n,t.y=s,vc.inverse.apply(this,[t]),t.x=sl(t.x+this.long0),t},names:["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]},Mc={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Ph&&(this.k0=.5*(1+nl(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=Ph&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Ph&&Math.abs(Math.cos(this.lat_ts))>Ph&&(this.k0=.5*this.cons*il(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/rl(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=il(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-Eh,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(t){var e,i,n,s,r,o,a=t.x,h=t.y,l=Math.sin(h),c=Math.cos(h),u=sl(a-this.long0);return Math.abs(Math.abs(a-this.long0)-Math.PI)<=Ph&&Math.abs(h+this.lat0)<=Ph?(t.x=NaN,t.y=NaN,t):this.sphere?(e=2*this.k0/(1+this.sinlat0*l+this.coslat0*c*Math.cos(u)),t.x=this.a*e*c*Math.sin(u)+this.x0,t.y=this.a*e*(this.coslat0*l-this.sinlat0*c*Math.cos(u))+this.y0,t):(i=2*Math.atan(this.ssfn_(h,l,this.e))-Eh,s=Math.cos(i),n=Math.sin(i),Math.abs(this.coslat0)<=Ph?(r=rl(this.e,h*this.con,this.con*l),o=2*this.a*this.k0*r/this.cons,t.x=this.x0+o*Math.sin(a-this.long0),t.y=this.y0-this.con*o*Math.cos(a-this.long0),t):(Math.abs(this.sinlat0)<Ph?(e=2*this.a*this.k0/(1+s*Math.cos(u)),t.y=e*n):(e=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*n+this.cosX0*s*Math.cos(u))),t.y=e*(this.cosX0*n-this.sinX0*s*Math.cos(u))+this.y0),t.x=e*s*Math.sin(u)+this.x0,t))},inverse:function(t){var e,i,n,s,r;t.x-=this.x0,t.y-=this.y0;var o=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var a=2*Math.atan(o/(2*this.a*this.k0));return e=this.long0,i=this.lat0,o<=Ph?(t.x=e,t.y=i,t):(i=Math.asin(Math.cos(a)*this.sinlat0+t.y*Math.sin(a)*this.coslat0/o),e=Math.abs(this.coslat0)<Ph?this.lat0>0?sl(this.long0+Math.atan2(t.x,-1*t.y)):sl(this.long0+Math.atan2(t.x,t.y)):sl(this.long0+Math.atan2(t.x*Math.sin(a),o*this.coslat0*Math.cos(a)-t.y*this.sinlat0*Math.sin(a))),t.x=e,t.y=i,t)}if(Math.abs(this.coslat0)<=Ph){if(o<=Ph)return i=this.lat0,e=this.long0,t.x=e,t.y=i,t;t.x*=this.con,t.y*=this.con,n=o*this.cons/(2*this.a*this.k0),i=this.con*ol(this.e,n),e=this.con*sl(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else s=2*Math.atan(o*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,o<=Ph?r=this.X0:(r=Math.asin(Math.cos(s)*this.sinX0+t.y*Math.sin(s)*this.cosX0/o),e=sl(this.long0+Math.atan2(t.x*Math.sin(s),o*this.cosX0*Math.cos(s)-t.y*this.sinX0*Math.sin(s)))),i=-1*ol(this.e,Math.tan(.5*(Eh+r)));return t.x=e,t.y=i,t},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)","Polar_Stereographic"],ssfn_:function(t,e,i){return e*=i,Math.tan(.5*(Eh+t))*Math.pow((1-e)/(1+e),.5*i)}},wc={init:function(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),i=this.a,n=1/this.rf,s=2*n-Math.pow(n,2),r=this.e=Math.sqrt(s);this.R=this.k0*i*Math.sqrt(1-s)/(1-s*Math.pow(e,2)),this.alpha=Math.sqrt(1+s/(1-s)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var o=Math.log(Math.tan(Math.PI/4+this.b0/2)),a=Math.log(Math.tan(Math.PI/4+t/2)),h=Math.log((1+r*e)/(1-r*e));this.K=o-this.alpha*a+this.alpha*r/2*h},forward:function(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),i=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),n=-this.alpha*(e+i)+this.K,s=2*(Math.atan(Math.exp(n))-Math.PI/4),r=this.alpha*(t.x-this.lambda0),o=Math.atan(Math.sin(r)/(Math.sin(this.b0)*Math.tan(s)+Math.cos(this.b0)*Math.cos(r))),a=Math.asin(Math.cos(this.b0)*Math.sin(s)-Math.sin(this.b0)*Math.cos(s)*Math.cos(r));return t.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,t.x=this.R*o+this.x0,t},inverse:function(t){for(var e=t.x-this.x0,i=t.y-this.y0,n=e/this.R,s=2*(Math.atan(Math.exp(i/this.R))-Math.PI/4),r=Math.asin(Math.cos(this.b0)*Math.sin(s)+Math.sin(this.b0)*Math.cos(s)*Math.cos(n)),o=Math.atan(Math.sin(n)/(Math.cos(this.b0)*Math.cos(n)-Math.sin(this.b0)*Math.tan(s))),a=this.lambda0+o/this.alpha,h=0,l=r,c=-1e3,u=0;Math.abs(l-c)>1e-7;){if(++u>20)return;h=1/this.alpha*(Math.log(Math.tan(Math.PI/4+r/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(l))/2)),c=l,l=2*Math.atan(Math.exp(h))-Math.PI/2}return t.x=a,t.y=l,t},names:["somerc"]};var Sc=1e-7;const Cc={init:function(){var t,e,i,n,s,r,o,a,h,l,c,u,d,g=0,f=0,p=0,_=0,m=0,y=0,v=0;this.no_off=(d="object"==typeof(u=this).PROJECTION?Object.keys(u.PROJECTION)[0]:u.PROJECTION,"no_uoff"in u||"no_off"in u||-1!==["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"].indexOf(d)),this.no_rot="no_rot"in this;var x=!1;"alpha"in this&&(x=!0);var M=!1;if("rectified_grid_angle"in this&&(M=!0),x&&(v=this.alpha),M&&(g=this.rectified_grid_angle*Ih),x||M)f=this.longc;else if(p=this.long1,m=this.lat1,_=this.long2,y=this.lat2,Math.abs(m-y)<=Sc||(t=Math.abs(m))<=Sc||Math.abs(t-Eh)<=Sc||Math.abs(Math.abs(this.lat0)-Eh)<=Sc||Math.abs(Math.abs(y)-Eh)<=Sc)throw new Error;var w=1-this.es;e=Math.sqrt(w),Math.abs(this.lat0)>Ph?(a=Math.sin(this.lat0),i=Math.cos(this.lat0),t=1-this.es*a*a,this.B=i*i,this.B=Math.sqrt(1+this.es*this.B*this.B/w),this.A=this.B*this.k0*e/t,(s=(n=this.B*e/(i*Math.sqrt(t)))*n-1)<=0?s=0:(s=Math.sqrt(s),this.lat0<0&&(s=-s)),this.E=s+=n,this.E*=Math.pow(rl(this.e,this.lat0,a),this.B)):(this.B=1/e,this.A=this.k0,this.E=n=s=1),x||M?(x?(c=Math.asin(Math.sin(v)/n),M||(g=v)):(c=g,v=Math.asin(n*Math.sin(c))),this.lam0=f-Math.asin(.5*(s-1/s)*Math.tan(c))/this.B):(r=Math.pow(rl(this.e,m,Math.sin(m)),this.B),o=Math.pow(rl(this.e,y,Math.sin(y)),this.B),s=this.E/r,h=(o-r)/(o+r),l=((l=this.E*this.E)-o*r)/(l+o*r),(t=p-_)<-Math.pi?_-=Ah:t>Math.pi&&(_+=Ah),this.lam0=sl(.5*(p+_)-Math.atan(l*Math.tan(.5*this.B*(p-_))/h)/this.B),c=Math.atan(2*Math.sin(this.B*sl(p-this.lam0))/(s-1/s)),g=v=Math.asin(n*Math.sin(c))),this.singam=Math.sin(c),this.cosgam=Math.cos(c),this.sinrot=Math.sin(g),this.cosrot=Math.cos(g),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.A,this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(n*n-1)/Math.cos(v))),this.lat0<0&&(this.u_0=-this.u_0)),s=.5*c,this.v_pole_n=this.ArB*Math.log(Math.tan(Rh-s)),this.v_pole_s=this.ArB*Math.log(Math.tan(Rh+s))},forward:function(t){var e,i,n,s,r,o,a,h,l={};if(t.x=t.x-this.lam0,Math.abs(Math.abs(t.y)-Eh)>Ph){if(e=.5*((r=this.E/Math.pow(rl(this.e,t.y,Math.sin(t.y)),this.B))-(o=1/r)),i=.5*(r+o),s=Math.sin(this.B*t.x),n=(e*this.singam-s*this.cosgam)/i,Math.abs(Math.abs(n)-1)<Ph)throw new Error;h=.5*this.ArB*Math.log((1-n)/(1+n)),o=Math.cos(this.B*t.x),a=Math.abs(o)<Sc?this.A*t.x:this.ArB*Math.atan2(e*this.cosgam+s*this.singam,o)}else h=t.y>0?this.v_pole_n:this.v_pole_s,a=this.ArB*t.y;return this.no_rot?(l.x=a,l.y=h):(a-=this.u_0,l.x=h*this.cosrot+a*this.sinrot,l.y=a*this.cosrot-h*this.sinrot),l.x=this.a*l.x+this.x0,l.y=this.a*l.y+this.y0,l},inverse:function(t){var e,i,n,s,r,o,a,h={};if(t.x=(t.x-this.x0)*(1/this.a),t.y=(t.y-this.y0)*(1/this.a),this.no_rot?(i=t.y,e=t.x):(i=t.x*this.cosrot-t.y*this.sinrot,e=t.y*this.cosrot+t.x*this.sinrot+this.u_0),s=.5*((n=Math.exp(-this.BrA*i))-1/n),r=.5*(n+1/n),a=((o=Math.sin(this.BrA*e))*this.cosgam+s*this.singam)/r,Math.abs(Math.abs(a)-1)<Ph)h.x=0,h.y=a<0?-Eh:Eh;else{if(h.y=this.E/Math.sqrt((1+a)/(1-a)),h.y=ol(this.e,Math.pow(h.y,1/this.B)),h.y===1/0)throw new Error;h.x=-this.rB*Math.atan2(s*this.cosgam-o*this.singam,Math.cos(this.BrA*e))}return h.x+=this.lam0,h},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"]},bc={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<Ph)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),i=Math.cos(this.lat1),n=il(this.e,e,i),s=rl(this.e,this.lat1,e),r=Math.sin(this.lat2),o=Math.cos(this.lat2),a=il(this.e,r,o),h=rl(this.e,this.lat2,r),l=rl(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>Ph?this.ns=Math.log(n/a)/Math.log(s/h):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=n/(this.ns*Math.pow(s,this.ns)),this.rh=this.a*this.f0*Math.pow(l,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(t){var e=t.x,i=t.y;Math.abs(2*Math.abs(i)-Math.PI)<=Ph&&(i=nl(i)*(Eh-2*Ph));var n,s,r=Math.abs(Math.abs(i)-Eh);if(r>Ph)n=rl(this.e,i,Math.sin(i)),s=this.a*this.f0*Math.pow(n,this.ns);else{if((r=i*this.ns)<=0)return null;s=0}var o=this.ns*sl(e-this.long0);return t.x=this.k0*(s*Math.sin(o))+this.x0,t.y=this.k0*(this.rh-s*Math.cos(o))+this.y0,t},inverse:function(t){var e,i,n,s,r,o=(t.x-this.x0)/this.k0,a=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(o*o+a*a),i=1):(e=-Math.sqrt(o*o+a*a),i=-1);var h=0;if(0!==e&&(h=Math.atan2(i*o,i*a)),0!==e||this.ns>0){if(i=1/this.ns,n=Math.pow(e/(this.a*this.f0),i),-9999===(s=ol(this.e,n)))return null}else s=-Eh;return r=sl(h/this.ns+this.long0),t.x=r,t.y=s,t},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"]},Ec={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(t){var e,i,n,s,r,o,a,h=t.x,l=t.y,c=sl(h-this.long0);return e=Math.pow((1+this.e*Math.sin(l))/(1-this.e*Math.sin(l)),this.alfa*this.e/2),i=2*(Math.atan(this.k*Math.pow(Math.tan(l/2+this.s45),this.alfa)/e)-this.s45),n=-c*this.alfa,s=Math.asin(Math.cos(this.ad)*Math.sin(i)+Math.sin(this.ad)*Math.cos(i)*Math.cos(n)),r=Math.asin(Math.cos(i)*Math.sin(n)/Math.cos(s)),o=this.n*r,a=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(s/2+this.s45),this.n),t.y=a*Math.cos(o)/1,t.x=a*Math.sin(o)/1,this.czech||(t.y*=-1,t.x*=-1),t},inverse:function(t){var e,i,n,s,r,o,a,h=t.x;t.x=t.y,t.y=h,this.czech||(t.y*=-1,t.x*=-1),r=Math.sqrt(t.x*t.x+t.y*t.y),s=Math.atan2(t.y,t.x)/Math.sin(this.s0),n=2*(Math.atan(Math.pow(this.ro0/r,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(n)-Math.sin(this.ad)*Math.cos(n)*Math.cos(s)),i=Math.asin(Math.cos(n)*Math.sin(s)/Math.cos(e)),t.x=this.long0-i/this.alfa,o=e,a=0;var l=0;do{t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(o))/(1-this.e*Math.sin(o)),this.e/2))-this.s45),Math.abs(o-t.y)<1e-10&&(a=1),o=t.y,l+=1}while(0===a&&l<15);return l>=15?null:t},names:["Krovak","krovak"]};function Pc(t,e,i,n,s){return t*s-e*Math.sin(2*s)+i*Math.sin(4*s)-n*Math.sin(6*s)}function Ic(t){return 1-.25*t*(1+t/16*(3+1.25*t))}function Tc(t){return.375*t*(1+.25*t*(1+.46875*t))}function Rc(t){return.05859375*t*t*(1+.75*t)}function Ac(t){return t*t*t*(35/3072)}function Fc(t,e,i){var n=e*i;return t/Math.sqrt(1-n*n)}function Lc(t){return Math.abs(t)<Eh?t:t-nl(t)*Math.PI}function kc(t,e,i,n,s){var r,o;r=t/e;for(var a=0;a<15;a++)if(r+=o=(t-(e*r-i*Math.sin(2*r)+n*Math.sin(4*r)-s*Math.sin(6*r)))/(e-2*i*Math.cos(2*r)+4*n*Math.cos(4*r)-6*s*Math.cos(6*r)),Math.abs(o)<=1e-10)return r;return NaN}const Oc={init:function(){this.sphere||(this.e0=Ic(this.es),this.e1=Tc(this.es),this.e2=Rc(this.es),this.e3=Ac(this.es),this.ml0=this.a*Pc(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(t){var e,i,n=t.x,s=t.y;if(n=sl(n-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(s)*Math.sin(n)),i=this.a*(Math.atan2(Math.tan(s),Math.cos(n))-this.lat0);else{var r=Math.sin(s),o=Math.cos(s),a=Fc(this.a,this.e,r),h=Math.tan(s)*Math.tan(s),l=n*Math.cos(s),c=l*l,u=this.es*o*o/(1-this.es);e=a*l*(1-c*h*(1/6-(8-h+8*u)*c/120)),i=this.a*Pc(this.e0,this.e1,this.e2,this.e3,s)-this.ml0+a*r/o*c*(.5+(5-h+6*u)*c/24)}return t.x=e+this.x0,t.y=i+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,i,n=t.x/this.a,s=t.y/this.a;if(this.sphere){var r=s+this.lat0;e=Math.asin(Math.sin(r)*Math.cos(n)),i=Math.atan2(Math.tan(n),Math.cos(r))}else{var o=kc(this.ml0/this.a+s,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(o)-Eh)<=Ph)return t.x=this.long0,t.y=Eh,s<0&&(t.y*=-1),t;var a=Fc(this.a,this.e,Math.sin(o)),h=a*a*a/this.a/this.a*(1-this.es),l=Math.pow(Math.tan(o),2),c=n*this.a/a,u=c*c;e=o-a*Math.tan(o)/h*c*c*(.5-(1+3*l)*c*c/24),i=c*(1-u*(l/3+(1+3*l)*l*u/15))/Math.cos(o)}return t.x=sl(i+this.long0),t.y=Lc(e),t},names:["Cassini","Cassini_Soldner","cass"]};function Dc(t,e){var i;return t>1e-7?(1-t*t)*(e/(1-(i=t*e)*i)-.5/t*Math.log((1-i)/(1+i))):2*e}const Nc={init:function(){var t,e=Math.abs(this.lat0);if(Math.abs(e-Eh)<Ph?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(e)<Ph?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0)switch(this.qp=Dc(this.e,1),this.mmf=.5/(1-this.es),this.apa=function(t){var e,i=[];return i[0]=.3333333333333333*t,e=t*t,i[0]+=.17222222222222222*e,i[1]=.06388888888888888*e,e*=t,i[0]+=.10257936507936508*e,i[1]+=.0664021164021164*e,i[2]=.016415012942191543*e,i}(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=Dc(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(t){var e,i,n,s,r,o,a,h,l,c,u=t.x,d=t.y;if(u=sl(u-this.long0),this.sphere){if(r=Math.sin(d),c=Math.cos(d),n=Math.cos(u),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((i=this.mode===this.EQUIT?1+c*n:1+this.sinph0*r+this.cosph0*c*n)<=Ph)return null;e=(i=Math.sqrt(2/i))*c*Math.sin(u),i*=this.mode===this.EQUIT?r:this.cosph0*r-this.sinph0*c*n}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),Math.abs(d+this.lat0)<Ph)return null;i=Rh-.5*d,e=(i=2*(this.mode===this.S_POLE?Math.cos(i):Math.sin(i)))*Math.sin(u),i*=n}}else{switch(a=0,h=0,l=0,n=Math.cos(u),s=Math.sin(u),r=Math.sin(d),o=Dc(this.e,r),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(a=o/this.qp,h=Math.sqrt(1-a*a)),this.mode){case this.OBLIQ:l=1+this.sinb1*a+this.cosb1*h*n;break;case this.EQUIT:l=1+h*n;break;case this.N_POLE:l=Eh+d,o=this.qp-o;break;case this.S_POLE:l=d-Eh,o=this.qp+o}if(Math.abs(l)<Ph)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:l=Math.sqrt(2/l),i=this.mode===this.OBLIQ?this.ymf*l*(this.cosb1*a-this.sinb1*h*n):(l=Math.sqrt(2/(1+h*n)))*a*this.ymf,e=this.xmf*l*h*s;break;case this.N_POLE:case this.S_POLE:o>=0?(e=(l=Math.sqrt(o))*s,i=n*(this.mode===this.S_POLE?l:-l)):e=i=0}}return t.x=this.a*e+this.x0,t.y=this.a*i+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,i,n,s,r,o,a,h,l,c,u=t.x/this.a,d=t.y/this.a;if(this.sphere){var g,f=0,p=0;if((i=.5*(g=Math.sqrt(u*u+d*d)))>1)return null;switch(i=2*Math.asin(i),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(p=Math.sin(i),f=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(g)<=Ph?0:Math.asin(d*p/g),u*=p,d=f*g;break;case this.OBLIQ:i=Math.abs(g)<=Ph?this.lat0:Math.asin(f*this.sinph0+d*p*this.cosph0/g),u*=p*this.cosph0,d=(f-Math.sin(i)*this.sinph0)*g;break;case this.N_POLE:d=-d,i=Eh-i;break;case this.S_POLE:i-=Eh}e=0!==d||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(u,d):0}else{if(a=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(u/=this.dd,d*=this.dd,(o=Math.sqrt(u*u+d*d))<Ph)return t.x=this.long0,t.y=this.lat0,t;s=2*Math.asin(.5*o/this.rq),n=Math.cos(s),u*=s=Math.sin(s),this.mode===this.OBLIQ?(a=n*this.sinb1+d*s*this.cosb1/o,r=this.qp*a,d=o*this.cosb1*n-d*this.sinb1*s):(a=d*s/o,r=this.qp*a,d=o*n)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(d=-d),!(r=u*u+d*d))return t.x=this.long0,t.y=this.lat0,t;a=1-r/this.qp,this.mode===this.S_POLE&&(a=-a)}e=Math.atan2(u,d),c=(h=Math.asin(a))+h,i=h+(l=this.apa)[0]*Math.sin(c)+l[1]*Math.sin(c+c)+l[2]*Math.sin(c+c+c)}return t.x=sl(this.long0+e),t.y=i,t},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4};function Gc(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)}const jc={init:function(){Math.abs(this.lat1+this.lat2)<Ph||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=il(this.e3,this.sin_po,this.cos_po),this.qs1=Dc(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=il(this.e3,this.sin_po,this.cos_po),this.qs2=Dc(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Dc(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>Ph?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(t){var e=t.x,i=t.y;this.sin_phi=Math.sin(i),this.cos_phi=Math.cos(i);var n=Dc(this.e3,this.sin_phi),s=this.a*Math.sqrt(this.c-this.ns0*n)/this.ns0,r=this.ns0*sl(e-this.long0),o=s*Math.sin(r)+this.x0,a=this.rh-s*Math.cos(r)+this.y0;return t.x=o,t.y=a,t},inverse:function(t){var e,i,n,s,r,o;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),n=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),n=-1),s=0,0!==e&&(s=Math.atan2(n*t.x,n*t.y)),n=e*this.ns0/this.a,this.sphere?o=Math.asin((this.c-n*n)/(2*this.ns0)):(i=(this.c-n*n)/this.ns0,o=this.phi1z(this.e3,i)),r=sl(s/this.ns0+this.long0),t.x=r,t.y=o,t},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(t,e){var i,n,s,r,o=Gc(.5*e);if(t<Ph)return o;for(var a=t*t,h=1;h<=25;h++)if(o+=r=.5*(s=1-(n=t*(i=Math.sin(o)))*n)*s/Math.cos(o)*(e/(1-a)-i/s+.5/t*Math.log((1-n)/(1+n))),Math.abs(r)<=1e-7)return o;return null}},zc={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(t){var e,i,n,s,r,o,a,h=t.x,l=t.y;return n=sl(h-this.long0),e=Math.sin(l),i=Math.cos(l),s=Math.cos(n),(r=this.sin_p14*e+this.cos_p14*i*s)>0||Math.abs(r)<=Ph?(o=this.x0+1*this.a*i*Math.sin(n)/r,a=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*i*s)/r):(o=this.x0+this.infinity_dist*i*Math.sin(n),a=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*i*s)),t.x=o,t.y=a,t},inverse:function(t){var e,i,n,s,r,o;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(s=Math.atan2(e,this.rc),i=Math.sin(s),o=Gc((n=Math.cos(s))*this.sin_p14+t.y*i*this.cos_p14/e),r=Math.atan2(t.x*i,e*this.cos_p14*n-t.y*this.sin_p14*i),r=sl(this.long0+r)):(o=this.phic0,r=0),t.x=r,t.y=o,t},names:["gnom"]},Bc={init:function(){this.sphere||(this.k0=il(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(t){var e,i,n=t.x,s=t.y,r=sl(n-this.long0);if(this.sphere)e=this.x0+this.a*r*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(s)/Math.cos(this.lat_ts);else{var o=Dc(this.e,Math.sin(s));e=this.x0+this.a*this.k0*r,i=this.y0+this.a*o*.5/this.k0}return t.x=e,t.y=i,t},inverse:function(t){var e,i;return t.x-=this.x0,t.y-=this.y0,this.sphere?(e=sl(this.long0+t.x/this.a/Math.cos(this.lat_ts)),i=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(i=function(t,e){var i=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-i)<1e-6)return e<0?-1*Eh:Eh;for(var n,s,r,o,a=Math.asin(.5*e),h=0;h<30;h++)if(s=Math.sin(a),r=Math.cos(a),o=t*s,a+=n=Math.pow(1-o*o,2)/(2*r)*(e/(1-t*t)-s/(1-o*o)+.5/t*Math.log((1-o)/(1+o))),Math.abs(n)<=1e-10)return a;return NaN}(this.e,2*t.y*this.k0/this.a),e=sl(this.long0+t.x/(this.a*this.k0))),t.x=e,t.y=i,t},names:["cea"]},Wc={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(t){var e=t.x,i=t.y,n=sl(e-this.long0),s=Lc(i-this.lat0);return t.x=this.x0+this.a*n*this.rc,t.y=this.y0+this.a*s,t},inverse:function(t){var e=t.x,i=t.y;return t.x=sl(this.long0+(e-this.x0)/(this.a*this.rc)),t.y=Lc(this.lat0+(i-this.y0)/this.a),t},names:["Equirectangular","Equidistant_Cylindrical","eqc"]},qc={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Ic(this.es),this.e1=Tc(this.es),this.e2=Rc(this.es),this.e3=Ac(this.es),this.ml0=this.a*Pc(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(t){var e,i,n,s=t.x,r=t.y,o=sl(s-this.long0);if(n=o*Math.sin(r),this.sphere)Math.abs(r)<=Ph?(e=this.a*o,i=-1*this.a*this.lat0):(e=this.a*Math.sin(n)/Math.tan(r),i=this.a*(Lc(r-this.lat0)+(1-Math.cos(n))/Math.tan(r)));else if(Math.abs(r)<=Ph)e=this.a*o,i=-1*this.ml0;else{var a=Fc(this.a,this.e,Math.sin(r))/Math.tan(r);e=a*Math.sin(n),i=this.a*Pc(this.e0,this.e1,this.e2,this.e3,r)-this.ml0+a*(1-Math.cos(n))}return t.x=e+this.x0,t.y=i+this.y0,t},inverse:function(t){var e,i,n,s,r,o,a,h,l;if(n=t.x-this.x0,s=t.y-this.y0,this.sphere)if(Math.abs(s+this.a*this.lat0)<=Ph)e=sl(n/this.a+this.long0),i=0;else{var c;for(o=this.lat0+s/this.a,a=n*n/this.a/this.a+o*o,h=o,r=20;r;--r)if(h+=l=-1*(o*(h*(c=Math.tan(h))+1)-h-.5*(h*h+a)*c)/((h-o)/c-1),Math.abs(l)<=Ph){i=h;break}e=sl(this.long0+Math.asin(n*Math.tan(h)/this.a)/Math.sin(i))}else if(Math.abs(s+this.ml0)<=Ph)i=0,e=sl(this.long0+n/this.a);else{var u,d,g,f,p;for(o=(this.ml0+s)/this.a,a=n*n/this.a/this.a+o*o,h=o,r=20;r;--r)if(p=this.e*Math.sin(h),u=Math.sqrt(1-p*p)*Math.tan(h),d=this.a*Pc(this.e0,this.e1,this.e2,this.e3,h),g=this.e0-2*this.e1*Math.cos(2*h)+4*this.e2*Math.cos(4*h)-6*this.e3*Math.cos(6*h),h-=l=(o*(u*(f=d/this.a)+1)-f-.5*u*(f*f+a))/(this.es*Math.sin(2*h)*(f*f+a-2*o*f)/(4*u)+(o-f)*(u*g-2/Math.sin(2*h))-g),Math.abs(l)<=Ph){i=h;break}u=Math.sqrt(1-this.es*Math.pow(Math.sin(i),2))*Math.tan(i),e=sl(this.long0+Math.asin(n*u/this.a)/Math.sin(i))}return t.x=e,t.y=i,t},names:["Polyconic","poly"]},Xc={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(t){var e,i=t.x,n=t.y-this.lat0,s=i-this.long0,r=n/bh*1e-5,o=s,a=1,h=0;for(e=1;e<=10;e++)a*=r,h+=this.A[e]*a;var l,c=h,u=o,d=1,g=0,f=0,p=0;for(e=1;e<=6;e++)l=g*c+d*u,d=d*c-g*u,g=l,f=f+this.B_re[e]*d-this.B_im[e]*g,p=p+this.B_im[e]*d+this.B_re[e]*g;return t.x=p*this.a+this.x0,t.y=f*this.a+this.y0,t},inverse:function(t){var e,i,n=t.x,s=t.y,r=n-this.x0,o=(s-this.y0)/this.a,a=r/this.a,h=1,l=0,c=0,u=0;for(e=1;e<=6;e++)i=l*o+h*a,h=h*o-l*a,l=i,c=c+this.C_re[e]*h-this.C_im[e]*l,u=u+this.C_im[e]*h+this.C_re[e]*l;for(var d=0;d<this.iterations;d++){var g,f=c,p=u,_=o,m=a;for(e=2;e<=6;e++)g=p*c+f*u,f=f*c-p*u,p=g,_+=(e-1)*(this.B_re[e]*f-this.B_im[e]*p),m+=(e-1)*(this.B_im[e]*f+this.B_re[e]*p);f=1,p=0;var y=this.B_re[1],v=this.B_im[1];for(e=2;e<=6;e++)g=p*c+f*u,f=f*c-p*u,p=g,y+=e*(this.B_re[e]*f-this.B_im[e]*p),v+=e*(this.B_im[e]*f+this.B_re[e]*p);var x=y*y+v*v;c=(_*y+m*v)/x,u=(m*y-_*v)/x}var M=c,w=u,S=1,C=0;for(e=1;e<=9;e++)S*=M,C+=this.D[e]*S;var b=this.lat0+C*bh*1e5,E=this.long0+w;return t.x=E,t.y=b,t},names:["New_Zealand_Map_Grid","nzmg"]},Uc={init:function(){},forward:function(t){var e=t.x,i=t.y,n=sl(e-this.long0),s=this.x0+this.a*n,r=this.y0+this.a*Math.log(Math.tan(Math.PI/4+i/2.5))*1.25;return t.x=s,t.y=r,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e=sl(this.long0+t.x/this.a),i=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=i,t},names:["Miller_Cylindrical","mill"]},Vc={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=ac(this.es)},forward:function(t){var e,i,n=t.x,s=t.y;if(n=sl(n-this.long0),this.sphere){if(this.m)for(var r=this.n*Math.sin(s),o=20;o;--o){var a=(this.m*s+Math.sin(s)-r)/(this.m+Math.cos(s));if(s-=a,Math.abs(a)<Ph)break}else s=1!==this.n?Math.asin(this.n*Math.sin(s)):s;e=this.a*this.C_x*n*(this.m+Math.cos(s)),i=this.a*this.C_y*s}else{var h=Math.sin(s),l=Math.cos(s);i=this.a*hc(s,h,l,this.en),e=this.a*n*l/Math.sqrt(1-this.es*h*h)}return t.x=e,t.y=i,t},inverse:function(t){var e,i,n;return t.x-=this.x0,i=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,i/=this.C_x*(this.m+Math.cos(e)),this.m?e=Gc((this.m*e+Math.sin(e))/this.n):1!==this.n&&(e=Gc(Math.sin(e)/this.n)),i=sl(i+this.long0),e=Lc(e)):(e=cc(t.y/this.a,this.es,this.en),(n=Math.abs(e))<Eh?(n=Math.sin(e),i=sl(this.long0+t.x*Math.sqrt(1-this.es*n*n)/(this.a*Math.cos(e)))):n-Ph<Eh&&(i=this.long0)),t.x=i,t.y=e,t},names:["Sinusoidal","sinu"]},Kc={init:function(){},forward:function(t){for(var e=t.x,i=t.y,n=sl(e-this.long0),s=i,r=Math.PI*Math.sin(i);;){var o=-(s+Math.sin(s)-r)/(1+Math.cos(s));if(s+=o,Math.abs(o)<Ph)break}s/=2,Math.PI/2-Math.abs(i)<Ph&&(n=0);var a=.900316316158*this.a*n*Math.cos(s)+this.x0,h=1.4142135623731*this.a*Math.sin(s)+this.y0;return t.x=a,t.y=h,t},inverse:function(t){var e,i;t.x-=this.x0,t.y-=this.y0,i=t.y/(1.4142135623731*this.a),Math.abs(i)>.999999999999&&(i=.999999999999),e=Math.asin(i);var n=sl(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));n<-Math.PI&&(n=-Math.PI),n>Math.PI&&(n=Math.PI),i=(2*e+Math.sin(2*e))/Math.PI,Math.abs(i)>1&&(i=1);var s=Math.asin(i);return t.x=n,t.y=s,t},names:["Mollweide","moll"]},Yc={init:function(){Math.abs(this.lat1+this.lat2)<Ph||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Ic(this.es),this.e1=Tc(this.es),this.e2=Rc(this.es),this.e3=Ac(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=il(this.e,this.sinphi,this.cosphi),this.ml1=Pc(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<Ph?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=il(this.e,this.sinphi,this.cosphi),this.ml2=Pc(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Pc(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(t){var e,i=t.x,n=t.y;if(this.sphere)e=this.a*(this.g-n);else{var s=Pc(this.e0,this.e1,this.e2,this.e3,n);e=this.a*(this.g-s)}var r=this.ns*sl(i-this.long0),o=this.x0+e*Math.sin(r),a=this.y0+this.rh-e*Math.cos(r);return t.x=o,t.y=a,t},inverse:function(t){var e,i,n,s;t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns>=0?(i=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(i=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var r=0;return 0!==i&&(r=Math.atan2(e*t.x,e*t.y)),this.sphere?(s=sl(this.long0+r/this.ns),n=Lc(this.g-i/this.a),t.x=s,t.y=n,t):(n=kc(this.g-i/this.a,this.e0,this.e1,this.e2,this.e3),s=sl(this.long0+r/this.ns),t.x=s,t.y=n,t)},names:["Equidistant_Conic","eqdc"]},Zc={init:function(){this.R=this.a},forward:function(t){var e,i,n=t.x,s=t.y,r=sl(n-this.long0);Math.abs(s)<=Ph&&(e=this.x0+this.R*r,i=this.y0);var o=Gc(2*Math.abs(s/Math.PI));(Math.abs(r)<=Ph||Math.abs(Math.abs(s)-Eh)<=Ph)&&(e=this.x0,i=s>=0?this.y0+Math.PI*this.R*Math.tan(.5*o):this.y0+Math.PI*this.R*-Math.tan(.5*o));var a=.5*Math.abs(Math.PI/r-r/Math.PI),h=a*a,l=Math.sin(o),c=Math.cos(o),u=c/(l+c-1),d=u*u,g=u*(2/l-1),f=g*g,p=Math.PI*this.R*(a*(u-f)+Math.sqrt(h*(u-f)*(u-f)-(f+h)*(d-f)))/(f+h);r<0&&(p=-p),e=this.x0+p;var _=h+u;return p=Math.PI*this.R*(g*_-a*Math.sqrt((f+h)*(h+1)-_*_))/(f+h),i=s>=0?this.y0+p:this.y0-p,t.x=e,t.y=i,t},inverse:function(t){var e,i,n,s,r,o,a,h,l,c,u,d;return t.x-=this.x0,t.y-=this.y0,u=Math.PI*this.R,r=(n=t.x/u)*n+(s=t.y/u)*s,u=3*(s*s/(h=-2*(o=-Math.abs(s)*(1+r))+1+2*s*s+r*r)+(2*(a=o-2*s*s+n*n)*a*a/h/h/h-9*o*a/h/h)/27)/(l=(o-a*a/3/h)/h)/(c=2*Math.sqrt(-l/3)),Math.abs(u)>1&&(u=u>=0?1:-1),d=Math.acos(u)/3,i=t.y>=0?(-c*Math.cos(d+Math.PI/3)-a/3/h)*Math.PI:-(-c*Math.cos(d+Math.PI/3)-a/3/h)*Math.PI,e=Math.abs(n)<Ph?this.long0:sl(this.long0+Math.PI*(r-1+Math.sqrt(1+2*(n*n-s*s)+r*r))/2/n),t.x=e,t.y=i,t},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]},Hc={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(t){var e,i,n,s,r,o,a,h,l,c,u,d,g,f,p,_,m,y,v,x,M,w,S=t.x,C=t.y,b=Math.sin(t.y),E=Math.cos(t.y),P=sl(S-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=Ph?(t.x=this.x0+this.a*(Eh-C)*Math.sin(P),t.y=this.y0-this.a*(Eh-C)*Math.cos(P),t):Math.abs(this.sin_p12+1)<=Ph?(t.x=this.x0+this.a*(Eh+C)*Math.sin(P),t.y=this.y0+this.a*(Eh+C)*Math.cos(P),t):(y=this.sin_p12*b+this.cos_p12*E*Math.cos(P),m=(_=Math.acos(y))?_/Math.sin(_):1,t.x=this.x0+this.a*m*E*Math.sin(P),t.y=this.y0+this.a*m*(this.cos_p12*b-this.sin_p12*E*Math.cos(P)),t):(e=Ic(this.es),i=Tc(this.es),n=Rc(this.es),s=Ac(this.es),Math.abs(this.sin_p12-1)<=Ph?(r=this.a*Pc(e,i,n,s,Eh),o=this.a*Pc(e,i,n,s,C),t.x=this.x0+(r-o)*Math.sin(P),t.y=this.y0-(r-o)*Math.cos(P),t):Math.abs(this.sin_p12+1)<=Ph?(r=this.a*Pc(e,i,n,s,Eh),o=this.a*Pc(e,i,n,s,C),t.x=this.x0+(r+o)*Math.sin(P),t.y=this.y0+(r+o)*Math.cos(P),t):(a=b/E,h=Fc(this.a,this.e,this.sin_p12),l=Fc(this.a,this.e,b),c=Math.atan((1-this.es)*a+this.es*h*this.sin_p12/(l*E)),v=0===(u=Math.atan2(Math.sin(P),this.cos_p12*Math.tan(c)-this.sin_p12*Math.cos(P)))?Math.asin(this.cos_p12*Math.sin(c)-this.sin_p12*Math.cos(c)):Math.abs(Math.abs(u)-Math.PI)<=Ph?-Math.asin(this.cos_p12*Math.sin(c)-this.sin_p12*Math.cos(c)):Math.asin(Math.sin(P)*Math.cos(c)/Math.sin(u)),d=this.e*this.sin_p12/Math.sqrt(1-this.es),_=h*v*(1-(x=v*v)*(p=(g=this.e*this.cos_p12*Math.cos(u)/Math.sqrt(1-this.es))*g)*(1-p)/6+(M=x*v)/8*(f=d*g)*(1-2*p)+(w=M*v)/120*(p*(4-7*p)-3*d*d*(1-7*p))-w*v/48*f),t.x=this.x0+_*Math.sin(u),t.y=this.y0+_*Math.cos(u),t))},inverse:function(t){var e,i,n,s,r,o,a,h,l,c,u,d,g,f,p,_,m,y,v,x,M,w,S;if(t.x-=this.x0,t.y-=this.y0,this.sphere){if((e=Math.sqrt(t.x*t.x+t.y*t.y))>2*Eh*this.a)return;return i=e/this.a,n=Math.sin(i),s=Math.cos(i),r=this.long0,Math.abs(e)<=Ph?o=this.lat0:(o=Gc(s*this.sin_p12+t.y*n*this.cos_p12/e),a=Math.abs(this.lat0)-Eh,r=Math.abs(a)<=Ph?this.lat0>=0?sl(this.long0+Math.atan2(t.x,-t.y)):sl(this.long0-Math.atan2(-t.x,t.y)):sl(this.long0+Math.atan2(t.x*n,e*this.cos_p12*s-t.y*this.sin_p12*n))),t.x=r,t.y=o,t}return h=Ic(this.es),l=Tc(this.es),c=Rc(this.es),u=Ac(this.es),Math.abs(this.sin_p12-1)<=Ph?(o=kc(((d=this.a*Pc(h,l,c,u,Eh))-(e=Math.sqrt(t.x*t.x+t.y*t.y)))/this.a,h,l,c,u),r=sl(this.long0+Math.atan2(t.x,-1*t.y)),t.x=r,t.y=o,t):Math.abs(this.sin_p12+1)<=Ph?(d=this.a*Pc(h,l,c,u,Eh),o=kc(((e=Math.sqrt(t.x*t.x+t.y*t.y))-d)/this.a,h,l,c,u),r=sl(this.long0+Math.atan2(t.x,t.y)),t.x=r,t.y=o,t):(e=Math.sqrt(t.x*t.x+t.y*t.y),p=Math.atan2(t.x,t.y),g=Fc(this.a,this.e,this.sin_p12),_=Math.cos(p),y=-(m=this.e*this.cos_p12*_)*m/(1-this.es),v=3*this.es*(1-y)*this.sin_p12*this.cos_p12*_/(1-this.es),w=1-y*(M=(x=e/g)-y*(1+y)*Math.pow(x,3)/6-v*(1+3*y)*Math.pow(x,4)/24)*M/2-x*M*M*M/6,f=Math.asin(this.sin_p12*Math.cos(M)+this.cos_p12*Math.sin(M)*_),r=sl(this.long0+Math.asin(Math.sin(p)*Math.sin(M)/Math.cos(f))),S=Math.sin(f),o=Math.atan2((S-this.es*w*this.sin_p12)*Math.tan(f),S*(1-this.es)),t.x=r,t.y=o,t)},names:["Azimuthal_Equidistant","aeqd"]},Jc={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(t){var e,i,n,s,r,o,a,h=t.x,l=t.y;return n=sl(h-this.long0),e=Math.sin(l),i=Math.cos(l),s=Math.cos(n),((r=this.sin_p14*e+this.cos_p14*i*s)>0||Math.abs(r)<=Ph)&&(o=1*this.a*i*Math.sin(n),a=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*i*s)),t.x=o,t.y=a,t},inverse:function(t){var e,i,n,s,r,o,a;return t.x-=this.x0,t.y-=this.y0,i=Gc((e=Math.sqrt(t.x*t.x+t.y*t.y))/this.a),n=Math.sin(i),s=Math.cos(i),o=this.long0,Math.abs(e)<=Ph?(a=this.lat0,t.x=o,t.y=a,t):(a=Gc(s*this.sin_p14+t.y*n*this.cos_p14/e),r=Math.abs(this.lat0)-Eh,Math.abs(r)<=Ph?(o=this.lat0>=0?sl(this.long0+Math.atan2(t.x,-t.y)):sl(this.long0-Math.atan2(-t.x,t.y)),t.x=o,t.y=a,t):(o=sl(this.long0+Math.atan2(t.x*n,e*this.cos_p14*s-t.y*this.sin_p14*n)),t.x=o,t.y=a,t))},names:["ortho"]};var $c=1,Qc=2,tu=3,eu=4;function iu(t,e,i,n){var s;return t<Ph?(n.value=$c,s=0):(s=Math.atan2(e,i),Math.abs(s)<=Rh?n.value=$c:s>Rh&&s<=Eh+Rh?(n.value=Qc,s-=Eh):s>Eh+Rh||s<=-(Eh+Rh)?(n.value=tu,s=s>=0?s-Fh:s+Fh):(n.value=eu,s+=Eh)),s}function nu(t,e){var i=t+e;return i<-Fh?i+=Ah:i>+Fh&&(i-=Ah),i}const su={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=Eh-Rh/2?this.face=5:this.lat0<=-(Eh-Rh/2)?this.face=6:Math.abs(this.long0)<=Rh?this.face=1:Math.abs(this.long0)<=Eh+Rh?this.face=this.long0>0?2:4:this.face=3,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(t){var e,i,n,s,r,o,a={x:0,y:0},h={value:0};if(t.x-=this.long0,e=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(t.y)):t.y,i=t.x,5===this.face)s=Eh-e,i>=Rh&&i<=Eh+Rh?(h.value=$c,n=i-Eh):i>Eh+Rh||i<=-(Eh+Rh)?(h.value=Qc,n=i>0?i-Fh:i+Fh):i>-(Eh+Rh)&&i<=-Rh?(h.value=tu,n=i+Eh):(h.value=eu,n=i);else if(6===this.face)s=Eh+e,i>=Rh&&i<=Eh+Rh?(h.value=$c,n=-i+Eh):i<Rh&&i>=-Rh?(h.value=Qc,n=-i):i<-Rh&&i>=-(Eh+Rh)?(h.value=tu,n=-i-Eh):(h.value=eu,n=i>0?-i+Fh:-i-Fh);else{var l,c,u,d,g,f;2===this.face?i=nu(i,+Eh):3===this.face?i=nu(i,+Fh):4===this.face&&(i=nu(i,-Eh)),d=Math.sin(e),g=Math.cos(e),f=Math.sin(i),l=g*Math.cos(i),c=g*f,u=d,1===this.face?n=iu(s=Math.acos(l),u,c,h):2===this.face?n=iu(s=Math.acos(c),u,-l,h):3===this.face?n=iu(s=Math.acos(-l),u,-c,h):4===this.face?n=iu(s=Math.acos(-c),u,l,h):(s=n=0,h.value=$c)}return o=Math.atan(12/Fh*(n+Math.acos(Math.sin(n)*Math.cos(Rh))-Eh)),r=Math.sqrt((1-Math.cos(s))/(Math.cos(o)*Math.cos(o))/(1-Math.cos(Math.atan(1/Math.cos(n))))),h.value===Qc?o+=Eh:h.value===tu?o+=Fh:h.value===eu&&(o+=1.5*Fh),a.x=r*Math.cos(o),a.y=r*Math.sin(o),a.x=a.x*this.a+this.x0,a.y=a.y*this.a+this.y0,t.x=a.x,t.y=a.y,t},inverse:function(t){var e,i,n,s,r,o,a,h,l,c,u,d,g={lam:0,phi:0},f={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,i=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),e=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?f.value=$c:t.y>=0&&t.y>=Math.abs(t.x)?(f.value=Qc,e-=Eh):t.x<0&&-t.x>=Math.abs(t.y)?(f.value=tu,e=e<0?e+Fh:e-Fh):(f.value=eu,e+=Eh),l=Fh/12*Math.tan(e),r=Math.sin(l)/(Math.cos(l)-1/Math.sqrt(2)),o=Math.atan(r),(a=1-(n=Math.cos(e))*n*(s=Math.tan(i))*s*(1-Math.cos(Math.atan(1/Math.cos(o)))))<-1?a=-1:a>1&&(a=1),5===this.face)h=Math.acos(a),g.phi=Eh-h,f.value===$c?g.lam=o+Eh:f.value===Qc?g.lam=o<0?o+Fh:o-Fh:f.value===tu?g.lam=o-Eh:g.lam=o;else if(6===this.face)h=Math.acos(a),g.phi=h-Eh,f.value===$c?g.lam=-o+Eh:f.value===Qc?g.lam=-o:f.value===tu?g.lam=-o-Eh:g.lam=o<0?-o-Fh:-o+Fh;else{var p,_,m;l=(p=a)*p,_=(l+=(m=l>=1?0:Math.sqrt(1-l)*Math.sin(o))*m)>=1?0:Math.sqrt(1-l),f.value===Qc?(l=_,_=-m,m=l):f.value===tu?(_=-_,m=-m):f.value===eu&&(l=_,_=m,m=-l),2===this.face?(l=p,p=-_,_=l):3===this.face?(p=-p,_=-_):4===this.face&&(l=p,p=_,_=-l),g.phi=Math.acos(-m)-Eh,g.lam=Math.atan2(_,p),2===this.face?g.lam=nu(g.lam,-Eh):3===this.face?g.lam=nu(g.lam,-Fh):4===this.face&&(g.lam=nu(g.lam,+Eh))}return 0!==this.es&&(c=g.phi<0?1:0,u=Math.tan(g.phi),d=this.b/Math.sqrt(u*u+this.one_minus_f_squared),g.phi=Math.atan(Math.sqrt(this.a*this.a-d*d)/(this.one_minus_f*d)),c&&(g.phi=-g.phi)),g.lam+=this.long0,t.x=g.lam,t.y=g.phi,t},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]};var ru=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],ou=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],au=.8487,hu=1.3523,lu=Th/5,cu=1/lu,uu=function(t,e){return t[0]+e*(t[1]+e*(t[2]+e*t[3]))};const du={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(t){var e=sl(t.x-this.long0),i=Math.abs(t.y),n=Math.floor(i*lu);n<0?n=0:n>=18&&(n=17);var s={x:uu(ru[n],i=Th*(i-cu*n))*e,y:uu(ou[n],i)};return t.y<0&&(s.y=-s.y),s.x=s.x*this.a*au+this.x0,s.y=s.y*this.a*hu+this.y0,s},inverse:function(t){var e={x:(t.x-this.x0)/(this.a*au),y:Math.abs(t.y-this.y0)/(this.a*hu)};if(e.y>=1)e.x/=ru[18][0],e.y=t.y<0?-Eh:Eh;else{var i=Math.floor(18*e.y);for(i<0?i=0:i>=18&&(i=17);;)if(ou[i][0]>e.y)--i;else{if(!(ou[i+1][0]<=e.y))break;++i}var n=ou[i],s=5*(e.y-n[0])/(ou[i+1][0]-n[0]);s=function(t,e,i,n){for(var s=e;n;--n){var r=t(s);if(s-=r,Math.abs(r)<i)break}return s}((function(t){return(uu(n,t)-e.y)/function(t,e){return t[1]+e*(2*t[2]+3*e*t[3])}(n,t)}),s,Ph,100),e.x/=uu(ru[i],s),e.y=(5*i+s)*Ih,t.y<0&&(e.y=-e.y)}return e.x=sl(e.x+this.long0),e},names:["Robinson","robin"]},gu={init:function(){this.name="geocent"},forward:function(t){return bl(t,this.es,this.a)},inverse:function(t){return El(t,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]};var fu={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};const pu={init:function(){if(Object.keys(fu).forEach(function(t){if(void 0===this[t])this[t]=fu[t].def;else{if(fu[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);fu[t].num&&(this[t]=parseFloat(this[t]))}fu[t].degrees&&(this[t]=this[t]*Ih)}.bind(this)),Math.abs(Math.abs(this.lat0)-Eh)<Ph?this.mode=this.lat0<0?1:0:Math.abs(this.lat0)<Ph?this.mode=2:(this.mode=3,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var t=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(t),this.sw=Math.sin(t)},forward:function(t){t.x-=this.long0;var e,i,n,s,r=Math.sin(t.y),o=Math.cos(t.y),a=Math.cos(t.x);switch(this.mode){case 3:i=this.sinph0*r+this.cosph0*o*a;break;case 2:i=o*a;break;case 1:i=-r;break;case 0:i=r}switch(e=(i=this.pn1/(this.p-i))*o*Math.sin(t.x),this.mode){case 3:i*=this.cosph0*r-this.sinph0*o*a;break;case 2:i*=r;break;case 0:i*=-o*a;break;case 1:i*=o*a}return s=1/((n=i*this.cg+e*this.sg)*this.sw*this.h1+this.cw),e=(e*this.cg-i*this.sg)*this.cw*s,i=n*s,t.x=e*this.a,t.y=i*this.a,t},inverse:function(t){t.x/=this.a,t.y/=this.a;var e,i,n,s={x:t.x,y:t.y};n=1/(this.pn1-t.y*this.sw),e=this.pn1*t.x*n,i=this.pn1*t.y*this.cw*n,t.x=e*this.cg+i*this.sg,t.y=i*this.cg-e*this.sg;var r=gc(t.x,t.y);if(Math.abs(r)<Ph)s.x=0,s.y=t.y;else{var o,a;switch(a=1-r*r*this.pfact,a=(this.p-Math.sqrt(a))/(this.pn1/r+r/this.pn1),o=Math.sqrt(1-a*a),this.mode){case 3:s.y=Math.asin(o*this.sinph0+t.y*a*this.cosph0/r),t.y=(o-this.sinph0*Math.sin(s.y))*r,t.x*=a*this.cosph0;break;case 2:s.y=Math.asin(t.y*a/r),t.y=o*r,t.x*=a;break;case 0:s.y=Math.asin(o),t.y=-t.y;break;case 1:s.y=-Math.asin(o)}s.x=Math.atan2(t.x,t.y)}return t.x=s.x+this.long0,t.y=s.y,t},names:["Tilted_Perspective","tpers"]},_u={init:function(){if(this.flip_axis="x"===this.sweep?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,0!==this.es){var t=1-this.es,e=1/t;this.radius_p=Math.sqrt(t),this.radius_p2=t,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")},forward:function(t){var e,i,n,s,r=t.x,o=t.y;if(r-=this.long0,"ellipse"===this.shape){o=Math.atan(this.radius_p2*Math.tan(o));var a=this.radius_p/gc(this.radius_p*Math.cos(o),Math.sin(o));if(i=a*Math.cos(r)*Math.cos(o),n=a*Math.sin(r)*Math.cos(o),s=a*Math.sin(o),(this.radius_g-i)*i-n*n-s*s*this.radius_p_inv2<0)return t.x=Number.NaN,t.y=Number.NaN,t;e=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(n/gc(s,e)),t.y=this.radius_g_1*Math.atan(s/e)):(t.x=this.radius_g_1*Math.atan(n/e),t.y=this.radius_g_1*Math.atan(s/gc(n,e)))}else"sphere"===this.shape&&(e=Math.cos(o),i=Math.cos(r)*e,n=Math.sin(r)*e,s=Math.sin(o),e=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(n/gc(s,e)),t.y=this.radius_g_1*Math.atan(s/e)):(t.x=this.radius_g_1*Math.atan(n/e),t.y=this.radius_g_1*Math.atan(s/gc(n,e))));return t.x=t.x*this.a,t.y=t.y*this.a,t},inverse:function(t){var e,i,n,s,r=-1,o=0,a=0;if(t.x=t.x/this.a,t.y=t.y/this.a,"ellipse"===this.shape){this.flip_axis?(a=Math.tan(t.y/this.radius_g_1),o=Math.tan(t.x/this.radius_g_1)*gc(1,a)):(o=Math.tan(t.x/this.radius_g_1),a=Math.tan(t.y/this.radius_g_1)*gc(1,o));var h=a/this.radius_p;if(e=o*o+h*h+r*r,(n=(i=2*this.radius_g*r)*i-4*e*this.C)<0)return t.x=Number.NaN,t.y=Number.NaN,t;s=(-i-Math.sqrt(n))/(2*e),r=this.radius_g+s*r,o*=s,a*=s,t.x=Math.atan2(o,r),t.y=Math.atan(a*Math.cos(t.x)/r),t.y=Math.atan(this.radius_p_inv2*Math.tan(t.y))}else if("sphere"===this.shape){if(this.flip_axis?(a=Math.tan(t.y/this.radius_g_1),o=Math.tan(t.x/this.radius_g_1)*Math.sqrt(1+a*a)):(o=Math.tan(t.x/this.radius_g_1),a=Math.tan(t.y/this.radius_g_1)*Math.sqrt(1+o*o)),e=o*o+a*a+r*r,(n=(i=2*this.radius_g*r)*i-4*e*this.C)<0)return t.x=Number.NaN,t.y=Number.NaN,t;s=(-i-Math.sqrt(n))/(2*e),r=this.radius_g+s*r,o*=s,a*=s,t.x=Math.atan2(o,r),t.y=Math.atan(a*Math.cos(t.x)/r)}return t.x=t.x+this.long0,t},names:["Geostationary Satellite View","Geostationary_Satellite","geos"]};var mu=1.340264,yu=-.081106,vu=893e-6,xu=.003796,Mu=Math.sqrt(3)/2;const wu={init:function(){this.es=0,this.long0=void 0!==this.long0?this.long0:0},forward:function(t){var e=sl(t.x-this.long0),i=t.y,n=Math.asin(Mu*Math.sin(i)),s=n*n,r=s*s*s;return t.x=e*Math.cos(n)/(Mu*(mu+3*yu*s+r*(7*vu+9*xu*s))),t.y=n*(mu+yu*s+r*(vu+xu*s)),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},inverse:function(t){t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a;var e,i,n,s,r=t.y;for(s=0;s<12&&(r-=n=(r*(mu+yu*(e=r*r)+(i=e*e*e)*(vu+xu*e))-t.y)/(mu+3*yu*e+i*(7*vu+9*xu*e)),!(Math.abs(n)<1e-9));++s);return i=(e=r*r)*e*e,t.x=Mu*t.x*(mu+3*yu*e+i*(7*vu+9*xu*e))/Math.cos(r),t.y=Math.asin(Math.sin(r)/Mu),t.x=sl(t.x+this.long0),t},names:["eqearth","Equal Earth","Equal_Earth"]};var Su=1e-10;function Cu(t){var e,i,n,s=sl(t.x-(this.long0||0)),r=t.y;return e=this.am1+this.m1-hc(r,i=Math.sin(r),n=Math.cos(r),this.en),i=n*s/(e*Math.sqrt(1-this.es*i*i)),t.x=e*Math.sin(i),t.y=this.am1-e*Math.cos(i),t.x=this.a*t.x+(this.x0||0),t.y=this.a*t.y+(this.y0||0),t}function bu(t){var e,i,n,s;if(t.x=(t.x-(this.x0||0))/this.a,t.y=(t.y-(this.y0||0))/this.a,i=gc(t.x,t.y=this.am1-t.y),s=cc(this.am1+this.m1-i,this.es,this.en),(e=Math.abs(s))<Eh)e=Math.sin(s),n=i*Math.atan2(t.x,t.y)*Math.sqrt(1-this.es*e*e)/Math.cos(s);else{if(!(Math.abs(e-Eh)<=Su))throw new Error;n=0}return t.x=sl(n+(this.long0||0)),t.y=Lc(s),t}function Eu(t){var e,i,n=sl(t.x-(this.long0||0)),s=t.y;return i=this.cphi1+this.phi1-s,Math.abs(i)>Su?(t.x=i*Math.sin(e=n*Math.cos(s)/i),t.y=this.cphi1-i*Math.cos(e)):t.x=t.y=0,t.x=this.a*t.x+(this.x0||0),t.y=this.a*t.y+(this.y0||0),t}function Pu(t){var e,i;t.x=(t.x-(this.x0||0))/this.a,t.y=(t.y-(this.y0||0))/this.a;var n=gc(t.x,t.y=this.cphi1-t.y);if(i=this.cphi1+this.phi1-n,Math.abs(i)>Eh)throw new Error;return e=Math.abs(Math.abs(i)-Eh)<=Su?0:n*Math.atan2(t.x,t.y)/Math.cos(i),t.x=sl(e+(this.long0||0)),t.y=Lc(i),t}const Iu={init:function(){var t;if(this.phi1=this.lat1,Math.abs(this.phi1)<Su)throw new Error;this.es?(this.en=ac(this.es),this.m1=hc(this.phi1,this.am1=Math.sin(this.phi1),t=Math.cos(this.phi1),this.en),this.am1=t/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=bu,this.forward=Cu):(Math.abs(this.phi1)+Su>=Eh?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=Pu,this.forward=Eu)},names:["bonne","Bonne (Werner lat_1=90)"]};var Tu;Gl.defaultDatum="WGS84",Gl.Proj=Cl,Gl.WGS84=new Gl.Proj("WGS84"),Gl.Point=nc,Gl.toPoint=Fl,Gl.defs=$h,Gl.nadgrid=function(t,e){var i=new DataView(e),n=function(t){var e=t.getInt32(8,!1);return 11!==e&&(11!==(e=t.getInt32(8,!0))&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}(i),s=function(t,e){return{nFields:t.getInt32(8,e),nSubgridFields:t.getInt32(24,e),nSubgrids:t.getInt32(40,e),shiftType:vl(t,56,64).trim(),fromSemiMajorAxis:t.getFloat64(120,e),fromSemiMinorAxis:t.getFloat64(136,e),toSemiMajorAxis:t.getFloat64(152,e),toSemiMinorAxis:t.getFloat64(168,e)}}(i,n),r=function(t,e,i){for(var n=176,s=[],r=0;r<e.nSubgrids;r++){var o=Ml(t,n,i),a=wl(t,n,o,i),h=Math.round(1+(o.upperLongitude-o.lowerLongitude)/o.longitudeInterval),l=Math.round(1+(o.upperLatitude-o.lowerLatitude)/o.latitudeInterval);s.push({ll:[yl(o.lowerLongitude),yl(o.lowerLatitude)],del:[yl(o.longitudeInterval),yl(o.latitudeInterval)],lim:[h,l],count:o.gridNodeCount,cvs:xl(a)}),n+=176+16*o.gridNodeCount}return s}(i,s,n),o={header:s,subgrids:r};return _l[t]=o,o},Gl.transform=kl,Gl.mgrs=Kl,Gl.version="__VERSION__",(Tu=Gl).Proj.projections.add(uc),Tu.Proj.projections.add(_c),Tu.Proj.projections.add(mc),Tu.Proj.projections.add(xc),Tu.Proj.projections.add(Mc),Tu.Proj.projections.add(wc),Tu.Proj.projections.add(Cc),Tu.Proj.projections.add(bc),Tu.Proj.projections.add(Ec),Tu.Proj.projections.add(Oc),Tu.Proj.projections.add(Nc),Tu.Proj.projections.add(jc),Tu.Proj.projections.add(zc),Tu.Proj.projections.add(Bc),Tu.Proj.projections.add(Wc),Tu.Proj.projections.add(qc),Tu.Proj.projections.add(Xc),Tu.Proj.projections.add(Uc),Tu.Proj.projections.add(Vc),Tu.Proj.projections.add(Kc),Tu.Proj.projections.add(Yc),Tu.Proj.projections.add(Zc),Tu.Proj.projections.add(Hc),Tu.Proj.projections.add(Jc),Tu.Proj.projections.add(su),Tu.Proj.projections.add(du),Tu.Proj.projections.add(gu),Tu.Proj.projections.add(pu),Tu.Proj.projections.add(_u),Tu.Proj.projections.add(wu),Tu.Proj.projections.add(Iu);const Ru=Gl;let Au=null;function Fu(t,e){var i=e.content,n=e.title,s=e.callback,r=document.createElement("button");return r.title=n,r.innerHTML=i,r.type="button",r.addEventListener("click",(function(t){t.stopPropagation(),s()})),t.appendChild(r),r}function Lu(t,e){if("https:"!==location.protocol&&"localhost"!==location.hostname)return console.warn("Geolocation is only available with HTTPS protocol");var i=document.createElement("div");i.classList.add("ol-control","c2cgeoform-locate-me-btn"),Fu(i,{content:'<i class="glyphicon glyphicon-record"></i>',title:e.geolocationTooltip,callback:function(){return navigator.geolocation.getCurrentPosition((function(e){var i,n,s=e.coords,r=s.latitude,o=s.longitude;t.getView().animate({center:(i=[o,r],n=t.getView().getProjection(),ve(),Fe(i,"EPSG:4326",void 0!==n?n:"EPSG:3857")),duration:1500,zoom:18})}),console.warn,{enableHighAccuracy:!0})}}),$(t.getViewport()).append(i)}class ku extends li{constructor(t,e,i){super(),void 0!==i&&void 0===e?this.setFlatCoordinates(i,t):(e=e||0,this.setCenterAndRadius(t,e,i))}clone(){const t=new ku(this.flatCoordinates.slice(),void 0,this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){const s=this.flatCoordinates,r=t-s[0],o=e-s[1],a=r*r+o*o;if(a<n){if(0===a)for(let t=0;t<this.stride;++t)i[t]=s[t];else{const t=this.getRadius()/Math.sqrt(a);i[0]=s[0]+t*r,i[1]=s[1]+t*o;for(let t=2;t<this.stride;++t)i[t]=s[t]}return i.length=this.stride,a}return n}containsXY(t,e){const i=this.flatCoordinates,n=t-i[0],s=e-i[1];return n*n+s*s<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(t){const e=this.flatCoordinates,i=e[this.stride]-e[0];return J(e[0]-i,e[1]-i,e[0]+i,e[1]+i,t)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e}getType(){return"Circle"}intersectsExtent(t){if(vt(t,this.getExtent())){const e=this.getCenter();return t[0]<=e[0]&&t[2]>=e[0]||t[1]<=e[1]&&t[3]>=e[1]||at(t,this.intersectsCoordinate.bind(this))}return!1}setCenter(t){const e=this.stride,i=this.flatCoordinates[e]-this.flatCoordinates[0],n=t.slice();n[e]=n[0]+i;for(let i=1;i<e;++i)n[e+i]=t[i];this.setFlatCoordinates(this.layout,n),this.changed()}setCenterAndRadius(t,e,i){this.setLayout(i,t,0),this.flatCoordinates||(this.flatCoordinates=[]);const n=this.flatCoordinates;let s=ci(n,0,t,this.stride);n[s++]=n[0]+e;for(let t=1,e=this.stride;t<e;++t)n[s++]=n[t];n.length=s,this.changed()}getCoordinates(){return null}setCoordinates(t,e){}setRadius(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()}rotate(t,e){const i=this.getCenter(),n=this.getStride();this.setCenter(ei(i,0,i.length,n,t,e,i)),this.changed()}}ku.prototype.transform;const Ou=ku,Du={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Nu=[Du.FILL],Gu=[Du.STROKE],ju=[Du.BEGIN_PATH],zu=[Du.CLOSE_PATH],Bu=Du,Wu=class{drawCustom(t,e,i,n,s){}drawGeometry(t){}setStyle(t){}drawCircle(t,e,i){}drawFeature(t,e,i){}drawGeometryCollection(t,e,i){}drawLineString(t,e,i){}drawMultiLineString(t,e,i){}drawMultiPoint(t,e,i){}drawMultiPolygon(t,e,i){}drawPoint(t,e,i){}drawPolygon(t,e,i){}drawText(t,e,i){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}},qu=class extends Wu{constructor(t,e,i,n){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=n,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return 1==e?t:t.map((function(t){return t*e}))}appendFlatPointCoordinates(t,e){const i=this.getBufferedMaxExtent(),n=this.tmpCoordinate_,s=this.coordinates;let r=s.length;for(let o=0,a=t.length;o<a;o+=e)n[0]=t[o],n[1]=t[o+1],K(i,n)&&(s[r++]=n[0],s[r++]=n[1]);return r}appendFlatLineCoordinates(t,e,i,n,s,r){const o=this.coordinates;let a=o.length;const h=this.getBufferedMaxExtent();r&&(e+=n);let l=t[e],c=t[e+1];const u=this.tmpCoordinate_;let d,g,f,p=!0;for(d=e+n;d<i;d+=n)u[0]=t[d],u[1]=t[d+1],f=H(h,u),f!==g?(p&&(o[a++]=l,o[a++]=c,p=!1),o[a++]=u[0],o[a++]=u[1]):f===W.INTERSECTING?(o[a++]=u[0],o[a++]=u[1],p=!1):p=!0,l=u[0],c=u[1],g=f;return(s&&p||d===e+n)&&(o[a++]=l,o[a++]=c),a}drawCustomCoordinates_(t,e,i,n,s){for(let r=0,o=i.length;r<o;++r){const o=i[r],a=this.appendFlatLineCoordinates(t,e,o,n,!1,!1);s.push(a),e=o}return e}drawCustom(t,e,i,n,s){this.beginGeometry(t,e,s);const r=t.getType(),o=t.getStride(),a=this.coordinates.length;let h,l,c,u,d;switch(r){case"MultiPolygon":h=t.getOrientedFlatCoordinates(),u=[];const e=t.getEndss();d=0;for(let t=0,i=e.length;t<i;++t){const i=[];d=this.drawCustomCoordinates_(h,d,e[t],o,i),u.push(i)}this.instructions.push([Bu.CUSTOM,a,u,t,i,Ci,s]),this.hitDetectionInstructions.push([Bu.CUSTOM,a,u,t,n||i,Ci,s]);break;case"Polygon":case"MultiLineString":c=[],h="Polygon"==r?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),d=this.drawCustomCoordinates_(h,0,t.getEnds(),o,c),this.instructions.push([Bu.CUSTOM,a,c,t,i,Si,s]),this.hitDetectionInstructions.push([Bu.CUSTOM,a,c,t,n||i,Si,s]);break;case"LineString":case"Circle":h=t.getFlatCoordinates(),l=this.appendFlatLineCoordinates(h,0,h.length,o,!1,!1),this.instructions.push([Bu.CUSTOM,a,l,t,i,wi,s]),this.hitDetectionInstructions.push([Bu.CUSTOM,a,l,t,n||i,wi,s]);break;case"MultiPoint":h=t.getFlatCoordinates(),l=this.appendFlatPointCoordinates(h,o),l>a&&(this.instructions.push([Bu.CUSTOM,a,l,t,i,wi,s]),this.hitDetectionInstructions.push([Bu.CUSTOM,a,l,t,n||i,wi,s]));break;case"Point":h=t.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),l=this.coordinates.length,this.instructions.push([Bu.CUSTOM,a,l,t,i,void 0,s]),this.hitDetectionInstructions.push([Bu.CUSTOM,a,l,t,n||i,void 0,s])}this.endGeometry(e)}beginGeometry(t,e,i){this.beginGeometryInstruction1_=[Bu.BEGIN_GEOMETRY,e,0,t,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Bu.BEGIN_GEOMETRY,e,0,t,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;let e;t.reverse();const i=t.length;let n,s,r=-1;for(e=0;e<i;++e)n=t[e],s=n[0],s==Bu.END_GEOMETRY?r=e:s==Bu.BEGIN_GEOMETRY&&(n[2]=e,a(this.hitDetectionInstructions,r,e),r=-1)}setFillStrokeStyle(t,e){const i=this.state;if(t){const e=t.getColor();i.fillPatternScale=e&&"object"==typeof e&&"src"in e?this.pixelRatio:1,i.fillStyle=sr(e||gr)}else i.fillStyle=void 0;if(e){const t=e.getColor();i.strokeStyle=sr(t||mr);const n=e.getLineCap();i.lineCap=void 0!==n?n:fr;const s=e.getLineDash();i.lineDash=s?s.slice():pr;const r=e.getLineDashOffset();i.lineDashOffset=r||0;const o=e.getLineJoin();i.lineJoin=void 0!==o?o:_r;const a=e.getWidth();i.lineWidth=void 0!==a?a:1;const h=e.getMiterLimit();i.miterLimit=void 0!==h?h:10,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0}createFill(t){const e=t.fillStyle,i=[Bu.SET_FILL_STYLE,e];return"string"!=typeof e&&i.push(t.fillPatternScale),i}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[Bu.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const i=t.fillStyle;"string"==typeof i&&t.currentFillStyle==i||(void 0!==i&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)}updateStrokeStyle(t,e){const i=t.strokeStyle,n=t.lineCap,s=t.lineDash,r=t.lineDashOffset,o=t.lineJoin,a=t.lineWidth,h=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=n||s!=t.currentLineDash&&!l(t.currentLineDash,s)||t.currentLineDashOffset!=r||t.currentLineJoin!=o||t.currentLineWidth!=a||t.currentMiterLimit!=h)&&(void 0!==i&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=n,t.currentLineDash=s,t.currentLineDashOffset=r,t.currentLineJoin=o,t.currentLineWidth=a,t.currentMiterLimit=h)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[Bu.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=U(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;X(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}},Xu=class extends qu{constructor(t,e,i,n){super(t,e,i,n)}drawFlatCoordinatess_(t,e,i,n){const s=this.state,r=void 0!==s.fillStyle,o=void 0!==s.strokeStyle,a=i.length;this.instructions.push(ju),this.hitDetectionInstructions.push(ju);for(let s=0;s<a;++s){const r=i[s],a=this.coordinates.length,h=this.appendFlatLineCoordinates(t,e,r,n,!0,!o),l=[Bu.MOVE_TO_LINE_TO,a,h];this.instructions.push(l),this.hitDetectionInstructions.push(l),o&&(this.instructions.push(zu),this.hitDetectionInstructions.push(zu)),e=r}return r&&(this.instructions.push(Nu),this.hitDetectionInstructions.push(Nu)),o&&(this.instructions.push(Gu),this.hitDetectionInstructions.push(Gu)),e}drawCircle(t,e,i){const n=this.state,s=n.fillStyle,r=n.strokeStyle;if(void 0===s&&void 0===r)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([Bu.SET_FILL_STYLE,gr]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([Bu.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,pr,0]);const o=t.getFlatCoordinates(),a=t.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,a,!1,!1);const l=[Bu.CIRCLE,h];this.instructions.push(ju,l),this.hitDetectionInstructions.push(ju,l),void 0!==n.fillStyle&&(this.instructions.push(Nu),this.hitDetectionInstructions.push(Nu)),void 0!==n.strokeStyle&&(this.instructions.push(Gu),this.hitDetectionInstructions.push(Gu)),this.endGeometry(e)}drawPolygon(t,e,i){const n=this.state,s=n.fillStyle,r=n.strokeStyle;if(void 0===s&&void 0===r)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([Bu.SET_FILL_STYLE,gr]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([Bu.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,pr,0]);const o=t.getEnds(),a=t.getOrientedFlatCoordinates(),h=t.getStride();this.drawFlatCoordinatess_(a,0,o,h),this.endGeometry(e)}drawMultiPolygon(t,e,i){const n=this.state,s=n.fillStyle,r=n.strokeStyle;if(void 0===s&&void 0===r)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([Bu.SET_FILL_STYLE,gr]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([Bu.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,pr,0]);const o=t.getEndss(),a=t.getOrientedFlatCoordinates(),h=t.getStride();let l=0;for(let t=0,e=o.length;t<e;++t)l=this.drawFlatCoordinatess_(a,l,o[t],h);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(0!==t){const e=this.coordinates;for(let i=0,n=e.length;i<n;++i)e[i]=Ot(e[i],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)}};function Uu(t,e,i,n,s){const r=[];let o=i,a=0,h=e.slice(i,2);for(;a<t&&o+s<n;){const[i,n]=h.slice(-2),l=e[o+s],c=e[o+s+1],u=Math.sqrt((l-i)*(l-i)+(c-n)*(c-n));if(a+=u,a>=t){const e=(t-a+u)/u,d=It(i,l,e),g=It(n,c,e);h.push(d,g),r.push(h),h=[d,g],a==t&&(o+=s),a=0}else if(a<t)h.push(e[o+s],e[o+s+1]),o+=s;else{const t=u-a,e=It(i,l,t/u),d=It(n,c,t/u);h.push(e,d),r.push(h),h=[e,d],a=0,o+=s}}return a>0&&r.push(h),r}function Vu(t,e,i,n,s){let r,o,a,h,l,c,u,d,g,f,p=i,_=i,m=0,y=0,v=i;for(o=i;o<n;o+=s){const i=e[o],n=e[o+1];void 0!==l&&(g=i-l,f=n-c,h=Math.sqrt(g*g+f*f),void 0!==u&&(y+=a,r=Math.acos((u*g+d*f)/(a*h)),r>t&&(y>m&&(m=y,p=v,_=o),y=0,v=o-s)),a=h,u=g,d=f),l=i,c=n}return y+=h,y>m?[v,o]:[p,_]}const Ku={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},Yu={Circle:Xu,Default:qu,Image:class extends qu{constructor(t,e,i,n){super(t,e,i,n),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e,i){if(!this.image_||this.maxExtent&&!K(this.maxExtent,t.getFlatCoordinates()))return;this.beginGeometry(t,e,i);const n=t.getFlatCoordinates(),s=t.getStride(),r=this.coordinates.length,o=this.appendFlatPointCoordinates(n,s);this.instructions.push([Bu.DRAW_IMAGE,r,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Bu.DRAW_IMAGE,r,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e,i){if(!this.image_)return;this.beginGeometry(t,e,i);const n=t.getFlatCoordinates(),s=[];for(let e=0,i=n.length;e<i;e+=t.getStride())this.maxExtent&&!K(this.maxExtent,n.slice(e,e+2))||s.push(n[e],n[e+1]);const r=this.coordinates.length,o=this.appendFlatPointCoordinates(s,2);this.instructions.push([Bu.DRAW_IMAGE,r,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Bu.DRAW_IMAGE,r,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const i=t.getAnchor(),n=t.getSize(),s=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=n[1],this.opacity_=t.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=n[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}},LineString:class extends qu{constructor(t,e,i,n){super(t,e,i,n)}drawFlatCoordinates_(t,e,i,n){const s=this.coordinates.length,r=this.appendFlatLineCoordinates(t,e,i,n,!1,!1),o=[Bu.MOVE_TO_LINE_TO,s,r];return this.instructions.push(o),this.hitDetectionInstructions.push(o),i}drawLineString(t,e,i){const n=this.state,s=n.strokeStyle,r=n.lineWidth;if(void 0===s||void 0===r)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([Bu.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,pr,0],ju);const o=t.getFlatCoordinates(),a=t.getStride();this.drawFlatCoordinates_(o,0,o.length,a),this.hitDetectionInstructions.push(Gu),this.endGeometry(e)}drawMultiLineString(t,e,i){const n=this.state,s=n.strokeStyle,r=n.lineWidth;if(void 0===s||void 0===r)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([Bu.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,pr,0],ju);const o=t.getEnds(),a=t.getFlatCoordinates(),h=t.getStride();let l=0;for(let t=0,e=o.length;t<e;++t)l=this.drawFlatCoordinates_(a,l,o[t],h);this.hitDetectionInstructions.push(Gu),this.endGeometry(e)}finish(){const t=this.state;return null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(Gu),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(Gu),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(ju)}},Polygon:Xu,Text:class extends qu{constructor(t,e,i,n){super(t,e,i,n),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[gr]={fillStyle:gr},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e,i){const n=this.textFillState_,s=this.textStrokeState_,r=this.textState_;if(""===this.text_||!r||!n&&!s)return;const o=this.coordinates;let a=o.length;const h=t.getType();let l=null,c=t.getStride();if("line"!==r.placement||"LineString"!=h&&"MultiLineString"!=h&&"Polygon"!=h&&"MultiPolygon"!=h){let n=r.overflow?null:[];switch(h){case"Point":case"MultiPoint":l=t.getFlatCoordinates();break;case"LineString":l=t.getFlatMidpoint();break;case"Circle":l=t.getCenter();break;case"MultiLineString":l=t.getFlatMidpoints(),c=2;break;case"Polygon":l=t.getFlatInteriorPoint(),r.overflow||n.push(l[2]/this.resolution),c=3;break;case"MultiPolygon":const e=t.getFlatInteriorPoints();l=[];for(let t=0,i=e.length;t<i;t+=3)r.overflow||n.push(e[t+2]/this.resolution),l.push(e[t],e[t+1]);if(0===l.length)return;c=2}const s=this.appendFlatPointCoordinates(l,c);if(s===a)return;if(n&&(s-a)/2!=l.length/c){let t=a/2;n=n.filter(((e,i)=>{const n=o[2*(t+i)]===l[i*c]&&o[2*(t+i)+1]===l[i*c+1];return n||--t,n}))}this.saveTextStates_(),(r.backgroundFill||r.backgroundStroke)&&(this.setFillStrokeStyle(r.backgroundFill,r.backgroundStroke),r.backgroundFill&&this.updateFillStyle(this.state,this.createFill),r.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e,i);let u=r.padding;if(u!=xr&&(r.scale[0]<0||r.scale[1]<0)){let t=r.padding[0],e=r.padding[1],i=r.padding[2],n=r.padding[3];r.scale[0]<0&&(e=-e,n=-n),r.scale[1]<0&&(t=-t,i=-i),u=[t,e,i,n]}const d=this.pixelRatio;this.instructions.push([Bu.DRAW_IMAGE,a,s,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,u==xr?xr:u.map((function(t){return t*d})),!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,n]);const g=1/d,f=this.state.fillStyle;r.backgroundFill&&(this.state.fillStyle=gr,this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([Bu.DRAW_IMAGE,a,s,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[g,g],NaN,this.declutterMode_,this.declutterImageWithText_,u,!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?gr:this.fillKey_,this.textOffsetX_,this.textOffsetY_,n]),r.backgroundFill&&(this.state.fillStyle=f,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(e)}else{if(!vt(this.maxExtent,t.getExtent()))return;let n;if(l=t.getFlatCoordinates(),"LineString"==h)n=[l.length];else if("MultiLineString"==h)n=t.getEnds();else if("Polygon"==h)n=t.getEnds().slice(0,1);else if("MultiPolygon"==h){const e=t.getEndss();n=[];for(let t=0,i=e.length;t<i;++t)n.push(e[t][0])}this.beginGeometry(t,e,i);const s=r.repeat,u=s?void 0:r.textAlign;let d=0;for(let t=0,e=n.length;t<e;++t){let e;e=s?Uu(s*this.resolution,l,d,n[t],c):[l.slice(d,n[t])];for(let i=0,s=e.length;i<s;++i){const s=e[i];let h=0,l=s.length;if(null==u){const t=Vu(r.maxAngle,s,0,s.length,2);h=t[0],l=t[1]}for(let t=h;t<l;t+=c)o.push(s[t],s[t+1]);const g=o.length;d=n[t],this.drawChars_(a,g),a=g}}this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,n=this.strokeKey_;t&&(n in this.strokeStates||(this.strokeStates[n]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:e.font,textAlign:e.textAlign||yr,justify:e.justify,textBaseline:e.textBaseline||vr,scale:e.scale});const r=this.fillKey_;i&&(r in this.fillStates||(this.fillStates[r]={fillStyle:i.fillStyle}))}drawChars_(t,e){const i=this.textStrokeState_,n=this.textState_,s=this.strokeKey_,r=this.textKey_,o=this.fillKey_;this.saveTextStates_();const a=this.pixelRatio,h=Ku[n.textBaseline],l=this.textOffsetY_*a,c=this.text_,u=i?i.lineWidth*Math.abs(n.scale[0])/2:0;this.instructions.push([Bu.DRAW_CHARS,t,e,h,n.overflow,o,n.maxAngle,a,l,s,u*a,c,r,1,this.declutterMode_]),this.hitDetectionInstructions.push([Bu.DRAW_CHARS,t,e,h,n.overflow,o?gr:o,n.maxAngle,a,l,s,u*a,c,r,1/a,this.declutterMode_])}setTextStyle(t,e){let i,n,s;if(t){const e=t.getFill();e?(n=this.textFillState_,n||(n={},this.textFillState_=n),n.fillStyle=sr(e.getColor()||gr)):(n=null,this.textFillState_=n);const r=t.getStroke();if(r){s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const t=r.getLineDash(),e=r.getLineDashOffset(),i=r.getWidth(),n=r.getMiterLimit();s.lineCap=r.getLineCap()||fr,s.lineDash=t?t.slice():pr,s.lineDashOffset=void 0===e?0:e,s.lineJoin=r.getLineJoin()||_r,s.lineWidth=void 0===i?1:i,s.miterLimit=void 0===n?10:n,s.strokeStyle=sr(r.getColor()||mr)}else s=null,this.textStrokeState_=s;i=this.textState_;const o=t.getFont()||dr;br(o);const a=t.getScaleArray();i.overflow=t.getOverflow(),i.font=o,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.repeat=t.getRepeat(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||vr,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||xr,i.scale=void 0===a?[1,1]:a;const h=t.getOffsetX(),l=t.getOffsetY(),c=t.getRotateWithView(),u=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===h?0:h,this.textOffsetY_=void 0===l?0:l,this.textRotateWithView_=void 0!==c&&c,this.textRotation_=void 0===u?0:u,this.strokeKey_=s?("string"==typeof s.strokeStyle?s.strokeStyle:F(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=n&&n.fillStyle?"string"==typeof n.fillStyle?n.fillStyle:"|"+F(n.fillStyle):""}else this.text_="";this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}},Zu=class{constructor(t,e,i,n){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=n,this.resolution_=i,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const i=this.buildersByZIndex_[e];for(const n in i){const s=i[n].finish();t[e][n]=s}}return t}getBuilder(t,e){const i=void 0!==t?t.toString():"0";let n=this.buildersByZIndex_[i];void 0===n&&(n={},this.buildersByZIndex_[i]=n);let s=n[e];return void 0===s&&(s=new(0,Yu[e])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),n[e]=s),s}},Hu=class extends T{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.staleKeys_=new Array,this.maxStaleKeys=5}getStaleKeys(){return this.staleKeys_}prependStaleKey(t){this.staleKeys_.unshift(t),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(t){return R()}getData(t){return null}prepareFrame(t){return R()}renderFrame(t,e){return R()}forEachFeatureAtCoordinate(t,e,i,n,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const e=t.target;e.getState()!==ls&&e.getState()!==cs||this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return e!=ls&&e!=cs&&t.addEventListener(y,this.boundHandleImageChange_),e==as&&(t.load(),e=t.getState()),e==ls}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&"ready"===t.getSourceState()&&t.changed()}renderDeferred(t){}disposeInternal(){delete this.layer_,super.disposeInternal()}},Ju=class{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(Ks(),{get:(t,e)=>{if("function"==typeof Ks()[e])return this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(e),this.pushMethodArgs_},set:(t,e,i)=>(this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(e,i),!0)})}pushMethodArgs_=(...t)=>(this.instructions_[this.zIndex+this.offset_].push(t),this);pushFunction(t){this.instructions_[this.zIndex+this.offset_].push(t)}getContext(){return this.context_}draw(t){this.instructions_.forEach((e=>{for(let i=0,n=e.length;i<n;++i){const n=e[i];if("function"==typeof n){n(t);continue}const s=e[++i];if("function"==typeof t[n])t[n](...s);else{if("function"==typeof s){t[n]=s(t);continue}t[n]=s}}}))}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}},$u=[];let Qu=null;const td=class extends Hu{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=[1,0,0,1,0,0],this.pixelTransform=[1,0,0,1,0,0],this.inversePixelTransform=[1,0,0,1,0,0],this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(t,e,i){let n;Qu||(Qu=Us(1,1,void 0,{willReadFrequently:!0})),Qu.clearRect(0,0,1,1);try{Qu.drawImage(t,e,i,1,1,0,0,1,1),n=Qu.getImageData(0,0,1,1).data}catch(t){return Qu=null,null}return n}getBackground(t){let e=this.getLayer().getBackground();return"function"==typeof e&&(e=e(t.viewState.resolution)),e||void 0}useContainer(t,e,i){const n=this.getLayer().getClassName();let s,r;if(t&&t.className===n&&(!i||t&&t.style.backgroundColor&&l(Ls(t.style.backgroundColor),Ls(i)))){const e=t.firstElementChild;e instanceof HTMLCanvasElement&&(r=e.getContext("2d"))}if(r&&r.canvas.style.transform===e?(this.container=t,this.context=r,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=document.createElement("div"),s.className=n;let t=s.style;t.position="absolute",t.width="100%",t.height="100%",r=Us();const e=r.canvas;s.appendChild(e),t=e.style,t.position="absolute",t.left="0",t.transformOrigin="top left",this.container=s,this.context=r}this.containerReused||!i||this.container.style.backgroundColor||(this.container.style.backgroundColor=i)}clipUnrotated(t,e,i){const n=_t(i),s=mt(i),r=ct(i),o=lt(i);G(e.coordinateToPixelTransform,n),G(e.coordinateToPixelTransform,s),G(e.coordinateToPixelTransform,r),G(e.coordinateToPixelTransform,o);const a=this.inversePixelTransform;G(a,n),G(a,s),G(a,r),G(a,o),t.save(),t.beginPath(),t.moveTo(Math.round(n[0]),Math.round(n[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.clip()}prepareContainer(t,e){const i=t.extent,n=t.viewState.resolution,s=t.viewState.rotation,r=t.pixelRatio,o=Math.round(yt(i)/n*r),a=Math.round(ft(i)/n*r);j(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/r,1/r,s,-o/2,-a/2),z(this.inversePixelTransform,this.pixelTransform);const h="matrix("+this.pixelTransform.map(((t,e)=>Math.round(t*B[e])/B[e])).join(", ")+")";if(this.useContainer(e,h,this.getBackground(t)),!this.containerReused){const t=this.context.canvas;t.width!=o||t.height!=a?(t.width=o,t.height=a):this.context.clearRect(0,0,o,a),h!==t.style.transform&&(t.style.transform=h)}}dispatchRenderEvent_(t,e,i){const n=this.getLayer();if(n.hasListener(t)){const s=new ta(t,this.inversePixelTransform,i,e);n.dispatchEvent(s)}}preRender(t,e){this.frameState=e,e.declutter||this.dispatchRenderEvent_(xn,t,e)}postRender(t,e){e.declutter||this.dispatchRenderEvent_(Mn,t,e)}renderDeferredInternal(t){}getRenderContext(t){return t.declutter&&!this.deferredContext_&&(this.deferredContext_=new Ju),t.declutter?this.deferredContext_.getContext():this.context}renderDeferred(t){t.declutter&&(this.dispatchRenderEvent_(xn,this.context,t),t.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(t),this.dispatchRenderEvent_(Mn,this.context,t))}getRenderTransform(t,e,i,n,s,r,o){const a=s/2,h=r/2,l=n/e,c=-l,u=-t[0]+o,d=-t[1];return j(this.tempTransform,a,h,l,c,-i,u,d)}disposeInternal(){delete this.frameState,super.disposeInternal()}};function ed(t,e,i,n,s,r,o,a,h,l,c,u){let d=t[e],g=t[e+1],f=0,p=0,_=0,m=0;function y(){f=d,p=g,d=t[e+=n],g=t[e+1],m+=_,_=Math.sqrt((d-f)*(d-f)+(g-p)*(g-p))}do{y()}while(e<i-n&&m+_<r);let v=0===_?0:(r-m)/_;const x=It(f,d,v),M=It(p,g,v),w=e-n,S=m,C=r+a*h(l,s,c);for(;e<i-n&&m+_<C;)y();v=0===_?0:(C-m)/_;const b=It(f,d,v),E=It(p,g,v);let P;if(u){const t=[x,M,b,E];ei(t,0,4,2,u,t,t),P=t[0]>t[2]}else P=x>b;const I=Math.PI,T=[],R=w+n===e;let A;if(_=0,m=S,d=t[e=w],g=t[e+1],R){y(),A=Math.atan2(g-p,d-f),P&&(A+=A>0?-I:I);const t=(b+x)/2,e=(E+M)/2;return T[0]=[t,e,(C-r)/2,A,s],T}for(let t=0,u=(s=s.replace(/\n/g," ")).length;t<u;){y();let x=Math.atan2(g-p,d-f);if(P&&(x+=x>0?-I:I),void 0!==A){let t=x-A;if(t+=t>I?-2*I:t<-I?2*I:0,Math.abs(t)>o)return null}A=x;const M=t;let w=0;for(;t<u;++t){const o=a*h(l,s[P?u-t-1:t],c);if(e+n<i&&m+_<r+w+o/2)break;w+=o}if(t===M)continue;const S=P?s.substring(u-M,u-t):s.substring(M,t);v=0===_?0:(r+w/2-m)/_;const C=It(f,d,v),b=It(p,g,v);T.push([C,b,w/2,x,S]),r+=w}return T}const id=[1/0,1/0,-1/0,-1/0],nd=[],sd=[],rd=[],od=[];function ad(t){return t[3].declutterBox}const hd=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function ld(t,e){return"start"===e?e=hd.test(t)?"right":"left":"end"===e&&(e=hd.test(t)?"left":"right"),Ku[e]}function cd(t,e,i){return i>0&&t.push("\n",""),t.push(e,""),t}const ud=class{constructor(t,e,i,n,s){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.alignAndScaleFill_,this.instructions=n.instructions,this.coordinates=n.coordinates,this.coordinateCache_={},this.renderedTransform_=[1,0,0,1,0,0],this.hitDetectionInstructions=n.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=n.fillStates||{},this.strokeStates=n.strokeStates||{},this.textStates=n.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new Ju:null}getZIndexContext(){return this.zIndexContext_}createLabel(t,e,i,n){const s=t+e+i+n;if(this.labels_[s])return this.labels_[s];const r=n?this.strokeStates[n]:null,o=i?this.fillStates[i]:null,a=this.textStates[e],h=this.pixelRatio,l=[a.scale[0]*h,a.scale[1]*h],c=a.justify?Ku[a.justify]:ld(Array.isArray(t)?t[0]:t,a.textAlign||yr),u=n&&r.lineWidth?r.lineWidth:0,d=Array.isArray(t)?t:String(t).split("\n").reduce(cd,[]),{width:g,height:f,widths:p,heights:_,lineWidths:m}=function(t,e){const i=[],n=[],s=[];let r=0,o=0,a=0,h=0;for(let l=0,c=e.length;l<=c;l+=2){const u=e[l];if("\n"===u||l===c){r=Math.max(r,o),s.push(o),o=0,a+=h,h=0;continue}const d=e[l+1]||t.font,g=Ir(d,u);i.push(g),o+=g;const f=Er(d);n.push(f),h=Math.max(h,f)}return{width:r,height:a,widths:i,heights:n,lineWidths:s}}(a,d),y=g+u,v=[],x=(y+2)*l[0],M=(f+u)*l[1],w={width:x<0?Math.floor(x):Math.ceil(x),height:M<0?Math.floor(M):Math.ceil(M),contextInstructions:v};1==l[0]&&1==l[1]||v.push("scale",l),n&&(v.push("strokeStyle",r.strokeStyle),v.push("lineWidth",u),v.push("lineCap",r.lineCap),v.push("lineJoin",r.lineJoin),v.push("miterLimit",r.miterLimit),v.push("setLineDash",[r.lineDash]),v.push("lineDashOffset",r.lineDashOffset)),i&&v.push("fillStyle",o.fillStyle),v.push("textBaseline","middle"),v.push("textAlign","center");const S=.5-c;let C=c*y+S*u;const b=[],E=[];let P,I=0,T=0,R=0,A=0;for(let t=0,e=d.length;t<e;t+=2){const e=d[t];if("\n"===e){T+=I,I=0,C=c*y+S*u,++A;continue}const s=d[t+1]||a.font;s!==P&&(n&&b.push("font",s),i&&E.push("font",s),P=s),I=Math.max(I,_[R]);const r=[e,C+S*p[R]+c*(p[R]-m[A]),.5*(u+I)+T];C+=p[R],n&&b.push("strokeText",r),i&&E.push("fillText",r),++R}return Array.prototype.push.apply(v,b),Array.prototype.push.apply(v,E),this.labels_[s]=w,w}replayTextBackground_(t,e,i,n,s,r,o){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,n),t.lineTo.apply(t,s),t.lineTo.apply(t,e),r&&(this.alignAndScaleFill_=r[2],this.fill_(t)),o&&(this.setStrokeStyle_(t,o),t.stroke())}calculateImageOrLabelDimensions_(t,e,i,n,s,r,o,a,h,l,c,u,d,g,f,p){let _=i-(o*=u[0]),m=n-(a*=u[1]);const y=s+h>t?t-h:s,v=r+l>e?e-l:r,x=g[3]+y*u[0]+g[1],M=g[0]+v*u[1]+g[2],w=_-g[3],S=m-g[0];let C;return(f||0!==c)&&(nd[0]=w,od[0]=w,nd[1]=S,sd[1]=S,sd[0]=w+x,rd[0]=sd[0],rd[1]=S+M,od[1]=rd[1]),0!==c?(C=j([1,0,0,1,0,0],i,n,1,1,c,-i,-n),G(C,nd),G(C,sd),G(C,rd),G(C,od),J(Math.min(nd[0],sd[0],rd[0],od[0]),Math.min(nd[1],sd[1],rd[1],od[1]),Math.max(nd[0],sd[0],rd[0],od[0]),Math.max(nd[1],sd[1],rd[1],od[1]),id)):J(Math.min(w,w+x),Math.min(S,S+M),Math.max(w,w+x),Math.max(S,S+M),id),d&&(_=Math.round(_),m=Math.round(m)),{drawImageX:_,drawImageY:m,drawImageW:y,drawImageH:v,originX:h,originY:l,declutterBox:{minX:id[0],minY:id[1],maxX:id[2],maxY:id[3],value:p},canvasTransform:C,scale:u}}replayImageOrLabel_(t,e,i,n,s,r,o){const a=!(!r&&!o),h=n.declutterBox,l=o?o[2]*n.scale[0]/2:0;return h.minX-l<=e[0]&&h.maxX+l>=0&&h.minY-l<=e[1]&&h.maxY+l>=0&&(a&&this.replayTextBackground_(t,nd,sd,rd,od,r,o),function(t,e,i,n,s,r,o,a,h,l,c){t.save(),1!==i&&(void 0===t.globalAlpha?t.globalAlpha=t=>t.globalAlpha*=i:t.globalAlpha*=i),e&&t.transform.apply(t,e),n.contextInstructions?(t.translate(h,l),t.scale(c[0],c[1]),function(t,e){const i=t.contextInstructions;for(let t=0,n=i.length;t<n;t+=2)Array.isArray(i[t+1])?e[i[t]].apply(e,i[t+1]):e[i[t]]=i[t+1]}(n,t)):c[0]<0||c[1]<0?(t.translate(h,l),t.scale(c[0],c[1]),t.drawImage(n,s,r,o,a,0,0,o,a)):t.drawImage(n,s,r,o,a,h,l,o*c[0],a*c[1]),t.restore()}(t,n.canvasTransform,s,i,n.originX,n.originY,n.drawImageW,n.drawImageH,n.drawImageX,n.drawImageY,n.scale)),!0}fill_(t){const e=this.alignAndScaleFill_;if(e){const i=G(this.renderedTransform_,[0,0]),n=512*this.pixelRatio;t.save(),t.translate(i[0]%n,i[1]%n),1!==e&&t.scale(e,e),t.rotate(this.viewRotation_)}t.fill(),e&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}drawLabelWithPointPlacement_(t,e,i,n){const s=this.textStates[e],r=this.createLabel(t,e,n,i),o=this.strokeStates[i],a=this.pixelRatio,h=ld(Array.isArray(t)?t[0]:t,s.textAlign||yr),l=Ku[s.textBaseline||vr],c=o&&o.lineWidth?o.lineWidth:0;return{label:r,anchorX:h*(r.width/a-2*s.scale[0])+2*(.5-h)*c,anchorY:l*r.height/a+2*(.5-l)*c}}execute_(t,e,i,n,s,r,o,a){const h=this.zIndexContext_;let c;var u,d;this.pixelCoordinates_&&l(i,this.renderedTransform_)?c=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),c=ti(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),d=i,(u=this.renderedTransform_)[0]=d[0],u[1]=d[1],u[2]=d[2],u[3]=d[3],u[4]=d[4],u[5]=d[5]);let g=0;const f=n.length;let p,_,m,y,v,x,M,w,S,C,b,E,P,I=0,T=0,R=0,A=null,F=null;const L=this.coordinateCache_,k=this.viewRotation_,O=Math.round(1e12*Math.atan2(-i[1],i[0]))/1e12,D={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:k},N=this.instructions!=n||this.overlaps?0:200;let G,j,z,B;for(;g<f;){const i=n[g];switch(i[0]){case Bu.BEGIN_GEOMETRY:G=i[1],B=i[3],G.getGeometry()?void 0===o||vt(o,B.getExtent())?++g:g=i[2]+1:g=i[2],h&&(h.zIndex=i[4]);break;case Bu.BEGIN_PATH:T>N&&(this.fill_(t),T=0),R>N&&(t.stroke(),R=0),T||R||(t.beginPath(),v=NaN,x=NaN),++g;break;case Bu.CIRCLE:I=i[1];const n=c[I],l=c[I+1],u=c[I+2]-n,d=c[I+3]-l,f=Math.sqrt(u*u+d*d);t.moveTo(n+f,l),t.arc(n,l,f,0,2*Math.PI,!0),++g;break;case Bu.CLOSE_PATH:t.closePath(),++g;break;case Bu.CUSTOM:I=i[1],p=i[2];const W=i[3],q=i[4],X=i[5];D.geometry=W,D.feature=G,g in L||(L[g]=[]);const U=L[g];X?X(c,I,p,2,U):(U[0]=c[I],U[1]=c[I+1],U.length=2),h&&(h.zIndex=i[6]),q(U,D),++g;break;case Bu.DRAW_IMAGE:I=i[1],p=i[2],S=i[3],_=i[4],m=i[5];let V=i[6];const K=i[7],Y=i[8],Z=i[9],H=i[10];let J=i[11];const $=i[12];let Q=i[13];y=i[14]||"declutter";const tt=i[15];if(!S&&i.length>=20){C=i[19],b=i[20],E=i[21],P=i[22];const t=this.drawLabelWithPointPlacement_(C,b,E,P);S=t.label,i[3]=S;const e=i[23];_=(t.anchorX-e)*this.pixelRatio,i[4]=_;const n=i[24];m=(t.anchorY-n)*this.pixelRatio,i[5]=m,V=S.height,i[6]=V,Q=S.width,i[13]=Q}let et,it,nt,st;i.length>25&&(et=i[25]),i.length>17?(it=i[16],nt=i[17],st=i[18]):(it=xr,nt=!1,st=!1),H&&O?J+=k:H||O||(J-=k);let rt=0;for(;I<p;I+=2){if(et&&et[rt++]<Q/this.pixelRatio)continue;const i=this.calculateImageOrLabelDimensions_(S.width,S.height,c[I],c[I+1],Q,V,_,m,Y,Z,J,$,s,it,nt||st,G),n=[t,e,S,i,K,nt?A:null,st?F:null];if(a){let t,e,s,r,o;if(tt){const i=p-I;if(!tt[i]){tt[i]={args:n,declutterMode:y};continue}const r=tt[i];t=r.args,e=r.declutterMode,delete tt[i],s=ad(t)}if(!t||"declutter"===e&&a.collides(s)||(r=!0),"declutter"===y&&a.collides(i.declutterBox)||(o=!0),"declutter"===e&&"declutter"===y){const t=r&&o;r=t,o=t}r&&("none"!==e&&a.insert(s),this.replayImageOrLabel_.apply(this,t)),o&&("none"!==y&&a.insert(i.declutterBox),this.replayImageOrLabel_.apply(this,n))}else this.replayImageOrLabel_.apply(this,n)}++g;break;case Bu.DRAW_CHARS:const ot=i[1],at=i[2],ht=i[3],lt=i[4];P=i[5];const ct=i[6],ut=i[7],dt=i[8];E=i[9];const gt=i[10];C=i[11],b=i[12];const ft=[i[13],i[13]];y=i[14]||"declutter";const pt=this.textStates[b],_t=pt.font,mt=[pt.scale[0]*ut,pt.scale[1]*ut];let yt;_t in this.widths_?yt=this.widths_[_t]:(yt={},this.widths_[_t]=yt);const xt=Ii(c,ot,at,2),Mt=Math.abs(mt[0])*Tr(_t,C,yt);if(lt||Mt<=xt){const i=ed(c,ot,at,2,C,(xt-Mt)*ld(C,this.textStates[b].textAlign),ct,Math.abs(mt[0]),Tr,_t,yt,O?0:this.viewRotation_);t:if(i){const n=[];let s,r,o,h,l;if(E)for(s=0,r=i.length;s<r;++s){l=i[s],o=l[4],h=this.createLabel(o,b,"",E),_=l[2]+(mt[0]<0?-gt:gt),m=ht*h.height+2*(.5-ht)*gt*mt[1]/mt[0]-dt;const r=this.calculateImageOrLabelDimensions_(h.width,h.height,l[0],l[1],h.width,h.height,_,m,0,0,l[3],ft,!1,xr,!1,G);if(a&&"declutter"===y&&a.collides(r.declutterBox))break t;n.push([t,e,h,r,1,null,null])}if(P)for(s=0,r=i.length;s<r;++s){l=i[s],o=l[4],h=this.createLabel(o,b,P,""),_=l[2],m=ht*h.height-dt;const r=this.calculateImageOrLabelDimensions_(h.width,h.height,l[0],l[1],h.width,h.height,_,m,0,0,l[3],ft,!1,xr,!1,G);if(a&&"declutter"===y&&a.collides(r.declutterBox))break t;n.push([t,e,h,r,1,null,null])}a&&"none"!==y&&a.load(n.map(ad));for(let t=0,e=n.length;t<e;++t)this.replayImageOrLabel_.apply(this,n[t])}}++g;break;case Bu.END_GEOMETRY:if(void 0!==r){G=i[1];const t=r(G,B,y);if(t)return t}++g;break;case Bu.FILL:N?T++:this.fill_(t),++g;break;case Bu.MOVE_TO_LINE_TO:for(I=i[1],p=i[2],j=c[I],z=c[I+1],t.moveTo(j,z),v=j+.5|0,x=z+.5|0,I+=2;I<p;I+=2)j=c[I],z=c[I+1],M=j+.5|0,w=z+.5|0,I!=p-2&&M===v&&w===x||(t.lineTo(j,z),v=M,x=w);++g;break;case Bu.SET_FILL_STYLE:A=i,this.alignAndScaleFill_=i[2],T&&(this.fill_(t),T=0,R&&(t.stroke(),R=0)),t.fillStyle=i[1],++g;break;case Bu.SET_STROKE_STYLE:F=i,R&&(t.stroke(),R=0),this.setStrokeStyle_(t,i),++g;break;case Bu.STROKE:N?R++:t.stroke(),++g;break;default:++g}}T&&this.fill_(t),R&&t.stroke()}execute(t,e,i,n,s,r){this.viewRotation_=n,this.execute_(t,e,i,this.instructions,s,void 0,void 0,r)}executeHitDetection(t,e,i,n,s){return this.viewRotation_=i,this.execute_(t,[t.canvas.width,t.canvas.height],e,this.hitDetectionInstructions,!0,n,s)}},dd=["Polygon","Circle","LineString","Image","Text","Default"],gd=["Image","Text"],fd=dd.filter((t=>!gd.includes(t))),pd={},_d=class{constructor(t,e,i,n,s,r,o){this.maxExtent_=t,this.overlaps_=n,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=r,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=[1,0,0,1,0,0],this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,o)}clip(t,e){const i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()}createExecutors_(t,e){for(const i in t){let n=this.executorsByZIndex_[i];void 0===n&&(n={},this.executorsByZIndex_[i]=n);const s=t[i];for(const t in s){const i=s[t];n[t]=new ud(this.resolution_,this.pixelRatio_,this.overlaps_,i,e)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const i=this.executorsByZIndex_[e];for(let e=0,n=t.length;e<n;++e)if(t[e]in i)return!0}return!1}forEachFeatureAtCoordinate(t,e,i,n,s,o){const a=2*(n=Math.round(n))+1,h=j(this.hitDetectionTransform_,n+.5,n+.5,1/e,-1/e,-i,-t[0],-t[1]),l=!this.hitDetectionContext_;l&&(this.hitDetectionContext_=Us(a,a,void 0,{willReadFrequently:!0}));const c=this.hitDetectionContext_;let u;c.canvas.width!==a||c.canvas.height!==a?(c.canvas.width=a,c.canvas.height=a):l||c.clearRect(0,0,a,a),void 0!==this.renderBuffer_&&(u=[1/0,1/0,-1/0,-1/0],st(u,t),X(u,e*(this.renderBuffer_+n),u));const d=function(t){if(void 0!==pd[t])return pd[t];const e=2*t+1,i=t*t,n=new Array(i+1);for(let s=0;s<=t;++s)for(let r=0;r<=t;++r){const o=s*s+r*r;if(o>i)break;let a=n[o];a||(a=[],n[o]=a),a.push(4*((t+s)*e+(t+r))+3),s>0&&a.push(4*((t-s)*e+(t+r))+3),r>0&&(a.push(4*((t+s)*e+(t-r))+3),s>0&&a.push(4*((t-s)*e+(t-r))+3))}const s=[];for(let t=0,e=n.length;t<e;++t)n[t]&&s.push(...n[t]);return pd[t]=s,s}(n);let g;function f(t,e,i){const r=c.getImageData(0,0,a,a).data;for(let h=0,l=d.length;h<l;h++)if(r[d[h]]>0){if(!o||"none"===i||"Image"!==g&&"Text"!==g||o.includes(t)){const i=(d[h]-3)/4,r=n-i%a,o=n-(i/a|0),l=s(t,e,r*r+o*o);if(l)return l}c.clearRect(0,0,a,a);break}}const p=Object.keys(this.executorsByZIndex_).map(Number);let _,m,y,v,x;for(p.sort(r),_=p.length-1;_>=0;--_){const t=p[_].toString();for(y=this.executorsByZIndex_[t],m=dd.length-1;m>=0;--m)if(g=dd[m],v=y[g],void 0!==v&&(x=v.executeHitDetection(c,h,i,f,u),x))return x}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const i=e[0],n=e[1],s=e[2],r=e[3],o=[i,n,i,r,s,r,s,n];return ti(o,0,8,2,t,o),o}isEmpty(){return _(this.executorsByZIndex_)}execute(t,e,i,n,s,o,a){const h=Object.keys(this.executorsByZIndex_).map(Number);h.sort(r),o=o||dd;const l=dd.length;let c,u,d,g,f;for(a&&h.reverse(),c=0,u=h.length;c<u;++c){const r=h[c].toString();for(f=this.executorsByZIndex_[r],d=0,g=o.length;d<g;++d){const r=o[d],u=f[r];if(void 0!==u){const o=null===a?void 0:u.getZIndexContext(),g=o?o.getContext():t,f=this.maxExtent_&&"Image"!==r&&"Text"!==r;if(f&&(g.save(),this.clip(g,i)),o&&"Text"!==r&&"Image"!==r?o.pushFunction((t=>u.execute(t,e,i,n,s,a))):u.execute(g,e,i,n,s,a),f&&g.restore(),o){o.offset();const t=h[c]*l+d;this.deferredZIndexContexts_[t]||(this.deferredZIndexContexts_[t]=[]),this.deferredZIndexContexts_[t].push(o)}}}}this.renderedContext_=t}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const t=this.deferredZIndexContexts_,e=Object.keys(t).map(Number).sort(r);for(let i=0,n=e.length;i<n;++i)t[e[i]].forEach((t=>{t.draw(this.renderedContext_),t.clear()})),t[e[i]].length=0}},md=class extends Wu{constructor(t,e,i,n,s,r,o){super(),this.context_=t,this.pixelRatio_=e,this.extent_=i,this.transform_=n,this.transformRotation_=n?Tt(Math.atan2(n[1],n[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=r,this.userTransform_=o,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=[1,0,0,1,0,0]}drawImages_(t,e,i,n){if(!this.image_)return;const s=ti(t,e,i,n,this.transform_,this.pixelCoordinates_),r=this.context_,o=this.tmpLocalTransform_,a=r.globalAlpha;1!=this.imageOpacity_&&(r.globalAlpha=a*this.imageOpacity_);let h=this.imageRotation_;0===this.transformRotation_&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let t=0,e=s.length;t<e;t+=2){const e=s[t]-this.imageAnchorX_,i=s[t+1]-this.imageAnchorY_;if(0!==h||1!=this.imageScale_[0]||1!=this.imageScale_[1]){const t=e+this.imageAnchorX_,n=i+this.imageAnchorY_;j(o,t,n,1,1,h,-t,-n),r.save(),r.transform.apply(r,o),r.translate(t,n),r.scale(this.imageScale_[0],this.imageScale_[1]),r.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),r.restore()}else r.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,e,i,this.imageWidth_,this.imageHeight_)}1!=this.imageOpacity_&&(r.globalAlpha=a)}drawText_(t,e,i,n){if(!this.textState_||""===this.text_)return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=ti(t,e,i,n,this.transform_,this.pixelCoordinates_),r=this.context_;let o=this.textRotation_;for(0===this.transformRotation_&&(o-=this.viewRotation_),this.textRotateWithView_&&(o+=this.viewRotation_);e<i;e+=n){const t=s[e]+this.textOffsetX_,i=s[e+1]+this.textOffsetY_;0!==o||1!=this.textScale_[0]||1!=this.textScale_[1]?(r.save(),r.translate(t-this.textOffsetX_,i-this.textOffsetY_),r.rotate(o),r.translate(this.textOffsetX_,this.textOffsetY_),r.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&r.strokeText(this.text_,0,0),this.textFillState_&&r.fillText(this.text_,0,0),r.restore()):(this.textStrokeState_&&r.strokeText(this.text_,t,i),this.textFillState_&&r.fillText(this.text_,t,i))}}moveToLineTo_(t,e,i,n,s){const r=this.context_,o=ti(t,e,i,n,this.transform_,this.pixelCoordinates_);r.moveTo(o[0],o[1]);let a=o.length;s&&(a-=2);for(let t=2;t<a;t+=2)r.lineTo(o[t],o[t+1]);return s&&r.closePath(),i}drawRings_(t,e,i,n){for(let s=0,r=i.length;s<r;++s)e=this.moveToLineTo_(t,e,i[s],n,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),vt(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=function(t,e,i){const n=t.getFlatCoordinates();if(!n)return null;const s=t.getStride();return ti(n,0,n.length,s,e,i)}(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],n=e[3]-e[1],s=Math.sqrt(i*i+n*n),r=this.context_;r.beginPath(),r.arc(e[0],e[1],s,0,2*Math.PI),this.fillState_&&r.fill(),this.strokeState_&&r.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t)}}drawFeature(t,e){const i=e.getGeometryFunction()(t);i&&(this.setStyle(e),this.drawGeometry(i))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let t=0,i=e.length;t<i;++t)this.drawGeometry(e[t])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),vt(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(vt(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();let n=0;const s=t.getEnds(),r=t.getStride();e.beginPath();for(let t=0,e=s.length;t<e;++t)n=this.moveToLineTo_(i,n,s[t],r,!1);e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoints();this.drawText_(e,0,e.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),vt(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),vt(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getOrientedFlatCoordinates();let n=0;const s=t.getEndss(),r=t.getStride();e.beginPath();for(let t=0,e=s.length;t<e;++t){const e=s[t];n=this.drawRings_(i,n,e,r)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),l(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,i=this.contextTextState_,n=t.textAlign?t.textAlign:yr;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=n&&(i.textAlign=n,e.textAlign=n),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=n,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:n,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(t){const e=t.getColor();this.fillState_={fillStyle:sr(e||gr)}}else this.fillState_=null;if(e){const t=e.getColor(),i=e.getLineCap(),n=e.getLineDash(),s=e.getLineDashOffset(),r=e.getLineJoin(),o=e.getWidth(),a=e.getMiterLimit(),h=n||pr;this.strokeState_={lineCap:void 0!==i?i:fr,lineDash:1===this.pixelRatio_?h:h.map((t=>t*this.pixelRatio_)),lineDashOffset:(s||0)*this.pixelRatio_,lineJoin:void 0!==r?r:_r,lineWidth:(void 0!==o?o:1)*this.pixelRatio_,miterLimit:void 0!==a?a:10,strokeStyle:sr(t||mr)}}else this.strokeState_=null}setImageStyle(t){let e;if(!t||!(e=t.getSize()))return void(this.image_=null);const i=t.getPixelRatio(this.pixelRatio_),n=t.getAnchor(),s=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=n[0]*i,this.imageAnchorY_=n[1]*i,this.imageHeight_=e[1]*i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const r=t.getScaleArray();this.imageScale_=[r[0]*this.pixelRatio_/i,r[1]*this.pixelRatio_/i],this.imageWidth_=e[0]*i}setTextStyle(t){if(t){const e=t.getFill();if(e){const t=e.getColor();this.textFillState_={fillStyle:sr(t||gr)}}else this.textFillState_=null;const i=t.getStroke();if(i){const t=i.getColor(),e=i.getLineCap(),n=i.getLineDash(),s=i.getLineDashOffset(),r=i.getLineJoin(),o=i.getWidth(),a=i.getMiterLimit();this.textStrokeState_={lineCap:void 0!==e?e:fr,lineDash:n||pr,lineDashOffset:s||0,lineJoin:void 0!==r?r:_r,lineWidth:void 0!==o?o:1,miterLimit:void 0!==a?a:10,strokeStyle:sr(t||mr)}}else this.textStrokeState_=null;const n=t.getFont(),s=t.getOffsetX(),r=t.getOffsetY(),o=t.getRotateWithView(),a=t.getRotation(),h=t.getScaleArray(),l=t.getText(),c=t.getTextAlign(),u=t.getTextBaseline();this.textState_={font:void 0!==n?n:dr,textAlign:void 0!==c?c:yr,textBaseline:void 0!==u?u:vr},this.text_=void 0!==l?Array.isArray(l)?l.reduce(((t,e,i)=>t+(i%2?" ":e)),""):l:"",this.textOffsetX_=void 0!==s?this.pixelRatio_*s:0,this.textOffsetY_=void 0!==r?this.pixelRatio_*r:0,this.textRotateWithView_=void 0!==o&&o,this.textRotation_=void 0!==a?a:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}else this.text_=""}},yd=.5,vd=.5,xd={Point:function(t,e,i,n,s,r){const o=i.getImage(),a=i.getText(),h=a&&a.getText(),l=r&&o&&h?{}:void 0;if(o){if(o.getImageState()!=ls)return;const r=t.getBuilder(i.getZIndex(),"Image");r.setImageStyle(o,l),r.drawPoint(e,n,s)}if(h){const r=t.getBuilder(i.getZIndex(),"Text");r.setTextStyle(a,l),r.drawText(e,n,s)}},LineString:function(t,e,i,n,s){const r=i.getStroke();if(r){const o=t.getBuilder(i.getZIndex(),"LineString");o.setFillStrokeStyle(null,r),o.drawLineString(e,n,s)}const o=i.getText();if(o&&o.getText()){const r=t.getBuilder(i.getZIndex(),"Text");r.setTextStyle(o),r.drawText(e,n,s)}},Polygon:function(t,e,i,n,s){const r=i.getFill(),o=i.getStroke();if(r||o){const a=t.getBuilder(i.getZIndex(),"Polygon");a.setFillStrokeStyle(r,o),a.drawPolygon(e,n,s)}const a=i.getText();if(a&&a.getText()){const r=t.getBuilder(i.getZIndex(),"Text");r.setTextStyle(a),r.drawText(e,n,s)}},MultiPoint:function(t,e,i,n,s,r){const o=i.getImage(),a=o&&0!==o.getOpacity(),h=i.getText(),l=h&&h.getText(),c=r&&a&&l?{}:void 0;if(a){if(o.getImageState()!=ls)return;const r=t.getBuilder(i.getZIndex(),"Image");r.setImageStyle(o,c),r.drawMultiPoint(e,n,s)}if(l){const r=t.getBuilder(i.getZIndex(),"Text");r.setTextStyle(h,c),r.drawText(e,n,s)}},MultiLineString:function(t,e,i,n,s){const r=i.getStroke();if(r){const o=t.getBuilder(i.getZIndex(),"LineString");o.setFillStrokeStyle(null,r),o.drawMultiLineString(e,n,s)}const o=i.getText();if(o&&o.getText()){const r=t.getBuilder(i.getZIndex(),"Text");r.setTextStyle(o),r.drawText(e,n,s)}},MultiPolygon:function(t,e,i,n,s){const r=i.getFill(),o=i.getStroke();if(o||r){const a=t.getBuilder(i.getZIndex(),"Polygon");a.setFillStrokeStyle(r,o),a.drawMultiPolygon(e,n,s)}const a=i.getText();if(a&&a.getText()){const r=t.getBuilder(i.getZIndex(),"Text");r.setTextStyle(a),r.drawText(e,n,s)}},GeometryCollection:function(t,e,i,n,s,r){const o=e.getGeometriesArray();let a,h;for(a=0,h=o.length;a<h;++a)(0,xd[o[a].getType()])(t,o[a],i,n,s,r)},Circle:function(t,e,i,n,s){const r=i.getFill(),o=i.getStroke();if(r||o){const a=t.getBuilder(i.getZIndex(),"Circle");a.setFillStrokeStyle(r,o),a.drawCircle(e,n,s)}const a=i.getText();if(a&&a.getText()){const s=t.getBuilder(i.getZIndex(),"Text");s.setTextStyle(a),s.drawText(e,n)}}};function Md(t,e){return parseInt(F(t),10)-parseInt(F(e),10)}function wd(t,e){const i=Sd(t,e);return i*i}function Sd(t,e){return vd*t/e}function Cd(t,e,i,n,s,r,o,a){const h=[],l=i.getImage();if(l){let t=!0;const e=l.getImageState();e==ls||e==cs?t=!1:e==as&&l.load(),t&&h.push(l.ready())}const c=i.getFill();c&&c.loading()&&h.push(c.ready());const u=h.length>0;return u&&Promise.all(h).then((()=>s(null))),function(t,e,i,n,s,r,o){const a=i.getGeometryFunction()(e);if(!a)return;const h=a.simplifyTransformed(n,s);i.getRenderer()?bd(t,h,i,e,o):(0,xd[h.getType()])(t,h,i,e,o,r)}(t,e,i,n,r,o,a),u}function bd(t,e,i,n,s){if("GeometryCollection"!=e.getType())t.getBuilder(i.getZIndex(),"Default").drawCustom(e,n,i.getRenderer(),i.getHitDetectionRenderer(),s);else{const r=e.getGeometries();for(let e=0,o=r.length;e<o;++e)bd(t,r[e],i,n,s)}}const Ed=class extends td{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=[1/0,1/0,-1/0,-1/0],this.wrappedRenderedExtent_=[1/0,1/0,-1/0,-1/0],this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(t,e,i){const n=e.extent,s=e.viewState,r=s.center,o=s.resolution,a=s.projection,h=s.rotation,l=a.getExtent(),c=this.getLayer().getSource(),u=this.getLayer().getDeclutter(),d=e.pixelRatio,g=e.viewHints,f=!(g[0]||g[1]),p=this.context,_=Math.round(yt(n)/o*d),m=Math.round(ft(n)/o*d),y=c.getWrapX()&&a.canWrapX(),v=y?yt(l):null,x=y?Math.ceil((n[2]-l[2])/v)+1:1;let M=y?Math.floor((n[0]-l[0])/v):0;do{let n=this.getRenderTransform(r,o,0,d,_,m,M*v);e.declutter&&(n=n.slice(0)),t.execute(p,[p.canvas.width,p.canvas.height],n,h,f,void 0===i?dd:i?gd:fd,i?u&&e.declutter[u]:void 0)}while(++M<x)}setDrawContext_(){1!==this.opacity_&&(this.targetContext_=this.context,this.context=Us(this.context.canvas.width,this.context.canvas.height,$u))}resetDrawContext_(){if(1!==this.opacity_){const t=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=t,Ys(this.context),$u.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(t){this.replayGroup_&&this.getLayer().getDeclutter()&&this.renderWorlds(this.replayGroup_,t,!0)}renderDeferredInternal(t){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(t,e){const i=t.layerStatesArray[t.layerIndex];this.opacity_=i.opacity;const n=t.viewState;this.prepareContainer(t,e);const s=this.context,r=this.replayGroup_;let o=r&&!r.isEmpty();if(!o&&!this.getLayer().hasListener(xn)&&!this.getLayer().hasListener(Mn))return null;this.setDrawContext_(),this.preRender(s,t);const a=n.projection;if(this.clipped_=!1,o&&i.extent&&this.clipping){const e=je(i.extent,a);o=vt(e,t.extent),this.clipped_=o&&!Y(e,t.extent),this.clipped_&&this.clipUnrotated(s,t,e)}return o&&this.renderWorlds(r,t,!this.getLayer().getDeclutter()&&void 0),!t.declutter&&this.clipped_&&s.restore(),this.postRender(s,t),this.renderedRotation_!==n.rotation&&(this.renderedRotation_=n.rotation,this.hitDetectionImageData_=null),t.declutter||this.resetDrawContext_(),this.container}getFeatures(t){return new Promise((e=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const t=this.frameState.size.slice(),e=this.renderedCenter_,i=this.renderedResolution_,n=this.renderedRotation_,s=this.renderedProjection_,o=this.wrappedRenderedExtent_,a=this.getLayer(),h=[],l=t[0]*yd,c=t[1]*yd;h.push(this.getRenderTransform(e,i,n,yd,l,c,0).slice());const u=a.getSource(),d=s.getExtent();if(u.getWrapX()&&s.canWrapX()&&!Y(d,o)){let t=o[0];const s=yt(d);let r,a=0;for(;t<d[0];)--a,r=s*a,h.push(this.getRenderTransform(e,i,n,yd,l,c,r).slice()),t+=s;for(a=0,t=o[2];t>d[2];)++a,r=s*a,h.push(this.getRenderTransform(e,i,n,yd,l,c,r).slice()),t-=s}const g=Oe();this.hitDetectionImageData_=function(t,e,i,n,s,o,a,h,l){const c=l?Ge(s,l):s,u=Us(t[0]*yd,t[1]*yd);u.imageSmoothingEnabled=!1;const d=u.canvas,g=new md(u,yd,s,null,a,h,l?Re(Oe(),l):null),f=i.length,p=Math.floor(16777215/f),_={};for(let t=1;t<=f;++t){const e=i[t-1],s=e.getStyleFunction()||n;if(!s)continue;let r=s(e,o);if(!r)continue;Array.isArray(r)||(r=[r]);const a=(t*p).toString(16).padStart(7,"#00000");for(let t=0,i=r.length;t<i;++t){const i=r[t],n=i.getGeometryFunction()(e);if(!n||!vt(c,n.getExtent()))continue;const s=i.clone(),o=s.getFill();o&&o.setColor(a);const h=s.getStroke();h&&(h.setColor(a),h.setLineDash(null)),s.setText(void 0);const l=i.getImage();if(l){const t=l.getImageSize();if(!t)continue;const e=Us(t[0],t[1],void 0,{alpha:!1}),i=e.canvas;e.fillStyle=a,e.fillRect(0,0,i.width,i.height),s.setImage(new Vr({img:i,anchor:l.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:l.getOrigin(),opacity:1,size:l.getSize(),scale:l.getScale(),rotation:l.getRotation(),rotateWithView:l.getRotateWithView()}))}const u=s.getZIndex()||0;let d=_[u];d||(d={},_[u]=d,d.Polygon=[],d.Circle=[],d.LineString=[],d.Point=[]);const g=n.getType();if("GeometryCollection"===g){const t=n.getGeometriesArrayRecursive();for(let e=0,i=t.length;e<i;++e){const i=t[e];d[i.getType().replace("Multi","")].push(i,s)}}else d[g.replace("Multi","")].push(n,s)}}const m=Object.keys(_).map(Number).sort(r);for(let t=0,i=m.length;t<i;++t){const i=_[m[t]];for(const t in i){const n=i[t];for(let t=0,i=n.length;t<i;t+=2){g.setStyle(n[t+1]);for(let i=0,s=e.length;i<s;++i)g.setTransform(e[i]),g.drawGeometry(n[t])}}}return u.getImageData(0,0,d.width,d.height)}(t,h,this.renderedFeatures_,a.getStyleFunction(),o,i,n,wd(i,this.renderedPixelRatio_),g?s:null)}e(function(t,e,i){const n=[];if(i){const s=Math.floor(Math.round(t[0])*yd),r=Math.floor(Math.round(t[1])*yd),o=4*(St(s,0,i.width-1)+St(r,0,i.height-1)*i.width),a=i.data[o],h=i.data[o+1],l=i.data[o+2]+256*(h+256*a),c=Math.floor(16777215/e.length);l&&l%c==0&&n.push(e[l/c-1])}return n}(t,this.renderedFeatures_,this.hitDetectionImageData_))}))}forEachFeatureAtCoordinate(t,e,i,n,s){if(!this.replayGroup_)return;const r=e.viewState.resolution,o=e.viewState.rotation,a=this.getLayer(),h={},l=function(t,e,i){const r=F(t),o=h[r];if(o){if(!0!==o&&i<o.distanceSq){if(0===i)return h[r]=!0,s.splice(s.lastIndexOf(o),1),n(t,a,e);o.geometry=e,o.distanceSq=i}}else{if(0===i)return h[r]=!0,n(t,a,e);s.push(h[r]={feature:t,layer:a,geometry:e,distanceSq:i,callback:n})}};let c;const u=[this.replayGroup_],d=this.getLayer().getDeclutter();return u.some((n=>c=n.forEachFeatureAtCoordinate(t,r,o,i,l,d&&e.declutter[d]?e.declutter[d].all().map((t=>t.value)):null))),c}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),i=e.getSource();if(!i)return!1;const n=t.viewHints[0],s=t.viewHints[1],r=e.getUpdateWhileAnimating(),o=e.getUpdateWhileInteracting();if(this.ready&&!r&&n||!o&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const a=t.extent,h=t.viewState,c=h.projection,u=h.resolution,d=t.pixelRatio,g=e.getRevision(),f=e.getRenderBuffer();let p=e.getRenderOrder();void 0===p&&(p=Md);const _=h.center.slice(),m=X(a,f*u),y=m.slice(),v=[m.slice()],x=c.getExtent();if(i.getWrapX()&&c.canWrapX()&&!Y(x,t.extent)){const t=yt(x),e=Math.max(yt(m)/2,t);m[0]=x[0]-e,m[2]=x[2]+e,ue(_,c);const i=Mt(v[0],c);i[0]<x[0]&&i[2]<x[2]?v.push([i[0]+t,i[1],i[2]+t,i[3]]):i[0]>x[0]&&i[2]>x[2]&&v.push([i[0]-t,i[1],i[2]-t,i[3]])}if(this.ready&&this.renderedResolution_==u&&this.renderedRevision_==g&&this.renderedRenderOrder_==p&&this.renderedFrameDeclutter_===!!t.declutter&&Y(this.wrappedRenderedExtent_,m))return l(this.renderedExtent_,y)||(this.hitDetectionImageData_=null,this.renderedExtent_=y),this.renderedCenter_=_,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const M=new Zu(Sd(u,d),m,u,d),w=Oe();let S;if(w){for(let t=0,e=v.length;t<e;++t){const e=Ge(v[t],c);i.loadFeatures(e,ze(u,c),w)}S=Re(w,c)}else for(let t=0,e=v.length;t<e;++t)i.loadFeatures(v[t],u,c);const C=wd(u,d);let b=!0;const E=(t,i)=>{let n;const s=t.getStyleFunction()||e.getStyleFunction();if(s&&(n=s(t,u)),n){const e=this.renderFeature(t,C,n,M,S,this.getLayer().getDeclutter(),i);b=b&&!e}},P=Ge(m,c),I=i.getFeaturesInExtent(P);p&&I.sort(p);for(let t=0,e=I.length;t<e;++t)E(I[t],t);this.renderedFeatures_=I,this.ready=b;const T=M.finish(),R=new _d(m,u,d,i.getOverlaps(),T,e.getRenderBuffer(),!!t.declutter);return this.renderedResolution_=u,this.renderedRevision_=g,this.renderedRenderOrder_=p,this.renderedFrameDeclutter_=!!t.declutter,this.renderedExtent_=y,this.wrappedRenderedExtent_=m,this.renderedCenter_=_,this.renderedProjection_=c,this.renderedPixelRatio_=d,this.replayGroup_=R,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,i,n,s,r,o){if(!i)return!1;let a=!1;if(Array.isArray(i))for(let h=0,l=i.length;h<l;++h)a=Cd(n,t,i[h],e,this.boundHandleStyleImageChange_,s,r,o)||a;else a=Cd(n,t,i,e,this.boundHandleStyleImageChange_,s,r,o);return a}},Pd=class extends Jo{constructor(t){super(t)}createRenderer(){return new Ed(this)}},Id="drawstart";class Td extends t{constructor(t,e){super(t),this.feature=e}}function Rd(t,e){return bt(t[0],t[1],e[0],e[1])}function Ad(t,e){const i=t.length;return e<0?t[e+i]:e>=i?t[e-i]:t[e]}function Fd(t,e,i){let n,s;e<i?(n=e,s=i):(n=i,s=e);const r=Math.ceil(n),o=Math.floor(s);if(r>o)return Rd(Gd(t,n),Gd(t,s));let a=0;n<r&&(a+=Rd(Gd(t,n),Ad(t,r))),o<s&&(a+=Rd(Ad(t,o),Gd(t,s)));for(let e=r;e<o-1;++e)a+=Rd(Ad(t,e),Ad(t,e+1));return a}function Ld(t,e,i){if(e instanceof Ri)Od(t,e.getCoordinates(),!1,i);else if(e instanceof Wi){const n=e.getCoordinates();for(let e=0,s=n.length;e<s;++e)Od(t,n[e],!1,i)}else if(e instanceof Di){const n=e.getCoordinates();for(let e=0,s=n.length;e<s;++e)Od(t,n[e],!0,i)}else if(e instanceof Xi){const n=e.getCoordinates();for(let e=0,s=n.length;e<s;++e){const s=n[e];for(let e=0,n=s.length;e<n;++e)Od(t,s[e],!0,i)}}else if(e instanceof Ki){const n=e.getGeometries();for(let e=0;e<n.length;++e)Ld(t,n[e],i)}}const kd={index:-1,endIndex:NaN};function Od(t,e,i,n){const s=t[0],r=t[1];for(let t=0,o=e.length-1;t<o;++t){const o=Nd(s,r,e[t],e[t+1]);if(0===o.squaredDistance){const s=t+o.along;return void n.push({coordinates:e,ring:i,startIndex:s,endIndex:s})}}}const Dd={along:0,squaredDistance:0};function Nd(t,e,i,n){const s=i[0],r=i[1],o=n[0]-s,a=n[1]-r;let h=0,l=s,c=r;return 0===o&&0===a||(h=St(((t-s)*o+(e-r)*a)/(o*o+a*a),0,1),l+=o*h,c+=a*h),Dd.along=h,Dd.squaredDistance=Tt(bt(t,e,l,c),10),Dd}function Gd(t,e){const i=t.length;let n=Math.floor(e);const s=e-n;n>=i?n-=i:n<0&&(n+=i);let r=n+1;r>=i&&(r-=i);const o=t[n],a=o[0],h=o[1],l=t[r];return[a+(l[0]-a)*s,h+(l[1]-h)*s]}function jd(){const t=Br();return function(e,i){return t[e.getGeometry().getType()]}}const zd=class extends Aa{constructor(t){const e=t;e.stopDown||(e.stopDown=u),super(e),this.on,this.once,this.un,this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.pointerType_,this.freehand_=!1,this.source_=t.source?t.source:null,this.features_=t.features?t.features:null,this.snapTolerance_=t.snapTolerance?t.snapTolerance:12,this.type_=t.type,this.mode_=function(t){switch(t){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+t)}}(this.type_),this.stopClick_=!!t.stopClick,this.minPoints_=t.minPoints?t.minPoints:"Polygon"===this.mode_?3:2,this.maxPoints_="Circle"===this.mode_?2:t.maxPoints?t.maxPoints:1/0,this.finishCondition_=t.finishCondition?t.finishCondition:c,this.geometryLayout_=t.geometryLayout?t.geometryLayout:"XY";let i=t.geometryFunction;if(!i){const t=this.mode_;if("Circle"===t)i=(t,e,i)=>{const n=e||new Ou([NaN,NaN]),s=Ne(t[0],i),r=le(s,Ne(t[t.length-1],i));n.setCenterAndRadius(s,Math.sqrt(r),this.geometryLayout_);const o=Oe();return o&&n.transform(i,o),n};else{let e;"Point"===t?e=pi:"LineString"===t?e=Ri:"Polygon"===t&&(e=Di),i=(i,n,s)=>(n?"Polygon"===t?i[0].length?n.setCoordinates([i[0].concat([i[0][0]])],this.geometryLayout_):n.setCoordinates([],this.geometryLayout_):n.setCoordinates(i,this.geometryLayout_):n=new e(i,this.geometryLayout_),n)}}this.geometryFunction_=i,this.dragVertexDelay_=void 0!==t.dragVertexDelay?t.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=t.clickTolerance?t.clickTolerance*t.clickTolerance:36,this.overlay_=new Pd({source:new mh({useSpatialIndex:!1,wrapX:!!t.wrapX&&t.wrapX}),style:t.style?t.style:jd(),updateWhileInteracting:!0}),this.geometryName_=t.geometryName,this.condition_=t.condition?t.condition:Ga,this.freehandCondition_,t.freehand?this.freehandCondition_=Oa:this.freehandCondition_=t.freehandCondition?t.freehandCondition:ja,this.traceCondition_,this.setTrace(t.trace||!1),this.traceState_={active:!1},this.traceSource_=t.traceSource||t.source||null,this.addChangeListener(Ea,this.updateState_)}setTrace(t){let e;e=t?!0===t?Oa:t:Na,this.traceCondition_=e}setMap(t){super.setMap(t),this.updateState_()}getOverlay(){return this.overlay_}handleEvent(t){t.originalEvent.type===v&&t.originalEvent.preventDefault(),this.freehand_="Point"!==this.mode_&&this.freehandCondition_(t);let e=t.type===ha.POINTERMOVE,i=!0;return!this.freehand_&&this.lastDragTime_&&t.type===ha.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=t.pixel,this.shouldHandle_=!this.freehand_,e=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&t.type===ha.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(t.coordinate),i=!1):this.freehand_&&t.type===ha.POINTERDOWN?i=!1:e&&this.getPointerCount()<2?(i=t.type===ha.POINTERMOVE,i&&this.freehand_?(this.handlePointerMove_(t),this.shouldHandle_&&t.originalEvent.preventDefault()):("mouse"===t.originalEvent.pointerType||t.type===ha.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(t)):t.type===ha.DBLCLICK&&(i=!1),super.handleEvent(t)&&i}handleDownEvent(t){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=t.pixel,this.finishCoordinate_||this.startDrawing_(t.coordinate),!0):this.condition_(t)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout((()=>{this.handlePointerMove_(new aa(ha.POINTERMOVE,t.map,t.originalEvent,!1,t.frameState))}),this.dragVertexDelay_),this.downPx_=t.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(t){if(!this.traceSource_||!this.traceCondition_(t))return;if(this.traceState_.active)return void this.deactivateTrace_();const e=this.getMap(),i=q([e.getCoordinateFromPixel([t.pixel[0]-this.snapTolerance_,t.pixel[1]+this.snapTolerance_]),e.getCoordinateFromPixel([t.pixel[0]+this.snapTolerance_,t.pixel[1]-this.snapTolerance_])]),n=this.traceSource_.getFeaturesInExtent(i);if(0===n.length)return;const s=function(t,e){const i=[];for(let n=0;n<e.length;++n)Ld(t,e[n].getGeometry(),i);return i}(t.coordinate,n);s.length&&(this.traceState_={active:!0,startPx:t.pixel.slice(),targets:s,targetIndex:-1})}addOrRemoveTracedCoordinates_(t,e){const i=t.startIndex<=t.endIndex;i===t.startIndex<=e?i&&e>t.endIndex||!i&&e<t.endIndex?this.addTracedCoordinates_(t,t.endIndex,e):(i&&e<t.endIndex||!i&&e>t.endIndex)&&this.removeTracedCoordinates_(e,t.endIndex):(this.removeTracedCoordinates_(t.startIndex,t.endIndex),this.addTracedCoordinates_(t,t.startIndex,e))}removeTracedCoordinates_(t,e){if(t===e)return;let i=0;if(t<e){const n=Math.ceil(t);let s=Math.floor(e);s===e&&(s-=1),i=s-n+1}else{const n=Math.floor(t);let s=Math.ceil(e);s===e&&(s+=1),i=n-s+1}i>0&&this.removeLastPoints_(i)}addTracedCoordinates_(t,e,i){if(e===i)return;const n=[];if(e<i){const s=Math.ceil(e);let r=Math.floor(i);r===i&&(r-=1);for(let e=s;e<=r;++e)n.push(Ad(t.coordinates,e))}else{const s=Math.floor(e);let r=Math.ceil(i);r===i&&(r+=1);for(let e=s;e>=r;--e)n.push(Ad(t.coordinates,e))}n.length&&this.appendCoordinates(n)}updateTrace_(t){const e=this.traceState_;if(!e.active)return;if(-1===e.targetIndex&&ce(e.startPx,t.pixel)<this.snapTolerance_)return;const i=function(t,e,i,n){const s=t[0],r=t[1];let o=1/0,a=-1,h=NaN;for(let t=0;t<e.targets.length;++t){const i=e.targets[t],n=i.coordinates;let l,c=1/0;for(let t=0;t<n.length-1;++t){const e=Nd(s,r,n[t],n[t+1]);e.squaredDistance<c&&(c=e.squaredDistance,l=t+e.along)}c<o&&(o=c,i.ring&&e.targetIndex===t&&(i.endIndex>i.startIndex?l<i.startIndex&&(l+=n.length):i.endIndex<i.startIndex&&l>i.startIndex&&(l-=n.length)),h=l,a=t)}const l=e.targets[a];let c=l.ring;if(e.targetIndex===a&&c){const t=Gd(l.coordinates,h);ce(i.getPixelFromCoordinate(t),e.startPx)>n&&(c=!1)}if(c){const t=l.coordinates,e=t.length,i=l.startIndex,n=h;if(i<n){const s=Fd(t,i,n);Fd(t,i,n-e)<s&&(h-=e)}else{const s=Fd(t,i,n);Fd(t,i,n+e)<s&&(h+=e)}}return kd.index=a,kd.endIndex=h,kd}(t.coordinate,e,this.getMap(),this.snapTolerance_);if(e.targetIndex!==i.index){if(-1!==e.targetIndex){const t=e.targets[e.targetIndex];this.removeTracedCoordinates_(t.startIndex,t.endIndex)}const t=e.targets[i.index];this.addTracedCoordinates_(t,t.startIndex,i.endIndex)}else{const t=e.targets[e.targetIndex];this.addOrRemoveTracedCoordinates_(t,i.endIndex)}e.targetIndex=i.index;const n=e.targets[e.targetIndex];n.endIndex=i.endIndex;const s=Gd(n.coordinates,n.endIndex),r=this.getMap().getPixelFromCoordinate(s);t.coordinate=s,t.pixel=[Math.round(r[0]),Math.round(r[1])]}handleUpEvent(t){let e=!0;if(0===this.getPointerCount()){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(t);const i=this.traceState_.active;if(this.toggleTraceState_(t),this.shouldHandle_){const n=!this.finishCoordinate_;n&&this.startDrawing_(t.coordinate),!n&&this.freehand_?this.finishDrawing():this.freehand_||n&&"Point"!==this.mode_||(this.atFinish_(t.pixel,i)?this.finishCondition_(t)&&this.finishDrawing():this.addToDrawing_(t.coordinate)),e=!1}else this.freehand_&&this.abortDrawing()}return!e&&this.stopClick_&&t.preventDefault(),e}handlePointerMove_(t){if(this.pointerType_=t.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){const e=this.downPx_,i=t.pixel,n=e[0]-i[0],s=e[1]-i[1],r=n*n+s*s;if(this.shouldHandle_=this.freehand_?r>this.squaredClickTolerance_:r<=this.squaredClickTolerance_,!this.shouldHandle_)return}this.finishCoordinate_?(this.updateTrace_(t),this.modifyDrawing_(t.coordinate)):this.createOrUpdateSketchPoint_(t.coordinate.slice())}atFinish_(t,e){let i=!1;if(this.sketchFeature_){let n=!1,s=[this.finishCoordinate_];const r=this.mode_;if("Point"===r)i=!0;else if("Circle"===r)i=2===this.sketchCoords_.length;else if("LineString"===r)n=!e&&this.sketchCoords_.length>this.minPoints_;else if("Polygon"===r){const t=this.sketchCoords_;n=t[0].length>this.minPoints_,s=[t[0][0],t[0][t[0].length-2]],s=e?[t[0][0]]:[t[0][0],t[0][t[0].length-2]]}if(n){const e=this.getMap();for(let n=0,r=s.length;n<r;n++){const r=s[n],o=e.getPixelFromCoordinate(r),a=t[0]-o[0],h=t[1]-o[1],l=this.freehand_?1:this.snapTolerance_;if(i=Math.sqrt(a*a+h*h)<=l,i){this.finishCoordinate_=r;break}}}}return i}createOrUpdateSketchPoint_(t){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(t):(this.sketchPoint_=new N(new pi(t)),this.updateSketchFeatures_())}createOrUpdateCustomSketchLine_(t){this.sketchLine_||(this.sketchLine_=new N);const e=t.getLinearRing(0);let i=this.sketchLine_.getGeometry();i?(i.setFlatCoordinates(e.getLayout(),e.getFlatCoordinates()),i.changed()):(i=new Ri(e.getFlatCoordinates(),e.getLayout()),this.sketchLine_.setGeometry(i))}startDrawing_(t){const e=this.getMap().getView().getProjection(),i=hi(this.geometryLayout_);for(;t.length<i;)t.push(0);this.finishCoordinate_=t,"Point"===this.mode_?this.sketchCoords_=t.slice():"Polygon"===this.mode_?(this.sketchCoords_=[[t.slice(),t.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[t.slice(),t.slice()],this.sketchLineCoords_&&(this.sketchLine_=new N(new Ri(this.sketchLineCoords_)));const n=this.geometryFunction_(this.sketchCoords_,void 0,e);this.sketchFeature_=new N,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(n),this.updateSketchFeatures_(),this.dispatchEvent(new Td(Id,this.sketchFeature_))}modifyDrawing_(t){const e=this.getMap(),i=this.sketchFeature_.getGeometry(),n=e.getView().getProjection(),s=hi(this.geometryLayout_);let r,o;for(;t.length<s;)t.push(0);"Point"===this.mode_?o=this.sketchCoords_:"Polygon"===this.mode_?(r=this.sketchCoords_[0],o=r[r.length-1],this.atFinish_(e.getPixelFromCoordinate(t))&&(t=this.finishCoordinate_.slice())):(r=this.sketchCoords_,o=r[r.length-1]),o[0]=t[0],o[1]=t[1],this.geometryFunction_(this.sketchCoords_,i,n),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(t),"Polygon"===i.getType()&&"Polygon"!==this.mode_?this.createOrUpdateCustomSketchLine_(i):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}addToDrawing_(t){const e=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection();let n,s;const r=this.mode_;return"LineString"===r||"Circle"===r?(this.finishCoordinate_=t.slice(),s=this.sketchCoords_,s.length>=this.maxPoints_&&(this.freehand_?s.pop():n=!0),s.push(t.slice()),this.geometryFunction_(s,e,i)):"Polygon"===r&&(s=this.sketchCoords_[0],s.length>=this.maxPoints_&&(this.freehand_?s.pop():n=!0),s.push(t.slice()),n&&(this.finishCoordinate_=s[0]),this.geometryFunction_(this.sketchCoords_,e,i)),this.createOrUpdateSketchPoint_(t.slice()),this.updateSketchFeatures_(),n?this.finishDrawing():this.sketchFeature_}removeLastPoints_(t){if(!this.sketchFeature_)return;const e=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection(),n=this.mode_;for(let s=0;s<t;++s){let t;if("LineString"===n||"Circle"===n){if(t=this.sketchCoords_,t.splice(-2,1),t.length>=2){this.finishCoordinate_=t[t.length-2].slice();const e=this.finishCoordinate_.slice();t[t.length-1]=e,this.createOrUpdateSketchPoint_(e)}this.geometryFunction_(t,e,i),"Polygon"===e.getType()&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(e)}else if("Polygon"===n){t=this.sketchCoords_[0],t.splice(-2,1);const n=this.sketchLine_.getGeometry();if(t.length>=2){const e=t[t.length-2].slice();t[t.length-1]=e,this.createOrUpdateSketchPoint_(e)}n.setCoordinates(t),this.geometryFunction_(this.sketchCoords_,e,i)}if(1===t.length){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){const t=this.abortDrawing_();if(!t)return null;let e=this.sketchCoords_;const i=t.getGeometry(),n=this.getMap().getView().getProjection();return"LineString"===this.mode_?(e.pop(),this.geometryFunction_(e,i,n)):"Polygon"===this.mode_&&(e[0].pop(),this.geometryFunction_(e,i,n),e=i.getCoordinates()),"MultiPoint"===this.type_?t.setGeometry(new zi([e])):"MultiLineString"===this.type_?t.setGeometry(new Wi([e])):"MultiPolygon"===this.type_&&t.setGeometry(new Xi([e])),this.dispatchEvent(new Td("drawend",t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t),t}abortDrawing_(){this.finishCoordinate_=null;const t=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),t}abortDrawing(){const t=this.abortDrawing_();t&&this.dispatchEvent(new Td("drawabort",t))}appendCoordinates(t){const e=this.mode_,i=!this.sketchFeature_;let n;if(i&&this.startDrawing_(t[0]),"LineString"===e||"Circle"===e)n=this.sketchCoords_;else{if("Polygon"!==e)return;n=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[]}i&&n.shift(),n.pop();for(let e=0;e<t.length;e++)this.addToDrawing_(t[e]);const s=t[t.length-1];this.sketchFeature_=this.addToDrawing_(s),this.modifyDrawing_(s)}extend(t){const e=t.getGeometry();this.sketchFeature_=t,this.sketchCoords_=e.getCoordinates();const i=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=i.slice(),this.sketchCoords_.push(i.slice()),this.sketchPoint_=new N(new pi(i)),this.updateSketchFeatures_(),this.dispatchEvent(new Td(Id,this.sketchFeature_))}updateSketchFeatures_(){const t=[];this.sketchFeature_&&t.push(this.sketchFeature_),this.sketchLine_&&t.push(this.sketchLine_),this.sketchPoint_&&t.push(this.sketchPoint_);const e=this.overlay_.getSource();e.clear(!0),e.addFeatures(t)}updateState_(){const t=this.getMap(),e=this.getActive();t&&e||this.abortDrawing(),this.overlay_.setMap(e?t:null)}},Bd=[0,0,0,0],Wd=[],qd="modifyend";class Xd extends t{constructor(t,e,i){super(t),this.features=e,this.mapBrowserEvent=i}}function Ud(t,e){return t.index-e.index}function Vd(t,e,i){const n=e.geometry;if("Circle"===n.getType()){let s=n;if(1===e.index){const e=Oe();e&&(s=s.clone().transform(e,i));const n=le(s.getCenter(),Ne(t,i)),r=Math.sqrt(n)-s.getRadius();return r*r}}const s=Ne(t,i);return Wd[0]=Ne(e.segment[0],i),Wd[1]=Ne(e.segment[1],i),function(t,e){return le(t,oe(t,e))}(s,Wd)}function Kd(t,e,i){const n=e.geometry;if("Circle"===n.getType()&&1===e.index){let e=n;const s=Oe();return s&&(e=e.clone().transform(s,i)),De(e.getClosestPoint(Ne(t,i)),i)}const s=Ne(t,i);return Wd[0]=Ne(e.segment[0],i),Wd[1]=Ne(e.segment[1],i),De(oe(s,Wd),i)}function Yd(){const t=Br();return function(e,i){return t.Point}}const Zd=class extends Aa{constructor(t){let e;if(super(t),this.on,this.once,this.un,this.boundHandleFeatureChange_=this.handleFeatureChange_.bind(this),this.condition_=t.condition?t.condition:Wa,this.defaultDeleteCondition_=function(t){return function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey}(t)&&function(t){return t.type==ha.SINGLECLICK}(t)},this.deleteCondition_=t.deleteCondition?t.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=t.insertVertexCondition?t.insertVertexCondition:Oa,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.featuresBeingModified_=null,this.rBush_=new lh,this.pixelTolerance_=void 0!==t.pixelTolerance?t.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new Pd({source:new mh({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.style?t.style:Yd(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_.bind(this),LineString:this.writeLineStringGeometry_.bind(this),LinearRing:this.writeLineStringGeometry_.bind(this),Polygon:this.writePolygonGeometry_.bind(this),MultiPoint:this.writeMultiPointGeometry_.bind(this),MultiLineString:this.writeMultiLineStringGeometry_.bind(this),MultiPolygon:this.writeMultiPolygonGeometry_.bind(this),Circle:this.writeCircleGeometry_.bind(this),GeometryCollection:this.writeGeometryCollectionGeometry_.bind(this)},this.source_=null,this.hitDetection_=null,t.features?e=t.features:t.source&&(this.source_=t.source,e=new ln(this.source_.getFeatures()),this.source_.addEventListener(dh,this.handleSourceAdd_.bind(this)),this.source_.addEventListener(gh,this.handleSourceRemove_.bind(this))),!e)throw new Error("The modify interaction requires features, a source or a layer");t.hitDetection&&(this.hitDetection_=t.hitDetection),this.features_=e,this.features_.forEach(this.addFeature_.bind(this)),this.features_.addEventListener(rn,this.handleFeatureAdd_.bind(this)),this.features_.addEventListener(on,this.handleFeatureRemove_.bind(this)),this.lastPointerEvent_=null,this.delta_=[0,0],this.snapToPointer_=void 0===t.snapToPointer?!this.hitDetection_:t.snapToPointer}addFeature_(t){const e=t.getGeometry();if(e){const i=this.SEGMENT_WRITERS_[e.getType()];i&&i(t,e)}const i=this.getMap();i&&i.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,i),t.addEventListener(y,this.boundHandleFeatureChange_)}willModifyFeatures_(t,e){if(!this.featuresBeingModified_){this.featuresBeingModified_=new ln;const i=this.featuresBeingModified_.getArray();for(let t=0,n=e.length;t<n;++t){const n=e[t];for(let t=0,e=n.length;t<e;++t){const e=n[t].feature;e&&!i.includes(e)&&this.featuresBeingModified_.push(e)}}0===this.featuresBeingModified_.getLength()?this.featuresBeingModified_=null:this.dispatchEvent(new Xd("modifystart",this.featuresBeingModified_,t))}}removeFeature_(t){this.removeFeatureSegmentData_(t),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),t.removeEventListener(y,this.boundHandleFeatureChange_)}removeFeatureSegmentData_(t){const e=this.rBush_,i=[];e.forEach((function(e){t===e.feature&&i.push(e)}));for(let t=i.length-1;t>=0;--t){const n=i[t];for(let t=this.dragSegments_.length-1;t>=0;--t)this.dragSegments_[t][0]===n&&this.dragSegments_.splice(t,1);e.remove(n)}}setActive(t){this.vertexFeature_&&!t&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),super.setActive(t)}setMap(t){this.overlay_.setMap(t),super.setMap(t)}getOverlay(){return this.overlay_}handleSourceAdd_(t){t.feature&&this.features_.push(t.feature)}handleSourceRemove_(t){t.feature&&this.features_.remove(t.feature)}handleFeatureAdd_(t){this.addFeature_(t.element)}handleFeatureChange_(t){if(!this.changingFeature_){const e=t.target;this.removeFeature_(e),this.addFeature_(e)}}handleFeatureRemove_(t){this.removeFeature_(t.element)}writePointGeometry_(t,e){const i=e.getCoordinates(),n={feature:t,geometry:e,segment:[i,i]};this.rBush_.insert(e.getExtent(),n)}writeMultiPointGeometry_(t,e){const i=e.getCoordinates();for(let n=0,s=i.length;n<s;++n){const s=i[n],r={feature:t,geometry:e,depth:[n],index:n,segment:[s,s]};this.rBush_.insert(e.getExtent(),r)}}writeLineStringGeometry_(t,e){const i=e.getCoordinates();for(let n=0,s=i.length-1;n<s;++n){const s=i.slice(n,n+2),r={feature:t,geometry:e,index:n,segment:s};this.rBush_.insert(q(s),r)}}writeMultiLineStringGeometry_(t,e){const i=e.getCoordinates();for(let n=0,s=i.length;n<s;++n){const s=i[n];for(let i=0,r=s.length-1;i<r;++i){const r=s.slice(i,i+2),o={feature:t,geometry:e,depth:[n],index:i,segment:r};this.rBush_.insert(q(r),o)}}}writePolygonGeometry_(t,e){const i=e.getCoordinates();for(let n=0,s=i.length;n<s;++n){const s=i[n];for(let i=0,r=s.length-1;i<r;++i){const r=s.slice(i,i+2),o={feature:t,geometry:e,depth:[n],index:i,segment:r};this.rBush_.insert(q(r),o)}}}writeMultiPolygonGeometry_(t,e){const i=e.getCoordinates();for(let n=0,s=i.length;n<s;++n){const s=i[n];for(let i=0,r=s.length;i<r;++i){const r=s[i];for(let s=0,o=r.length-1;s<o;++s){const o=r.slice(s,s+2),a={feature:t,geometry:e,depth:[i,n],index:s,segment:o};this.rBush_.insert(q(o),a)}}}}writeCircleGeometry_(t,e){const i=e.getCenter(),n={feature:t,geometry:e,index:0,segment:[i,i]},s={feature:t,geometry:e,index:1,segment:[i,i]},r=[n,s];n.featureSegments=r,s.featureSegments=r,this.rBush_.insert(tt(i),n);let o=e;const a=Oe();if(a&&this.getMap()){const t=this.getMap().getView().getProjection();o=o.clone().transform(a,t),o=Gi(o).transform(t,a)}this.rBush_.insert(o.getExtent(),s)}writeGeometryCollectionGeometry_(t,e){const i=e.getGeometriesArray();for(let e=0;e<i.length;++e){const n=i[e];(0,this.SEGMENT_WRITERS_[n.getType()])(t,n)}}createOrUpdateVertexFeature_(t,e,i){let n=this.vertexFeature_;return n?n.getGeometry().setCoordinates(t):(n=new N(new pi(t)),this.vertexFeature_=n,this.overlay_.getSource().addFeature(n)),n.set("features",e),n.set("geometries",i),n}handleEvent(t){if(!t.originalEvent)return!0;let e;return this.lastPointerEvent_=t,t.map.getView().getInteracting()||t.type!=ha.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(t),this.vertexFeature_&&this.deleteCondition_(t)&&(e=!(t.type!=ha.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),t.type==ha.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),super.handleEvent(t)&&!e}handleDragEvent(t){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(t,this.dragSegments_);const e=[t.coordinate[0]+this.delta_[0],t.coordinate[1]+this.delta_[1]],i=[],n=[];for(let s=0,r=this.dragSegments_.length;s<r;++s){const r=this.dragSegments_[s],o=r[0],a=o.feature;i.includes(a)||i.push(a);const h=o.geometry;n.includes(h)||n.push(h);const l=o.depth;let c;const u=o.segment,d=r[1];for(;e.length<h.getStride();)e.push(u[d][e.length]);switch(h.getType()){case"Point":c=e,u[0]=e,u[1]=e;break;case"MultiPoint":c=h.getCoordinates(),c[o.index]=e,u[0]=e,u[1]=e;break;case"LineString":c=h.getCoordinates(),c[o.index+d]=e,u[d]=e;break;case"MultiLineString":case"Polygon":c=h.getCoordinates(),c[l[0]][o.index+d]=e,u[d]=e;break;case"MultiPolygon":c=h.getCoordinates(),c[l[1]][l[0]][o.index+d]=e,u[d]=e;break;case"Circle":if(u[0]=e,u[1]=e,0===o.index)this.changingFeature_=!0,h.setCenter(e),this.changingFeature_=!1;else{this.changingFeature_=!0;const i=t.map.getView().getProjection();let n=ce(Ne(h.getCenter(),i),Ne(e,i));const s=Oe();if(s){const t=h.clone().transform(s,i);t.setRadius(n),n=t.transform(i,s).getRadius()}h.setRadius(n),this.changingFeature_=!1}}c&&this.setGeometryCoordinates_(h,c)}this.createOrUpdateVertexFeature_(e,i,n)}handleDownEvent(t){if(!this.condition_(t))return!1;const e=t.coordinate;this.handlePointerAtPixel_(t.pixel,t.map,e),this.dragSegments_.length=0,this.featuresBeingModified_=null;const i=this.vertexFeature_;if(i){const n=t.map.getView().getProjection(),s=[],r=i.getGeometry().getCoordinates(),o=q([r]),a=this.rBush_.getInExtent(o),h={};a.sort(Ud);for(let i=0,o=a.length;i<o;++i){const o=a[i],l=o.segment;let c=F(o.geometry);const u=o.depth;if(u&&(c+="-"+u.join("-")),h[c]||(h[c]=new Array(2)),"Circle"!==o.geometry.getType()||1!==o.index)if(!ae(l[0],r)||h[c][0])if(!ae(l[1],r)||h[c][1])F(l)in this.vertexSegments_&&!h[c][0]&&!h[c][1]&&this.insertVertexCondition_(t)&&s.push(o);else{if(h[c][0]&&0===h[c][0].index){let t=o.geometry.getCoordinates();switch(o.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":t=t[u[1]];case"Polygon":if(o.index!==t[u[0]].length-2)continue}}this.dragSegments_.push([o,1]),h[c][1]=o}else this.dragSegments_.push([o,0]),h[c][0]=o;else ae(Kd(e,o,n),r)&&!h[c][0]&&(this.dragSegments_.push([o,0]),h[c][0]=o)}s.length&&this.willModifyFeatures_(t,[s]);for(let t=s.length-1;t>=0;--t)this.insertVertex_(s[t],r)}return!!this.vertexFeature_}handleUpEvent(t){for(let e=this.dragSegments_.length-1;e>=0;--e){const i=this.dragSegments_[e][0],n=i.geometry;if("Circle"===n.getType()){const e=n.getCenter(),s=i.featureSegments[0],r=i.featureSegments[1];s.segment[0]=e,s.segment[1]=e,r.segment[0]=e,r.segment[1]=e,this.rBush_.update(tt(e),s);let o=n;const a=Oe();if(a){const e=t.map.getView().getProjection();o=o.clone().transform(a,e),o=Gi(o).transform(e,a)}this.rBush_.update(o.getExtent(),r)}else this.rBush_.update(q(i.segment),i)}return this.featuresBeingModified_&&(this.dispatchEvent(new Xd(qd,this.featuresBeingModified_,t)),this.featuresBeingModified_=null),!1}handlePointerMove_(t){this.lastPixel_=t.pixel,this.handlePointerAtPixel_(t.pixel,t.map,t.coordinate)}handlePointerAtPixel_(t,e,i){const n=i||e.getCoordinateFromPixel(t),s=e.getView().getProjection(),r=function(t,e){return Vd(n,t,s)-Vd(n,e,s)};let o,a;if(this.hitDetection_){const i="object"==typeof this.hitDetection_?t=>t===this.hitDetection_:void 0;e.forEachFeatureAtPixel(t,((t,e,i)=>{i&&"Point"===i.getType()&&(i=new pi(De(i.getCoordinates(),s)));const n=i||t.getGeometry();if(t instanceof N&&this.features_.getArray().includes(t)){a=n;const e=t.getGeometry().getFlatCoordinates().slice(0,2);o=[{feature:t,geometry:a,segment:[e,e]}]}return!0}),{layerFilter:i})}if(!o){const t=Ge(X(je(tt(n,Bd),s),e.getView().getResolution()*this.pixelTolerance_,Bd),s);o=this.rBush_.getInExtent(t)}if(o&&o.length>0){const i=o.sort(r)[0],h=i.segment;let l=Kd(n,i,s);const c=e.getPixelFromCoordinate(l);let u=ce(t,c);if(a||u<=this.pixelTolerance_){const t={};if(t[F(h)]=!0,this.snapToPointer_||(this.delta_[0]=l[0]-n[0],this.delta_[1]=l[1]-n[1]),"Circle"===i.geometry.getType()&&1===i.index)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(l,[i.feature],[i.geometry]);else{const n=e.getPixelFromCoordinate(h[0]),s=e.getPixelFromCoordinate(h[1]),r=le(c,n),a=le(c,s);u=Math.sqrt(Math.min(r,a)),this.snappedToVertex_=u<=this.pixelTolerance_,this.snappedToVertex_&&(l=r>a?h[1]:h[0]),this.createOrUpdateVertexFeature_(l,[i.feature],[i.geometry]);const d={};d[F(i.geometry)]=!0;for(let e=1,i=o.length;e<i;++e){const i=o[e].segment;if(!(ae(h[0],i[0])&&ae(h[1],i[1])||ae(h[0],i[1])&&ae(h[1],i[0])))break;{const n=F(o[e].geometry);n in d||(d[n]=!0,t[F(i)]=!0)}}}return void(this.vertexSegments_=t)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)}insertVertex_(t,e){const i=t.segment,n=t.feature,s=t.geometry,r=t.depth,o=t.index;let a;for(;e.length<s.getStride();)e.push(0);switch(s.getType()){case"MultiLineString":case"Polygon":a=s.getCoordinates(),a[r[0]].splice(o+1,0,e);break;case"MultiPolygon":a=s.getCoordinates(),a[r[1]][r[0]].splice(o+1,0,e);break;case"LineString":a=s.getCoordinates(),a.splice(o+1,0,e);break;default:return}this.setGeometryCoordinates_(s,a);const h=this.rBush_;h.remove(t),this.updateSegmentIndices_(s,o,r,1);const l={segment:[i[0],e],feature:n,geometry:s,depth:r,index:o};h.insert(q(l.segment),l),this.dragSegments_.push([l,1]);const c={segment:[e,i[1]],feature:n,geometry:s,depth:r,index:o+1};h.insert(q(c.segment),c),this.dragSegments_.push([c,0]),this.ignoreNextSingleClick_=!0}removePoint(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=ha.POINTERDRAG){const t=this.lastPointerEvent_;this.willModifyFeatures_(t,this.dragSegments_);const e=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new Xd(qd,this.featuresBeingModified_,t)),this.featuresBeingModified_=null,e}return!1}removeVertex_(){const t=this.dragSegments_,e={};let i,n,s,r,o,a,h,l,c,u,d,g=!1;for(o=t.length-1;o>=0;--o)s=t[o],u=s[0],d=F(u.feature),u.depth&&(d+="-"+u.depth.join("-")),d in e||(e[d]={}),0===s[1]?(e[d].right=u,e[d].index=u.index):1==s[1]&&(e[d].left=u,e[d].index=u.index+1);for(d in e){switch(c=e[d].right,h=e[d].left,a=e[d].index,l=a-1,u=void 0!==h?h:c,l<0&&(l=0),r=u.geometry,n=r.getCoordinates(),i=n,g=!1,r.getType()){case"MultiLineString":n[u.depth[0]].length>2&&(n[u.depth[0]].splice(a,1),g=!0);break;case"LineString":n.length>2&&(n.splice(a,1),g=!0);break;case"MultiPolygon":i=i[u.depth[1]];case"Polygon":i=i[u.depth[0]],i.length>4&&(a==i.length-1&&(a=0),i.splice(a,1),g=!0,0===a&&(i.pop(),i.push(i[0]),l=i.length-1))}if(g){this.setGeometryCoordinates_(r,n);const e=[];if(void 0!==h&&(this.rBush_.remove(h),e.push(h.segment[0])),void 0!==c&&(this.rBush_.remove(c),e.push(c.segment[1])),void 0!==h&&void 0!==c){const t={depth:u.depth,feature:u.feature,geometry:u.geometry,index:l,segment:e};this.rBush_.insert(q(t.segment),t)}this.updateSegmentIndices_(r,a,u.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),t.length=0}}return g}setGeometryCoordinates_(t,e){this.changingFeature_=!0,t.setCoordinates(e),this.changingFeature_=!1}updateSegmentIndices_(t,e,i,n){this.rBush_.forEachInExtent(t.getExtent(),(function(s){s.geometry===t&&(void 0===i||void 0===s.depth||l(s.depth,i))&&s.index>e&&(s.index+=n)}))}};var Hd=["input","multi"],Jd=new sn;const $d=class extends m{constructor(t,e,i){super(),i=i||{},this.tileCoord=t,this.state=e,this.key="",this.transition_=void 0===i.transition?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(y)}release(){3===this.state&&this.setState(4)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(3!==this.state&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}load(){R()}getAlpha(t,e){if(!this.transition_)return 1;let i=this.transitionStarts_[t];if(i){if(-1===i)return 1}else i=e,this.transitionStarts_[t]=i;const n=e-i+1e3/60;return n>=this.transition_?1:kn(n/this.transition_)}inTransition(t){return!!this.transition_&&-1!==this.transitionStarts_[t]}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}},Qd=class extends $d{constructor(t,e,i,n,s,r){super(t,e,r),this.crossOrigin_=n,this.src_=i,this.key=i,this.image_=new Image,null!==n&&(this.image_.crossOrigin=n),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(t){this.image_=t,this.state=2,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=3,this.unlistenImage_(),this.image_=function(){const t=Us(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}(),this.changed()}handleImageLoad_(){const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=2:this.state=4,this.unlistenImage_(),this.changed()}load(){3==this.state&&(this.state=0,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),0==this.state&&(this.state=1,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=function(t,e,i){const n=t;let s=!0,r=!1,o=!1;const a=[E(n,"load",(function(){o=!0,r||e()}))];return n.src&&Ws?(r=!0,n.decode().then((function(){s&&e()})).catch((function(t){s&&(o?e():i())}))):a.push(E(n,"error",i)),function(){s=!1,a.forEach(P)}}(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}},tg=class{constructor(t,e,i,n,s,r){this.sourceProj_=t,this.targetProj_=e;let o={};const a=Ae(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){const e=t[0]+"/"+t[1];return o[e]||(o[e]=a(t)),o[e]},this.maxSourceExtent_=n,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&yt(n)>=yt(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?yt(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?yt(this.targetProj_.getExtent()):null;const h=_t(i),l=mt(i),c=ct(i),u=lt(i),d=this.transformInv_(h),g=this.transformInv_(l),f=this.transformInv_(c),p=this.transformInv_(u),_=10+(r?Math.max(0,Math.ceil(Math.log2(ht(i)/(r*r*256*256)))):0);if(this.addQuad_(h,l,c,u,d,g,f,p,_),this.wrapsXInSource_){let t=1/0;this.triangles_.forEach((function(e,i,n){t=Math.min(t,e.source[0][0],e.source[1][0],e.source[2][0])})),this.triangles_.forEach((e=>{if(Math.max(e.source[0][0],e.source[1][0],e.source[2][0])-t>this.sourceWorldWidth_/2){const i=[[e.source[0][0],e.source[0][1]],[e.source[1][0],e.source[1][1]],[e.source[2][0],e.source[2][1]]];i[0][0]-t>this.sourceWorldWidth_/2&&(i[0][0]-=this.sourceWorldWidth_),i[1][0]-t>this.sourceWorldWidth_/2&&(i[1][0]-=this.sourceWorldWidth_),i[2][0]-t>this.sourceWorldWidth_/2&&(i[2][0]-=this.sourceWorldWidth_);const n=Math.min(i[0][0],i[1][0],i[2][0]);Math.max(i[0][0],i[1][0],i[2][0])-n<this.sourceWorldWidth_/2&&(e.source=i)}}))}o={}}addTriangle_(t,e,i,n,s,r){this.triangles_.push({source:[n,s,r],target:[t,e,i]})}addQuad_(t,e,i,n,s,r,o,a,h){const l=q([s,r,o,a]),c=this.sourceWorldWidth_?yt(l)/this.sourceWorldWidth_:null,u=this.sourceWorldWidth_,d=this.sourceProj_.canWrapX()&&c>.5&&c<1;let g=!1;if(h>0&&(this.targetProj_.isGlobal()&&this.targetWorldWidth_&&(g=yt(q([t,e,i,n]))/this.targetWorldWidth_>.25||g),!d&&this.sourceProj_.isGlobal()&&c&&(g=c>.25||g)),!g&&this.maxSourceExtent_&&isFinite(l[0])&&isFinite(l[1])&&isFinite(l[2])&&isFinite(l[3])&&!vt(l,this.maxSourceExtent_))return;let f=0;if(!(g||isFinite(s[0])&&isFinite(s[1])&&isFinite(r[0])&&isFinite(r[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(a[0])&&isFinite(a[1])))if(h>0)g=!0;else if(f=(isFinite(s[0])&&isFinite(s[1])?0:8)+(isFinite(r[0])&&isFinite(r[1])?0:4)+(isFinite(o[0])&&isFinite(o[1])?0:2)+(isFinite(a[0])&&isFinite(a[1])?0:1),1!=f&&2!=f&&4!=f&&8!=f)return;if(h>0){if(!g){const e=[(t[0]+i[0])/2,(t[1]+i[1])/2],n=this.transformInv_(e);let r;r=d?(Pt(s[0],u)+Pt(o[0],u))/2-Pt(n[0],u):(s[0]+o[0])/2-n[0];const a=(s[1]+o[1])/2-n[1];g=r*r+a*a>this.errorThresholdSquared_}if(g){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){const l=[(e[0]+i[0])/2,(e[1]+i[1])/2],c=this.transformInv_(l),u=[(n[0]+t[0])/2,(n[1]+t[1])/2],d=this.transformInv_(u);this.addQuad_(t,e,l,u,s,r,c,d,h-1),this.addQuad_(u,l,i,n,d,c,o,a,h-1)}else{const l=[(t[0]+e[0])/2,(t[1]+e[1])/2],c=this.transformInv_(l),u=[(i[0]+n[0])/2,(i[1]+n[1])/2],d=this.transformInv_(u);this.addQuad_(t,l,u,n,s,c,d,a,h-1),this.addQuad_(l,e,i,u,c,r,o,d,h-1)}return}}if(d){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}11&f||this.addTriangle_(t,i,n,s,o,a),14&f||this.addTriangle_(t,i,e,s,o,r),f&&(13&f||this.addTriangle_(e,n,t,r,a,s),7&f||this.addTriangle_(e,n,i,r,a,o))}calculateSourceExtent(){const t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach((function(e,i,n){const s=e.source;st(t,s[0]),st(t,s[1]),st(t,s[2])})),t}getTriangles(){return this.triangles_}};let eg;const ig=[];function ng(t,e,i,n,s){t.beginPath(),t.moveTo(0,0),t.lineTo(e,i),t.lineTo(n,s),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,n)+1,Math.max(i,s)),t.restore()}function sg(t,e){return Math.abs(t[4*e]-210)>2||Math.abs(t[4*e+3]-191.25)>2}function rg(t,e,i,n){const s=Fe(i,e,t);let r=Ce(e,n,i);const o=e.getMetersPerUnit();void 0!==o&&(r*=o);const a=t.getMetersPerUnit();void 0!==a&&(r/=a);const h=t.getExtent();if(!h||K(h,s)){const e=Ce(t,r,s)/r;isFinite(e)&&e>0&&(r/=e)}return r}function og(t,e,i,n){const s=ut(i);let r=rg(t,e,s,n);return(!isFinite(r)||r<=0)&&at(i,(function(i){return r=rg(t,e,i,n),isFinite(r)&&r>0})),r}function ag(t,e,i,n,s,r,o,a,h,l,c,u,d,g){const f=Us(Math.round(i*t),Math.round(i*e),ig);if(u||(f.imageSmoothingEnabled=!1),0===h.length)return f.canvas;function p(t){return Math.round(t*i)/i}f.scale(i,i),f.globalCompositeOperation="lighter";const _=[1/0,1/0,-1/0,-1/0];let m;h.forEach((function(t,e,i){nt(_,t.extent)}));const y=i/n,v=(u?1:1+Math.pow(2,-24))/y;if(!d||1!==h.length||0!==l){if(m=Us(Math.round(yt(_)*y),Math.round(ft(_)*y),ig),u||(m.imageSmoothingEnabled=!1),s&&g){const t=(s[0]-_[0])*y,e=-(s[3]-_[3])*y,i=yt(s)*y,n=ft(s)*y;m.rect(t,e,i,n),m.clip()}h.forEach((function(t,e,i){if(t.image.width>0&&t.image.height>0){if(t.clipExtent){m.save();const e=(t.clipExtent[0]-_[0])*y,i=-(t.clipExtent[3]-_[3])*y,n=yt(t.clipExtent)*y,s=ft(t.clipExtent)*y;m.rect(u?e:Math.round(e),u?i:Math.round(i),u?n:Math.round(e+n)-Math.round(e),u?s:Math.round(i+s)-Math.round(i)),m.clip()}const e=(t.extent[0]-_[0])*y,i=-(t.extent[3]-_[3])*y,n=yt(t.extent)*y,s=ft(t.extent)*y;m.drawImage(t.image,l,l,t.image.width-2*l,t.image.height-2*l,u?e:Math.round(e),u?i:Math.round(i),u?n:Math.round(e+n)-Math.round(e),u?s:Math.round(i+s)-Math.round(i)),t.clipExtent&&m.restore()}}))}const x=_t(o);return a.getTriangles().forEach((function(t,e,i){const n=t.source,s=t.target;let o=n[0][0],a=n[0][1],l=n[1][0],c=n[1][1],d=n[2][0],g=n[2][1];const y=p((s[0][0]-x[0])/r),M=p(-(s[0][1]-x[1])/r),w=p((s[1][0]-x[0])/r),S=p(-(s[1][1]-x[1])/r),C=p((s[2][0]-x[0])/r),b=p(-(s[2][1]-x[1])/r),E=o,P=a;o=0,a=0,l-=E,c-=P,d-=E,g-=P;const I=function(t){const e=t.length;for(let i=0;i<e;i++){let n=i,s=Math.abs(t[i][i]);for(let r=i+1;r<e;r++){const e=Math.abs(t[r][i]);e>s&&(s=e,n=r)}if(0===s)return null;const r=t[n];t[n]=t[i],t[i]=r;for(let n=i+1;n<e;n++){const s=-t[n][i]/t[i][i];for(let r=i;r<e+1;r++)i==r?t[n][r]=0:t[n][r]+=s*t[i][r]}}const i=new Array(e);for(let n=e-1;n>=0;n--){i[n]=t[n][e]/t[n][n];for(let s=n-1;s>=0;s--)t[s][e]-=t[s][n]*i[n]}return i}([[l,c,0,0,w-y],[d,g,0,0,C-y],[0,0,l,c,S-M],[0,0,d,g,b-M]]);if(!I)return;if(f.save(),f.beginPath(),function(){if(void 0===eg){const t=Us(6,6,ig);t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",ng(t,4,5,4,0),ng(t,4,5,0,5);const e=t.getImageData(0,0,3,3).data;eg=sg(e,0)||sg(e,4)||sg(e,8),Ys(t),ig.push(t.canvas)}return eg}()||!u){f.moveTo(w,S);const t=4,e=y-w,i=M-S;for(let n=0;n<t;n++)f.lineTo(w+p((n+1)*e/t),S+p(n*i/(t-1))),n!=t-1&&f.lineTo(w+p((n+1)*e/t),S+p((n+1)*i/(t-1)));f.lineTo(C,b)}else f.moveTo(w,S),f.lineTo(y,M),f.lineTo(C,b);let T;if(f.clip(),f.transform(I[0],I[2],I[1],I[3],y,M),f.translate(_[0]-E,_[3]-P),m)T=m.canvas,f.scale(v,-v);else{const t=h[0],e=t.extent;T=t.image,f.scale(yt(e)/T.width,-ft(e)/T.height)}f.drawImage(T,0,0),f.restore()})),m&&(Ys(m),ig.push(m.canvas)),c&&(f.save(),f.globalCompositeOperation="source-over",f.strokeStyle="black",f.lineWidth=1,a.getTriangles().forEach((function(t,e,i){const n=t.target,s=(n[0][0]-x[0])/r,o=-(n[0][1]-x[1])/r,a=(n[1][0]-x[0])/r,h=-(n[1][1]-x[1])/r,l=(n[2][0]-x[0])/r,c=-(n[2][1]-x[1])/r;f.beginPath(),f.moveTo(a,h),f.lineTo(s,o),f.lineTo(l,c),f.closePath(),f.stroke()})),f.restore()),f.canvas}const hg=class extends $d{constructor(t,e,i,n,s,r,o,a,h,l,c,u){super(s,0,u),this.renderEdges_=void 0!==c&&c,this.pixelRatio_=o,this.gutter_=a,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=n,this.wrappedTileCoord_=r||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=t.canWrapX()?t.getExtent():void 0;const d=n.getTileCoordExtent(this.wrappedTileCoord_),g=this.targetTileGrid_.getExtent();let f=this.sourceTileGrid_.getExtent();const p=g?pt(d,g):d;if(0===ht(p))return void(this.state=4);const _=t.getExtent();_&&(f=f?pt(f,_):_);const m=n.getResolution(this.wrappedTileCoord_[0]),y=og(t,i,p,m);if(!isFinite(y)||y<=0)return void(this.state=4);const v=void 0!==l?l:.5;if(this.triangulation_=new tg(t,i,p,f,y*v,m),0===this.triangulation_.getTriangles().length)return void(this.state=4);this.sourceZ_=e.getZForResolution(y);let x=this.triangulation_.calculateSourceExtent();if(f&&(t.canWrapX()?(x[1]=St(x[1],f[1],f[3]),x[3]=St(x[3],f[1],f[3])):x=pt(x,f)),ht(x)){let i=0,n=0;t.canWrapX()&&(i=yt(_),n=Math.floor((x[0]-_[0])/i)),wt(x.slice(),t,!0).forEach((t=>{const s=e.getTileRangeForExtentAndZ(t,this.sourceZ_);for(let t=s.minX;t<=s.maxX;t++)for(let e=s.minY;e<=s.maxY;e++){const s=h(this.sourceZ_,t,e,o);if(s){const t=n*i;this.sourceTiles_.push({tile:s,offset:t})}}++n})),0===this.sourceTiles_.length&&(this.state=4)}else this.state=4}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach((e=>{const i=e.tile;if(i&&2==i.getState()){const n=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);n[0]+=e.offset,n[2]+=e.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=e.offset,s[2]+=e.offset),t.push({extent:n,clipExtent:s,image:i.getImage()})}})),this.sourceTiles_.length=0,0===t.length)this.state=3;else{const e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),n="number"==typeof i?i:i[0],s="number"==typeof i?i:i[1],r=this.targetTileGrid_.getResolution(e),o=this.sourceTileGrid_.getResolution(this.sourceZ_),a=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=ag(n,s,this.pixelRatio_,o,this.sourceTileGrid_.getExtent(),r,a,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=2}this.changed()}load(){if(0==this.state){this.state=1,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach((({tile:e})=>{const i=e.getState();if(0==i||1==i){t++;const i=b(e,y,(n=>{const s=e.getState();2!=s&&3!=s&&4!=s||(P(i),t--,0===t&&(this.unlistenSources_(),this.reproject_()))}));this.sourcesListenerKeys_.push(i)}})),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach((function({tile:t},e,i){0==t.getState()&&t.load()}))}}unlistenSources_(){this.sourcesListenerKeys_.forEach(P),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Ys(this.canvas_.getContext("2d")),ig.push(this.canvas_),this.canvas_=null),super.release()}},lg=class{constructor(t){this.highWaterMark=void 0!==t?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.pop()}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const i=this.entries_[t];return O(void 0!==i,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(t){const e=this.entries_[t];return O(void 0!==e,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e,i=0;for(e=this.newest_;e;e=e.older)t[i++]=e.key_;return t}getValues(){const t=new Array(this.count_);let e,i=0;for(e=this.newest_;e;e=e.older)t[i++]=e.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){return this.entries_[t]?.value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){O(!(t in this.entries_),"Tried to set a value for a key that is used already");const i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_}setSize(t){this.highWaterMark=t}};function cg(t,e,i,n){return void 0!==n?(n[0]=t,n[1]=e,n[2]=i,n):[t,e,i]}function ug(t,e,i){return t+"/"+e+"/"+i}function dg(t){return ug(t[0],t[1],t[2])}const gg=class extends lg{clear(){for(;this.getCount()>0;)this.pop().release();super.clear()}expireCache(t){for(;this.canExpireCache()&&!(this.peekLast().getKey()in t);)this.pop().release()}pruneExceptNewestZ(){if(0===this.getCount())return;const t=this.peekFirstKey().split("/").map(Number)[0];this.forEach((e=>{e.tileCoord[0]!==t&&(this.remove(dg(e.tileCoord)),e.release())}))}};class fg{constructor(t,e,i,n){this.minX=t,this.maxX=e,this.minY=i,this.maxY=n}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function pg(t,e,i,n,s){return void 0!==s?(s.minX=t,s.maxX=e,s.minY=i,s.maxY=n,s):new fg(t,e,i,n)}const _g=fg,mg=[0,0,0],yg=class{constructor(t){let e;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,O(function(t){const e=((t,e)=>e-t)||r;return t.every((function(i,n){if(0===n)return!0;const s=e(t[n-1],i);return!(s>0||0===s)}))}(this.resolutions_),"`resolutions` must be sorted in descending order"),!t.origins)for(let t=0,i=this.resolutions_.length-1;t<i;++t)if(e){if(this.resolutions_[t]/this.resolutions_[t+1]!==e){e=void 0;break}}else e=this.resolutions_[t]/this.resolutions_[t+1];this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,O(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=t.extent;void 0===i||this.origin_||this.origins_||(this.origin_=_t(i)),O(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,O(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:En,O(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=void 0!==i?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map(((t,e)=>{const n=new _g(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1));if(i){const t=this.getTileRangeForExtentAndZ(i,e);n.minX=Math.max(t.minX,n.minX),n.maxX=Math.min(t.maxX,n.maxX),n.minY=Math.max(t.minY,n.minY),n.maxY=Math.min(t.maxY,n.maxY)}return n})):i&&this.calculateTileRanges_(i)}forEachTileCoord(t,e,i){const n=this.getTileRangeForExtentAndZ(t,e);for(let t=n.minX,s=n.maxX;t<=s;++t)for(let s=n.minY,r=n.maxY;s<=r;++s)i([e,t,s])}forEachTileCoordParentTileRange(t,e,i,n){let s,r,o,a=null,h=t[0]-1;for(2===this.zoomFactor_?(r=t[1],o=t[2]):a=this.getTileCoordExtent(t,n);h>=this.minZoom;){if(void 0!==r&&void 0!==o?(r=Math.floor(r/2),o=Math.floor(o/2),s=pg(r,r,o,o,i)):s=this.getTileRangeForExtentAndZ(a,h,i),e(h,s))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,i){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){const i=2*t[1],n=2*t[2];return pg(i,i+1,n,n+1,e)}const n=this.getTileCoordExtent(t,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(n,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,i){if(e>this.maxZoom||e<this.minZoom)return null;const n=t[0],s=t[1],r=t[2];if(e===n)return pg(s,r,s,r,i);if(this.zoomFactor_){const t=Math.pow(this.zoomFactor_,e-n),o=Math.floor(s*t),a=Math.floor(r*t);return e<n?pg(o,o,a,a,i):pg(o,Math.floor(t*(s+1))-1,a,Math.floor(t*(r+1))-1,i)}const o=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,e,i)}getTileRangeForExtentAndZ(t,e,i){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,mg);const n=mg[1],s=mg[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,mg),pg(n,mg[1],s,mg[2],i)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),i=this.getResolution(t[0]),n=gs(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*n[0]*i,e[1]-(t[2]+.5)*n[1]*i]}getTileCoordExtent(t,e){const i=this.getOrigin(t[0]),n=this.getResolution(t[0]),s=gs(this.getTileSize(t[0]),this.tmpSize_),r=i[0]+t[1]*s[0]*n,o=i[1]-(t[2]+1)*s[1]*n;return J(r,o,r+s[0]*n,o+s[1]*n,e)}getTileCoordForCoordAndResolution(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)}getTileCoordForXYAndResolution_(t,e,i,n,s){const r=this.getZForResolution(i),o=i/this.getResolution(r),a=this.getOrigin(r),h=gs(this.getTileSize(r),this.tmpSize_);let l=o*(t-a[0])/i/h[0],c=o*(a[1]-e)/i/h[1];return n?(l=Ft(l,5)-1,c=Ft(c,5)-1):(l=At(l,5),c=At(c,5)),cg(r,l,c,s)}getTileCoordForXYAndZ_(t,e,i,n,s){const r=this.getOrigin(i),o=this.getResolution(i),a=gs(this.getTileSize(i),this.tmpSize_);let h=(t-r[0])/o/a[0],l=(r[1]-e)/o/a[1];return n?(h=Ft(h,5)-1,l=Ft(l,5)-1):(h=At(h,5),l=At(l,5)),cg(i,h,l,s)}getTileCoordForCoordAndZ(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){return St(o(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return Ei(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){const e=this.resolutions_.length,i=new Array(e);for(let n=this.minZoom;n<e;++n)i[n]=this.getTileRangeForExtentAndZ(t,n);this.fullTileRanges_=i}};function vg(t){let e=t.getDefaultTileGrid();return e||(e=function(t){return function(t,e,i,n){n=void 0!==n?n:"top-left";const s=xg(t,e,i);return new yg({extent:t,origin:dt(t,n),resolutions:s,tileSize:i})}(Mg(t),void 0,void 0,void 0)}(t),t.setDefaultTileGrid(e)),e}function xg(t,e,i,n){e=void 0!==e?e:bn,i=gs(void 0!==i?i:En);const s=ft(t),r=yt(t);n=n>0?n:Math.max(r/i[0],s/i[1]);const o=e+1,a=new Array(o);for(let t=0;t<o;++t)a[t]=n/Math.pow(2,t);return a}function Mg(t){let e=(t=Se(t)).getExtent();if(!e){const i=180*qt.degrees/t.getMetersPerUnit();e=J(-i,-i,i,i)}return e}class wg extends t{constructor(t,e){super(t),this.tile=e}}const Sg=class extends uh{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=void 0!==t.tilePixelRatio?t.tilePixelRatio:1,this.tileGrid=void 0!==t.tileGrid?t.tileGrid:null;this.tileGrid&&gs(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),[256,256]),this.tileCache=new gg(t.cacheSize||0),this.tmpSize=[0,0],this.key_=t.key||"",this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}canExpireCache(){return this.tileCache.canExpireCache()}expireCache(t,e){const i=this.getTileCacheForProjection(t);i&&i.expireCache(e)}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getResolutions(t){const e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,i,n,s){return R()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:vg(t)}getTileCacheForProjection(t){const e=this.getProjection();return O(null===e||Te(e,t),"A VectorTile source can only be rendered if it has a projection compatible with the view projection."),this.tileCache}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,i){const n=this.getTileGridForProjection(i),s=this.getTilePixelRatio(e),r=gs(n.getTileSize(t),this.tmpSize);return 1==s?r:(o=r,a=s,void 0===(h=this.tmpSize)&&(h=[0,0]),h[0]=o[0]*a+.5|0,h[1]=o[1]*a+.5|0,h);var o,a,h}getTileCoordForTileUrlFunction(t,e){e=void 0!==e?e:this.getProjection();const i=this.getTileGridForProjection(e);return this.getWrapX()&&e.isGlobal()&&(t=function(t,e,i){const n=e[0],s=t.getTileCoordCenter(e),r=Mg(i);if(!K(r,s)){const e=yt(r),i=Math.ceil((r[0]-s[0])/e);return s[0]+=e*i,t.getTileCoordForCoordAndZ(s,n)}return e}(i,t,e)),function(t,e){const i=t[0],n=t[1],s=t[2];if(e.getMinZoom()>i||i>e.getMaxZoom())return!1;const r=e.getFullTileRange(i);return!r||r.containsXY(n,s)}(t,i)?t:null}clear(){this.tileCache.clear()}refresh(){this.clear(),super.refresh()}useTile(t,e,i,n){}};function Cg(t,e){const i=[];Object.keys(e).forEach((function(t){null!==e[t]&&void 0!==e[t]&&i.push(t+"="+encodeURIComponent(e[t]))}));const n=i.join("&");return t=t.replace(/[?&]$/,""),(t+=t.includes("?")?"&":"?")+n}const bg=/\{z\}/g,Eg=/\{x\}/g,Pg=/\{y\}/g,Ig=/\{-y\}/g;function Tg(t){const e=[];let i=/\{([a-z])-([a-z])\}/.exec(t);if(i){const n=i[1].charCodeAt(0),s=i[2].charCodeAt(0);let r;for(r=n;r<=s;++r)e.push(t.replace(i[0],String.fromCharCode(r)));return e}if(i=/\{(\d+)-(\d+)\}/.exec(t),i){const n=parseInt(i[2],10);for(let s=parseInt(i[1],10);s<=n;s++)e.push(t.replace(i[0],s.toString()));return e}return e.push(t),e}function Rg(t,e){return function(i,n,s){if(!i)return;let r;const o=i[0];if(e){const t=e.getFullTileRange(o);t&&(r=t.getHeight()-1)}return function(t,e,i,n,s){return t.replace(bg,e.toString()).replace(Eg,i.toString()).replace(Pg,n.toString()).replace(Ig,(function(){if(void 0===s)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(s-n).toString()}))}(t,o,i[1],i[2],r)}}function Ag(t){return 1===t.length?t[0]:function(e,i,n){if(!e)return;const s=function(t){return e=t[0],(t[1]<<e)+t[2];var e}(e),r=Pt(s,t.length);return t[r](e,i,n)}}class Fg extends Sg{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===Fg.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,i=F(e),n=e.getState();let s;1==n?(this.tileLoadingKeys_[i]=!0,s="tileloadstart"):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=3==n?"tileloaderror":2==n?"tileloadend":void 0),null!=s&&this.dispatchEvent(new wg(s,e))}setTileLoadFunction(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()}setUrl(t){const e=Tg(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(function(t,e){const i=t.length,n=new Array(i);for(let s=0;s<i;++s)n[s]=Rg(t[s],e);return Ag(n)}(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,i){}useTile(t,e,i){const n=ug(t,e,i);this.tileCache.containsKey(n)&&this.tileCache.get(n)}}const Lg=Fg;function kg(t,e){t.getImage().src=e}const Og=class extends Lg{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:kg,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:void 0===t.interpolate||t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=void 0!==t.crossOrigin?t.crossOrigin:null,this.tileClass=void 0!==t.tileClass?t.tileClass:Qd,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}canExpireCache(){if(this.tileCache.canExpireCache())return!0;for(const t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1}expireCache(t,e){const i=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==i?e:{});for(const t in this.tileCacheForProjection){const n=this.tileCacheForProjection[t];n.expireCache(n==i?e:{})}}getGutterForProjection(t){return this.getProjection()&&t&&!Te(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||Te(e,t)))return this.tileGrid;const i=F(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=vg(t)),this.tileGridForProjection[i]}getTileCacheForProjection(t){const e=this.getProjection();if(!e||Te(e,t))return this.tileCache;const i=F(t);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new gg(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]}createTile_(t,e,i,n,s,r){const o=[t,e,i],a=this.getTileCoordForTileUrlFunction(o,s),h=a?this.tileUrlFunction(a,n,s):void 0,l=new this.tileClass(o,void 0!==h?0:4,void 0!==h?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return l.key=r,l.addEventListener(y,this.handleTileChange.bind(this)),l}getTile(t,e,i,n,s){const r=this.getProjection();if(!r||!s||Te(r,s))return this.getTileInternal(t,e,i,n,r||s);const o=this.getTileCacheForProjection(s),a=[t,e,i];let h;const l=dg(a);o.containsKey(l)&&(h=o.get(l));const c=this.getKey();if(h&&h.key==c)return h;const u=this.getTileGridForProjection(r),d=this.getTileGridForProjection(s),g=this.getTileCoordForTileUrlFunction(a,s),f=new hg(r,u,s,d,a,g,this.getTilePixelRatio(n),this.getGutter(),((t,e,i,n)=>this.getTileInternal(t,e,i,n,r)),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return f.key=c,h?o.replace(l,f):o.set(l,f),f}getTileInternal(t,e,i,n,s){const r=ug(t,e,i),o=this.getKey();if(!this.tileCache.containsKey(r)){const a=this.createTile_(t,e,i,n,s,o);return this.tileCache.set(r,a),a}let a=this.tileCache.get(r);return a.key!=o&&(a=this.createTile_(t,e,i,n,s,o),this.tileCache.replace(r,a)),a}setRenderReprojectionEdges(t){if(this.renderReprojectionEdges_!=t){this.renderReprojectionEdges_=t;for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear();this.changed()}}setTileGridForProjection(t,e){const i=Se(t);if(i){const t=F(i);t in this.tileGridForProjection||(this.tileGridForProjection[t]=e)}}clear(){super.clear();for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear()}},Dg=class extends Og{constructor(t){const e=void 0!==(t=t||{}).projection?t.projection:"EPSG:3857",i=void 0!==t.tileGrid?t.tileGrid:function(t){const e=t||{},i=e.extent||Se("EPSG:3857").getExtent(),n={extent:i,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:xg(i,e.maxZoom,e.tileSize,e.maxResolution)};return new yg(n)}({extent:Mg(e),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:e,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.gutter_=void 0!==t.gutter?t.gutter:0}getGutter(){return this.gutter_}},Ng=class extends Dg{constructor(t){let e;e=void 0!==(t=t||{}).attributions?t.attributions:['&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.'];const i=void 0!==t.crossOrigin?t.crossOrigin:"anonymous",n=void 0!==t.url?t.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:e,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:i,interpolate:t.interpolate,maxZoom:void 0!==t.maxZoom?t.maxZoom:19,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:n,wrapX:t.wrapX,zDirection:t.zDirection})}},Gg=class extends Og{constructor(t){const e=void 0!==t.requestEncoding?t.requestEncoding:"KVP",i=t.tileGrid;let n=t.urls;void 0===n&&void 0!==t.url&&(n=Tg(t.url)),super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:i,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,urls:n,wrapX:void 0!==t.wrapX&&t.wrapX,transition:t.transition,zDirection:t.zDirection}),this.version_=void 0!==t.version?t.version:"1.0.0",this.format_=void 0!==t.format?t.format:"image/jpeg",this.dimensions_=void 0!==t.dimensions?t.dimensions:{},this.layer_=t.layer,this.matrixSet_=t.matrixSet,this.style_=t.style,this.requestEncoding_=e,this.setKey(this.getKeyForDimensions_()),n&&n.length>0&&(this.tileUrlFunction=Ag(n.map(this.createFromWMTSTemplate.bind(this))))}setUrls(t){this.urls=t;const e=t.join("\n");this.setTileUrlFunction(Ag(t.map(this.createFromWMTSTemplate.bind(this))),e)}getDimensions(){return this.dimensions_}getFormat(){return this.format_}getLayer(){return this.layer_}getMatrixSet(){return this.matrixSet_}getRequestEncoding(){return this.requestEncoding_}getStyle(){return this.style_}getVersion(){return this.version_}getKeyForDimensions_(){const t=this.urls?this.urls.slice(0):[];for(const e in this.dimensions_)t.push(e+"-"+this.dimensions_[e]);return t.join("/")}updateDimensions(t){Object.assign(this.dimensions_,t),this.setKey(this.getKeyForDimensions_())}createFromWMTSTemplate(t){const e=this.requestEncoding_,i={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};"KVP"==e&&Object.assign(i,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),t="KVP"==e?Cg(t,i):t.replace(/\{(\w+?)\}/g,(function(t,e){return e.toLowerCase()in i?i[e.toLowerCase()]:t}));const n=this.tileGrid,s=this.dimensions_;return function(i,r,o){if(!i)return;const a={TileMatrix:n.getMatrixId(i[0]),TileCol:i[1],TileRow:i[2]};Object.assign(a,s);let h=t;return h="KVP"==e?Cg(h,a):h.replace(/\{(\w+?)\}/g,(function(t,e){return a[e]})),h}}};const jg=class extends yg{constructor(t){super({extent:t.extent,origin:t.origin,origins:t.origins,resolutions:t.resolutions,tileSize:t.tileSize,tileSizes:t.tileSizes,sizes:t.sizes}),this.matrixIds_=t.matrixIds}getMatrixId(t){return this.matrixIds_[t]}getMatrixIds(){return this.matrixIds_}},zg="preload",Bg="useInterimTilesOnError",Wg=class extends qn{constructor(t){t=t||{};const e=Object.assign({},t),i=t.cacheSize;delete t.cacheSize,delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(void 0!==t.preload?t.preload:0),this.setUseInterimTilesOnError(void 0===t.useInterimTilesOnError||t.useInterimTilesOnError)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(zg)}setPreload(t){this.set(zg,t)}getUseInterimTilesOnError(){return this.get(Bg)}setUseInterimTilesOnError(t){this.set(Bg,t)}getData(t){return super.getData(t)}};function qg(t){return t instanceof Image||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageBitmap?t:null}const Xg=new Error("disposed");let Ug=null;const Vg=[256,256],Kg=class extends $d{constructor(t){super(t.tileCoord,0,{transition:t.transition,interpolate:t.interpolate}),this.loader_=t.loader,this.data_=null,this.error_=null,this.size_=t.size||null,this.controller_=t.controller||null}getSize(){if(this.size_)return this.size_;const t=qg(this.data_);return t?[t.width,t.height]:Vg}getData(){return this.data_}getError(){return this.error_}load(){if(0!==this.state&&3!==this.state)return;this.state=1,this.changed();const t=this;this.loader_().then((function(e){t.data_=e,t.state=2,t.changed()})).catch((function(e){t.error_=e,t.state=3,t.changed()}))}disposeInternal(){this.controller_&&(this.controller_.abort(Xg),this.controller_=null),super.disposeInternal()}},Yg=class extends Kg{constructor(t){super({tileCoord:t.tileCoord,loader:()=>Promise.resolve(new Uint8ClampedArray(4)),interpolate:t.interpolate,transition:t.transition}),this.pixelRatio_=t.pixelRatio,this.gutter_=t.gutter,this.reprojData_=null,this.reprojError_=null,this.reprojSize_=void 0,this.sourceTileGrid_=t.sourceTileGrid,this.targetTileGrid_=t.targetTileGrid,this.wrappedTileCoord_=t.wrappedTileCoord||t.tileCoord,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const e=t.sourceProj,i=e.getExtent(),n=t.sourceTileGrid.getExtent();this.clipExtent_=e.canWrapX()?n?pt(i,n):i:n;const s=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_),r=this.targetTileGrid_.getExtent();let o=this.sourceTileGrid_.getExtent();const a=r?pt(s,r):s;if(0===ht(a))return void(this.state=4);i&&(o=o?pt(o,i):i);const h=this.targetTileGrid_.getResolution(this.wrappedTileCoord_[0]),l=t.targetProj,c=og(e,l,a,h);if(!isFinite(c)||c<=0)return void(this.state=4);const u=void 0!==t.errorThreshold?t.errorThreshold:.5;if(this.triangulation_=new tg(e,l,a,o,c*u,h),0===this.triangulation_.getTriangles().length)return void(this.state=4);this.sourceZ_=this.sourceTileGrid_.getZForResolution(c);let d=this.triangulation_.calculateSourceExtent();if(o&&(e.canWrapX()?(d[1]=St(d[1],o[1],o[3]),d[3]=St(d[3],o[1],o[3])):d=pt(d,o)),ht(d)){let n=0,s=0;e.canWrapX()&&(n=yt(i),s=Math.floor((d[0]-i[0])/n)),wt(d.slice(),e,!0).forEach((e=>{const i=this.sourceTileGrid_.getTileRangeForExtentAndZ(e,this.sourceZ_),r=t.getTileFunction;for(let t=i.minX;t<=i.maxX;t++)for(let e=i.minY;e<=i.maxY;e++){const i=r(this.sourceZ_,t,e,this.pixelRatio_);if(i){const t=s*n;this.sourceTiles_.push({tile:i,offset:t})}}++s})),0===this.sourceTiles_.length&&(this.state=4)}else this.state=4}getSize(){return this.reprojSize_}getData(){return this.reprojData_}getError(){return this.reprojError_}reproject_(){const t=[];let e=!1;if(this.sourceTiles_.forEach((i=>{const n=i.tile;if(!n||2!==n.getState())return;const s=n.getSize(),r=this.gutter_;let o;const a=(h=n.getData())instanceof Uint8Array||h instanceof Uint8ClampedArray||h instanceof Float32Array||h instanceof DataView?h:null;var h;a?o=a:(e=!0,o=function(t){Ug||(Ug=Us(t.width,t.height,void 0,{willReadFrequently:!0}));const e=Ug.canvas,i=t.width;e.width!==i&&(e.width=i);const n=t.height;return e.height!==n&&(e.height=n),Ug.clearRect(0,0,i,n),Ug.drawImage(t,0,0),Ug.getImageData(0,0,i,n).data}(qg(n.getData())));const l=[s[0]+2*r,s[1]+2*r],c=o instanceof Float32Array,u=l[0]*l[1],d=c?Float32Array:Uint8ClampedArray,g=new d(o.buffer),f=d.BYTES_PER_ELEMENT,p=f*g.length/u,_=g.byteLength/l[1],m=Math.floor(_/f/l[0]),y=u*m;let v=g;if(g.length!==y){v=new d(y);let t=0,e=0;const i=l[0]*m;for(let n=0;n<l[1];++n){for(let n=0;n<i;++n)v[t++]=g[e+n];e+=_/f}}const x=this.sourceTileGrid_.getTileCoordExtent(n.tileCoord);x[0]+=i.offset,x[2]+=i.offset;const M=this.clipExtent_?.slice();M&&(M[0]+=i.offset,M[2]+=i.offset),t.push({extent:x,clipExtent:M,data:new Uint8ClampedArray(v.buffer),dataType:d,bytesPerPixel:p,pixelSize:l})})),this.sourceTiles_.length=0,0===t.length)return this.state=3,void this.changed();const i=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(i),s="number"==typeof n?n:n[0],r="number"==typeof n?n:n[1],o=this.targetTileGrid_.getResolution(i),a=this.sourceTileGrid_.getResolution(this.sourceZ_),h=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);let l,c;const u=t[0].bytesPerPixel;for(let e=Math.ceil(u/3)-1;e>=0;--e){const i=[];for(let n=0,s=t.length;n<s;++n){const s=t[n],r=s.data,o=s.pixelSize,a=o[0],h=o[1],l=Us(a,h,ig),c=l.createImageData(a,h),d=c.data;let g=3*e;for(let t=0,e=d.length;t<e;t+=4)d[t]=r[g],d[t+1]=r[g+1],d[t+2]=r[g+2],d[t+3]=255,g+=u;l.putImageData(c,0,0),i.push({extent:s.extent,clipExtent:s.clipExtent,image:l.canvas})}const n=ag(s,r,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,h,this.triangulation_,i,this.gutter_,!1,!1,!1);for(let t=0,e=i.length;t<e;++t){const e=i[t].image.getContext("2d");Ys(e),ig.push(e.canvas)}const d=n.getContext("2d"),g=d.getImageData(0,0,n.width,n.height);Ys(d),ig.push(n),l||(c=new Uint8ClampedArray(u*g.width*g.height),l=new t[0].dataType(c.buffer));const f=g.data;let p=3*e;for(let t=0,e=f.length;t<e;t+=4)255===f[t+3]?(c[p]=f[t],c[p+1]=f[t+1],c[p+2]=f[t+2]):(c[p]=0,c[p+1]=0,c[p+2]=0),p+=u}if(e){const t=Us(s,r),e=new ImageData(l,s);t.putImageData(e,0,0),this.reprojData_=t.canvas}else this.reprojData_=l;this.reprojSize_=[Math.round(s*this.pixelRatio_),Math.round(r*this.pixelRatio_)],this.state=2,this.changed()}load(){if(0!==this.state&&3!==this.state)return;this.state=1,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach((({tile:e})=>{const i=e.getState();if(0!==i&&1!==i)return;t++;const n=b(e,y,(()=>{const i=e.getState();2!=i&&3!=i&&4!=i||(P(n),t--,0===t&&(this.unlistenSources_(),this.reproject_()))}));this.sourcesListenerKeys_.push(n)})),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach((function({tile:t}){0==t.getState()&&t.load()}))}unlistenSources_(){this.sourcesListenerKeys_.forEach(P),this.sourcesListenerKeys_=null}};function Zg(t,e,i,n){return`${t},${ug(e,i,n)}`}function Hg(t,e,i){if(!(i in t))return t[i]=new Set([e]),!0;const n=t[i],s=n.has(e);return s||n.add(e),!s}function Jg(t,e,i){const n=t[i];return!!n&&n.delete(e)}function $g(t,e){const i=t.layerStatesArray[t.layerIndex];i.extent&&(e=pt(e,je(i.extent,t.viewState.projection)));const n=i.layer.getRenderSource();if(!n.getWrapX()){const i=n.getTileGridForProjection(t.viewState.projection).getExtent();i&&(e=pt(e,i))}return e}const Qg=class extends td{constructor(t,e){super(t),e=e||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=[1/0,1/0,-1/0,-1/0],this.tempTileRange_=new _g(0,0,0,0),this.tempTileCoord_=cg(0,0,0);const i=void 0!==e.cacheSize?e.cacheSize:512;this.tileCache_=new lg(i),this.maxStaleKeys=.5*i}getTileCache(){return this.tileCache_}getOrCreateTile(t,e,i,n){const s=this.tileCache_,r=this.getLayer().getSource(),o=Zg(r.getKey(),t,e,i);let a;if(s.containsKey(o))a=s.get(o);else{if(a=r.getTile(t,e,i,n.pixelRatio,n.viewState.projection),!a)return null;s.set(o,a)}return a}getTile(t,e,i,n){return this.getOrCreateTile(t,e,i,n)||null}getData(t){const e=this.frameState;if(!e)return null;const i=this.getLayer(),n=G(e.pixelToCoordinateTransform,t.slice()),s=i.getExtent();if(s&&!K(s,n))return null;const r=e.viewState,o=i.getRenderSource(),a=o.getTileGridForProjection(r.projection),h=o.getTilePixelRatio(e.pixelRatio);for(let t=a.getZForResolution(r.resolution);t>=a.getMinZoom();--t){const i=a.getTileCoordForCoordAndZ(n,t),s=this.getTile(t,i[1],i[2],e);if(!s||2!==s.getState())continue;const l=a.getOrigin(t),c=gs(a.getTileSize(t)),u=a.getResolution(t);let d;if(s instanceof Qd)d=s.getImage();else{if(!(s instanceof Kg))continue;if(d=qg(s.getData()),!d)continue}const g=Math.floor(h*((n[0]-l[0])/u-i[1]*c[0])),f=Math.floor(h*((l[1]-n[1])/u-i[2]*c[1])),p=Math.round(h*o.getGutterForProjection(r.projection));return this.getImageData(d,g+p,f+p)}return null}prepareFrame(t){const e=this.getLayer().getSource();if(!e)return!1;const i=e.getRevision();return this.renderedRevision_?this.renderedRevision_!==i&&(this.renderedRevision_=i,this.renderedSourceKey_===e.getKey()&&this.tileCache_.clear()):this.renderedRevision_=i,!0}enqueueTiles(t,e,i,n,s){const r=t.viewState,o=this.getLayer(),a=o.getRenderSource(),h=a.getTileGridForProjection(r.projection),l=F(a);l in t.wantedTiles||(t.wantedTiles[l]={});const c=t.wantedTiles[l],u=o.getMapInternal(),d=Math.max(i-s,h.getMinZoom(),h.getZForResolution(Math.min(o.getMaxResolution(),u?u.getView().getResolutionForZoom(Math.max(o.getMinZoom(),0)):h.getResolution(0)),a.zDirection));for(let s=i;s>=d;--s){const i=h.getTileRangeForExtentAndZ(e,s,this.tempTileRange_),r=h.getResolution(s);for(let e=i.minX;e<=i.maxX;++e)for(let o=i.minY;o<=i.maxY;++o){const i=this.getTile(s,e,o,t);if(!i)continue;if(!Hg(n,i,s))continue;const a=i.getKey();if(c[a]=!0,0===i.getState()&&!t.tileQueue.isKeyQueued(a)){const n=cg(s,e,o,this.tempTileCoord_);t.tileQueue.enqueue([i,l,h.getTileCoordCenter(n),r])}}}}findStaleTile_(t,e){const i=this.tileCache_,n=t[0],s=t[1],r=t[2],o=this.getStaleKeys();for(let t=0;t<o.length;++t){const a=Zg(o[t],n,s,r);if(i.containsKey(a)){const t=i.get(a);if(2===t.getState())return t.endTransition(F(this)),Hg(e,t,n),!0}}return!1}findAltTiles_(t,e,i,n){const s=t.getTileRangeForTileCoordAndZ(e,i,this.tempTileRange_);if(!s)return!1;let r=!0;const o=this.tileCache_,a=this.getLayer().getRenderSource().getKey();for(let t=s.minX;t<=s.maxX;++t)for(let e=s.minY;e<=s.maxY;++e){const s=Zg(a,i,t,e);let h=!1;if(o.containsKey(s)){const t=o.get(s);2===t.getState()&&(Hg(n,t,i),h=!0)}h||(r=!1)}return r}renderFrame(t,e){this.renderComplete=!0;const i=t.layerStatesArray[t.layerIndex],n=t.viewState,s=n.projection,o=n.resolution,a=n.center,h=t.pixelRatio,l=this.getLayer(),c=l.getSource(),u=c.getRevision(),d=c.getTileGridForProjection(s),g=d.getZForResolution(o,c.zDirection),f=d.getResolution(g),p=c.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==p&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=p):this.renderedSourceKey_=p;let _=t.extent;const m=c.getTilePixelRatio(h);this.prepareContainer(t,e);const y=this.context.canvas.width,v=this.context.canvas.height,x=i.extent&&je(i.extent,s);x&&(_=pt(_,je(i.extent,s)));const M=f*y/2/m,w=f*v/2/m,S=[a[0]-M,a[1]-w,a[0]+M,a[1]+w],C={};this.renderedTiles.length=0;const b=l.getPreload();if(t.nextExtent){const e=d.getZForResolution(n.nextResolution,c.zDirection),i=$g(t,t.nextExtent);this.enqueueTiles(t,i,e,C,b)}const E=$g(t,_);if(this.enqueueTiles(t,E,g,C,0),b>0&&setTimeout((()=>{this.enqueueTiles(t,E,g-1,C,b-1)}),0),!(g in C))return this.container;const P=F(this),I=t.time;for(const e of C[g]){const i=e.getState();if((e instanceof hg||e instanceof Yg)&&4===i)continue;const n=e.tileCoord;if(2===i&&1===e.getAlpha(P,I)){e.endTransition(P);continue}if(this.renderComplete=!1,this.findStaleTile_(n,C)){Jg(C,e,g),t.animate=!0;continue}if(this.findAltTiles_(d,n,g+1,C))continue;const s=d.getMinZoom();for(let t=g-1;t>=s&&!this.findAltTiles_(d,n,t,C);--t);}const T=f/o*h/m,R=this.getRenderContext(t);j(this.tempTransform,y/2,v/2,T,T,0,-y/2,-v/2),i.extent&&this.clipUnrotated(R,t,x),c.getInterpolate()||(R.imageSmoothingEnabled=!1),this.preRender(R,t);const A=Object.keys(C).map(Number);let L;A.sort(r);const k=[],O=[];for(let e=A.length-1;e>=0;--e){const i=A[e],n=c.getTilePixelSize(i,h,s),r=d.getResolution(i)/f,o=n[0]*r*T,a=n[1]*r*T,l=d.getTileCoordForCoordAndZ(_t(S),i),u=d.getTileCoordExtent(l),g=G(this.tempTransform,[m*(u[0]-S[0])/f,m*(S[3]-u[3])/f]),p=m*c.getGutterForProjection(s);for(const e of C[i]){if(2!==e.getState())continue;const n=e.tileCoord,s=l[1]-n[1],r=Math.round(g[0]-(s-1)*o),h=l[2]-n[2],u=Math.round(g[1]-(h-1)*a),d=Math.round(g[0]-s*o),f=Math.round(g[1]-h*a),_=r-d,m=u-f,y=1===A.length;let v=!1;L=[d,f,d+_,f,d+_,f+m,d,f+m];for(let t=0,e=k.length;t<e;++t)if(!y&&i<O[t]){const e=k[t];vt([d,f,d+_,f+m],[e[0],e[3],e[4],e[7]])&&(v||(R.save(),v=!0),R.beginPath(),R.moveTo(L[0],L[1]),R.lineTo(L[2],L[3]),R.lineTo(L[4],L[5]),R.lineTo(L[6],L[7]),R.moveTo(e[6],e[7]),R.lineTo(e[4],e[5]),R.lineTo(e[2],e[3]),R.lineTo(e[0],e[1]),R.clip())}k.push(L),O.push(i),this.drawTile(e,t,d,f,_,m,p,y),v&&R.restore(),this.renderedTiles.unshift(e),this.updateUsedTiles(t.usedTiles,c,e)}}return this.renderedRevision=u,this.renderedResolution=f,this.extentChanged=!this.renderedExtent_||!it(this.renderedExtent_,S),this.renderedExtent_=S,this.renderedPixelRatio=h,this.renderedProjection=s,this.postRender(this.context,t),i.extent&&R.restore(),R.imageSmoothingEnabled=!0,t.postRenderFunctions.push(((t,e)=>{const i=F(c),n=e.wantedTiles[i],s=n?Object.keys(n).length:0;this.updateCacheSize(s),this.tileCache_.expireCache()})),this.container}updateCacheSize(t){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,2*t)}drawTile(t,e,i,n,s,r,o,a){let h;if(t instanceof Kg){if(h=qg(t.getData()),!h)throw new Error("Rendering array data is not yet supported")}else h=this.getTileImage(t);if(!h)return;const l=this.getRenderContext(e),c=F(this),u=e.layerStatesArray[e.layerIndex],d=u.opacity*(a?t.getAlpha(c,e.time):1),g=d!==l.globalAlpha;g&&(l.save(),l.globalAlpha=d),l.drawImage(h,o,o,h.width-2*o,h.height-2*o,i,n,s,r),g&&l.restore(),d!==u.opacity?e.animate=!0:a&&t.endTransition(c)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}updateUsedTiles(t,e,i){const n=F(e);n in t||(t[n]={}),t[n][i.getKey()]=!0}},tf=class extends Wg{constructor(t){super(t)}createRenderer(){return new Qg(this,{cacheSize:this.getCacheSize()})}},ef=class extends qn{constructor(t){super(t=t||{})}},nf=class extends td{constructor(t){super(t),this.image=null}getImage(){return this.image?this.image.getImage():null}prepareFrame(t){const e=t.layerStatesArray[t.layerIndex],i=t.pixelRatio,n=t.viewState,s=n.resolution,r=this.getLayer().getSource(),o=t.viewHints;let a=t.extent;if(void 0!==e.extent&&(a=pt(a,je(e.extent,n.projection))),!o[0]&&!o[1]&&!xt(a))if(r){const t=n.projection,e=r.getImage(a,s,i,t);e&&(this.loadImage(e)?this.image=e:e.getState()===us&&(this.image=null))}else this.image=null;return!!this.image}getData(t){const e=this.frameState;if(!e)return null;const i=this.getLayer(),n=G(e.pixelToCoordinateTransform,t.slice()),s=i.getExtent();if(s&&!K(s,n))return null;const r=this.image.getExtent(),o=this.image.getImage(),a=yt(r),h=Math.floor(o.width*((n[0]-r[0])/a));if(h<0||h>=o.width)return null;const l=ft(r),c=Math.floor(o.height*((r[3]-n[1])/l));return c<0||c>=o.height?null:this.getImageData(o,h,c)}renderFrame(t,e){const i=this.image,n=i.getExtent(),s=i.getResolution(),[r,o]=Array.isArray(s)?s:[s,s],a=i.getPixelRatio(),h=t.layerStatesArray[t.layerIndex],l=t.pixelRatio,c=t.viewState,u=c.center,d=c.resolution,g=l*r/(d*a),f=l*o/(d*a);this.prepareContainer(t,e);const p=this.context.canvas.width,_=this.context.canvas.height,m=this.getRenderContext(t);let y=!1,v=!0;if(h.extent){const e=je(h.extent,c.projection);v=vt(e,t.extent),y=v&&!Y(e,t.extent),y&&this.clipUnrotated(m,t,e)}const x=i.getImage(),M=j(this.tempTransform,p/2,_/2,g,f,0,a*(n[0]-u[0])/r,a*(u[1]-n[3])/o);this.renderedResolution=o*l/a;const w=x.width*M[0],S=x.height*M[3];if(this.getLayer().getSource().getInterpolate()||(m.imageSmoothingEnabled=!1),this.preRender(m,t),v&&w>=.5&&S>=.5){const t=M[4],e=M[5],i=h.opacity;1!==i&&(m.save(),m.globalAlpha=i),m.drawImage(x,0,0,+x.width,+x.height,t,e,w,S),1!==i&&m.restore()}return this.postRender(this.context,t),y&&m.restore(),m.imageSmoothingEnabled=!0,this.container}},sf=class extends ef{constructor(t){super(t)}createRenderer(){return new nf(this)}getData(t){return super.getData(t)}};function rf(t){return Array.isArray(t)?Math.min(...t):t}const of=class extends $s{constructor(t,e,i,n,s,r,o){let a=t.getExtent();a&&t.canWrapX()&&(a=a.slice(),a[0]=-1/0,a[2]=1/0);let h=e.getExtent();h&&e.canWrapX()&&(h=h.slice(),h[0]=-1/0,h[2]=1/0);const l=h?pt(i,h):i,c=rg(t,e,ut(l),n),u=new tg(t,e,l,a,.5*c,n),d=u.calculateSourceExtent(),g=xt(d)?null:r(d,c,s),f=g?as:us,p=g?g.getPixelRatio():1;super(i,n,p,f),this.targetProj_=e,this.maxSourceExtent_=a,this.triangulation_=u,this.targetResolution_=n,this.targetExtent_=i,this.sourceImage_=g,this.sourcePixelRatio_=p,this.interpolate_=o,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==hs&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const t=this.sourceImage_.getState();if(t==ls){const t=yt(this.targetExtent_)/this.targetResolution_,e=ft(this.targetExtent_)/this.targetResolution_;this.canvas_=ag(t,e,this.sourcePixelRatio_,rf(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=t,this.changed()}load(){if(this.state==as){this.state=hs,this.changed();const t=this.sourceImage_.getState();t==ls||t==cs?this.reproject_():(this.sourceListenerKey_=b(this.sourceImage_,y,(t=>{const e=this.sourceImage_.getState();e!=ls&&e!=cs||(this.unlistenSource_(),this.reproject_())})),this.sourceImage_.load())}}unlistenSource_(){P(this.sourceListenerKey_),this.sourceListenerKey_=null}},af=4;class hf extends t{constructor(t,e){super(t),this.image=e}}function lf(t,e){t.getImage().src=e}function cf(t,e,i,n){const s=e/i,r=ut(t),o=Ft(yt(t)/s,af),a=Ft(ft(t)/s,af);return gt(r,s,0,[o+2*Ft((n-1)*o/2,af),a+2*Ft((n-1)*a/2,af)])}const uf=class extends uh{constructor(t){super({attributions:t.attributions,projection:t.projection,state:t.state,interpolate:void 0===t.interpolate||t.interpolate}),this.on,this.once,this.un,this.loader=t.loader||null,this.resolutions_=void 0!==t.resolutions?t.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=!!t.loader&&0===t.loader.length,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(t){this.resolutions_=t}findNearestResolution(t){const e=this.getResolutions();return e&&(t=e[o(e,t,0)]),t}getImage(t,e,i,n){const s=this.getProjection();if(!s||!n||Te(s,n))return s&&(n=s),this.getImageInternal(t,e,i,n);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&Te(this.reprojectedImage_.getProjection(),n)&&this.reprojectedImage_.getResolution()==e&&it(this.reprojectedImage_.getExtent(),t))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new of(s,n,t,e,i,((t,e,i)=>this.getImageInternal(t,e,i,s)),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(t,e,i,n){if(this.loader){const s=cf(t,e,i,1),r=this.findNearestResolution(e);if(this.image&&(this.static_||this.wantedProjection_===n&&(this.wantedExtent_&&Y(this.wantedExtent_,s)||Y(this.image.getExtent(),s))&&(this.wantedResolution_&&rf(this.wantedResolution_)===r||rf(this.image.getResolution())===r)))return this.image;this.wantedProjection_=n,this.wantedExtent_=s,this.wantedResolution_=r,this.image=new $s(s,r,i,this.loader),this.image.addEventListener(y,this.handleImageChange.bind(this))}return this.image}handleImageChange(t){const e=t.target;let i;switch(e.getState()){case hs:this.loading=!0,i="imageloadstart";break;case ls:this.loading=!1,i="imageloadend";break;case cs:this.loading=!1,i="imageloaderror";break;default:return}this.hasListener(i)&&this.dispatchEvent(new hf(i,e))}};function df(t,e){const i=(""+t).split("."),n=(""+e).split(".");for(let t=0;t<Math.max(i.length,n.length);t++){const e=parseInt(i[t]||"0",10),s=parseInt(n[t]||"0",10);if(e>s)return 1;if(s>e)return-1}return 0}const gf="1.3.0",ff=[101,101];function pf(t,e,i,n,s){s.WIDTH=i[0],s.HEIGHT=i[1];const r=n.getAxisOrientation(),o=df(s.VERSION,"1.3")>=0;s[o?"CRS":"SRS"]=n.getCode();const a=o&&r.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e;return s.BBOX=a.join(","),Cg(t,s)}function _f(t,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:gf,FORMAT:"image/png",STYLES:"",TRANSPARENT:!0},t)}const mf=class extends uf{constructor(t){super({attributions:(t=t||{}).attributions,interpolate:t.interpolate,projection:t.projection,resolutions:t.resolutions}),this.crossOrigin_=void 0!==t.crossOrigin?t.crossOrigin:null,this.url_=t.url,this.imageLoadFunction_=void 0!==t.imageLoadFunction?t.imageLoadFunction:lf,this.params_=Object.assign({},t.params),this.serverType_=t.serverType,this.hidpi_=void 0===t.hidpi||t.hidpi,this.renderedRevision_=0,this.ratio_=void 0!==t.ratio?t.ratio:1.5,this.loaderProjection_=null}getFeatureInfoUrl(t,e,i,n){const s=Se(i),r=this.getProjection();return r&&r!==s&&(e=rg(r,s,t,e),t=Fe(t,s,r)),function(t,e,i){if(void 0===t.url)return;const n=Se(t.projection||"EPSG:3857"),s=gt(e,i,0,ff),r={QUERY_LAYERS:t.params.LAYERS,INFO_FORMAT:"application/json"};Object.assign(r,_f(t.params,"GetFeatureInfo"),t.params);const o=At((e[0]-s[0])/i,af),a=At((s[3]-e[1])/i,af),h=df(r.VERSION,"1.3")>=0;return r[h?"I":"X"]=o,r[h?"J":"Y"]=a,pf(t.url,s,ff,n,r)}({url:this.url_,params:{...this.params_,...n},projection:r||s},t,e)}getLegendUrl(t,e){return function(t,e){if(void 0===t.url)return;const i={SERVICE:"WMS",VERSION:gf,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0!==e){const n=Se(t.projection||"EPSG:3857").getMetersPerUnit()||1,s=28e-5;i.SCALE=e*n/s}if(Object.assign(i,t.params),void 0!==t.params&&void 0===i.LAYER){const t=i.LAYERS;if(Array.isArray(t)&&1===t.length)return;i.LAYER=t}return Cg(t.url,i)}({url:this.url_,params:{...this.params_,...e}},t)}getParams(){return this.params_}getImageInternal(t,e,i,n){return void 0===this.url_?null:(this.loader&&this.loaderProjection_===n||(this.loaderProjection_=n,this.loader=function(t){const e=void 0===t.hidpi||t.hidpi,i=Se(t.projection||"EPSG:3857"),n=t.ratio||1.5,s=t.load||Js,r=t.crossOrigin??null;return(o,a,h)=>{o=cf(o,a,h,n),1==h||e&&void 0!==t.serverType||(h=1);const l=function(t,e,i,n,s,r,o){r=Object.assign({REQUEST:"GetMap"},r);const a=e/i,h=[Rt(yt(t)/a,af),Rt(ft(t)/a,af)];if(1!=i)switch(o){case"geoserver":const t=90*i+.5|0;"FORMAT_OPTIONS"in r?r.FORMAT_OPTIONS+=";dpi:"+t:r.FORMAT_OPTIONS="dpi:"+t;break;case"mapserver":r.MAP_RESOLUTION=90*i;break;case"carmentaserver":case"qgis":r.DPI=90*i;break;default:throw new Error("Unknown `serverType` configured")}return pf(s,t,h,n,r)}(o,a,h,i,t.url,_f(t.params,"GetMap"),t.serverType),c=new Image;return c.crossOrigin=r,s(c,l).then((t=>({image:t,extent:o,pixelRatio:h})))}}({crossOrigin:this.crossOrigin_,params:this.params_,projection:n,serverType:this.serverType_,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(t,e)=>(this.image.setImage(t),this.imageLoadFunction_(this.image,e),Js(t))})),super.getImageInternal(t,e,i,n))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(t){this.imageLoadFunction_=t,this.changed()}setUrl(t){t!=this.url_&&(this.url_=t,this.loader=null,this.changed())}updateParams(t){Object.assign(this.params_,t),this.changed()}changed(){this.image=null,super.changed()}};var yf=["type_","tileGrid"],vf=.8;function xf(t){var e;switch(t.type_){case"WMTS":t.type_;var i=t.tileGrid,n=function(t,e){if(null==t)return{};var i,n,s=function(t,e){if(null==t)return{};var i={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.includes(n))continue;i[n]=t[n]}return i}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)i=r[n],e.includes(i)||{}.propertyIsEnumerable.call(t,i)&&(s[i]=t[i])}return s}(t,yf);i&&(n.tileGrid=new jg(i)),e=new Gg(n);break;case"XYZ":e=new Dg({url:t.url});break;case"WMS":return e=new mf({url:t.url}),new sf({source:e});default:e=new Ng}return new tf({source:e,opacity:t.opacity||vf})}function Mf(t,e){return new Pd({source:t,style:e})}var wf="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAMAAAC6V+0/AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABm1BMVEUAAADdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPYLi7dMzPcMjLdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzPdMzP///+sruHMAAAAh3RSTlMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEhIANcHBNgyxsw1b9/hdGMnKGXf++c75/nkq3eIpKd4rBJTgHZUEQO3tQQywsQxa9+Ad91sYyOVDyRh2/v3v/ncp3frd3SkEkuMvkwRI6uQ76kjC/OjC9/eP19/e148GHCMjHAYUgpGvAAAAAWJLR0SIa2YWWgAAAAd0SU1FB+MKGAomNRvjZowAAAEBSURBVBjTY2CAAEZFJWUVJgYUwMyiqqauwcqGIsiuqdXerq3DgSzGyaGr196ub8DFjSTIY2jUDgTGJuwIMV4+UzNzCwtLK2t+AZiYoJCNbbudvYNdu6MTjzDMFmeX9nZXNzfX9nZ3DxGImCi7pxdM0NuHRwwsKO7r1w4TbPcPkACJSfIEBgF5wSEhwUAqNExKGigoEx4Bck5kVFQkiI6OkWVgYJWLjQNx4hMS4kF0YpK8AgN7cgqI3Z6alpYKZqRnsDBkZoGZ7dk5OdkQVm4eQ34BhFlYVFQIYRWXMJRCWO1l5eVlUGYFQ2U7BqhiqK6prUMBtfUNDI1NzS0ooLm1DQBCY3WJfMK7sQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxOS0xMC0yNFQxMDozODo1My0wNDowMIZxXTkAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTktMTAtMjRUMTA6Mzg6NTMtMDQ6MDD3LOWFAAAAAElFTkSuQmCC",Sf=new qr({stroke:new Nr({color:"blue",width:3}),fill:new Or({color:"rgba(0, 0, 255, 0.1)"}),image:new Lr({radius:6,stroke:new Nr({width:1.5,color:"rgba(0, 0, 255, 1)"}),fill:new Or({color:"rgba(0, 0, 255, 0.4)"})})});function Cf(t){var e={};return function(i){var n;if("Point"!=i.getGeometry().getType())return Sf;var s=i.get("icon")||t.icon||wf,r=i==(null===(n=t.context)||void 0===n?void 0:n.feature),o="".concat(s,":").concat(r);return void 0===e[o]&&(e[o]=new qr({image:new Vr({src:s,scale:r?1.25:1}),zIndex:r?100:void 0})),e[o]}}var bf,Ef=new sn,Pf={};function If(t,e){var i=new mh,n=Mf(i),s={feature:null};n.setStyle(Cf({context:s}));var r=new hh({layers:e.baseLayers.map((function(t){return xf(t)})).concat([n]),target:t,view:new Bn(e.view||{}),controls:ba({zoomOptions:e})});return e.view.initialExtent&&r.getView().fit(e.view.initialExtent),e.url&&fetch(e.url).then((function(t){return t.json()})).then((function(t){return Ef.readFeatures(t)})).then((function(t){i.addFeatures(t),e.fitSource&&r.getView().fit(i.getExtent(),{maxZoom:e.fitMaxZoom||18}),e.onFeaturesLoaded&&e.onFeaturesLoaded(t)})),r.on("pointermove",(function(t){var e;t.dragging||(r.forEachFeatureAtPixel(t.pixel,(function(t){return e=t}),{hitTolerance:3}),r.getTargetElement().classList.toggle("hovering",!!e),s.feature=e,n.changed())})),Lu(r,e),r}function Tf(t,e){if(!Af(t)){var i=e.geojson?Ef.readGeometry(e.geojson):null,n=document.querySelector("#map_".concat(t)),s=document.querySelector("#".concat(t)),r=e.point?"Point":e.line?"Line":"Polygon",o=e.isMultiGeometry,a=new mh,h=Mf(a),l=new hh({layers:e.baseLayers.map((function(t){return xf(t)})).concat([h]),target:n,view:new Bn(e.view||{}),interactions:rh({onFocusOnly:e.onFocusOnly}),controls:ba({zoomOptions:e})});if(Pf[t]=l,e.onFocusOnly&&l.getTargetElement().setAttribute("tabindex","0"),i?(a.addFeature(new N({geometry:i})),l.getView().fit(i,{maxZoom:e.fitMaxZoom||18,padding:[20,20,20,20]})):e.view.initialExtent&&l.getView().fit(e.view.initialExtent),!e.readonly){var c=function(t){var e=t.input,i=t.multi,n=function(t,e){if(null==t)return{};var i,n,s=function(t,e){if(null==t)return{};var i={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.includes(n))continue;i[n]=t[n]}return i}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)i=r[n],e.includes(i)||{}.propertyIsEnumerable.call(t,i)&&(s[i]=t[i])}return s}(t,Hd),s=function(t){e.value=t?function(t,e){var i={Point:zi,LineString:Wi,Polygon:Xi};return e&&t.getType()in i&&(t=new(i[t.getType()])([t.getCoordinates()])),Jd.writeGeometry(t)}(t,i):"",e.dispatchEvent(new Event("input",{bubbles:!0}))},r=function(t){var e=t.map,i=t.source,n=t.type,s=new zd({type:n});return e.addInteraction(s),s.on("drawstart",(function(){return i.clear()})),s.on("drawend",(function(t){return i.addFeature(t.feature)})),s}(n),o=function(t){var e=t.map,i=t.source,n=new Zd({source:i});return e.addInteraction(n),n}(n);if(o.setActive(!1),t.source.on("change",(function(){var e;return s(null===(e=t.source.getFeatures()[0])||void 0===e?void 0:e.getGeometry())})),(null!==t.mobile?t.mobile:window.matchMedia("(max-width: 767px)").matches)&&"Point"===n.type){var a=t.map;r.setActive(!1),o.setActive(!1),a.getTargetElement().classList.add("cross"),a.updateSize(),a.on("moveend",(function(){return s(new pi(a.getView().getCenter()))}))}return{draw:r,modify:o}}({map:l,source:a,type:r,input:s,multi:o,mobile:e.mobile});!function(t){var e=t.target,i=t.type,n=t.interactions,s=t.source,r=n.draw,o=n.modify,a=document.createElement("div");a.classList.add("ol-control","ol-unselectable","c2cgeoform-controls"),"Point"!==i&&(Fu(a,{content:'<i class="glyphicon glyphicon-pencil"></i>',title:t.drawTooltip,callback:function(){return r.setActive(!0)&&o.setActive(!1)}}),Fu(a,{content:'<i class="glyphicon glyphicon-move"></i>',title:t.modifyTooltip,callback:function(){return o.setActive(!0)&&r.setActive(!1)}})),Fu(a,{content:'<i class="glyphicon glyphicon-remove"></i>',title:t.clearTooltip,callback:function(){return s.clear()}}),e.appendChild(a)}(Object.assign(e,{target:n,interactions:c,drawTooltip:e["draw".concat(r,"Tooltip")],source:a,type:r}))}bf&&h.setStyle(Cf({icon:bf})),Lu(l,e)}}function Rf(t,e){var i=xf(e);return Ff(t).addLayer(i),i}function Af(t){return t in Pf}function Ff(t){return Pf[t]}function Lf(t){var e=Ff(t);e.getControls().clear(),e.getInteractions().clear(),e.getTargetElement().classList.add("c2cgeoform-readonly"),e.updateSize()}function kf(t,e){Ru.defs(t,e),function(t){Au=t;const e=Object.keys(t.defs),i=e.length;let n,s;for(n=0;n<i;++n){const i=e[n];if(!Se(i)){const e=t.defs(i);let n=e.units;n||"longlat"!==e.projName||(n="degrees"),we(new Xt({code:i,axisOrientation:e.axis,metersPerUnit:e.to_meter,units:n}))}}for(n=0;n<i;++n){const r=e[n],o=Se(r);for(s=0;s<i;++s){const i=e[s],n=Se(i);if(!re(r,i))if(t.defs[r]===t.defs[i])be([o,n]);else{const e=t(r,i);Ie(o,n,Be(o,n,e.forward),Be(n,o,e.inverse))}}}}(Ru)}function Of(t){bf=t}})(),c2cgeoform=n})();
//# sourceMappingURL=index.js.map